(function webpackUniversalModuleDefinition(root, factory) {
  if (typeof exports === 'object' && typeof module === 'object')
    module.exports = factory();
  else if (typeof define === 'function' && define.amd) define([], factory);
        else {
  var a = factory();
  for (var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];
}})(globalThis, function () {
"use strict";var __exports__=(()=>{var Cft=Object.create;var Jx=Object.defineProperty;var Pft=Object.getOwnPropertyDescriptor;var Ift=Object.getOwnPropertyNames;var Rft=Object.getPrototypeOf,Lft=Object.prototype.hasOwnProperty;var Oft=(e,t,r)=>t in e?Jx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var tV=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var Te=(e,t)=>()=>(e&&(t=e(e=0)),t);var Ye=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Lo=(e,t)=>{for(var r in t)Jx(e,r,{get:t[r],enumerable:!0})},eV=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Ift(t))!Lft.call(e,i)&&i!==r&&Jx(e,i,{get:()=>t[i],enumerable:!(n=Pft(t,i))||n.enumerable});return e};var tc=(e,t,r)=>(r=e!=null?Cft(Rft(e)):{},eV(t||!e||!e.__esModule?Jx(r,"default",{value:e,enumerable:!0}):r,e)),rV=e=>eV(Jx({},"__esModule",{value:!0}),e);var Vr=(e,t,r)=>(Oft(e,typeof t!="symbol"?t+"":t,r),r);var U7=Ye((UO,VO)=>{(function(e,t){typeof UO=="object"&&typeof VO<"u"?VO.exports=t():typeof define=="function"&&define.amd?define(t):(e=e||self,e.mapboxgl=t())})(UO,function(){"use strict";var e,t,r;function n(i,o){if(!e)e=o;else if(!t)t=o;else{var s="var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk);",c={};e(c),r=o(c),typeof window<"u"&&(r.workerUrl=window.URL.createObjectURL(new Blob([s],{type:"text/javascript"})))}}return n(["exports"],function(i){"use strict";function o(a,u){return a(u={exports:{}},u.exports),u.exports}var s=c;function c(a,u,f,b){this.cx=3*a,this.bx=3*(f-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(b-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=b,this.p2x=f,this.p2y=b}c.prototype.sampleCurveX=function(a){return((this.ax*a+this.bx)*a+this.cx)*a},c.prototype.sampleCurveY=function(a){return((this.ay*a+this.by)*a+this.cy)*a},c.prototype.sampleCurveDerivativeX=function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},c.prototype.solveCurveX=function(a,u){var f,b,S,I,N;for(u===void 0&&(u=1e-6),S=a,N=0;N<8;N++){if(I=this.sampleCurveX(S)-a,Math.abs(I)<u)return S;var H=this.sampleCurveDerivativeX(S);if(Math.abs(H)<1e-6)break;S-=I/H}if((S=a)<(f=0))return f;if(S>(b=1))return b;for(;f<b;){if(I=this.sampleCurveX(S),Math.abs(I-a)<u)return S;a>I?f=S:b=S,S=.5*(b-f)+f}return S},c.prototype.solve=function(a,u){return this.sampleCurveY(this.solveCurveX(a,u))};var l=h;function h(a,u){this.x=a,this.y=u}h.prototype={clone:function(){return new h(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,u){return this.clone()._rotateAround(a,u)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var u=a.x-this.x,f=a.y-this.y;return u*u+f*f},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,u){return Math.atan2(this.x*u-this.y*a,this.x*a+this.y*u)},_matMult:function(a){var u=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=u,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var u=Math.cos(a),f=Math.sin(a),b=f*this.x+u*this.y;return this.x=u*this.x-f*this.y,this.y=b,this},_rotateAround:function(a,u){var f=Math.cos(a),b=Math.sin(a),S=u.y+b*(this.x-u.x)+f*(this.y-u.y);return this.x=u.x+f*(this.x-u.x)-b*(this.y-u.y),this.y=S,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},h.convert=function(a){return a instanceof h?a:Array.isArray(a)?new h(a[0],a[1]):a};var p=typeof self<"u"?self:{},x=Math.pow(2,53)-1;function w(a,u,f,b){var S=new s(a,u,f,b);return function(I){return S.solve(I)}}var E=w(.25,.1,.25,1);function P(a,u,f){return Math.min(f,Math.max(u,a))}function B(a,u,f){var b=f-u,S=((a-u)%b+b)%b+u;return S===u?f:S}function D(a){for(var u=[],f=arguments.length-1;f-- >0;)u[f]=arguments[f+1];for(var b=0,S=u;b<S.length;b+=1){var I=S[b];for(var N in I)a[N]=I[N]}return a}var W=1;function X(){return W++}function q(){return function a(u){return u?(u^16*Math.random()>>u/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function $(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function et(a,u){a.forEach(function(f){u[f]&&(u[f]=u[f].bind(u))})}function F(a,u){return a.indexOf(u,a.length-u.length)!==-1}function ut(a,u,f){var b={};for(var S in a)b[S]=u.call(f||this,a[S],S,a);return b}function ot(a,u,f){var b={};for(var S in a)u.call(f||this,a[S],S,a)&&(b[S]=a[S]);return b}function J(a){return Array.isArray(a)?a.map(J):typeof a=="object"&&a?ut(a,J):a}var G={};function mt(a){G[a]||(typeof console<"u"&&console.warn(a),G[a]=!0)}function Mt(a,u,f){return(f.y-a.y)*(u.x-a.x)>(u.y-a.y)*(f.x-a.x)}function ct(a){for(var u=0,f=0,b=a.length,S=b-1,I=void 0,N=void 0;f<b;S=f++)u+=((N=a[S]).x-(I=a[f]).x)*(I.y+N.y);return u}function gt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function ee(a){var u={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(b,S,I,N){var H=I||N;return u[S]=!H||H.toLowerCase(),""}),u["max-age"]){var f=parseInt(u["max-age"],10);isNaN(f)?delete u["max-age"]:u["max-age"]=f}return u}var Ne=null;function Ue(a){if(Ne==null){var u=a.navigator?a.navigator.userAgent:null;Ne=!!a.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return Ne}function sr(a){try{var u=p[a];return u.setItem("_mapbox_test_",1),u.removeItem("_mapbox_test_"),!0}catch{return!1}}var gr,Xr,ir,on,Xe=p.performance&&p.performance.now?p.performance.now.bind(p.performance):Date.now.bind(Date),He=p.requestAnimationFrame||p.mozRequestAnimationFrame||p.webkitRequestAnimationFrame||p.msRequestAnimationFrame,_n=p.cancelAnimationFrame||p.mozCancelAnimationFrame||p.webkitCancelAnimationFrame||p.msCancelAnimationFrame,dt={now:Xe,frame:function(a){var u=He(a);return{cancel:function(){return _n(u)}}},getImageData:function(a,u){u===void 0&&(u=0);var f=p.document.createElement("canvas"),b=f.getContext("2d");if(!b)throw new Error("failed to create canvas 2d context");return f.width=a.width,f.height=a.height,b.drawImage(a,0,0,a.width,a.height),b.getImageData(-u,-u,a.width+2*u,a.height+2*u)},resolveURL:function(a){return gr||(gr=p.document.createElement("a")),gr.href=a,gr.href},hardwareConcurrency:p.navigator&&p.navigator.hardwareConcurrency||4,get devicePixelRatio(){return p.devicePixelRatio},get prefersReducedMotion(){return!!p.matchMedia&&(Xr==null&&(Xr=p.matchMedia("(prefers-reduced-motion: reduce)")),Xr.matches)}},wt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ht={supported:!1,testSupport:function(a){!ue&&on&&(Le?Ee(a):ir=a)}},ue=!1,Le=!1;function Ee(a){var u=a.createTexture();a.bindTexture(a.TEXTURE_2D,u);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,on),a.isContextLost())return;Ht.supported=!0}catch{}a.deleteTexture(u),ue=!0}p.document&&((on=p.document.createElement("img")).onload=function(){ir&&Ee(ir),ir=null,Le=!0},on.onerror=function(){ue=!0,ir=null},on.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Jr="01",bn=function(a,u){this._transformRequestFn=a,this._customAccessToken=u,this._createSkuToken()};function ai(a){return a.indexOf("mapbox:")===0}bn.prototype._createSkuToken=function(){var a=function(){for(var u="",f=0;f<10;f++)u+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Jr,u].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt},bn.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},bn.prototype.transformRequest=function(a,u){return this._transformRequestFn&&this._transformRequestFn(a,u)||{url:a}},bn.prototype.normalizeStyleURL=function(a,u){if(!ai(a))return a;var f=Ui(a);return f.path="/styles/v1"+f.path,this._makeAPIURL(f,this._customAccessToken||u)},bn.prototype.normalizeGlyphsURL=function(a,u){if(!ai(a))return a;var f=Ui(a);return f.path="/fonts/v1"+f.path,this._makeAPIURL(f,this._customAccessToken||u)},bn.prototype.normalizeSourceURL=function(a,u){if(!ai(a))return a;var f=Ui(a);return f.path="/v4/"+f.authority+".json",f.params.push("secure"),this._makeAPIURL(f,this._customAccessToken||u)},bn.prototype.normalizeSpriteURL=function(a,u,f,b){var S=Ui(a);return ai(a)?(S.path="/styles/v1"+S.path+"/sprite"+u+f,this._makeAPIURL(S,this._customAccessToken||b)):(S.path+=""+u+f,bs(S))},bn.prototype.normalizeTileURL=function(a,u){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!ai(a))return a;var f=Ui(a);f.path=f.path.replace(/(\.(png|jpg)\d*)(?=$)/,(dt.devicePixelRatio>=2||u===512?"@2x":"")+(Ht.supported?".webp":"$1")),f.path=f.path.replace(/^.+\/v4\//,"/"),f.path="/v4"+f.path;var b=this._customAccessToken||function(S){for(var I=0,N=S;I<N.length;I+=1){var H=N[I].match(/^access_token=(.*)$/);if(H)return H[1]}return null}(f.params)||wt.ACCESS_TOKEN;return wt.REQUIRE_ACCESS_TOKEN&&b&&this._skuToken&&f.params.push("sku="+this._skuToken),this._makeAPIURL(f,b)},bn.prototype.canonicalizeTileURL=function(a,u){var f=Ui(a);if(!f.path.match(/(^\/v4\/)/)||!f.path.match(/\.[\w]+$/))return a;var b="mapbox://tiles/";b+=f.path.replace("/v4/","");var S=f.params;return u&&(S=S.filter(function(I){return!I.match(/^access_token=/)})),S.length&&(b+="?"+S.join("&")),b},bn.prototype.canonicalizeTileset=function(a,u){for(var f=!!u&&ai(u),b=[],S=0,I=a.tiles||[];S<I.length;S+=1){var N=I[S];_i(N)?b.push(this.canonicalizeTileURL(N,f)):b.push(N)}return b},bn.prototype._makeAPIURL=function(a,u){var f="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",b=Ui(wt.API_URL);if(a.protocol=b.protocol,a.authority=b.authority,a.protocol==="http"){var S=a.params.indexOf("secure");S>=0&&a.params.splice(S,1)}if(b.path!=="/"&&(a.path=""+b.path+a.path),!wt.REQUIRE_ACCESS_TOKEN)return bs(a);if(!(u=u||wt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+f);if(u[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+f);return a.params=a.params.filter(function(I){return I.indexOf("access_token")===-1}),a.params.push("access_token="+u),bs(a)};var qo=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function _i(a){return qo.test(a)}var Xn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ui(a){var u=a.match(Xn);if(!u)throw new Error("Unable to parse URL object");return{protocol:u[1],authority:u[2],path:u[3]||"/",params:u[4]?u[4].split("&"):[]}}function bs(a){var u=a.params.length?"?"+a.params.join("&"):"";return a.protocol+"://"+a.authority+a.path+u}function Vi(a){if(!a)return null;var u=a.split(".");if(!u||u.length!==3)return null;try{return JSON.parse(decodeURIComponent(p.atob(u[1]).split("").map(function(f){return"%"+("00"+f.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Cn=function(a){this.type=a,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Cn.prototype.getStorageKey=function(a){var u,f=Vi(wt.ACCESS_TOKEN);return u=f&&f.u?p.btoa(encodeURIComponent(f.u).replace(/%([0-9A-F]{2})/g,function(b,S){return String.fromCharCode(Number("0x"+S))})):wt.ACCESS_TOKEN||"",a?"mapbox.eventData."+a+":"+u:"mapbox.eventData:"+u},Cn.prototype.fetchEventData=function(){var a=sr("localStorage"),u=this.getStorageKey(),f=this.getStorageKey("uuid");if(a)try{var b=p.localStorage.getItem(u);b&&(this.eventData=JSON.parse(b));var S=p.localStorage.getItem(f);S&&(this.anonId=S)}catch{mt("Unable to read from LocalStorage")}},Cn.prototype.saveEventData=function(){var a=sr("localStorage"),u=this.getStorageKey(),f=this.getStorageKey("uuid");if(a)try{p.localStorage.setItem(f,this.anonId),Object.keys(this.eventData).length>=1&&p.localStorage.setItem(u,JSON.stringify(this.eventData))}catch{mt("Unable to write to LocalStorage")}},Cn.prototype.processRequests=function(a){},Cn.prototype.postEvent=function(a,u,f,b){var S=this;if(wt.EVENTS_URL){var I=Ui(wt.EVENTS_URL);I.params.push("access_token="+(b||wt.ACCESS_TOKEN||""));var N={event:this.type,created:new Date(a).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.3",skuId:Jr,userId:this.anonId},H=u?D(N,u):N,Q={url:bs(I),headers:{"Content-Type":"text/plain"},body:JSON.stringify([H])};this.pendingRequest=fo(Q,function(rt){S.pendingRequest=null,f(rt),S.saveEventData(),S.processRequests(b)})}},Cn.prototype.queueRequest=function(a,u){this.queue.push(a),this.processRequests(u)};var yi,_o,Nr=function(a){function u(){a.call(this,"map.load"),this.success={},this.skuToken=""}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.postMapLoadEvent=function(f,b,S,I){this.skuToken=S;var N=!(!I&&!wt.ACCESS_TOKEN),H=Array.isArray(f)&&f.some(function(Q){return ai(Q)||_i(Q)});wt.EVENTS_URL&&N&&H&&this.queueRequest({id:b,timestamp:Date.now()},I)},u.prototype.processRequests=function(f){var b=this;if(!this.pendingRequest&&this.queue.length!==0){var S=this.queue.shift(),I=S.id,N=S.timestamp;I&&this.success[I]||(this.anonId||this.fetchEventData(),$(this.anonId)||(this.anonId=q()),this.postEvent(N,{skuToken:this.skuToken},function(H){H||I&&(b.success[I]=!0)},f))}},u}(Cn),ar=new(function(a){function u(f){a.call(this,"appUserTurnstile"),this._customAccessToken=f}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.postTurnstileEvent=function(f,b){wt.EVENTS_URL&&wt.ACCESS_TOKEN&&Array.isArray(f)&&f.some(function(S){return ai(S)||_i(S)})&&this.queueRequest(Date.now(),b)},u.prototype.processRequests=function(f){var b=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var S=Vi(wt.ACCESS_TOKEN),I=S?S.u:wt.ACCESS_TOKEN,N=I!==this.eventData.tokenU;$(this.anonId)||(this.anonId=q(),N=!0);var H=this.queue.shift();if(this.eventData.lastSuccess){var Q=new Date(this.eventData.lastSuccess),rt=new Date(H),st=(H-this.eventData.lastSuccess)/864e5;N=N||st>=1||st<-1||Q.getDate()!==rt.getDate()}else N=!0;if(!N)return this.processRequests();this.postEvent(H,{"enabled.telemetry":!1},function(lt){lt||(b.eventData.lastSuccess=H,b.eventData.tokenU=I)},f)}},u}(Cn)),zr=ar.postTurnstileEvent.bind(ar),hn=new Nr,ho=hn.postMapLoadEvent.bind(hn),ki=500,ds=50;function es(){p.caches&&!yi&&(yi=p.caches.open("mapbox-tiles"))}function rs(a){var u=a.indexOf("?");return u<0?a:a.slice(0,u)}var No,ha=1/0;function ch(){return No==null&&(No=p.OffscreenCanvas&&new p.OffscreenCanvas(1,1).getContext("2d")&&typeof p.createImageBitmap=="function"),No}var Xl={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Xl);var vu=function(a){function u(f,b,S){b===401&&_i(S)&&(f+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),a.call(this,f),this.status=b,this.url=S,this.name=this.constructor.name,this.message=f}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},u}(Error),wl=gt()?function(){return self.worker&&self.worker.referrer}:function(){return(p.location.protocol==="blob:"?p.parent:p).location.href},el,fa,hc=function(a,u){if(!(/^file:/.test(f=a.url)||/^file:/.test(wl())&&!/^\w+:/.test(f))){if(p.fetch&&p.Request&&p.AbortController&&p.Request.prototype.hasOwnProperty("signal"))return function(b,S){var I,N=new p.AbortController,H=new p.Request(b.url,{method:b.method||"GET",body:b.body,credentials:b.credentials,headers:b.headers,referrer:wl(),signal:N.signal}),Q=!1,rt=!1,st=(I=H.url).indexOf("sku=")>0&&_i(I);b.type==="json"&&H.headers.set("Accept","application/json");var lt=function(Tt,kt,Ut){if(!rt){if(Tt&&Tt.message!=="SecurityError"&&mt(Tt),kt&&Ut)return yt(kt);var $t=Date.now();p.fetch(H).then(function(qt){if(qt.ok){var ie=st?qt.clone():null;return yt(qt,ie,$t)}return S(new vu(qt.statusText,qt.status,b.url))}).catch(function(qt){qt.code!==20&&S(new Error(qt.message))})}},yt=function(Tt,kt,Ut){(b.type==="arrayBuffer"?Tt.arrayBuffer():b.type==="json"?Tt.json():Tt.text()).then(function($t){rt||(kt&&Ut&&function(qt,ie,de){if(es(),yi){var ge={status:ie.status,statusText:ie.statusText,headers:new p.Headers};ie.headers.forEach(function(De,Ke){return ge.headers.set(Ke,De)});var we=ee(ie.headers.get("Cache-Control")||"");we["no-store"]||(we["max-age"]&&ge.headers.set("Expires",new Date(de+1e3*we["max-age"]).toUTCString()),new Date(ge.headers.get("Expires")).getTime()-de<42e4||function(De,Ke){if(_o===void 0)try{new Response(new ReadableStream),_o=!0}catch{_o=!1}_o?Ke(De.body):De.blob().then(Ke)}(ie,function(De){var Ke=new p.Response(De,ge);es(),yi&&yi.then(function(or){return or.put(rs(qt.url),Ke)}).catch(function(or){return mt(or.message)})}))}}(H,kt,Ut),Q=!0,S(null,$t,Tt.headers.get("Cache-Control"),Tt.headers.get("Expires")))}).catch(function($t){rt||S(new Error($t.message))})};return st?function(Tt,kt){if(es(),!yi)return kt(null);var Ut=rs(Tt.url);yi.then(function($t){$t.match(Ut).then(function(qt){var ie=function(de){if(!de)return!1;var ge=new Date(de.headers.get("Expires")||0),we=ee(de.headers.get("Cache-Control")||"");return ge>Date.now()&&!we["no-cache"]}(qt);$t.delete(Ut),ie&&$t.put(Ut,qt.clone()),kt(null,qt,ie)}).catch(kt)}).catch(kt)}(H,lt):lt(null,null),{cancel:function(){rt=!0,Q||N.abort()}}}(a,u);if(gt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,u,void 0,!0)}var f;return function(b,S){var I=new p.XMLHttpRequest;for(var N in I.open(b.method||"GET",b.url,!0),b.type==="arrayBuffer"&&(I.responseType="arraybuffer"),b.headers)I.setRequestHeader(N,b.headers[N]);return b.type==="json"&&(I.responseType="text",I.setRequestHeader("Accept","application/json")),I.withCredentials=b.credentials==="include",I.onerror=function(){S(new Error(I.statusText))},I.onload=function(){if((I.status>=200&&I.status<300||I.status===0)&&I.response!==null){var H=I.response;if(b.type==="json")try{H=JSON.parse(I.response)}catch(Q){return S(Q)}S(null,H,I.getResponseHeader("Cache-Control"),I.getResponseHeader("Expires"))}else S(new vu(I.statusText,I.status,b.url))},I.send(b.body),{cancel:function(){return I.abort()}}}(a,u)},bu=function(a,u){return hc(D(a,{type:"arrayBuffer"}),u)},fo=function(a,u){return hc(D(a,{method:"POST"}),u)},at="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";el=[],fa=0;var At=function(a,u){if(Ht.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),fa>=wt.MAX_PARALLEL_IMAGE_REQUESTS){var f={requestParameters:a,callback:u,cancelled:!1,cancel:function(){this.cancelled=!0}};return el.push(f),f}fa++;var b=!1,S=function(){if(!b)for(b=!0,fa--;el.length&&fa<wt.MAX_PARALLEL_IMAGE_REQUESTS;){var N=el.shift();N.cancelled||(N.cancel=At(N.requestParameters,N.callback).cancel)}},I=bu(a,function(N,H,Q,rt){S(),N?u(N):H&&(ch()?function(st,lt){var yt=new p.Blob([new Uint8Array(st)],{type:"image/png"});p.createImageBitmap(yt).then(function(Tt){lt(null,Tt)}).catch(function(Tt){lt(new Error("Could not load image because of "+Tt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(H,u):function(st,lt,yt,Tt){var kt=new p.Image,Ut=p.URL;kt.onload=function(){lt(null,kt),Ut.revokeObjectURL(kt.src),kt.onload=null,p.requestAnimationFrame(function(){kt.src=at})},kt.onerror=function(){return lt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var $t=new p.Blob([new Uint8Array(st)],{type:"image/png"});kt.cacheControl=yt,kt.expires=Tt,kt.src=st.byteLength?Ut.createObjectURL($t):at}(H,u,Q,rt))});return{cancel:function(){I.cancel(),S()}}};function bt(a,u,f){f[a]&&f[a].indexOf(u)!==-1||(f[a]=f[a]||[],f[a].push(u))}function Lt(a,u,f){if(f&&f[a]){var b=f[a].indexOf(u);b!==-1&&f[a].splice(b,1)}}var vt=function(a,u){u===void 0&&(u={}),D(this,u),this.type=a},Qt=function(a){function u(f,b){b===void 0&&(b={}),a.call(this,"error",D({error:f},b))}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u}(vt),Jt=function(){};Jt.prototype.on=function(a,u){return this._listeners=this._listeners||{},bt(a,u,this._listeners),this},Jt.prototype.off=function(a,u){return Lt(a,u,this._listeners),Lt(a,u,this._oneTimeListeners),this},Jt.prototype.once=function(a,u){return this._oneTimeListeners=this._oneTimeListeners||{},bt(a,u,this._oneTimeListeners),this},Jt.prototype.fire=function(a,u){typeof a=="string"&&(a=new vt(a,u||{}));var f=a.type;if(this.listens(f)){a.target=this;for(var b=0,S=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];b<S.length;b+=1)S[b].call(this,a);for(var I=0,N=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];I<N.length;I+=1){var H=N[I];Lt(f,H,this._oneTimeListeners),H.call(this,a)}var Q=this._eventedParent;Q&&(D(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),Q.fire(a))}else a instanceof Qt&&console.error(a.error);return this},Jt.prototype.listens=function(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)},Jt.prototype.setEventedParent=function(a,u){return this._eventedParent=a,this._eventedParentData=u,this};var St={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},jt=function(a,u,f,b){this.message=(a?a+": ":"")+f,b&&(this.identifier=b),u!=null&&u.__line__&&(this.line=u.__line__)};function ce(a){var u=a.value;return u?[new jt(a.key,u,"constants have been deprecated as of v8")]:[]}function je(a){for(var u=[],f=arguments.length-1;f-- >0;)u[f]=arguments[f+1];for(var b=0,S=u;b<S.length;b+=1){var I=S[b];for(var N in I)a[N]=I[N]}return a}function Ge(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Pe(a){if(Array.isArray(a))return a.map(Pe);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){var u={};for(var f in a)u[f]=Pe(a[f]);return u}return Ge(a)}var We=function(a){function u(f,b){a.call(this,b),this.message=b,this.key=f}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u}(Error),Rr=function(a,u){u===void 0&&(u=[]),this.parent=a,this.bindings={};for(var f=0,b=u;f<b.length;f+=1){var S=b[f];this.bindings[S[0]]=S[1]}};Rr.prototype.concat=function(a){return new Rr(this,a)},Rr.prototype.get=function(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(a+" not found in scope.")},Rr.prototype.has=function(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)};var Cr={kind:"null"},Re={kind:"number"},yr={kind:"string"},tr={kind:"boolean"},cr={kind:"color"},wn={kind:"object"},fr={kind:"value"},On={kind:"collator"},Ci={kind:"formatted"},Bn={kind:"resolvedImage"};function Zn(a,u){return{kind:"array",itemType:a,N:u}}function Yn(a){if(a.kind==="array"){var u=Yn(a.itemType);return typeof a.N=="number"?"array<"+u+", "+a.N+">":a.itemType.kind==="value"?"array":"array<"+u+">"}return a.kind}var Ns=[Cr,Re,yr,tr,cr,Ci,wn,Zn(fr),Bn];function di(a,u){if(u.kind==="error")return null;if(a.kind==="array"){if(u.kind==="array"&&(u.N===0&&u.itemType.kind==="value"||!di(a.itemType,u.itemType))&&(typeof a.N!="number"||a.N===u.N))return null}else{if(a.kind===u.kind)return null;if(a.kind==="value"){for(var f=0,b=Ns;f<b.length;f+=1)if(!di(b[f],u))return null}}return"Expected "+Yn(a)+" but found "+Yn(u)+" instead."}function yo(a,u){return u.some(function(f){return f.kind===a.kind})}function Pi(a,u){return u.some(function(f){return f==="null"?a===null:f==="array"?Array.isArray(a):f==="object"?a&&!Array.isArray(a)&&typeof a=="object":f===typeof a})}var Dn=o(function(a,u){var f={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function b(H){return(H=Math.round(H))<0?0:H>255?255:H}function S(H){return b(H[H.length-1]==="%"?parseFloat(H)/100*255:parseInt(H))}function I(H){return(Q=H[H.length-1]==="%"?parseFloat(H)/100:parseFloat(H))<0?0:Q>1?1:Q;var Q}function N(H,Q,rt){return rt<0?rt+=1:rt>1&&(rt-=1),6*rt<1?H+(Q-H)*rt*6:2*rt<1?Q:3*rt<2?H+(Q-H)*(2/3-rt)*6:H}try{u.parseCSSColor=function(H){var Q,rt=H.replace(/ /g,"").toLowerCase();if(rt in f)return f[rt].slice();if(rt[0]==="#")return rt.length===4?(Q=parseInt(rt.substr(1),16))>=0&&Q<=4095?[(3840&Q)>>4|(3840&Q)>>8,240&Q|(240&Q)>>4,15&Q|(15&Q)<<4,1]:null:rt.length===7&&(Q=parseInt(rt.substr(1),16))>=0&&Q<=16777215?[(16711680&Q)>>16,(65280&Q)>>8,255&Q,1]:null;var st=rt.indexOf("("),lt=rt.indexOf(")");if(st!==-1&&lt+1===rt.length){var yt=rt.substr(0,st),Tt=rt.substr(st+1,lt-(st+1)).split(","),kt=1;switch(yt){case"rgba":if(Tt.length!==4)return null;kt=I(Tt.pop());case"rgb":return Tt.length!==3?null:[S(Tt[0]),S(Tt[1]),S(Tt[2]),kt];case"hsla":if(Tt.length!==4)return null;kt=I(Tt.pop());case"hsl":if(Tt.length!==3)return null;var Ut=(parseFloat(Tt[0])%360+360)%360/360,$t=I(Tt[1]),qt=I(Tt[2]),ie=qt<=.5?qt*($t+1):qt+$t-qt*$t,de=2*qt-ie;return[b(255*N(de,ie,Ut+1/3)),b(255*N(de,ie,Ut)),b(255*N(de,ie,Ut-1/3)),kt];default:return null}}return null}}catch{}}).parseCSSColor,ci=function(a,u,f,b){b===void 0&&(b=1),this.r=a,this.g=u,this.b=f,this.a=b};ci.parse=function(a){if(a){if(a instanceof ci)return a;if(typeof a=="string"){var u=Dn(a);if(u)return new ci(u[0]/255*u[3],u[1]/255*u[3],u[2]/255*u[3],u[3])}}},ci.prototype.toString=function(){var a=this.toArray(),u=a[1],f=a[2],b=a[3];return"rgba("+Math.round(a[0])+","+Math.round(u)+","+Math.round(f)+","+b+")"},ci.prototype.toArray=function(){var a=this.a;return a===0?[0,0,0,0]:[255*this.r/a,255*this.g/a,255*this.b/a,a]},ci.black=new ci(0,0,0,1),ci.white=new ci(1,1,1,1),ci.transparent=new ci(0,0,0,0),ci.red=new ci(1,0,0,1);var pa=function(a,u,f){this.sensitivity=a?u?"variant":"case":u?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};pa.prototype.compare=function(a,u){return this.collator.compare(a,u)},pa.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var lh=function(a,u,f,b,S){this.text=a,this.image=u,this.scale=f,this.fontStack=b,this.textColor=S},ns=function(a){this.sections=a};ns.fromString=function(a){return new ns([new lh(a,null,null,null,null)])},ns.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(a){return a.text.length!==0||a.image&&a.image.name.length!==0})},ns.factory=function(a){return a instanceof ns?a:ns.fromString(a)},ns.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(a){return a.text}).join("")},ns.prototype.serialize=function(){for(var a=["format"],u=0,f=this.sections;u<f.length;u+=1){var b=f[u];if(b.image)a.push(["image",b.image.name]);else{a.push(b.text);var S={};b.fontStack&&(S["text-font"]=["literal",b.fontStack.split(",")]),b.scale&&(S["font-scale"]=b.scale),b.textColor&&(S["text-color"]=["rgba"].concat(b.textColor.toArray())),a.push(S)}}return a};var ks=function(a){this.name=a.name,this.available=a.available};function tf(a,u,f,b){return typeof a=="number"&&a>=0&&a<=255&&typeof u=="number"&&u>=0&&u<=255&&typeof f=="number"&&f>=0&&f<=255?b===void 0||typeof b=="number"&&b>=0&&b<=1?null:"Invalid rgba value ["+[a,u,f,b].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof b=="number"?[a,u,f,b]:[a,u,f]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ws(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof ci||a instanceof pa||a instanceof ns||a instanceof ks)return!0;if(Array.isArray(a)){for(var u=0,f=a;u<f.length;u+=1)if(!ws(f[u]))return!1;return!0}if(typeof a=="object"){for(var b in a)if(!ws(a[b]))return!1;return!0}return!1}function Xi(a){if(a===null)return Cr;if(typeof a=="string")return yr;if(typeof a=="boolean")return tr;if(typeof a=="number")return Re;if(a instanceof ci)return cr;if(a instanceof pa)return On;if(a instanceof ns)return Ci;if(a instanceof ks)return Bn;if(Array.isArray(a)){for(var u,f=a.length,b=0,S=a;b<S.length;b+=1){var I=Xi(S[b]);if(u){if(u===I)continue;u=fr;break}u=I}return Zn(u||fr,f)}return wn}function Yl(a){var u=typeof a;return a===null?"":u==="string"||u==="number"||u==="boolean"?String(a):a instanceof ci||a instanceof ns||a instanceof ks?a.toString():JSON.stringify(a)}ks.prototype.toString=function(){return this.name},ks.fromString=function(a){return a?new ks({name:a,available:!1}):null},ks.prototype.serialize=function(){return["image",this.name]};var Zs=function(a,u){this.type=a,this.value=u};Zs.parse=function(a,u){if(a.length!==2)return u.error("'literal' expression requires exactly one argument, but found "+(a.length-1)+" instead.");if(!ws(a[1]))return u.error("invalid value");var f=a[1],b=Xi(f),S=u.expectedType;return b.kind!=="array"||b.N!==0||!S||S.kind!=="array"||typeof S.N=="number"&&S.N!==0||(b=S),new Zs(b,f)},Zs.prototype.evaluate=function(){return this.value},Zs.prototype.eachChild=function(){},Zs.prototype.outputDefined=function(){return!0},Zs.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ci?["rgba"].concat(this.value.toArray()):this.value instanceof ns?this.value.serialize():this.value};var ms=function(a){this.name="ExpressionEvaluationError",this.message=a};ms.prototype.toJSON=function(){return this.message};var Sa={string:yr,number:Re,boolean:tr,object:wn},Yi=function(a,u){this.type=a,this.args=u};Yi.parse=function(a,u){if(a.length<2)return u.error("Expected at least one argument.");var f,b=1,S=a[0];if(S==="array"){var I,N;if(a.length>2){var H=a[1];if(typeof H!="string"||!(H in Sa)||H==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);I=Sa[H],b++}else I=fr;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return u.error('The length argument to "array" must be a positive integer literal',2);N=a[2],b++}f=Zn(I,N)}else f=Sa[S];for(var Q=[];b<a.length;b++){var rt=u.parse(a[b],b,fr);if(!rt)return null;Q.push(rt)}return new Yi(f,Q)},Yi.prototype.evaluate=function(a){for(var u=0;u<this.args.length;u++){var f=this.args[u].evaluate(a);if(!di(this.type,Xi(f)))return f;if(u===this.args.length-1)throw new ms("Expected value to be of type "+Yn(this.type)+", but found "+Yn(Xi(f))+" instead.")}return null},Yi.prototype.eachChild=function(a){this.args.forEach(a)},Yi.prototype.outputDefined=function(){return this.args.every(function(a){return a.outputDefined()})},Yi.prototype.serialize=function(){var a=this.type,u=[a.kind];if(a.kind==="array"){var f=a.itemType;if(f.kind==="string"||f.kind==="number"||f.kind==="boolean"){u.push(f.kind);var b=a.N;(typeof b=="number"||this.args.length>1)&&u.push(b)}}return u.concat(this.args.map(function(S){return S.serialize()}))};var Ca=function(a){this.type=Ci,this.sections=a};Ca.parse=function(a,u){if(a.length<2)return u.error("Expected at least one argument.");var f=a[1];if(!Array.isArray(f)&&typeof f=="object")return u.error("First argument must be an image or text section.");for(var b=[],S=!1,I=1;I<=a.length-1;++I){var N=a[I];if(S&&typeof N=="object"&&!Array.isArray(N)){S=!1;var H=null;if(N["font-scale"]&&!(H=u.parse(N["font-scale"],1,Re)))return null;var Q=null;if(N["text-font"]&&!(Q=u.parse(N["text-font"],1,Zn(yr))))return null;var rt=null;if(N["text-color"]&&!(rt=u.parse(N["text-color"],1,cr)))return null;var st=b[b.length-1];st.scale=H,st.font=Q,st.textColor=rt}else{var lt=u.parse(a[I],1,fr);if(!lt)return null;var yt=lt.type.kind;if(yt!=="string"&&yt!=="value"&&yt!=="null"&&yt!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");S=!0,b.push({content:lt,scale:null,font:null,textColor:null})}}return new Ca(b)},Ca.prototype.evaluate=function(a){return new ns(this.sections.map(function(u){var f=u.content.evaluate(a);return Xi(f)===Bn?new lh("",f,null,null,null):new lh(Yl(f),null,u.scale?u.scale.evaluate(a):null,u.font?u.font.evaluate(a).join(","):null,u.textColor?u.textColor.evaluate(a):null)}))},Ca.prototype.eachChild=function(a){for(var u=0,f=this.sections;u<f.length;u+=1){var b=f[u];a(b.content),b.scale&&a(b.scale),b.font&&a(b.font),b.textColor&&a(b.textColor)}},Ca.prototype.outputDefined=function(){return!1},Ca.prototype.serialize=function(){for(var a=["format"],u=0,f=this.sections;u<f.length;u+=1){var b=f[u];a.push(b.content.serialize());var S={};b.scale&&(S["font-scale"]=b.scale.serialize()),b.font&&(S["text-font"]=b.font.serialize()),b.textColor&&(S["text-color"]=b.textColor.serialize()),a.push(S)}return a};var Pa=function(a){this.type=Bn,this.input=a};Pa.parse=function(a,u){if(a.length!==2)return u.error("Expected two arguments.");var f=u.parse(a[1],1,yr);return f?new Pa(f):u.error("No image name provided.")},Pa.prototype.evaluate=function(a){var u=this.input.evaluate(a),f=ks.fromString(u);return f&&a.availableImages&&(f.available=a.availableImages.indexOf(u)>-1),f},Pa.prototype.eachChild=function(a){a(this.input)},Pa.prototype.outputDefined=function(){return!1},Pa.prototype.serialize=function(){return["image",this.input.serialize()]};var yA={"to-boolean":tr,"to-color":cr,"to-number":Re,"to-string":yr},fc=function(a,u){this.type=a,this.args=u};fc.parse=function(a,u){if(a.length<2)return u.error("Expected at least one argument.");var f=a[0];if((f==="to-boolean"||f==="to-string")&&a.length!==2)return u.error("Expected one argument.");for(var b=yA[f],S=[],I=1;I<a.length;I++){var N=u.parse(a[I],I,fr);if(!N)return null;S.push(N)}return new fc(b,S)},fc.prototype.evaluate=function(a){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(a));if(this.type.kind==="color"){for(var u,f,b=0,S=this.args;b<S.length;b+=1){if(f=null,(u=S[b].evaluate(a))instanceof ci)return u;if(typeof u=="string"){var I=a.parseColor(u);if(I)return I}else if(Array.isArray(u)&&!(f=u.length<3||u.length>4?"Invalid rbga value "+JSON.stringify(u)+": expected an array containing either three or four numeric values.":tf(u[0],u[1],u[2],u[3])))return new ci(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new ms(f||"Could not parse color from value '"+(typeof u=="string"?u:String(JSON.stringify(u)))+"'")}if(this.type.kind==="number"){for(var N=null,H=0,Q=this.args;H<Q.length;H+=1){if((N=Q[H].evaluate(a))===null)return 0;var rt=Number(N);if(!isNaN(rt))return rt}throw new ms("Could not convert "+JSON.stringify(N)+" to number.")}return this.type.kind==="formatted"?ns.fromString(Yl(this.args[0].evaluate(a))):this.type.kind==="resolvedImage"?ks.fromString(Yl(this.args[0].evaluate(a))):Yl(this.args[0].evaluate(a))},fc.prototype.eachChild=function(a){this.args.forEach(a)},fc.prototype.outputDefined=function(){return this.args.every(function(a){return a.outputDefined()})},fc.prototype.serialize=function(){if(this.type.kind==="formatted")return new Ca([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Pa(this.args[0]).serialize();var a=["to-"+this.type.kind];return this.eachChild(function(u){a.push(u.serialize())}),a};var Rc=["Unknown","Point","LineString","Polygon"],rl=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};rl.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},rl.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Rc[this.feature.type]:this.feature.type:null},rl.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},rl.prototype.canonicalID=function(){return this.canonical},rl.prototype.properties=function(){return this.feature&&this.feature.properties||{}},rl.prototype.parseColor=function(a){var u=this._parseColorCache[a];return u||(u=this._parseColorCache[a]=ci.parse(a)),u};var ko=function(a,u,f,b){this.name=a,this.type=u,this._evaluate=f,this.args=b};ko.prototype.evaluate=function(a){return this._evaluate(a,this.args)},ko.prototype.eachChild=function(a){this.args.forEach(a)},ko.prototype.outputDefined=function(){return!1},ko.prototype.serialize=function(){return[this.name].concat(this.args.map(function(a){return a.serialize()}))},ko.parse=function(a,u){var f,b=a[0],S=ko.definitions[b];if(!S)return u.error('Unknown expression "'+b+'". If you wanted a literal array, use ["literal", [...]].',0);for(var I=Array.isArray(S)?S[0]:S.type,N=Array.isArray(S)?[[S[1],S[2]]]:S.overloads,H=N.filter(function(Zr){var Tr=Zr[0];return!Array.isArray(Tr)||Tr.length===a.length-1}),Q=null,rt=0,st=H;rt<st.length;rt+=1){var lt=st[rt],yt=lt[0],Tt=lt[1];Q=new Ql(u.registry,u.path,null,u.scope);for(var kt=[],Ut=!1,$t=1;$t<a.length;$t++){var qt=a[$t],ie=Array.isArray(yt)?yt[$t-1]:yt.type,de=Q.parse(qt,1+kt.length,ie);if(!de){Ut=!0;break}kt.push(de)}if(!Ut)if(Array.isArray(yt)&&yt.length!==kt.length)Q.error("Expected "+yt.length+" arguments, but found "+kt.length+" instead.");else{for(var ge=0;ge<kt.length;ge++){var we=Array.isArray(yt)?yt[ge]:yt.type,De=kt[ge];Q.concat(ge+1).checkSubtype(we,De.type)}if(Q.errors.length===0)return new ko(b,I,Tt,kt)}}if(H.length===1)(f=u.errors).push.apply(f,Q.errors);else{for(var Ke=(H.length?H:N).map(function(Zr){var Tr;return Tr=Zr[0],Array.isArray(Tr)?"("+Tr.map(Yn).join(", ")+")":"("+Yn(Tr.type)+"...)"}).join(" | "),or=[],Hr=1;Hr<a.length;Hr++){var vr=u.parse(a[Hr],1+or.length);if(!vr)return null;or.push(Yn(vr.type))}u.error("Expected arguments of type "+Ke+", but found ("+or.join(", ")+") instead.")}return null},ko.register=function(a,u){for(var f in ko.definitions=u,u)a[f]=ko};var nl=function(a,u,f){this.type=On,this.locale=f,this.caseSensitive=a,this.diacriticSensitive=u};function $s(a,u){a[0]=Math.min(a[0],u[0]),a[1]=Math.min(a[1],u[1]),a[2]=Math.max(a[2],u[0]),a[3]=Math.max(a[3],u[1])}function Ha(a,u){return!(a[0]<=u[0]||a[2]>=u[2]||a[1]<=u[1]||a[3]>=u[3])}function wu(a,u){var f=(180+a[0])/360,b=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,S=Math.pow(2,u.z);return[Math.round(f*S*8192),Math.round(b*S*8192)]}function Id(a,u,f){return u[1]>a[1]!=f[1]>a[1]&&a[0]<(f[0]-u[0])*(a[1]-u[1])/(f[1]-u[1])+u[0]}function Rd(a,u){for(var f,b,S,I,N,H,Q,rt=!1,st=0,lt=u.length;st<lt;st++)for(var yt=u[st],Tt=0,kt=yt.length;Tt<kt-1;Tt++){if((I=(f=a)[0]-(b=yt[Tt])[0])*(Q=f[1]-(S=yt[Tt+1])[1])-(H=f[0]-S[0])*(N=f[1]-b[1])==0&&I*H<=0&&N*Q<=0)return!1;Id(a,yt[Tt],yt[Tt+1])&&(rt=!rt)}return rt}function ef(a,u){for(var f=0;f<u.length;f++)if(Rd(a,u[f]))return!0;return!1}function Ld(a,u,f,b){var S=b[0]-f[0],I=b[1]-f[1],N=(a[0]-f[0])*I-S*(a[1]-f[1]),H=(u[0]-f[0])*I-S*(u[1]-f[1]);return N>0&&H<0||N<0&&H>0}function Od(a,u,f){for(var b=0,S=f;b<S.length;b+=1)for(var I=S[b],N=0;N<I.length-1;++N)if((lt=[(st=I[N+1])[0]-(rt=I[N])[0],st[1]-rt[1]])[0]*(yt=[(Q=u)[0]-(H=a)[0],Q[1]-H[1]])[1]-lt[1]*yt[0]!=0&&Ld(H,Q,rt,st)&&Ld(rt,st,H,Q))return!0;var H,Q,rt,st,lt,yt;return!1}function Bd(a,u){for(var f=0;f<a.length;++f)if(!Rd(a[f],u))return!1;for(var b=0;b<a.length-1;++b)if(Od(a[b],a[b+1],u))return!1;return!0}function Dd(a,u){for(var f=0;f<u.length;f++)if(Bd(a,u[f]))return!0;return!1}function uh(a,u,f){for(var b=[],S=0;S<a.length;S++){for(var I=[],N=0;N<a[S].length;N++){var H=wu(a[S][N],f);$s(u,H),I.push(H)}b.push(I)}return b}function hp(a,u,f){for(var b=[],S=0;S<a.length;S++){var I=uh(a[S],u,f);b.push(I)}return b}function rf(a,u,f,b){if(a[0]<f[0]||a[0]>f[2]){var S=.5*b,I=a[0]-f[0]>S?-b:f[0]-a[0]>S?b:0;I===0&&(I=a[0]-f[2]>S?-b:f[2]-a[0]>S?b:0),a[0]+=I}$s(u,a)}function xA(a,u,f,b){for(var S=8192*Math.pow(2,b.z),I=[8192*b.x,8192*b.y],N=[],H=0,Q=a;H<Q.length;H+=1)for(var rt=0,st=Q[H];rt<st.length;rt+=1){var lt=st[rt],yt=[lt.x+I[0],lt.y+I[1]];rf(yt,u,f,S),N.push(yt)}return N}function hh(a,u,f,b){for(var S,I=8192*Math.pow(2,b.z),N=[8192*b.x,8192*b.y],H=[],Q=0,rt=a;Q<rt.length;Q+=1){for(var st=[],lt=0,yt=rt[Q];lt<yt.length;lt+=1){var Tt=yt[lt],kt=[Tt.x+N[0],Tt.y+N[1]];$s(u,kt),st.push(kt)}H.push(st)}if(u[2]-u[0]<=I/2){(S=u)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(var Ut=0,$t=H;Ut<$t.length;Ut+=1)for(var qt=0,ie=$t[Ut];qt<ie.length;qt+=1)rf(ie[qt],u,f,I)}return H}nl.parse=function(a,u){if(a.length!==2)return u.error("Expected one argument.");var f=a[1];if(typeof f!="object"||Array.isArray(f))return u.error("Collator options argument must be an object.");var b=u.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,tr);if(!b)return null;var S=u.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,tr);if(!S)return null;var I=null;return f.locale&&!(I=u.parse(f.locale,1,yr))?null:new nl(b,S,I)},nl.prototype.evaluate=function(a){return new pa(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)},nl.prototype.eachChild=function(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)},nl.prototype.outputDefined=function(){return!1},nl.prototype.serialize=function(){var a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]};var pc=function(a,u){this.type=tr,this.geojson=a,this.geometries=u};function Kl(a){if(a instanceof ko&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof pc)return!1;var u=!0;return a.eachChild(function(f){u&&!Kl(f)&&(u=!1)}),u}function Zl(a){if(a instanceof ko&&a.name==="feature-state")return!1;var u=!0;return a.eachChild(function(f){u&&!Zl(f)&&(u=!1)}),u}function Tu(a,u){if(a instanceof ko&&u.indexOf(a.name)>=0)return!1;var f=!0;return a.eachChild(function(b){f&&!Tu(b,u)&&(f=!1)}),f}pc.parse=function(a,u){if(a.length!==2)return u.error("'within' expression requires exactly one argument, but found "+(a.length-1)+" instead.");if(ws(a[1])){var f=a[1];if(f.type==="FeatureCollection")for(var b=0;b<f.features.length;++b){var S=f.features[b].geometry.type;if(S==="Polygon"||S==="MultiPolygon")return new pc(f,f.features[b].geometry)}else if(f.type==="Feature"){var I=f.geometry.type;if(I==="Polygon"||I==="MultiPolygon")return new pc(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new pc(f,f)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")},pc.prototype.evaluate=function(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(u,f){var b=[1/0,1/0,-1/0,-1/0],S=[1/0,1/0,-1/0,-1/0],I=u.canonicalID();if(f.type==="Polygon"){var N=uh(f.coordinates,S,I),H=xA(u.geometry(),b,S,I);if(!Ha(b,S))return!1;for(var Q=0,rt=H;Q<rt.length;Q+=1)if(!Rd(rt[Q],N))return!1}if(f.type==="MultiPolygon"){var st=hp(f.coordinates,S,I),lt=xA(u.geometry(),b,S,I);if(!Ha(b,S))return!1;for(var yt=0,Tt=lt;yt<Tt.length;yt+=1)if(!ef(Tt[yt],st))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(u,f){var b=[1/0,1/0,-1/0,-1/0],S=[1/0,1/0,-1/0,-1/0],I=u.canonicalID();if(f.type==="Polygon"){var N=uh(f.coordinates,S,I),H=hh(u.geometry(),b,S,I);if(!Ha(b,S))return!1;for(var Q=0,rt=H;Q<rt.length;Q+=1)if(!Bd(rt[Q],N))return!1}if(f.type==="MultiPolygon"){var st=hp(f.coordinates,S,I),lt=hh(u.geometry(),b,S,I);if(!Ha(b,S))return!1;for(var yt=0,Tt=lt;yt<Tt.length;yt+=1)if(!Dd(Tt[yt],st))return!1}return!0}(a,this.geometries)}return!1},pc.prototype.eachChild=function(){},pc.prototype.outputDefined=function(){return!0},pc.prototype.serialize=function(){return["within",this.geojson]};var $l=function(a,u){this.type=u.type,this.name=a,this.boundExpression=u};$l.parse=function(a,u){if(a.length!==2||typeof a[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");var f=a[1];return u.scope.has(f)?new $l(f,u.scope.get(f)):u.error('Unknown variable "'+f+'". Make sure "'+f+'" has been bound in an enclosing "let" expression before using it.',1)},$l.prototype.evaluate=function(a){return this.boundExpression.evaluate(a)},$l.prototype.eachChild=function(){},$l.prototype.outputDefined=function(){return!1},$l.prototype.serialize=function(){return["var",this.name]};var Ql=function(a,u,f,b,S){u===void 0&&(u=[]),b===void 0&&(b=new Rr),S===void 0&&(S=[]),this.registry=a,this.path=u,this.key=u.map(function(I){return"["+I+"]"}).join(""),this.scope=b,this.errors=S,this.expectedType=f};function fp(a,u){for(var f,b=a.length-1,S=0,I=b,N=0;S<=I;)if((f=a[N=Math.floor((S+I)/2)])<=u){if(N===b||u<a[N+1])return N;S=N+1}else{if(!(f>u))throw new ms("Input is not a number.");I=N-1}return 0}Ql.prototype.parse=function(a,u,f,b,S){return S===void 0&&(S={}),u?this.concat(u,f,b)._parse(a,S):this._parse(a,S)},Ql.prototype._parse=function(a,u){function f(rt,st,lt){return lt==="assert"?new Yi(st,[rt]):lt==="coerce"?new fc(st,[rt]):rt}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var b=a[0];if(typeof b!="string")return this.error("Expression name must be a string, but found "+typeof b+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var S=this.registry[b];if(S){var I=S.parse(a,this);if(!I)return null;if(this.expectedType){var N=this.expectedType,H=I.type;if(N.kind!=="string"&&N.kind!=="number"&&N.kind!=="boolean"&&N.kind!=="object"&&N.kind!=="array"||H.kind!=="value")if(N.kind!=="color"&&N.kind!=="formatted"&&N.kind!=="resolvedImage"||H.kind!=="value"&&H.kind!=="string"){if(this.checkSubtype(N,H))return null}else I=f(I,N,u.typeAnnotation||"coerce");else I=f(I,N,u.typeAnnotation||"assert")}if(!(I instanceof Zs)&&I.type.kind!=="resolvedImage"&&function rt(st){if(st instanceof $l)return rt(st.boundExpression);if(st instanceof ko&&st.name==="error"||st instanceof nl||st instanceof pc)return!1;var lt=st instanceof fc||st instanceof Yi,yt=!0;return st.eachChild(function(Tt){yt=lt?yt&&rt(Tt):yt&&Tt instanceof Zs}),!!yt&&Kl(st)&&Tu(st,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(I)){var Q=new rl;try{I=new Zs(I.type,I.evaluate(Q))}catch(rt){return this.error(rt.message),null}}return I}return this.error('Unknown expression "'+b+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof a+" instead.")},Ql.prototype.concat=function(a,u,f){var b=typeof a=="number"?this.path.concat(a):this.path,S=f?this.scope.concat(f):this.scope;return new Ql(this.registry,b,u||null,S,this.errors)},Ql.prototype.error=function(a){for(var u=[],f=arguments.length-1;f-- >0;)u[f]=arguments[f+1];var b=""+this.key+u.map(function(S){return"["+S+"]"}).join("");this.errors.push(new We(b,a))},Ql.prototype.checkSubtype=function(a,u){var f=di(a,u);return f&&this.error(f),f};var da=function(a,u,f){this.type=a,this.input=u,this.labels=[],this.outputs=[];for(var b=0,S=f;b<S.length;b+=1){var I=S[b],N=I[1];this.labels.push(I[0]),this.outputs.push(N)}};function xo(a,u,f){return a*(1-f)+u*f}da.parse=function(a,u){if(a.length-1<4)return u.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if((a.length-1)%2!=0)return u.error("Expected an even number of arguments.");var f=u.parse(a[1],1,Re);if(!f)return null;var b=[],S=null;u.expectedType&&u.expectedType.kind!=="value"&&(S=u.expectedType);for(var I=1;I<a.length;I+=2){var N=I===1?-1/0:a[I],H=a[I+1],Q=I,rt=I+1;if(typeof N!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Q);if(b.length&&b[b.length-1][0]>=N)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Q);var st=u.parse(H,rt,S);if(!st)return null;S=S||st.type,b.push([N,st])}return new da(S,f,b)},da.prototype.evaluate=function(a){var u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(a);var b=this.input.evaluate(a);if(b<=u[0])return f[0].evaluate(a);var S=u.length;return b>=u[S-1]?f[S-1].evaluate(a):f[fp(u,b)].evaluate(a)},da.prototype.eachChild=function(a){a(this.input);for(var u=0,f=this.outputs;u<f.length;u+=1)a(f[u])},da.prototype.outputDefined=function(){return this.outputs.every(function(a){return a.outputDefined()})},da.prototype.serialize=function(){for(var a=["step",this.input.serialize()],u=0;u<this.labels.length;u++)u>0&&a.push(this.labels[u]),a.push(this.outputs[u].serialize());return a};var Eu=Object.freeze({__proto__:null,number:xo,color:function(a,u,f){return new ci(xo(a.r,u.r,f),xo(a.g,u.g,f),xo(a.b,u.b,f),xo(a.a,u.a,f))},array:function(a,u,f){return a.map(function(b,S){return xo(b,u[S],f)})}}),pp=6/29*3*(6/29),vA=Math.PI/180,bA=180/Math.PI;function nf(a){return a>.008856451679035631?Math.pow(a,1/3):a/pp+4/29}function Nd(a){return a>6/29?a*a*a:pp*(a-4/29)}function kd(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function Fd(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function fh(a){var u=Fd(a.r),f=Fd(a.g),b=Fd(a.b),S=nf((.4124564*u+.3575761*f+.1804375*b)/.95047),I=nf((.2126729*u+.7151522*f+.072175*b)/1);return{l:116*I-16,a:500*(S-I),b:200*(I-nf((.0193339*u+.119192*f+.9503041*b)/1.08883)),alpha:a.a}}function zd(a){var u=(a.l+16)/116,f=isNaN(a.a)?u:u+a.a/500,b=isNaN(a.b)?u:u-a.b/200;return u=1*Nd(u),f=.95047*Nd(f),b=1.08883*Nd(b),new ci(kd(3.2404542*f-1.5371385*u-.4985314*b),kd(-.969266*f+1.8760108*u+.041556*b),kd(.0556434*f-.2040259*u+1.0572252*b),a.alpha)}function Ud(a,u,f){var b=u-a;return a+f*(b>180||b<-180?b-360*Math.round(b/360):b)}var of={forward:fh,reverse:zd,interpolate:function(a,u,f){return{l:xo(a.l,u.l,f),a:xo(a.a,u.a,f),b:xo(a.b,u.b,f),alpha:xo(a.alpha,u.alpha,f)}}},sf={forward:function(a){var u=fh(a),f=u.l,b=u.a,S=u.b,I=Math.atan2(S,b)*bA;return{h:I<0?I+360:I,c:Math.sqrt(b*b+S*S),l:f,alpha:a.a}},reverse:function(a){var u=a.h*vA,f=a.c;return zd({l:a.l,a:Math.cos(u)*f,b:Math.sin(u)*f,alpha:a.alpha})},interpolate:function(a,u,f){return{h:Ud(a.h,u.h,f),c:xo(a.c,u.c,f),l:xo(a.l,u.l,f),alpha:xo(a.alpha,u.alpha,f)}}},wA=Object.freeze({__proto__:null,lab:of,hcl:sf}),R=function(a,u,f,b,S){this.type=a,this.operator=u,this.interpolation=f,this.input=b,this.labels=[],this.outputs=[];for(var I=0,N=S;I<N.length;I+=1){var H=N[I],Q=H[1];this.labels.push(H[0]),this.outputs.push(Q)}};function V(a,u,f,b){var S=b-f,I=a-f;return S===0?0:u===1?I/S:(Math.pow(u,I)-1)/(Math.pow(u,S)-1)}R.interpolationFactor=function(a,u,f,b){var S=0;if(a.name==="exponential")S=V(u,a.base,f,b);else if(a.name==="linear")S=V(u,1,f,b);else if(a.name==="cubic-bezier"){var I=a.controlPoints;S=new s(I[0],I[1],I[2],I[3]).solve(V(u,1,f,b))}return S},R.parse=function(a,u){var f=a[0],b=a[1],S=a[2],I=a.slice(3);if(!Array.isArray(b)||b.length===0)return u.error("Expected an interpolation type expression.",1);if(b[0]==="linear")b={name:"linear"};else if(b[0]==="exponential"){var N=b[1];if(typeof N!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);b={name:"exponential",base:N}}else{if(b[0]!=="cubic-bezier")return u.error("Unknown interpolation type "+String(b[0]),1,0);var H=b.slice(1);if(H.length!==4||H.some(function($t){return typeof $t!="number"||$t<0||$t>1}))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);b={name:"cubic-bezier",controlPoints:H}}if(a.length-1<4)return u.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if((a.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(!(S=u.parse(S,2,Re)))return null;var Q=[],rt=null;f==="interpolate-hcl"||f==="interpolate-lab"?rt=cr:u.expectedType&&u.expectedType.kind!=="value"&&(rt=u.expectedType);for(var st=0;st<I.length;st+=2){var lt=I[st],yt=I[st+1],Tt=st+3,kt=st+4;if(typeof lt!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Tt);if(Q.length&&Q[Q.length-1][0]>=lt)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Tt);var Ut=u.parse(yt,kt,rt);if(!Ut)return null;rt=rt||Ut.type,Q.push([lt,Ut])}return rt.kind==="number"||rt.kind==="color"||rt.kind==="array"&&rt.itemType.kind==="number"&&typeof rt.N=="number"?new R(rt,f,b,S,Q):u.error("Type "+Yn(rt)+" is not interpolatable.")},R.prototype.evaluate=function(a){var u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(a);var b=this.input.evaluate(a);if(b<=u[0])return f[0].evaluate(a);var S=u.length;if(b>=u[S-1])return f[S-1].evaluate(a);var I=fp(u,b),N=R.interpolationFactor(this.interpolation,b,u[I],u[I+1]),H=f[I].evaluate(a),Q=f[I+1].evaluate(a);return this.operator==="interpolate"?Eu[this.type.kind.toLowerCase()](H,Q,N):this.operator==="interpolate-hcl"?sf.reverse(sf.interpolate(sf.forward(H),sf.forward(Q),N)):of.reverse(of.interpolate(of.forward(H),of.forward(Q),N))},R.prototype.eachChild=function(a){a(this.input);for(var u=0,f=this.outputs;u<f.length;u+=1)a(f[u])},R.prototype.outputDefined=function(){return this.outputs.every(function(a){return a.outputDefined()})},R.prototype.serialize=function(){var a;a=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var u=[this.operator,a,this.input.serialize()],f=0;f<this.labels.length;f++)u.push(this.labels[f],this.outputs[f].serialize());return u};var Y=function(a,u){this.type=a,this.args=u};Y.parse=function(a,u){if(a.length<2)return u.error("Expectected at least one argument.");var f=null,b=u.expectedType;b&&b.kind!=="value"&&(f=b);for(var S=[],I=0,N=a.slice(1);I<N.length;I+=1){var H=u.parse(N[I],1+S.length,f,void 0,{typeAnnotation:"omit"});if(!H)return null;f=f||H.type,S.push(H)}var Q=b&&S.some(function(rt){return di(b,rt.type)});return new Y(Q?fr:f,S)},Y.prototype.evaluate=function(a){for(var u,f=null,b=0,S=0,I=this.args;S<I.length&&(b++,(f=I[S].evaluate(a))&&f instanceof ks&&!f.available&&(u||(u=f.name),f=null,b===this.args.length&&(f=u)),f===null);S+=1);return f},Y.prototype.eachChild=function(a){this.args.forEach(a)},Y.prototype.outputDefined=function(){return this.args.every(function(a){return a.outputDefined()})},Y.prototype.serialize=function(){var a=["coalesce"];return this.eachChild(function(u){a.push(u.serialize())}),a};var tt=function(a,u){this.type=u.type,this.bindings=[].concat(a),this.result=u};tt.prototype.evaluate=function(a){return this.result.evaluate(a)},tt.prototype.eachChild=function(a){for(var u=0,f=this.bindings;u<f.length;u+=1)a(f[u][1]);a(this.result)},tt.parse=function(a,u){if(a.length<4)return u.error("Expected at least 3 arguments, but found "+(a.length-1)+" instead.");for(var f=[],b=1;b<a.length-1;b+=2){var S=a[b];if(typeof S!="string")return u.error("Expected string, but found "+typeof S+" instead.",b);if(/[^a-zA-Z0-9_]/.test(S))return u.error("Variable names must contain only alphanumeric characters or '_'.",b);var I=u.parse(a[b+1],b+1);if(!I)return null;f.push([S,I])}var N=u.parse(a[a.length-1],a.length-1,u.expectedType,f);return N?new tt(f,N):null},tt.prototype.outputDefined=function(){return this.result.outputDefined()},tt.prototype.serialize=function(){for(var a=["let"],u=0,f=this.bindings;u<f.length;u+=1){var b=f[u];a.push(b[0],b[1].serialize())}return a.push(this.result.serialize()),a};var ht=function(a,u,f){this.type=a,this.index=u,this.input=f};ht.parse=function(a,u){if(a.length!==3)return u.error("Expected 2 arguments, but found "+(a.length-1)+" instead.");var f=u.parse(a[1],1,Re),b=u.parse(a[2],2,Zn(u.expectedType||fr));return f&&b?new ht(b.type.itemType,f,b):null},ht.prototype.evaluate=function(a){var u=this.index.evaluate(a),f=this.input.evaluate(a);if(u<0)throw new ms("Array index out of bounds: "+u+" < 0.");if(u>=f.length)throw new ms("Array index out of bounds: "+u+" > "+(f.length-1)+".");if(u!==Math.floor(u))throw new ms("Array index must be an integer, but found "+u+" instead.");return f[u]},ht.prototype.eachChild=function(a){a(this.index),a(this.input)},ht.prototype.outputDefined=function(){return!1},ht.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var ft=function(a,u){this.type=tr,this.needle=a,this.haystack=u};ft.parse=function(a,u){if(a.length!==3)return u.error("Expected 2 arguments, but found "+(a.length-1)+" instead.");var f=u.parse(a[1],1,fr),b=u.parse(a[2],2,fr);return f&&b?yo(f.type,[tr,yr,Re,Cr,fr])?new ft(f,b):u.error("Expected first argument to be of type boolean, string, number or null, but found "+Yn(f.type)+" instead"):null},ft.prototype.evaluate=function(a){var u=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(!f)return!1;if(!Pi(u,["boolean","string","number","null"]))throw new ms("Expected first argument to be of type boolean, string, number or null, but found "+Yn(Xi(u))+" instead.");if(!Pi(f,["string","array"]))throw new ms("Expected second argument to be of type array or string, but found "+Yn(Xi(f))+" instead.");return f.indexOf(u)>=0},ft.prototype.eachChild=function(a){a(this.needle),a(this.haystack)},ft.prototype.outputDefined=function(){return!0},ft.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var xt=function(a,u,f){this.type=Re,this.needle=a,this.haystack=u,this.fromIndex=f};xt.parse=function(a,u){if(a.length<=2||a.length>=5)return u.error("Expected 3 or 4 arguments, but found "+(a.length-1)+" instead.");var f=u.parse(a[1],1,fr),b=u.parse(a[2],2,fr);if(!f||!b)return null;if(!yo(f.type,[tr,yr,Re,Cr,fr]))return u.error("Expected first argument to be of type boolean, string, number or null, but found "+Yn(f.type)+" instead");if(a.length===4){var S=u.parse(a[3],3,Re);return S?new xt(f,b,S):null}return new xt(f,b)},xt.prototype.evaluate=function(a){var u=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(!Pi(u,["boolean","string","number","null"]))throw new ms("Expected first argument to be of type boolean, string, number or null, but found "+Yn(Xi(u))+" instead.");if(!Pi(f,["string","array"]))throw new ms("Expected second argument to be of type array or string, but found "+Yn(Xi(f))+" instead.");if(this.fromIndex){var b=this.fromIndex.evaluate(a);return f.indexOf(u,b)}return f.indexOf(u)},xt.prototype.eachChild=function(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)},xt.prototype.outputDefined=function(){return!1},xt.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var a=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),a]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Kt=function(a,u,f,b,S,I){this.inputType=a,this.type=u,this.input=f,this.cases=b,this.outputs=S,this.otherwise=I};Kt.parse=function(a,u){if(a.length<5)return u.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if(a.length%2!=1)return u.error("Expected an even number of arguments.");var f,b;u.expectedType&&u.expectedType.kind!=="value"&&(b=u.expectedType);for(var S={},I=[],N=2;N<a.length-1;N+=2){var H=a[N],Q=a[N+1];Array.isArray(H)||(H=[H]);var rt=u.concat(N);if(H.length===0)return rt.error("Expected at least one branch label.");for(var st=0,lt=H;st<lt.length;st+=1){var yt=lt[st];if(typeof yt!="number"&&typeof yt!="string")return rt.error("Branch labels must be numbers or strings.");if(typeof yt=="number"&&Math.abs(yt)>Number.MAX_SAFE_INTEGER)return rt.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof yt=="number"&&Math.floor(yt)!==yt)return rt.error("Numeric branch labels must be integer values.");if(f){if(rt.checkSubtype(f,Xi(yt)))return null}else f=Xi(yt);if(S[String(yt)]!==void 0)return rt.error("Branch labels must be unique.");S[String(yt)]=I.length}var Tt=u.parse(Q,N,b);if(!Tt)return null;b=b||Tt.type,I.push(Tt)}var kt=u.parse(a[1],1,fr);if(!kt)return null;var Ut=u.parse(a[a.length-1],a.length-1,b);return Ut?kt.type.kind!=="value"&&u.concat(1).checkSubtype(f,kt.type)?null:new Kt(f,b,kt,S,I,Ut):null},Kt.prototype.evaluate=function(a){var u=this.input.evaluate(a);return(Xi(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(a)},Kt.prototype.eachChild=function(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)},Kt.prototype.outputDefined=function(){return this.outputs.every(function(a){return a.outputDefined()})&&this.otherwise.outputDefined()},Kt.prototype.serialize=function(){for(var a=this,u=["match",this.input.serialize()],f=[],b={},S=0,I=Object.keys(this.cases).sort();S<I.length;S+=1){var N=I[S];(lt=b[this.cases[N]])===void 0?(b[this.cases[N]]=f.length,f.push([this.cases[N],[N]])):f[lt][1].push(N)}for(var H=function(Tt){return a.inputType.kind==="number"?Number(Tt):Tt},Q=0,rt=f;Q<rt.length;Q+=1){var st=rt[Q],lt=st[0],yt=st[1];u.push(yt.length===1?H(yt[0]):yt.map(H)),u.push(this.outputs[outputIndex$1].serialize())}return u.push(this.otherwise.serialize()),u};var Wt=function(a,u,f){this.type=a,this.branches=u,this.otherwise=f};Wt.parse=function(a,u){if(a.length<4)return u.error("Expected at least 3 arguments, but found only "+(a.length-1)+".");if(a.length%2!=0)return u.error("Expected an odd number of arguments.");var f;u.expectedType&&u.expectedType.kind!=="value"&&(f=u.expectedType);for(var b=[],S=1;S<a.length-1;S+=2){var I=u.parse(a[S],S,tr);if(!I)return null;var N=u.parse(a[S+1],S+1,f);if(!N)return null;b.push([I,N]),f=f||N.type}var H=u.parse(a[a.length-1],a.length-1,f);return H?new Wt(f,b,H):null},Wt.prototype.evaluate=function(a){for(var u=0,f=this.branches;u<f.length;u+=1){var b=f[u],S=b[1];if(b[0].evaluate(a))return S.evaluate(a)}return this.otherwise.evaluate(a)},Wt.prototype.eachChild=function(a){for(var u=0,f=this.branches;u<f.length;u+=1){var b=f[u],S=b[1];a(b[0]),a(S)}a(this.otherwise)},Wt.prototype.outputDefined=function(){return this.branches.every(function(a){return a[1].outputDefined()})&&this.otherwise.outputDefined()},Wt.prototype.serialize=function(){var a=["case"];return this.eachChild(function(u){a.push(u.serialize())}),a};var oe=function(a,u,f,b){this.type=a,this.input=u,this.beginIndex=f,this.endIndex=b};function Oe(a,u){return a==="=="||a==="!="?u.kind==="boolean"||u.kind==="string"||u.kind==="number"||u.kind==="null"||u.kind==="value":u.kind==="string"||u.kind==="number"||u.kind==="value"}function Fe(a,u,f,b){return b.compare(u,f)===0}function ae(a,u,f){var b=a!=="=="&&a!=="!=";return function(){function S(I,N,H){this.type=tr,this.lhs=I,this.rhs=N,this.collator=H,this.hasUntypedArgument=I.type.kind==="value"||N.type.kind==="value"}return S.parse=function(I,N){if(I.length!==3&&I.length!==4)return N.error("Expected two or three arguments.");var H=I[0],Q=N.parse(I[1],1,fr);if(!Q)return null;if(!Oe(H,Q.type))return N.concat(1).error('"'+H+`" comparisons are not supported for type '`+Yn(Q.type)+"'.");var rt=N.parse(I[2],2,fr);if(!rt)return null;if(!Oe(H,rt.type))return N.concat(2).error('"'+H+`" comparisons are not supported for type '`+Yn(rt.type)+"'.");if(Q.type.kind!==rt.type.kind&&Q.type.kind!=="value"&&rt.type.kind!=="value")return N.error("Cannot compare types '"+Yn(Q.type)+"' and '"+Yn(rt.type)+"'.");b&&(Q.type.kind==="value"&&rt.type.kind!=="value"?Q=new Yi(rt.type,[Q]):Q.type.kind!=="value"&&rt.type.kind==="value"&&(rt=new Yi(Q.type,[rt])));var st=null;if(I.length===4){if(Q.type.kind!=="string"&&rt.type.kind!=="string"&&Q.type.kind!=="value"&&rt.type.kind!=="value")return N.error("Cannot use collator to compare non-string types.");if(!(st=N.parse(I[3],3,On)))return null}return new S(Q,rt,st)},S.prototype.evaluate=function(I){var N=this.lhs.evaluate(I),H=this.rhs.evaluate(I);if(b&&this.hasUntypedArgument){var Q=Xi(N),rt=Xi(H);if(Q.kind!==rt.kind||Q.kind!=="string"&&Q.kind!=="number")throw new ms('Expected arguments for "'+a+'" to be (string, string) or (number, number), but found ('+Q.kind+", "+rt.kind+") instead.")}if(this.collator&&!b&&this.hasUntypedArgument){var st=Xi(N),lt=Xi(H);if(st.kind!=="string"||lt.kind!=="string")return u(I,N,H)}return this.collator?f(I,N,H,this.collator.evaluate(I)):u(I,N,H)},S.prototype.eachChild=function(I){I(this.lhs),I(this.rhs),this.collator&&I(this.collator)},S.prototype.outputDefined=function(){return!0},S.prototype.serialize=function(){var I=[a];return this.eachChild(function(N){I.push(N.serialize())}),I},S}()}oe.parse=function(a,u){if(a.length<=2||a.length>=5)return u.error("Expected 3 or 4 arguments, but found "+(a.length-1)+" instead.");var f=u.parse(a[1],1,fr),b=u.parse(a[2],2,Re);if(!f||!b)return null;if(!yo(f.type,[Zn(fr),yr,fr]))return u.error("Expected first argument to be of type array or string, but found "+Yn(f.type)+" instead");if(a.length===4){var S=u.parse(a[3],3,Re);return S?new oe(f.type,f,b,S):null}return new oe(f.type,f,b)},oe.prototype.evaluate=function(a){var u=this.input.evaluate(a),f=this.beginIndex.evaluate(a);if(!Pi(u,["string","array"]))throw new ms("Expected first argument to be of type array or string, but found "+Yn(Xi(u))+" instead.");if(this.endIndex){var b=this.endIndex.evaluate(a);return u.slice(f,b)}return u.slice(f)},oe.prototype.eachChild=function(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)},oe.prototype.outputDefined=function(){return!1},oe.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var a=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),a]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var rr=ae("==",function(a,u,f){return u===f},Fe),fn=ae("!=",function(a,u,f){return u!==f},function(a,u,f,b){return!Fe(0,u,f,b)}),se=ae("<",function(a,u,f){return u<f},function(a,u,f,b){return b.compare(u,f)<0}),ve=ae(">",function(a,u,f){return u>f},function(a,u,f,b){return b.compare(u,f)>0}),er=ae("<=",function(a,u,f){return u<=f},function(a,u,f,b){return b.compare(u,f)<=0}),jr=ae(">=",function(a,u,f){return u>=f},function(a,u,f,b){return b.compare(u,f)>=0}),_=function(a,u,f,b,S){this.type=yr,this.number=a,this.locale=u,this.currency=f,this.minFractionDigits=b,this.maxFractionDigits=S};_.parse=function(a,u){if(a.length!==3)return u.error("Expected two arguments.");var f=u.parse(a[1],1,Re);if(!f)return null;var b=a[2];if(typeof b!="object"||Array.isArray(b))return u.error("NumberFormat options argument must be an object.");var S=null;if(b.locale&&!(S=u.parse(b.locale,1,yr)))return null;var I=null;if(b.currency&&!(I=u.parse(b.currency,1,yr)))return null;var N=null;if(b["min-fraction-digits"]&&!(N=u.parse(b["min-fraction-digits"],1,Re)))return null;var H=null;return b["max-fraction-digits"]&&!(H=u.parse(b["max-fraction-digits"],1,Re))?null:new _(f,S,I,N,H)},_.prototype.evaluate=function(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))},_.prototype.eachChild=function(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)},_.prototype.outputDefined=function(){return!1},_.prototype.serialize=function(){var a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]};var Pn=function(a){this.type=Re,this.input=a};Pn.parse=function(a,u){if(a.length!==2)return u.error("Expected 1 argument, but found "+(a.length-1)+" instead.");var f=u.parse(a[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?u.error("Expected argument of type string or array, but found "+Yn(f.type)+" instead."):new Pn(f):null},Pn.prototype.evaluate=function(a){var u=this.input.evaluate(a);if(typeof u=="string"||Array.isArray(u))return u.length;throw new ms("Expected value to be of type string or array, but found "+Yn(Xi(u))+" instead.")},Pn.prototype.eachChild=function(a){a(this.input)},Pn.prototype.outputDefined=function(){return!1},Pn.prototype.serialize=function(){var a=["length"];return this.eachChild(function(u){a.push(u.serialize())}),a};var Ur={"==":rr,"!=":fn,">":ve,"<":se,">=":jr,"<=":er,array:Yi,at:ht,boolean:Yi,case:Wt,coalesce:Y,collator:nl,format:Ca,image:Pa,in:ft,"index-of":xt,interpolate:R,"interpolate-hcl":R,"interpolate-lab":R,length:Pn,let:tt,literal:Zs,match:Kt,number:Yi,"number-format":_,object:Yi,slice:oe,step:da,string:Yi,"to-boolean":fc,"to-color":fc,"to-number":fc,"to-string":fc,var:$l,within:pc};function Rt(a,u){var f=u[0],b=u[1],S=u[2],I=u[3];f=f.evaluate(a),b=b.evaluate(a),S=S.evaluate(a);var N=I?I.evaluate(a):1,H=tf(f,b,S,N);if(H)throw new ms(H);return new ci(f/255*N,b/255*N,S/255*N,N)}function gn(a,u){return a in u}function ni(a,u){var f=u[a];return f===void 0?null:f}function ji(a){return{type:a}}function mi(a){return{result:"success",value:a}}function $n(a){return{result:"error",value:a}}function Hi(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function Nn(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function kn(a){return!!a.expression&&a.expression.interpolated}function Kn(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function Qs(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function dp(a){return a}function Fs(a,u,f){return a!==void 0?a:u!==void 0?u:f!==void 0?f:void 0}function Fo(a,u,f,b,S){return Fs(typeof f===S?b[f]:void 0,a.default,u.default)}function Mu(a,u,f){if(Kn(f)!=="number")return Fs(a.default,u.default);var b=a.stops.length;if(b===1||f<=a.stops[0][0])return a.stops[0][1];if(f>=a.stops[b-1][0])return a.stops[b-1][1];var S=fp(a.stops.map(function(I){return I[0]}),f);return a.stops[S][1]}function dc(a,u,f){var b=a.base!==void 0?a.base:1;if(Kn(f)!=="number")return Fs(a.default,u.default);var S=a.stops.length;if(S===1||f<=a.stops[0][0])return a.stops[0][1];if(f>=a.stops[S-1][0])return a.stops[S-1][1];var I=fp(a.stops.map(function(lt){return lt[0]}),f),N=function(lt,yt,Tt,kt){var Ut=kt-Tt,$t=lt-Tt;return Ut===0?0:yt===1?$t/Ut:(Math.pow(yt,$t)-1)/(Math.pow(yt,Ut)-1)}(f,b,a.stops[I][0],a.stops[I+1][0]),H=a.stops[I][1],Q=a.stops[I+1][1],rt=Eu[u.type]||dp;if(a.colorSpace&&a.colorSpace!=="rgb"){var st=wA[a.colorSpace];rt=function(lt,yt){return st.reverse(st.interpolate(st.forward(lt),st.forward(yt),N))}}return typeof H.evaluate=="function"?{evaluate:function(){for(var lt=[],yt=arguments.length;yt--;)lt[yt]=arguments[yt];var Tt=H.evaluate.apply(void 0,lt),kt=Q.evaluate.apply(void 0,lt);if(Tt!==void 0&&kt!==void 0)return rt(Tt,kt,N)}}:rt(H,Q,N)}function Su(a,u,f){return u.type==="color"?f=ci.parse(f):u.type==="formatted"?f=ns.fromString(f.toString()):u.type==="resolvedImage"?f=ks.fromString(f.toString()):Kn(f)===u.type||u.type==="enum"&&u.values[f]||(f=void 0),Fs(f,a.default,u.default)}ko.register(Ur,{error:[{kind:"error"},[yr],function(a,u){throw new ms(u[0].evaluate(a))}],typeof:[yr,[fr],function(a,u){return Yn(Xi(u[0].evaluate(a)))}],"to-rgba":[Zn(Re,4),[cr],function(a,u){return u[0].evaluate(a).toArray()}],rgb:[cr,[Re,Re,Re],Rt],rgba:[cr,[Re,Re,Re,Re],Rt],has:{type:tr,overloads:[[[yr],function(a,u){return gn(u[0].evaluate(a),a.properties())}],[[yr,wn],function(a,u){var f=u[1];return gn(u[0].evaluate(a),f.evaluate(a))}]]},get:{type:fr,overloads:[[[yr],function(a,u){return ni(u[0].evaluate(a),a.properties())}],[[yr,wn],function(a,u){var f=u[1];return ni(u[0].evaluate(a),f.evaluate(a))}]]},"feature-state":[fr,[yr],function(a,u){return ni(u[0].evaluate(a),a.featureState||{})}],properties:[wn,[],function(a){return a.properties()}],"geometry-type":[yr,[],function(a){return a.geometryType()}],id:[fr,[],function(a){return a.id()}],zoom:[Re,[],function(a){return a.globals.zoom}],"heatmap-density":[Re,[],function(a){return a.globals.heatmapDensity||0}],"line-progress":[Re,[],function(a){return a.globals.lineProgress||0}],accumulated:[fr,[],function(a){return a.globals.accumulated===void 0?null:a.globals.accumulated}],"+":[Re,ji(Re),function(a,u){for(var f=0,b=0,S=u;b<S.length;b+=1)f+=S[b].evaluate(a);return f}],"*":[Re,ji(Re),function(a,u){for(var f=1,b=0,S=u;b<S.length;b+=1)f*=S[b].evaluate(a);return f}],"-":{type:Re,overloads:[[[Re,Re],function(a,u){var f=u[1];return u[0].evaluate(a)-f.evaluate(a)}],[[Re],function(a,u){return-u[0].evaluate(a)}]]},"/":[Re,[Re,Re],function(a,u){var f=u[1];return u[0].evaluate(a)/f.evaluate(a)}],"%":[Re,[Re,Re],function(a,u){var f=u[1];return u[0].evaluate(a)%f.evaluate(a)}],ln2:[Re,[],function(){return Math.LN2}],pi:[Re,[],function(){return Math.PI}],e:[Re,[],function(){return Math.E}],"^":[Re,[Re,Re],function(a,u){var f=u[1];return Math.pow(u[0].evaluate(a),f.evaluate(a))}],sqrt:[Re,[Re],function(a,u){return Math.sqrt(u[0].evaluate(a))}],log10:[Re,[Re],function(a,u){return Math.log(u[0].evaluate(a))/Math.LN10}],ln:[Re,[Re],function(a,u){return Math.log(u[0].evaluate(a))}],log2:[Re,[Re],function(a,u){return Math.log(u[0].evaluate(a))/Math.LN2}],sin:[Re,[Re],function(a,u){return Math.sin(u[0].evaluate(a))}],cos:[Re,[Re],function(a,u){return Math.cos(u[0].evaluate(a))}],tan:[Re,[Re],function(a,u){return Math.tan(u[0].evaluate(a))}],asin:[Re,[Re],function(a,u){return Math.asin(u[0].evaluate(a))}],acos:[Re,[Re],function(a,u){return Math.acos(u[0].evaluate(a))}],atan:[Re,[Re],function(a,u){return Math.atan(u[0].evaluate(a))}],min:[Re,ji(Re),function(a,u){return Math.min.apply(Math,u.map(function(f){return f.evaluate(a)}))}],max:[Re,ji(Re),function(a,u){return Math.max.apply(Math,u.map(function(f){return f.evaluate(a)}))}],abs:[Re,[Re],function(a,u){return Math.abs(u[0].evaluate(a))}],round:[Re,[Re],function(a,u){var f=u[0].evaluate(a);return f<0?-Math.round(-f):Math.round(f)}],floor:[Re,[Re],function(a,u){return Math.floor(u[0].evaluate(a))}],ceil:[Re,[Re],function(a,u){return Math.ceil(u[0].evaluate(a))}],"filter-==":[tr,[yr,fr],function(a,u){var f=u[0],b=u[1];return a.properties()[f.value]===b.value}],"filter-id-==":[tr,[fr],function(a,u){var f=u[0];return a.id()===f.value}],"filter-type-==":[tr,[yr],function(a,u){var f=u[0];return a.geometryType()===f.value}],"filter-<":[tr,[yr,fr],function(a,u){var f=u[0],b=u[1],S=a.properties()[f.value],I=b.value;return typeof S==typeof I&&S<I}],"filter-id-<":[tr,[fr],function(a,u){var f=u[0],b=a.id(),S=f.value;return typeof b==typeof S&&b<S}],"filter->":[tr,[yr,fr],function(a,u){var f=u[0],b=u[1],S=a.properties()[f.value],I=b.value;return typeof S==typeof I&&S>I}],"filter-id->":[tr,[fr],function(a,u){var f=u[0],b=a.id(),S=f.value;return typeof b==typeof S&&b>S}],"filter-<=":[tr,[yr,fr],function(a,u){var f=u[0],b=u[1],S=a.properties()[f.value],I=b.value;return typeof S==typeof I&&S<=I}],"filter-id-<=":[tr,[fr],function(a,u){var f=u[0],b=a.id(),S=f.value;return typeof b==typeof S&&b<=S}],"filter->=":[tr,[yr,fr],function(a,u){var f=u[0],b=u[1],S=a.properties()[f.value],I=b.value;return typeof S==typeof I&&S>=I}],"filter-id->=":[tr,[fr],function(a,u){var f=u[0],b=a.id(),S=f.value;return typeof b==typeof S&&b>=S}],"filter-has":[tr,[fr],function(a,u){return u[0].value in a.properties()}],"filter-has-id":[tr,[],function(a){return a.id()!==null&&a.id()!==void 0}],"filter-type-in":[tr,[Zn(yr)],function(a,u){return u[0].value.indexOf(a.geometryType())>=0}],"filter-id-in":[tr,[Zn(fr)],function(a,u){return u[0].value.indexOf(a.id())>=0}],"filter-in-small":[tr,[yr,Zn(fr)],function(a,u){var f=u[0];return u[1].value.indexOf(a.properties()[f.value])>=0}],"filter-in-large":[tr,[yr,Zn(fr)],function(a,u){var f=u[0],b=u[1];return function(S,I,N,H){for(;N<=H;){var Q=N+H>>1;if(I[Q]===S)return!0;I[Q]>S?H=Q-1:N=Q+1}return!1}(a.properties()[f.value],b.value,0,b.value.length-1)}],all:{type:tr,overloads:[[[tr,tr],function(a,u){var f=u[1];return u[0].evaluate(a)&&f.evaluate(a)}],[ji(tr),function(a,u){for(var f=0,b=u;f<b.length;f+=1)if(!b[f].evaluate(a))return!1;return!0}]]},any:{type:tr,overloads:[[[tr,tr],function(a,u){var f=u[1];return u[0].evaluate(a)||f.evaluate(a)}],[ji(tr),function(a,u){for(var f=0,b=u;f<b.length;f+=1)if(b[f].evaluate(a))return!0;return!1}]]},"!":[tr,[tr],function(a,u){return!u[0].evaluate(a)}],"is-supported-script":[tr,[yr],function(a,u){var f=a.globals&&a.globals.isSupportedScript;return!f||f(u[0].evaluate(a))}],upcase:[yr,[yr],function(a,u){return u[0].evaluate(a).toUpperCase()}],downcase:[yr,[yr],function(a,u){return u[0].evaluate(a).toLowerCase()}],concat:[yr,ji(fr),function(a,u){return u.map(function(f){return Yl(f.evaluate(a))}).join("")}],"resolved-locale":[yr,[On],function(a,u){return u[0].evaluate(a).resolvedLocale()}]});var Ai=function(a,u){this.expression=a,this._warningHistory={},this._evaluator=new rl,this._defaultValue=u?function(f){return f.type==="color"&&Qs(f.default)?new ci(0,0,0,0):f.type==="color"?ci.parse(f.default)||null:f.default===void 0?null:f.default}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null};function ma(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Ur}function pn(a,u){var f=new Ql(Ur,[],u?function(S){var I={color:cr,string:yr,number:Re,enum:yr,boolean:tr,formatted:Ci,resolvedImage:Bn};return S.type==="array"?Zn(I[S.value]||fr,S.length):I[S.type]}(u):void 0),b=f.parse(a,void 0,void 0,void 0,u&&u.type==="string"?{typeAnnotation:"coerce"}:void 0);return b?mi(new Ai(b,u)):$n(f.errors)}Ai.prototype.evaluateWithoutErrorHandling=function(a,u,f,b,S,I){return this._evaluator.globals=a,this._evaluator.feature=u,this._evaluator.featureState=f,this._evaluator.canonical=b,this._evaluator.availableImages=S||null,this._evaluator.formattedSection=I,this.expression.evaluate(this._evaluator)},Ai.prototype.evaluate=function(a,u,f,b,S,I){this._evaluator.globals=a,this._evaluator.feature=u||null,this._evaluator.featureState=f||null,this._evaluator.canonical=b,this._evaluator.availableImages=S||null,this._evaluator.formattedSection=I||null;try{var N=this.expression.evaluate(this._evaluator);if(N==null||typeof N=="number"&&N!=N)return this._defaultValue;if(this._enumValues&&!(N in this._enumValues))throw new ms("Expected value to be one of "+Object.keys(this._enumValues).map(function(H){return JSON.stringify(H)}).join(", ")+", but found "+JSON.stringify(N)+" instead.");return N}catch(H){return this._warningHistory[H.message]||(this._warningHistory[H.message]=!0,typeof console<"u"&&console.warn(H.message)),this._defaultValue}};var Bt=function(a,u){this.kind=a,this._styleExpression=u,this.isStateDependent=a!=="constant"&&!Zl(u.expression)};Bt.prototype.evaluateWithoutErrorHandling=function(a,u,f,b,S,I){return this._styleExpression.evaluateWithoutErrorHandling(a,u,f,b,S,I)},Bt.prototype.evaluate=function(a,u,f,b,S,I){return this._styleExpression.evaluate(a,u,f,b,S,I)};var dn=function(a,u,f,b){this.kind=a,this.zoomStops=f,this._styleExpression=u,this.isStateDependent=a!=="camera"&&!Zl(u.expression),this.interpolationType=b};function mp(a,u){if((a=pn(a,u)).result==="error")return a;var f=a.value.expression,b=Kl(f);if(!b&&!Hi(u))return $n([new We("","data expressions not supported")]);var S=Tu(f,["zoom"]);if(!S&&!Nn(u))return $n([new We("","zoom expressions not supported")]);var I=function N(H){var Q=null;if(H instanceof tt)Q=N(H.result);else if(H instanceof Y)for(var rt=0,st=H.args;rt<st.length&&!(Q=N(st[rt]));rt+=1);else(H instanceof da||H instanceof R)&&H.input instanceof ko&&H.input.name==="zoom"&&(Q=H);return Q instanceof We||H.eachChild(function(lt){var yt=N(lt);yt instanceof We?Q=yt:!Q&&yt?Q=new We("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):Q&&yt&&Q!==yt&&(Q=new We("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),Q}(f);return I||S?I instanceof We?$n([I]):I instanceof R&&!kn(u)?$n([new We("",'"interpolate" expressions cannot be used with this property')]):mi(I?new dn(b?"camera":"composite",a.value,I.labels,I instanceof R?I.interpolation:void 0):new Bt(b?"constant":"source",a.value)):$n([new We("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}dn.prototype.evaluateWithoutErrorHandling=function(a,u,f,b,S,I){return this._styleExpression.evaluateWithoutErrorHandling(a,u,f,b,S,I)},dn.prototype.evaluate=function(a,u,f,b,S,I){return this._styleExpression.evaluate(a,u,f,b,S,I)},dn.prototype.interpolationFactor=function(a,u,f){return this.interpolationType?R.interpolationFactor(this.interpolationType,a,u,f):0};var Jl=function(a,u){this._parameters=a,this._specification=u,je(this,function f(b,S){var I,N,H,Q=S.type==="color",rt=b.stops&&typeof b.stops[0][0]=="object",st=rt||!(rt||b.property!==void 0),lt=b.type||(kn(S)?"exponential":"interval");if(Q&&((b=je({},b)).stops&&(b.stops=b.stops.map(function(vr){return[vr[0],ci.parse(vr[1])]})),b.default=ci.parse(b.default?b.default:S.default)),b.colorSpace&&b.colorSpace!=="rgb"&&!wA[b.colorSpace])throw new Error("Unknown color space: "+b.colorSpace);if(lt==="exponential")I=dc;else if(lt==="interval")I=Mu;else if(lt==="categorical"){I=Fo,N=Object.create(null);for(var yt=0,Tt=b.stops;yt<Tt.length;yt+=1){var kt=Tt[yt];N[kt[0]]=kt[1]}H=typeof b.stops[0][0]}else{if(lt!=="identity")throw new Error('Unknown function type "'+lt+'"');I=Su}if(rt){for(var Ut={},$t=[],qt=0;qt<b.stops.length;qt++){var ie=b.stops[qt],de=ie[0].zoom;Ut[de]===void 0&&(Ut[de]={zoom:de,type:b.type,property:b.property,default:b.default,stops:[]},$t.push(de)),Ut[de].stops.push([ie[0].value,ie[1]])}for(var ge=[],we=0,De=$t;we<De.length;we+=1){var Ke=De[we];ge.push([Ut[Ke].zoom,f(Ut[Ke],S)])}var or={name:"linear"};return{kind:"composite",interpolationType:or,interpolationFactor:R.interpolationFactor.bind(void 0,or),zoomStops:ge.map(function(vr){return vr[0]}),evaluate:function(vr,Zr){var Tr=vr.zoom;return dc({stops:ge,base:b.base},S,Tr).evaluate(Tr,Zr)}}}if(st){var Hr=lt==="exponential"?{name:"exponential",base:b.base!==void 0?b.base:1}:null;return{kind:"camera",interpolationType:Hr,interpolationFactor:R.interpolationFactor.bind(void 0,Hr),zoomStops:b.stops.map(function(vr){return vr[0]}),evaluate:function(vr){return I(b,S,vr.zoom,N,H)}}}return{kind:"source",evaluate:function(vr,Zr){var Tr=Zr&&Zr.properties?Zr.properties[b.property]:void 0;return Tr===void 0?Fs(b.default,S.default):I(b,S,Tr,N,H)}}}(this._parameters,this._specification))};function Ts(a){var u=a.key,f=a.value,b=a.valueSpec||{},S=a.objectElementValidators||{},I=a.style,N=a.styleSpec,H=[],Q=Kn(f);if(Q!=="object")return[new jt(u,f,"object expected, "+Q+" found")];for(var rt in f){var st=rt.split(".")[0],lt=b[st]||b["*"],yt=void 0;if(S[st])yt=S[st];else if(b[st])yt=dr;else if(S["*"])yt=S["*"];else{if(!b["*"]){H.push(new jt(u,f[rt],'unknown property "'+rt+'"'));continue}yt=dr}H=H.concat(yt({key:(u&&u+".")+rt,value:f[rt],valueSpec:lt,style:I,styleSpec:N,object:f,objectKey:rt},f))}for(var Tt in b)S[Tt]||b[Tt].required&&b[Tt].default===void 0&&f[Tt]===void 0&&H.push(new jt(u,f,'missing required property "'+Tt+'"'));return H}function af(a){var u=a.value,f=a.valueSpec,b=a.style,S=a.styleSpec,I=a.key,N=a.arrayElementValidator||dr;if(Kn(u)!=="array")return[new jt(I,u,"array expected, "+Kn(u)+" found")];if(f.length&&u.length!==f.length)return[new jt(I,u,"array length "+f.length+" expected, length "+u.length+" found")];if(f["min-length"]&&u.length<f["min-length"])return[new jt(I,u,"array length at least "+f["min-length"]+" expected, length "+u.length+" found")];var H={type:f.value,values:f.values};S.$version<7&&(H.function=f.function),Kn(f.value)==="object"&&(H=f.value);for(var Q=[],rt=0;rt<u.length;rt++)Q=Q.concat(N({array:u,arrayIndex:rt,value:u[rt],valueSpec:H,style:b,styleSpec:S,key:I+"["+rt+"]"}));return Q}function il(a){var u=a.key,f=a.value,b=a.valueSpec,S=Kn(f);return S==="number"&&f!=f&&(S="NaN"),S!=="number"?[new jt(u,f,"number expected, "+S+" found")]:"minimum"in b&&f<b.minimum?[new jt(u,f,f+" is less than the minimum value "+b.minimum)]:"maximum"in b&&f>b.maximum?[new jt(u,f,f+" is greater than the maximum value "+b.maximum)]:[]}function It(a){var u,f,b,S=a.valueSpec,I=Ge(a.value.type),N={},H=I!=="categorical"&&a.value.property===void 0,Q=!H,rt=Kn(a.value.stops)==="array"&&Kn(a.value.stops[0])==="array"&&Kn(a.value.stops[0][0])==="object",st=Ts({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(Tt){if(I==="identity")return[new jt(Tt.key,Tt.value,'identity function may not have a "stops" property')];var kt=[],Ut=Tt.value;return kt=kt.concat(af({key:Tt.key,value:Ut,valueSpec:Tt.valueSpec,style:Tt.style,styleSpec:Tt.styleSpec,arrayElementValidator:lt})),Kn(Ut)==="array"&&Ut.length===0&&kt.push(new jt(Tt.key,Ut,"array must have at least one stop")),kt},default:function(Tt){return dr({key:Tt.key,value:Tt.value,valueSpec:S,style:Tt.style,styleSpec:Tt.styleSpec})}}});return I==="identity"&&H&&st.push(new jt(a.key,a.value,'missing required property "property"')),I==="identity"||a.value.stops||st.push(new jt(a.key,a.value,'missing required property "stops"')),I==="exponential"&&a.valueSpec.expression&&!kn(a.valueSpec)&&st.push(new jt(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(Q&&!Hi(a.valueSpec)?st.push(new jt(a.key,a.value,"property functions not supported")):H&&!Nn(a.valueSpec)&&st.push(new jt(a.key,a.value,"zoom functions not supported"))),I!=="categorical"&&!rt||a.value.property!==void 0||st.push(new jt(a.key,a.value,'"property" property is required')),st;function lt(Tt){var kt=[],Ut=Tt.value,$t=Tt.key;if(Kn(Ut)!=="array")return[new jt($t,Ut,"array expected, "+Kn(Ut)+" found")];if(Ut.length!==2)return[new jt($t,Ut,"array length 2 expected, length "+Ut.length+" found")];if(rt){if(Kn(Ut[0])!=="object")return[new jt($t,Ut,"object expected, "+Kn(Ut[0])+" found")];if(Ut[0].zoom===void 0)return[new jt($t,Ut,"object stop key must have zoom")];if(Ut[0].value===void 0)return[new jt($t,Ut,"object stop key must have value")];if(b&&b>Ge(Ut[0].zoom))return[new jt($t,Ut[0].zoom,"stop zoom values must appear in ascending order")];Ge(Ut[0].zoom)!==b&&(b=Ge(Ut[0].zoom),f=void 0,N={}),kt=kt.concat(Ts({key:$t+"[0]",value:Ut[0],valueSpec:{zoom:{}},style:Tt.style,styleSpec:Tt.styleSpec,objectElementValidators:{zoom:il,value:yt}}))}else kt=kt.concat(yt({key:$t+"[0]",value:Ut[0],valueSpec:{},style:Tt.style,styleSpec:Tt.styleSpec},Ut));return ma(Pe(Ut[1]))?kt.concat([new jt($t+"[1]",Ut[1],"expressions are not allowed in function stops.")]):kt.concat(dr({key:$t+"[1]",value:Ut[1],valueSpec:S,style:Tt.style,styleSpec:Tt.styleSpec}))}function yt(Tt,kt){var Ut=Kn(Tt.value),$t=Ge(Tt.value),qt=Tt.value!==null?Tt.value:kt;if(u){if(Ut!==u)return[new jt(Tt.key,qt,Ut+" stop domain type must match previous stop domain type "+u)]}else u=Ut;if(Ut!=="number"&&Ut!=="string"&&Ut!=="boolean")return[new jt(Tt.key,qt,"stop domain value must be a number, string, or boolean")];if(Ut!=="number"&&I!=="categorical"){var ie="number expected, "+Ut+" found";return Hi(S)&&I===void 0&&(ie+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new jt(Tt.key,qt,ie)]}return I!=="categorical"||Ut!=="number"||isFinite($t)&&Math.floor($t)===$t?I!=="categorical"&&Ut==="number"&&f!==void 0&&$t<f?[new jt(Tt.key,qt,"stop domain values must appear in ascending order")]:(f=$t,I==="categorical"&&$t in N?[new jt(Tt.key,qt,"stop domain values must be unique")]:(N[$t]=!0,[])):[new jt(Tt.key,qt,"integer expected, found "+$t)]}}function mc(a){var u=(a.expressionContext==="property"?mp:pn)(Pe(a.value),a.valueSpec);if(u.result==="error")return u.value.map(function(b){return new jt(""+a.key+b.key,a.value,b.message)});var f=u.value.expression||u.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!f.outputDefined())return[new jt(a.key,a.value,'Invalid data expression for "'+a.propertyKey+'". Output values must be contained as literals within the expression.')];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!Zl(f))return[new jt(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!Zl(f))return[new jt(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!Tu(f,["zoom","feature-state"]))return[new jt(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!Kl(f))return[new jt(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Tl(a){var u=a.key,f=a.value,b=a.valueSpec,S=[];return Array.isArray(b.values)?b.values.indexOf(Ge(f))===-1&&S.push(new jt(u,f,"expected one of ["+b.values.join(", ")+"], "+JSON.stringify(f)+" found")):Object.keys(b.values).indexOf(Ge(f))===-1&&S.push(new jt(u,f,"expected one of ["+Object.keys(b.values).join(", ")+"], "+JSON.stringify(f)+" found")),S}function tu(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(var u=0,f=a.slice(1);u<f.length;u+=1){var b=f[u];if(!tu(b)&&typeof b!="boolean")return!1}return!0;default:return!0}}Jl.deserialize=function(a){return new Jl(a._parameters,a._specification)},Jl.serialize=function(a){return{_parameters:a._parameters,_specification:a._specification}};var ph={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function cf(a){if(a==null)return{filter:function(){return!0},needGeometry:!1};tu(a)||(a=eu(a));var u=pn(a,ph);if(u.result==="error")throw new Error(u.value.map(function(f){return f.key+": "+f.message}).join(", "));return{filter:function(f,b,S){return u.value.evaluate(f,b,{},S)},needGeometry:function f(b){if(!Array.isArray(b))return!1;if(b[0]==="within")return!0;for(var S=1;S<b.length;S++)if(f(b[S]))return!0;return!1}(a)}}function lf(a,u){return a<u?-1:a>u?1:0}function eu(a){if(!a)return!0;var u,f=a[0];return a.length<=1?f!=="any":f==="=="?Cu(a[1],a[2],"=="):f==="!="?Io(Cu(a[1],a[2],"==")):f==="<"||f===">"||f==="<="||f===">="?Cu(a[1],a[2],f):f==="any"?(u=a.slice(1),["any"].concat(u.map(eu))):f==="all"?["all"].concat(a.slice(1).map(eu)):f==="none"?["all"].concat(a.slice(1).map(eu).map(Io)):f==="in"?Ap(a[1],a.slice(2)):f==="!in"?Io(Ap(a[1],a.slice(2))):f==="has"?Wa(a[1]):f==="!has"?Io(Wa(a[1])):f!=="within"||a}function Cu(a,u,f){switch(a){case"$type":return["filter-type-"+f,u];case"$id":return["filter-id-"+f,u];default:return["filter-"+f,a,u]}}function Ap(a,u){if(u.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",u]];case"$id":return["filter-id-in",["literal",u]];default:return u.length>200&&!u.some(function(f){return typeof f!=typeof u[0]})?["filter-in-large",a,["literal",u.sort(lf)]]:["filter-in-small",a,["literal",u]]}}function Wa(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Io(a){return["!",a]}function zt(a){return tu(Pe(a.value))?mc(je({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function u(f){var b=f.value,S=f.key;if(Kn(b)!=="array")return[new jt(S,b,"array expected, "+Kn(b)+" found")];var I,N=f.styleSpec,H=[];if(b.length<1)return[new jt(S,b,"filter array must have at least 1 element")];switch(H=H.concat(Tl({key:S+"[0]",value:b[0],valueSpec:N.filter_operator,style:f.style,styleSpec:f.styleSpec})),Ge(b[0])){case"<":case"<=":case">":case">=":b.length>=2&&Ge(b[1])==="$type"&&H.push(new jt(S,b,'"$type" cannot be use with operator "'+b[0]+'"'));case"==":case"!=":b.length!==3&&H.push(new jt(S,b,'filter array for operator "'+b[0]+'" must have 3 elements'));case"in":case"!in":b.length>=2&&(I=Kn(b[1]))!=="string"&&H.push(new jt(S+"[1]",b[1],"string expected, "+I+" found"));for(var Q=2;Q<b.length;Q++)I=Kn(b[Q]),Ge(b[1])==="$type"?H=H.concat(Tl({key:S+"["+Q+"]",value:b[Q],valueSpec:N.geometry_type,style:f.style,styleSpec:f.styleSpec})):I!=="string"&&I!=="number"&&I!=="boolean"&&H.push(new jt(S+"["+Q+"]",b[Q],"string, number, or boolean expected, "+I+" found"));break;case"any":case"all":case"none":for(var rt=1;rt<b.length;rt++)H=H.concat(u({key:S+"["+rt+"]",value:b[rt],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":I=Kn(b[1]),b.length!==2?H.push(new jt(S,b,'filter array for "'+b[0]+'" operator must have 2 elements')):I!=="string"&&H.push(new jt(S+"[1]",b[1],"string expected, "+I+" found"));break;case"within":I=Kn(b[1]),b.length!==2?H.push(new jt(S,b,'filter array for "'+b[0]+'" operator must have 2 elements')):I!=="object"&&H.push(new jt(S+"[1]",b[1],"object expected, "+I+" found"))}return H}(a)}function ne(a,u){var f=a.key,b=a.style,S=a.styleSpec,I=a.value,N=a.objectKey,H=S[u+"_"+a.layerType];if(!H)return[];var Q=N.match(/^(.*)-transition$/);if(u==="paint"&&Q&&H[Q[1]]&&H[Q[1]].transition)return dr({key:f,value:I,valueSpec:S.transition,style:b,styleSpec:S});var rt,st=a.valueSpec||H[N];if(!st)return[new jt(f,I,'unknown property "'+N+'"')];if(Kn(I)==="string"&&Hi(st)&&!st.tokens&&(rt=/^{([^}]+)}$/.exec(I)))return[new jt(f,I,'"'+N+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(rt[1])+" }`.")];var lt=[];return a.layerType==="symbol"&&(N==="text-field"&&b&&!b.glyphs&&lt.push(new jt(f,I,'use of "text-field" requires a style "glyphs" property')),N==="text-font"&&Qs(Pe(I))&&Ge(I.type)==="identity"&&lt.push(new jt(f,I,'"text-font" does not support identity functions'))),lt.concat(dr({key:a.key,value:I,valueSpec:st,style:b,styleSpec:S,expressionContext:"property",propertyType:u,propertyKey:N}))}function _e(a){return ne(a,"paint")}function Ie(a){return ne(a,"layout")}function ze(a){var u=[],f=a.value,b=a.key,S=a.style,I=a.styleSpec;f.type||f.ref||u.push(new jt(b,f,'either "type" or "ref" is required'));var N,H=Ge(f.type),Q=Ge(f.ref);if(f.id)for(var rt=Ge(f.id),st=0;st<a.arrayIndex;st++){var lt=S.layers[st];Ge(lt.id)===rt&&u.push(new jt(b,f.id,'duplicate layer id "'+f.id+'", previously used at line '+lt.id.__line__))}if("ref"in f)["type","source","source-layer","filter","layout"].forEach(function(kt){kt in f&&u.push(new jt(b,f[kt],'"'+kt+'" is prohibited for ref layers'))}),S.layers.forEach(function(kt){Ge(kt.id)===Q&&(N=kt)}),N?N.ref?u.push(new jt(b,f.ref,"ref cannot reference another ref layer")):H=Ge(N.type):u.push(new jt(b,f.ref,'ref layer "'+Q+'" not found'));else if(H!=="background")if(f.source){var yt=S.sources&&S.sources[f.source],Tt=yt&&Ge(yt.type);yt?Tt==="vector"&&H==="raster"?u.push(new jt(b,f.source,'layer "'+f.id+'" requires a raster source')):Tt==="raster"&&H!=="raster"?u.push(new jt(b,f.source,'layer "'+f.id+'" requires a vector source')):Tt!=="vector"||f["source-layer"]?Tt==="raster-dem"&&H!=="hillshade"?u.push(new jt(b,f.source,"raster-dem source can only be used with layer type 'hillshade'.")):H!=="line"||!f.paint||!f.paint["line-gradient"]||Tt==="geojson"&&yt.lineMetrics||u.push(new jt(b,f,'layer "'+f.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):u.push(new jt(b,f,'layer "'+f.id+'" must specify a "source-layer"')):u.push(new jt(b,f.source,'source "'+f.source+'" not found'))}else u.push(new jt(b,f,'missing required property "source"'));return u=u.concat(Ts({key:b,value:f,valueSpec:I.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return dr({key:b+".type",value:f.type,valueSpec:I.layer.type,style:a.style,styleSpec:a.styleSpec,object:f,objectKey:"type"})},filter:zt,layout:function(kt){return Ts({layer:f,key:kt.key,value:kt.value,style:kt.style,styleSpec:kt.styleSpec,objectElementValidators:{"*":function(Ut){return Ie(je({layerType:H},Ut))}}})},paint:function(kt){return Ts({layer:f,key:kt.key,value:kt.value,style:kt.style,styleSpec:kt.styleSpec,objectElementValidators:{"*":function(Ut){return _e(je({layerType:H},Ut))}}})}}}))}function hr(a){var u=a.value,f=a.key,b=Kn(u);return b!=="string"?[new jt(f,u,"string expected, "+b+" found")]:[]}var nr={promoteId:function(a){var u=a.key,f=a.value;if(Kn(f)==="string")return hr({key:u,value:f});var b=[];for(var S in f)b.push.apply(b,hr({key:u+"."+S,value:f[S]}));return b}};function pr(a){var u=a.value,f=a.key,b=a.styleSpec,S=a.style;if(!u.type)return[new jt(f,u,'"type" is required')];var I,N=Ge(u.type);switch(N){case"vector":case"raster":case"raster-dem":return Ts({key:f,value:u,valueSpec:b["source_"+N.replace("-","_")],style:a.style,styleSpec:b,objectElementValidators:nr});case"geojson":if(I=Ts({key:f,value:u,valueSpec:b.source_geojson,style:S,styleSpec:b,objectElementValidators:nr}),u.cluster)for(var H in u.clusterProperties){var Q=u.clusterProperties[H],rt=Q[0],st=typeof rt=="string"?[rt,["accumulated"],["get",H]]:rt;I.push.apply(I,mc({key:f+"."+H+".map",value:Q[1],expressionContext:"cluster-map"})),I.push.apply(I,mc({key:f+"."+H+".reduce",value:st,expressionContext:"cluster-reduce"}))}return I;case"video":return Ts({key:f,value:u,valueSpec:b.source_video,style:S,styleSpec:b});case"image":return Ts({key:f,value:u,valueSpec:b.source_image,style:S,styleSpec:b});case"canvas":return[new jt(f,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Tl({key:f+".type",value:u.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:S,styleSpec:b})}}function Pr(a){var u=a.value,f=a.styleSpec,b=f.light,S=a.style,I=[],N=Kn(u);if(u===void 0)return I;if(N!=="object")return I.concat([new jt("light",u,"object expected, "+N+" found")]);for(var H in u){var Q=H.match(/^(.*)-transition$/);I=I.concat(Q&&b[Q[1]]&&b[Q[1]].transition?dr({key:H,value:u[H],valueSpec:f.transition,style:S,styleSpec:f}):b[H]?dr({key:H,value:u[H],valueSpec:b[H],style:S,styleSpec:f}):[new jt(H,u[H],'unknown property "'+H+'"')])}return I}var Sn={"*":function(){return[]},array:af,boolean:function(a){var u=a.value,f=a.key,b=Kn(u);return b!=="boolean"?[new jt(f,u,"boolean expected, "+b+" found")]:[]},number:il,color:function(a){var u=a.key,f=a.value,b=Kn(f);return b!=="string"?[new jt(u,f,"color expected, "+b+" found")]:Dn(f)===null?[new jt(u,f,'color expected, "'+f+'" found')]:[]},constants:ce,enum:Tl,filter:zt,function:It,layer:ze,object:Ts,source:pr,light:Pr,string:hr,formatted:function(a){return hr(a).length===0?[]:mc(a)},resolvedImage:function(a){return hr(a).length===0?[]:mc(a)}};function dr(a){var u=a.value,f=a.valueSpec,b=a.styleSpec;return f.expression&&Qs(Ge(u))?It(a):f.expression&&ma(Pe(u))?mc(a):f.type&&Sn[f.type]?Sn[f.type](a):Ts(je({},a,{valueSpec:f.type?b[f.type]:f}))}function kr(a){var u=a.value,f=a.key,b=hr(a);return b.length||(u.indexOf("{fontstack}")===-1&&b.push(new jt(f,u,'"glyphs" url must include a "{fontstack}" token')),u.indexOf("{range}")===-1&&b.push(new jt(f,u,'"glyphs" url must include a "{range}" token'))),b}function xn(a,u){u===void 0&&(u=St);var f=[];return f=f.concat(dr({key:"",value:a,valueSpec:u.$root,styleSpec:u,style:a,objectElementValidators:{glyphs:kr,"*":function(){return[]}}})),a.constants&&(f=f.concat(ce({key:"constants",value:a.constants,style:a,styleSpec:u}))),sn(f)}function sn(a){return[].concat(a).sort(function(u,f){return u.line-f.line})}function xi(a){return function(){for(var u=[],f=arguments.length;f--;)u[f]=arguments[f];return sn(a.apply(this,u))}}xn.source=xi(pr),xn.light=xi(Pr),xn.layer=xi(ze),xn.filter=xi(zt),xn.paintProperty=xi(_e),xn.layoutProperty=xi(Ie);var Go=xn,zs=Go.light,qa=Go.paintProperty,Js=Go.layoutProperty;function Ac(a,u){var f=!1;if(u&&u.length)for(var b=0,S=u;b<S.length;b+=1)a.fire(new Qt(new Error(S[b].message))),f=!0;return f}var po=is;function is(a,u,f){var b=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var S=new Int32Array(this.arrayBuffer);a=S[0],this.d=(u=S[1])+2*(f=S[2]);for(var I=0;I<this.d*this.d;I++){var N=S[3+I],H=S[3+I+1];b.push(N===H?null:S.subarray(N,H))}var Q=S[3+b.length+1];this.keys=S.subarray(S[3+b.length],Q),this.bboxes=S.subarray(Q),this.insert=this._insertReadonly}else{this.d=u+2*f;for(var rt=0;rt<this.d*this.d;rt++)b.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=a,this.padding=f,this.scale=u/a,this.uid=0;var st=f/u*a;this.min=-st,this.max=a+st}is.prototype.insert=function(a,u,f,b,S){this._forEachCell(u,f,b,S,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(b),this.bboxes.push(S)},is.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},is.prototype._insertCell=function(a,u,f,b,S,I){this.cells[S].push(I)},is.prototype.query=function(a,u,f,b,S){var I=this.min,N=this.max;if(a<=I&&u<=I&&N<=f&&N<=b&&!S)return Array.prototype.slice.call(this.keys);var H=[];return this._forEachCell(a,u,f,b,this._queryCell,H,{},S),H},is.prototype._queryCell=function(a,u,f,b,S,I,N,H){var Q=this.cells[S];if(Q!==null)for(var rt=this.keys,st=this.bboxes,lt=0;lt<Q.length;lt++){var yt=Q[lt];if(N[yt]===void 0){var Tt=4*yt;(H?H(st[Tt+0],st[Tt+1],st[Tt+2],st[Tt+3]):a<=st[Tt+2]&&u<=st[Tt+3]&&f>=st[Tt+0]&&b>=st[Tt+1])?(N[yt]=!0,I.push(rt[yt])):N[yt]=!1}}},is.prototype._forEachCell=function(a,u,f,b,S,I,N,H){for(var Q=this._convertToCellCoord(a),rt=this._convertToCellCoord(u),st=this._convertToCellCoord(f),lt=this._convertToCellCoord(b),yt=Q;yt<=st;yt++)for(var Tt=rt;Tt<=lt;Tt++){var kt=this.d*Tt+yt;if((!H||H(this._convertFromCellCoord(yt),this._convertFromCellCoord(Tt),this._convertFromCellCoord(yt+1),this._convertFromCellCoord(Tt+1)))&&S.call(this,a,u,f,b,kt,I,N,H))return}},is.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},is.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},is.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,u=3+this.cells.length+1+1,f=0,b=0;b<this.cells.length;b++)f+=this.cells[b].length;var S=new Int32Array(u+f+this.keys.length+this.bboxes.length);S[0]=this.extent,S[1]=this.n,S[2]=this.padding;for(var I=u,N=0;N<a.length;N++){var H=a[N];S[3+N]=I,S.set(H,I),I+=H.length}return S[3+a.length]=I,S.set(this.keys,I),S[3+a.length+1]=I+=this.keys.length,S.set(this.bboxes,I),I+=this.bboxes.length,S.buffer};var gp=p.ImageData,Dg=p.ImageBitmap,li={};function _r(a,u,f){f===void 0&&(f={}),Object.defineProperty(u,"_classRegistryKey",{value:a,writeable:!1}),li[a]={klass:u,omit:f.omit||[],shallow:f.shallow||[]}}for(var to in _r("Object",Object),po.serialize=function(a,u){var f=a.toArrayBuffer();return u&&u.push(f),{buffer:f}},po.deserialize=function(a){return new po(a.buffer)},_r("Grid",po),_r("Color",ci),_r("Error",Error),_r("ResolvedImage",ks),_r("StylePropertyFunction",Jl),_r("StyleExpression",Ai,{omit:["_evaluator"]}),_r("ZoomDependentExpression",dn),_r("ZoomConstantExpression",Bt),_r("CompoundExpression",ko,{omit:["_evaluate"]}),Ur)Ur[to]._classRegistryKey||_r("Expression_"+to,Ur[to]);function uf(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function dh(a){return Dg&&a instanceof Dg}function Ga(a,u){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(uf(a)||dh(a))return u&&u.push(a),a;if(ArrayBuffer.isView(a)){var f=a;return u&&u.push(f.buffer),f}if(a instanceof gp)return u&&u.push(a.data.buffer),a;if(Array.isArray(a)){for(var b=[],S=0,I=a;S<I.length;S+=1)b.push(Ga(I[S],u));return b}if(typeof a=="object"){var N=a.constructor,H=N._classRegistryKey;if(!H)throw new Error("can't serialize object of unregistered class");var Q=N.serialize?N.serialize(a,u):{};if(!N.serialize){for(var rt in a)if(a.hasOwnProperty(rt)&&!(li[H].omit.indexOf(rt)>=0)){var st=a[rt];Q[rt]=li[H].shallow.indexOf(rt)>=0?st:Ga(st,u)}a instanceof Error&&(Q.message=a.message)}if(Q.$name)throw new Error("$name property is reserved for worker serialization logic.");return H!=="Object"&&(Q.$name=H),Q}throw new Error("can't serialize object of type "+typeof a)}function Xa(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||uf(a)||dh(a)||ArrayBuffer.isView(a)||a instanceof gp)return a;if(Array.isArray(a))return a.map(Xa);if(typeof a=="object"){var u=a.$name||"Object",f=li[u].klass;if(!f)throw new Error("can't deserialize unregistered class "+u);if(f.deserialize)return f.deserialize(a);for(var b=Object.create(f.prototype),S=0,I=Object.keys(a);S<I.length;S+=1){var N=I[S];if(N!=="$name"){var H=a[N];b[N]=li[u].shallow.indexOf(N)>=0?H:Xa(H)}}return b}throw new Error("can't deserialize object of type "+typeof a)}var TA=function(){this.first=!0};TA.prototype.update=function(a,u){var f=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=f,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=f,!0):(this.lastFloorZoom>f?(this.lastIntegerZoom=f+1,this.lastIntegerZoomTime=u):this.lastFloorZoom<f&&(this.lastIntegerZoom=f,this.lastIntegerZoomTime=u),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=f,!0))};var lr={"Latin-1 Supplement":function(a){return a>=128&&a<=255},Arabic:function(a){return a>=1536&&a<=1791},"Arabic Supplement":function(a){return a>=1872&&a<=1919},"Arabic Extended-A":function(a){return a>=2208&&a<=2303},"Hangul Jamo":function(a){return a>=4352&&a<=4607},"Unified Canadian Aboriginal Syllabics":function(a){return a>=5120&&a<=5759},Khmer:function(a){return a>=6016&&a<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(a){return a>=6320&&a<=6399},"General Punctuation":function(a){return a>=8192&&a<=8303},"Letterlike Symbols":function(a){return a>=8448&&a<=8527},"Number Forms":function(a){return a>=8528&&a<=8591},"Miscellaneous Technical":function(a){return a>=8960&&a<=9215},"Control Pictures":function(a){return a>=9216&&a<=9279},"Optical Character Recognition":function(a){return a>=9280&&a<=9311},"Enclosed Alphanumerics":function(a){return a>=9312&&a<=9471},"Geometric Shapes":function(a){return a>=9632&&a<=9727},"Miscellaneous Symbols":function(a){return a>=9728&&a<=9983},"Miscellaneous Symbols and Arrows":function(a){return a>=11008&&a<=11263},"CJK Radicals Supplement":function(a){return a>=11904&&a<=12031},"Kangxi Radicals":function(a){return a>=12032&&a<=12255},"Ideographic Description Characters":function(a){return a>=12272&&a<=12287},"CJK Symbols and Punctuation":function(a){return a>=12288&&a<=12351},Hiragana:function(a){return a>=12352&&a<=12447},Katakana:function(a){return a>=12448&&a<=12543},Bopomofo:function(a){return a>=12544&&a<=12591},"Hangul Compatibility Jamo":function(a){return a>=12592&&a<=12687},Kanbun:function(a){return a>=12688&&a<=12703},"Bopomofo Extended":function(a){return a>=12704&&a<=12735},"CJK Strokes":function(a){return a>=12736&&a<=12783},"Katakana Phonetic Extensions":function(a){return a>=12784&&a<=12799},"Enclosed CJK Letters and Months":function(a){return a>=12800&&a<=13055},"CJK Compatibility":function(a){return a>=13056&&a<=13311},"CJK Unified Ideographs Extension A":function(a){return a>=13312&&a<=19903},"Yijing Hexagram Symbols":function(a){return a>=19904&&a<=19967},"CJK Unified Ideographs":function(a){return a>=19968&&a<=40959},"Yi Syllables":function(a){return a>=40960&&a<=42127},"Yi Radicals":function(a){return a>=42128&&a<=42191},"Hangul Jamo Extended-A":function(a){return a>=43360&&a<=43391},"Hangul Syllables":function(a){return a>=44032&&a<=55215},"Hangul Jamo Extended-B":function(a){return a>=55216&&a<=55295},"Private Use Area":function(a){return a>=57344&&a<=63743},"CJK Compatibility Ideographs":function(a){return a>=63744&&a<=64255},"Arabic Presentation Forms-A":function(a){return a>=64336&&a<=65023},"Vertical Forms":function(a){return a>=65040&&a<=65055},"CJK Compatibility Forms":function(a){return a>=65072&&a<=65103},"Small Form Variants":function(a){return a>=65104&&a<=65135},"Arabic Presentation Forms-B":function(a){return a>=65136&&a<=65279},"Halfwidth and Fullwidth Forms":function(a){return a>=65280&&a<=65519}};function Vd(a){for(var u=0,f=a;u<f.length;u+=1)if(mh(f[u].charCodeAt(0)))return!0;return!1}function mh(a){return!(a!==746&&a!==747&&(a<4352||!(lr["Bopomofo Extended"](a)||lr.Bopomofo(a)||lr["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||lr["CJK Compatibility Ideographs"](a)||lr["CJK Compatibility"](a)||lr["CJK Radicals Supplement"](a)||lr["CJK Strokes"](a)||!(!lr["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||lr["CJK Unified Ideographs Extension A"](a)||lr["CJK Unified Ideographs"](a)||lr["Enclosed CJK Letters and Months"](a)||lr["Hangul Compatibility Jamo"](a)||lr["Hangul Jamo Extended-A"](a)||lr["Hangul Jamo Extended-B"](a)||lr["Hangul Jamo"](a)||lr["Hangul Syllables"](a)||lr.Hiragana(a)||lr["Ideographic Description Characters"](a)||lr.Kanbun(a)||lr["Kangxi Radicals"](a)||lr["Katakana Phonetic Extensions"](a)||lr.Katakana(a)&&a!==12540||!(!lr["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!lr["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||lr["Unified Canadian Aboriginal Syllabics"](a)||lr["Unified Canadian Aboriginal Syllabics Extended"](a)||lr["Vertical Forms"](a)||lr["Yijing Hexagram Symbols"](a)||lr["Yi Syllables"](a)||lr["Yi Radicals"](a))))}function ru(a){return!(mh(a)||function(u){return!!(lr["Latin-1 Supplement"](u)&&(u===167||u===169||u===174||u===177||u===188||u===189||u===190||u===215||u===247)||lr["General Punctuation"](u)&&(u===8214||u===8224||u===8225||u===8240||u===8241||u===8251||u===8252||u===8258||u===8263||u===8264||u===8265||u===8273)||lr["Letterlike Symbols"](u)||lr["Number Forms"](u)||lr["Miscellaneous Technical"](u)&&(u>=8960&&u<=8967||u>=8972&&u<=8991||u>=8996&&u<=9e3||u===9003||u>=9085&&u<=9114||u>=9150&&u<=9165||u===9167||u>=9169&&u<=9179||u>=9186&&u<=9215)||lr["Control Pictures"](u)&&u!==9251||lr["Optical Character Recognition"](u)||lr["Enclosed Alphanumerics"](u)||lr["Geometric Shapes"](u)||lr["Miscellaneous Symbols"](u)&&!(u>=9754&&u<=9759)||lr["Miscellaneous Symbols and Arrows"](u)&&(u>=11026&&u<=11055||u>=11088&&u<=11097||u>=11192&&u<=11243)||lr["CJK Symbols and Punctuation"](u)||lr.Katakana(u)||lr["Private Use Area"](u)||lr["CJK Compatibility Forms"](u)||lr["Small Form Variants"](u)||lr["Halfwidth and Fullwidth Forms"](u)||u===8734||u===8756||u===8757||u>=9984&&u<=10087||u>=10102&&u<=10131||u===65532||u===65533)}(a))}function gc(a){return a>=1424&&a<=2303||lr["Arabic Presentation Forms-A"](a)||lr["Arabic Presentation Forms-B"](a)}function Ia(a,u){return!(!u&&gc(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||lr.Khmer(a))}function Ah(a){for(var u=0,f=a;u<f.length;u+=1)if(gc(f[u].charCodeAt(0)))return!0;return!1}var El=null,os="unavailable",Ml=null,EA=function(a){a&&typeof a=="string"&&a.indexOf("NetworkError")>-1&&(os="error"),El&&El(a)};function gh(){MA.fire(new vt("pluginStateChange",{pluginStatus:os,pluginURL:Ml}))}var MA=new Jt,SA=function(){return os},Lc=function(){if(os!=="deferred"||!Ml)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");os="loading",gh(),Ml&&bu({url:Ml},function(a){a?EA(a):(os="loaded",gh())})},_c={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return os==="loaded"||_c.applyArabicShaping!=null},isLoading:function(){return os==="loading"},setState:function(a){os=a.pluginStatus,Ml=a.pluginURL},isParsed:function(){return _c.applyArabicShaping!=null&&_c.processBidirectionalText!=null&&_c.processStyledBidirectionalText!=null},getPluginURL:function(){return Ml}},Un=function(a,u){this.zoom=a,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.zoomHistory=u.zoomHistory,this.transition=u.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new TA,this.transition={})};Un.prototype.isSupportedScript=function(a){return function(u,f){for(var b=0,S=u;b<S.length;b+=1)if(!Ia(S[b].charCodeAt(0),f))return!1;return!0}(a,_c.isLoaded())},Un.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Un.prototype.getCrossfadeParameters=function(){var a=this.zoom,u=a-Math.floor(a),f=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:u+(1-u)*f}:{fromScale:.5,toScale:1,t:1-(1-f)*u}};var Sl=function(a,u){this.property=a,this.value=u,this.expression=function(f,b){if(Qs(f))return new Jl(f,b);if(ma(f)){var S=mp(f,b);if(S.result==="error")throw new Error(S.value.map(function(N){return N.key+": "+N.message}).join(", "));return S.value}var I=f;return typeof f=="string"&&b.type==="color"&&(I=ci.parse(f)),{kind:"constant",evaluate:function(){return I}}}(u===void 0?a.specification.default:u,a.specification)};Sl.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Sl.prototype.possiblyEvaluate=function(a,u,f){return this.property.possiblyEvaluate(this,a,u,f)};var Oc=function(a){this.property=a,this.value=new Sl(a,void 0)};Oc.prototype.transitioned=function(a,u){return new _h(this.property,this.value,u,D({},a.transition,this.transition),a.now)},Oc.prototype.untransitioned=function(){return new _h(this.property,this.value,null,{},0)};var Us=function(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)};Us.prototype.getValue=function(a){return J(this._values[a].value.value)},Us.prototype.setValue=function(a,u){this._values.hasOwnProperty(a)||(this._values[a]=new Oc(this._values[a].property)),this._values[a].value=new Sl(this._values[a].property,u===null?void 0:J(u))},Us.prototype.getTransition=function(a){return J(this._values[a].transition)},Us.prototype.setTransition=function(a,u){this._values.hasOwnProperty(a)||(this._values[a]=new Oc(this._values[a].property)),this._values[a].transition=J(u)||void 0},Us.prototype.serialize=function(){for(var a={},u=0,f=Object.keys(this._values);u<f.length;u+=1){var b=f[u],S=this.getValue(b);S!==void 0&&(a[b]=S);var I=this.getTransition(b);I!==void 0&&(a[b+"-transition"]=I)}return a},Us.prototype.transitioned=function(a,u){for(var f=new Pu(this._properties),b=0,S=Object.keys(this._values);b<S.length;b+=1){var I=S[b];f._values[I]=this._values[I].transitioned(a,u._values[I])}return f},Us.prototype.untransitioned=function(){for(var a=new Pu(this._properties),u=0,f=Object.keys(this._values);u<f.length;u+=1){var b=f[u];a._values[b]=this._values[b].untransitioned()}return a};var _h=function(a,u,f,b,S){this.property=a,this.value=u,this.begin=S+b.delay||0,this.end=this.begin+b.duration||0,a.specification.transition&&(b.delay||b.duration)&&(this.prior=f)};_h.prototype.possiblyEvaluate=function(a,u,f){var b=a.now||0,S=this.value.possiblyEvaluate(a,u,f),I=this.prior;if(I){if(b>this.end)return this.prior=null,S;if(this.value.isDataDriven())return this.prior=null,S;if(b<this.begin)return I.possiblyEvaluate(a,u,f);var N=(b-this.begin)/(this.end-this.begin);return this.property.interpolate(I.possiblyEvaluate(a,u,f),S,function(H){if(H<=0)return 0;if(H>=1)return 1;var Q=H*H,rt=Q*H;return 4*(H<.5?rt:3*(H-Q)+rt-.75)}(N))}return S};var Pu=function(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)};Pu.prototype.possiblyEvaluate=function(a,u,f){for(var b=new _p(this._properties),S=0,I=Object.keys(this._values);S<I.length;S+=1){var N=I[S];b._values[N]=this._values[N].possiblyEvaluate(a,u,f)}return b},Pu.prototype.hasTransition=function(){for(var a=0,u=Object.keys(this._values);a<u.length;a+=1)if(this._values[u[a]].prior)return!0;return!1};var ol=function(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)};ol.prototype.getValue=function(a){return J(this._values[a].value)},ol.prototype.setValue=function(a,u){this._values[a]=new Sl(this._values[a].property,u===null?void 0:J(u))},ol.prototype.serialize=function(){for(var a={},u=0,f=Object.keys(this._values);u<f.length;u+=1){var b=f[u],S=this.getValue(b);S!==void 0&&(a[b]=S)}return a},ol.prototype.possiblyEvaluate=function(a,u,f){for(var b=new _p(this._properties),S=0,I=Object.keys(this._values);S<I.length;S+=1){var N=I[S];b._values[N]=this._values[N].possiblyEvaluate(a,u,f)}return b};var Es=function(a,u,f){this.property=a,this.value=u,this.parameters=f};Es.prototype.isConstant=function(){return this.value.kind==="constant"},Es.prototype.constantOr=function(a){return this.value.kind==="constant"?this.value.value:a},Es.prototype.evaluate=function(a,u,f,b){return this.property.evaluate(this.value,this.parameters,a,u,f,b)};var _p=function(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)};_p.prototype.get=function(a){return this._values[a]};var Wr=function(a){this.specification=a};Wr.prototype.possiblyEvaluate=function(a,u){return a.expression.evaluate(u)},Wr.prototype.interpolate=function(a,u,f){var b=Eu[this.specification.type];return b?b(a,u,f):a};var Or=function(a,u){this.specification=a,this.overrides=u};Or.prototype.possiblyEvaluate=function(a,u,f,b){return new Es(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(u,null,{},f,b)}:a.expression,u)},Or.prototype.interpolate=function(a,u,f){if(a.value.kind!=="constant"||u.value.kind!=="constant")return a;if(a.value.value===void 0||u.value.value===void 0)return new Es(this,{kind:"constant",value:void 0},a.parameters);var b=Eu[this.specification.type];return b?new Es(this,{kind:"constant",value:b(a.value.value,u.value.value,f)},a.parameters):a},Or.prototype.evaluate=function(a,u,f,b,S,I){return a.kind==="constant"?a.value:a.evaluate(u,f,b,S,I)};var Iu=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.possiblyEvaluate=function(f,b,S,I){if(f.value===void 0)return new Es(this,{kind:"constant",value:void 0},b);if(f.expression.kind==="constant"){var N=f.expression.evaluate(b,null,{},S,I),H=f.property.specification.type==="resolvedImage"&&typeof N!="string"?N.name:N,Q=this._calculate(H,H,H,b);return new Es(this,{kind:"constant",value:Q},b)}if(f.expression.kind==="camera"){var rt=this._calculate(f.expression.evaluate({zoom:b.zoom-1}),f.expression.evaluate({zoom:b.zoom}),f.expression.evaluate({zoom:b.zoom+1}),b);return new Es(this,{kind:"constant",value:rt},b)}return new Es(this,f.expression,b)},u.prototype.evaluate=function(f,b,S,I,N,H){if(f.kind==="source"){var Q=f.evaluate(b,S,I,N,H);return this._calculate(Q,Q,Q,b)}return f.kind==="composite"?this._calculate(f.evaluate({zoom:Math.floor(b.zoom)-1},S,I),f.evaluate({zoom:Math.floor(b.zoom)},S,I),f.evaluate({zoom:Math.floor(b.zoom)+1},S,I),b):f.value},u.prototype._calculate=function(f,b,S,I){return I.zoom>I.zoomHistory.lastIntegerZoom?{from:f,to:b}:{from:S,to:b}},u.prototype.interpolate=function(f){return f},u}(Or),Aa=function(a){this.specification=a};Aa.prototype.possiblyEvaluate=function(a,u,f,b){if(a.value!==void 0){if(a.expression.kind==="constant"){var S=a.expression.evaluate(u,null,{},f,b);return this._calculate(S,S,S,u)}return this._calculate(a.expression.evaluate(new Un(Math.floor(u.zoom-1),u)),a.expression.evaluate(new Un(Math.floor(u.zoom),u)),a.expression.evaluate(new Un(Math.floor(u.zoom+1),u)),u)}},Aa.prototype._calculate=function(a,u,f,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:a,to:u}:{from:f,to:u}},Aa.prototype.interpolate=function(a){return a};var yc=function(a){this.specification=a};yc.prototype.possiblyEvaluate=function(a,u,f,b){return!!a.expression.evaluate(u,null,{},f,b)},yc.prototype.interpolate=function(){return!1};var Ms=function(a){for(var u in this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],a){var f=a[u];f.specification.overridable&&this.overridableProperties.push(u);var b=this.defaultPropertyValues[u]=new Sl(f,void 0),S=this.defaultTransitionablePropertyValues[u]=new Oc(f);this.defaultTransitioningPropertyValues[u]=S.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=b.possiblyEvaluate({})}};_r("DataDrivenProperty",Or),_r("DataConstantProperty",Wr),_r("CrossFadedDataDrivenProperty",Iu),_r("CrossFadedProperty",Aa),_r("ColorRampProperty",yc);var Ra=function(a){function u(f,b){if(a.call(this),this.id=f.id,this.type=f.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},f.type!=="custom"&&(this.metadata=(f=f).metadata,this.minzoom=f.minzoom,this.maxzoom=f.maxzoom,f.type!=="background"&&(this.source=f.source,this.sourceLayer=f["source-layer"],this.filter=f.filter),b.layout&&(this._unevaluatedLayout=new ol(b.layout)),b.paint)){for(var S in this._transitionablePaint=new Us(b.paint),f.paint)this.setPaintProperty(S,f.paint[S],{validate:!1});for(var I in f.layout)this.setLayoutProperty(I,f.layout[I],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new _p(b.paint)}}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},u.prototype.getLayoutProperty=function(f){return f==="visibility"?this.visibility:this._unevaluatedLayout.getValue(f)},u.prototype.setLayoutProperty=function(f,b,S){S===void 0&&(S={}),b!=null&&this._validate(Js,"layers."+this.id+".layout."+f,f,b,S)||(f!=="visibility"?this._unevaluatedLayout.setValue(f,b):this.visibility=b)},u.prototype.getPaintProperty=function(f){return F(f,"-transition")?this._transitionablePaint.getTransition(f.slice(0,-11)):this._transitionablePaint.getValue(f)},u.prototype.setPaintProperty=function(f,b,S){if(S===void 0&&(S={}),b!=null&&this._validate(qa,"layers."+this.id+".paint."+f,f,b,S))return!1;if(F(f,"-transition"))return this._transitionablePaint.setTransition(f.slice(0,-11),b||void 0),!1;var I=this._transitionablePaint._values[f],N=I.property.specification["property-type"]==="cross-faded-data-driven",H=I.value.isDataDriven(),Q=I.value;this._transitionablePaint.setValue(f,b),this._handleSpecialPaintPropertyUpdate(f);var rt=this._transitionablePaint._values[f].value;return rt.isDataDriven()||H||N||this._handleOverridablePaintPropertyUpdate(f,Q,rt)},u.prototype._handleSpecialPaintPropertyUpdate=function(f){},u.prototype._handleOverridablePaintPropertyUpdate=function(f,b,S){return!1},u.prototype.isHidden=function(f){return!!(this.minzoom&&f<this.minzoom)||!!(this.maxzoom&&f>=this.maxzoom)||this.visibility==="none"},u.prototype.updateTransitions=function(f){this._transitioningPaint=this._transitionablePaint.transitioned(f,this._transitioningPaint)},u.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},u.prototype.recalculate=function(f,b){f.getCrossfadeParameters&&(this._crossfadeParameters=f.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(f,void 0,b)),this.paint=this._transitioningPaint.possiblyEvaluate(f,void 0,b)},u.prototype.serialize=function(){var f={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(f.layout=f.layout||{},f.layout.visibility=this.visibility),ot(f,function(b,S){return!(b===void 0||S==="layout"&&!Object.keys(b).length||S==="paint"&&!Object.keys(b).length)})},u.prototype._validate=function(f,b,S,I,N){return N===void 0&&(N={}),(!N||N.validate!==!1)&&Ac(this,f.call(Go,{key:b,layerType:this.type,objectKey:S,value:I,styleSpec:St,style:{glyphs:!0,sprite:!0}}))},u.prototype.is3D=function(){return!1},u.prototype.isTileClipped=function(){return!1},u.prototype.hasOffscreenPass=function(){return!1},u.prototype.resize=function(){},u.prototype.isStateDependent=function(){for(var f in this.paint._values){var b=this.paint.get(f);if(b instanceof Es&&Hi(b.property.specification)&&(b.value.kind==="source"||b.value.kind==="composite")&&b.value.isStateDependent)return!0}return!1},u}(Jt),CA={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},hf=function(a,u){this._structArray=a,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},vi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Ss(a,u){u===void 0&&(u=1);var f=0,b=0;return{members:a.map(function(S){var I=CA[S.type].BYTES_PER_ELEMENT,N=f=PA(f,Math.max(u,I)),H=S.components||1;return b=Math.max(b,I),f+=I*H,{name:S.name,type:S.type,components:H,offset:N}}),size:PA(f,Math.max(b,u)),alignment:u}}function PA(a,u){return Math.ceil(a/u)*u}vi.serialize=function(a,u){return a._trim(),u&&(a.isTransferred=!0,u.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}},vi.deserialize=function(a){var u=Object.create(this.prototype);return u.arrayBuffer=a.arrayBuffer,u.length=a.length,u.capacity=a.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u},vi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},vi.prototype.clear=function(){this.length=0},vi.prototype.resize=function(a){this.reserve(a),this.length=a},vi.prototype.reserve=function(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}},vi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var nu=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b){var S=this.length;return this.resize(S+1),this.emplace(S,f,b)},u.prototype.emplace=function(f,b,S){var I=2*f;return this.int16[I+0]=b,this.int16[I+1]=S,f},u}(vi);nu.prototype.bytesPerElement=4,_r("StructArrayLayout2i4",nu);var yp=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b,S,I){var N=this.length;return this.resize(N+1),this.emplace(N,f,b,S,I)},u.prototype.emplace=function(f,b,S,I,N){var H=4*f;return this.int16[H+0]=b,this.int16[H+1]=S,this.int16[H+2]=I,this.int16[H+3]=N,f},u}(vi);yp.prototype.bytesPerElement=8,_r("StructArrayLayout4i8",yp);var Bc=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b,S,I,N,H){var Q=this.length;return this.resize(Q+1),this.emplace(Q,f,b,S,I,N,H)},u.prototype.emplace=function(f,b,S,I,N,H,Q){var rt=6*f;return this.int16[rt+0]=b,this.int16[rt+1]=S,this.int16[rt+2]=I,this.int16[rt+3]=N,this.int16[rt+4]=H,this.int16[rt+5]=Q,f},u}(vi);Bc.prototype.bytesPerElement=12,_r("StructArrayLayout2i4i12",Bc);var ii=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b,S,I,N,H){var Q=this.length;return this.resize(Q+1),this.emplace(Q,f,b,S,I,N,H)},u.prototype.emplace=function(f,b,S,I,N,H,Q){var rt=4*f,st=8*f;return this.int16[rt+0]=b,this.int16[rt+1]=S,this.uint8[st+4]=I,this.uint8[st+5]=N,this.uint8[st+6]=H,this.uint8[st+7]=Q,f},u}(vi);ii.prototype.bytesPerElement=8,_r("StructArrayLayout2i4ub8",ii);var ff=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b){var S=this.length;return this.resize(S+1),this.emplace(S,f,b)},u.prototype.emplace=function(f,b,S){var I=2*f;return this.float32[I+0]=b,this.float32[I+1]=S,f},u}(vi);ff.prototype.bytesPerElement=8,_r("StructArrayLayout2f8",ff);var Cl=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b,S,I,N,H,Q,rt,st,lt){var yt=this.length;return this.resize(yt+1),this.emplace(yt,f,b,S,I,N,H,Q,rt,st,lt)},u.prototype.emplace=function(f,b,S,I,N,H,Q,rt,st,lt,yt){var Tt=10*f;return this.uint16[Tt+0]=b,this.uint16[Tt+1]=S,this.uint16[Tt+2]=I,this.uint16[Tt+3]=N,this.uint16[Tt+4]=H,this.uint16[Tt+5]=Q,this.uint16[Tt+6]=rt,this.uint16[Tt+7]=st,this.uint16[Tt+8]=lt,this.uint16[Tt+9]=yt,f},u}(vi);Cl.prototype.bytesPerElement=20,_r("StructArrayLayout10ui20",Cl);var jd=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b,S,I,N,H,Q,rt,st,lt,yt,Tt){var kt=this.length;return this.resize(kt+1),this.emplace(kt,f,b,S,I,N,H,Q,rt,st,lt,yt,Tt)},u.prototype.emplace=function(f,b,S,I,N,H,Q,rt,st,lt,yt,Tt,kt){var Ut=12*f;return this.int16[Ut+0]=b,this.int16[Ut+1]=S,this.int16[Ut+2]=I,this.int16[Ut+3]=N,this.uint16[Ut+4]=H,this.uint16[Ut+5]=Q,this.uint16[Ut+6]=rt,this.uint16[Ut+7]=st,this.int16[Ut+8]=lt,this.int16[Ut+9]=yt,this.int16[Ut+10]=Tt,this.int16[Ut+11]=kt,f},u}(vi);jd.prototype.bytesPerElement=24,_r("StructArrayLayout4i4ui4i24",jd);var pf=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b,S){var I=this.length;return this.resize(I+1),this.emplace(I,f,b,S)},u.prototype.emplace=function(f,b,S,I){var N=3*f;return this.float32[N+0]=b,this.float32[N+1]=S,this.float32[N+2]=I,f},u}(vi);pf.prototype.bytesPerElement=12,_r("StructArrayLayout3f12",pf);var xp=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f){var b=this.length;return this.resize(b+1),this.emplace(b,f)},u.prototype.emplace=function(f,b){return this.uint32[1*f+0]=b,f},u}(vi);xp.prototype.bytesPerElement=4,_r("StructArrayLayout1ul4",xp);var IA=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b,S,I,N,H,Q,rt,st){var lt=this.length;return this.resize(lt+1),this.emplace(lt,f,b,S,I,N,H,Q,rt,st)},u.prototype.emplace=function(f,b,S,I,N,H,Q,rt,st,lt){var yt=10*f,Tt=5*f;return this.int16[yt+0]=b,this.int16[yt+1]=S,this.int16[yt+2]=I,this.int16[yt+3]=N,this.int16[yt+4]=H,this.int16[yt+5]=Q,this.uint32[Tt+3]=rt,this.uint16[yt+8]=st,this.uint16[yt+9]=lt,f},u}(vi);IA.prototype.bytesPerElement=20,_r("StructArrayLayout6i1ul2ui20",IA);var df=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b,S,I,N,H){var Q=this.length;return this.resize(Q+1),this.emplace(Q,f,b,S,I,N,H)},u.prototype.emplace=function(f,b,S,I,N,H,Q){var rt=6*f;return this.int16[rt+0]=b,this.int16[rt+1]=S,this.int16[rt+2]=I,this.int16[rt+3]=N,this.int16[rt+4]=H,this.int16[rt+5]=Q,f},u}(vi);df.prototype.bytesPerElement=12,_r("StructArrayLayout2i2i2i12",df);var As=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b,S,I,N){var H=this.length;return this.resize(H+1),this.emplace(H,f,b,S,I,N)},u.prototype.emplace=function(f,b,S,I,N,H){var Q=4*f,rt=8*f;return this.float32[Q+0]=b,this.float32[Q+1]=S,this.float32[Q+2]=I,this.int16[rt+6]=N,this.int16[rt+7]=H,f},u}(vi);As.prototype.bytesPerElement=16,_r("StructArrayLayout2f1f2i16",As);var vp=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b,S,I){var N=this.length;return this.resize(N+1),this.emplace(N,f,b,S,I)},u.prototype.emplace=function(f,b,S,I,N){var H=12*f,Q=3*f;return this.uint8[H+0]=b,this.uint8[H+1]=S,this.float32[Q+1]=I,this.float32[Q+2]=N,f},u}(vi);vp.prototype.bytesPerElement=12,_r("StructArrayLayout2ub2f12",vp);var Ya=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b,S){var I=this.length;return this.resize(I+1),this.emplace(I,f,b,S)},u.prototype.emplace=function(f,b,S,I){var N=3*f;return this.uint16[N+0]=b,this.uint16[N+1]=S,this.uint16[N+2]=I,f},u}(vi);Ya.prototype.bytesPerElement=6,_r("StructArrayLayout3ui6",Ya);var Ru=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b,S,I,N,H,Q,rt,st,lt,yt,Tt,kt,Ut,$t,qt,ie){var de=this.length;return this.resize(de+1),this.emplace(de,f,b,S,I,N,H,Q,rt,st,lt,yt,Tt,kt,Ut,$t,qt,ie)},u.prototype.emplace=function(f,b,S,I,N,H,Q,rt,st,lt,yt,Tt,kt,Ut,$t,qt,ie,de){var ge=24*f,we=12*f,De=48*f;return this.int16[ge+0]=b,this.int16[ge+1]=S,this.uint16[ge+2]=I,this.uint16[ge+3]=N,this.uint32[we+2]=H,this.uint32[we+3]=Q,this.uint32[we+4]=rt,this.uint16[ge+10]=st,this.uint16[ge+11]=lt,this.uint16[ge+12]=yt,this.float32[we+7]=Tt,this.float32[we+8]=kt,this.uint8[De+36]=Ut,this.uint8[De+37]=$t,this.uint8[De+38]=qt,this.uint32[we+10]=ie,this.int16[ge+22]=de,f},u}(vi);Ru.prototype.bytesPerElement=48,_r("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ru);var mf=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b,S,I,N,H,Q,rt,st,lt,yt,Tt,kt,Ut,$t,qt,ie,de,ge,we,De,Ke,or,Hr,vr,Zr,Tr,Ln){var un=this.length;return this.resize(un+1),this.emplace(un,f,b,S,I,N,H,Q,rt,st,lt,yt,Tt,kt,Ut,$t,qt,ie,de,ge,we,De,Ke,or,Hr,vr,Zr,Tr,Ln)},u.prototype.emplace=function(f,b,S,I,N,H,Q,rt,st,lt,yt,Tt,kt,Ut,$t,qt,ie,de,ge,we,De,Ke,or,Hr,vr,Zr,Tr,Ln,un){var Fr=34*f,Wn=17*f;return this.int16[Fr+0]=b,this.int16[Fr+1]=S,this.int16[Fr+2]=I,this.int16[Fr+3]=N,this.int16[Fr+4]=H,this.int16[Fr+5]=Q,this.int16[Fr+6]=rt,this.int16[Fr+7]=st,this.uint16[Fr+8]=lt,this.uint16[Fr+9]=yt,this.uint16[Fr+10]=Tt,this.uint16[Fr+11]=kt,this.uint16[Fr+12]=Ut,this.uint16[Fr+13]=$t,this.uint16[Fr+14]=qt,this.uint16[Fr+15]=ie,this.uint16[Fr+16]=de,this.uint16[Fr+17]=ge,this.uint16[Fr+18]=we,this.uint16[Fr+19]=De,this.uint16[Fr+20]=Ke,this.uint16[Fr+21]=or,this.uint16[Fr+22]=Hr,this.uint32[Wn+12]=vr,this.float32[Wn+13]=Zr,this.float32[Wn+14]=Tr,this.float32[Wn+15]=Ln,this.float32[Wn+16]=un,f},u}(vi);mf.prototype.bytesPerElement=68,_r("StructArrayLayout8i15ui1ul4f68",mf);var Lu=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f){var b=this.length;return this.resize(b+1),this.emplace(b,f)},u.prototype.emplace=function(f,b){return this.float32[1*f+0]=b,f},u}(vi);Lu.prototype.bytesPerElement=4,_r("StructArrayLayout1f4",Lu);var zo=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b,S){var I=this.length;return this.resize(I+1),this.emplace(I,f,b,S)},u.prototype.emplace=function(f,b,S,I){var N=3*f;return this.int16[N+0]=b,this.int16[N+1]=S,this.int16[N+2]=I,f},u}(vi);zo.prototype.bytesPerElement=6,_r("StructArrayLayout3i6",zo);var Hd=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b,S){var I=this.length;return this.resize(I+1),this.emplace(I,f,b,S)},u.prototype.emplace=function(f,b,S,I){var N=4*f;return this.uint32[2*f+0]=b,this.uint16[N+2]=S,this.uint16[N+3]=I,f},u}(vi);Hd.prototype.bytesPerElement=8,_r("StructArrayLayout1ul2ui8",Hd);var yh=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b){var S=this.length;return this.resize(S+1),this.emplace(S,f,b)},u.prototype.emplace=function(f,b,S){var I=2*f;return this.uint16[I+0]=b,this.uint16[I+1]=S,f},u}(vi);yh.prototype.bytesPerElement=4,_r("StructArrayLayout2ui4",yh);var Ou=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f){var b=this.length;return this.resize(b+1),this.emplace(b,f)},u.prototype.emplace=function(f,b){return this.uint16[1*f+0]=b,f},u}(vi);Ou.prototype.bytesPerElement=2,_r("StructArrayLayout1ui2",Ou);var Bu=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},u.prototype.emplaceBack=function(f,b,S,I){var N=this.length;return this.resize(N+1),this.emplace(N,f,b,S,I)},u.prototype.emplace=function(f,b,S,I,N){var H=4*f;return this.float32[H+0]=b,this.float32[H+1]=S,this.float32[H+2]=I,this.float32[H+3]=N,f},u}(vi);Bu.prototype.bytesPerElement=16,_r("StructArrayLayout4f16",Bu);var d=function(a){function u(){a.apply(this,arguments)}a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u;var f={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return f.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},f.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},f.x1.get=function(){return this._structArray.int16[this._pos2+2]},f.y1.get=function(){return this._structArray.int16[this._pos2+3]},f.x2.get=function(){return this._structArray.int16[this._pos2+4]},f.y2.get=function(){return this._structArray.int16[this._pos2+5]},f.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},f.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},f.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},f.anchorPoint.get=function(){return new l(this.anchorPointX,this.anchorPointY)},Object.defineProperties(u.prototype,f),u}(hf);d.prototype.size=20;var y=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.get=function(f){return new d(this,f)},u}(IA);_r("CollisionBoxArray",y);var m=function(a){function u(){a.apply(this,arguments)}a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u;var f={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return f.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},f.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},f.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},f.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},f.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},f.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},f.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},f.segment.get=function(){return this._structArray.uint16[this._pos2+10]},f.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},f.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},f.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},f.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},f.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},f.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},f.placedOrientation.set=function(b){this._structArray.uint8[this._pos1+37]=b},f.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},f.hidden.set=function(b){this._structArray.uint8[this._pos1+38]=b},f.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},f.crossTileID.set=function(b){this._structArray.uint32[this._pos4+10]=b},f.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(u.prototype,f),u}(hf);m.prototype.size=48;var T=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.get=function(f){return new m(this,f)},u}(Ru);_r("PlacedSymbolArray",T);var O=function(a){function u(){a.apply(this,arguments)}a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u;var f={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return f.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},f.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},f.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},f.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},f.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},f.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},f.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},f.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},f.key.get=function(){return this._structArray.uint16[this._pos2+8]},f.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},f.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},f.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},f.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},f.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},f.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},f.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},f.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},f.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},f.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},f.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},f.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},f.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},f.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},f.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},f.crossTileID.set=function(b){this._structArray.uint32[this._pos4+12]=b},f.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},f.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},f.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},f.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(u.prototype,f),u}(hf);O.prototype.size=68;var U=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.get=function(f){return new O(this,f)},u}(mf);_r("SymbolInstanceArray",U);var j=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.getoffsetX=function(f){return this.float32[1*f+0]},u}(Lu);_r("GlyphOffsetArray",j);var K=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.getx=function(f){return this.int16[3*f+0]},u.prototype.gety=function(f){return this.int16[3*f+1]},u.prototype.gettileUnitDistanceFromAnchor=function(f){return this.int16[3*f+2]},u}(zo);_r("SymbolLineVertexArray",K);var it=function(a){function u(){a.apply(this,arguments)}a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u;var f={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return f.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},f.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},f.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(u.prototype,f),u}(hf);it.prototype.size=8;var pt=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.get=function(f){return new it(this,f)},u}(Hd);_r("FeatureIndexArray",pt);var Et=Ss([{name:"a_pos",components:2,type:"Int16"}],4).members,Ct=function(a){a===void 0&&(a=[]),this.segments=a};function Pt(a,u){return 256*(a=P(Math.floor(a),0,255))+P(Math.floor(u),0,255)}Ct.prototype.prepareSegment=function(a,u,f,b){var S=this.segments[this.segments.length-1];return a>Ct.MAX_VERTEX_ARRAY_LENGTH&&mt("Max vertices per segment is "+Ct.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+a),(!S||S.vertexLength+a>Ct.MAX_VERTEX_ARRAY_LENGTH||S.sortKey!==b)&&(S={vertexOffset:u.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},b!==void 0&&(S.sortKey=b),this.segments.push(S)),S},Ct.prototype.get=function(){return this.segments},Ct.prototype.destroy=function(){for(var a=0,u=this.segments;a<u.length;a+=1){var f=u[a];for(var b in f.vaos)f.vaos[b].destroy()}},Ct.simpleSegment=function(a,u,f,b){return new Ct([{vertexOffset:a,primitiveOffset:u,vertexLength:f,primitiveLength:b,vaos:{},sortKey:0}])},Ct.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,_r("SegmentVector",Ct);var Vt=Ss([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Ft=o(function(a){a.exports=function(u,f){var b,S,I,N,H,Q,rt,st;for(S=u.length-(b=3&u.length),I=f,H=3432918353,Q=461845907,st=0;st<S;)rt=255&u.charCodeAt(st)|(255&u.charCodeAt(++st))<<8|(255&u.charCodeAt(++st))<<16|(255&u.charCodeAt(++st))<<24,++st,I=27492+(65535&(N=5*(65535&(I=(I^=rt=(65535&(rt=(rt=(65535&rt)*H+(((rt>>>16)*H&65535)<<16)&4294967295)<<15|rt>>>17))*Q+(((rt>>>16)*Q&65535)<<16)&4294967295)<<13|I>>>19))+((5*(I>>>16)&65535)<<16)&4294967295))+((58964+(N>>>16)&65535)<<16);switch(rt=0,b){case 3:rt^=(255&u.charCodeAt(st+2))<<16;case 2:rt^=(255&u.charCodeAt(st+1))<<8;case 1:I^=rt=(65535&(rt=(rt=(65535&(rt^=255&u.charCodeAt(st)))*H+(((rt>>>16)*H&65535)<<16)&4294967295)<<15|rt>>>17))*Q+(((rt>>>16)*Q&65535)<<16)&4294967295}return I^=u.length,I=2246822507*(65535&(I^=I>>>16))+((2246822507*(I>>>16)&65535)<<16)&4294967295,I=3266489909*(65535&(I^=I>>>13))+((3266489909*(I>>>16)&65535)<<16)&4294967295,(I^=I>>>16)>>>0}}),Yt=o(function(a){a.exports=function(u,f){for(var b,S=u.length,I=f^S,N=0;S>=4;)b=1540483477*(65535&(b=255&u.charCodeAt(N)|(255&u.charCodeAt(++N))<<8|(255&u.charCodeAt(++N))<<16|(255&u.charCodeAt(++N))<<24))+((1540483477*(b>>>16)&65535)<<16),I=1540483477*(65535&I)+((1540483477*(I>>>16)&65535)<<16)^(b=1540483477*(65535&(b^=b>>>24))+((1540483477*(b>>>16)&65535)<<16)),S-=4,++N;switch(S){case 3:I^=(255&u.charCodeAt(N+2))<<16;case 2:I^=(255&u.charCodeAt(N+1))<<8;case 1:I=1540483477*(65535&(I^=255&u.charCodeAt(N)))+((1540483477*(I>>>16)&65535)<<16)}return I=1540483477*(65535&(I^=I>>>13))+((1540483477*(I>>>16)&65535)<<16),(I^=I>>>15)>>>0}}),Dt=Ft,Xt=Yt;Dt.murmur3=Ft,Dt.murmur2=Xt;var te=function(){this.ids=[],this.positions=[],this.indexed=!1};te.prototype.add=function(a,u,f,b){this.ids.push(be(a)),this.positions.push(u,f,b)},te.prototype.getPositions=function(a){for(var u=be(a),f=0,b=this.ids.length-1;f<b;){var S=f+b>>1;this.ids[S]>=u?b=S:f=S+1}for(var I=[];this.ids[f]===u;)I.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return I},te.serialize=function(a,u){var f=new Float64Array(a.ids),b=new Uint32Array(a.positions);return function S(I,N,H,Q){for(;H<Q;){for(var rt=I[H+Q>>1],st=H-1,lt=Q+1;;){do st++;while(I[st]<rt);do lt--;while(I[lt]>rt);if(st>=lt)break;Ae(I,st,lt),Ae(N,3*st,3*lt),Ae(N,3*st+1,3*lt+1),Ae(N,3*st+2,3*lt+2)}lt-H<Q-lt?(S(I,N,H,lt),H=lt+1):(S(I,N,lt+1,Q),Q=lt)}}(f,b,0,f.length-1),u&&u.push(f.buffer,b.buffer),{ids:f,positions:b}},te.deserialize=function(a){var u=new te;return u.ids=a.ids,u.positions=a.positions,u.indexed=!0,u};var le=Math.pow(2,53)-1;function be(a){var u=+a;return!isNaN(u)&&u<=le?u:Dt(String(a))}function Ae(a,u,f){var b=a[u];a[u]=a[f],a[f]=b}_r("FeaturePositionMap",te);var Me=function(a,u){this.gl=a.gl,this.location=u},Ve=function(a){function u(f,b){a.call(this,f,b),this.current=0}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.set=function(f){this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))},u}(Me),Je=function(a){function u(f,b){a.call(this,f,b),this.current=0}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.set=function(f){this.current!==f&&(this.current=f,this.gl.uniform1f(this.location,f))},u}(Me),$e=function(a){function u(f,b){a.call(this,f,b),this.current=[0,0]}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.set=function(f){f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1]))},u}(Me),wr=function(a){function u(f,b){a.call(this,f,b),this.current=[0,0,0]}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.set=function(f){f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2]))},u}(Me),qr=function(a){function u(f,b){a.call(this,f,b),this.current=[0,0,0,0]}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.set=function(f){f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]&&f[3]===this.current[3]||(this.current=f,this.gl.uniform4f(this.location,f[0],f[1],f[2],f[3]))},u}(Me),$r=function(a){function u(f,b){a.call(this,f,b),this.current=ci.transparent}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.set=function(f){f.r===this.current.r&&f.g===this.current.g&&f.b===this.current.b&&f.a===this.current.a||(this.current=f,this.gl.uniform4f(this.location,f.r,f.g,f.b,f.a))},u}(Me),Kr=new Float32Array(16),ei=function(a){function u(f,b){a.call(this,f,b),this.current=Kr}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.set=function(f){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(var b=1;b<16;b++)if(f[b]!==this.current[b]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}},u}(Me);function Sr(a){return[Pt(255*a.r,255*a.g),Pt(255*a.b,255*a.a)]}var mn=function(a,u,f){this.value=a,this.uniformNames=u.map(function(b){return"u_"+b}),this.type=f};mn.prototype.setUniform=function(a,u,f){a.set(f.constantOr(this.value))},mn.prototype.getBinding=function(a,u,f){return this.type==="color"?new $r(a,u):new Je(a,u)};var An=function(a,u){this.uniformNames=u.map(function(f){return"u_"+f}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};An.prototype.setConstantPatternPositions=function(a,u){this.pixelRatioFrom=u.pixelRatio,this.pixelRatioTo=a.pixelRatio,this.patternFrom=u.tlbr,this.patternTo=a.tlbr},An.prototype.setUniform=function(a,u,f,b){var S=b==="u_pattern_to"?this.patternTo:b==="u_pattern_from"?this.patternFrom:b==="u_pixel_ratio_to"?this.pixelRatioTo:b==="u_pixel_ratio_from"?this.pixelRatioFrom:null;S&&a.set(S)},An.prototype.getBinding=function(a,u,f){return f.substr(0,9)==="u_pattern"?new qr(a,u):new Je(a,u)};var cn=function(a,u,f,b){this.expression=a,this.type=f,this.maxValue=0,this.paintVertexAttributes=u.map(function(S){return{name:"a_"+S,type:"Float32",components:f==="color"?2:1,offset:0}}),this.paintVertexArray=new b};cn.prototype.populatePaintArray=function(a,u,f,b,S){var I=this.paintVertexArray.length,N=this.expression.evaluate(new Un(0),u,{},b,[],S);this.paintVertexArray.resize(a),this._setPaintValue(I,a,N)},cn.prototype.updatePaintArray=function(a,u,f,b){var S=this.expression.evaluate({zoom:0},f,b);this._setPaintValue(a,u,S)},cn.prototype._setPaintValue=function(a,u,f){if(this.type==="color")for(var b=Sr(f),S=a;S<u;S++)this.paintVertexArray.emplace(S,b[0],b[1]);else{for(var I=a;I<u;I++)this.paintVertexArray.emplace(I,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}},cn.prototype.upload=function(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},cn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var ln=function(a,u,f,b,S,I){this.expression=a,this.uniformNames=u.map(function(N){return"u_"+N+"_t"}),this.type=f,this.useIntegerZoom=b,this.zoom=S,this.maxValue=0,this.paintVertexAttributes=u.map(function(N){return{name:"a_"+N,type:"Float32",components:f==="color"?4:2,offset:0}}),this.paintVertexArray=new I};ln.prototype.populatePaintArray=function(a,u,f,b,S){var I=this.expression.evaluate(new Un(this.zoom),u,{},b,[],S),N=this.expression.evaluate(new Un(this.zoom+1),u,{},b,[],S),H=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(H,a,I,N)},ln.prototype.updatePaintArray=function(a,u,f,b){var S=this.expression.evaluate({zoom:this.zoom},f,b),I=this.expression.evaluate({zoom:this.zoom+1},f,b);this._setPaintValue(a,u,S,I)},ln.prototype._setPaintValue=function(a,u,f,b){if(this.type==="color")for(var S=Sr(f),I=Sr(b),N=a;N<u;N++)this.paintVertexArray.emplace(N,S[0],S[1],I[0],I[1]);else{for(var H=a;H<u;H++)this.paintVertexArray.emplace(H,f,b);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(b))}},ln.prototype.upload=function(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ln.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ln.prototype.setUniform=function(a,u){var f=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,b=P(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);a.set(b)},ln.prototype.getBinding=function(a,u,f){return new Je(a,u)};var Tn=function(a,u,f,b,S,I){this.expression=a,this.type=u,this.useIntegerZoom=f,this.zoom=b,this.layerId=I,this.zoomInPaintVertexArray=new S,this.zoomOutPaintVertexArray=new S};Tn.prototype.populatePaintArray=function(a,u,f){var b=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(a),this.zoomOutPaintVertexArray.resize(a),this._setPaintValues(b,a,u.patterns&&u.patterns[this.layerId],f)},Tn.prototype.updatePaintArray=function(a,u,f,b,S){this._setPaintValues(a,u,f.patterns&&f.patterns[this.layerId],S)},Tn.prototype._setPaintValues=function(a,u,f,b){if(b&&f){var S=b[f.min],I=b[f.mid],N=b[f.max];if(S&&I&&N)for(var H=a;H<u;H++)this.zoomInPaintVertexArray.emplace(H,I.tl[0],I.tl[1],I.br[0],I.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],I.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(H,I.tl[0],I.tl[1],I.br[0],I.br[1],N.tl[0],N.tl[1],N.br[0],N.br[1],I.pixelRatio,N.pixelRatio)}},Tn.prototype.upload=function(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,Vt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,Vt.members,this.expression.isStateDependent))},Tn.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var an=function(a,u,f){this.binders={},this._buffers=[];var b=[];for(var S in a.paint._values)if(f(S)){var I=a.paint.get(S);if(I instanceof Es&&Hi(I.property.specification)){var N=gs(S,a.type),H=I.value,Q=I.property.specification.type,rt=I.property.useIntegerZoom,st=I.property.specification["property-type"],lt=st==="cross-faded"||st==="cross-faded-data-driven";if(H.kind==="constant")this.binders[S]=lt?new An(H.value,N):new mn(H.value,N,Q),b.push("/u_"+S);else if(H.kind==="source"||lt){var yt=Fi(S,Q,"source");this.binders[S]=lt?new Tn(H,Q,rt,u,yt,a.id):new cn(H,N,Q,yt),b.push("/a_"+S)}else{var Tt=Fi(S,Q,"composite");this.binders[S]=new ln(H,N,Q,rt,u,Tt),b.push("/z_"+S)}}}this.cacheKey=b.sort().join("")};an.prototype.getMaxValue=function(a){var u=this.binders[a];return u instanceof cn||u instanceof ln?u.maxValue:0},an.prototype.populatePaintArrays=function(a,u,f,b,S){for(var I in this.binders){var N=this.binders[I];(N instanceof cn||N instanceof ln||N instanceof Tn)&&N.populatePaintArray(a,u,f,b,S)}},an.prototype.setConstantPatternPositions=function(a,u){for(var f in this.binders){var b=this.binders[f];b instanceof An&&b.setConstantPatternPositions(a,u)}},an.prototype.updatePaintArrays=function(a,u,f,b,S){var I=!1;for(var N in a)for(var H=0,Q=u.getPositions(N);H<Q.length;H+=1){var rt=Q[H],st=f.feature(rt.index);for(var lt in this.binders){var yt=this.binders[lt];if((yt instanceof cn||yt instanceof ln||yt instanceof Tn)&&yt.expression.isStateDependent===!0){var Tt=b.paint.get(lt);yt.expression=Tt.value,yt.updatePaintArray(rt.start,rt.end,st,a[N],S),I=!0}}}return I},an.prototype.defines=function(){var a=[];for(var u in this.binders){var f=this.binders[u];(f instanceof mn||f instanceof An)&&a.push.apply(a,f.uniformNames.map(function(b){return"#define HAS_UNIFORM_"+b}))}return a},an.prototype.getBinderAttributes=function(){var a=[];for(var u in this.binders){var f=this.binders[u];if(f instanceof cn||f instanceof ln)for(var b=0;b<f.paintVertexAttributes.length;b++)a.push(f.paintVertexAttributes[b].name);else if(f instanceof Tn)for(var S=0;S<Vt.members.length;S++)a.push(Vt.members[S].name)}return a},an.prototype.getBinderUniforms=function(){var a=[];for(var u in this.binders){var f=this.binders[u];if(f instanceof mn||f instanceof An||f instanceof ln)for(var b=0,S=f.uniformNames;b<S.length;b+=1)a.push(S[b])}return a},an.prototype.getPaintVertexBuffers=function(){return this._buffers},an.prototype.getUniforms=function(a,u){var f=[];for(var b in this.binders){var S=this.binders[b];if(S instanceof mn||S instanceof An||S instanceof ln)for(var I=0,N=S.uniformNames;I<N.length;I+=1){var H=N[I];if(u[H]){var Q=S.getBinding(a,u[H],H);f.push({name:H,property:b,binding:Q})}}}return f},an.prototype.setUniforms=function(a,u,f,b){for(var S=0,I=u;S<I.length;S+=1){var N=I[S],H=N.name,Q=N.property;this.binders[Q].setUniform(N.binding,b,f.get(Q),H)}},an.prototype.updatePaintBuffers=function(a){for(var u in this._buffers=[],this.binders){var f=this.binders[u];if(a&&f instanceof Tn){var b=a.fromScale===2?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer;b&&this._buffers.push(b)}else(f instanceof cn||f instanceof ln)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}},an.prototype.upload=function(a){for(var u in this.binders){var f=this.binders[u];(f instanceof cn||f instanceof ln||f instanceof Tn)&&f.upload(a)}this.updatePaintBuffers()},an.prototype.destroy=function(){for(var a in this.binders){var u=this.binders[a];(u instanceof cn||u instanceof ln||u instanceof Tn)&&u.destroy()}};var en=function(a,u,f){f===void 0&&(f=function(){return!0}),this.programConfigurations={};for(var b=0,S=a;b<S.length;b+=1){var I=S[b];this.programConfigurations[I.id]=new an(I,u,f)}this.needsUpload=!1,this._featureMap=new te,this._bufferOffset=0};function gs(a,u){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(u+"-","").replace(/-/g,"_")]}function Fi(a,u,f){var b={color:{source:ff,composite:Bu},number:{source:Lu,composite:ff}},S=function(I){return{"line-pattern":{source:Cl,composite:Cl},"fill-pattern":{source:Cl,composite:Cl},"fill-extrusion-pattern":{source:Cl,composite:Cl}}[I]}(a);return S&&S[f]||b[u][f]}en.prototype.populatePaintArrays=function(a,u,f,b,S,I){for(var N in this.programConfigurations)this.programConfigurations[N].populatePaintArrays(a,u,b,S,I);u.id!==void 0&&this._featureMap.add(u.id,f,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0},en.prototype.updatePaintArrays=function(a,u,f,b){for(var S=0,I=f;S<I.length;S+=1){var N=I[S];this.needsUpload=this.programConfigurations[N.id].updatePaintArrays(a,this._featureMap,u,N,b)||this.needsUpload}},en.prototype.get=function(a){return this.programConfigurations[a]},en.prototype.upload=function(a){if(this.needsUpload){for(var u in this.programConfigurations)this.programConfigurations[u].upload(a);this.needsUpload=!1}},en.prototype.destroy=function(){for(var a in this.programConfigurations)this.programConfigurations[a].destroy()},_r("ConstantBinder",mn),_r("CrossFadedConstantBinder",An),_r("SourceExpressionBinder",cn),_r("CrossFadedCompositeBinder",Tn),_r("CompositeExpressionBinder",ln),_r("ProgramConfiguration",an,{omit:["_buffers"]}),_r("ProgramConfigurationSet",en);var Vs=Math.pow(2,14)-1,_s=-Vs-1;function vo(a){for(var u=8192/a.extent,f=a.loadGeometry(),b=0;b<f.length;b++)for(var S=f[b],I=0;I<S.length;I++){var N=S[I],H=Math.round(N.x*u),Q=Math.round(N.y*u);N.x=P(H,_s,Vs),N.y=P(Q,_s,Vs),(H<N.x||H>N.x+1||Q<N.y||Q>N.y+1)&&mt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return f}function Uo(a,u){return{type:a.type,id:a.id,properties:a.properties,geometry:u?vo(a):[]}}function Ka(a,u,f,b,S){a.emplaceBack(2*u+(b+1)/2,2*f+(S+1)/2)}var ga=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new nu,this.indexArray=new Ya,this.segments=new Ct,this.programConfigurations=new en(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};function Du(a,u){for(var f=0;f<a.length;f++)if(Ki(u,a[f]))return!0;for(var b=0;b<u.length;b++)if(Ki(a,u[b]))return!0;return!!bp(a,u)}function La(a,u,f){return!!Ki(a,u)||!!Nu(u,a,f)}function sl(a,u){if(a.length===1)return gf(u,a[0]);for(var f=0;f<u.length;f++)for(var b=u[f],S=0;S<b.length;S++)if(Ki(a,b[S]))return!0;for(var I=0;I<a.length;I++)if(gf(u,a[I]))return!0;for(var N=0;N<u.length;N++)if(bp(a,u[N]))return!0;return!1}function Dc(a,u,f){if(a.length>1){if(bp(a,u))return!0;for(var b=0;b<u.length;b++)if(Nu(u[b],a,f))return!0}for(var S=0;S<a.length;S++)if(Nu(a[S],u,f))return!0;return!1}function bp(a,u){if(a.length===0||u.length===0)return!1;for(var f=0;f<a.length-1;f++)for(var b=a[f],S=a[f+1],I=0;I<u.length-1;I++)if(Af(b,S,u[I],u[I+1]))return!0;return!1}function Af(a,u,f,b){return Mt(a,f,b)!==Mt(u,f,b)&&Mt(a,u,f)!==Mt(a,u,b)}function Nu(a,u,f){var b=f*f;if(u.length===1)return a.distSqr(u[0])<b;for(var S=1;S<u.length;S++)if(xh(a,u[S-1],u[S])<b)return!0;return!1}function xh(a,u,f){var b=u.distSqr(f);if(b===0)return a.distSqr(u);var S=((a.x-u.x)*(f.x-u.x)+(a.y-u.y)*(f.y-u.y))/b;return a.distSqr(S<0?u:S>1?f:f.sub(u)._mult(S)._add(u))}function gf(a,u){for(var f,b,S,I=!1,N=0;N<a.length;N++)for(var H=0,Q=(f=a[N]).length-1;H<f.length;Q=H++)(b=f[H]).y>u.y!=(S=f[Q]).y>u.y&&u.x<(S.x-b.x)*(u.y-b.y)/(S.y-b.y)+b.x&&(I=!I);return I}function Ki(a,u){for(var f=!1,b=0,S=a.length-1;b<a.length;S=b++){var I=a[b],N=a[S];I.y>u.y!=N.y>u.y&&u.x<(N.x-I.x)*(u.y-I.y)/(N.y-I.y)+I.x&&(f=!f)}return f}function wp(a,u,f){var b=f[0],S=f[2];if(a.x<b.x&&u.x<b.x||a.x>S.x&&u.x>S.x||a.y<b.y&&u.y<b.y||a.y>S.y&&u.y>S.y)return!1;var I=Mt(a,u,f[0]);return I!==Mt(a,u,f[1])||I!==Mt(a,u,f[2])||I!==Mt(a,u,f[3])}function Pl(a,u,f){var b=u.paint.get(a).value;return b.kind==="constant"?b.value:f.programConfigurations.get(u.id).getMaxValue(a)}function Ro(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function ys(a,u,f,b,S){if(!u[0]&&!u[1])return a;var I=l.convert(u)._mult(S);f==="viewport"&&I._rotate(-b);for(var N=[],H=0;H<a.length;H++)N.push(a[H].sub(I));return N}ga.prototype.populate=function(a,u,f){var b=this.layers[0],S=[],I=null;b.type==="circle"&&(I=b.layout.get("circle-sort-key"));for(var N=0,H=a;N<H.length;N+=1){var Q=H[N],rt=Q.feature,st=Q.id,lt=Q.index,yt=Q.sourceLayerIndex,Tt=this.layers[0]._featureFilter.needGeometry,kt=Uo(rt,Tt);if(this.layers[0]._featureFilter.filter(new Un(this.zoom),kt,f)){var Ut=I?I.evaluate(kt,{},f):void 0,$t={id:st,properties:rt.properties,type:rt.type,sourceLayerIndex:yt,index:lt,geometry:Tt?kt.geometry:vo(rt),patterns:{},sortKey:Ut};S.push($t)}}I&&S.sort(function(or,Hr){return or.sortKey-Hr.sortKey});for(var qt=0,ie=S;qt<ie.length;qt+=1){var de=ie[qt],ge=de.geometry,we=de.index,De=de.sourceLayerIndex,Ke=a[we].feature;this.addFeature(de,ge,we,f),u.featureIndex.insert(Ke,ge,we,De,this.index)}},ga.prototype.update=function(a,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f)},ga.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ga.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ga.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Et),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},ga.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ga.prototype.addFeature=function(a,u,f,b){for(var S=0,I=u;S<I.length;S+=1)for(var N=0,H=I[S];N<H.length;N+=1){var Q=H[N],rt=Q.x,st=Q.y;if(!(rt<0||rt>=8192||st<0||st>=8192)){var lt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),yt=lt.vertexLength;Ka(this.layoutVertexArray,rt,st,-1,-1),Ka(this.layoutVertexArray,rt,st,1,-1),Ka(this.layoutVertexArray,rt,st,1,1),Ka(this.layoutVertexArray,rt,st,-1,1),this.indexArray.emplaceBack(yt,yt+1,yt+2),this.indexArray.emplaceBack(yt,yt+3,yt+2),lt.vertexLength+=4,lt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,{},b)},_r("CircleBucket",ga,{omit:["layers"]});var ku=new Ms({"circle-sort-key":new Or(St.layout_circle["circle-sort-key"])}),vh={paint:new Ms({"circle-radius":new Or(St.paint_circle["circle-radius"]),"circle-color":new Or(St.paint_circle["circle-color"]),"circle-blur":new Or(St.paint_circle["circle-blur"]),"circle-opacity":new Or(St.paint_circle["circle-opacity"]),"circle-translate":new Wr(St.paint_circle["circle-translate"]),"circle-translate-anchor":new Wr(St.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Wr(St.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Wr(St.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Or(St.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Or(St.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Or(St.paint_circle["circle-stroke-opacity"])}),layout:ku},gi=typeof Float32Array<"u"?Float32Array:Array;function Za(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function _a(a,u,f){var b=u[0],S=u[1],I=u[2],N=u[3],H=u[4],Q=u[5],rt=u[6],st=u[7],lt=u[8],yt=u[9],Tt=u[10],kt=u[11],Ut=u[12],$t=u[13],qt=u[14],ie=u[15],de=f[0],ge=f[1],we=f[2],De=f[3];return a[0]=de*b+ge*H+we*lt+De*Ut,a[1]=de*S+ge*Q+we*yt+De*$t,a[2]=de*I+ge*rt+we*Tt+De*qt,a[3]=de*N+ge*st+we*kt+De*ie,a[4]=(de=f[4])*b+(ge=f[5])*H+(we=f[6])*lt+(De=f[7])*Ut,a[5]=de*S+ge*Q+we*yt+De*$t,a[6]=de*I+ge*rt+we*Tt+De*qt,a[7]=de*N+ge*st+we*kt+De*ie,a[8]=(de=f[8])*b+(ge=f[9])*H+(we=f[10])*lt+(De=f[11])*Ut,a[9]=de*S+ge*Q+we*yt+De*$t,a[10]=de*I+ge*rt+we*Tt+De*qt,a[11]=de*N+ge*st+we*kt+De*ie,a[12]=(de=f[12])*b+(ge=f[13])*H+(we=f[14])*lt+(De=f[15])*Ut,a[13]=de*S+ge*Q+we*yt+De*$t,a[14]=de*I+ge*rt+we*Tt+De*qt,a[15]=de*N+ge*st+we*kt+De*ie,a}Math.hypot||(Math.hypot=function(){for(var a=arguments,u=0,f=arguments.length;f--;)u+=a[f]*a[f];return Math.sqrt(u)});var Fu,Ng=_a;function Wd(a,u,f){var b=u[0],S=u[1],I=u[2],N=u[3];return a[0]=f[0]*b+f[4]*S+f[8]*I+f[12]*N,a[1]=f[1]*b+f[5]*S+f[9]*I+f[13]*N,a[2]=f[2]*b+f[6]*S+f[10]*I+f[14]*N,a[3]=f[3]*b+f[7]*S+f[11]*I+f[15]*N,a}Fu=new gi(3),gi!=Float32Array&&(Fu[0]=0,Fu[1]=0,Fu[2]=0),function(){var a=new gi(4);gi!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0,a[3]=0)}();var Cx=(function(){var a=new gi(2);gi!=Float32Array&&(a[0]=0,a[1]=0)}(),function(a){function u(f){a.call(this,f,vh)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.createBucket=function(f){return new ga(f)},u.prototype.queryRadius=function(f){var b=f;return Pl("circle-radius",this,b)+Pl("circle-stroke-width",this,b)+Ro(this.paint.get("circle-translate"))},u.prototype.queryIntersectsFeature=function(f,b,S,I,N,H,Q,rt){for(var st=ys(f,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),H.angle,Q),lt=this.paint.get("circle-radius").evaluate(b,S)+this.paint.get("circle-stroke-width").evaluate(b,S),yt=this.paint.get("circle-pitch-alignment")==="map",Tt=yt?st:function(Ke,or){return Ke.map(function(Hr){return Tp(Hr,or)})}(st,rt),kt=yt?lt*Q:lt,Ut=0,$t=I;Ut<$t.length;Ut+=1)for(var qt=0,ie=$t[Ut];qt<ie.length;qt+=1){var de=ie[qt],ge=yt?de:Tp(de,rt),we=kt,De=Wd([],[de.x,de.y,0,1],rt);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?we*=De[3]/H.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(we*=H.cameraToCenterDistance/De[3]),La(Tt,ge,we))return!0}return!1},u}(Ra));function Tp(a,u){var f=Wd([],[a.x,a.y,0,1],u);return new l(f[0]/f[3],f[1]/f[3])}var kg=function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u}(ga);function _f(a,u,f,b){var S=u.width,I=u.height;if(b){if(b instanceof Uint8ClampedArray)b=new Uint8Array(b.buffer);else if(b.length!==S*I*f)throw new RangeError("mismatched image size")}else b=new Uint8Array(S*I*f);return a.width=S,a.height=I,a.data=b,a}function al(a,u,f){var b=u.width,S=u.height;if(b!==a.width||S!==a.height){var I=_f({},{width:b,height:S},f);Il(a,I,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,b),height:Math.min(a.height,S)},f),a.width=b,a.height=S,a.data=I.data}}function Il(a,u,f,b,S,I){if(S.width===0||S.height===0)return u;if(S.width>a.width||S.height>a.height||f.x>a.width-S.width||f.y>a.height-S.height)throw new RangeError("out of range source coordinates for image copy");if(S.width>u.width||S.height>u.height||b.x>u.width-S.width||b.y>u.height-S.height)throw new RangeError("out of range destination coordinates for image copy");for(var N=a.data,H=u.data,Q=0;Q<S.height;Q++)for(var rt=((f.y+Q)*a.width+f.x)*I,st=((b.y+Q)*u.width+b.x)*I,lt=0;lt<S.width*I;lt++)H[st+lt]=N[rt+lt];return u}_r("HeatmapBucket",kg,{omit:["layers"]});var vn=function(a,u){_f(this,a,1,u)};vn.prototype.resize=function(a){al(this,a,1)},vn.prototype.clone=function(){return new vn({width:this.width,height:this.height},new Uint8Array(this.data))},vn.copy=function(a,u,f,b,S){Il(a,u,f,b,S,1)};var Vo=function(a,u){_f(this,a,4,u)};Vo.prototype.resize=function(a){al(this,a,4)},Vo.prototype.replace=function(a,u){u?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a},Vo.prototype.clone=function(){return new Vo({width:this.width,height:this.height},new Uint8Array(this.data))},Vo.copy=function(a,u,f,b,S){Il(a,u,f,b,S,4)},_r("AlphaImage",vn),_r("RGBAImage",Vo);var ui={paint:new Ms({"heatmap-radius":new Or(St.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Or(St.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Wr(St.paint_heatmap["heatmap-intensity"]),"heatmap-color":new yc(St.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Wr(St.paint_heatmap["heatmap-opacity"])})};function Oa(a){var u={},f=a.resolution||256,b=a.clips?a.clips.length:1,S=a.image||new Vo({width:f,height:b}),I=function(kt,Ut,$t){u[a.evaluationKey]=$t;var qt=a.expression.evaluate(u);S.data[kt+Ut+0]=Math.floor(255*qt.r/qt.a),S.data[kt+Ut+1]=Math.floor(255*qt.g/qt.a),S.data[kt+Ut+2]=Math.floor(255*qt.b/qt.a),S.data[kt+Ut+3]=Math.floor(255*qt.a)};if(a.clips)for(var N=0,H=0;N<b;++N,H+=4*f)for(var Q=0,rt=0;Q<f;Q++,rt+=4){var st=Q/(f-1),lt=a.clips[N];I(H,rt,lt.start*(1-st)+lt.end*st)}else for(var yt=0,Tt=0;yt<f;yt++,Tt+=4)I(0,Tt,yt/(f-1));return S}var UT=function(a){function u(f){a.call(this,f,ui),this._updateColorRamp()}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.createBucket=function(f){return new kg(f)},u.prototype._handleSpecialPaintPropertyUpdate=function(f){f==="heatmap-color"&&this._updateColorRamp()},u.prototype._updateColorRamp=function(){this.colorRamp=Oa({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},u.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},u.prototype.queryRadius=function(){return 0},u.prototype.queryIntersectsFeature=function(){return!1},u.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},u}(Ra),Px={paint:new Ms({"hillshade-illumination-direction":new Wr(St.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Wr(St.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Wr(St.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Wr(St.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Wr(St.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Wr(St.paint_hillshade["hillshade-accent-color"])})},Ep=function(a){function u(f){a.call(this,f,Px)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},u}(Ra),JR=Ss([{name:"a_pos",components:2,type:"Int16"}],4).members,ya=bh,Fg=bh;function bh(a,u,f){f=f||2;var b,S,I,N,H,Q,rt,st=u&&u.length,lt=st?u[0]*f:a.length,yt=Ix(a,0,lt,f,!0),Tt=[];if(!yt||yt.next===yt.prev)return Tt;if(st&&(yt=function(Ut,$t,qt,ie){var de,ge,we,De=[];for(de=0,ge=$t.length;de<ge;de++)(we=Ix(Ut,$t[de]*ie,de<ge-1?$t[de+1]*ie:Ut.length,ie,!1))===we.next&&(we.steiner=!0),De.push(A(we));for(De.sort(Mp),de=0;de<De.length;de++)jT(De[de],qt),qt=Qe(qt,qt.next);return qt}(a,u,yt,f)),a.length>80*f){b=I=a[0],S=N=a[1];for(var kt=f;kt<lt;kt+=f)(H=a[kt])<b&&(b=H),(Q=a[kt+1])<S&&(S=Q),H>I&&(I=H),Q>N&&(N=Q);rt=(rt=Math.max(I-b,N-S))!==0?1/rt:0}return xr(yt,Tt,f,b,S,rt),Tt}function Ix(a,u,f,b,S){var I,N;if(S===Gt(a,u,f,b)>0)for(I=u;I<f;I+=b)N=Ot(I,a[I],a[I+1],N);else for(I=f-b;I>=u;I-=b)N=Ot(I,a[I],a[I+1],N);return N&&L(N,N.next)&&(Zt(N),N=N.next),N}function Qe(a,u){if(!a)return a;u||(u=a);var f,b=a;do if(f=!1,b.steiner||!L(b,b.next)&&C(b.prev,b,b.next)!==0)b=b.next;else{if(Zt(b),(b=u=b.prev)===b.next)break;f=!0}while(f||b!==u);return u}function xr(a,u,f,b,S,I,N){if(a){!N&&I&&function(st,lt,yt,Tt){var kt=st;do kt.z===null&&(kt.z=g(kt.x,kt.y,lt,yt,Tt)),kt.prevZ=kt.prev,kt.nextZ=kt.next,kt=kt.next;while(kt!==st);kt.prevZ.nextZ=null,kt.prevZ=null,function(Ut){var $t,qt,ie,de,ge,we,De,Ke,or=1;do{for(qt=Ut,Ut=null,ge=null,we=0;qt;){for(we++,ie=qt,De=0,$t=0;$t<or&&(De++,ie=ie.nextZ);$t++);for(Ke=or;De>0||Ke>0&&ie;)De!==0&&(Ke===0||!ie||qt.z<=ie.z)?(de=qt,qt=qt.nextZ,De--):(de=ie,ie=ie.nextZ,Ke--),ge?ge.nextZ=de:Ut=de,de.prevZ=ge,ge=de;qt=ie}ge.nextZ=null,or*=2}while(we>1)}(kt)}(a,b,S,I);for(var H,Q,rt=a;a.prev!==a.next;)if(H=a.prev,Q=a.next,I?Rx(a,b,S,I):VT(a))u.push(H.i/f),u.push(a.i/f),u.push(Q.i/f),Zt(a),a=Q.next,rt=Q.next;else if((a=Q)===rt){N?N===1?xr(a=zg(Qe(a),u,f),u,f,b,S,I,2):N===2&&Ug(a,u,f,b,S,I):xr(Qe(a),u,f,b,S,I,1);break}}}function VT(a){var u=a.prev,f=a,b=a.next;if(C(u,f,b)>=0)return!1;for(var S=a.next.next;S!==a.prev;){if(v(u.x,u.y,f.x,f.y,b.x,b.y,S.x,S.y)&&C(S.prev,S,S.next)>=0)return!1;S=S.next}return!0}function Rx(a,u,f,b){var S=a.prev,I=a,N=a.next;if(C(S,I,N)>=0)return!1;for(var H=S.x>I.x?S.x>N.x?S.x:N.x:I.x>N.x?I.x:N.x,Q=S.y>I.y?S.y>N.y?S.y:N.y:I.y>N.y?I.y:N.y,rt=g(S.x<I.x?S.x<N.x?S.x:N.x:I.x<N.x?I.x:N.x,S.y<I.y?S.y<N.y?S.y:N.y:I.y<N.y?I.y:N.y,u,f,b),st=g(H,Q,u,f,b),lt=a.prevZ,yt=a.nextZ;lt&&lt.z>=rt&&yt&&yt.z<=st;){if(lt!==a.prev&&lt!==a.next&&v(S.x,S.y,I.x,I.y,N.x,N.y,lt.x,lt.y)&&C(lt.prev,lt,lt.next)>=0||(lt=lt.prevZ,yt!==a.prev&&yt!==a.next&&v(S.x,S.y,I.x,I.y,N.x,N.y,yt.x,yt.y)&&C(yt.prev,yt,yt.next)>=0))return!1;yt=yt.nextZ}for(;lt&&lt.z>=rt;){if(lt!==a.prev&&lt!==a.next&&v(S.x,S.y,I.x,I.y,N.x,N.y,lt.x,lt.y)&&C(lt.prev,lt,lt.next)>=0)return!1;lt=lt.prevZ}for(;yt&&yt.z<=st;){if(yt!==a.prev&&yt!==a.next&&v(S.x,S.y,I.x,I.y,N.x,N.y,yt.x,yt.y)&&C(yt.prev,yt,yt.next)>=0)return!1;yt=yt.nextZ}return!0}function zg(a,u,f){var b=a;do{var S=b.prev,I=b.next.next;!L(S,I)&&k(S,b,b.next,I)&&nt(S,I)&&nt(I,S)&&(u.push(S.i/f),u.push(b.i/f),u.push(I.i/f),Zt(b),Zt(b.next),b=a=I),b=b.next}while(b!==a);return Qe(b)}function Ug(a,u,f,b,S,I){var N=a;do{for(var H=N.next.next;H!==N.prev;){if(N.i!==H.i&&M(N,H)){var Q=_t(N,H);return N=Qe(N,N.next),Q=Qe(Q,Q.next),xr(N,u,f,b,S,I),void xr(Q,u,f,b,S,I)}H=H.next}N=N.next}while(N!==a)}function Mp(a,u){return a.x-u.x}function jT(a,u){if(u=function(b,S){var I,N=S,H=b.x,Q=b.y,rt=-1/0;do{if(Q<=N.y&&Q>=N.next.y&&N.next.y!==N.y){var st=N.x+(Q-N.y)*(N.next.x-N.x)/(N.next.y-N.y);if(st<=H&&st>rt){if(rt=st,st===H){if(Q===N.y)return N;if(Q===N.next.y)return N.next}I=N.x<N.next.x?N:N.next}}N=N.next}while(N!==S);if(!I)return null;if(H===rt)return I;var lt,yt=I,Tt=I.x,kt=I.y,Ut=1/0;N=I;do H>=N.x&&N.x>=Tt&&H!==N.x&&v(Q<kt?H:rt,Q,Tt,kt,Q<kt?rt:H,Q,N.x,N.y)&&(lt=Math.abs(Q-N.y)/(H-N.x),nt(N,b)&&(lt<Ut||lt===Ut&&(N.x>I.x||N.x===I.x&&yf(I,N)))&&(I=N,Ut=lt)),N=N.next;while(N!==yt);return I}(a,u)){var f=_t(u,a);Qe(u,u.next),Qe(f,f.next)}}function yf(a,u){return C(a.prev,a,u.prev)<0&&C(u.next,a,a.next)<0}function g(a,u,f,b,S){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-f)*S)|a<<8))|a<<4))|a<<2))|a<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=32767*(u-b)*S)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function A(a){var u=a,f=a;do(u.x<f.x||u.x===f.x&&u.y<f.y)&&(f=u),u=u.next;while(u!==a);return f}function v(a,u,f,b,S,I,N,H){return(S-N)*(u-H)-(a-N)*(I-H)>=0&&(a-N)*(b-H)-(f-N)*(u-H)>=0&&(f-N)*(I-H)-(S-N)*(b-H)>=0}function M(a,u){return a.next.i!==u.i&&a.prev.i!==u.i&&!function(f,b){var S=f;do{if(S.i!==f.i&&S.next.i!==f.i&&S.i!==b.i&&S.next.i!==b.i&&k(S,S.next,f,b))return!0;S=S.next}while(S!==f);return!1}(a,u)&&(nt(a,u)&&nt(u,a)&&function(f,b){var S=f,I=!1,N=(f.x+b.x)/2,H=(f.y+b.y)/2;do S.y>H!=S.next.y>H&&S.next.y!==S.y&&N<(S.next.x-S.x)*(H-S.y)/(S.next.y-S.y)+S.x&&(I=!I),S=S.next;while(S!==f);return I}(a,u)&&(C(a.prev,a,u.prev)||C(a,u.prev,u))||L(a,u)&&C(a.prev,a,a.next)>0&&C(u.prev,u,u.next)>0)}function C(a,u,f){return(u.y-a.y)*(f.x-u.x)-(u.x-a.x)*(f.y-u.y)}function L(a,u){return a.x===u.x&&a.y===u.y}function k(a,u,f,b){var S=Z(C(a,u,f)),I=Z(C(a,u,b)),N=Z(C(f,b,a)),H=Z(C(f,b,u));return S!==I&&N!==H||!(S!==0||!z(a,f,u))||!(I!==0||!z(a,b,u))||!(N!==0||!z(f,a,b))||!(H!==0||!z(f,u,b))}function z(a,u,f){return u.x<=Math.max(a.x,f.x)&&u.x>=Math.min(a.x,f.x)&&u.y<=Math.max(a.y,f.y)&&u.y>=Math.min(a.y,f.y)}function Z(a){return a>0?1:a<0?-1:0}function nt(a,u){return C(a.prev,a,a.next)<0?C(a,u,a.next)>=0&&C(a,a.prev,u)>=0:C(a,u,a.prev)<0||C(a,a.next,u)<0}function _t(a,u){var f=new re(a.i,a.x,a.y),b=new re(u.i,u.x,u.y),S=a.next,I=u.prev;return a.next=u,u.prev=a,f.next=S,S.prev=f,b.next=f,f.prev=b,I.next=b,b.prev=I,b}function Ot(a,u,f,b){var S=new re(a,u,f);return b?(S.next=b.next,S.prev=b,b.next.prev=S,b.next=S):(S.prev=S,S.next=S),S}function Zt(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function re(a,u,f){this.i=a,this.x=u,this.y=f,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Gt(a,u,f,b){for(var S=0,I=u,N=f-b;I<f;I+=b)S+=(a[N]-a[I])*(a[I+1]+a[N+1]),N=I;return S}function me(a,u,f,b,S){(function I(N,H,Q,rt,st){for(;rt>Q;){if(rt-Q>600){var lt=rt-Q+1,yt=H-Q+1,Tt=Math.log(lt),kt=.5*Math.exp(2*Tt/3),Ut=.5*Math.sqrt(Tt*kt*(lt-kt)/lt)*(yt-lt/2<0?-1:1);I(N,H,Math.max(Q,Math.floor(H-yt*kt/lt+Ut)),Math.min(rt,Math.floor(H+(lt-yt)*kt/lt+Ut)),st)}var $t=N[H],qt=Q,ie=rt;for(ke(N,Q,H),st(N[rt],$t)>0&&ke(N,Q,rt);qt<ie;){for(ke(N,qt,ie),qt++,ie--;st(N[qt],$t)<0;)qt++;for(;st(N[ie],$t)>0;)ie--}st(N[Q],$t)===0?ke(N,Q,ie):ke(N,++ie,rt),ie<=H&&(Q=ie+1),H<=ie&&(rt=ie-1)}})(a,u,f||0,b||a.length-1,S||Be)}function ke(a,u,f){var b=a[u];a[u]=a[f],a[f]=b}function Be(a,u){return a<u?-1:a>u?1:0}function xe(a,u){var f=a.length;if(f<=1)return[a];for(var b,S,I=[],N=0;N<f;N++){var H=ct(a[N]);H!==0&&(a[N].area=Math.abs(H),S===void 0&&(S=H<0),S===H<0?(b&&I.push(b),b=[a[N]]):b.push(a[N]))}if(b&&I.push(b),u>1)for(var Q=0;Q<I.length;Q++)I[Q].length<=u||(me(I[Q],u,1,I[Q].length-1,Se),I[Q]=I[Q].slice(0,u));return I}function Se(a,u){return u.area-a.area}function pe(a,u,f){for(var b=f.patternDependencies,S=!1,I=0,N=u;I<N.length;I+=1){var H=N[I].paint.get(a+"-pattern");H.isConstant()||(S=!0);var Q=H.constantOr(null);Q&&(S=!0,b[Q.to]=!0,b[Q.from]=!0)}return S}function Ir(a,u,f,b,S){for(var I=S.patternDependencies,N=0,H=u;N<H.length;N+=1){var Q=H[N],rt=Q.paint.get(a+"-pattern").value;if(rt.kind!=="constant"){var st=rt.evaluate({zoom:b-1},f,{},S.availableImages),lt=rt.evaluate({zoom:b},f,{},S.availableImages),yt=rt.evaluate({zoom:b+1},f,{},S.availableImages);lt=lt&&lt.name?lt.name:lt,yt=yt&&yt.name?yt.name:yt,I[st=st&&st.name?st.name:st]=!0,I[lt]=!0,I[yt]=!0,f.patterns[Q.id]={min:st,mid:lt,max:yt}}}return f}bh.deviation=function(a,u,f,b){var S=u&&u.length,I=Math.abs(Gt(a,0,S?u[0]*f:a.length,f));if(S)for(var N=0,H=u.length;N<H;N++)I-=Math.abs(Gt(a,u[N]*f,N<H-1?u[N+1]*f:a.length,f));var Q=0;for(N=0;N<b.length;N+=3){var rt=b[N]*f,st=b[N+1]*f,lt=b[N+2]*f;Q+=Math.abs((a[rt]-a[lt])*(a[st+1]-a[rt+1])-(a[rt]-a[st])*(a[lt+1]-a[rt+1]))}return I===0&&Q===0?0:Math.abs((Q-I)/I)},bh.flatten=function(a){for(var u=a[0][0].length,f={vertices:[],holes:[],dimensions:u},b=0,S=0;S<a.length;S++){for(var I=0;I<a[S].length;I++)for(var N=0;N<u;N++)f.vertices.push(a[S][I][N]);S>0&&f.holes.push(b+=a[S-1].length)}return f},ya.default=Fg;var Lr=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new nu,this.indexArray=new Ya,this.indexArray2=new yh,this.programConfigurations=new en(a.layers,a.zoom),this.segments=new Ct,this.segments2=new Ct,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};Lr.prototype.populate=function(a,u,f){this.hasPattern=pe("fill",this.layers,u);for(var b=this.layers[0].layout.get("fill-sort-key"),S=[],I=0,N=a;I<N.length;I+=1){var H=N[I],Q=H.feature,rt=H.id,st=H.index,lt=H.sourceLayerIndex,yt=this.layers[0]._featureFilter.needGeometry,Tt=Uo(Q,yt);if(this.layers[0]._featureFilter.filter(new Un(this.zoom),Tt,f)){var kt=b?b.evaluate(Tt,{},f,u.availableImages):void 0,Ut={id:rt,properties:Q.properties,type:Q.type,sourceLayerIndex:lt,index:st,geometry:yt?Tt.geometry:vo(Q),patterns:{},sortKey:kt};S.push(Ut)}}b&&S.sort(function(Ke,or){return Ke.sortKey-or.sortKey});for(var $t=0,qt=S;$t<qt.length;$t+=1){var ie=qt[$t],de=ie.geometry,ge=ie.index,we=ie.sourceLayerIndex;if(this.hasPattern){var De=Ir("fill",this.layers,ie,this.zoom,u);this.patternFeatures.push(De)}else this.addFeature(ie,de,ge,f,{});u.featureIndex.insert(a[ge].feature,de,ge,we,this.index)}},Lr.prototype.update=function(a,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f)},Lr.prototype.addFeatures=function(a,u,f){for(var b=0,S=this.patternFeatures;b<S.length;b+=1){var I=S[b];this.addFeature(I,I.geometry,I.index,u,f)}},Lr.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Lr.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Lr.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,JR),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0},Lr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Lr.prototype.addFeature=function(a,u,f,b,S){for(var I=0,N=xe(u,500);I<N.length;I+=1){for(var H=N[I],Q=0,rt=0,st=H;rt<st.length;rt+=1)Q+=st[rt].length;for(var lt=this.segments.prepareSegment(Q,this.layoutVertexArray,this.indexArray),yt=lt.vertexLength,Tt=[],kt=[],Ut=0,$t=H;Ut<$t.length;Ut+=1){var qt=$t[Ut];if(qt.length!==0){qt!==H[0]&&kt.push(Tt.length/2);var ie=this.segments2.prepareSegment(qt.length,this.layoutVertexArray,this.indexArray2),de=ie.vertexLength;this.layoutVertexArray.emplaceBack(qt[0].x,qt[0].y),this.indexArray2.emplaceBack(de+qt.length-1,de),Tt.push(qt[0].x),Tt.push(qt[0].y);for(var ge=1;ge<qt.length;ge++)this.layoutVertexArray.emplaceBack(qt[ge].x,qt[ge].y),this.indexArray2.emplaceBack(de+ge-1,de+ge),Tt.push(qt[ge].x),Tt.push(qt[ge].y);ie.vertexLength+=qt.length,ie.primitiveLength+=qt.length}}for(var we=ya(Tt,kt),De=0;De<we.length;De+=3)this.indexArray.emplaceBack(yt+we[De],yt+we[De+1],yt+we[De+2]);lt.vertexLength+=Q,lt.primitiveLength+=we.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,S,b)},_r("FillBucket",Lr,{omit:["layers","patternFeatures"]});var Er=new Ms({"fill-sort-key":new Or(St.layout_fill["fill-sort-key"])}),Br={paint:new Ms({"fill-antialias":new Wr(St.paint_fill["fill-antialias"]),"fill-opacity":new Or(St.paint_fill["fill-opacity"]),"fill-color":new Or(St.paint_fill["fill-color"]),"fill-outline-color":new Or(St.paint_fill["fill-outline-color"]),"fill-translate":new Wr(St.paint_fill["fill-translate"]),"fill-translate-anchor":new Wr(St.paint_fill["fill-translate-anchor"]),"fill-pattern":new Iu(St.paint_fill["fill-pattern"])}),layout:Er},Zi=function(a){function u(f){a.call(this,f,Br)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.recalculate=function(f,b){a.prototype.recalculate.call(this,f,b);var S=this.paint._values["fill-outline-color"];S.value.kind==="constant"&&S.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},u.prototype.createBucket=function(f){return new Lr(f)},u.prototype.queryRadius=function(){return Ro(this.paint.get("fill-translate"))},u.prototype.queryIntersectsFeature=function(f,b,S,I,N,H,Q){return sl(ys(f,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),H.angle,Q),I)},u.prototype.isTileClipped=function(){return!0},u}(Ra),Ii=Ss([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Ri=In;function In(a,u,f,b,S){this.properties={},this.extent=f,this.type=0,this._pbf=a,this._geometry=-1,this._keys=b,this._values=S,a.readFields(Hn,this,u)}function Hn(a,u,f){a==1?u.id=f.readVarint():a==2?function(b,S){for(var I=b.readVarint()+b.pos;b.pos<I;){var N=S._keys[b.readVarint()],H=S._values[b.readVarint()];S.properties[N]=H}}(f,u):a==3?u.type=f.readVarint():a==4&&(u._geometry=f.pos)}function Qn(a){for(var u,f,b=0,S=0,I=a.length,N=I-1;S<I;N=S++)b+=((f=a[N]).x-(u=a[S]).x)*(u.y+f.y);return b}In.types=["Unknown","Point","LineString","Polygon"],In.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var u,f=a.readVarint()+a.pos,b=1,S=0,I=0,N=0,H=[];a.pos<f;){if(S<=0){var Q=a.readVarint();b=7&Q,S=Q>>3}if(S--,b===1||b===2)I+=a.readSVarint(),N+=a.readSVarint(),b===1&&(u&&H.push(u),u=[]),u.push(new l(I,N));else{if(b!==7)throw new Error("unknown command "+b);u&&u.push(u[0].clone())}}return u&&H.push(u),H},In.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var u=a.readVarint()+a.pos,f=1,b=0,S=0,I=0,N=1/0,H=-1/0,Q=1/0,rt=-1/0;a.pos<u;){if(b<=0){var st=a.readVarint();f=7&st,b=st>>3}if(b--,f===1||f===2)(S+=a.readSVarint())<N&&(N=S),S>H&&(H=S),(I+=a.readSVarint())<Q&&(Q=I),I>rt&&(rt=I);else if(f!==7)throw new Error("unknown command "+f)}return[N,Q,H,rt]},In.prototype.toGeoJSON=function(a,u,f){var b,S,I=this.extent*Math.pow(2,f),N=this.extent*a,H=this.extent*u,Q=this.loadGeometry(),rt=In.types[this.type];function st(Tt){for(var kt=0;kt<Tt.length;kt++){var Ut=Tt[kt];Tt[kt]=[360*(Ut.x+N)/I-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ut.y+H)/I)*Math.PI/180))-90]}}switch(this.type){case 1:var lt=[];for(b=0;b<Q.length;b++)lt[b]=Q[b][0];st(Q=lt);break;case 2:for(b=0;b<Q.length;b++)st(Q[b]);break;case 3:for(Q=function(Tt){var kt=Tt.length;if(kt<=1)return[Tt];for(var Ut,$t,qt=[],ie=0;ie<kt;ie++){var de=Qn(Tt[ie]);de!==0&&($t===void 0&&($t=de<0),$t===de<0?(Ut&&qt.push(Ut),Ut=[Tt[ie]]):Ut.push(Tt[ie]))}return Ut&&qt.push(Ut),qt}(Q),b=0;b<Q.length;b++)for(S=0;S<Q[b].length;S++)st(Q[b][S])}Q.length===1?Q=Q[0]:rt="Multi"+rt;var yt={type:"Feature",geometry:{type:rt,coordinates:Q},properties:this.properties};return"id"in this&&(yt.id=this.id),yt};var eo=Rn;function Rn(a,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(bo,this,u),this.length=this._features.length}function bo(a,u,f){a===15?u.version=f.readVarint():a===1?u.name=f.readString():a===5?u.extent=f.readVarint():a===2?u._features.push(f.pos):a===3?u._keys.push(f.readString()):a===4&&u._values.push(function(b){for(var S=null,I=b.readVarint()+b.pos;b.pos<I;){var N=b.readVarint()>>3;S=N===1?b.readString():N===2?b.readFloat():N===3?b.readDouble():N===4?b.readVarint64():N===5?b.readVarint():N===6?b.readSVarint():N===7?b.readBoolean():null}return S}(f))}function xc(a,u,f){if(a===3){var b=new eo(f,f.readVarint()+f.pos);b.length&&(u[b.name]=b)}}Rn.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var u=this._pbf.readVarint()+this._pbf.pos;return new Ri(this._pbf,u,this.extent,this._keys,this._values)};var Sp={VectorTile:function(a,u){this.layers=a.readFields(xc,{},u)},VectorTileFeature:Ri,VectorTileLayer:eo},bht=Sp.VectorTileFeature.types,tL=Math.pow(2,13);function Lx(a,u,f,b,S,I,N,H){a.emplaceBack(u,f,2*Math.floor(b*tL)+N,S*tL*2,I*tL*2,Math.round(H))}var wh=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new Bc,this.indexArray=new Ya,this.programConfigurations=new en(a.layers,a.zoom),this.segments=new Ct,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};function wht(a,u){return a.x===u.x&&(a.x<0||a.x>8192)||a.y===u.y&&(a.y<0||a.y>8192)}wh.prototype.populate=function(a,u,f){this.features=[],this.hasPattern=pe("fill-extrusion",this.layers,u);for(var b=0,S=a;b<S.length;b+=1){var I=S[b],N=I.feature,H=I.id,Q=I.index,rt=I.sourceLayerIndex,st=this.layers[0]._featureFilter.needGeometry,lt=Uo(N,st);if(this.layers[0]._featureFilter.filter(new Un(this.zoom),lt,f)){var yt={id:H,sourceLayerIndex:rt,index:Q,geometry:st?lt.geometry:vo(N),properties:N.properties,type:N.type,patterns:{}};this.hasPattern?this.features.push(Ir("fill-extrusion",this.layers,yt,this.zoom,u)):this.addFeature(yt,yt.geometry,Q,f,{}),u.featureIndex.insert(N,yt.geometry,Q,rt,this.index,!0)}}},wh.prototype.addFeatures=function(a,u,f){for(var b=0,S=this.features;b<S.length;b+=1){var I=S[b];this.addFeature(I,I.geometry,I.index,u,f)}},wh.prototype.update=function(a,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f)},wh.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},wh.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},wh.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Ii),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},wh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},wh.prototype.addFeature=function(a,u,f,b,S){for(var I=0,N=xe(u,500);I<N.length;I+=1){for(var H=N[I],Q=0,rt=0,st=H;rt<st.length;rt+=1)Q+=st[rt].length;for(var lt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),yt=0,Tt=H;yt<Tt.length;yt+=1){var kt=Tt[yt];if(kt.length!==0&&!((Wn=kt).every(function(En){return En.x<0})||Wn.every(function(En){return En.x>8192})||Wn.every(function(En){return En.y<0})||Wn.every(function(En){return En.y>8192})))for(var Ut=0,$t=0;$t<kt.length;$t++){var qt=kt[$t];if($t>=1){var ie=kt[$t-1];if(!wht(qt,ie)){lt.vertexLength+4>Ct.MAX_VERTEX_ARRAY_LENGTH&&(lt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var de=qt.sub(ie)._perp()._unit(),ge=ie.dist(qt);Ut+ge>32768&&(Ut=0),Lx(this.layoutVertexArray,qt.x,qt.y,de.x,de.y,0,0,Ut),Lx(this.layoutVertexArray,qt.x,qt.y,de.x,de.y,0,1,Ut),Lx(this.layoutVertexArray,ie.x,ie.y,de.x,de.y,0,0,Ut+=ge),Lx(this.layoutVertexArray,ie.x,ie.y,de.x,de.y,0,1,Ut);var we=lt.vertexLength;this.indexArray.emplaceBack(we,we+2,we+1),this.indexArray.emplaceBack(we+1,we+2,we+3),lt.vertexLength+=4,lt.primitiveLength+=2}}}}if(lt.vertexLength+Q>Ct.MAX_VERTEX_ARRAY_LENGTH&&(lt=this.segments.prepareSegment(Q,this.layoutVertexArray,this.indexArray)),bht[a.type]==="Polygon"){for(var De=[],Ke=[],or=lt.vertexLength,Hr=0,vr=H;Hr<vr.length;Hr+=1){var Zr=vr[Hr];if(Zr.length!==0){Zr!==H[0]&&Ke.push(De.length/2);for(var Tr=0;Tr<Zr.length;Tr++){var Ln=Zr[Tr];Lx(this.layoutVertexArray,Ln.x,Ln.y,0,0,1,1,0),De.push(Ln.x),De.push(Ln.y)}}}for(var un=ya(De,Ke),Fr=0;Fr<un.length;Fr+=3)this.indexArray.emplaceBack(or+un[Fr],or+un[Fr+2],or+un[Fr+1]);lt.primitiveLength+=un.length/3,lt.vertexLength+=Q}}var Wn;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,S,b)},_r("FillExtrusionBucket",wh,{omit:["layers","features"]});var Tht={paint:new Ms({"fill-extrusion-opacity":new Wr(St["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Or(St["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Wr(St["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Wr(St["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Iu(St["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Or(St["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Or(St["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Wr(St["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Eht=function(a){function u(f){a.call(this,f,Tht)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.createBucket=function(f){return new wh(f)},u.prototype.queryRadius=function(){return Ro(this.paint.get("fill-extrusion-translate"))},u.prototype.is3D=function(){return!0},u.prototype.queryIntersectsFeature=function(f,b,S,I,N,H,Q,rt){var st=ys(f,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),H.angle,Q),lt=this.paint.get("fill-extrusion-height").evaluate(b,S),yt=this.paint.get("fill-extrusion-base").evaluate(b,S),Tt=function(Ut,$t,qt,ie){for(var de=[],ge=0,we=Ut;ge<we.length;ge+=1){var De=we[ge],Ke=[De.x,De.y,0,1];Wd(Ke,Ke,$t),de.push(new l(Ke[0]/Ke[3],Ke[1]/Ke[3]))}return de}(st,rt),kt=function(Ut,$t,qt,ie){for(var de=[],ge=[],we=ie[8]*$t,De=ie[9]*$t,Ke=ie[10]*$t,or=ie[11]*$t,Hr=ie[8]*qt,vr=ie[9]*qt,Zr=ie[10]*qt,Tr=ie[11]*qt,Ln=0,un=Ut;Ln<un.length;Ln+=1){for(var Fr=[],Wn=[],En=0,si=un[Ln];En<si.length;En+=1){var Qr=si[En],bi=Qr.x,To=Qr.y,Xo=ie[0]*bi+ie[4]*To+ie[12],jo=ie[1]*bi+ie[5]*To+ie[13],Eo=ie[2]*bi+ie[6]*To+ie[14],Yo=ie[3]*bi+ie[7]*To+ie[15],js=Eo+Ke,Hs=Yo+or,Qa=Xo+Hr,ea=jo+vr,Ja=Eo+Zr,ss=Yo+Tr,ra=new l((Xo+we)/Hs,(jo+De)/Hs);ra.z=js/Hs,Fr.push(ra);var Jn=new l(Qa/ss,ea/ss);Jn.z=Ja/ss,Wn.push(Jn)}de.push(Fr),ge.push(Wn)}return[de,ge]}(I,yt,lt,rt);return function(Ut,$t,qt){var ie=1/0;sl(qt,$t)&&(ie=j8(qt,$t[0]));for(var de=0;de<$t.length;de++)for(var ge=$t[de],we=Ut[de],De=0;De<ge.length-1;De++){var Ke=ge[De],or=[Ke,ge[De+1],we[De+1],we[De],Ke];Du(qt,or)&&(ie=Math.min(ie,j8(qt,or)))}return ie!==1/0&&ie}(kt[0],kt[1],Tt)},u}(Ra);function Ox(a,u){return a.x*u.x+a.y*u.y}function j8(a,u){if(a.length===1){for(var f,b=0,S=u[b++];!f||S.equals(f);)if(!(f=u[b++]))return 1/0;for(;b<u.length;b++){var I=u[b],N=a[0],H=f.sub(S),Q=I.sub(S),rt=N.sub(S),st=Ox(H,H),lt=Ox(H,Q),yt=Ox(Q,Q),Tt=Ox(rt,H),kt=Ox(rt,Q),Ut=st*yt-lt*lt,$t=(yt*Tt-lt*kt)/Ut,qt=(st*kt-lt*Tt)/Ut,ie=S.z*(1-$t-qt)+f.z*$t+I.z*qt;if(isFinite(ie))return ie}return 1/0}for(var de=1/0,ge=0,we=u;ge<we.length;ge+=1)de=Math.min(de,we[ge].z);return de}var Mht=Ss([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Sht=Ss([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Cht=Sp.VectorTileFeature.types,Pht=Math.cos(Math.PI/180*37.5),H8=Math.pow(2,14)/.5,vc=function(a){var u=this;this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(f){return f.id}),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(f){u.gradients[f.id]={}}),this.layoutVertexArray=new ii,this.layoutVertexArray2=new ff,this.indexArray=new Ya,this.programConfigurations=new en(a.layers,a.zoom),this.segments=new Ct,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(f){return f.isStateDependent()}).map(function(f){return f.id})};vc.prototype.populate=function(a,u,f){this.hasPattern=pe("line",this.layers,u);for(var b=this.layers[0].layout.get("line-sort-key"),S=[],I=0,N=a;I<N.length;I+=1){var H=N[I],Q=H.feature,rt=H.id,st=H.index,lt=H.sourceLayerIndex,yt=this.layers[0]._featureFilter.needGeometry,Tt=Uo(Q,yt);if(this.layers[0]._featureFilter.filter(new Un(this.zoom),Tt,f)){var kt=b?b.evaluate(Tt,{},f):void 0,Ut={id:rt,properties:Q.properties,type:Q.type,sourceLayerIndex:lt,index:st,geometry:yt?Tt.geometry:vo(Q),patterns:{},sortKey:kt};S.push(Ut)}}b&&S.sort(function(Ke,or){return Ke.sortKey-or.sortKey});for(var $t=0,qt=S;$t<qt.length;$t+=1){var ie=qt[$t],de=ie.geometry,ge=ie.index,we=ie.sourceLayerIndex;if(this.hasPattern){var De=Ir("line",this.layers,ie,this.zoom,u);this.patternFeatures.push(De)}else this.addFeature(ie,de,ge,f,{});u.featureIndex.insert(a[ge].feature,de,ge,we,this.index)}},vc.prototype.update=function(a,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f)},vc.prototype.addFeatures=function(a,u,f){for(var b=0,S=this.patternFeatures;b<S.length;b+=1){var I=S[b];this.addFeature(I,I.geometry,I.index,u,f)}},vc.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},vc.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},vc.prototype.upload=function(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,Sht)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Mht),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},vc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},vc.prototype.lineFeatureClips=function(a){if(a.properties&&a.properties.hasOwnProperty("mapbox_clip_start")&&a.properties.hasOwnProperty("mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}},vc.prototype.addFeature=function(a,u,f,b,S){var I=this.layers[0].layout,N=I.get("line-join").evaluate(a,{}),H=I.get("line-cap"),Q=I.get("line-miter-limit"),rt=I.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(var st=0,lt=u;st<lt.length;st+=1)this.addLine(lt[st],a,N,H,Q,rt);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,S,b)},vc.prototype.addLine=function(a,u,f,b,S,I){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var N=0;N<a.length-1;N++)this.totalDistance+=a[N].dist(a[N+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var H=Cht[u.type]==="Polygon",Q=a.length;Q>=2&&a[Q-1].equals(a[Q-2]);)Q--;for(var rt=0;rt<Q-1&&a[rt].equals(a[rt+1]);)rt++;if(!(Q<(H?3:2))){f==="bevel"&&(S=1.05);var st,lt=this.overscaling<=16?122880/(512*this.overscaling):0,yt=this.segments.prepareSegment(10*Q,this.layoutVertexArray,this.indexArray),Tt=void 0,kt=void 0,Ut=void 0,$t=void 0;this.e1=this.e2=-1,H&&($t=a[rt].sub(st=a[Q-2])._unit()._perp());for(var qt=rt;qt<Q;qt++)if(!(kt=qt===Q-1?H?a[rt+1]:void 0:a[qt+1])||!a[qt].equals(kt)){$t&&(Ut=$t),st&&(Tt=st),st=a[qt],$t=kt?kt.sub(st)._unit()._perp():Ut;var ie=(Ut=Ut||$t).add($t);ie.x===0&&ie.y===0||ie._unit();var de=Ut.x*$t.x+Ut.y*$t.y,ge=ie.x*$t.x+ie.y*$t.y,we=ge!==0?1/ge:1/0,De=2*Math.sqrt(2-2*ge),Ke=ge<Pht&&Tt&&kt,or=Ut.x*$t.y-Ut.y*$t.x>0;if(Ke&&qt>rt){var Hr=st.dist(Tt);if(Hr>2*lt){var vr=st.sub(st.sub(Tt)._mult(lt/Hr)._round());this.updateDistance(Tt,vr),this.addCurrentVertex(vr,Ut,0,0,yt),Tt=vr}}var Zr=Tt&&kt,Tr=Zr?f:H?"butt":b;if(Zr&&Tr==="round"&&(we<I?Tr="miter":we<=2&&(Tr="fakeround")),Tr==="miter"&&we>S&&(Tr="bevel"),Tr==="bevel"&&(we>2&&(Tr="flipbevel"),we<S&&(Tr="miter")),Tt&&this.updateDistance(Tt,st),Tr==="miter")ie._mult(we),this.addCurrentVertex(st,ie,0,0,yt);else if(Tr==="flipbevel"){if(we>100)ie=$t.mult(-1);else{var Ln=we*Ut.add($t).mag()/Ut.sub($t).mag();ie._perp()._mult(Ln*(or?-1:1))}this.addCurrentVertex(st,ie,0,0,yt),this.addCurrentVertex(st,ie.mult(-1),0,0,yt)}else if(Tr==="bevel"||Tr==="fakeround"){var un=-Math.sqrt(we*we-1),Fr=or?un:0,Wn=or?0:un;if(Tt&&this.addCurrentVertex(st,Ut,Fr,Wn,yt),Tr==="fakeround")for(var En=Math.round(180*De/Math.PI/20),si=1;si<En;si++){var Qr=si/En;if(Qr!==.5){var bi=Qr-.5;Qr+=Qr*bi*(Qr-1)*((1.0904+de*(de*(3.55645-1.43519*de)-3.2452))*bi*bi+(.848013+de*(.215638*de-1.06021)))}var To=$t.sub(Ut)._mult(Qr)._add(Ut)._unit()._mult(or?-1:1);this.addHalfVertex(st,To.x,To.y,!1,or,0,yt)}kt&&this.addCurrentVertex(st,$t,-Fr,-Wn,yt)}else if(Tr==="butt")this.addCurrentVertex(st,ie,0,0,yt);else if(Tr==="square"){var Xo=Tt?1:-1;this.addCurrentVertex(st,ie,Xo,Xo,yt)}else Tr==="round"&&(Tt&&(this.addCurrentVertex(st,Ut,0,0,yt),this.addCurrentVertex(st,Ut,1,1,yt,!0)),kt&&(this.addCurrentVertex(st,$t,-1,-1,yt,!0),this.addCurrentVertex(st,$t,0,0,yt)));if(Ke&&qt<Q-1){var jo=st.dist(kt);if(jo>2*lt){var Eo=st.add(kt.sub(st)._mult(lt/jo)._round());this.updateDistance(st,Eo),this.addCurrentVertex(Eo,$t,0,0,yt),st=Eo}}}}},vc.prototype.addCurrentVertex=function(a,u,f,b,S,I){I===void 0&&(I=!1);var N=u.y*b-u.x,H=-u.y-u.x*b;this.addHalfVertex(a,u.x+u.y*f,u.y-u.x*f,I,!1,f,S),this.addHalfVertex(a,N,H,I,!0,-b,S),this.distance>H8/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(a,u,f,b,S,I))},vc.prototype.addHalfVertex=function(a,u,f,b,S,I,N){var H=.5*(this.lineClips?this.scaledDistance*(H8-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((a.x<<1)+(b?1:0),(a.y<<1)+(S?1:0),Math.round(63*u)+128,Math.round(63*f)+128,1+(I===0?0:I<0?-1:1)|(63&H)<<2,H>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var Q=N.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Q),N.primitiveLength++),S?this.e2=Q:this.e1=Q},vc.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},vc.prototype.updateDistance=function(a,u){this.distance+=a.dist(u),this.updateScaledDistance()},_r("LineBucket",vc,{omit:["layers","patternFeatures"]});var Iht=new Ms({"line-cap":new Wr(St.layout_line["line-cap"]),"line-join":new Or(St.layout_line["line-join"]),"line-miter-limit":new Wr(St.layout_line["line-miter-limit"]),"line-round-limit":new Wr(St.layout_line["line-round-limit"]),"line-sort-key":new Or(St.layout_line["line-sort-key"])}),W8={paint:new Ms({"line-opacity":new Or(St.paint_line["line-opacity"]),"line-color":new Or(St.paint_line["line-color"]),"line-translate":new Wr(St.paint_line["line-translate"]),"line-translate-anchor":new Wr(St.paint_line["line-translate-anchor"]),"line-width":new Or(St.paint_line["line-width"]),"line-gap-width":new Or(St.paint_line["line-gap-width"]),"line-offset":new Or(St.paint_line["line-offset"]),"line-blur":new Or(St.paint_line["line-blur"]),"line-dasharray":new Aa(St.paint_line["line-dasharray"]),"line-pattern":new Iu(St.paint_line["line-pattern"]),"line-gradient":new yc(St.paint_line["line-gradient"])}),layout:Iht},q8=new(function(a){function u(){a.apply(this,arguments)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.possiblyEvaluate=function(f,b){return b=new Un(Math.floor(b.zoom),{now:b.now,fadeDuration:b.fadeDuration,zoomHistory:b.zoomHistory,transition:b.transition}),a.prototype.possiblyEvaluate.call(this,f,b)},u.prototype.evaluate=function(f,b,S,I){return b=D({},b,{zoom:Math.floor(b.zoom)}),a.prototype.evaluate.call(this,f,b,S,I)},u}(Or))(W8.paint.properties["line-width"].specification);q8.useIntegerZoom=!0;var Rht=function(a){function u(f){a.call(this,f,W8),this.gradientVersion=0}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype._handleSpecialPaintPropertyUpdate=function(f){f==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof da,this.gradientVersion=(this.gradientVersion+1)%x)},u.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},u.prototype.recalculate=function(f,b){a.prototype.recalculate.call(this,f,b),this.paint._values["line-floorwidth"]=q8.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,f)},u.prototype.createBucket=function(f){return new vc(f)},u.prototype.queryRadius=function(f){var b=f,S=G8(Pl("line-width",this,b),Pl("line-gap-width",this,b)),I=Pl("line-offset",this,b);return S/2+Math.abs(I)+Ro(this.paint.get("line-translate"))},u.prototype.queryIntersectsFeature=function(f,b,S,I,N,H,Q){var rt=ys(f,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),H.angle,Q),st=Q/2*G8(this.paint.get("line-width").evaluate(b,S),this.paint.get("line-gap-width").evaluate(b,S)),lt=this.paint.get("line-offset").evaluate(b,S);return lt&&(I=function(yt,Tt){for(var kt=[],Ut=new l(0,0),$t=0;$t<yt.length;$t++){for(var qt=yt[$t],ie=[],de=0;de<qt.length;de++){var ge=qt[de],we=qt[de+1],De=de===0?Ut:ge.sub(qt[de-1])._unit()._perp(),Ke=de===qt.length-1?Ut:we.sub(ge)._unit()._perp(),or=De._add(Ke)._unit();or._mult(1/(or.x*Ke.x+or.y*Ke.y)),ie.push(or._mult(Tt)._add(ge))}kt.push(ie)}return kt}(I,lt*Q)),function(yt,Tt,kt){for(var Ut=0;Ut<Tt.length;Ut++){var $t=Tt[Ut];if(yt.length>=3){for(var qt=0;qt<$t.length;qt++)if(Ki(yt,$t[qt]))return!0}if(Dc(yt,$t,kt))return!0}return!1}(rt,I,st)},u.prototype.isTileClipped=function(){return!0},u}(Ra);function G8(a,u){return u>0?u+2*a:a}var Lht=Ss([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Oht=Ss([{name:"a_projected_pos",components:3,type:"Float32"}],4),Bht=(Ss([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Ss([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),X8=(Ss([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Ss([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Dht=Ss([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Nht(a,u,f){return a.sections.forEach(function(b){b.text=function(S,I,N){var H=I.layout.get("text-transform").evaluate(N,{});return H==="uppercase"?S=S.toLocaleUpperCase():H==="lowercase"&&(S=S.toLocaleLowerCase()),_c.applyArabicShaping&&(S=_c.applyArabicShaping(S)),S}(b.text,u,f)}),a}Ss([{name:"triangle",components:3,type:"Uint16"}]),Ss([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ss([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ss([{type:"Float32",name:"offsetX"}]),Ss([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Bx={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Y8=function(a,u,f,b,S){var I,N,H=8*S-b-1,Q=(1<<H)-1,rt=Q>>1,st=-7,lt=f?S-1:0,yt=f?-1:1,Tt=a[u+lt];for(lt+=yt,I=Tt&(1<<-st)-1,Tt>>=-st,st+=H;st>0;I=256*I+a[u+lt],lt+=yt,st-=8);for(N=I&(1<<-st)-1,I>>=-st,st+=b;st>0;N=256*N+a[u+lt],lt+=yt,st-=8);if(I===0)I=1-rt;else{if(I===Q)return N?NaN:1/0*(Tt?-1:1);N+=Math.pow(2,b),I-=rt}return(Tt?-1:1)*N*Math.pow(2,I-b)},K8=function(a,u,f,b,S,I){var N,H,Q,rt=8*I-S-1,st=(1<<rt)-1,lt=st>>1,yt=S===23?Math.pow(2,-24)-Math.pow(2,-77):0,Tt=b?0:I-1,kt=b?1:-1,Ut=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(H=isNaN(u)?1:0,N=st):(N=Math.floor(Math.log(u)/Math.LN2),u*(Q=Math.pow(2,-N))<1&&(N--,Q*=2),(u+=N+lt>=1?yt/Q:yt*Math.pow(2,1-lt))*Q>=2&&(N++,Q/=2),N+lt>=st?(H=0,N=st):N+lt>=1?(H=(u*Q-1)*Math.pow(2,S),N+=lt):(H=u*Math.pow(2,lt-1)*Math.pow(2,S),N=0));S>=8;a[f+Tt]=255&H,Tt+=kt,H/=256,S-=8);for(N=N<<S|H,rt+=S;rt>0;a[f+Tt]=255&N,Tt+=kt,N/=256,rt-=8);a[f+Tt-kt]|=128*Ut},HT=lo;function lo(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}lo.Varint=0,lo.Fixed64=1,lo.Bytes=2,lo.Fixed32=5;var Z8=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Cp(a){return a.type===lo.Bytes?a.readVarint()+a.pos:a.pos+1}function Vg(a,u,f){return f?4294967296*u+(a>>>0):4294967296*(u>>>0)+(a>>>0)}function $8(a,u,f){var b=u<=16383?1:u<=2097151?2:u<=268435455?3:Math.floor(Math.log(u)/(7*Math.LN2));f.realloc(b);for(var S=f.pos-1;S>=a;S--)f.buf[S+b]=f.buf[S]}function kht(a,u){for(var f=0;f<a.length;f++)u.writeVarint(a[f])}function Fht(a,u){for(var f=0;f<a.length;f++)u.writeSVarint(a[f])}function zht(a,u){for(var f=0;f<a.length;f++)u.writeFloat(a[f])}function Uht(a,u){for(var f=0;f<a.length;f++)u.writeDouble(a[f])}function Vht(a,u){for(var f=0;f<a.length;f++)u.writeBoolean(a[f])}function jht(a,u){for(var f=0;f<a.length;f++)u.writeFixed32(a[f])}function Hht(a,u){for(var f=0;f<a.length;f++)u.writeSFixed32(a[f])}function Wht(a,u){for(var f=0;f<a.length;f++)u.writeFixed64(a[f])}function qht(a,u){for(var f=0;f<a.length;f++)u.writeSFixed64(a[f])}function WT(a,u){return(a[u]|a[u+1]<<8|a[u+2]<<16)+16777216*a[u+3]}function jg(a,u,f){a[f]=u,a[f+1]=u>>>8,a[f+2]=u>>>16,a[f+3]=u>>>24}function Q8(a,u){return(a[u]|a[u+1]<<8|a[u+2]<<16)+(a[u+3]<<24)}function Ght(a,u,f){a===1&&f.readMessage(Xht,u)}function Xht(a,u,f){if(a===3){var b=f.readMessage(Yht,{}),S=b.width,I=b.height,N=b.left,H=b.top,Q=b.advance;u.push({id:b.id,bitmap:new vn({width:S+6,height:I+6},b.bitmap),metrics:{width:S,height:I,left:N,top:H,advance:Q}})}}function Yht(a,u,f){a===1?u.id=f.readVarint():a===2?u.bitmap=f.readBytes():a===3?u.width=f.readVarint():a===4?u.height=f.readVarint():a===5?u.left=f.readSVarint():a===6?u.top=f.readSVarint():a===7&&(u.advance=f.readVarint())}function J8(a){for(var u=0,f=0,b=0,S=a;b<S.length;b+=1){var I=S[b];u+=I.w*I.h,f=Math.max(f,I.w)}a.sort(function(Ut,$t){return $t.h-Ut.h});for(var N=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(u/.95)),f),h:1/0}],H=0,Q=0,rt=0,st=a;rt<st.length;rt+=1)for(var lt=st[rt],yt=N.length-1;yt>=0;yt--){var Tt=N[yt];if(!(lt.w>Tt.w||lt.h>Tt.h)){if(lt.x=Tt.x,lt.y=Tt.y,Q=Math.max(Q,lt.y+lt.h),H=Math.max(H,lt.x+lt.w),lt.w===Tt.w&&lt.h===Tt.h){var kt=N.pop();yt<N.length&&(N[yt]=kt)}else lt.h===Tt.h?(Tt.x+=lt.w,Tt.w-=lt.w):lt.w===Tt.w?(Tt.y+=lt.h,Tt.h-=lt.h):(N.push({x:Tt.x+lt.w,y:Tt.y,w:Tt.w-lt.w,h:lt.h}),Tt.y+=lt.h,Tt.h-=lt.h);break}}return{w:H,h:Q,fill:u/(H*Q)||0}}lo.prototype={destroy:function(){this.buf=null},readFields:function(a,u,f){for(f=f||this.length;this.pos<f;){var b=this.readVarint(),S=b>>3,I=this.pos;this.type=7&b,a(S,u,this),this.pos===I&&this.skip(b)}return u},readMessage:function(a,u){return this.readFields(a,u,this.readVarint()+this.pos)},readFixed32:function(){var a=WT(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=Q8(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=WT(this.buf,this.pos)+4294967296*WT(this.buf,this.pos+4);return this.pos+=8,a},readSFixed64:function(){var a=WT(this.buf,this.pos)+4294967296*Q8(this.buf,this.pos+4);return this.pos+=8,a},readFloat:function(){var a=Y8(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=Y8(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var u,f,b=this.buf;return u=127&(f=b[this.pos++]),f<128?u:(u|=(127&(f=b[this.pos++]))<<7,f<128?u:(u|=(127&(f=b[this.pos++]))<<14,f<128?u:(u|=(127&(f=b[this.pos++]))<<21,f<128?u:function(S,I,N){var H,Q,rt=N.buf;if(H=(112&(Q=rt[N.pos++]))>>4,Q<128||(H|=(127&(Q=rt[N.pos++]))<<3,Q<128)||(H|=(127&(Q=rt[N.pos++]))<<10,Q<128)||(H|=(127&(Q=rt[N.pos++]))<<17,Q<128)||(H|=(127&(Q=rt[N.pos++]))<<24,Q<128)||(H|=(1&(Q=rt[N.pos++]))<<31,Q<128))return Vg(S,H,I);throw new Error("Expected varint not more than 10 bytes")}(u|=(15&(f=b[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,u=this.pos;return this.pos=a,a-u>=12&&Z8?function(f,b,S){return Z8.decode(f.subarray(b,S))}(this.buf,u,a):function(f,b,S){for(var I="",N=b;N<S;){var H,Q,rt,st=f[N],lt=null,yt=st>239?4:st>223?3:st>191?2:1;if(N+yt>S)break;yt===1?st<128&&(lt=st):yt===2?(192&(H=f[N+1]))==128&&(lt=(31&st)<<6|63&H)<=127&&(lt=null):yt===3?(Q=f[N+2],(192&(H=f[N+1]))==128&&(192&Q)==128&&((lt=(15&st)<<12|(63&H)<<6|63&Q)<=2047||lt>=55296&&lt<=57343)&&(lt=null)):yt===4&&(Q=f[N+2],rt=f[N+3],(192&(H=f[N+1]))==128&&(192&Q)==128&&(192&rt)==128&&((lt=(15&st)<<18|(63&H)<<12|(63&Q)<<6|63&rt)<=65535||lt>=1114112)&&(lt=null)),lt===null?(lt=65533,yt=1):lt>65535&&(lt-=65536,I+=String.fromCharCode(lt>>>10&1023|55296),lt=56320|1023&lt),I+=String.fromCharCode(lt),N+=yt}return I}(this.buf,u,a)},readBytes:function(){var a=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,a);return this.pos=a,u},readPackedVarint:function(a,u){if(this.type!==lo.Bytes)return a.push(this.readVarint(u));var f=Cp(this);for(a=a||[];this.pos<f;)a.push(this.readVarint(u));return a},readPackedSVarint:function(a){if(this.type!==lo.Bytes)return a.push(this.readSVarint());var u=Cp(this);for(a=a||[];this.pos<u;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==lo.Bytes)return a.push(this.readBoolean());var u=Cp(this);for(a=a||[];this.pos<u;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==lo.Bytes)return a.push(this.readFloat());var u=Cp(this);for(a=a||[];this.pos<u;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==lo.Bytes)return a.push(this.readDouble());var u=Cp(this);for(a=a||[];this.pos<u;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==lo.Bytes)return a.push(this.readFixed32());var u=Cp(this);for(a=a||[];this.pos<u;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==lo.Bytes)return a.push(this.readSFixed32());var u=Cp(this);for(a=a||[];this.pos<u;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==lo.Bytes)return a.push(this.readFixed64());var u=Cp(this);for(a=a||[];this.pos<u;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==lo.Bytes)return a.push(this.readSFixed64());var u=Cp(this);for(a=a||[];this.pos<u;)a.push(this.readSFixed64());return a},skip:function(a){var u=7&a;if(u===lo.Varint)for(;this.buf[this.pos++]>127;);else if(u===lo.Bytes)this.pos=this.readVarint()+this.pos;else if(u===lo.Fixed32)this.pos+=4;else{if(u!==lo.Fixed64)throw new Error("Unimplemented type: "+u);this.pos+=8}},writeTag:function(a,u){this.writeVarint(a<<3|u)},realloc:function(a){for(var u=this.length||16;u<this.pos+a;)u*=2;if(u!==this.length){var f=new Uint8Array(u);f.set(this.buf),this.buf=f,this.length=u}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),jg(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),jg(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),jg(this.buf,-1&a,this.pos),jg(this.buf,Math.floor(a*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),jg(this.buf,-1&a,this.pos),jg(this.buf,Math.floor(a*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(u,f){var b,S;if(u>=0?(b=u%4294967296|0,S=u/4294967296|0):(S=~(-u/4294967296),4294967295^(b=~(-u%4294967296))?b=b+1|0:(b=0,S=S+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");f.realloc(10),function(I,N,H){H.buf[H.pos++]=127&I|128,I>>>=7,H.buf[H.pos++]=127&I|128,I>>>=7,H.buf[H.pos++]=127&I|128,I>>>=7,H.buf[H.pos++]=127&I|128,H.buf[H.pos]=127&(I>>>=7)}(b,0,f),function(I,N){var H=(7&I)<<4;N.buf[N.pos++]|=H|((I>>>=3)?128:0),I&&(N.buf[N.pos++]=127&I|((I>>>=7)?128:0),I&&(N.buf[N.pos++]=127&I|((I>>>=7)?128:0),I&&(N.buf[N.pos++]=127&I|((I>>>=7)?128:0),I&&(N.buf[N.pos++]=127&I|((I>>>=7)?128:0),I&&(N.buf[N.pos++]=127&I)))))}(S,f)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var u=this.pos;this.pos=function(b,S,I){for(var N,H,Q=0;Q<S.length;Q++){if((N=S.charCodeAt(Q))>55295&&N<57344){if(!H){N>56319||Q+1===S.length?(b[I++]=239,b[I++]=191,b[I++]=189):H=N;continue}if(N<56320){b[I++]=239,b[I++]=191,b[I++]=189,H=N;continue}N=H-55296<<10|N-56320|65536,H=null}else H&&(b[I++]=239,b[I++]=191,b[I++]=189,H=null);N<128?b[I++]=N:(N<2048?b[I++]=N>>6|192:(N<65536?b[I++]=N>>12|224:(b[I++]=N>>18|240,b[I++]=N>>12&63|128),b[I++]=N>>6&63|128),b[I++]=63&N|128)}return I}(this.buf,a,this.pos);var f=this.pos-u;f>=128&&$8(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f},writeFloat:function(a){this.realloc(4),K8(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),K8(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var u=a.length;this.writeVarint(u),this.realloc(u);for(var f=0;f<u;f++)this.buf[this.pos++]=a[f]},writeRawMessage:function(a,u){this.pos++;var f=this.pos;a(u,this);var b=this.pos-f;b>=128&&$8(f,b,this),this.pos=f-1,this.writeVarint(b),this.pos+=b},writeMessage:function(a,u,f){this.writeTag(a,lo.Bytes),this.writeRawMessage(u,f)},writePackedVarint:function(a,u){u.length&&this.writeMessage(a,kht,u)},writePackedSVarint:function(a,u){u.length&&this.writeMessage(a,Fht,u)},writePackedBoolean:function(a,u){u.length&&this.writeMessage(a,Vht,u)},writePackedFloat:function(a,u){u.length&&this.writeMessage(a,zht,u)},writePackedDouble:function(a,u){u.length&&this.writeMessage(a,Uht,u)},writePackedFixed32:function(a,u){u.length&&this.writeMessage(a,jht,u)},writePackedSFixed32:function(a,u){u.length&&this.writeMessage(a,Hht,u)},writePackedFixed64:function(a,u){u.length&&this.writeMessage(a,Wht,u)},writePackedSFixed64:function(a,u){u.length&&this.writeMessage(a,qht,u)},writeBytesField:function(a,u){this.writeTag(a,lo.Bytes),this.writeBytes(u)},writeFixed32Field:function(a,u){this.writeTag(a,lo.Fixed32),this.writeFixed32(u)},writeSFixed32Field:function(a,u){this.writeTag(a,lo.Fixed32),this.writeSFixed32(u)},writeFixed64Field:function(a,u){this.writeTag(a,lo.Fixed64),this.writeFixed64(u)},writeSFixed64Field:function(a,u){this.writeTag(a,lo.Fixed64),this.writeSFixed64(u)},writeVarintField:function(a,u){this.writeTag(a,lo.Varint),this.writeVarint(u)},writeSVarintField:function(a,u){this.writeTag(a,lo.Varint),this.writeSVarint(u)},writeStringField:function(a,u){this.writeTag(a,lo.Bytes),this.writeString(u)},writeFloatField:function(a,u){this.writeTag(a,lo.Fixed32),this.writeFloat(u)},writeDoubleField:function(a,u){this.writeTag(a,lo.Fixed64),this.writeDouble(u)},writeBooleanField:function(a,u){this.writeVarintField(a,Boolean(u))}};var qT=function(a,u){var f=u.pixelRatio,b=u.version,S=u.stretchX,I=u.stretchY,N=u.content;this.paddedRect=a,this.pixelRatio=f,this.stretchX=S,this.stretchY=I,this.content=N,this.version=b},Dx={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Dx.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Dx.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Dx.tlbr.get=function(){return this.tl.concat(this.br)},Dx.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(qT.prototype,Dx);var Nx=function(a,u){var f={},b={};this.haveRenderCallbacks=[];var S=[];this.addImages(a,f,S),this.addImages(u,b,S);var I=J8(S),N=new Vo({width:I.w||1,height:I.h||1});for(var H in a){var Q=a[H],rt=f[H].paddedRect;Vo.copy(Q.data,N,{x:0,y:0},{x:rt.x+1,y:rt.y+1},Q.data)}for(var st in u){var lt=u[st],yt=b[st].paddedRect,Tt=yt.x+1,kt=yt.y+1,Ut=lt.data.width,$t=lt.data.height;Vo.copy(lt.data,N,{x:0,y:0},{x:Tt,y:kt},lt.data),Vo.copy(lt.data,N,{x:0,y:$t-1},{x:Tt,y:kt-1},{width:Ut,height:1}),Vo.copy(lt.data,N,{x:0,y:0},{x:Tt,y:kt+$t},{width:Ut,height:1}),Vo.copy(lt.data,N,{x:Ut-1,y:0},{x:Tt-1,y:kt},{width:1,height:$t}),Vo.copy(lt.data,N,{x:0,y:0},{x:Tt+Ut,y:kt},{width:1,height:$t})}this.image=N,this.iconPositions=f,this.patternPositions=b};Nx.prototype.addImages=function(a,u,f){for(var b in a){var S=a[b],I={x:0,y:0,w:S.data.width+2,h:S.data.height+2};f.push(I),u[b]=new qT(I,S),S.hasRenderCallback&&this.haveRenderCallbacks.push(b)}},Nx.prototype.patchUpdatedImages=function(a,u){for(var f in a.dispatchRenderCallbacks(this.haveRenderCallbacks),a.updatedImages)this.patchUpdatedImage(this.iconPositions[f],a.getImage(f),u),this.patchUpdatedImage(this.patternPositions[f],a.getImage(f),u)},Nx.prototype.patchUpdatedImage=function(a,u,f){if(a&&u&&a.version!==u.version){a.version=u.version;var b=a.tl;f.update(u.data,void 0,{x:b[0],y:b[1]})}},_r("ImagePosition",qT),_r("ImageAtlas",Nx);var Rl={horizontal:1,vertical:2,horizontalOnly:3},Hg=function(){this.scale=1,this.fontStack="",this.imageName=null};Hg.forText=function(a,u){var f=new Hg;return f.scale=a||1,f.fontStack=u,f},Hg.forImage=function(a){var u=new Hg;return u.imageName=a,u};var $a=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function GT(a,u,f,b,S,I,N,H,Q,rt,st,lt,yt,Tt,kt,Ut){var $t,qt=$a.fromFeature(a,S);lt===Rl.vertical&&qt.verticalizePunctuation();var ie=_c.processBidirectionalText,de=_c.processStyledBidirectionalText;if(ie&&qt.sections.length===1){$t=[];for(var ge=0,we=ie(qt.toString(),eL(qt,rt,I,u,b,Tt,kt));ge<we.length;ge+=1){var De=we[ge],Ke=new $a;Ke.text=De,Ke.sections=qt.sections;for(var or=0;or<De.length;or++)Ke.sectionIndex.push(0);$t.push(Ke)}}else if(de){$t=[];for(var Hr=0,vr=de(qt.text,qt.sectionIndex,eL(qt,rt,I,u,b,Tt,kt));Hr<vr.length;Hr+=1){var Zr=vr[Hr],Tr=new $a;Tr.text=Zr[0],Tr.sectionIndex=Zr[1],Tr.sections=qt.sections,$t.push(Tr)}}else $t=function(Fr,Wn){for(var En=[],si=Fr.text,Qr=0,bi=0,To=Wn;bi<To.length;bi+=1){var Xo=To[bi];En.push(Fr.substring(Qr,Xo)),Qr=Xo}return Qr<si.length&&En.push(Fr.substring(Qr,si.length)),En}(qt,eL(qt,rt,I,u,b,Tt,kt));var Ln=[],un={positionedLines:Ln,text:qt.toString(),top:st[1],bottom:st[1],left:st[0],right:st[0],writingMode:lt,iconsInText:!1,verticalizable:!1};return function(Fr,Wn,En,si,Qr,bi,To,Xo,jo,Eo,Yo,js){for(var Hs=0,Qa=-17,ea=0,Ja=0,ss=Xo==="right"?1:Xo==="left"?0:.5,ra=0,Jn=0,$i=Qr;Jn<$i.length;Jn+=1){var zi=$i[Jn];zi.trim();var hi=zi.getMaxScale(),bc=24*(hi-1),Ba={positionedGlyphs:[],lineOffset:0};Fr.positionedLines[ra]=Ba;var mo=Ba.positionedGlyphs,xs=0;if(zi.length()){for(var Da=0;Da<zi.length();Da++){var wi=zi.getSection(Da),xf=zi.getSectionIndex(Da),Ll=zi.getCharCode(Da),vf=0,as=null,bf=null,zu=null,$g=24,BA=!(jo===Rl.horizontal||!Yo&&!mh(Ll)||Yo&&(XT[Ll]||(Lp=Ll,lr.Arabic(Lp)||lr["Arabic Supplement"](Lp)||lr["Arabic Extended-A"](Lp)||lr["Arabic Presentation Forms-A"](Lp)||lr["Arabic Presentation Forms-B"](Lp))));if(wi.imageName){var Qg=si[wi.imageName];if(!Qg)continue;zu=wi.imageName,Fr.iconsInText=Fr.iconsInText||!0,bf=Qg.paddedRect;var Rp=Qg.displaySize;wi.scale=24*wi.scale/js,vf=bc+(24-Rp[1]*wi.scale),$g=(as={width:Rp[0],height:Rp[1],left:1,top:-3,advance:BA?Rp[1]:Rp[0]}).advance;var Jg=BA?Rp[0]*wi.scale-24*hi:Rp[1]*wi.scale-24*hi;Jg>0&&Jg>xs&&(xs=Jg)}else{var rE=En[wi.fontStack],t_=rE&&rE[Ll];if(t_&&t_.rect)bf=t_.rect,as=t_.metrics;else{var zx=Wn[wi.fontStack],nE=zx&&zx[Ll];if(!nE)continue;as=nE.metrics}vf=24*(hi-wi.scale)}BA?(Fr.verticalizable=!0,mo.push({glyph:Ll,imageName:zu,x:Hs,y:Qa+vf,vertical:BA,scale:wi.scale,fontStack:wi.fontStack,sectionIndex:xf,metrics:as,rect:bf}),Hs+=$g*wi.scale+Eo):(mo.push({glyph:Ll,imageName:zu,x:Hs,y:Qa+vf,vertical:BA,scale:wi.scale,fontStack:wi.fontStack,sectionIndex:xf,metrics:as,rect:bf}),Hs+=as.advance*wi.scale+Eo)}mo.length!==0&&(ea=Math.max(Hs-Eo,ea),Zht(mo,0,mo.length-1,ss,xs)),Hs=0;var iE=bi*hi+xs;Ba.lineOffset=Math.max(xs,bc),Qa+=iE,Ja=Math.max(iE,Ja),++ra}else Qa+=bi,++ra}var Lp,Ux=Qa- -17,e_=rL(To),Gd=e_.horizontalAlign,r_=e_.verticalAlign;(function(oE,sE,Vx,jx,aE,Hx,Wx,qx,cE){var n_,lE=(sE-Vx)*aE;n_=Hx!==Wx?-qx*jx- -17:(-jx*cE+.5)*Wx;for(var i_=0,Gx=oE;i_<Gx.length;i_+=1)for(var DA=0,Xx=Gx[i_].positionedGlyphs;DA<Xx.length;DA+=1){var o_=Xx[DA];o_.x+=lE,o_.y+=n_}})(Fr.positionedLines,ss,Gd,r_,ea,Ja,bi,Ux,Qr.length),Fr.top+=-r_*Ux,Fr.bottom=Fr.top+Ux,Fr.left+=-Gd*ea,Fr.right=Fr.left+ea}(un,u,f,b,$t,N,H,Q,lt,rt,yt,Ut),!function(Fr){for(var Wn=0,En=Fr;Wn<En.length;Wn+=1)if(En[Wn].positionedGlyphs.length!==0)return!1;return!0}(Ln)&&un}$a.fromFeature=function(a,u){for(var f=new $a,b=0;b<a.sections.length;b++){var S=a.sections[b];S.image?f.addImageSection(S):f.addTextSection(S,u)}return f},$a.prototype.length=function(){return this.text.length},$a.prototype.getSection=function(a){return this.sections[this.sectionIndex[a]]},$a.prototype.getSectionIndex=function(a){return this.sectionIndex[a]},$a.prototype.getCharCode=function(a){return this.text.charCodeAt(a)},$a.prototype.verticalizePunctuation=function(){this.text=function(a){for(var u="",f=0;f<a.length;f++){var b=a.charCodeAt(f+1)||null,S=a.charCodeAt(f-1)||null;u+=b&&ru(b)&&!Bx[a[f+1]]||S&&ru(S)&&!Bx[a[f-1]]||!Bx[a[f]]?a[f]:Bx[a[f]]}return u}(this.text)},$a.prototype.trim=function(){for(var a=0,u=0;u<this.text.length&&XT[this.text.charCodeAt(u)];u++)a++;for(var f=this.text.length,b=this.text.length-1;b>=0&&b>=a&&XT[this.text.charCodeAt(b)];b--)f--;this.text=this.text.substring(a,f),this.sectionIndex=this.sectionIndex.slice(a,f)},$a.prototype.substring=function(a,u){var f=new $a;return f.text=this.text.substring(a,u),f.sectionIndex=this.sectionIndex.slice(a,u),f.sections=this.sections,f},$a.prototype.toString=function(){return this.text},$a.prototype.getMaxScale=function(){var a=this;return this.sectionIndex.reduce(function(u,f){return Math.max(u,a.sections[f].scale)},0)},$a.prototype.addTextSection=function(a,u){this.text+=a.text,this.sections.push(Hg.forText(a.scale,a.fontStack||u));for(var f=this.sections.length-1,b=0;b<a.text.length;++b)this.sectionIndex.push(f)},$a.prototype.addImageSection=function(a){var u=a.image?a.image.name:"";if(u.length!==0){var f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(Hg.forImage(u)),this.sectionIndex.push(this.sections.length-1)):mt("Reached maximum number of images 6401")}else mt("Can't add FormattedSection with an empty image.")},$a.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var XT={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},cl={};function tU(a,u,f,b,S,I){if(u.imageName){var N=b[u.imageName];return N?N.displaySize[0]*u.scale*24/I+S:0}var H=f[u.fontStack],Q=H&&H[a];return Q?Q.metrics.advance*u.scale+S:0}function eU(a,u,f,b){var S=Math.pow(a-u,2);return b?a<u?S/2:2*S:S+Math.abs(f)*f}function Kht(a,u,f){var b=0;return a===10&&(b-=1e4),f&&(b+=150),a!==40&&a!==65288||(b+=50),u!==41&&u!==65289||(b+=50),b}function rU(a,u,f,b,S,I){for(var N=null,H=eU(u,f,S,I),Q=0,rt=b;Q<rt.length;Q+=1){var st=rt[Q],lt=eU(u-st.x,f,S,I)+st.badness;lt<=H&&(N=st,H=lt)}return{index:a,x:u,priorBreak:N,badness:H}}function eL(a,u,f,b,S,I,N){if(I!=="point")return[];if(!a)return[];for(var H,Q=[],rt=function($t,qt,ie,de,ge,we){for(var De=0,Ke=0;Ke<$t.length();Ke++){var or=$t.getSection(Ke);De+=tU($t.getCharCode(Ke),or,de,ge,qt,we)}return De/Math.max(1,Math.ceil(De/ie))}(a,u,f,b,S,N),st=a.text.indexOf("\u200B")>=0,lt=0,yt=0;yt<a.length();yt++){var Tt=a.getSection(yt),kt=a.getCharCode(yt);if(XT[kt]||(lt+=tU(kt,Tt,b,S,u,N)),yt<a.length()-1){var Ut=!((H=kt)<11904||!(lr["Bopomofo Extended"](H)||lr.Bopomofo(H)||lr["CJK Compatibility Forms"](H)||lr["CJK Compatibility Ideographs"](H)||lr["CJK Compatibility"](H)||lr["CJK Radicals Supplement"](H)||lr["CJK Strokes"](H)||lr["CJK Symbols and Punctuation"](H)||lr["CJK Unified Ideographs Extension A"](H)||lr["CJK Unified Ideographs"](H)||lr["Enclosed CJK Letters and Months"](H)||lr["Halfwidth and Fullwidth Forms"](H)||lr.Hiragana(H)||lr["Ideographic Description Characters"](H)||lr["Kangxi Radicals"](H)||lr["Katakana Phonetic Extensions"](H)||lr.Katakana(H)||lr["Vertical Forms"](H)||lr["Yi Radicals"](H)||lr["Yi Syllables"](H)));(cl[kt]||Ut||Tt.imageName)&&Q.push(rU(yt+1,lt,rt,Q,Kht(kt,a.getCharCode(yt+1),Ut&&st),!1))}}return function $t(qt){return qt?$t(qt.priorBreak).concat(qt.index):[]}(rU(a.length(),lt,rt,Q,0,!0))}function rL(a){var u=.5,f=.5;switch(a){case"right":case"top-right":case"bottom-right":u=1;break;case"left":case"top-left":case"bottom-left":u=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":f=1;break;case"top":case"top-right":case"top-left":f=0}return{horizontalAlign:u,verticalAlign:f}}function Zht(a,u,f,b,S){if(b||S)for(var I=a[f],N=(a[f].x+I.metrics.advance*I.scale)*b,H=u;H<=f;H++)a[H].x-=N,a[H].y+=S}function nU(a,u,f,b,S,I){var N,H=a.image;if(H.content){var Q=H.content,rt=H.pixelRatio||1;N=[Q[0]/rt,Q[1]/rt,H.displaySize[0]-Q[2]/rt,H.displaySize[1]-Q[3]/rt]}var st,lt,yt,Tt,kt=u.left*I,Ut=u.right*I;f==="width"||f==="both"?(Tt=S[0]+kt-b[3],lt=S[0]+Ut+b[1]):lt=(Tt=S[0]+(kt+Ut-H.displaySize[0])/2)+H.displaySize[0];var $t=u.top*I,qt=u.bottom*I;return f==="height"||f==="both"?(st=S[1]+$t-b[0],yt=S[1]+qt+b[2]):yt=(st=S[1]+($t+qt-H.displaySize[1])/2)+H.displaySize[1],{image:H,top:st,right:lt,bottom:yt,left:Tt,collisionPadding:N}}cl[10]=!0,cl[32]=!0,cl[38]=!0,cl[40]=!0,cl[41]=!0,cl[43]=!0,cl[45]=!0,cl[47]=!0,cl[173]=!0,cl[183]=!0,cl[8203]=!0,cl[8208]=!0,cl[8211]=!0,cl[8231]=!0;var Wg=function(a){function u(f,b,S,I){a.call(this,f,b),this.angle=S,I!==void 0&&(this.segment=I)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.clone=function(){return new u(this.x,this.y,this.angle,this.segment)},u}(l);function nL(a,u){var f=u.expression;if(f.kind==="constant")return{kind:"constant",layoutSize:f.evaluate(new Un(a+1))};if(f.kind==="source")return{kind:"source"};for(var b=f.zoomStops,S=f.interpolationType,I=0;I<b.length&&b[I]<=a;)I++;for(var N=I=Math.max(0,I-1);N<b.length&&b[N]<a+1;)N++;N=Math.min(b.length-1,N);var H=b[I],Q=b[N];return f.kind==="composite"?{kind:"composite",minZoom:H,maxZoom:Q,interpolationType:S}:{kind:"camera",minZoom:H,maxZoom:Q,minSize:f.evaluate(new Un(H)),maxSize:f.evaluate(new Un(Q)),interpolationType:S}}function iU(a,u,f){var b=u.uSize,S=f.lowerSize;return a.kind==="source"?S/128:a.kind==="composite"?xo(S/128,f.upperSize/128,u.uSizeT):b}function oU(a,u){var f=0,b=0;if(a.kind==="constant")b=a.layoutSize;else if(a.kind!=="source"){var S=a.interpolationType,I=S?P(R.interpolationFactor(S,u,a.minZoom,a.maxZoom),0,1):0;a.kind==="camera"?b=xo(a.minSize,a.maxSize,I):f=I}return{uSizeT:f,uSize:b}}_r("Anchor",Wg);var $ht=Object.freeze({__proto__:null,getSizeData:nL,evaluateSizeForFeature:iU,evaluateSizeForZoom:oU,SIZE_PACK_FACTOR:128});function sU(a,u,f,b,S){if(u.segment===void 0)return!0;for(var I=u,N=u.segment+1,H=0;H>-f/2;){if(--N<0)return!1;H-=a[N].dist(I),I=a[N]}H+=a[N].dist(a[N+1]),N++;for(var Q=[],rt=0;H<f/2;){var st=a[N],lt=a[N+1];if(!lt)return!1;var yt=a[N-1].angleTo(st)-st.angleTo(lt);for(yt=Math.abs((yt+3*Math.PI)%(2*Math.PI)-Math.PI),Q.push({distance:H,angleDelta:yt}),rt+=yt;H-Q[0].distance>b;)rt-=Q.shift().angleDelta;if(rt>S)return!1;N++,H+=st.dist(lt)}return!0}function aU(a){for(var u=0,f=0;f<a.length-1;f++)u+=a[f].dist(a[f+1]);return u}function cU(a,u,f){return a?.6*u*f:0}function lU(a,u){return Math.max(a?a.right-a.left:0,u?u.right-u.left:0)}function Qht(a,u,f,b,S,I){for(var N=cU(f,S,I),H=lU(f,b)*I,Q=0,rt=aU(a)/2,st=0;st<a.length-1;st++){var lt=a[st],yt=a[st+1],Tt=lt.dist(yt);if(Q+Tt>rt){var kt=(rt-Q)/Tt,Ut=xo(lt.x,yt.x,kt),$t=xo(lt.y,yt.y,kt),qt=new Wg(Ut,$t,yt.angleTo(lt),st);return qt._round(),!N||sU(a,qt,H,N,u)?qt:void 0}Q+=Tt}}function Jht(a,u,f,b,S,I,N,H,Q){var rt=cU(b,I,N),st=lU(b,S),lt=st*N,yt=a[0].x===0||a[0].x===Q||a[0].y===0||a[0].y===Q;return u-lt<u/4&&(u=lt+u/4),function Tt(kt,Ut,$t,qt,ie,de,ge,we,De){for(var Ke=de/2,or=aU(kt),Hr=0,vr=Ut-$t,Zr=[],Tr=0;Tr<kt.length-1;Tr++){for(var Ln=kt[Tr],un=kt[Tr+1],Fr=Ln.dist(un),Wn=un.angleTo(Ln);vr+$t<Hr+Fr;){var En=((vr+=$t)-Hr)/Fr,si=xo(Ln.x,un.x,En),Qr=xo(Ln.y,un.y,En);if(si>=0&&si<De&&Qr>=0&&Qr<De&&vr-Ke>=0&&vr+Ke<=or){var bi=new Wg(si,Qr,Wn,Tr);bi._round(),qt&&!sU(kt,bi,de,qt,ie)||Zr.push(bi)}}Hr+=Fr}return we||Zr.length||ge||(Zr=Tt(kt,Hr/2,$t,qt,ie,de,ge,!0,De)),Zr}(a,yt?u/2*H%u:(st/2+2*I)*N*H%u,u,rt,f,lt,yt,!1,Q)}function uU(a,u,f,b,S){for(var I=[],N=0;N<a.length;N++)for(var H=a[N],Q=void 0,rt=0;rt<H.length-1;rt++){var st=H[rt],lt=H[rt+1];st.x<u&&lt.x<u||(st.x<u?st=new l(u,st.y+(u-st.x)/(lt.x-st.x)*(lt.y-st.y))._round():lt.x<u&&(lt=new l(u,st.y+(u-st.x)/(lt.x-st.x)*(lt.y-st.y))._round()),st.y<f&&lt.y<f||(st.y<f?st=new l(st.x+(f-st.y)/(lt.y-st.y)*(lt.x-st.x),f)._round():lt.y<f&&(lt=new l(st.x+(f-st.y)/(lt.y-st.y)*(lt.x-st.x),f)._round()),st.x>=b&&lt.x>=b||(st.x>=b?st=new l(b,st.y+(b-st.x)/(lt.x-st.x)*(lt.y-st.y))._round():lt.x>=b&&(lt=new l(b,st.y+(b-st.x)/(lt.x-st.x)*(lt.y-st.y))._round()),st.y>=S&&lt.y>=S||(st.y>=S?st=new l(st.x+(S-st.y)/(lt.y-st.y)*(lt.x-st.x),S)._round():lt.y>=S&&(lt=new l(st.x+(S-st.y)/(lt.y-st.y)*(lt.x-st.x),S)._round()),Q&&st.equals(Q[Q.length-1])||I.push(Q=[st]),Q.push(lt)))))}return I}function hU(a,u,f,b){var S=[],I=a.image,N=I.pixelRatio,H=I.paddedRect.w-2,Q=I.paddedRect.h-2,rt=a.right-a.left,st=a.bottom-a.top,lt=I.stretchX||[[0,H]],yt=I.stretchY||[[0,Q]],Tt=function(si,Qr){return si+Qr[1]-Qr[0]},kt=lt.reduce(Tt,0),Ut=yt.reduce(Tt,0),$t=H-kt,qt=Q-Ut,ie=0,de=kt,ge=0,we=Ut,De=0,Ke=$t,or=0,Hr=qt;if(I.content&&b){var vr=I.content;ie=YT(lt,0,vr[0]),ge=YT(yt,0,vr[1]),de=YT(lt,vr[0],vr[2]),we=YT(yt,vr[1],vr[3]),De=vr[0]-ie,or=vr[1]-ge,Ke=vr[2]-vr[0]-de,Hr=vr[3]-vr[1]-we}var Zr=function(si,Qr,bi,To){var Xo=KT(si.stretch-ie,de,rt,a.left),jo=ZT(si.fixed-De,Ke,si.stretch,kt),Eo=KT(Qr.stretch-ge,we,st,a.top),Yo=ZT(Qr.fixed-or,Hr,Qr.stretch,Ut),js=KT(bi.stretch-ie,de,rt,a.left),Hs=ZT(bi.fixed-De,Ke,bi.stretch,kt),Qa=KT(To.stretch-ge,we,st,a.top),ea=ZT(To.fixed-or,Hr,To.stretch,Ut),Ja=new l(Xo,Eo),ss=new l(js,Eo),ra=new l(js,Qa),Jn=new l(Xo,Qa),$i=new l(jo/N,Yo/N),zi=new l(Hs/N,ea/N),hi=u*Math.PI/180;if(hi){var bc=Math.sin(hi),Ba=Math.cos(hi),mo=[Ba,-bc,bc,Ba];Ja._matMult(mo),ss._matMult(mo),Jn._matMult(mo),ra._matMult(mo)}var xs=si.stretch+si.fixed,Da=Qr.stretch+Qr.fixed;return{tl:Ja,tr:ss,bl:Jn,br:ra,tex:{x:I.paddedRect.x+1+xs,y:I.paddedRect.y+1+Da,w:bi.stretch+bi.fixed-xs,h:To.stretch+To.fixed-Da},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:$i,pixelOffsetBR:zi,minFontScaleX:Ke/N/rt,minFontScaleY:Hr/N/st,isSDF:f}};if(b&&(I.stretchX||I.stretchY))for(var Tr=fU(lt,$t,kt),Ln=fU(yt,qt,Ut),un=0;un<Tr.length-1;un++)for(var Fr=Tr[un],Wn=Tr[un+1],En=0;En<Ln.length-1;En++)S.push(Zr(Fr,Ln[En],Wn,Ln[En+1]));else S.push(Zr({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:H+1},{fixed:0,stretch:Q+1}));return S}function YT(a,u,f){for(var b=0,S=0,I=a;S<I.length;S+=1){var N=I[S];b+=Math.max(u,Math.min(f,N[1]))-Math.max(u,Math.min(f,N[0]))}return b}function fU(a,u,f){for(var b=[{fixed:-1,stretch:0}],S=0,I=a;S<I.length;S+=1){var N=I[S],H=N[0],Q=N[1],rt=b[b.length-1];b.push({fixed:H-rt.stretch,stretch:rt.stretch}),b.push({fixed:H-rt.stretch,stretch:rt.stretch+(Q-H)})}return b.push({fixed:u+1,stretch:f}),b}function KT(a,u,f,b){return a/u*f+b}function ZT(a,u,f,b){return a-u*f/b}var $T=function(a,u,f,b,S,I,N,H,Q,rt){if(this.boxStartIndex=a.length,Q){var st=I.top,lt=I.bottom,yt=I.collisionPadding;yt&&(st-=yt[1],lt+=yt[3]);var Tt=lt-st;Tt>0&&(Tt=Math.max(10,Tt),this.circleDiameter=Tt)}else{var kt=I.top*N-H,Ut=I.bottom*N+H,$t=I.left*N-H,qt=I.right*N+H,ie=I.collisionPadding;if(ie&&($t-=ie[0]*N,kt-=ie[1]*N,qt+=ie[2]*N,Ut+=ie[3]*N),rt){var de=new l($t,kt),ge=new l(qt,kt),we=new l($t,Ut),De=new l(qt,Ut),Ke=rt*Math.PI/180;de._rotate(Ke),ge._rotate(Ke),we._rotate(Ke),De._rotate(Ke),$t=Math.min(de.x,ge.x,we.x,De.x),qt=Math.max(de.x,ge.x,we.x,De.x),kt=Math.min(de.y,ge.y,we.y,De.y),Ut=Math.max(de.y,ge.y,we.y,De.y)}a.emplaceBack(u.x,u.y,$t,kt,qt,Ut,f,b,S)}this.boxEndIndex=a.length},qg=function(a,u){if(a===void 0&&(a=[]),u===void 0&&(u=tft),this.data=a,this.length=this.data.length,this.compare=u,this.length>0)for(var f=(this.length>>1)-1;f>=0;f--)this._down(f)};function tft(a,u){return a<u?-1:a>u?1:0}function eft(a,u,f){u===void 0&&(u=1),f===void 0&&(f=!1);for(var b=1/0,S=1/0,I=-1/0,N=-1/0,H=a[0],Q=0;Q<H.length;Q++){var rt=H[Q];(!Q||rt.x<b)&&(b=rt.x),(!Q||rt.y<S)&&(S=rt.y),(!Q||rt.x>I)&&(I=rt.x),(!Q||rt.y>N)&&(N=rt.y)}var st=Math.min(I-b,N-S),lt=st/2,yt=new qg([],rft);if(st===0)return new l(b,S);for(var Tt=b;Tt<I;Tt+=st)for(var kt=S;kt<N;kt+=st)yt.push(new Gg(Tt+lt,kt+lt,lt,a));for(var Ut=function(ie){for(var de=0,ge=0,we=0,De=ie[0],Ke=0,or=De.length,Hr=or-1;Ke<or;Hr=Ke++){var vr=De[Ke],Zr=De[Hr],Tr=vr.x*Zr.y-Zr.x*vr.y;ge+=(vr.x+Zr.x)*Tr,we+=(vr.y+Zr.y)*Tr,de+=3*Tr}return new Gg(ge/de,we/de,0,ie)}(a),$t=yt.length;yt.length;){var qt=yt.pop();(qt.d>Ut.d||!Ut.d)&&(Ut=qt,f&&console.log("found best %d after %d probes",Math.round(1e4*qt.d)/1e4,$t)),qt.max-Ut.d<=u||(yt.push(new Gg(qt.p.x-(lt=qt.h/2),qt.p.y-lt,lt,a)),yt.push(new Gg(qt.p.x+lt,qt.p.y-lt,lt,a)),yt.push(new Gg(qt.p.x-lt,qt.p.y+lt,lt,a)),yt.push(new Gg(qt.p.x+lt,qt.p.y+lt,lt,a)),$t+=4)}return f&&(console.log("num probes: "+$t),console.log("best distance: "+Ut.d)),Ut.p}function rft(a,u){return u.max-a.max}function Gg(a,u,f,b){this.p=new l(a,u),this.h=f,this.d=function(S,I){for(var N=!1,H=1/0,Q=0;Q<I.length;Q++)for(var rt=I[Q],st=0,lt=rt.length,yt=lt-1;st<lt;yt=st++){var Tt=rt[st],kt=rt[yt];Tt.y>S.y!=kt.y>S.y&&S.x<(kt.x-Tt.x)*(S.y-Tt.y)/(kt.y-Tt.y)+Tt.x&&(N=!N),H=Math.min(H,xh(S,Tt,kt))}return(N?1:-1)*Math.sqrt(H)}(this.p,b),this.max=this.d+this.h*Math.SQRT2}qg.prototype.push=function(a){this.data.push(a),this.length++,this._up(this.length-1)},qg.prototype.pop=function(){if(this.length!==0){var a=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),a}},qg.prototype.peek=function(){return this.data[0]},qg.prototype._up=function(a){for(var u=this.data,f=this.compare,b=u[a];a>0;){var S=a-1>>1,I=u[S];if(f(b,I)>=0)break;u[a]=I,a=S}u[a]=b},qg.prototype._down=function(a){for(var u=this.data,f=this.compare,b=this.length>>1,S=u[a];a<b;){var I=1+(a<<1),N=u[I],H=I+1;if(H<this.length&&f(u[H],N)<0&&(I=H,N=u[H]),f(N,S)>=0)break;u[a]=N,a=I}u[a]=S};var iL=Number.POSITIVE_INFINITY;function pU(a,u){return u[1]!==iL?function(f,b,S){var I=0,N=0;switch(b=Math.abs(b),S=Math.abs(S),f){case"top-right":case"top-left":case"top":N=S-7;break;case"bottom-right":case"bottom-left":case"bottom":N=7-S}switch(f){case"top-right":case"bottom-right":case"right":I=-b;break;case"top-left":case"bottom-left":case"left":I=b}return[I,N]}(a,u[0],u[1]):function(f,b){var S=0,I=0;b<0&&(b=0);var N=b/Math.sqrt(2);switch(f){case"top-right":case"top-left":I=N-7;break;case"bottom-right":case"bottom-left":I=7-N;break;case"bottom":I=7-b;break;case"top":I=b-7}switch(f){case"top-right":case"bottom-right":S=-N;break;case"top-left":case"bottom-left":S=N;break;case"left":S=b;break;case"right":S=-b}return[S,I]}(a,u[0])}function oL(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function dU(a,u,f,b,S,I,N,H,Q,rt,st,lt,yt,Tt,kt){var Ut=function(ge,we,De,Ke,or,Hr,vr,Zr){for(var Tr=Ke.layout.get("text-rotate").evaluate(Hr,{})*Math.PI/180,Ln=[],un=0,Fr=we.positionedLines;un<Fr.length;un+=1)for(var Wn=Fr[un],En=0,si=Wn.positionedGlyphs;En<si.length;En+=1){var Qr=si[En];if(Qr.rect){var bi=Qr.rect||{},To=4,Xo=!0,jo=1,Eo=0,Yo=(or||Zr)&&Qr.vertical,js=Qr.metrics.advance*Qr.scale/2;if(Zr&&we.verticalizable&&(Eo=Wn.lineOffset/2-(Qr.imageName?-(24-Qr.metrics.width*Qr.scale)/2:24*(Qr.scale-1))),Qr.imageName){var Hs=vr[Qr.imageName];Xo=Hs.sdf,To=1/(jo=Hs.pixelRatio)}var Qa=or?[Qr.x+js,Qr.y]:[0,0],ea=or?[0,0]:[Qr.x+js+De[0],Qr.y+De[1]-Eo],Ja=[0,0];Yo&&(Ja=ea,ea=[0,0]);var ss=(Qr.metrics.left-To)*Qr.scale-js+ea[0],ra=(-Qr.metrics.top-To)*Qr.scale+ea[1],Jn=ss+bi.w*Qr.scale/jo,$i=ra+bi.h*Qr.scale/jo,zi=new l(ss,ra),hi=new l(Jn,ra),bc=new l(ss,$i),Ba=new l(Jn,$i);if(Yo){var mo=new l(-js,js- -17),xs=-Math.PI/2,Da=12-js,wi=new l(22-Da,-(Qr.imageName?Da:0)),xf=new(Function.prototype.bind.apply(l,[null].concat(Ja)));zi._rotateAround(xs,mo)._add(wi)._add(xf),hi._rotateAround(xs,mo)._add(wi)._add(xf),bc._rotateAround(xs,mo)._add(wi)._add(xf),Ba._rotateAround(xs,mo)._add(wi)._add(xf)}if(Tr){var Ll=Math.sin(Tr),vf=Math.cos(Tr),as=[vf,-Ll,Ll,vf];zi._matMult(as),hi._matMult(as),bc._matMult(as),Ba._matMult(as)}var bf=new l(0,0),zu=new l(0,0);Ln.push({tl:zi,tr:hi,bl:bc,br:Ba,tex:bi,writingMode:we.writingMode,glyphOffset:Qa,sectionIndex:Qr.sectionIndex,isSDF:Xo,pixelOffsetTL:bf,pixelOffsetBR:zu,minFontScaleX:0,minFontScaleY:0})}}return Ln}(0,f,H,S,I,N,b,a.allowVerticalPlacement),$t=a.textSizeData,qt=null;$t.kind==="source"?(qt=[128*S.layout.get("text-size").evaluate(N,{})])[0]>32640&&mt(a.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):$t.kind==="composite"&&((qt=[128*Tt.compositeTextSizes[0].evaluate(N,{},kt),128*Tt.compositeTextSizes[1].evaluate(N,{},kt)])[0]>32640||qt[1]>32640)&&mt(a.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),a.addSymbols(a.text,Ut,qt,H,I,N,rt,u,Q.lineStartIndex,Q.lineLength,yt,kt);for(var ie=0,de=st;ie<de.length;ie+=1)lt[de[ie]]=a.text.placedSymbolArray.length-1;return 4*Ut.length}function mU(a){for(var u in a)return a[u];return null}function nft(a,u,f,b){var S=a.compareText;if(u in S){for(var I=S[u],N=I.length-1;N>=0;N--)if(b.dist(I[N])<f)return!0}else S[u]=[];return S[u].push(b),!1}var ift=Sp.VectorTileFeature.types,oft=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function QT(a,u,f,b,S,I,N,H,Q,rt,st,lt,yt){var Tt=H?Math.min(32640,Math.round(H[0])):0,kt=H?Math.min(32640,Math.round(H[1])):0;a.emplaceBack(u,f,Math.round(32*b),Math.round(32*S),I,N,(Tt<<1)+(Q?1:0),kt,16*rt,16*st,256*lt,256*yt)}function sL(a,u,f){a.emplaceBack(u.x,u.y,f),a.emplaceBack(u.x,u.y,f),a.emplaceBack(u.x,u.y,f),a.emplaceBack(u.x,u.y,f)}function sft(a){for(var u=0,f=a.sections;u<f.length;u+=1)if(Ah(f[u].text))return!0;return!1}var Xg=function(a){this.layoutVertexArray=new jd,this.indexArray=new Ya,this.programConfigurations=a,this.segments=new Ct,this.dynamicLayoutVertexArray=new pf,this.opacityVertexArray=new xp,this.placedSymbolArray=new T};Xg.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Xg.prototype.upload=function(a,u,f,b){this.isEmpty()||(f&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Lht.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,Oht.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,oft,!0),this.opacityVertexBuffer.itemSize=1),(f||b)&&this.programConfigurations.upload(a))},Xg.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},_r("SymbolBuffers",Xg);var kx=function(a,u,f){this.layoutVertexArray=new a,this.layoutAttributes=u,this.indexArray=new f,this.segments=new Ct,this.collisionVertexArray=new vp};kx.prototype.upload=function(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,Bht.members,!0)},kx.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},_r("CollisionBuffers",kx);var Wi=function(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(I){return I.id}),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Za([]),this.placementViewportMatrix=Za([]);var u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=nL(this.zoom,u["text-size"]),this.iconSizeData=nL(this.zoom,u["icon-size"]);var f=this.layers[0].layout,b=f.get("symbol-sort-key"),S=f.get("symbol-z-order");this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=S!=="viewport-y"&&b.constantOr(1)!==void 0,this.sortFeaturesByY=(S==="viewport-y"||S==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map(function(I){return Rl[I]})),this.stateDependentLayerIds=this.layers.filter(function(I){return I.isStateDependent()}).map(function(I){return I.id}),this.sourceID=a.sourceID};Wi.prototype.createArrays=function(){this.text=new Xg(new en(this.layers,this.zoom,function(a){return/^text/.test(a)})),this.icon=new Xg(new en(this.layers,this.zoom,function(a){return/^icon/.test(a)})),this.glyphOffsetArray=new j,this.lineVertexArray=new K,this.symbolInstances=new U},Wi.prototype.calculateGlyphDependencies=function(a,u,f,b,S){for(var I=0;I<a.length;I++)if(u[a.charCodeAt(I)]=!0,(f||b)&&S){var N=Bx[a.charAt(I)];N&&(u[N.charCodeAt(0)]=!0)}},Wi.prototype.populate=function(a,u,f){var b=this.layers[0],S=b.layout,I=S.get("text-font"),N=S.get("text-field"),H=S.get("icon-image"),Q=(N.value.kind!=="constant"||N.value.value instanceof ns&&!N.value.value.isEmpty()||N.value.value.toString().length>0)&&(I.value.kind!=="constant"||I.value.value.length>0),rt=H.value.kind!=="constant"||!!H.value.value||Object.keys(H.parameters).length>0,st=S.get("symbol-sort-key");if(this.features=[],Q||rt){for(var lt=u.iconDependencies,yt=u.glyphDependencies,Tt=u.availableImages,kt=new Un(this.zoom),Ut=0,$t=a;Ut<$t.length;Ut+=1){var qt=$t[Ut],ie=qt.feature,de=qt.id,ge=qt.index,we=qt.sourceLayerIndex,De=b._featureFilter.needGeometry,Ke=Uo(ie,De);if(b._featureFilter.filter(kt,Ke,f)){De||(Ke.geometry=vo(ie));var or=void 0;if(Q){var Hr=b.getValueAndResolveTokens("text-field",Ke,f,Tt),vr=ns.factory(Hr);sft(vr)&&(this.hasRTLText=!0),(!this.hasRTLText||SA()==="unavailable"||this.hasRTLText&&_c.isParsed())&&(or=Nht(vr,b,Ke))}var Zr=void 0;if(rt){var Tr=b.getValueAndResolveTokens("icon-image",Ke,f,Tt);Zr=Tr instanceof ks?Tr:ks.fromString(Tr)}if(or||Zr){var Ln=this.sortFeaturesByKey?st.evaluate(Ke,{},f):void 0;if(this.features.push({id:de,text:or,icon:Zr,index:ge,sourceLayerIndex:we,geometry:Ke.geometry,properties:ie.properties,type:ift[ie.type],sortKey:Ln}),Zr&&(lt[Zr.name]=!0),or){var un=I.evaluate(Ke,{},f).join(","),Fr=S.get("text-rotation-alignment")==="map"&&S.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Rl.vertical)>=0;for(var Wn=0,En=or.sections;Wn<En.length;Wn+=1){var si=En[Wn];if(si.image)lt[si.image.name]=!0;else{var Qr=Vd(or.toString()),bi=si.fontStack||un,To=yt[bi]=yt[bi]||{};this.calculateGlyphDependencies(si.text,To,Fr,this.allowVerticalPlacement,Qr)}}}}}}S.get("symbol-placement")==="line"&&(this.features=function(Xo){var jo={},Eo={},Yo=[],js=0;function Hs(mo){Yo.push(Xo[mo]),js++}function Qa(mo,xs,Da){var wi=Eo[mo];return delete Eo[mo],Eo[xs]=wi,Yo[wi].geometry[0].pop(),Yo[wi].geometry[0]=Yo[wi].geometry[0].concat(Da[0]),wi}function ea(mo,xs,Da){var wi=jo[xs];return delete jo[xs],jo[mo]=wi,Yo[wi].geometry[0].shift(),Yo[wi].geometry[0]=Da[0].concat(Yo[wi].geometry[0]),wi}function Ja(mo,xs,Da){var wi=Da?xs[0][xs[0].length-1]:xs[0][0];return mo+":"+wi.x+":"+wi.y}for(var ss=0;ss<Xo.length;ss++){var ra=Xo[ss],Jn=ra.geometry,$i=ra.text?ra.text.toString():null;if($i){var zi=Ja($i,Jn),hi=Ja($i,Jn,!0);if(zi in Eo&&hi in jo&&Eo[zi]!==jo[hi]){var bc=ea(zi,hi,Jn),Ba=Qa(zi,hi,Yo[bc].geometry);delete jo[zi],delete Eo[hi],Eo[Ja($i,Yo[Ba].geometry,!0)]=Ba,Yo[bc].geometry=null}else zi in Eo?Qa(zi,hi,Jn):hi in jo?ea(zi,hi,Jn):(Hs(ss),jo[zi]=js-1,Eo[hi]=js-1)}else Hs(ss)}return Yo.filter(function(mo){return mo.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Xo,jo){return Xo.sortKey-jo.sortKey})}},Wi.prototype.update=function(a,u,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,u,this.layers,f),this.icon.programConfigurations.updatePaintArrays(a,u,this.layers,f))},Wi.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Wi.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Wi.prototype.upload=function(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Wi.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Wi.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Wi.prototype.addToLineVertexArray=function(a,u){var f=this.lineVertexArray.length;if(a.segment!==void 0){for(var b=a.dist(u[a.segment+1]),S=a.dist(u[a.segment]),I={},N=a.segment+1;N<u.length;N++)I[N]={x:u[N].x,y:u[N].y,tileUnitDistanceFromAnchor:b},N<u.length-1&&(b+=u[N+1].dist(u[N]));for(var H=a.segment||0;H>=0;H--)I[H]={x:u[H].x,y:u[H].y,tileUnitDistanceFromAnchor:S},H>0&&(S+=u[H-1].dist(u[H]));for(var Q=0;Q<u.length;Q++){var rt=I[Q];this.lineVertexArray.emplaceBack(rt.x,rt.y,rt.tileUnitDistanceFromAnchor)}}return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}},Wi.prototype.addSymbols=function(a,u,f,b,S,I,N,H,Q,rt,st,lt){for(var yt=a.indexArray,Tt=a.layoutVertexArray,kt=a.segments.prepareSegment(4*u.length,Tt,yt,this.canOverlap?I.sortKey:void 0),Ut=this.glyphOffsetArray.length,$t=kt.vertexLength,qt=this.allowVerticalPlacement&&N===Rl.vertical?Math.PI/2:0,ie=I.text&&I.text.sections,de=0;de<u.length;de++){var ge=u[de],we=ge.tl,De=ge.tr,Ke=ge.bl,or=ge.br,Hr=ge.tex,vr=ge.pixelOffsetTL,Zr=ge.pixelOffsetBR,Tr=ge.minFontScaleX,Ln=ge.minFontScaleY,un=ge.glyphOffset,Fr=ge.isSDF,Wn=ge.sectionIndex,En=kt.vertexLength,si=un[1];QT(Tt,H.x,H.y,we.x,si+we.y,Hr.x,Hr.y,f,Fr,vr.x,vr.y,Tr,Ln),QT(Tt,H.x,H.y,De.x,si+De.y,Hr.x+Hr.w,Hr.y,f,Fr,Zr.x,vr.y,Tr,Ln),QT(Tt,H.x,H.y,Ke.x,si+Ke.y,Hr.x,Hr.y+Hr.h,f,Fr,vr.x,Zr.y,Tr,Ln),QT(Tt,H.x,H.y,or.x,si+or.y,Hr.x+Hr.w,Hr.y+Hr.h,f,Fr,Zr.x,Zr.y,Tr,Ln),sL(a.dynamicLayoutVertexArray,H,qt),yt.emplaceBack(En,En+1,En+2),yt.emplaceBack(En+1,En+2,En+3),kt.vertexLength+=4,kt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(un[0]),de!==u.length-1&&Wn===u[de+1].sectionIndex||a.programConfigurations.populatePaintArrays(Tt.length,I,I.index,{},lt,ie&&ie[Wn])}a.placedSymbolArray.emplaceBack(H.x,H.y,Ut,this.glyphOffsetArray.length-Ut,$t,Q,rt,H.segment,f?f[0]:0,f?f[1]:0,b[0],b[1],N,0,!1,0,st)},Wi.prototype._addCollisionDebugVertex=function(a,u,f,b,S,I){return u.emplaceBack(0,0),a.emplaceBack(f.x,f.y,b,S,Math.round(I.x),Math.round(I.y))},Wi.prototype.addCollisionDebugVertices=function(a,u,f,b,S,I,N){var H=S.segments.prepareSegment(4,S.layoutVertexArray,S.indexArray),Q=H.vertexLength,rt=S.layoutVertexArray,st=S.collisionVertexArray,lt=N.anchorX,yt=N.anchorY;this._addCollisionDebugVertex(rt,st,I,lt,yt,new l(a,u)),this._addCollisionDebugVertex(rt,st,I,lt,yt,new l(f,u)),this._addCollisionDebugVertex(rt,st,I,lt,yt,new l(f,b)),this._addCollisionDebugVertex(rt,st,I,lt,yt,new l(a,b)),H.vertexLength+=4;var Tt=S.indexArray;Tt.emplaceBack(Q,Q+1),Tt.emplaceBack(Q+1,Q+2),Tt.emplaceBack(Q+2,Q+3),Tt.emplaceBack(Q+3,Q),H.primitiveLength+=4},Wi.prototype.addDebugCollisionBoxes=function(a,u,f,b){for(var S=a;S<u;S++){var I=this.collisionBoxArray.get(S);this.addCollisionDebugVertices(I.x1,I.y1,I.x2,I.y2,b?this.textCollisionBox:this.iconCollisionBox,I.anchorPoint,f)}},Wi.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new kx(df,X8.members,yh),this.iconCollisionBox=new kx(df,X8.members,yh);for(var a=0;a<this.symbolInstances.length;a++){var u=this.symbolInstances.get(a);this.addDebugCollisionBoxes(u.textBoxStartIndex,u.textBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.iconBoxStartIndex,u.iconBoxEndIndex,u,!1),this.addDebugCollisionBoxes(u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex,u,!1)}},Wi.prototype._deserializeCollisionBoxesForSymbol=function(a,u,f,b,S,I,N,H,Q){for(var rt={},st=u;st<f;st++){var lt=a.get(st);rt.textBox={x1:lt.x1,y1:lt.y1,x2:lt.x2,y2:lt.y2,anchorPointX:lt.anchorPointX,anchorPointY:lt.anchorPointY},rt.textFeatureIndex=lt.featureIndex;break}for(var yt=b;yt<S;yt++){var Tt=a.get(yt);rt.verticalTextBox={x1:Tt.x1,y1:Tt.y1,x2:Tt.x2,y2:Tt.y2,anchorPointX:Tt.anchorPointX,anchorPointY:Tt.anchorPointY},rt.verticalTextFeatureIndex=Tt.featureIndex;break}for(var kt=I;kt<N;kt++){var Ut=a.get(kt);rt.iconBox={x1:Ut.x1,y1:Ut.y1,x2:Ut.x2,y2:Ut.y2,anchorPointX:Ut.anchorPointX,anchorPointY:Ut.anchorPointY},rt.iconFeatureIndex=Ut.featureIndex;break}for(var $t=H;$t<Q;$t++){var qt=a.get($t);rt.verticalIconBox={x1:qt.x1,y1:qt.y1,x2:qt.x2,y2:qt.y2,anchorPointX:qt.anchorPointX,anchorPointY:qt.anchorPointY},rt.verticalIconFeatureIndex=qt.featureIndex;break}return rt},Wi.prototype.deserializeCollisionBoxes=function(a){this.collisionArrays=[];for(var u=0;u<this.symbolInstances.length;u++){var f=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}},Wi.prototype.hasTextData=function(){return this.text.segments.get().length>0},Wi.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Wi.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Wi.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Wi.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Wi.prototype.addIndicesForPlacedSymbol=function(a,u){for(var f=a.placedSymbolArray.get(u),b=f.vertexStartIndex+4*f.numGlyphs,S=f.vertexStartIndex;S<b;S+=4)a.indexArray.emplaceBack(S,S+1,S+2),a.indexArray.emplaceBack(S+1,S+2,S+3)},Wi.prototype.getSortedSymbolIndexes=function(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var u=Math.sin(a),f=Math.cos(a),b=[],S=[],I=[],N=0;N<this.symbolInstances.length;++N){I.push(N);var H=this.symbolInstances.get(N);b.push(0|Math.round(u*H.anchorX+f*H.anchorY)),S.push(H.featureIndex)}return I.sort(function(Q,rt){return b[Q]-b[rt]||S[rt]-S[Q]}),I},Wi.prototype.addToSortKeyRanges=function(a,u){var f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===u?f.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:a,symbolInstanceEnd:a+1})},Wi.prototype.sortFeatures=function(a){var u=this;if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var f=0,b=this.symbolInstanceIndexes;f<b.length;f+=1){var S=this.symbolInstances.get(b[f]);this.featureSortOrder.push(S.featureIndex),[S.rightJustifiedTextSymbolIndex,S.centerJustifiedTextSymbolIndex,S.leftJustifiedTextSymbolIndex].forEach(function(I,N,H){I>=0&&H.indexOf(I)===N&&u.addIndicesForPlacedSymbol(u.text,I)}),S.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,S.verticalPlacedTextSymbolIndex),S.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,S.placedIconSymbolIndex),S.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,S.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},_r("SymbolBucket",Wi,{omit:["layers","collisionBoxArray","features","compareText"]}),Wi.MAX_GLYPHS=65535,Wi.addDynamicAttributes=sL;var aft=new Ms({"symbol-placement":new Wr(St.layout_symbol["symbol-placement"]),"symbol-spacing":new Wr(St.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Wr(St.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Or(St.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Wr(St.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Wr(St.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Wr(St.layout_symbol["icon-ignore-placement"]),"icon-optional":new Wr(St.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Wr(St.layout_symbol["icon-rotation-alignment"]),"icon-size":new Or(St.layout_symbol["icon-size"]),"icon-text-fit":new Wr(St.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Wr(St.layout_symbol["icon-text-fit-padding"]),"icon-image":new Or(St.layout_symbol["icon-image"]),"icon-rotate":new Or(St.layout_symbol["icon-rotate"]),"icon-padding":new Wr(St.layout_symbol["icon-padding"]),"icon-keep-upright":new Wr(St.layout_symbol["icon-keep-upright"]),"icon-offset":new Or(St.layout_symbol["icon-offset"]),"icon-anchor":new Or(St.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Wr(St.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Wr(St.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Wr(St.layout_symbol["text-rotation-alignment"]),"text-field":new Or(St.layout_symbol["text-field"]),"text-font":new Or(St.layout_symbol["text-font"]),"text-size":new Or(St.layout_symbol["text-size"]),"text-max-width":new Or(St.layout_symbol["text-max-width"]),"text-line-height":new Wr(St.layout_symbol["text-line-height"]),"text-letter-spacing":new Or(St.layout_symbol["text-letter-spacing"]),"text-justify":new Or(St.layout_symbol["text-justify"]),"text-radial-offset":new Or(St.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Wr(St.layout_symbol["text-variable-anchor"]),"text-anchor":new Or(St.layout_symbol["text-anchor"]),"text-max-angle":new Wr(St.layout_symbol["text-max-angle"]),"text-writing-mode":new Wr(St.layout_symbol["text-writing-mode"]),"text-rotate":new Or(St.layout_symbol["text-rotate"]),"text-padding":new Wr(St.layout_symbol["text-padding"]),"text-keep-upright":new Wr(St.layout_symbol["text-keep-upright"]),"text-transform":new Or(St.layout_symbol["text-transform"]),"text-offset":new Or(St.layout_symbol["text-offset"]),"text-allow-overlap":new Wr(St.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Wr(St.layout_symbol["text-ignore-placement"]),"text-optional":new Wr(St.layout_symbol["text-optional"])}),aL={paint:new Ms({"icon-opacity":new Or(St.paint_symbol["icon-opacity"]),"icon-color":new Or(St.paint_symbol["icon-color"]),"icon-halo-color":new Or(St.paint_symbol["icon-halo-color"]),"icon-halo-width":new Or(St.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Or(St.paint_symbol["icon-halo-blur"]),"icon-translate":new Wr(St.paint_symbol["icon-translate"]),"icon-translate-anchor":new Wr(St.paint_symbol["icon-translate-anchor"]),"text-opacity":new Or(St.paint_symbol["text-opacity"]),"text-color":new Or(St.paint_symbol["text-color"],{runtimeType:cr,getOverride:function(a){return a.textColor},hasOverride:function(a){return!!a.textColor}}),"text-halo-color":new Or(St.paint_symbol["text-halo-color"]),"text-halo-width":new Or(St.paint_symbol["text-halo-width"]),"text-halo-blur":new Or(St.paint_symbol["text-halo-blur"]),"text-translate":new Wr(St.paint_symbol["text-translate"]),"text-translate-anchor":new Wr(St.paint_symbol["text-translate-anchor"])}),layout:aft},Yg=function(a){this.type=a.property.overrides?a.property.overrides.runtimeType:Cr,this.defaultValue=a};Yg.prototype.evaluate=function(a){if(a.formattedSection){var u=this.defaultValue.property.overrides;if(u&&u.hasOverride(a.formattedSection))return u.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default},Yg.prototype.eachChild=function(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)},Yg.prototype.outputDefined=function(){return!1},Yg.prototype.serialize=function(){return null},_r("FormatSectionOverride",Yg,{omit:["defaultValue"]});var cft=function(a){function u(f){a.call(this,f,aL)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.recalculate=function(f,b){if(a.prototype.recalculate.call(this,f,b),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var S=this.layout.get("text-writing-mode");if(S){for(var I=[],N=0,H=S;N<H.length;N+=1){var Q=H[N];I.indexOf(Q)<0&&I.push(Q)}this.layout._values["text-writing-mode"]=I}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},u.prototype.getValueAndResolveTokens=function(f,b,S,I){var N=this.layout.get(f).evaluate(b,{},S,I),H=this._unevaluatedLayout._values[f];return H.isDataDriven()||ma(H.value)||!N?N:function(Q,rt){return rt.replace(/{([^{}]+)}/g,function(st,lt){return lt in Q?String(Q[lt]):""})}(b.properties,N)},u.prototype.createBucket=function(f){return new Wi(f)},u.prototype.queryRadius=function(){return 0},u.prototype.queryIntersectsFeature=function(){return!1},u.prototype._setPaintOverrides=function(){for(var f=0,b=aL.paint.overridableProperties;f<b.length;f+=1){var S=b[f];if(u.hasPaintOverride(this.layout,S)){var I,N=this.paint.get(S),H=new Yg(N),Q=new Ai(H,N.property.specification);I=N.value.kind==="constant"||N.value.kind==="source"?new Bt("source",Q):new dn("composite",Q,N.value.zoomStops,N.value._interpolationType),this.paint._values[S]=new Es(N.property,I,N.parameters)}}},u.prototype._handleOverridablePaintPropertyUpdate=function(f,b,S){return!(!this.layout||b.isDataDriven()||S.isDataDriven())&&u.hasPaintOverride(this.layout,f)},u.hasPaintOverride=function(f,b){var S=f.get("text-field"),I=aL.paint.properties[b],N=!1,H=function(st){for(var lt=0,yt=st;lt<yt.length;lt+=1)if(I.overrides&&I.overrides.hasOverride(yt[lt]))return void(N=!0)};if(S.value.kind==="constant"&&S.value.value instanceof ns)H(S.value.value.sections);else if(S.value.kind==="source"){var Q=function(st){N||(st instanceof Zs&&Xi(st.value)===Ci?H(st.value.sections):st instanceof Ca?H(st.sections):st.eachChild(Q))},rt=S.value;rt._styleExpression&&Q(rt._styleExpression.expression)}return N},u}(Ra),lft={paint:new Ms({"background-color":new Wr(St.paint_background["background-color"]),"background-pattern":new Aa(St.paint_background["background-pattern"]),"background-opacity":new Wr(St.paint_background["background-opacity"])})},uft=function(a){function u(f){a.call(this,f,lft)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u}(Ra),hft={paint:new Ms({"raster-opacity":new Wr(St.paint_raster["raster-opacity"]),"raster-hue-rotate":new Wr(St.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Wr(St.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Wr(St.paint_raster["raster-brightness-max"]),"raster-saturation":new Wr(St.paint_raster["raster-saturation"]),"raster-contrast":new Wr(St.paint_raster["raster-contrast"]),"raster-resampling":new Wr(St.paint_raster["raster-resampling"]),"raster-fade-duration":new Wr(St.paint_raster["raster-fade-duration"])})},fft=function(a){function u(f){a.call(this,f,hft)}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u}(Ra),pft=function(a){function u(f){a.call(this,f,{}),this.implementation=f}return a&&(u.__proto__=a),(u.prototype=Object.create(a&&a.prototype)).constructor=u,u.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},u.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},u.prototype.recalculate=function(){},u.prototype.updateTransitions=function(){},u.prototype.hasTransition=function(){},u.prototype.serialize=function(){},u.prototype.onAdd=function(f){this.implementation.onAdd&&this.implementation.onAdd(f,f.painter.context.gl)},u.prototype.onRemove=function(f){this.implementation.onRemove&&this.implementation.onRemove(f,f.painter.context.gl)},u}(Ra),dft={circle:Cx,heatmap:UT,hillshade:Ep,fill:Zi,"fill-extrusion":Eht,line:Rht,symbol:cft,background:uft,raster:fft},AU=p.HTMLImageElement,gU=p.HTMLCanvasElement,_U=p.HTMLVideoElement,yU=p.ImageData,JT=p.ImageBitmap,RA=function(a,u,f,b){this.context=a,this.format=f,this.texture=a.gl.createTexture(),this.update(u,b)};RA.prototype.update=function(a,u,f){var b=a.width,S=a.height,I=!(this.size&&this.size[0]===b&&this.size[1]===S||f),N=this.context,H=N.gl;if(this.useMipmap=Boolean(u&&u.useMipmap),H.bindTexture(H.TEXTURE_2D,this.texture),N.pixelStoreUnpackFlipY.set(!1),N.pixelStoreUnpack.set(1),N.pixelStoreUnpackPremultiplyAlpha.set(this.format===H.RGBA&&(!u||u.premultiply!==!1)),I)this.size=[b,S],a instanceof AU||a instanceof gU||a instanceof _U||a instanceof yU||JT&&a instanceof JT?H.texImage2D(H.TEXTURE_2D,0,this.format,this.format,H.UNSIGNED_BYTE,a):H.texImage2D(H.TEXTURE_2D,0,this.format,b,S,0,this.format,H.UNSIGNED_BYTE,a.data);else{var Q=f||{x:0,y:0},rt=Q.x,st=Q.y;a instanceof AU||a instanceof gU||a instanceof _U||a instanceof yU||JT&&a instanceof JT?H.texSubImage2D(H.TEXTURE_2D,0,rt,st,H.RGBA,H.UNSIGNED_BYTE,a):H.texSubImage2D(H.TEXTURE_2D,0,rt,st,b,S,H.RGBA,H.UNSIGNED_BYTE,a.data)}this.useMipmap&&this.isSizePowerOfTwo()&&H.generateMipmap(H.TEXTURE_2D)},RA.prototype.bind=function(a,u,f){var b=this.context.gl;b.bindTexture(b.TEXTURE_2D,this.texture),f!==b.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=b.LINEAR),a!==this.filter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,a),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,f||a),this.filter=a),u!==this.wrap&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,u),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,u),this.wrap=u)},RA.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},RA.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var cL=function(a){var u=this;this._callback=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){u._triggered=!1,u._callback()})};cL.prototype.trigger=function(){var a=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){a._triggered=!1,a._callback()},0))},cL.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Kg=function(a,u,f){this.target=a,this.parent=u,this.mapId=f,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},et(["receive","process"],this),this.invoker=new cL(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=gt()?a:p};function xU(a,u,f){var b=2*Math.PI*6378137/256/Math.pow(2,f);return[a*b-2*Math.PI*6378137/2,u*b-2*Math.PI*6378137/2]}Kg.prototype.send=function(a,u,f,b,S){var I=this;S===void 0&&(S=!1);var N=Math.round(1e18*Math.random()).toString(36).substring(0,10);f&&(this.callbacks[N]=f);var H=Ue(this.globalScope)?void 0:[];return this.target.postMessage({id:N,type:a,hasCallback:!!f,targetMapId:b,mustQueue:S,sourceMapId:this.mapId,data:Ga(u,H)},H),{cancel:function(){f&&delete I.callbacks[N],I.target.postMessage({id:N,type:"<cancel>",targetMapId:b,sourceMapId:I.mapId})}}},Kg.prototype.receive=function(a){var u=a.data,f=u.id;if(f&&(!u.targetMapId||this.mapId===u.targetMapId))if(u.type==="<cancel>"){delete this.tasks[f];var b=this.cancelCallbacks[f];delete this.cancelCallbacks[f],b&&b()}else gt()||u.mustQueue?(this.tasks[f]=u,this.taskQueue.push(f),this.invoker.trigger()):this.processTask(f,u)},Kg.prototype.process=function(){if(this.taskQueue.length){var a=this.taskQueue.shift(),u=this.tasks[a];delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),u&&this.processTask(a,u)}},Kg.prototype.processTask=function(a,u){var f=this;if(u.type==="<response>"){var b=this.callbacks[a];delete this.callbacks[a],b&&(u.error?b(Xa(u.error)):b(null,Xa(u.data)))}else{var S=!1,I=Ue(this.globalScope)?void 0:[],N=u.hasCallback?function(st,lt){S=!0,delete f.cancelCallbacks[a],f.target.postMessage({id:a,type:"<response>",sourceMapId:f.mapId,error:st?Ga(st):null,data:Ga(lt,I)},I)}:function(st){S=!0},H=null,Q=Xa(u.data);if(this.parent[u.type])H=this.parent[u.type](u.sourceMapId,Q,N);else if(this.parent.getWorkerSource){var rt=u.type.split(".");H=this.parent.getWorkerSource(u.sourceMapId,rt[0],Q.source)[rt[1]](Q,N)}else N(new Error("Could not find function "+u.type));!S&&H&&H.cancel&&(this.cancelCallbacks[a]=H.cancel)}},Kg.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Cs=function(a,u){a&&(u?this.setSouthWest(a).setNorthEast(u):a.length===4?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))};Cs.prototype.setNorthEast=function(a){return this._ne=a instanceof wo?new wo(a.lng,a.lat):wo.convert(a),this},Cs.prototype.setSouthWest=function(a){return this._sw=a instanceof wo?new wo(a.lng,a.lat):wo.convert(a),this},Cs.prototype.extend=function(a){var u,f,b=this._sw,S=this._ne;if(a instanceof wo)u=a,f=a;else{if(!(a instanceof Cs))return Array.isArray(a)?a.length===4||a.every(Array.isArray)?this.extend(Cs.convert(a)):this.extend(wo.convert(a)):this;if(f=a._ne,!(u=a._sw)||!f)return this}return b||S?(b.lng=Math.min(u.lng,b.lng),b.lat=Math.min(u.lat,b.lat),S.lng=Math.max(f.lng,S.lng),S.lat=Math.max(f.lat,S.lat)):(this._sw=new wo(u.lng,u.lat),this._ne=new wo(f.lng,f.lat)),this},Cs.prototype.getCenter=function(){return new wo((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Cs.prototype.getSouthWest=function(){return this._sw},Cs.prototype.getNorthEast=function(){return this._ne},Cs.prototype.getNorthWest=function(){return new wo(this.getWest(),this.getNorth())},Cs.prototype.getSouthEast=function(){return new wo(this.getEast(),this.getSouth())},Cs.prototype.getWest=function(){return this._sw.lng},Cs.prototype.getSouth=function(){return this._sw.lat},Cs.prototype.getEast=function(){return this._ne.lng},Cs.prototype.getNorth=function(){return this._ne.lat},Cs.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Cs.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Cs.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Cs.prototype.contains=function(a){var u=wo.convert(a),f=u.lng,b=u.lat,S=this._sw.lng<=f&&f<=this._ne.lng;return this._sw.lng>this._ne.lng&&(S=this._sw.lng>=f&&f>=this._ne.lng),this._sw.lat<=b&&b<=this._ne.lat&&S},Cs.convert=function(a){return!a||a instanceof Cs?a:new Cs(a)};var wo=function(a,u){if(isNaN(a)||isNaN(u))throw new Error("Invalid LngLat object: ("+a+", "+u+")");if(this.lng=+a,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};wo.prototype.wrap=function(){return new wo(B(this.lng,-180,180),this.lat)},wo.prototype.toArray=function(){return[this.lng,this.lat]},wo.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},wo.prototype.distanceTo=function(a){var u=Math.PI/180,f=this.lat*u,b=a.lat*u,S=Math.sin(f)*Math.sin(b)+Math.cos(f)*Math.cos(b)*Math.cos((a.lng-this.lng)*u);return 63710088e-1*Math.acos(Math.min(S,1))},wo.prototype.toBounds=function(a){a===void 0&&(a=0);var u=360*a/40075017,f=u/Math.cos(Math.PI/180*this.lat);return new Cs(new wo(this.lng-f,this.lat-u),new wo(this.lng+f,this.lat+u))},wo.convert=function(a){if(a instanceof wo)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new wo(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new wo(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var vU=2*Math.PI*63710088e-1;function bU(a){return vU*Math.cos(a*Math.PI/180)}function wU(a){return(180+a)/360}function TU(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function EU(a,u){return a/bU(u)}function lL(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}var LA=function(a,u,f){f===void 0&&(f=0),this.x=+a,this.y=+u,this.z=+f};LA.fromLngLat=function(a,u){u===void 0&&(u=0);var f=wo.convert(a);return new LA(wU(f.lng),TU(f.lat),EU(u,f.lat))},LA.prototype.toLngLat=function(){return new wo(360*this.x-180,lL(this.y))},LA.prototype.toAltitude=function(){return this.z*bU(lL(this.y))},LA.prototype.meterInMercatorCoordinateUnits=function(){return 1/vU*(a=lL(this.y),1/Math.cos(a*Math.PI/180));var a};var OA=function(a,u,f){this.z=a,this.x=u,this.y=f,this.key=Fx(0,a,a,u,f)};OA.prototype.equals=function(a){return this.z===a.z&&this.x===a.x&&this.y===a.y},OA.prototype.url=function(a,u){var f,b,S,I,N,H=(b=this.y,S=this.z,I=xU(256*(f=this.x),256*(b=Math.pow(2,S)-b-1),S),N=xU(256*(f+1),256*(b+1),S),I[0]+","+I[1]+","+N[0]+","+N[1]),Q=function(rt,st,lt){for(var yt,Tt="",kt=rt;kt>0;kt--)Tt+=(st&(yt=1<<kt-1)?1:0)+(lt&yt?2:0);return Tt}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",Q).replace("{bbox-epsg-3857}",H)},OA.prototype.getTilePoint=function(a){var u=Math.pow(2,this.z);return new l(8192*(a.x*u-this.x),8192*(a.y*u-this.y))},OA.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var MU=function(a,u){this.wrap=a,this.canonical=u,this.key=Fx(a,u.z,u.z,u.x,u.y)},Ps=function(a,u,f,b,S){this.overscaledZ=a,this.wrap=u,this.canonical=new OA(f,+b,+S),this.key=Fx(u,a,f,b,S)};function Fx(a,u,f,b,S){(a*=2)<0&&(a=-1*a-1);var I=1<<f;return(I*I*a+I*S+b).toString(36)+f.toString(36)+u.toString(36)}Ps.prototype.equals=function(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)},Ps.prototype.scaledTo=function(a){var u=this.canonical.z-a;return a>this.canonical.z?new Ps(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ps(a,this.wrap,a,this.canonical.x>>u,this.canonical.y>>u)},Ps.prototype.calculateScaledKey=function(a,u){var f=this.canonical.z-a;return a>this.canonical.z?Fx(this.wrap*+u,a,this.canonical.z,this.canonical.x,this.canonical.y):Fx(this.wrap*+u,a,a,this.canonical.x>>f,this.canonical.y>>f)},Ps.prototype.isChildOf=function(a){if(a.wrap!==this.wrap)return!1;var u=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>u&&a.canonical.y===this.canonical.y>>u},Ps.prototype.children=function(a){if(this.overscaledZ>=a)return[new Ps(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var u=this.canonical.z+1,f=2*this.canonical.x,b=2*this.canonical.y;return[new Ps(u,this.wrap,u,f,b),new Ps(u,this.wrap,u,f+1,b),new Ps(u,this.wrap,u,f,b+1),new Ps(u,this.wrap,u,f+1,b+1)]},Ps.prototype.isLessThan=function(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))},Ps.prototype.wrapped=function(){return new Ps(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Ps.prototype.unwrapTo=function(a){return new Ps(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)},Ps.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Ps.prototype.toUnwrapped=function(){return new MU(this.wrap,this.canonical)},Ps.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Ps.prototype.getTilePoint=function(a){return this.canonical.getTilePoint(new LA(a.x-this.wrap,a.y))},_r("CanonicalTileID",OA),_r("OverscaledTileID",Ps,{omit:["posMatrix"]});var Pp=function(a,u,f){if(this.uid=a,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(f&&f!=="mapbox"&&f!=="terrarium")return mt('"'+f+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=u.height;var b=this.dim=u.height-2;this.data=new Uint32Array(u.data.buffer),this.encoding=f||"mapbox";for(var S=0;S<b;S++)this.data[this._idx(-1,S)]=this.data[this._idx(0,S)],this.data[this._idx(b,S)]=this.data[this._idx(b-1,S)],this.data[this._idx(S,-1)]=this.data[this._idx(S,0)],this.data[this._idx(S,b)]=this.data[this._idx(S,b-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(b,-1)]=this.data[this._idx(b-1,0)],this.data[this._idx(-1,b)]=this.data[this._idx(0,b-1)],this.data[this._idx(b,b)]=this.data[this._idx(b-1,b-1)]};Pp.prototype.get=function(a,u){var f=new Uint8Array(this.data.buffer),b=4*this._idx(a,u);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(f[b],f[b+1],f[b+2])},Pp.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Pp.prototype._idx=function(a,u){if(a<-1||a>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(a+1)},Pp.prototype._unpackMapbox=function(a,u,f){return(256*a*256+256*u+f)/10-1e4},Pp.prototype._unpackTerrarium=function(a,u,f){return 256*a+u+f/256-32768},Pp.prototype.getPixels=function(){return new Vo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Pp.prototype.backfillBorder=function(a,u,f){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");var b=u*this.dim,S=u*this.dim+this.dim,I=f*this.dim,N=f*this.dim+this.dim;switch(u){case-1:b=S-1;break;case 1:S=b+1}switch(f){case-1:I=N-1;break;case 1:N=I+1}for(var H=-u*this.dim,Q=-f*this.dim,rt=I;rt<N;rt++)for(var st=b;st<S;st++)this.data[this._idx(st,rt)]=a.data[this._idx(st+H,rt+Q)]},_r("DEMData",Pp);var tE=function(a){this._stringToNumber={},this._numberToString=[];for(var u=0;u<a.length;u++){var f=a[u];this._stringToNumber[f]=u,this._numberToString[u]=f}};tE.prototype.encode=function(a){return this._stringToNumber[a]},tE.prototype.decode=function(a){return this._numberToString[a]};var eE=function(a,u,f,b,S){this.type="Feature",this._vectorTileFeature=a,a._z=u,a._x=f,a._y=b,this.properties=a.properties,this.id=S},uL={geometry:{configurable:!0}};uL.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},uL.geometry.set=function(a){this._geometry=a},eE.prototype.toJSON=function(){var a={geometry:this.geometry};for(var u in this)u!=="_geometry"&&u!=="_vectorTileFeature"&&(a[u]=this[u]);return a},Object.defineProperties(eE.prototype,uL);var Zg=function(){this.state={},this.stateChanges={},this.deletedStates={}};Zg.prototype.updateState=function(a,u,f){var b=String(u);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][b]=this.stateChanges[a][b]||{},D(this.stateChanges[a][b],f),this.deletedStates[a]===null)for(var S in this.deletedStates[a]={},this.state[a])S!==b&&(this.deletedStates[a][S]=null);else if(this.deletedStates[a]&&this.deletedStates[a][b]===null)for(var I in this.deletedStates[a][b]={},this.state[a][b])f[I]||(this.deletedStates[a][b][I]=null);else for(var N in f)this.deletedStates[a]&&this.deletedStates[a][b]&&this.deletedStates[a][b][N]===null&&delete this.deletedStates[a][b][N]},Zg.prototype.removeFeatureState=function(a,u,f){if(this.deletedStates[a]!==null){var b=String(u);if(this.deletedStates[a]=this.deletedStates[a]||{},f&&u!==void 0)this.deletedStates[a][b]!==null&&(this.deletedStates[a][b]=this.deletedStates[a][b]||{},this.deletedStates[a][b][f]=null);else if(u!==void 0)if(this.stateChanges[a]&&this.stateChanges[a][b])for(f in this.deletedStates[a][b]={},this.stateChanges[a][b])this.deletedStates[a][b][f]=null;else this.deletedStates[a][b]=null;else this.deletedStates[a]=null}},Zg.prototype.getState=function(a,u){var f=String(u),b=D({},(this.state[a]||{})[f],(this.stateChanges[a]||{})[f]);if(this.deletedStates[a]===null)return{};if(this.deletedStates[a]){var S=this.deletedStates[a][u];if(S===null)return{};for(var I in S)delete b[I]}return b},Zg.prototype.initializeTileState=function(a,u){a.setFeatureState(this.state,u)},Zg.prototype.coalesceChanges=function(a,u){var f={};for(var b in this.stateChanges){this.state[b]=this.state[b]||{};var S={};for(var I in this.stateChanges[b])this.state[b][I]||(this.state[b][I]={}),D(this.state[b][I],this.stateChanges[b][I]),S[I]=this.state[b][I];f[b]=S}for(var N in this.deletedStates){this.state[N]=this.state[N]||{};var H={};if(this.deletedStates[N]===null)for(var Q in this.state[N])H[Q]={},this.state[N][Q]={};else for(var rt in this.deletedStates[N]){if(this.deletedStates[N][rt]===null)this.state[N][rt]={};else for(var st=0,lt=Object.keys(this.deletedStates[N][rt]);st<lt.length;st+=1)delete this.state[N][rt][lt[st]];H[rt]=this.state[N][rt]}f[N]=f[N]||{},D(f[N],H)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(var yt in a)a[yt].setFeatureState(f,u)};var Ip=function(a,u){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new po(8192,16,0),this.grid3D=new po(8192,16,0),this.featureIndexArray=new pt,this.promoteId=u};function SU(a,u,f,b,S){return ut(a,function(I,N){var H=u instanceof _p?u.get(N):null;return H&&H.evaluate?H.evaluate(f,b,S):H})}function CU(a){for(var u=1/0,f=1/0,b=-1/0,S=-1/0,I=0,N=a;I<N.length;I+=1){var H=N[I];u=Math.min(u,H.x),f=Math.min(f,H.y),b=Math.max(b,H.x),S=Math.max(S,H.y)}return{minX:u,minY:f,maxX:b,maxY:S}}function mft(a,u){return u-a}Ip.prototype.insert=function(a,u,f,b,S,I){var N=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,b,S);for(var H=I?this.grid3D:this.grid,Q=0;Q<u.length;Q++){for(var rt=u[Q],st=[1/0,1/0,-1/0,-1/0],lt=0;lt<rt.length;lt++){var yt=rt[lt];st[0]=Math.min(st[0],yt.x),st[1]=Math.min(st[1],yt.y),st[2]=Math.max(st[2],yt.x),st[3]=Math.max(st[3],yt.y)}st[0]<8192&&st[1]<8192&&st[2]>=0&&st[3]>=0&&H.insert(N,st[0],st[1],st[2],st[3])}},Ip.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Sp.VectorTile(new HT(this.rawTileData)).layers,this.sourceLayerCoder=new tE(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Ip.prototype.query=function(a,u,f,b){var S=this;this.loadVTLayers();for(var I=a.params||{},N=8192/a.tileSize/a.scale,H=cf(I.filter),Q=a.queryGeometry,rt=a.queryPadding*N,st=CU(Q),lt=this.grid.query(st.minX-rt,st.minY-rt,st.maxX+rt,st.maxY+rt),yt=CU(a.cameraQueryGeometry),Tt=this.grid3D.query(yt.minX-rt,yt.minY-rt,yt.maxX+rt,yt.maxY+rt,function(ge,we,De,Ke){return function(or,Hr,vr,Zr,Tr){for(var Ln=0,un=or;Ln<un.length;Ln+=1){var Fr=un[Ln];if(Hr<=Fr.x&&vr<=Fr.y&&Zr>=Fr.x&&Tr>=Fr.y)return!0}var Wn=[new l(Hr,vr),new l(Hr,Tr),new l(Zr,Tr),new l(Zr,vr)];if(or.length>2){for(var En=0,si=Wn;En<si.length;En+=1)if(Ki(or,si[En]))return!0}for(var Qr=0;Qr<or.length-1;Qr++)if(wp(or[Qr],or[Qr+1],Wn))return!0;return!1}(a.cameraQueryGeometry,ge-rt,we-rt,De+rt,Ke+rt)}),kt=0,Ut=Tt;kt<Ut.length;kt+=1)lt.push(Ut[kt]);lt.sort(mft);for(var $t,qt={},ie=function(ge){var we=lt[ge];if(we!==$t){$t=we;var De=S.featureIndexArray.get(we),Ke=null;S.loadMatchingFeature(qt,De.bucketIndex,De.sourceLayerIndex,De.featureIndex,H,I.layers,I.availableImages,u,f,b,function(or,Hr,vr){return Ke||(Ke=vo(or)),Hr.queryIntersectsFeature(Q,or,vr,Ke,S.z,a.transform,N,a.pixelPosMatrix)})}},de=0;de<lt.length;de++)ie(de);return qt},Ip.prototype.loadMatchingFeature=function(a,u,f,b,S,I,N,H,Q,rt,st){var lt=this.bucketLayerIDs[u];if(!I||function(or,Hr){for(var vr=0;vr<or.length;vr++)if(Hr.indexOf(or[vr])>=0)return!0;return!1}(I,lt)){var yt=this.sourceLayerCoder.decode(f),Tt=this.vtLayers[yt].feature(b);if(S.needGeometry){var kt=Uo(Tt,!0);if(!S.filter(new Un(this.tileID.overscaledZ),kt,this.tileID.canonical))return}else if(!S.filter(new Un(this.tileID.overscaledZ),Tt))return;for(var Ut=this.getId(Tt,yt),$t=0;$t<lt.length;$t++){var qt=lt[$t];if(!(I&&I.indexOf(qt)<0)){var ie=H[qt];if(ie){var de={};Ut!==void 0&&rt&&(de=rt.getState(ie.sourceLayer||"_geojsonTileLayer",Ut));var ge=D({},Q[qt]);ge.paint=SU(ge.paint,ie.paint,Tt,de,N),ge.layout=SU(ge.layout,ie.layout,Tt,de,N);var we=!st||st(Tt,ie,de);if(we){var De=new eE(Tt,this.z,this.x,this.y,Ut);De.layer=ge;var Ke=a[qt];Ke===void 0&&(Ke=a[qt]=[]),Ke.push({featureIndex:b,feature:De,intersectionZ:we})}}}}}},Ip.prototype.lookupSymbolFeatures=function(a,u,f,b,S,I,N,H){var Q={};this.loadVTLayers();for(var rt=cf(S),st=0,lt=a;st<lt.length;st+=1)this.loadMatchingFeature(Q,f,b,lt[st],rt,I,N,H,u);return Q},Ip.prototype.hasLayer=function(a){for(var u=0,f=this.bucketLayerIDs;u<f.length;u+=1)for(var b=0,S=f[u];b<S.length;b+=1)if(a===S[b])return!0;return!1},Ip.prototype.getId=function(a,u){var f=a.id;return this.promoteId&&typeof(f=a.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[u]])=="boolean"&&(f=Number(f)),f},_r("FeatureIndex",Ip,{omit:["rawTileData","sourceLayerCoder"]});var ta=function(a,u){this.tileID=a,this.uid=X(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};ta.prototype.registerFadeDuration=function(a){var u=a+this.timeAdded;u<dt.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)},ta.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},ta.prototype.loadVectorData=function(a,u,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",a){for(var b in a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(rt,st){var lt={};if(!st)return lt;for(var yt=function(){var Ut=kt[Tt],$t=Ut.layerIds.map(function(de){return st.getLayer(de)}).filter(Boolean);if($t.length!==0){Ut.layers=$t,Ut.stateDependentLayerIds&&(Ut.stateDependentLayers=Ut.stateDependentLayerIds.map(function(de){return $t.filter(function(ge){return ge.id===de})[0]}));for(var qt=0,ie=$t;qt<ie.length;qt+=1)lt[ie[qt].id]=Ut}},Tt=0,kt=rt;Tt<kt.length;Tt+=1)yt();return lt}(a.buckets,u.style),this.hasSymbolBuckets=!1,this.buckets){var S=this.buckets[b];if(S instanceof Wi){if(this.hasSymbolBuckets=!0,!f)break;S.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var I in this.buckets){var N=this.buckets[I];if(N instanceof Wi&&N.hasRTLText){this.hasRTLText=!0,_c.isLoading()||_c.isLoaded()||SA()!=="deferred"||Lc();break}}for(var H in this.queryPadding=0,this.buckets){var Q=this.buckets[H];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(H).queryRadius(Q))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage)}else this.collisionBoxArray=new y},ta.prototype.unloadVectorData=function(){for(var a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},ta.prototype.getBucket=function(a){return this.buckets[a.id]},ta.prototype.upload=function(a){for(var u in this.buckets){var f=this.buckets[u];f.uploadPending()&&f.upload(a)}var b=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new RA(a,this.imageAtlas.image,b.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new RA(a,this.glyphAtlasImage,b.ALPHA),this.glyphAtlasImage=null)},ta.prototype.prepare=function(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)},ta.prototype.queryRenderedFeatures=function(a,u,f,b,S,I,N,H,Q,rt){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:b,cameraQueryGeometry:S,scale:I,tileSize:this.tileSize,pixelPosMatrix:rt,transform:H,params:N,queryPadding:this.queryPadding*Q},a,u,f):{}},ta.prototype.querySourceFeatures=function(a,u){var f=this.latestFeatureIndex;if(f&&f.rawTileData){var b=f.loadVTLayers(),S=u?u.sourceLayer:"",I=b._geojsonTileLayer||b[S];if(I)for(var N=cf(u&&u.filter),H=this.tileID.canonical,Q=H.z,rt=H.x,st=H.y,lt={z:Q,x:rt,y:st},yt=0;yt<I.length;yt++){var Tt=I.feature(yt);if(N.needGeometry){var kt=Uo(Tt,!0);if(!N.filter(new Un(this.tileID.overscaledZ),kt,this.tileID.canonical))continue}else if(!N.filter(new Un(this.tileID.overscaledZ),Tt))continue;var Ut=f.getId(Tt,S),$t=new eE(Tt,Q,rt,st,Ut);$t.tile=lt,a.push($t)}}},ta.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},ta.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},ta.prototype.setExpiryData=function(a){var u=this.expirationTime;if(a.cacheControl){var f=ee(a.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){var b=Date.now(),S=!1;if(this.expirationTime>b)S=!1;else if(u)if(this.expirationTime<u)S=!0;else{var I=this.expirationTime-u;I?this.expirationTime=b+Math.max(I,3e4):S=!0}else S=!0;S?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},ta.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},ta.prototype.setFeatureState=function(a,u){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(a).length!==0){var f=this.latestFeatureIndex.loadVTLayers();for(var b in this.buckets)if(u.style.hasLayer(b)){var S=this.buckets[b],I=S.layers[0].sourceLayer||"_geojsonTileLayer",N=f[I],H=a[I];if(N&&H&&Object.keys(H).length!==0){S.update(H,N,this.imageAtlas&&this.imageAtlas.patternPositions||{});var Q=u&&u.style&&u.style.getLayer(b);Q&&(this.queryPadding=Math.max(this.queryPadding,Q.queryRadius(S)))}}}},ta.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},ta.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<dt.now()},ta.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},ta.prototype.setHoldDuration=function(a){this.symbolFadeHoldUntil=dt.now()+a},ta.prototype.setDependencies=function(a,u){for(var f={},b=0,S=u;b<S.length;b+=1)f[S[b]]=!0;this.dependencies[a]=f},ta.prototype.hasDependency=function(a,u){for(var f=0,b=a;f<b.length;f+=1){var S=this.dependencies[b[f]];if(S){for(var I=0,N=u;I<N.length;I+=1)if(S[N[I]])return!0}}return!1};var qd=p.performance,PU=function(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},qd.mark(this._marks.start)};PU.prototype.finish=function(){qd.mark(this._marks.end);var a=qd.getEntriesByName(this._marks.measure);return a.length===0&&(qd.measure(this._marks.measure,this._marks.start,this._marks.end),a=qd.getEntriesByName(this._marks.measure),qd.clearMarks(this._marks.start),qd.clearMarks(this._marks.end),qd.clearMeasures(this._marks.measure)),a},i.Actor=Kg,i.AlphaImage=vn,i.CanonicalTileID=OA,i.CollisionBoxArray=y,i.Color=ci,i.DEMData=Pp,i.DataConstantProperty=Wr,i.DictionaryCoder=tE,i.EXTENT=8192,i.ErrorEvent=Qt,i.EvaluationParameters=Un,i.Event=vt,i.Evented=Jt,i.FeatureIndex=Ip,i.FillBucket=Lr,i.FillExtrusionBucket=wh,i.ImageAtlas=Nx,i.ImagePosition=qT,i.LineBucket=vc,i.LngLat=wo,i.LngLatBounds=Cs,i.MercatorCoordinate=LA,i.ONE_EM=24,i.OverscaledTileID=Ps,i.Point=l,i.Point$1=l,i.Properties=Ms,i.Protobuf=HT,i.RGBAImage=Vo,i.RequestManager=bn,i.RequestPerformance=PU,i.ResourceType=Xl,i.SegmentVector=Ct,i.SourceFeatureState=Zg,i.StructArrayLayout1ui2=Ou,i.StructArrayLayout2f1f2i16=As,i.StructArrayLayout2i4=nu,i.StructArrayLayout3ui6=Ya,i.StructArrayLayout4i8=yp,i.SymbolBucket=Wi,i.Texture=RA,i.Tile=ta,i.Transitionable=Us,i.Uniform1f=Je,i.Uniform1i=Ve,i.Uniform2f=$e,i.Uniform3f=wr,i.Uniform4f=qr,i.UniformColor=$r,i.UniformMatrix4f=ei,i.UnwrappedTileID=MU,i.ValidationError=jt,i.WritingMode=Rl,i.ZoomHistory=TA,i.add=function(a,u,f){return a[0]=u[0]+f[0],a[1]=u[1]+f[1],a[2]=u[2]+f[2],a},i.addDynamicAttributes=sL,i.asyncAll=function(a,u,f){if(!a.length)return f(null,[]);var b=a.length,S=new Array(a.length),I=null;a.forEach(function(N,H){u(N,function(Q,rt){Q&&(I=Q),S[H]=rt,--b==0&&f(I,S)})})},i.bezier=w,i.bindAll=et,i.browser=dt,i.cacheEntryPossiblyAdded=function(a){++ha>ds&&(a.getActor().send("enforceCacheSizeLimit",ki),ha=0)},i.clamp=P,i.clearTileCache=function(a){var u=p.caches.delete("mapbox-tiles");a&&u.catch(a).then(function(){return a()})},i.clipLine=uU,i.clone=function(a){var u=new gi(16);return u[0]=a[0],u[1]=a[1],u[2]=a[2],u[3]=a[3],u[4]=a[4],u[5]=a[5],u[6]=a[6],u[7]=a[7],u[8]=a[8],u[9]=a[9],u[10]=a[10],u[11]=a[11],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15],u},i.clone$1=J,i.clone$2=function(a){var u=new gi(3);return u[0]=a[0],u[1]=a[1],u[2]=a[2],u},i.collisionCircleLayout=Dht,i.config=wt,i.create=function(){var a=new gi(16);return gi!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},i.create$1=function(){var a=new gi(9);return gi!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a},i.create$2=function(){var a=new gi(4);return gi!=Float32Array&&(a[1]=0,a[2]=0),a[0]=1,a[3]=1,a},i.createCommonjsModule=o,i.createExpression=pn,i.createLayout=Ss,i.createStyleLayer=function(a){return a.type==="custom"?new pft(a):new dft[a.type](a)},i.cross=function(a,u,f){var b=u[0],S=u[1],I=u[2],N=f[0],H=f[1],Q=f[2];return a[0]=S*Q-I*H,a[1]=I*N-b*Q,a[2]=b*H-S*N,a},i.deepEqual=function a(u,f){if(Array.isArray(u)){if(!Array.isArray(f)||u.length!==f.length)return!1;for(var b=0;b<u.length;b++)if(!a(u[b],f[b]))return!1;return!0}if(typeof u=="object"&&u!==null&&f!==null){if(typeof f!="object"||Object.keys(u).length!==Object.keys(f).length)return!1;for(var S in u)if(!a(u[S],f[S]))return!1;return!0}return u===f},i.dot=function(a,u){return a[0]*u[0]+a[1]*u[1]+a[2]*u[2]},i.dot$1=function(a,u){return a[0]*u[0]+a[1]*u[1]+a[2]*u[2]+a[3]*u[3]},i.ease=E,i.emitValidationErrors=Ac,i.endsWith=F,i.enforceCacheSizeLimit=function(a){es(),yi&&yi.then(function(u){u.keys().then(function(f){for(var b=0;b<f.length-a;b++)u.delete(f[b])})})},i.evaluateSizeForFeature=iU,i.evaluateSizeForZoom=oU,i.evaluateVariableOffset=pU,i.evented=MA,i.extend=D,i.featureFilter=cf,i.filterObject=ot,i.fromRotation=function(a,u){var f=Math.sin(u),b=Math.cos(u);return a[0]=b,a[1]=f,a[2]=0,a[3]=-f,a[4]=b,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},i.getAnchorAlignment=rL,i.getAnchorJustification=oL,i.getArrayBuffer=bu,i.getImage=At,i.getJSON=function(a,u){return hc(D(a,{type:"json"}),u)},i.getRTLTextPluginStatus=SA,i.getReferrer=wl,i.getVideo=function(a,u){var f,b,S=p.document.createElement("video");S.muted=!0,S.onloadstart=function(){u(null,S)};for(var I=0;I<a.length;I++){var N=p.document.createElement("source");f=a[I],b=void 0,(b=p.document.createElement("a")).href=f,(b.protocol!==p.document.location.protocol||b.host!==p.document.location.host)&&(S.crossOrigin="Anonymous"),N.src=a[I],S.appendChild(N)}return{cancel:function(){}}},i.identity=Za,i.invert=function(a,u){var f=u[0],b=u[1],S=u[2],I=u[3],N=u[4],H=u[5],Q=u[6],rt=u[7],st=u[8],lt=u[9],yt=u[10],Tt=u[11],kt=u[12],Ut=u[13],$t=u[14],qt=u[15],ie=f*H-b*N,de=f*Q-S*N,ge=f*rt-I*N,we=b*Q-S*H,De=b*rt-I*H,Ke=S*rt-I*Q,or=st*Ut-lt*kt,Hr=st*$t-yt*kt,vr=st*qt-Tt*kt,Zr=lt*$t-yt*Ut,Tr=lt*qt-Tt*Ut,Ln=yt*qt-Tt*$t,un=ie*Ln-de*Tr+ge*Zr+we*vr-De*Hr+Ke*or;return un?(a[0]=(H*Ln-Q*Tr+rt*Zr)*(un=1/un),a[1]=(S*Tr-b*Ln-I*Zr)*un,a[2]=(Ut*Ke-$t*De+qt*we)*un,a[3]=(yt*De-lt*Ke-Tt*we)*un,a[4]=(Q*vr-N*Ln-rt*Hr)*un,a[5]=(f*Ln-S*vr+I*Hr)*un,a[6]=($t*ge-kt*Ke-qt*de)*un,a[7]=(st*Ke-yt*ge+Tt*de)*un,a[8]=(N*Tr-H*vr+rt*or)*un,a[9]=(b*vr-f*Tr-I*or)*un,a[10]=(kt*De-Ut*ge+qt*ie)*un,a[11]=(lt*ge-st*De-Tt*ie)*un,a[12]=(H*Hr-N*Zr-Q*or)*un,a[13]=(f*Zr-b*Hr+S*or)*un,a[14]=(Ut*de-kt*we-$t*ie)*un,a[15]=(st*we-lt*de+yt*ie)*un,a):null},i.isChar=lr,i.isMapboxURL=ai,i.keysDifference=function(a,u){var f=[];for(var b in a)b in u||f.push(b);return f},i.makeRequest=hc,i.mapObject=ut,i.mercatorXfromLng=wU,i.mercatorYfromLat=TU,i.mercatorZfromAltitude=EU,i.mul=Ng,i.multiply=_a,i.mvt=Sp,i.nextPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},i.normalize=function(a,u){var f=u[0],b=u[1],S=u[2],I=f*f+b*b+S*S;return I>0&&(I=1/Math.sqrt(I)),a[0]=u[0]*I,a[1]=u[1]*I,a[2]=u[2]*I,a},i.number=xo,i.offscreenCanvasSupported=ch,i.ortho=function(a,u,f,b,S,I,N){var H=1/(u-f),Q=1/(b-S),rt=1/(I-N);return a[0]=-2*H,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*Q,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*rt,a[11]=0,a[12]=(u+f)*H,a[13]=(S+b)*Q,a[14]=(N+I)*rt,a[15]=1,a},i.parseGlyphPBF=function(a){return new HT(a).readFields(Ght,[])},i.pbf=HT,i.performSymbolLayout=function(a,u,f,b,S,I,N){a.createArrays(),a.tilePixelRatio=8192/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;var H=a.layers[0].layout,Q=a.layers[0]._unevaluatedLayout._values,rt={};if(a.textSizeData.kind==="composite"){var st=a.textSizeData,lt=st.maxZoom;rt.compositeTextSizes=[Q["text-size"].possiblyEvaluate(new Un(st.minZoom),N),Q["text-size"].possiblyEvaluate(new Un(lt),N)]}if(a.iconSizeData.kind==="composite"){var yt=a.iconSizeData,Tt=yt.maxZoom;rt.compositeIconSizes=[Q["icon-size"].possiblyEvaluate(new Un(yt.minZoom),N),Q["icon-size"].possiblyEvaluate(new Un(Tt),N)]}rt.layoutTextSize=Q["text-size"].possiblyEvaluate(new Un(a.zoom+1),N),rt.layoutIconSize=Q["icon-size"].possiblyEvaluate(new Un(a.zoom+1),N),rt.textMaxSize=Q["text-size"].possiblyEvaluate(new Un(18));for(var kt=24*H.get("text-line-height"),Ut=H.get("text-rotation-alignment")==="map"&&H.get("symbol-placement")!=="point",$t=H.get("text-keep-upright"),qt=H.get("text-size"),ie=function(){var we=ge[de],De=H.get("text-font").evaluate(we,{},N).join(","),Ke=qt.evaluate(we,{},N),or=rt.layoutTextSize.evaluate(we,{},N),Hr=rt.layoutIconSize.evaluate(we,{},N),vr={horizontal:{},vertical:void 0},Zr=we.text,Tr=[0,0];if(Zr){var Ln=Zr.toString(),un=24*H.get("text-letter-spacing").evaluate(we,{},N),Fr=function(Jn){for(var $i=0,zi=Jn;$i<zi.length;$i+=1)if(hi=zi[$i].charCodeAt(0),lr.Arabic(hi)||lr["Arabic Supplement"](hi)||lr["Arabic Extended-A"](hi)||lr["Arabic Presentation Forms-A"](hi)||lr["Arabic Presentation Forms-B"](hi))return!1;var hi;return!0}(Ln)?un:0,Wn=H.get("text-anchor").evaluate(we,{},N),En=H.get("text-variable-anchor");if(!En){var si=H.get("text-radial-offset").evaluate(we,{},N);Tr=si?pU(Wn,[24*si,iL]):H.get("text-offset").evaluate(we,{},N).map(function(Jn){return 24*Jn})}var Qr=Ut?"center":H.get("text-justify").evaluate(we,{},N),bi=H.get("symbol-placement"),To=bi==="point"?24*H.get("text-max-width").evaluate(we,{},N):0,Xo=function(){a.allowVerticalPlacement&&Vd(Ln)&&(vr.vertical=GT(Zr,u,f,S,De,To,kt,Wn,"left",Fr,Tr,Rl.vertical,!0,bi,or,Ke))};if(!Ut&&En){for(var jo=Qr==="auto"?En.map(function(Jn){return oL(Jn)}):[Qr],Eo=!1,Yo=0;Yo<jo.length;Yo++){var js=jo[Yo];if(!vr.horizontal[js])if(Eo)vr.horizontal[js]=vr.horizontal[0];else{var Hs=GT(Zr,u,f,S,De,To,kt,"center",js,Fr,Tr,Rl.horizontal,!1,bi,or,Ke);Hs&&(vr.horizontal[js]=Hs,Eo=Hs.positionedLines.length===1)}}Xo()}else{Qr==="auto"&&(Qr=oL(Wn));var Qa=GT(Zr,u,f,S,De,To,kt,Wn,Qr,Fr,Tr,Rl.horizontal,!1,bi,or,Ke);Qa&&(vr.horizontal[Qr]=Qa),Xo(),Vd(Ln)&&Ut&&$t&&(vr.vertical=GT(Zr,u,f,S,De,To,kt,Wn,Qr,Fr,Tr,Rl.vertical,!1,bi,or,Ke))}}var ea=void 0,Ja=!1;if(we.icon&&we.icon.name){var ss=b[we.icon.name];ss&&(ea=function(Jn,$i,zi){var hi=rL(zi),bc=$i[0]-Jn.displaySize[0]*hi.horizontalAlign,Ba=$i[1]-Jn.displaySize[1]*hi.verticalAlign;return{image:Jn,top:Ba,bottom:Ba+Jn.displaySize[1],left:bc,right:bc+Jn.displaySize[0]}}(S[we.icon.name],H.get("icon-offset").evaluate(we,{},N),H.get("icon-anchor").evaluate(we,{},N)),Ja=ss.sdf,a.sdfIcons===void 0?a.sdfIcons=ss.sdf:a.sdfIcons!==ss.sdf&&mt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ss.pixelRatio!==a.pixelRatio||H.get("icon-rotate").constantOr(1)!==0)&&(a.iconsNeedLinear=!0))}var ra=mU(vr.horizontal)||vr.vertical;a.iconsInText=!!ra&&ra.iconsInText,(ra||ea)&&function(Jn,$i,zi,hi,bc,Ba,mo,xs,Da,wi,xf){var Ll=Ba.textMaxSize.evaluate($i,{});Ll===void 0&&(Ll=mo);var vf,as=Jn.layers[0].layout,bf=as.get("icon-offset").evaluate($i,{},xf),zu=mU(zi.horizontal),$g=mo/24,BA=Jn.tilePixelRatio*$g,Qg=Jn.tilePixelRatio*Ll/24,Rp=Jn.tilePixelRatio*xs,Jg=Jn.tilePixelRatio*as.get("symbol-spacing"),rE=as.get("text-padding")*Jn.tilePixelRatio,t_=as.get("icon-padding")*Jn.tilePixelRatio,zx=as.get("text-max-angle")/180*Math.PI,nE=as.get("text-rotation-alignment")==="map"&&as.get("symbol-placement")!=="point",iE=as.get("icon-rotation-alignment")==="map"&&as.get("symbol-placement")!=="point",Lp=as.get("symbol-placement"),Ux=Jg/2,e_=as.get("icon-text-fit");hi&&e_!=="none"&&(Jn.allowVerticalPlacement&&zi.vertical&&(vf=nU(hi,zi.vertical,e_,as.get("icon-text-fit-padding"),bf,$g)),zu&&(hi=nU(hi,zu,e_,as.get("icon-text-fit-padding"),bf,$g)));var Gd=function(Aft,Yx){Yx.x<0||Yx.x>=8192||Yx.y<0||Yx.y>=8192||function(cs,Th,gft,Xd,dL,LU,uE,wf,hE,Kx,fE,pE,mL,OU,Zx,BU,DU,NU,kU,FU,Ol,dE,zU,Tf,_ft){var UU,NA,s_,a_,c_,l_=cs.addToLineVertexArray(Th,gft),VU=0,jU=0,HU=0,WU=0,AL=-1,gL=-1,Op={},qU=Dt(""),_L=0,yL=0;if(wf._unevaluatedLayout.getValue("text-radial-offset")===void 0?(_L=(UU=wf.layout.get("text-offset").evaluate(Ol,{},Tf).map(function(Qx){return 24*Qx}))[0],yL=UU[1]):(_L=24*wf.layout.get("text-radial-offset").evaluate(Ol,{},Tf),yL=iL),cs.allowVerticalPlacement&&Xd.vertical){var GU=wf.layout.get("text-rotate").evaluate(Ol,{},Tf)+90;a_=new $T(hE,Th,Kx,fE,pE,Xd.vertical,mL,OU,Zx,GU),uE&&(c_=new $T(hE,Th,Kx,fE,pE,uE,DU,NU,Zx,GU))}if(dL){var xL=wf.layout.get("icon-rotate").evaluate(Ol,{}),XU=wf.layout.get("icon-text-fit")!=="none",YU=hU(dL,xL,zU,XU),vL=uE?hU(uE,xL,zU,XU):void 0;s_=new $T(hE,Th,Kx,fE,pE,dL,DU,NU,!1,xL),VU=4*YU.length;var KU=cs.iconSizeData,$x=null;KU.kind==="source"?($x=[128*wf.layout.get("icon-size").evaluate(Ol,{})])[0]>32640&&mt(cs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):KU.kind==="composite"&&(($x=[128*dE.compositeIconSizes[0].evaluate(Ol,{},Tf),128*dE.compositeIconSizes[1].evaluate(Ol,{},Tf)])[0]>32640||$x[1]>32640)&&mt(cs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),cs.addSymbols(cs.icon,YU,$x,FU,kU,Ol,!1,Th,l_.lineStartIndex,l_.lineLength,-1,Tf),AL=cs.icon.placedSymbolArray.length-1,vL&&(jU=4*vL.length,cs.addSymbols(cs.icon,vL,$x,FU,kU,Ol,Rl.vertical,Th,l_.lineStartIndex,l_.lineLength,-1,Tf),gL=cs.icon.placedSymbolArray.length-1)}for(var ZU in Xd.horizontal){var mE=Xd.horizontal[ZU];if(!NA){qU=Dt(mE.text);var yft=wf.layout.get("text-rotate").evaluate(Ol,{},Tf);NA=new $T(hE,Th,Kx,fE,pE,mE,mL,OU,Zx,yft)}var $U=mE.positionedLines.length===1;if(HU+=dU(cs,Th,mE,LU,wf,Zx,Ol,BU,l_,Xd.vertical?Rl.horizontal:Rl.horizontalOnly,$U?Object.keys(Xd.horizontal):[ZU],Op,AL,dE,Tf),$U)break}Xd.vertical&&(WU+=dU(cs,Th,Xd.vertical,LU,wf,Zx,Ol,BU,l_,Rl.vertical,["vertical"],Op,gL,dE,Tf));var xft=NA?NA.boxStartIndex:cs.collisionBoxArray.length,vft=NA?NA.boxEndIndex:cs.collisionBoxArray.length,bft=a_?a_.boxStartIndex:cs.collisionBoxArray.length,wft=a_?a_.boxEndIndex:cs.collisionBoxArray.length,Tft=s_?s_.boxStartIndex:cs.collisionBoxArray.length,Eft=s_?s_.boxEndIndex:cs.collisionBoxArray.length,Mft=c_?c_.boxStartIndex:cs.collisionBoxArray.length,Sft=c_?c_.boxEndIndex:cs.collisionBoxArray.length,Ef=-1,AE=function(Qx,JU){return Qx&&Qx.circleDiameter?Math.max(Qx.circleDiameter,JU):JU};Ef=AE(NA,Ef),Ef=AE(a_,Ef),Ef=AE(s_,Ef);var QU=(Ef=AE(c_,Ef))>-1?1:0;QU&&(Ef*=_ft/24),cs.glyphOffsetArray.length>=Wi.MAX_GLYPHS&&mt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ol.sortKey!==void 0&&cs.addToSortKeyRanges(cs.symbolInstances.length,Ol.sortKey),cs.symbolInstances.emplaceBack(Th.x,Th.y,Op.right>=0?Op.right:-1,Op.center>=0?Op.center:-1,Op.left>=0?Op.left:-1,Op.vertical||-1,AL,gL,qU,xft,vft,bft,wft,Tft,Eft,Mft,Sft,Kx,HU,WU,VU,jU,QU,0,mL,_L,yL,Ef)}(Jn,Yx,Aft,zi,hi,bc,vf,Jn.layers[0],Jn.collisionBoxArray,$i.index,$i.sourceLayerIndex,Jn.index,BA,rE,nE,Da,Rp,t_,iE,bf,$i,Ba,wi,xf,mo)};if(Lp==="line")for(var r_=0,oE=uU($i.geometry,0,0,8192,8192);r_<oE.length;r_+=1)for(var sE=oE[r_],Vx=0,jx=Jht(sE,Jg,zx,zi.vertical||zu,hi,24,Qg,Jn.overscaling,8192);Vx<jx.length;Vx+=1){var aE=jx[Vx];zu&&nft(Jn,zu.text,Ux,aE)||Gd(sE,aE)}else if(Lp==="line-center")for(var Hx=0,Wx=$i.geometry;Hx<Wx.length;Hx+=1){var qx=Wx[Hx];if(qx.length>1){var cE=Qht(qx,zx,zi.vertical||zu,hi,24,Qg);cE&&Gd(qx,cE)}}else if($i.type==="Polygon")for(var n_=0,lE=xe($i.geometry,0);n_<lE.length;n_+=1){var i_=lE[n_],Gx=eft(i_,16);Gd(i_[0],new Wg(Gx.x,Gx.y,0))}else if($i.type==="LineString")for(var DA=0,Xx=$i.geometry;DA<Xx.length;DA+=1){var o_=Xx[DA];Gd(o_,new Wg(o_[0].x,o_[0].y,0))}else if($i.type==="Point")for(var hL=0,IU=$i.geometry;hL<IU.length;hL+=1)for(var fL=0,RU=IU[hL];fL<RU.length;fL+=1){var pL=RU[fL];Gd([pL],new Wg(pL.x,pL.y,0))}}(a,we,vr,ea,b,rt,or,Hr,Tr,Ja,N)},de=0,ge=a.features;de<ge.length;de+=1)ie();I&&a.generateCollisionDebugBuffers()},i.perspective=function(a,u,f,b,S){var I,N=1/Math.tan(u/2);return a[0]=N/f,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=N,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,S!=null&&S!==1/0?(a[10]=(S+b)*(I=1/(b-S)),a[14]=2*S*b*I):(a[10]=-1,a[14]=-2*b),a},i.pick=function(a,u){for(var f={},b=0;b<u.length;b++){var S=u[b];S in a&&(f[S]=a[S])}return f},i.plugin=_c,i.polygonIntersectsPolygon=Du,i.postMapLoadEvent=ho,i.postTurnstileEvent=zr,i.potpack=J8,i.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.register=_r,i.registerForPluginStateChange=function(a){return a({pluginStatus:os,pluginURL:Ml}),MA.on("pluginStateChange",a),a},i.renderColorRamp=Oa,i.rotate=function(a,u,f){var b=u[0],S=u[1],I=u[2],N=u[3],H=Math.sin(f),Q=Math.cos(f);return a[0]=b*Q+I*H,a[1]=S*Q+N*H,a[2]=b*-H+I*Q,a[3]=S*-H+N*Q,a},i.rotateX=function(a,u,f){var b=Math.sin(f),S=Math.cos(f),I=u[4],N=u[5],H=u[6],Q=u[7],rt=u[8],st=u[9],lt=u[10],yt=u[11];return u!==a&&(a[0]=u[0],a[1]=u[1],a[2]=u[2],a[3]=u[3],a[12]=u[12],a[13]=u[13],a[14]=u[14],a[15]=u[15]),a[4]=I*S+rt*b,a[5]=N*S+st*b,a[6]=H*S+lt*b,a[7]=Q*S+yt*b,a[8]=rt*S-I*b,a[9]=st*S-N*b,a[10]=lt*S-H*b,a[11]=yt*S-Q*b,a},i.rotateZ=function(a,u,f){var b=Math.sin(f),S=Math.cos(f),I=u[0],N=u[1],H=u[2],Q=u[3],rt=u[4],st=u[5],lt=u[6],yt=u[7];return u!==a&&(a[8]=u[8],a[9]=u[9],a[10]=u[10],a[11]=u[11],a[12]=u[12],a[13]=u[13],a[14]=u[14],a[15]=u[15]),a[0]=I*S+rt*b,a[1]=N*S+st*b,a[2]=H*S+lt*b,a[3]=Q*S+yt*b,a[4]=rt*S-I*b,a[5]=st*S-N*b,a[6]=lt*S-H*b,a[7]=yt*S-Q*b,a},i.scale=function(a,u,f){var b=f[0],S=f[1],I=f[2];return a[0]=u[0]*b,a[1]=u[1]*b,a[2]=u[2]*b,a[3]=u[3]*b,a[4]=u[4]*S,a[5]=u[5]*S,a[6]=u[6]*S,a[7]=u[7]*S,a[8]=u[8]*I,a[9]=u[9]*I,a[10]=u[10]*I,a[11]=u[11]*I,a[12]=u[12],a[13]=u[13],a[14]=u[14],a[15]=u[15],a},i.scale$1=function(a,u,f){return a[0]=u[0]*f,a[1]=u[1]*f,a[2]=u[2]*f,a[3]=u[3]*f,a},i.scale$2=function(a,u,f){return a[0]=u[0]*f,a[1]=u[1]*f,a[2]=u[2]*f,a},i.setCacheLimits=function(a,u){ki=a,ds=u},i.setRTLTextPlugin=function(a,u,f){if(f===void 0&&(f=!1),os==="deferred"||os==="loading"||os==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Ml=dt.resolveURL(a),os="deferred",El=u,gh(),f||Lc()},i.sphericalToCartesian=function(a){var u=a[0],f=a[1],b=a[2];return f+=90,f*=Math.PI/180,b*=Math.PI/180,{x:u*Math.cos(f)*Math.sin(b),y:u*Math.sin(f)*Math.sin(b),z:u*Math.cos(b)}},i.sqrLen=function(a){var u=a[0],f=a[1];return u*u+f*f},i.styleSpec=St,i.sub=function(a,u,f){return a[0]=u[0]-f[0],a[1]=u[1]-f[1],a[2]=u[2]-f[2],a},i.symbolSize=$ht,i.transformMat3=function(a,u,f){var b=u[0],S=u[1],I=u[2];return a[0]=b*f[0]+S*f[3]+I*f[6],a[1]=b*f[1]+S*f[4]+I*f[7],a[2]=b*f[2]+S*f[5]+I*f[8],a},i.transformMat4=Wd,i.translate=function(a,u,f){var b,S,I,N,H,Q,rt,st,lt,yt,Tt,kt,Ut=f[0],$t=f[1],qt=f[2];return u===a?(a[12]=u[0]*Ut+u[4]*$t+u[8]*qt+u[12],a[13]=u[1]*Ut+u[5]*$t+u[9]*qt+u[13],a[14]=u[2]*Ut+u[6]*$t+u[10]*qt+u[14],a[15]=u[3]*Ut+u[7]*$t+u[11]*qt+u[15]):(S=u[1],I=u[2],N=u[3],H=u[4],Q=u[5],rt=u[6],st=u[7],lt=u[8],yt=u[9],Tt=u[10],kt=u[11],a[0]=b=u[0],a[1]=S,a[2]=I,a[3]=N,a[4]=H,a[5]=Q,a[6]=rt,a[7]=st,a[8]=lt,a[9]=yt,a[10]=Tt,a[11]=kt,a[12]=b*Ut+H*$t+lt*qt+u[12],a[13]=S*Ut+Q*$t+yt*qt+u[13],a[14]=I*Ut+rt*$t+Tt*qt+u[14],a[15]=N*Ut+st*$t+kt*qt+u[15]),a},i.triggerPluginCompletionEvent=EA,i.uniqueId=X,i.validateCustomStyleLayer=function(a){var u=[],f=a.id;return f===void 0&&u.push({message:"layers."+f+': missing required property "id"'}),a.render===void 0&&u.push({message:"layers."+f+': missing required method "render"'}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&u.push({message:"layers."+f+': property "renderingMode" must be either "2d" or "3d"'}),u},i.validateLight=zs,i.validateStyle=Go,i.values=function(a){var u=[];for(var f in a)u.push(a[f]);return u},i.vectorTile=Sp,i.version="1.13.3",i.warnOnce=mt,i.webpSupported=Ht,i.window=p,i.wrap=B}),n(["./shared"],function(i){"use strict";function o(at){var At=typeof at;if(At==="number"||At==="boolean"||At==="string"||at==null)return JSON.stringify(at);if(Array.isArray(at)){for(var bt="[",Lt=0,vt=at;Lt<vt.length;Lt+=1)bt+=o(vt[Lt])+",";return bt+"]"}for(var Qt=Object.keys(at).sort(),Jt="{",St=0;St<Qt.length;St++)Jt+=JSON.stringify(Qt[St])+":"+o(at[Qt[St]])+",";return Jt+"}"}function s(at){for(var At="",bt=0,Lt=i.refProperties;bt<Lt.length;bt+=1)At+="/"+o(at[Lt[bt]]);return At}var c=function(at){this.keyCache={},at&&this.replace(at)};c.prototype.replace=function(at){this._layerConfigs={},this._layers={},this.update(at,[])},c.prototype.update=function(at,At){for(var bt=this,Lt=0,vt=at;Lt<vt.length;Lt+=1){var Qt=vt[Lt];this._layerConfigs[Qt.id]=Qt;var Jt=this._layers[Qt.id]=i.createStyleLayer(Qt);Jt._featureFilter=i.featureFilter(Jt.filter),this.keyCache[Qt.id]&&delete this.keyCache[Qt.id]}for(var St=0,jt=At;St<jt.length;St+=1){var ce=jt[St];delete this.keyCache[ce],delete this._layerConfigs[ce],delete this._layers[ce]}this.familiesBySource={};for(var je=0,Ge=function(tr,cr){for(var wn={},fr=0;fr<tr.length;fr++){var On=cr&&cr[tr[fr].id]||s(tr[fr]);cr&&(cr[tr[fr].id]=On);var Ci=wn[On];Ci||(Ci=wn[On]=[]),Ci.push(tr[fr])}var Bn=[];for(var Zn in wn)Bn.push(wn[Zn]);return Bn}(i.values(this._layerConfigs),this.keyCache);je<Ge.length;je+=1){var Pe=Ge[je].map(function(tr){return bt._layers[tr.id]}),We=Pe[0];if(We.visibility!=="none"){var Rr=We.source||"",Cr=this.familiesBySource[Rr];Cr||(Cr=this.familiesBySource[Rr]={});var Re=We.sourceLayer||"_geojsonTileLayer",yr=Cr[Re];yr||(yr=Cr[Re]=[]),yr.push(Pe)}}};var l=function(at){var At={},bt=[];for(var Lt in at){var vt=at[Lt],Qt=At[Lt]={};for(var Jt in vt){var St=vt[+Jt];if(St&&St.bitmap.width!==0&&St.bitmap.height!==0){var jt={x:0,y:0,w:St.bitmap.width+2,h:St.bitmap.height+2};bt.push(jt),Qt[Jt]={rect:jt,metrics:St.metrics}}}}var ce=i.potpack(bt),je=new i.AlphaImage({width:ce.w||1,height:ce.h||1});for(var Ge in at){var Pe=at[Ge];for(var We in Pe){var Rr=Pe[+We];if(Rr&&Rr.bitmap.width!==0&&Rr.bitmap.height!==0){var Cr=At[Ge][We].rect;i.AlphaImage.copy(Rr.bitmap,je,{x:0,y:0},{x:Cr.x+1,y:Cr.y+1},Rr.bitmap)}}}this.image=je,this.positions=At};i.register("GlyphAtlas",l);var h=function(at){this.tileID=new i.OverscaledTileID(at.tileID.overscaledZ,at.tileID.wrap,at.tileID.canonical.z,at.tileID.canonical.x,at.tileID.canonical.y),this.uid=at.uid,this.zoom=at.zoom,this.pixelRatio=at.pixelRatio,this.tileSize=at.tileSize,this.source=at.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=at.showCollisionBoxes,this.collectResourceTiming=!!at.collectResourceTiming,this.returnDependencies=!!at.returnDependencies,this.promoteId=at.promoteId};function p(at,At,bt){for(var Lt=new i.EvaluationParameters(At),vt=0,Qt=at;vt<Qt.length;vt+=1)Qt[vt].recalculate(Lt,bt)}function x(at,At){var bt=i.getArrayBuffer(at.request,function(Lt,vt,Qt,Jt){Lt?At(Lt):vt&&At(null,{vectorTile:new i.vectorTile.VectorTile(new i.pbf(vt)),rawData:vt,cacheControl:Qt,expires:Jt})});return function(){bt.cancel(),At()}}h.prototype.parse=function(at,At,bt,Lt,vt){var Qt=this;this.status="parsing",this.data=at,this.collisionBoxArray=new i.CollisionBoxArray;var Jt=new i.DictionaryCoder(Object.keys(at.layers).sort()),St=new i.FeatureIndex(this.tileID,this.promoteId);St.bucketLayerIDs=[];var jt,ce,je,Ge,Pe={},We={featureIndex:St,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:bt},Rr=At.familiesBySource[this.source];for(var Cr in Rr){var Re=at.layers[Cr];if(Re){Re.version===1&&i.warnOnce('Vector tile source "'+this.source+'" layer "'+Cr+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var yr=Jt.encode(Cr),tr=[],cr=0;cr<Re.length;cr++){var wn=Re.feature(cr),fr=St.getId(wn,Cr);tr.push({feature:wn,id:fr,index:cr,sourceLayerIndex:yr})}for(var On=0,Ci=Rr[Cr];On<Ci.length;On+=1){var Bn=Ci[On],Zn=Bn[0];Zn.minzoom&&this.zoom<Math.floor(Zn.minzoom)||Zn.maxzoom&&this.zoom>=Zn.maxzoom||Zn.visibility!=="none"&&(p(Bn,this.zoom,bt),(Pe[Zn.id]=Zn.createBucket({index:St.bucketLayerIDs.length,layers:Bn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:yr,sourceID:this.source})).populate(tr,We,this.tileID.canonical),St.bucketLayerIDs.push(Bn.map(function(Pi){return Pi.id})))}}}var Yn=i.mapObject(We.glyphDependencies,function(Pi){return Object.keys(Pi).map(Number)});Object.keys(Yn).length?Lt.send("getGlyphs",{uid:this.uid,stacks:Yn},function(Pi,Dn){jt||(jt=Pi,ce=Dn,yo.call(Qt))}):ce={};var Ns=Object.keys(We.iconDependencies);Ns.length?Lt.send("getImages",{icons:Ns,source:this.source,tileID:this.tileID,type:"icons"},function(Pi,Dn){jt||(jt=Pi,je=Dn,yo.call(Qt))}):je={};var di=Object.keys(We.patternDependencies);function yo(){if(jt)return vt(jt);if(ce&&je&&Ge){var Pi=new l(ce),Dn=new i.ImageAtlas(je,Ge);for(var ci in Pe){var pa=Pe[ci];pa instanceof i.SymbolBucket?(p(pa.layers,this.zoom,bt),i.performSymbolLayout(pa,ce,Pi.positions,je,Dn.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):pa.hasPattern&&(pa instanceof i.LineBucket||pa instanceof i.FillBucket||pa instanceof i.FillExtrusionBucket)&&(p(pa.layers,this.zoom,bt),pa.addFeatures(We,this.tileID.canonical,Dn.patternPositions))}this.status="done",vt(null,{buckets:i.values(Pe).filter(function(lh){return!lh.isEmpty()}),featureIndex:St,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Pi.image,imageAtlas:Dn,glyphMap:this.returnDependencies?ce:null,iconMap:this.returnDependencies?je:null,glyphPositions:this.returnDependencies?Pi.positions:null})}}di.length?Lt.send("getImages",{icons:di,source:this.source,tileID:this.tileID,type:"patterns"},function(Pi,Dn){jt||(jt=Pi,Ge=Dn,yo.call(Qt))}):Ge={},yo.call(this)};var w=function(at,At,bt,Lt){this.actor=at,this.layerIndex=At,this.availableImages=bt,this.loadVectorData=Lt||x,this.loading={},this.loaded={}};w.prototype.loadTile=function(at,At){var bt=this,Lt=at.uid;this.loading||(this.loading={});var vt=!!(at&&at.request&&at.request.collectResourceTiming)&&new i.RequestPerformance(at.request),Qt=this.loading[Lt]=new h(at);Qt.abort=this.loadVectorData(at,function(Jt,St){if(delete bt.loading[Lt],Jt||!St)return Qt.status="done",bt.loaded[Lt]=Qt,At(Jt);var jt=St.rawData,ce={};St.expires&&(ce.expires=St.expires),St.cacheControl&&(ce.cacheControl=St.cacheControl);var je={};if(vt){var Ge=vt.finish();Ge&&(je.resourceTiming=JSON.parse(JSON.stringify(Ge)))}Qt.vectorTile=St.vectorTile,Qt.parse(St.vectorTile,bt.layerIndex,bt.availableImages,bt.actor,function(Pe,We){if(Pe||!We)return At(Pe);At(null,i.extend({rawTileData:jt.slice(0)},We,ce,je))}),bt.loaded=bt.loaded||{},bt.loaded[Lt]=Qt})},w.prototype.reloadTile=function(at,At){var bt=this,Lt=this.loaded,vt=at.uid,Qt=this;if(Lt&&Lt[vt]){var Jt=Lt[vt];Jt.showCollisionBoxes=at.showCollisionBoxes;var St=function(jt,ce){var je=Jt.reloadCallback;je&&(delete Jt.reloadCallback,Jt.parse(Jt.vectorTile,Qt.layerIndex,bt.availableImages,Qt.actor,je)),At(jt,ce)};Jt.status==="parsing"?Jt.reloadCallback=St:Jt.status==="done"&&(Jt.vectorTile?Jt.parse(Jt.vectorTile,this.layerIndex,this.availableImages,this.actor,St):St())}},w.prototype.abortTile=function(at,At){var bt=this.loading,Lt=at.uid;bt&&bt[Lt]&&bt[Lt].abort&&(bt[Lt].abort(),delete bt[Lt]),At()},w.prototype.removeTile=function(at,At){var bt=this.loaded,Lt=at.uid;bt&&bt[Lt]&&delete bt[Lt],At()};var E=i.window.ImageBitmap,P=function(){this.loaded={}};function B(at,At){if(at.length!==0){D(at[0],At);for(var bt=1;bt<at.length;bt++)D(at[bt],!At)}}function D(at,At){for(var bt=0,Lt=0,vt=0,Qt=at.length,Jt=Qt-1;vt<Qt;Jt=vt++){var St=(at[vt][0]-at[Jt][0])*(at[Jt][1]+at[vt][1]),jt=bt+St;Lt+=Math.abs(bt)>=Math.abs(St)?bt-jt+St:St-jt+bt,bt=jt}bt+Lt>=0!=!!At&&at.reverse()}P.prototype.loadTile=function(at,At){var bt=at.uid,Lt=at.encoding,vt=at.rawImageData,Qt=E&&vt instanceof E?this.getImageData(vt):vt,Jt=new i.DEMData(bt,Qt,Lt);this.loaded=this.loaded||{},this.loaded[bt]=Jt,At(null,Jt)},P.prototype.getImageData=function(at){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(at.width,at.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=at.width,this.offscreenCanvas.height=at.height,this.offscreenCanvasContext.drawImage(at,0,0,at.width,at.height);var At=this.offscreenCanvasContext.getImageData(-1,-1,at.width+2,at.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new i.RGBAImage({width:At.width,height:At.height},At.data)},P.prototype.removeTile=function(at){var At=this.loaded,bt=at.uid;At&&At[bt]&&delete At[bt]};var W=i.vectorTile.VectorTileFeature.prototype.toGeoJSON,X=function(at){this._feature=at,this.extent=i.EXTENT,this.type=at.type,this.properties=at.tags,"id"in at&&!isNaN(at.id)&&(this.id=parseInt(at.id,10))};X.prototype.loadGeometry=function(){if(this._feature.type===1){for(var at=[],At=0,bt=this._feature.geometry;At<bt.length;At+=1){var Lt=bt[At];at.push([new i.Point$1(Lt[0],Lt[1])])}return at}for(var vt=[],Qt=0,Jt=this._feature.geometry;Qt<Jt.length;Qt+=1){for(var St=[],jt=0,ce=Jt[Qt];jt<ce.length;jt+=1){var je=ce[jt];St.push(new i.Point$1(je[0],je[1]))}vt.push(St)}return vt},X.prototype.toGeoJSON=function(at,At,bt){return W.call(this,at,At,bt)};var q=function(at){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.EXTENT,this.length=at.length,this._features=at};q.prototype.feature=function(at){return new X(this._features[at])};var $=i.vectorTile.VectorTileFeature,et=F;function F(at,At){this.options=At||{},this.features=at,this.length=at.length}function ut(at,At){this.id=typeof at.id=="number"?at.id:void 0,this.type=at.type,this.rawGeometry=at.type===1?[at.geometry]:at.geometry,this.properties=at.tags,this.extent=At||4096}F.prototype.feature=function(at){return new ut(this.features[at],this.options.extent)},ut.prototype.loadGeometry=function(){var at=this.rawGeometry;this.geometry=[];for(var At=0;At<at.length;At++){for(var bt=at[At],Lt=[],vt=0;vt<bt.length;vt++)Lt.push(new i.Point$1(bt[vt][0],bt[vt][1]));this.geometry.push(Lt)}return this.geometry},ut.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var at=this.geometry,At=1/0,bt=-1/0,Lt=1/0,vt=-1/0,Qt=0;Qt<at.length;Qt++)for(var Jt=at[Qt],St=0;St<Jt.length;St++){var jt=Jt[St];At=Math.min(At,jt.x),bt=Math.max(bt,jt.x),Lt=Math.min(Lt,jt.y),vt=Math.max(vt,jt.y)}return[At,Lt,bt,vt]},ut.prototype.toGeoJSON=$.prototype.toGeoJSON;var ot=G,J=et;function G(at){var At=new i.pbf;return function(bt,Lt){for(var vt in bt.layers)Lt.writeMessage(3,mt,bt.layers[vt])}(at,At),At.finish()}function mt(at,At){var bt;At.writeVarintField(15,at.version||1),At.writeStringField(1,at.name||""),At.writeVarintField(5,at.extent||4096);var Lt={keys:[],values:[],keycache:{},valuecache:{}};for(bt=0;bt<at.length;bt++)Lt.feature=at.feature(bt),At.writeMessage(2,Mt,Lt);var vt=Lt.keys;for(bt=0;bt<vt.length;bt++)At.writeStringField(3,vt[bt]);var Qt=Lt.values;for(bt=0;bt<Qt.length;bt++)At.writeMessage(4,Ue,Qt[bt])}function Mt(at,At){var bt=at.feature;bt.id!==void 0&&At.writeVarintField(1,bt.id),At.writeMessage(2,ct,at),At.writeVarintField(3,bt.type),At.writeMessage(4,Ne,bt)}function ct(at,At){var bt=at.feature,Lt=at.keys,vt=at.values,Qt=at.keycache,Jt=at.valuecache;for(var St in bt.properties){var jt=Qt[St];jt===void 0&&(Lt.push(St),Qt[St]=jt=Lt.length-1),At.writeVarint(jt);var ce=bt.properties[St],je=typeof ce;je!=="string"&&je!=="boolean"&&je!=="number"&&(ce=JSON.stringify(ce));var Ge=je+":"+ce,Pe=Jt[Ge];Pe===void 0&&(vt.push(ce),Jt[Ge]=Pe=vt.length-1),At.writeVarint(Pe)}}function gt(at,At){return(At<<3)+(7&at)}function ee(at){return at<<1^at>>31}function Ne(at,At){for(var bt=at.loadGeometry(),Lt=at.type,vt=0,Qt=0,Jt=bt.length,St=0;St<Jt;St++){var jt=bt[St],ce=1;Lt===1&&(ce=jt.length),At.writeVarint(gt(1,ce));for(var je=Lt===3?jt.length-1:jt.length,Ge=0;Ge<je;Ge++){Ge===1&&Lt!==1&&At.writeVarint(gt(2,je-1));var Pe=jt[Ge].x-vt,We=jt[Ge].y-Qt;At.writeVarint(ee(Pe)),At.writeVarint(ee(We)),vt+=Pe,Qt+=We}Lt===3&&At.writeVarint(gt(7,1))}}function Ue(at,At){var bt=typeof at;bt==="string"?At.writeStringField(1,at):bt==="boolean"?At.writeBooleanField(7,at):bt==="number"&&(at%1!=0?At.writeDoubleField(3,at):at<0?At.writeSVarintField(6,at):At.writeVarintField(5,at))}function sr(at,At,bt,Lt){gr(at,bt,Lt),gr(At,2*bt,2*Lt),gr(At,2*bt+1,2*Lt+1)}function gr(at,At,bt){var Lt=at[At];at[At]=at[bt],at[bt]=Lt}function Xr(at,At,bt,Lt){var vt=at-bt,Qt=At-Lt;return vt*vt+Qt*Qt}ot.fromVectorTileJs=G,ot.fromGeojsonVt=function(at,At){At=At||{};var bt={};for(var Lt in at)bt[Lt]=new et(at[Lt].features,At),bt[Lt].name=Lt,bt[Lt].version=At.version,bt[Lt].extent=At.extent;return G({layers:bt})},ot.GeoJSONWrapper=J;var ir=function(at){return at[0]},on=function(at){return at[1]},Xe=function(at,At,bt,Lt,vt){At===void 0&&(At=ir),bt===void 0&&(bt=on),Lt===void 0&&(Lt=64),vt===void 0&&(vt=Float64Array),this.nodeSize=Lt,this.points=at;for(var Qt=at.length<65536?Uint16Array:Uint32Array,Jt=this.ids=new Qt(at.length),St=this.coords=new vt(2*at.length),jt=0;jt<at.length;jt++)Jt[jt]=jt,St[2*jt]=At(at[jt]),St[2*jt+1]=bt(at[jt]);(function ce(je,Ge,Pe,We,Rr,Cr){if(!(Rr-We<=Pe)){var Re=We+Rr>>1;(function yr(tr,cr,wn,fr,On,Ci){for(;On>fr;){if(On-fr>600){var Bn=On-fr+1,Zn=wn-fr+1,Yn=Math.log(Bn),Ns=.5*Math.exp(2*Yn/3),di=.5*Math.sqrt(Yn*Ns*(Bn-Ns)/Bn)*(Zn-Bn/2<0?-1:1);yr(tr,cr,wn,Math.max(fr,Math.floor(wn-Zn*Ns/Bn+di)),Math.min(On,Math.floor(wn+(Bn-Zn)*Ns/Bn+di)),Ci)}var yo=cr[2*wn+Ci],Pi=fr,Dn=On;for(sr(tr,cr,fr,wn),cr[2*On+Ci]>yo&&sr(tr,cr,fr,On);Pi<Dn;){for(sr(tr,cr,Pi,Dn),Pi++,Dn--;cr[2*Pi+Ci]<yo;)Pi++;for(;cr[2*Dn+Ci]>yo;)Dn--}cr[2*fr+Ci]===yo?sr(tr,cr,fr,Dn):sr(tr,cr,++Dn,On),Dn<=wn&&(fr=Dn+1),wn<=Dn&&(On=Dn-1)}})(je,Ge,Re,We,Rr,Cr%2),ce(je,Ge,Pe,We,Re-1,Cr+1),ce(je,Ge,Pe,Re+1,Rr,Cr+1)}})(Jt,St,Lt,0,Jt.length-1,0)};Xe.prototype.range=function(at,At,bt,Lt){return function(vt,Qt,Jt,St,jt,ce,je){for(var Ge,Pe,We=[0,vt.length-1,0],Rr=[];We.length;){var Cr=We.pop(),Re=We.pop(),yr=We.pop();if(Re-yr<=je)for(var tr=yr;tr<=Re;tr++)Pe=Qt[2*tr+1],(Ge=Qt[2*tr])>=Jt&&Ge<=jt&&Pe>=St&&Pe<=ce&&Rr.push(vt[tr]);else{var cr=Math.floor((yr+Re)/2);Pe=Qt[2*cr+1],(Ge=Qt[2*cr])>=Jt&&Ge<=jt&&Pe>=St&&Pe<=ce&&Rr.push(vt[cr]);var wn=(Cr+1)%2;(Cr===0?Jt<=Ge:St<=Pe)&&(We.push(yr),We.push(cr-1),We.push(wn)),(Cr===0?jt>=Ge:ce>=Pe)&&(We.push(cr+1),We.push(Re),We.push(wn))}}return Rr}(this.ids,this.coords,at,At,bt,Lt,this.nodeSize)},Xe.prototype.within=function(at,At,bt){return function(Lt,vt,Qt,Jt,St,jt){for(var ce=[0,Lt.length-1,0],je=[],Ge=St*St;ce.length;){var Pe=ce.pop(),We=ce.pop(),Rr=ce.pop();if(We-Rr<=jt)for(var Cr=Rr;Cr<=We;Cr++)Xr(vt[2*Cr],vt[2*Cr+1],Qt,Jt)<=Ge&&je.push(Lt[Cr]);else{var Re=Math.floor((Rr+We)/2),yr=vt[2*Re],tr=vt[2*Re+1];Xr(yr,tr,Qt,Jt)<=Ge&&je.push(Lt[Re]);var cr=(Pe+1)%2;(Pe===0?Qt-St<=yr:Jt-St<=tr)&&(ce.push(Rr),ce.push(Re-1),ce.push(cr)),(Pe===0?Qt+St>=yr:Jt+St>=tr)&&(ce.push(Re+1),ce.push(We),ce.push(cr))}}return je}(this.ids,this.coords,at,At,bt,this.nodeSize)};var He={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(at){return at}},_n=function(at){this.options=Jr(Object.create(He),at),this.trees=new Array(this.options.maxZoom+1)};function dt(at,At,bt,Lt,vt){return{x:at,y:At,zoom:1/0,id:bt,parentId:-1,numPoints:Lt,properties:vt}}function wt(at,At){var bt=at.geometry.coordinates,Lt=bt[1];return{x:Le(bt[0]),y:Ee(Lt),zoom:1/0,index:At,parentId:-1}}function Ht(at){return{type:"Feature",id:at.id,properties:ue(at),geometry:{type:"Point",coordinates:[(Lt=at.x,360*(Lt-.5)),(At=at.y,bt=(180-360*At)*Math.PI/180,360*Math.atan(Math.exp(bt))/Math.PI-90)]}};var At,bt,Lt}function ue(at){var At=at.numPoints,bt=At>=1e4?Math.round(At/1e3)+"k":At>=1e3?Math.round(At/100)/10+"k":At;return Jr(Jr({},at.properties),{cluster:!0,cluster_id:at.id,point_count:At,point_count_abbreviated:bt})}function Le(at){return at/360+.5}function Ee(at){var At=Math.sin(at*Math.PI/180),bt=.5-.25*Math.log((1+At)/(1-At))/Math.PI;return bt<0?0:bt>1?1:bt}function Jr(at,At){for(var bt in At)at[bt]=At[bt];return at}function bn(at){return at.x}function ai(at){return at.y}function qo(at,At,bt,Lt,vt,Qt){var Jt=vt-bt,St=Qt-Lt;if(Jt!==0||St!==0){var jt=((at-bt)*Jt+(At-Lt)*St)/(Jt*Jt+St*St);jt>1?(bt=vt,Lt=Qt):jt>0&&(bt+=Jt*jt,Lt+=St*jt)}return(Jt=at-bt)*Jt+(St=At-Lt)*St}function _i(at,At,bt,Lt){var vt={id:at===void 0?null:at,type:At,geometry:bt,tags:Lt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Qt){var Jt=Qt.geometry,St=Qt.type;if(St==="Point"||St==="MultiPoint"||St==="LineString")Xn(Qt,Jt);else if(St==="Polygon"||St==="MultiLineString")for(var jt=0;jt<Jt.length;jt++)Xn(Qt,Jt[jt]);else if(St==="MultiPolygon")for(jt=0;jt<Jt.length;jt++)for(var ce=0;ce<Jt[jt].length;ce++)Xn(Qt,Jt[jt][ce])}(vt),vt}function Xn(at,At){for(var bt=0;bt<At.length;bt+=3)at.minX=Math.min(at.minX,At[bt]),at.minY=Math.min(at.minY,At[bt+1]),at.maxX=Math.max(at.maxX,At[bt]),at.maxY=Math.max(at.maxY,At[bt+1])}function Ui(at,At,bt,Lt){if(At.geometry){var vt=At.geometry.coordinates,Qt=At.geometry.type,Jt=Math.pow(bt.tolerance/((1<<bt.maxZoom)*bt.extent),2),St=[],jt=At.id;if(bt.promoteId?jt=At.properties[bt.promoteId]:bt.generateId&&(jt=Lt||0),Qt==="Point")bs(vt,St);else if(Qt==="MultiPoint")for(var ce=0;ce<vt.length;ce++)bs(vt[ce],St);else if(Qt==="LineString")Vi(vt,St,Jt,!1);else if(Qt==="MultiLineString"){if(bt.lineMetrics){for(ce=0;ce<vt.length;ce++)Vi(vt[ce],St=[],Jt,!1),at.push(_i(jt,"LineString",St,At.properties));return}Cn(vt,St,Jt,!1)}else if(Qt==="Polygon")Cn(vt,St,Jt,!0);else{if(Qt!=="MultiPolygon"){if(Qt==="GeometryCollection"){for(ce=0;ce<At.geometry.geometries.length;ce++)Ui(at,{id:jt,geometry:At.geometry.geometries[ce],properties:At.properties},bt,Lt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ce=0;ce<vt.length;ce++){var je=[];Cn(vt[ce],je,Jt,!0),St.push(je)}}at.push(_i(jt,Qt,St,At.properties))}}function bs(at,At){At.push(yi(at[0])),At.push(_o(at[1])),At.push(0)}function Vi(at,At,bt,Lt){for(var vt,Qt,Jt=0,St=0;St<at.length;St++){var jt=yi(at[St][0]),ce=_o(at[St][1]);At.push(jt),At.push(ce),At.push(0),St>0&&(Jt+=Lt?(vt*ce-jt*Qt)/2:Math.sqrt(Math.pow(jt-vt,2)+Math.pow(ce-Qt,2))),vt=jt,Qt=ce}var je=At.length-3;At[2]=1,function Ge(Pe,We,Rr,Cr){for(var Re,yr=Cr,tr=Rr-We>>1,cr=Rr-We,wn=Pe[We],fr=Pe[We+1],On=Pe[Rr],Ci=Pe[Rr+1],Bn=We+3;Bn<Rr;Bn+=3){var Zn=qo(Pe[Bn],Pe[Bn+1],wn,fr,On,Ci);if(Zn>yr)Re=Bn,yr=Zn;else if(Zn===yr){var Yn=Math.abs(Bn-tr);Yn<cr&&(Re=Bn,cr=Yn)}}yr>Cr&&(Re-We>3&&Ge(Pe,We,Re,Cr),Pe[Re+2]=yr,Rr-Re>3&&Ge(Pe,Re,Rr,Cr))}(At,0,je,bt),At[je+2]=1,At.size=Math.abs(Jt),At.start=0,At.end=At.size}function Cn(at,At,bt,Lt){for(var vt=0;vt<at.length;vt++){var Qt=[];Vi(at[vt],Qt,bt,Lt),At.push(Qt)}}function yi(at){return at/360+.5}function _o(at){var At=Math.sin(at*Math.PI/180),bt=.5-.25*Math.log((1+At)/(1-At))/Math.PI;return bt<0?0:bt>1?1:bt}function Nr(at,At,bt,Lt,vt,Qt,Jt,St){if(Lt/=At,Qt>=(bt/=At)&&Jt<Lt)return at;if(Jt<bt||Qt>=Lt)return null;for(var jt=[],ce=0;ce<at.length;ce++){var je=at[ce],Ge=je.geometry,Pe=je.type,We=vt===0?je.minX:je.minY,Rr=vt===0?je.maxX:je.maxY;if(We>=bt&&Rr<Lt)jt.push(je);else if(!(Rr<bt||We>=Lt)){var Cr=[];if(Pe==="Point"||Pe==="MultiPoint")ar(Ge,Cr,bt,Lt,vt);else if(Pe==="LineString")zr(Ge,Cr,bt,Lt,vt,!1,St.lineMetrics);else if(Pe==="MultiLineString")ho(Ge,Cr,bt,Lt,vt,!1);else if(Pe==="Polygon")ho(Ge,Cr,bt,Lt,vt,!0);else if(Pe==="MultiPolygon")for(var Re=0;Re<Ge.length;Re++){var yr=[];ho(Ge[Re],yr,bt,Lt,vt,!0),yr.length&&Cr.push(yr)}if(Cr.length){if(St.lineMetrics&&Pe==="LineString"){for(Re=0;Re<Cr.length;Re++)jt.push(_i(je.id,Pe,Cr[Re],je.tags));continue}Pe!=="LineString"&&Pe!=="MultiLineString"||(Cr.length===1?(Pe="LineString",Cr=Cr[0]):Pe="MultiLineString"),Pe!=="Point"&&Pe!=="MultiPoint"||(Pe=Cr.length===3?"Point":"MultiPoint"),jt.push(_i(je.id,Pe,Cr,je.tags))}}}return jt.length?jt:null}function ar(at,At,bt,Lt,vt){for(var Qt=0;Qt<at.length;Qt+=3){var Jt=at[Qt+vt];Jt>=bt&&Jt<=Lt&&(At.push(at[Qt]),At.push(at[Qt+1]),At.push(at[Qt+2]))}}function zr(at,At,bt,Lt,vt,Qt,Jt){for(var St,jt,ce=hn(at),je=vt===0?ds:es,Ge=at.start,Pe=0;Pe<at.length-3;Pe+=3){var We=at[Pe],Rr=at[Pe+1],Cr=at[Pe+2],Re=at[Pe+3],yr=at[Pe+4],tr=vt===0?We:Rr,cr=vt===0?Re:yr,wn=!1;Jt&&(St=Math.sqrt(Math.pow(We-Re,2)+Math.pow(Rr-yr,2))),tr<bt?cr>bt&&(jt=je(ce,We,Rr,Re,yr,bt),Jt&&(ce.start=Ge+St*jt)):tr>Lt?cr<Lt&&(jt=je(ce,We,Rr,Re,yr,Lt),Jt&&(ce.start=Ge+St*jt)):ki(ce,We,Rr,Cr),cr<bt&&tr>=bt&&(jt=je(ce,We,Rr,Re,yr,bt),wn=!0),cr>Lt&&tr<=Lt&&(jt=je(ce,We,Rr,Re,yr,Lt),wn=!0),!Qt&&wn&&(Jt&&(ce.end=Ge+St*jt),At.push(ce),ce=hn(at)),Jt&&(Ge+=St)}var fr=at.length-3;We=at[fr],Rr=at[fr+1],Cr=at[fr+2],(tr=vt===0?We:Rr)>=bt&&tr<=Lt&&ki(ce,We,Rr,Cr),fr=ce.length-3,Qt&&fr>=3&&(ce[fr]!==ce[0]||ce[fr+1]!==ce[1])&&ki(ce,ce[0],ce[1],ce[2]),ce.length&&At.push(ce)}function hn(at){var At=[];return At.size=at.size,At.start=at.start,At.end=at.end,At}function ho(at,At,bt,Lt,vt,Qt){for(var Jt=0;Jt<at.length;Jt++)zr(at[Jt],At,bt,Lt,vt,Qt,!1)}function ki(at,At,bt,Lt){at.push(At),at.push(bt),at.push(Lt)}function ds(at,At,bt,Lt,vt,Qt){var Jt=(Qt-At)/(Lt-At);return at.push(Qt),at.push(bt+(vt-bt)*Jt),at.push(1),Jt}function es(at,At,bt,Lt,vt,Qt){var Jt=(Qt-bt)/(vt-bt);return at.push(At+(Lt-At)*Jt),at.push(Qt),at.push(1),Jt}function rs(at,At){for(var bt=[],Lt=0;Lt<at.length;Lt++){var vt,Qt=at[Lt],Jt=Qt.type;if(Jt==="Point"||Jt==="MultiPoint"||Jt==="LineString")vt=No(Qt.geometry,At);else if(Jt==="MultiLineString"||Jt==="Polygon"){vt=[];for(var St=0;St<Qt.geometry.length;St++)vt.push(No(Qt.geometry[St],At))}else if(Jt==="MultiPolygon")for(vt=[],St=0;St<Qt.geometry.length;St++){for(var jt=[],ce=0;ce<Qt.geometry[St].length;ce++)jt.push(No(Qt.geometry[St][ce],At));vt.push(jt)}bt.push(_i(Qt.id,Jt,vt,Qt.tags))}return bt}function No(at,At){var bt=[];bt.size=at.size,at.start!==void 0&&(bt.start=at.start,bt.end=at.end);for(var Lt=0;Lt<at.length;Lt+=3)bt.push(at[Lt]+At,at[Lt+1],at[Lt+2]);return bt}function ha(at,At){if(at.transformed)return at;var bt,Lt,vt,Qt=1<<at.z,Jt=at.x,St=at.y;for(bt=0;bt<at.features.length;bt++){var jt=at.features[bt],ce=jt.geometry,je=jt.type;if(jt.geometry=[],je===1)for(Lt=0;Lt<ce.length;Lt+=2)jt.geometry.push(ch(ce[Lt],ce[Lt+1],At,Qt,Jt,St));else for(Lt=0;Lt<ce.length;Lt++){var Ge=[];for(vt=0;vt<ce[Lt].length;vt+=2)Ge.push(ch(ce[Lt][vt],ce[Lt][vt+1],At,Qt,Jt,St));jt.geometry.push(Ge)}}return at.transformed=!0,at}function ch(at,At,bt,Lt,vt,Qt){return[Math.round(bt*(at*Lt-vt)),Math.round(bt*(At*Lt-Qt))]}function Xl(at,At,bt,Lt,vt){for(var Qt=At===vt.maxZoom?0:vt.tolerance/((1<<At)*vt.extent),Jt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:bt,y:Lt,z:At,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},St=0;St<at.length;St++){Jt.numFeatures++,vu(Jt,at[St],Qt,vt);var jt=at[St].minX,ce=at[St].minY,je=at[St].maxX,Ge=at[St].maxY;jt<Jt.minX&&(Jt.minX=jt),ce<Jt.minY&&(Jt.minY=ce),je>Jt.maxX&&(Jt.maxX=je),Ge>Jt.maxY&&(Jt.maxY=Ge)}return Jt}function vu(at,At,bt,Lt){var vt=At.geometry,Qt=At.type,Jt=[];if(Qt==="Point"||Qt==="MultiPoint")for(var St=0;St<vt.length;St+=3)Jt.push(vt[St]),Jt.push(vt[St+1]),at.numPoints++,at.numSimplified++;else if(Qt==="LineString")wl(Jt,vt,at,bt,!1,!1);else if(Qt==="MultiLineString"||Qt==="Polygon")for(St=0;St<vt.length;St++)wl(Jt,vt[St],at,bt,Qt==="Polygon",St===0);else if(Qt==="MultiPolygon")for(var jt=0;jt<vt.length;jt++){var ce=vt[jt];for(St=0;St<ce.length;St++)wl(Jt,ce[St],at,bt,!0,St===0)}if(Jt.length){var je=At.tags||null;if(Qt==="LineString"&&Lt.lineMetrics){for(var Ge in je={},At.tags)je[Ge]=At.tags[Ge];je.mapbox_clip_start=vt.start/vt.size,je.mapbox_clip_end=vt.end/vt.size}var Pe={geometry:Jt,type:Qt==="Polygon"||Qt==="MultiPolygon"?3:Qt==="LineString"||Qt==="MultiLineString"?2:1,tags:je};At.id!==null&&(Pe.id=At.id),at.features.push(Pe)}}function wl(at,At,bt,Lt,vt,Qt){var Jt=Lt*Lt;if(Lt>0&&At.size<(vt?Jt:Lt))bt.numPoints+=At.length/3;else{for(var St=[],jt=0;jt<At.length;jt+=3)(Lt===0||At[jt+2]>Jt)&&(bt.numSimplified++,St.push(At[jt]),St.push(At[jt+1])),bt.numPoints++;vt&&function(ce,je){for(var Ge=0,Pe=0,We=ce.length,Rr=We-2;Pe<We;Rr=Pe,Pe+=2)Ge+=(ce[Pe]-ce[Rr])*(ce[Pe+1]+ce[Rr+1]);if(Ge>0===je)for(Pe=0,We=ce.length;Pe<We/2;Pe+=2){var Cr=ce[Pe],Re=ce[Pe+1];ce[Pe]=ce[We-2-Pe],ce[Pe+1]=ce[We-1-Pe],ce[We-2-Pe]=Cr,ce[We-1-Pe]=Re}}(St,Qt),at.push(St)}}function el(at,At){var bt=(At=this.options=function(vt,Qt){for(var Jt in Qt)vt[Jt]=Qt[Jt];return vt}(Object.create(this.options),At)).debug;if(bt&&console.time("preprocess data"),At.maxZoom<0||At.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(At.promoteId&&At.generateId)throw new Error("promoteId and generateId cannot be used together.");var Lt=function(vt,Qt){var Jt=[];if(vt.type==="FeatureCollection")for(var St=0;St<vt.features.length;St++)Ui(Jt,vt.features[St],Qt,St);else Ui(Jt,vt.type==="Feature"?vt:{geometry:vt},Qt);return Jt}(at,At);this.tiles={},this.tileCoords=[],bt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",At.indexMaxZoom,At.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Lt=function(vt,Qt){var Jt=Qt.buffer/Qt.extent,St=vt,jt=Nr(vt,1,-1-Jt,Jt,0,-1,2,Qt),ce=Nr(vt,1,1-Jt,2+Jt,0,-1,2,Qt);return(jt||ce)&&(St=Nr(vt,1,-Jt,1+Jt,0,-1,2,Qt)||[],jt&&(St=rs(jt,1).concat(St)),ce&&(St=St.concat(rs(ce,-1)))),St}(Lt,At)).length&&this.splitTile(Lt,0,0,0),bt&&(Lt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function fa(at,At,bt){return 32*((1<<at)*bt+At)+at}function hc(at,At){var bt=at.tileID.canonical;if(!this._geoJSONIndex)return At(null,null);var Lt=this._geoJSONIndex.getTile(bt.z,bt.x,bt.y);if(!Lt)return At(null,null);var vt=new q(Lt.features),Qt=ot(vt);Qt.byteOffset===0&&Qt.byteLength===Qt.buffer.byteLength||(Qt=new Uint8Array(Qt)),At(null,{vectorTile:vt,rawData:Qt.buffer})}_n.prototype.load=function(at){var At=this.options,bt=At.log,Lt=At.minZoom,vt=At.maxZoom,Qt=At.nodeSize;bt&&console.time("total time");var Jt="prepare "+at.length+" points";bt&&console.time(Jt),this.points=at;for(var St=[],jt=0;jt<at.length;jt++)at[jt].geometry&&St.push(wt(at[jt],jt));this.trees[vt+1]=new Xe(St,bn,ai,Qt,Float32Array),bt&&console.timeEnd(Jt);for(var ce=vt;ce>=Lt;ce--){var je=+Date.now();St=this._cluster(St,ce),this.trees[ce]=new Xe(St,bn,ai,Qt,Float32Array),bt&&console.log("z%d: %d clusters in %dms",ce,St.length,+Date.now()-je)}return bt&&console.timeEnd("total time"),this},_n.prototype.getClusters=function(at,At){var bt=((at[0]+180)%360+360)%360-180,Lt=Math.max(-90,Math.min(90,at[1])),vt=at[2]===180?180:((at[2]+180)%360+360)%360-180,Qt=Math.max(-90,Math.min(90,at[3]));if(at[2]-at[0]>=360)bt=-180,vt=180;else if(bt>vt){var Jt=this.getClusters([bt,Lt,180,Qt],At),St=this.getClusters([-180,Lt,vt,Qt],At);return Jt.concat(St)}for(var jt=this.trees[this._limitZoom(At)],ce=[],je=0,Ge=jt.range(Le(bt),Ee(Qt),Le(vt),Ee(Lt));je<Ge.length;je+=1){var Pe=jt.points[Ge[je]];ce.push(Pe.numPoints?Ht(Pe):this.points[Pe.index])}return ce},_n.prototype.getChildren=function(at){var At=this._getOriginId(at),bt=this._getOriginZoom(at),Lt="No cluster with the specified id.",vt=this.trees[bt];if(!vt)throw new Error(Lt);var Qt=vt.points[At];if(!Qt)throw new Error(Lt);for(var Jt=this.options.radius/(this.options.extent*Math.pow(2,bt-1)),St=[],jt=0,ce=vt.within(Qt.x,Qt.y,Jt);jt<ce.length;jt+=1){var je=vt.points[ce[jt]];je.parentId===at&&St.push(je.numPoints?Ht(je):this.points[je.index])}if(St.length===0)throw new Error(Lt);return St},_n.prototype.getLeaves=function(at,At,bt){var Lt=[];return this._appendLeaves(Lt,at,At=At||10,bt=bt||0,0),Lt},_n.prototype.getTile=function(at,At,bt){var Lt=this.trees[this._limitZoom(at)],vt=Math.pow(2,at),Qt=this.options,Jt=Qt.radius/Qt.extent,St=(bt-Jt)/vt,jt=(bt+1+Jt)/vt,ce={features:[]};return this._addTileFeatures(Lt.range((At-Jt)/vt,St,(At+1+Jt)/vt,jt),Lt.points,At,bt,vt,ce),At===0&&this._addTileFeatures(Lt.range(1-Jt/vt,St,1,jt),Lt.points,vt,bt,vt,ce),At===vt-1&&this._addTileFeatures(Lt.range(0,St,Jt/vt,jt),Lt.points,-1,bt,vt,ce),ce.features.length?ce:null},_n.prototype.getClusterExpansionZoom=function(at){for(var At=this._getOriginZoom(at)-1;At<=this.options.maxZoom;){var bt=this.getChildren(at);if(At++,bt.length!==1)break;at=bt[0].properties.cluster_id}return At},_n.prototype._appendLeaves=function(at,At,bt,Lt,vt){for(var Qt=0,Jt=this.getChildren(At);Qt<Jt.length;Qt+=1){var St=Jt[Qt],jt=St.properties;if(jt&&jt.cluster?vt+jt.point_count<=Lt?vt+=jt.point_count:vt=this._appendLeaves(at,jt.cluster_id,bt,Lt,vt):vt<Lt?vt++:at.push(St),at.length===bt)break}return vt},_n.prototype._addTileFeatures=function(at,At,bt,Lt,vt,Qt){for(var Jt=0,St=at;Jt<St.length;Jt+=1){var jt=At[St[Jt]],ce=jt.numPoints,je={type:1,geometry:[[Math.round(this.options.extent*(jt.x*vt-bt)),Math.round(this.options.extent*(jt.y*vt-Lt))]],tags:ce?ue(jt):this.points[jt.index].properties},Ge=void 0;ce?Ge=jt.id:this.options.generateId?Ge=jt.index:this.points[jt.index].id&&(Ge=this.points[jt.index].id),Ge!==void 0&&(je.id=Ge),Qt.features.push(je)}},_n.prototype._limitZoom=function(at){return Math.max(this.options.minZoom,Math.min(+at,this.options.maxZoom+1))},_n.prototype._cluster=function(at,At){for(var bt=[],Lt=this.options,vt=Lt.reduce,Qt=Lt.minPoints,Jt=Lt.radius/(Lt.extent*Math.pow(2,At)),St=0;St<at.length;St++){var jt=at[St];if(!(jt.zoom<=At)){jt.zoom=At;for(var ce=this.trees[At+1],je=ce.within(jt.x,jt.y,Jt),Ge=jt.numPoints||1,Pe=Ge,We=0,Rr=je;We<Rr.length;We+=1){var Cr=ce.points[Rr[We]];Cr.zoom>At&&(Pe+=Cr.numPoints||1)}if(Pe>=Qt){for(var Re=jt.x*Ge,yr=jt.y*Ge,tr=vt&&Ge>1?this._map(jt,!0):null,cr=(St<<5)+(At+1)+this.points.length,wn=0,fr=je;wn<fr.length;wn+=1){var On=ce.points[fr[wn]];if(!(On.zoom<=At)){On.zoom=At;var Ci=On.numPoints||1;Re+=On.x*Ci,yr+=On.y*Ci,On.parentId=cr,vt&&(tr||(tr=this._map(jt,!0)),vt(tr,this._map(On)))}}jt.parentId=cr,bt.push(dt(Re/Pe,yr/Pe,cr,Pe,tr))}else if(bt.push(jt),Pe>1)for(var Bn=0,Zn=je;Bn<Zn.length;Bn+=1){var Yn=ce.points[Zn[Bn]];Yn.zoom<=At||(Yn.zoom=At,bt.push(Yn))}}}return bt},_n.prototype._getOriginId=function(at){return at-this.points.length>>5},_n.prototype._getOriginZoom=function(at){return(at-this.points.length)%32},_n.prototype._map=function(at,At){if(at.numPoints)return At?Jr({},at.properties):at.properties;var bt=this.points[at.index].properties,Lt=this.options.map(bt);return At&&Lt===bt?Jr({},Lt):Lt},el.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},el.prototype.splitTile=function(at,At,bt,Lt,vt,Qt,Jt){for(var St=[at,At,bt,Lt],jt=this.options,ce=jt.debug;St.length;){Lt=St.pop(),bt=St.pop(),At=St.pop(),at=St.pop();var je=1<<At,Ge=fa(At,bt,Lt),Pe=this.tiles[Ge];if(!Pe&&(ce>1&&console.time("creation"),Pe=this.tiles[Ge]=Xl(at,At,bt,Lt,jt),this.tileCoords.push({z:At,x:bt,y:Lt}),ce)){ce>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",At,bt,Lt,Pe.numFeatures,Pe.numPoints,Pe.numSimplified),console.timeEnd("creation"));var We="z"+At;this.stats[We]=(this.stats[We]||0)+1,this.total++}if(Pe.source=at,vt){if(At===jt.maxZoom||At===vt)continue;var Rr=1<<vt-At;if(bt!==Math.floor(Qt/Rr)||Lt!==Math.floor(Jt/Rr))continue}else if(At===jt.indexMaxZoom||Pe.numPoints<=jt.indexMaxPoints)continue;if(Pe.source=null,at.length!==0){ce>1&&console.time("clipping");var Cr,Re,yr,tr,cr,wn,fr=.5*jt.buffer/jt.extent,On=.5-fr,Ci=.5+fr,Bn=1+fr;Cr=Re=yr=tr=null,cr=Nr(at,je,bt-fr,bt+Ci,0,Pe.minX,Pe.maxX,jt),wn=Nr(at,je,bt+On,bt+Bn,0,Pe.minX,Pe.maxX,jt),at=null,cr&&(Cr=Nr(cr,je,Lt-fr,Lt+Ci,1,Pe.minY,Pe.maxY,jt),Re=Nr(cr,je,Lt+On,Lt+Bn,1,Pe.minY,Pe.maxY,jt),cr=null),wn&&(yr=Nr(wn,je,Lt-fr,Lt+Ci,1,Pe.minY,Pe.maxY,jt),tr=Nr(wn,je,Lt+On,Lt+Bn,1,Pe.minY,Pe.maxY,jt),wn=null),ce>1&&console.timeEnd("clipping"),St.push(Cr||[],At+1,2*bt,2*Lt),St.push(Re||[],At+1,2*bt,2*Lt+1),St.push(yr||[],At+1,2*bt+1,2*Lt),St.push(tr||[],At+1,2*bt+1,2*Lt+1)}}},el.prototype.getTile=function(at,At,bt){var Lt=this.options,vt=Lt.extent,Qt=Lt.debug;if(at<0||at>24)return null;var Jt=1<<at,St=fa(at,At=(At%Jt+Jt)%Jt,bt);if(this.tiles[St])return ha(this.tiles[St],vt);Qt>1&&console.log("drilling down to z%d-%d-%d",at,At,bt);for(var jt,ce=at,je=At,Ge=bt;!jt&&ce>0;)ce--,je=Math.floor(je/2),Ge=Math.floor(Ge/2),jt=this.tiles[fa(ce,je,Ge)];return jt&&jt.source?(Qt>1&&console.log("found parent tile z%d-%d-%d",ce,je,Ge),Qt>1&&console.time("drilling down"),this.splitTile(jt.source,ce,je,Ge,at,At,bt),Qt>1&&console.timeEnd("drilling down"),this.tiles[St]?ha(this.tiles[St],vt):null):null};var bu=function(at){function At(bt,Lt,vt,Qt){at.call(this,bt,Lt,vt,hc),Qt&&(this.loadGeoJSON=Qt)}return at&&(At.__proto__=at),(At.prototype=Object.create(at&&at.prototype)).constructor=At,At.prototype.loadData=function(bt,Lt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Lt,this._pendingLoadDataParams=bt,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},At.prototype._loadData=function(){var bt=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Lt=this._pendingCallback,vt=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Qt=!!(vt&&vt.request&&vt.request.collectResourceTiming)&&new i.RequestPerformance(vt.request);this.loadGeoJSON(vt,function(Jt,St){if(Jt||!St)return Lt(Jt);if(typeof St!="object")return Lt(new Error("Input data given to '"+vt.source+"' is not a valid GeoJSON object."));(function Pe(We,Rr){var Cr,Re=We&&We.type;if(Re==="FeatureCollection")for(Cr=0;Cr<We.features.length;Cr++)Pe(We.features[Cr],Rr);else if(Re==="GeometryCollection")for(Cr=0;Cr<We.geometries.length;Cr++)Pe(We.geometries[Cr],Rr);else if(Re==="Feature")Pe(We.geometry,Rr);else if(Re==="Polygon")B(We.coordinates,Rr);else if(Re==="MultiPolygon")for(Cr=0;Cr<We.coordinates.length;Cr++)B(We.coordinates[Cr],Rr);return We})(St,!0);try{if(vt.filter){var jt=i.createExpression(vt.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(jt.result==="error")throw new Error(jt.value.map(function(Pe){return Pe.key+": "+Pe.message}).join(", "));var ce=St.features.filter(function(Pe){return jt.value.evaluate({zoom:0},Pe)});St={type:"FeatureCollection",features:ce}}bt._geoJSONIndex=vt.cluster?new _n(function(Pe){var We=Pe.superclusterOptions,Rr=Pe.clusterProperties;if(!Rr||!We)return We;for(var Cr={},Re={},yr={accumulated:null,zoom:0},tr={properties:null},cr=Object.keys(Rr),wn=0,fr=cr;wn<fr.length;wn+=1){var On=fr[wn],Ci=Rr[On],Bn=Ci[0],Zn=i.createExpression(Ci[1]),Yn=i.createExpression(typeof Bn=="string"?[Bn,["accumulated"],["get",On]]:Bn);Cr[On]=Zn.value,Re[On]=Yn.value}return We.map=function(Ns){tr.properties=Ns;for(var di={},yo=0,Pi=cr;yo<Pi.length;yo+=1){var Dn=Pi[yo];di[Dn]=Cr[Dn].evaluate(yr,tr)}return di},We.reduce=function(Ns,di){tr.properties=di;for(var yo=0,Pi=cr;yo<Pi.length;yo+=1){var Dn=Pi[yo];yr.accumulated=Ns[Dn],Ns[Dn]=Re[Dn].evaluate(yr,tr)}},We}(vt)).load(St.features):function(Pe,We){return new el(Pe,We)}(St,vt.geojsonVtOptions)}catch(Pe){return Lt(Pe)}bt.loaded={};var je={};if(Qt){var Ge=Qt.finish();Ge&&(je.resourceTiming={},je.resourceTiming[vt.source]=JSON.parse(JSON.stringify(Ge)))}Lt(null,je)})}},At.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},At.prototype.reloadTile=function(bt,Lt){var vt=this.loaded;return vt&&vt[bt.uid]?at.prototype.reloadTile.call(this,bt,Lt):this.loadTile(bt,Lt)},At.prototype.loadGeoJSON=function(bt,Lt){if(bt.request)i.getJSON(bt.request,Lt);else{if(typeof bt.data!="string")return Lt(new Error("Input data given to '"+bt.source+"' is not a valid GeoJSON object."));try{return Lt(null,JSON.parse(bt.data))}catch{return Lt(new Error("Input data given to '"+bt.source+"' is not a valid GeoJSON object."))}}},At.prototype.removeSource=function(bt,Lt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Lt()},At.prototype.getClusterExpansionZoom=function(bt,Lt){try{Lt(null,this._geoJSONIndex.getClusterExpansionZoom(bt.clusterId))}catch(vt){Lt(vt)}},At.prototype.getClusterChildren=function(bt,Lt){try{Lt(null,this._geoJSONIndex.getChildren(bt.clusterId))}catch(vt){Lt(vt)}},At.prototype.getClusterLeaves=function(bt,Lt){try{Lt(null,this._geoJSONIndex.getLeaves(bt.clusterId,bt.limit,bt.offset))}catch(vt){Lt(vt)}},At}(w),fo=function(at){var At=this;this.self=at,this.actor=new i.Actor(at,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:w,geojson:bu},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(bt,Lt){if(At.workerSourceTypes[bt])throw new Error('Worker source with name "'+bt+'" already registered.');At.workerSourceTypes[bt]=Lt},this.self.registerRTLTextPlugin=function(bt){if(i.plugin.isParsed())throw new Error("RTL text plugin already registered.");i.plugin.applyArabicShaping=bt.applyArabicShaping,i.plugin.processBidirectionalText=bt.processBidirectionalText,i.plugin.processStyledBidirectionalText=bt.processStyledBidirectionalText}};return fo.prototype.setReferrer=function(at,At){this.referrer=At},fo.prototype.setImages=function(at,At,bt){for(var Lt in this.availableImages[at]=At,this.workerSources[at]){var vt=this.workerSources[at][Lt];for(var Qt in vt)vt[Qt].availableImages=At}bt()},fo.prototype.setLayers=function(at,At,bt){this.getLayerIndex(at).replace(At),bt()},fo.prototype.updateLayers=function(at,At,bt){this.getLayerIndex(at).update(At.layers,At.removedIds),bt()},fo.prototype.loadTile=function(at,At,bt){this.getWorkerSource(at,At.type,At.source).loadTile(At,bt)},fo.prototype.loadDEMTile=function(at,At,bt){this.getDEMWorkerSource(at,At.source).loadTile(At,bt)},fo.prototype.reloadTile=function(at,At,bt){this.getWorkerSource(at,At.type,At.source).reloadTile(At,bt)},fo.prototype.abortTile=function(at,At,bt){this.getWorkerSource(at,At.type,At.source).abortTile(At,bt)},fo.prototype.removeTile=function(at,At,bt){this.getWorkerSource(at,At.type,At.source).removeTile(At,bt)},fo.prototype.removeDEMTile=function(at,At){this.getDEMWorkerSource(at,At.source).removeTile(At)},fo.prototype.removeSource=function(at,At,bt){if(this.workerSources[at]&&this.workerSources[at][At.type]&&this.workerSources[at][At.type][At.source]){var Lt=this.workerSources[at][At.type][At.source];delete this.workerSources[at][At.type][At.source],Lt.removeSource!==void 0?Lt.removeSource(At,bt):bt()}},fo.prototype.loadWorkerSource=function(at,At,bt){try{this.self.importScripts(At.url),bt()}catch(Lt){bt(Lt.toString())}},fo.prototype.syncRTLPluginState=function(at,At,bt){try{i.plugin.setState(At);var Lt=i.plugin.getPluginURL();if(i.plugin.isLoaded()&&!i.plugin.isParsed()&&Lt!=null){this.self.importScripts(Lt);var vt=i.plugin.isParsed();bt(vt?void 0:new Error("RTL Text Plugin failed to import scripts from "+Lt),vt)}}catch(Qt){bt(Qt.toString())}},fo.prototype.getAvailableImages=function(at){var At=this.availableImages[at];return At||(At=[]),At},fo.prototype.getLayerIndex=function(at){var At=this.layerIndexes[at];return At||(At=this.layerIndexes[at]=new c),At},fo.prototype.getWorkerSource=function(at,At,bt){var Lt=this;return this.workerSources[at]||(this.workerSources[at]={}),this.workerSources[at][At]||(this.workerSources[at][At]={}),this.workerSources[at][At][bt]||(this.workerSources[at][At][bt]=new this.workerSourceTypes[At]({send:function(vt,Qt,Jt){Lt.actor.send(vt,Qt,Jt,at)}},this.getLayerIndex(at),this.getAvailableImages(at))),this.workerSources[at][At][bt]},fo.prototype.getDEMWorkerSource=function(at,At){return this.demWorkerSources[at]||(this.demWorkerSources[at]={}),this.demWorkerSources[at][At]||(this.demWorkerSources[at][At]=new P),this.demWorkerSources[at][At]},fo.prototype.enforceCacheSizeLimit=function(at,At){i.enforceCacheSizeLimit(At)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new fo(self)),fo}),n(["./shared"],function(i){"use strict";var o=i.createCommonjsModule(function(d){function y(O){return!m(O)}function m(O){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var j,K,it=new Blob([""],{type:"text/javascript"}),pt=URL.createObjectURL(it);try{K=new Worker(pt),j=!0}catch{j=!1}return K&&K.terminate(),URL.revokeObjectURL(pt),j}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var j=document.createElement("canvas");j.width=j.height=1;var K=j.getContext("2d");if(!K)return!1;var it=K.getImageData(0,0,1,1);return it&&it.width===j.width}()?(T[U=O&&O.failIfMajorPerformanceCaveat]===void 0&&(T[U]=function(j){var K=function(pt){var Et=document.createElement("canvas"),Ct=Object.create(y.webGLContextAttributes);return Ct.failIfMajorPerformanceCaveat=pt,Et.probablySupportsContext?Et.probablySupportsContext("webgl",Ct)||Et.probablySupportsContext("experimental-webgl",Ct):Et.supportsContext?Et.supportsContext("webgl",Ct)||Et.supportsContext("experimental-webgl",Ct):Et.getContext("webgl",Ct)||Et.getContext("experimental-webgl",Ct)}(j);if(!K)return!1;var it=K.createShader(K.VERTEX_SHADER);return!(!it||K.isContextLost())&&(K.shaderSource(it,"void main() {}"),K.compileShader(it),K.getShaderParameter(it,K.COMPILE_STATUS)===!0)}(U)),T[U]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var U}d.exports?d.exports=y:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=y,window.mapboxgl.notSupportedReason=m);var T={};y.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),s={create:function(d,y,m){var T=i.window.document.createElement(d);return y!==void 0&&(T.className=y),m&&m.appendChild(T),T},createNS:function(d,y){return i.window.document.createElementNS(d,y)}},c=i.window.document&&i.window.document.documentElement.style;function l(d){if(!c)return d[0];for(var y=0;y<d.length;y++)if(d[y]in c)return d[y];return d[0]}var h,p=l(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);s.disableDrag=function(){c&&p&&(h=c[p],c[p]="none")},s.enableDrag=function(){c&&p&&(c[p]=h)};var x=l(["transform","WebkitTransform"]);s.setTransform=function(d,y){d.style[x]=y};var w=!1;try{var E=Object.defineProperty({},"passive",{get:function(){w=!0}});i.window.addEventListener("test",E,E),i.window.removeEventListener("test",E,E)}catch{w=!1}s.addEventListener=function(d,y,m,T){T===void 0&&(T={}),d.addEventListener(y,m,"passive"in T&&w?T:T.capture)},s.removeEventListener=function(d,y,m,T){T===void 0&&(T={}),d.removeEventListener(y,m,"passive"in T&&w?T:T.capture)};var P=function(d){d.preventDefault(),d.stopPropagation(),i.window.removeEventListener("click",P,!0)};function B(d){var y=d.userImage;return!!(y&&y.render&&y.render())&&(d.data.replace(new Uint8Array(y.data.buffer)),!0)}s.suppressClick=function(){i.window.addEventListener("click",P,!0),i.window.setTimeout(function(){i.window.removeEventListener("click",P,!0)},0)},s.mousePos=function(d,y){var m=d.getBoundingClientRect();return new i.Point(y.clientX-m.left-d.clientLeft,y.clientY-m.top-d.clientTop)},s.touchPos=function(d,y){for(var m=d.getBoundingClientRect(),T=[],O=0;O<y.length;O++)T.push(new i.Point(y[O].clientX-m.left-d.clientLeft,y[O].clientY-m.top-d.clientTop));return T},s.mouseButton=function(d){return i.window.InstallTrigger!==void 0&&d.button===2&&d.ctrlKey&&i.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:d.button},s.remove=function(d){d.parentNode&&d.parentNode.removeChild(d)};var D=function(d){function y(){d.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new i.RGBAImage({width:1,height:1}),this.dirty=!0}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.isLoaded=function(){return this.loaded},y.prototype.setLoaded=function(m){if(this.loaded!==m&&(this.loaded=m,m)){for(var T=0,O=this.requestors;T<O.length;T+=1){var U=O[T];this._notify(U.ids,U.callback)}this.requestors=[]}},y.prototype.getImage=function(m){return this.images[m]},y.prototype.addImage=function(m,T){this._validate(m,T)&&(this.images[m]=T)},y.prototype._validate=function(m,T){var O=!0;return this._validateStretch(T.stretchX,T.data&&T.data.width)||(this.fire(new i.ErrorEvent(new Error('Image "'+m+'" has invalid "stretchX" value'))),O=!1),this._validateStretch(T.stretchY,T.data&&T.data.height)||(this.fire(new i.ErrorEvent(new Error('Image "'+m+'" has invalid "stretchY" value'))),O=!1),this._validateContent(T.content,T)||(this.fire(new i.ErrorEvent(new Error('Image "'+m+'" has invalid "content" value'))),O=!1),O},y.prototype._validateStretch=function(m,T){if(!m)return!0;for(var O=0,U=0,j=m;U<j.length;U+=1){var K=j[U];if(K[0]<O||K[1]<K[0]||T<K[1])return!1;O=K[1]}return!0},y.prototype._validateContent=function(m,T){return!(m&&(m.length!==4||m[0]<0||T.data.width<m[0]||m[1]<0||T.data.height<m[1]||m[2]<0||T.data.width<m[2]||m[3]<0||T.data.height<m[3]||m[2]<m[0]||m[3]<m[1]))},y.prototype.updateImage=function(m,T){T.version=this.images[m].version+1,this.images[m]=T,this.updatedImages[m]=!0},y.prototype.removeImage=function(m){var T=this.images[m];delete this.images[m],delete this.patterns[m],T.userImage&&T.userImage.onRemove&&T.userImage.onRemove()},y.prototype.listImages=function(){return Object.keys(this.images)},y.prototype.getImages=function(m,T){var O=!0;if(!this.isLoaded())for(var U=0,j=m;U<j.length;U+=1)this.images[j[U]]||(O=!1);this.isLoaded()||O?this._notify(m,T):this.requestors.push({ids:m,callback:T})},y.prototype._notify=function(m,T){for(var O={},U=0,j=m;U<j.length;U+=1){var K=j[U];this.images[K]||this.fire(new i.Event("styleimagemissing",{id:K}));var it=this.images[K];it?O[K]={data:it.data.clone(),pixelRatio:it.pixelRatio,sdf:it.sdf,version:it.version,stretchX:it.stretchX,stretchY:it.stretchY,content:it.content,hasRenderCallback:Boolean(it.userImage&&it.userImage.render)}:i.warnOnce('Image "'+K+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}T(null,O)},y.prototype.getPixelSize=function(){var m=this.atlasImage;return{width:m.width,height:m.height}},y.prototype.getPattern=function(m){var T=this.patterns[m],O=this.getImage(m);if(!O)return null;if(T&&T.position.version===O.version)return T.position;if(T)T.position.version=O.version;else{var U={w:O.data.width+2,h:O.data.height+2,x:0,y:0},j=new i.ImagePosition(U,O);this.patterns[m]={bin:U,position:j}}return this._updatePatternAtlas(),this.patterns[m].position},y.prototype.bind=function(m){var T=m.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new i.Texture(m,this.atlasImage,T.RGBA),this.atlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE)},y.prototype._updatePatternAtlas=function(){var m=[];for(var T in this.patterns)m.push(this.patterns[T].bin);var O=i.potpack(m),U=O.w,j=O.h,K=this.atlasImage;for(var it in K.resize({width:U||1,height:j||1}),this.patterns){var pt=this.patterns[it].bin,Et=pt.x+1,Ct=pt.y+1,Pt=this.images[it].data,Vt=Pt.width,Ft=Pt.height;i.RGBAImage.copy(Pt,K,{x:0,y:0},{x:Et,y:Ct},{width:Vt,height:Ft}),i.RGBAImage.copy(Pt,K,{x:0,y:Ft-1},{x:Et,y:Ct-1},{width:Vt,height:1}),i.RGBAImage.copy(Pt,K,{x:0,y:0},{x:Et,y:Ct+Ft},{width:Vt,height:1}),i.RGBAImage.copy(Pt,K,{x:Vt-1,y:0},{x:Et-1,y:Ct},{width:1,height:Ft}),i.RGBAImage.copy(Pt,K,{x:0,y:0},{x:Et+Vt,y:Ct},{width:1,height:Ft})}this.dirty=!0},y.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},y.prototype.dispatchRenderCallbacks=function(m){for(var T=0,O=m;T<O.length;T+=1){var U=O[T];if(!this.callbackDispatchedThisFrame[U]){this.callbackDispatchedThisFrame[U]=!0;var j=this.images[U];B(j)&&this.updateImage(U,j)}}},y}(i.Evented),W=$,X=$,q=1e20;function $(d,y,m,T,O,U){this.fontSize=d||24,this.buffer=y===void 0?3:y,this.cutoff=T||.25,this.fontFamily=O||"sans-serif",this.fontWeight=U||"normal",this.radius=m||8;var j=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=j,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(j*j),this.gridInner=new Float64Array(j*j),this.f=new Float64Array(j),this.d=new Float64Array(j),this.z=new Float64Array(j+1),this.v=new Int16Array(j),this.middle=Math.round(j/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function et(d,y,m,T,O,U,j){for(var K=0;K<y;K++){for(var it=0;it<m;it++)T[it]=d[it*y+K];for(F(T,O,U,j,m),it=0;it<m;it++)d[it*y+K]=O[it]}for(it=0;it<m;it++){for(K=0;K<y;K++)T[K]=d[it*y+K];for(F(T,O,U,j,y),K=0;K<y;K++)d[it*y+K]=Math.sqrt(O[K])}}function F(d,y,m,T,O){m[0]=0,T[0]=-q,T[1]=+q;for(var U=1,j=0;U<O;U++){for(var K=(d[U]+U*U-(d[m[j]]+m[j]*m[j]))/(2*U-2*m[j]);K<=T[j];)j--,K=(d[U]+U*U-(d[m[j]]+m[j]*m[j]))/(2*U-2*m[j]);m[++j]=U,T[j]=K,T[j+1]=+q}for(U=0,j=0;U<O;U++){for(;T[j+1]<U;)j++;y[U]=(U-m[j])*(U-m[j])+d[m[j]]}}$.prototype.draw=function(d){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(d,this.buffer,this.middle);for(var y=this.ctx.getImageData(0,0,this.size,this.size),m=new Uint8ClampedArray(this.size*this.size),T=0;T<this.size*this.size;T++){var O=y.data[4*T+3]/255;this.gridOuter[T]=O===1?0:O===0?q:Math.pow(Math.max(0,.5-O),2),this.gridInner[T]=O===1?q:O===0?0:Math.pow(Math.max(0,O-.5),2)}for(et(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),et(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),T=0;T<this.size*this.size;T++)m[T]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[T]-this.gridInner[T])/this.radius+this.cutoff))));return m},W.default=X;var ut=function(d,y){this.requestManager=d,this.localIdeographFontFamily=y,this.entries={}};ut.prototype.setURL=function(d){this.url=d},ut.prototype.getGlyphs=function(d,y){var m=this,T=[];for(var O in d)for(var U=0,j=d[O];U<j.length;U+=1)T.push({stack:O,id:j[U]});i.asyncAll(T,function(K,it){var pt=K.stack,Et=K.id,Ct=m.entries[pt];Ct||(Ct=m.entries[pt]={glyphs:{},requests:{},ranges:{}});var Pt=Ct.glyphs[Et];if(Pt===void 0){if(Pt=m._tinySDF(Ct,pt,Et))return Ct.glyphs[Et]=Pt,void it(null,{stack:pt,id:Et,glyph:Pt});var Vt=Math.floor(Et/256);if(256*Vt>65535)it(new Error("glyphs > 65535 not supported"));else if(Ct.ranges[Vt])it(null,{stack:pt,id:Et,glyph:Pt});else{var Ft=Ct.requests[Vt];Ft||(Ft=Ct.requests[Vt]=[],ut.loadGlyphRange(pt,Vt,m.url,m.requestManager,function(Yt,Dt){if(Dt){for(var Xt in Dt)m._doesCharSupportLocalGlyph(+Xt)||(Ct.glyphs[+Xt]=Dt[+Xt]);Ct.ranges[Vt]=!0}for(var te=0,le=Ft;te<le.length;te+=1)(0,le[te])(Yt,Dt);delete Ct.requests[Vt]})),Ft.push(function(Yt,Dt){Yt?it(Yt):Dt&&it(null,{stack:pt,id:Et,glyph:Dt[Et]||null})})}}else it(null,{stack:pt,id:Et,glyph:Pt})},function(K,it){if(K)y(K);else if(it){for(var pt={},Et=0,Ct=it;Et<Ct.length;Et+=1){var Pt=Ct[Et],Vt=Pt.stack,Ft=Pt.id,Yt=Pt.glyph;(pt[Vt]||(pt[Vt]={}))[Ft]=Yt&&{id:Yt.id,bitmap:Yt.bitmap.clone(),metrics:Yt.metrics}}y(null,pt)}})},ut.prototype._doesCharSupportLocalGlyph=function(d){return!!this.localIdeographFontFamily&&(i.isChar["CJK Unified Ideographs"](d)||i.isChar["Hangul Syllables"](d)||i.isChar.Hiragana(d)||i.isChar.Katakana(d))},ut.prototype._tinySDF=function(d,y,m){var T=this.localIdeographFontFamily;if(T&&this._doesCharSupportLocalGlyph(m)){var O=d.tinySDF;if(!O){var U="400";/bold/i.test(y)?U="900":/medium/i.test(y)?U="500":/light/i.test(y)&&(U="200"),O=d.tinySDF=new ut.TinySDF(24,3,8,.25,T,U)}return{id:m,bitmap:new i.AlphaImage({width:30,height:30},O.draw(String.fromCharCode(m))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},ut.loadGlyphRange=function(d,y,m,T,O){var U=256*y,j=U+255,K=T.transformRequest(T.normalizeGlyphsURL(m).replace("{fontstack}",d).replace("{range}",U+"-"+j),i.ResourceType.Glyphs);i.getArrayBuffer(K,function(it,pt){if(it)O(it);else if(pt){for(var Et={},Ct=0,Pt=i.parseGlyphPBF(pt);Ct<Pt.length;Ct+=1){var Vt=Pt[Ct];Et[Vt.id]=Vt}O(null,Et)}})},ut.TinySDF=W;var ot=function(){this.specification=i.styleSpec.light.position};ot.prototype.possiblyEvaluate=function(d,y){return i.sphericalToCartesian(d.expression.evaluate(y))},ot.prototype.interpolate=function(d,y,m){return{x:i.number(d.x,y.x,m),y:i.number(d.y,y.y,m),z:i.number(d.z,y.z,m)}};var J=new i.Properties({anchor:new i.DataConstantProperty(i.styleSpec.light.anchor),position:new ot,color:new i.DataConstantProperty(i.styleSpec.light.color),intensity:new i.DataConstantProperty(i.styleSpec.light.intensity)}),G=function(d){function y(m){d.call(this),this._transitionable=new i.Transitionable(J),this.setLight(m),this._transitioning=this._transitionable.untransitioned()}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getLight=function(){return this._transitionable.serialize()},y.prototype.setLight=function(m,T){if(T===void 0&&(T={}),!this._validate(i.validateLight,m,T))for(var O in m){var U=m[O];i.endsWith(O,"-transition")?this._transitionable.setTransition(O.slice(0,-11),U):this._transitionable.setValue(O,U)}},y.prototype.updateTransitions=function(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)},y.prototype.hasTransition=function(){return this._transitioning.hasTransition()},y.prototype.recalculate=function(m){this.properties=this._transitioning.possiblyEvaluate(m)},y.prototype._validate=function(m,T,O){return(!O||O.validate!==!1)&&i.emitValidationErrors(this,m.call(i.validateStyle,i.extend({value:T,style:{glyphs:!0,sprite:!0},styleSpec:i.styleSpec})))},y}(i.Evented),mt=function(d,y){this.width=d,this.height=y,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};mt.prototype.getDash=function(d,y){var m=d.join(",")+String(y);return this.dashEntry[m]||(this.dashEntry[m]=this.addDash(d,y)),this.dashEntry[m]},mt.prototype.getDashRanges=function(d,y,m){var T=[],O=d.length%2==1?-d[d.length-1]*m:0,U=d[0]*m,j=!0;T.push({left:O,right:U,isDash:j,zeroLength:d[0]===0});for(var K=d[0],it=1;it<d.length;it++){var pt=d[it];T.push({left:O=K*m,right:U=(K+=pt)*m,isDash:j=!j,zeroLength:pt===0})}return T},mt.prototype.addRoundDash=function(d,y,m){for(var T=y/2,O=-m;O<=m;O++)for(var U=this.width*(this.nextRow+m+O),j=0,K=d[j],it=0;it<this.width;it++){it/K.right>1&&(K=d[++j]);var pt=Math.abs(it-K.left),Et=Math.abs(it-K.right),Ct=Math.min(pt,Et),Pt=void 0,Vt=O/m*(T+1);if(K.isDash){var Ft=T-Math.abs(Vt);Pt=Math.sqrt(Ct*Ct+Ft*Ft)}else Pt=T-Math.sqrt(Ct*Ct+Vt*Vt);this.data[U+it]=Math.max(0,Math.min(255,Pt+128))}},mt.prototype.addRegularDash=function(d){for(var y=d.length-1;y>=0;--y){var m=d[y],T=d[y+1];m.zeroLength?d.splice(y,1):T&&T.isDash===m.isDash&&(T.left=m.left,d.splice(y,1))}var O=d[0],U=d[d.length-1];O.isDash===U.isDash&&(O.left=U.left-this.width,U.right=O.right+this.width);for(var j=this.width*this.nextRow,K=0,it=d[K],pt=0;pt<this.width;pt++){pt/it.right>1&&(it=d[++K]);var Et=Math.abs(pt-it.left),Ct=Math.abs(pt-it.right),Pt=Math.min(Et,Ct);this.data[j+pt]=Math.max(0,Math.min(255,(it.isDash?Pt:-Pt)+128))}},mt.prototype.addDash=function(d,y){var m=y?7:0,T=2*m+1;if(this.nextRow+T>this.height)return i.warnOnce("LineAtlas out of space"),null;for(var O=0,U=0;U<d.length;U++)O+=d[U];if(O!==0){var j=this.width/O,K=this.getDashRanges(d,this.width,j);y?this.addRoundDash(K,j,m):this.addRegularDash(K)}var it={y:(this.nextRow+m+.5)/this.height,height:2*m/this.height,width:O};return this.nextRow+=T,this.dirty=!0,it},mt.prototype.bind=function(d){var y=d.gl;this.texture?(y.bindTexture(y.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,y.texSubImage2D(y.TEXTURE_2D,0,0,0,this.width,this.height,y.ALPHA,y.UNSIGNED_BYTE,this.data))):(this.texture=y.createTexture(),y.bindTexture(y.TEXTURE_2D,this.texture),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.REPEAT),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.REPEAT),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.LINEAR),y.texImage2D(y.TEXTURE_2D,0,y.ALPHA,this.width,this.height,0,y.ALPHA,y.UNSIGNED_BYTE,this.data))};var Mt=function d(y,m){this.workerPool=y,this.actors=[],this.currentActor=0,this.id=i.uniqueId();for(var T=this.workerPool.acquire(this.id),O=0;O<T.length;O++){var U=new d.Actor(T[O],m,this.id);U.name="Worker "+O,this.actors.push(U)}};function ct(d,y,m){var T=function(O,U){if(O)return m(O);if(U){var j=i.pick(i.extend(U,d),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);U.vector_layers&&(j.vectorLayers=U.vector_layers,j.vectorLayerIds=j.vectorLayers.map(function(K){return K.id})),j.tiles=y.canonicalizeTileset(j,d.url),m(null,j)}};return d.url?i.getJSON(y.transformRequest(y.normalizeSourceURL(d.url),i.ResourceType.Source),T):i.browser.frame(function(){return T(null,d)})}Mt.prototype.broadcast=function(d,y,m){i.asyncAll(this.actors,function(T,O){T.send(d,y,O)},m=m||function(){})},Mt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Mt.prototype.remove=function(){this.actors.forEach(function(d){d.remove()}),this.actors=[],this.workerPool.release(this.id)},Mt.Actor=i.Actor;var gt=function(d,y,m){this.bounds=i.LngLatBounds.convert(this.validateBounds(d)),this.minzoom=y||0,this.maxzoom=m||24};gt.prototype.validateBounds=function(d){return Array.isArray(d)&&d.length===4?[Math.max(-180,d[0]),Math.max(-90,d[1]),Math.min(180,d[2]),Math.min(90,d[3])]:[-180,-90,180,90]},gt.prototype.contains=function(d){var y=Math.pow(2,d.z),m=Math.floor(i.mercatorXfromLng(this.bounds.getWest())*y),T=Math.floor(i.mercatorYfromLat(this.bounds.getNorth())*y),O=Math.ceil(i.mercatorXfromLng(this.bounds.getEast())*y),U=Math.ceil(i.mercatorYfromLat(this.bounds.getSouth())*y);return d.x>=m&&d.x<O&&d.y>=T&&d.y<U};var ee=function(d){function y(m,T,O,U){if(d.call(this),this.id=m,this.dispatcher=O,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.extend(this,i.pick(T,["url","scheme","tileSize","promoteId"])),this._options=i.extend({type:"vector"},T),this._collectResourceTiming=T.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(U)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.load=function(){var m=this;this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ct(this._options,this.map._requestManager,function(T,O){m._tileJSONRequest=null,m._loaded=!0,T?m.fire(new i.ErrorEvent(T)):O&&(i.extend(m,O),O.bounds&&(m.tileBounds=new gt(O.bounds,m.minzoom,m.maxzoom)),i.postTurnstileEvent(O.tiles,m.map._requestManager._customAccessToken),i.postMapLoadEvent(O.tiles,m.map._getMapId(),m.map._requestManager._skuToken,m.map._requestManager._customAccessToken),m.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),m.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})))})},y.prototype.loaded=function(){return this._loaded},y.prototype.hasTile=function(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)},y.prototype.onAdd=function(m){this.map=m,this.load()},y.prototype.setSourceProperty=function(m){this._tileJSONRequest&&this._tileJSONRequest.cancel(),m(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},y.prototype.setTiles=function(m){var T=this;return this.setSourceProperty(function(){T._options.tiles=m}),this},y.prototype.setUrl=function(m){var T=this;return this.setSourceProperty(function(){T.url=m,T._options.url=m}),this},y.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},y.prototype.serialize=function(){return i.extend({},this._options)},y.prototype.loadTile=function(m,T){var O=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme)),U={request:this.map._requestManager.transformRequest(O,i.ResourceType.Tile),uid:m.uid,tileID:m.tileID,zoom:m.tileID.overscaledZ,tileSize:this.tileSize*m.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:i.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function j(K,it){return delete m.request,m.aborted?T(null):K&&K.status!==404?T(K):(it&&it.resourceTiming&&(m.resourceTiming=it.resourceTiming),this.map._refreshExpiredTiles&&it&&m.setExpiryData(it),m.loadVectorData(it,this.map.painter),i.cacheEntryPossiblyAdded(this.dispatcher),T(null),void(m.reloadCallback&&(this.loadTile(m,m.reloadCallback),m.reloadCallback=null)))}U.request.collectResourceTiming=this._collectResourceTiming,m.actor&&m.state!=="expired"?m.state==="loading"?m.reloadCallback=T:m.request=m.actor.send("reloadTile",U,j.bind(this)):(m.actor=this.dispatcher.getActor(),m.request=m.actor.send("loadTile",U,j.bind(this)))},y.prototype.abortTile=function(m){m.request&&(m.request.cancel(),delete m.request),m.actor&&m.actor.send("abortTile",{uid:m.uid,type:this.type,source:this.id},void 0)},y.prototype.unloadTile=function(m){m.unloadVectorData(),m.actor&&m.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id},void 0)},y.prototype.hasTransition=function(){return!1},y}(i.Evented),Ne=function(d){function y(m,T,O,U){d.call(this),this.id=m,this.dispatcher=O,this.setEventedParent(U),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.extend({type:"raster"},T),i.extend(this,i.pick(T,["url","scheme","tileSize"]))}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.load=function(){var m=this;this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ct(this._options,this.map._requestManager,function(T,O){m._tileJSONRequest=null,m._loaded=!0,T?m.fire(new i.ErrorEvent(T)):O&&(i.extend(m,O),O.bounds&&(m.tileBounds=new gt(O.bounds,m.minzoom,m.maxzoom)),i.postTurnstileEvent(O.tiles),i.postMapLoadEvent(O.tiles,m.map._getMapId(),m.map._requestManager._skuToken),m.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),m.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})))})},y.prototype.loaded=function(){return this._loaded},y.prototype.onAdd=function(m){this.map=m,this.load()},y.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},y.prototype.serialize=function(){return i.extend({},this._options)},y.prototype.hasTile=function(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)},y.prototype.loadTile=function(m,T){var O=this,U=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);m.request=i.getImage(this.map._requestManager.transformRequest(U,i.ResourceType.Tile),function(j,K){if(delete m.request,m.aborted)m.state="unloaded",T(null);else if(j)m.state="errored",T(j);else if(K){O.map._refreshExpiredTiles&&m.setExpiryData(K),delete K.cacheControl,delete K.expires;var it=O.map.painter.context,pt=it.gl;m.texture=O.map.painter.getTileTexture(K.width),m.texture?m.texture.update(K,{useMipmap:!0}):(m.texture=new i.Texture(it,K,pt.RGBA,{useMipmap:!0}),m.texture.bind(pt.LINEAR,pt.CLAMP_TO_EDGE,pt.LINEAR_MIPMAP_NEAREST),it.extTextureFilterAnisotropic&&pt.texParameterf(pt.TEXTURE_2D,it.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,it.extTextureFilterAnisotropicMax)),m.state="loaded",i.cacheEntryPossiblyAdded(O.dispatcher),T(null)}})},y.prototype.abortTile=function(m,T){m.request&&(m.request.cancel(),delete m.request),T()},y.prototype.unloadTile=function(m,T){m.texture&&this.map.painter.saveTileTexture(m.texture),T()},y.prototype.hasTransition=function(){return!1},y}(i.Evented),Ue=function(d){function y(m,T,O,U){d.call(this,m,T,O,U),this.type="raster-dem",this.maxzoom=22,this._options=i.extend({type:"raster-dem"},T),this.encoding=T.encoding||"mapbox"}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},y.prototype.loadTile=function(m,T){var O=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function U(j,K){j&&(m.state="errored",T(j)),K&&(m.dem=K,m.needsHillshadePrepare=!0,m.state="loaded",T(null))}m.request=i.getImage(this.map._requestManager.transformRequest(O,i.ResourceType.Tile),function(j,K){if(delete m.request,m.aborted)m.state="unloaded",T(null);else if(j)m.state="errored",T(j);else if(K){this.map._refreshExpiredTiles&&m.setExpiryData(K),delete K.cacheControl,delete K.expires;var it=i.window.ImageBitmap&&K instanceof i.window.ImageBitmap&&i.offscreenCanvasSupported()?K:i.browser.getImageData(K,1),pt={uid:m.uid,coord:m.tileID,source:this.id,rawImageData:it,encoding:this.encoding};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",pt,U.bind(this)))}}.bind(this)),m.neighboringTiles=this._getNeighboringTiles(m.tileID)},y.prototype._getNeighboringTiles=function(m){var T=m.canonical,O=Math.pow(2,T.z),U=(T.x-1+O)%O,j=T.x===0?m.wrap-1:m.wrap,K=(T.x+1+O)%O,it=T.x+1===O?m.wrap+1:m.wrap,pt={};return pt[new i.OverscaledTileID(m.overscaledZ,j,T.z,U,T.y).key]={backfilled:!1},pt[new i.OverscaledTileID(m.overscaledZ,it,T.z,K,T.y).key]={backfilled:!1},T.y>0&&(pt[new i.OverscaledTileID(m.overscaledZ,j,T.z,U,T.y-1).key]={backfilled:!1},pt[new i.OverscaledTileID(m.overscaledZ,m.wrap,T.z,T.x,T.y-1).key]={backfilled:!1},pt[new i.OverscaledTileID(m.overscaledZ,it,T.z,K,T.y-1).key]={backfilled:!1}),T.y+1<O&&(pt[new i.OverscaledTileID(m.overscaledZ,j,T.z,U,T.y+1).key]={backfilled:!1},pt[new i.OverscaledTileID(m.overscaledZ,m.wrap,T.z,T.x,T.y+1).key]={backfilled:!1},pt[new i.OverscaledTileID(m.overscaledZ,it,T.z,K,T.y+1).key]={backfilled:!1}),pt},y.prototype.unloadTile=function(m){m.demTexture&&this.map.painter.saveTileTexture(m.demTexture),m.fbo&&(m.fbo.destroy(),delete m.fbo),m.dem&&delete m.dem,delete m.neighboringTiles,m.state="unloaded",m.actor&&m.actor.send("removeDEMTile",{uid:m.uid,source:this.id})},y}(Ne),sr=function(d){function y(m,T,O,U){d.call(this),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=O.getActor(),this.setEventedParent(U),this._data=T.data,this._options=i.extend({},T),this._collectResourceTiming=T.collectResourceTiming,this._resourceTiming=[],T.maxzoom!==void 0&&(this.maxzoom=T.maxzoom),T.type&&(this.type=T.type),T.attribution&&(this.attribution=T.attribution),this.promoteId=T.promoteId;var j=i.EXTENT/this.tileSize;this.workerOptions=i.extend({source:this.id,cluster:T.cluster||!1,geojsonVtOptions:{buffer:(T.buffer!==void 0?T.buffer:128)*j,tolerance:(T.tolerance!==void 0?T.tolerance:.375)*j,extent:i.EXTENT,maxZoom:this.maxzoom,lineMetrics:T.lineMetrics||!1,generateId:T.generateId||!1},superclusterOptions:{maxZoom:T.clusterMaxZoom!==void 0?Math.min(T.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,T.clusterMinPoints||2),extent:i.EXTENT,radius:(T.clusterRadius||50)*j,log:!1,generateId:T.generateId||!1},clusterProperties:T.clusterProperties,filter:T.filter},T.workerOptions)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.load=function(){var m=this;this.fire(new i.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(T){if(T)m.fire(new i.ErrorEvent(T));else{var O={dataType:"source",sourceDataType:"metadata"};m._collectResourceTiming&&m._resourceTiming&&m._resourceTiming.length>0&&(O.resourceTiming=m._resourceTiming,m._resourceTiming=[]),m.fire(new i.Event("data",O))}})},y.prototype.onAdd=function(m){this.map=m,this.load()},y.prototype.setData=function(m){var T=this;return this._data=m,this.fire(new i.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(O){if(O)T.fire(new i.ErrorEvent(O));else{var U={dataType:"source",sourceDataType:"content"};T._collectResourceTiming&&T._resourceTiming&&T._resourceTiming.length>0&&(U.resourceTiming=T._resourceTiming,T._resourceTiming=[]),T.fire(new i.Event("data",U))}}),this},y.prototype.getClusterExpansionZoom=function(m,T){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id},T),this},y.prototype.getClusterChildren=function(m,T){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id},T),this},y.prototype.getClusterLeaves=function(m,T,O,U){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:m,limit:T,offset:O},U),this},y.prototype._updateWorkerData=function(m){var T=this;this._loaded=!1;var O=i.extend({},this.workerOptions),U=this._data;typeof U=="string"?(O.request=this.map._requestManager.transformRequest(i.browser.resolveURL(U),i.ResourceType.Source),O.request.collectResourceTiming=this._collectResourceTiming):O.data=JSON.stringify(U),this.actor.send(this.type+".loadData",O,function(j,K){T._removed||K&&K.abandoned||(T._loaded=!0,K&&K.resourceTiming&&K.resourceTiming[T.id]&&(T._resourceTiming=K.resourceTiming[T.id].slice(0)),T.actor.send(T.type+".coalesce",{source:O.source},null),m(j))})},y.prototype.loaded=function(){return this._loaded},y.prototype.loadTile=function(m,T){var O=this,U=m.actor?"reloadTile":"loadTile";m.actor=this.actor,m.request=this.actor.send(U,{type:this.type,uid:m.uid,tileID:m.tileID,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:i.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(j,K){return delete m.request,m.unloadVectorData(),m.aborted?T(null):j?T(j):(m.loadVectorData(K,O.map.painter,U==="reloadTile"),T(null))})},y.prototype.abortTile=function(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0},y.prototype.unloadTile=function(m){m.unloadVectorData(),this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})},y.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},y.prototype.serialize=function(){return i.extend({},this._options,{type:this.type,data:this._data})},y.prototype.hasTransition=function(){return!1},y}(i.Evented),gr=i.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Xr=function(d){function y(m,T,O,U){d.call(this),this.id=m,this.dispatcher=O,this.coordinates=T.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(U),this.options=T}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.load=function(m,T){var O=this;this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this.url=this.options.url,i.getImage(this.map._requestManager.transformRequest(this.url,i.ResourceType.Image),function(U,j){O._loaded=!0,U?O.fire(new i.ErrorEvent(U)):j&&(O.image=j,m&&(O.coordinates=m),T&&T(),O._finishLoading())})},y.prototype.loaded=function(){return this._loaded},y.prototype.updateImage=function(m){var T=this;return this.image&&m.url?(this.options.url=m.url,this.load(m.coordinates,function(){T.texture=null}),this):this},y.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})))},y.prototype.onAdd=function(m){this.map=m,this.load()},y.prototype.setCoordinates=function(m){var T=this;this.coordinates=m;var O=m.map(i.MercatorCoordinate.fromLngLat);this.tileID=function(j){for(var K=1/0,it=1/0,pt=-1/0,Et=-1/0,Ct=0,Pt=j;Ct<Pt.length;Ct+=1){var Vt=Pt[Ct];K=Math.min(K,Vt.x),it=Math.min(it,Vt.y),pt=Math.max(pt,Vt.x),Et=Math.max(Et,Vt.y)}var Ft=Math.max(pt-K,Et-it),Yt=Math.max(0,Math.floor(-Math.log(Ft)/Math.LN2)),Dt=Math.pow(2,Yt);return new i.CanonicalTileID(Yt,Math.floor((K+pt)/2*Dt),Math.floor((it+Et)/2*Dt))}(O),this.minzoom=this.maxzoom=this.tileID.z;var U=O.map(function(j){return T.tileID.getTilePoint(j)._round()});return this._boundsArray=new i.StructArrayLayout4i8,this._boundsArray.emplaceBack(U[0].x,U[0].y,0,0),this._boundsArray.emplaceBack(U[1].x,U[1].y,i.EXTENT,0),this._boundsArray.emplaceBack(U[3].x,U[3].y,0,i.EXTENT),this._boundsArray.emplaceBack(U[2].x,U[2].y,i.EXTENT,i.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})),this},y.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var m=this.map.painter.context,T=m.gl;for(var O in this.boundsBuffer||(this.boundsBuffer=m.createVertexBuffer(this._boundsArray,gr.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new i.Texture(m,this.image,T.RGBA),this.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE)),this.tiles){var U=this.tiles[O];U.state!=="loaded"&&(U.state="loaded",U.texture=this.texture)}}},y.prototype.loadTile=function(m,T){this.tileID&&this.tileID.equals(m.tileID.canonical)?(this.tiles[String(m.tileID.wrap)]=m,m.buckets={},T(null)):(m.state="errored",T(null))},y.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},y.prototype.hasTransition=function(){return!1},y}(i.Evented),ir=function(d){function y(m,T,O,U){d.call(this,m,T,O,U),this.roundZoom=!0,this.type="video",this.options=T}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.load=function(){var m=this;this._loaded=!1;var T=this.options;this.urls=[];for(var O=0,U=T.urls;O<U.length;O+=1)this.urls.push(this.map._requestManager.transformRequest(U[O],i.ResourceType.Source).url);i.getVideo(this.urls,function(j,K){m._loaded=!0,j?m.fire(new i.ErrorEvent(j)):K&&(m.video=K,m.video.loop=!0,m.video.setAttribute("playsinline",""),m.video.addEventListener("playing",function(){m.map.triggerRepaint()}),m.map&&m.video.play(),m._finishLoading())})},y.prototype.pause=function(){this.video&&this.video.pause()},y.prototype.play=function(){this.video&&this.video.play()},y.prototype.seek=function(m){if(this.video){var T=this.video.seekable;m<T.start(0)||m>T.end(0)?this.fire(new i.ErrorEvent(new i.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+T.start(0)+" and "+T.end(0)+"-second mark."))):this.video.currentTime=m}},y.prototype.getVideo=function(){return this.video},y.prototype.onAdd=function(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},y.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var m=this.map.painter.context,T=m.gl;for(var O in this.boundsBuffer||(this.boundsBuffer=m.createVertexBuffer(this._boundsArray,gr.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE),T.texSubImage2D(T.TEXTURE_2D,0,0,0,T.RGBA,T.UNSIGNED_BYTE,this.video)):(this.texture=new i.Texture(m,this.video,T.RGBA),this.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE)),this.tiles){var U=this.tiles[O];U.state!=="loaded"&&(U.state="loaded",U.texture=this.texture)}}},y.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},y.prototype.hasTransition=function(){return this.video&&!this.video.paused},y}(Xr),on=function(d){function y(m,T,O,U){d.call(this,m,T,O,U),T.coordinates?Array.isArray(T.coordinates)&&T.coordinates.length===4&&!T.coordinates.some(function(j){return!Array.isArray(j)||j.length!==2||j.some(function(K){return typeof K!="number"})})||this.fire(new i.ErrorEvent(new i.ValidationError("sources."+m,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.ErrorEvent(new i.ValidationError("sources."+m,null,'missing required property "coordinates"'))),T.animate&&typeof T.animate!="boolean"&&this.fire(new i.ErrorEvent(new i.ValidationError("sources."+m,null,'optional "animate" property must be a boolean value'))),T.canvas?typeof T.canvas=="string"||T.canvas instanceof i.window.HTMLCanvasElement||this.fire(new i.ErrorEvent(new i.ValidationError("sources."+m,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.ErrorEvent(new i.ValidationError("sources."+m,null,'missing required property "canvas"'))),this.options=T,this.animate=T.animate===void 0||T.animate}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof i.window.HTMLCanvasElement?this.options.canvas:i.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},y.prototype.getCanvas=function(){return this.canvas},y.prototype.onAdd=function(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()},y.prototype.onRemove=function(){this.pause()},y.prototype.prepare=function(){var m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var T=this.map.painter.context,O=T.gl;for(var U in this.boundsBuffer||(this.boundsBuffer=T.createVertexBuffer(this._boundsArray,gr.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(m||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.Texture(T,this.canvas,O.RGBA,{premultiply:!0}),this.tiles){var j=this.tiles[U];j.state!=="loaded"&&(j.state="loaded",j.texture=this.texture)}}},y.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},y.prototype.hasTransition=function(){return this._playing},y.prototype._hasInvalidDimensions=function(){for(var m=0,T=[this.canvas.width,this.canvas.height];m<T.length;m+=1){var O=T[m];if(isNaN(O)||O<=0)return!0}return!1},y}(Xr),Xe={vector:ee,raster:Ne,"raster-dem":Ue,geojson:sr,video:ir,image:Xr,canvas:on};function He(d,y){var m=i.identity([]);return i.translate(m,m,[1,1,0]),i.scale(m,m,[.5*d.width,.5*d.height,1]),i.multiply(m,m,d.calculatePosMatrix(y.toUnwrapped()))}function _n(d,y,m,T,O,U){var j=function(Yt,Dt,Xt){if(Yt)for(var te=0,le=Yt;te<le.length;te+=1){var be=Dt[le[te]];if(be&&be.source===Xt&&be.type==="fill-extrusion")return!0}else for(var Ae in Dt){var Me=Dt[Ae];if(Me.source===Xt&&Me.type==="fill-extrusion")return!0}return!1}(O&&O.layers,y,d.id),K=U.maxPitchScaleFactor(),it=d.tilesIn(T,K,j);it.sort(dt);for(var pt=[],Et=0,Ct=it;Et<Ct.length;Et+=1){var Pt=Ct[Et];pt.push({wrappedTileID:Pt.tileID.wrapped().key,queryResults:Pt.tile.queryRenderedFeatures(y,m,d._state,Pt.queryGeometry,Pt.cameraQueryGeometry,Pt.scale,O,U,K,He(d.transform,Pt.tileID))})}var Vt=function(Yt){for(var Dt={},Xt={},te=0,le=Yt;te<le.length;te+=1){var be=le[te],Ae=be.queryResults,Me=be.wrappedTileID,Ve=Xt[Me]=Xt[Me]||{};for(var Je in Ae)for(var $e=Ae[Je],wr=Ve[Je]=Ve[Je]||{},qr=Dt[Je]=Dt[Je]||[],$r=0,Kr=$e;$r<Kr.length;$r+=1){var ei=Kr[$r];wr[ei.featureIndex]||(wr[ei.featureIndex]=!0,qr.push(ei))}}return Dt}(pt);for(var Ft in Vt)Vt[Ft].forEach(function(Yt){var Dt=Yt.feature,Xt=d.getFeatureState(Dt.layer["source-layer"],Dt.id);Dt.source=Dt.layer.source,Dt.layer["source-layer"]&&(Dt.sourceLayer=Dt.layer["source-layer"]),Dt.state=Xt});return Vt}function dt(d,y){var m=d.tileID,T=y.tileID;return m.overscaledZ-T.overscaledZ||m.canonical.y-T.canonical.y||m.wrap-T.wrap||m.canonical.x-T.canonical.x}var wt=function(d,y){this.max=d,this.onRemove=y,this.reset()};wt.prototype.reset=function(){for(var d in this.data)for(var y=0,m=this.data[d];y<m.length;y+=1){var T=m[y];T.timeout&&clearTimeout(T.timeout),this.onRemove(T.value)}return this.data={},this.order=[],this},wt.prototype.add=function(d,y,m){var T=this,O=d.wrapped().key;this.data[O]===void 0&&(this.data[O]=[]);var U={value:y,timeout:void 0};if(m!==void 0&&(U.timeout=setTimeout(function(){T.remove(d,U)},m)),this.data[O].push(U),this.order.push(O),this.order.length>this.max){var j=this._getAndRemoveByKey(this.order[0]);j&&this.onRemove(j)}return this},wt.prototype.has=function(d){return d.wrapped().key in this.data},wt.prototype.getAndRemove=function(d){return this.has(d)?this._getAndRemoveByKey(d.wrapped().key):null},wt.prototype._getAndRemoveByKey=function(d){var y=this.data[d].shift();return y.timeout&&clearTimeout(y.timeout),this.data[d].length===0&&delete this.data[d],this.order.splice(this.order.indexOf(d),1),y.value},wt.prototype.getByKey=function(d){var y=this.data[d];return y?y[0].value:null},wt.prototype.get=function(d){return this.has(d)?this.data[d.wrapped().key][0].value:null},wt.prototype.remove=function(d,y){if(!this.has(d))return this;var m=d.wrapped().key,T=y===void 0?0:this.data[m].indexOf(y),O=this.data[m][T];return this.data[m].splice(T,1),O.timeout&&clearTimeout(O.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(O.value),this.order.splice(this.order.indexOf(m),1),this},wt.prototype.setMaxSize=function(d){for(this.max=d;this.order.length>this.max;){var y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this},wt.prototype.filter=function(d){var y=[];for(var m in this.data)for(var T=0,O=this.data[m];T<O.length;T+=1){var U=O[T];d(U.value)||y.push(U)}for(var j=0,K=y;j<K.length;j+=1){var it=K[j];this.remove(it.value.tileID,it)}};var Ht=function(d,y,m){this.context=d;var T=d.gl;this.buffer=T.createBuffer(),this.dynamicDraw=Boolean(m),this.context.unbindVAO(),d.bindElementBuffer.set(this.buffer),T.bufferData(T.ELEMENT_ARRAY_BUFFER,y.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||delete y.arrayBuffer};Ht.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ht.prototype.updateData=function(d){var y=this.context.gl;this.context.unbindVAO(),this.bind(),y.bufferSubData(y.ELEMENT_ARRAY_BUFFER,0,d.arrayBuffer)},Ht.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ue={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Le=function(d,y,m,T){this.length=y.length,this.attributes=m,this.itemSize=y.bytesPerElement,this.dynamicDraw=T,this.context=d;var O=d.gl;this.buffer=O.createBuffer(),d.bindVertexBuffer.set(this.buffer),O.bufferData(O.ARRAY_BUFFER,y.arrayBuffer,this.dynamicDraw?O.DYNAMIC_DRAW:O.STATIC_DRAW),this.dynamicDraw||delete y.arrayBuffer};Le.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Le.prototype.updateData=function(d){var y=this.context.gl;this.bind(),y.bufferSubData(y.ARRAY_BUFFER,0,d.arrayBuffer)},Le.prototype.enableAttributes=function(d,y){for(var m=0;m<this.attributes.length;m++){var T=y.attributes[this.attributes[m].name];T!==void 0&&d.enableVertexAttribArray(T)}},Le.prototype.setVertexAttribPointers=function(d,y,m){for(var T=0;T<this.attributes.length;T++){var O=this.attributes[T],U=y.attributes[O.name];U!==void 0&&d.vertexAttribPointer(U,O.components,d[ue[O.type]],!1,this.itemSize,O.offset+this.itemSize*(m||0))}},Le.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Ee=function(d){this.gl=d.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Ee.prototype.get=function(){return this.current},Ee.prototype.set=function(d){},Ee.prototype.getDefault=function(){return this.default},Ee.prototype.setDefault=function(){this.set(this.default)};var Jr=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return i.Color.transparent},y.prototype.set=function(m){var T=this.current;(m.r!==T.r||m.g!==T.g||m.b!==T.b||m.a!==T.a||this.dirty)&&(this.gl.clearColor(m.r,m.g,m.b,m.a),this.current=m,this.dirty=!1)},y}(Ee),bn=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return 1},y.prototype.set=function(m){(m!==this.current||this.dirty)&&(this.gl.clearDepth(m),this.current=m,this.dirty=!1)},y}(Ee),ai=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return 0},y.prototype.set=function(m){(m!==this.current||this.dirty)&&(this.gl.clearStencil(m),this.current=m,this.dirty=!1)},y}(Ee),qo=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return[!0,!0,!0,!0]},y.prototype.set=function(m){var T=this.current;(m[0]!==T[0]||m[1]!==T[1]||m[2]!==T[2]||m[3]!==T[3]||this.dirty)&&(this.gl.colorMask(m[0],m[1],m[2],m[3]),this.current=m,this.dirty=!1)},y}(Ee),_i=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return!0},y.prototype.set=function(m){(m!==this.current||this.dirty)&&(this.gl.depthMask(m),this.current=m,this.dirty=!1)},y}(Ee),Xn=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return 255},y.prototype.set=function(m){(m!==this.current||this.dirty)&&(this.gl.stencilMask(m),this.current=m,this.dirty=!1)},y}(Ee),Ui=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},y.prototype.set=function(m){var T=this.current;(m.func!==T.func||m.ref!==T.ref||m.mask!==T.mask||this.dirty)&&(this.gl.stencilFunc(m.func,m.ref,m.mask),this.current=m,this.dirty=!1)},y}(Ee),bs=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){var m=this.gl;return[m.KEEP,m.KEEP,m.KEEP]},y.prototype.set=function(m){var T=this.current;(m[0]!==T[0]||m[1]!==T[1]||m[2]!==T[2]||this.dirty)&&(this.gl.stencilOp(m[0],m[1],m[2]),this.current=m,this.dirty=!1)},y}(Ee),Vi=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return!1},y.prototype.set=function(m){if(m!==this.current||this.dirty){var T=this.gl;m?T.enable(T.STENCIL_TEST):T.disable(T.STENCIL_TEST),this.current=m,this.dirty=!1}},y}(Ee),Cn=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return[0,1]},y.prototype.set=function(m){var T=this.current;(m[0]!==T[0]||m[1]!==T[1]||this.dirty)&&(this.gl.depthRange(m[0],m[1]),this.current=m,this.dirty=!1)},y}(Ee),yi=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return!1},y.prototype.set=function(m){if(m!==this.current||this.dirty){var T=this.gl;m?T.enable(T.DEPTH_TEST):T.disable(T.DEPTH_TEST),this.current=m,this.dirty=!1}},y}(Ee),_o=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return this.gl.LESS},y.prototype.set=function(m){(m!==this.current||this.dirty)&&(this.gl.depthFunc(m),this.current=m,this.dirty=!1)},y}(Ee),Nr=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return!1},y.prototype.set=function(m){if(m!==this.current||this.dirty){var T=this.gl;m?T.enable(T.BLEND):T.disable(T.BLEND),this.current=m,this.dirty=!1}},y}(Ee),ar=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){var m=this.gl;return[m.ONE,m.ZERO]},y.prototype.set=function(m){var T=this.current;(m[0]!==T[0]||m[1]!==T[1]||this.dirty)&&(this.gl.blendFunc(m[0],m[1]),this.current=m,this.dirty=!1)},y}(Ee),zr=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return i.Color.transparent},y.prototype.set=function(m){var T=this.current;(m.r!==T.r||m.g!==T.g||m.b!==T.b||m.a!==T.a||this.dirty)&&(this.gl.blendColor(m.r,m.g,m.b,m.a),this.current=m,this.dirty=!1)},y}(Ee),hn=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return this.gl.FUNC_ADD},y.prototype.set=function(m){(m!==this.current||this.dirty)&&(this.gl.blendEquation(m),this.current=m,this.dirty=!1)},y}(Ee),ho=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return!1},y.prototype.set=function(m){if(m!==this.current||this.dirty){var T=this.gl;m?T.enable(T.CULL_FACE):T.disable(T.CULL_FACE),this.current=m,this.dirty=!1}},y}(Ee),ki=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return this.gl.BACK},y.prototype.set=function(m){(m!==this.current||this.dirty)&&(this.gl.cullFace(m),this.current=m,this.dirty=!1)},y}(Ee),ds=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return this.gl.CCW},y.prototype.set=function(m){(m!==this.current||this.dirty)&&(this.gl.frontFace(m),this.current=m,this.dirty=!1)},y}(Ee),es=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return null},y.prototype.set=function(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)},y}(Ee),rs=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return this.gl.TEXTURE0},y.prototype.set=function(m){(m!==this.current||this.dirty)&&(this.gl.activeTexture(m),this.current=m,this.dirty=!1)},y}(Ee),No=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){var m=this.gl;return[0,0,m.drawingBufferWidth,m.drawingBufferHeight]},y.prototype.set=function(m){var T=this.current;(m[0]!==T[0]||m[1]!==T[1]||m[2]!==T[2]||m[3]!==T[3]||this.dirty)&&(this.gl.viewport(m[0],m[1],m[2],m[3]),this.current=m,this.dirty=!1)},y}(Ee),ha=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return null},y.prototype.set=function(m){if(m!==this.current||this.dirty){var T=this.gl;T.bindFramebuffer(T.FRAMEBUFFER,m),this.current=m,this.dirty=!1}},y}(Ee),ch=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return null},y.prototype.set=function(m){if(m!==this.current||this.dirty){var T=this.gl;T.bindRenderbuffer(T.RENDERBUFFER,m),this.current=m,this.dirty=!1}},y}(Ee),Xl=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return null},y.prototype.set=function(m){if(m!==this.current||this.dirty){var T=this.gl;T.bindTexture(T.TEXTURE_2D,m),this.current=m,this.dirty=!1}},y}(Ee),vu=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return null},y.prototype.set=function(m){if(m!==this.current||this.dirty){var T=this.gl;T.bindBuffer(T.ARRAY_BUFFER,m),this.current=m,this.dirty=!1}},y}(Ee),wl=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return null},y.prototype.set=function(m){var T=this.gl;T.bindBuffer(T.ELEMENT_ARRAY_BUFFER,m),this.current=m,this.dirty=!1},y}(Ee),el=function(d){function y(m){d.call(this,m),this.vao=m.extVertexArrayObject}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return null},y.prototype.set=function(m){this.vao&&(m!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(m),this.current=m,this.dirty=!1)},y}(Ee),fa=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return 4},y.prototype.set=function(m){if(m!==this.current||this.dirty){var T=this.gl;T.pixelStorei(T.UNPACK_ALIGNMENT,m),this.current=m,this.dirty=!1}},y}(Ee),hc=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return!1},y.prototype.set=function(m){if(m!==this.current||this.dirty){var T=this.gl;T.pixelStorei(T.UNPACK_PREMULTIPLY_ALPHA_WEBGL,m),this.current=m,this.dirty=!1}},y}(Ee),bu=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return!1},y.prototype.set=function(m){if(m!==this.current||this.dirty){var T=this.gl;T.pixelStorei(T.UNPACK_FLIP_Y_WEBGL,m),this.current=m,this.dirty=!1}},y}(Ee),fo=function(d){function y(m,T){d.call(this,m),this.context=m,this.parent=T}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getDefault=function(){return null},y}(Ee),at=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.setDirty=function(){this.dirty=!0},y.prototype.set=function(m){if(m!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var T=this.gl;T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.TEXTURE_2D,m,0),this.current=m,this.dirty=!1}},y}(fo),At=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.set=function(m){if(m!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var T=this.gl;T.framebufferRenderbuffer(T.FRAMEBUFFER,T.DEPTH_ATTACHMENT,T.RENDERBUFFER,m),this.current=m,this.dirty=!1}},y}(fo),bt=function(d,y,m,T){this.context=d,this.width=y,this.height=m;var O=this.framebuffer=d.gl.createFramebuffer();this.colorAttachment=new at(d,O),T&&(this.depthAttachment=new At(d,O))};bt.prototype.destroy=function(){var d=this.context.gl,y=this.colorAttachment.get();if(y&&d.deleteTexture(y),this.depthAttachment){var m=this.depthAttachment.get();m&&d.deleteRenderbuffer(m)}d.deleteFramebuffer(this.framebuffer)};var Lt=function(d,y,m){this.func=d,this.mask=y,this.range=m};Lt.ReadOnly=!1,Lt.ReadWrite=!0,Lt.disabled=new Lt(519,Lt.ReadOnly,[0,1]);var vt=function(d,y,m,T,O,U){this.test=d,this.ref=y,this.mask=m,this.fail=T,this.depthFail=O,this.pass=U};vt.disabled=new vt({func:519,mask:0},0,0,7680,7680,7680);var Qt=function(d,y,m){this.blendFunction=d,this.blendColor=y,this.mask=m};Qt.disabled=new Qt(Qt.Replace=[1,0],i.Color.transparent,[!1,!1,!1,!1]),Qt.unblended=new Qt(Qt.Replace,i.Color.transparent,[!0,!0,!0,!0]),Qt.alphaBlended=new Qt([1,771],i.Color.transparent,[!0,!0,!0,!0]);var Jt=function(d,y,m){this.enable=d,this.mode=y,this.frontFace=m};Jt.disabled=new Jt(!1,1029,2305),Jt.backCCW=new Jt(!0,1029,2305);var St=function(d){this.gl=d,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Jr(this),this.clearDepth=new bn(this),this.clearStencil=new ai(this),this.colorMask=new qo(this),this.depthMask=new _i(this),this.stencilMask=new Xn(this),this.stencilFunc=new Ui(this),this.stencilOp=new bs(this),this.stencilTest=new Vi(this),this.depthRange=new Cn(this),this.depthTest=new yi(this),this.depthFunc=new _o(this),this.blend=new Nr(this),this.blendFunc=new ar(this),this.blendColor=new zr(this),this.blendEquation=new hn(this),this.cullFace=new ho(this),this.cullFaceSide=new ki(this),this.frontFace=new ds(this),this.program=new es(this),this.activeTexture=new rs(this),this.viewport=new No(this),this.bindFramebuffer=new ha(this),this.bindRenderbuffer=new ch(this),this.bindTexture=new Xl(this),this.bindVertexBuffer=new vu(this),this.bindElementBuffer=new wl(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new el(this),this.pixelStoreUnpack=new fa(this),this.pixelStoreUnpackPremultiplyAlpha=new hc(this),this.pixelStoreUnpackFlipY=new bu(this),this.extTextureFilterAnisotropic=d.getExtension("EXT_texture_filter_anisotropic")||d.getExtension("MOZ_EXT_texture_filter_anisotropic")||d.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=d.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=d.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(d.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=d.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=d.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=d.getParameter(d.MAX_TEXTURE_SIZE)};St.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},St.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},St.prototype.createIndexBuffer=function(d,y){return new Ht(this,d,y)},St.prototype.createVertexBuffer=function(d,y,m){return new Le(this,d,y,m)},St.prototype.createRenderbuffer=function(d,y,m){var T=this.gl,O=T.createRenderbuffer();return this.bindRenderbuffer.set(O),T.renderbufferStorage(T.RENDERBUFFER,d,y,m),this.bindRenderbuffer.set(null),O},St.prototype.createFramebuffer=function(d,y,m){return new bt(this,d,y,m)},St.prototype.clear=function(d){var y=d.color,m=d.depth,T=this.gl,O=0;y&&(O|=T.COLOR_BUFFER_BIT,this.clearColor.set(y),this.colorMask.set([!0,!0,!0,!0])),m!==void 0&&(O|=T.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(m),this.depthMask.set(!0)),T.clear(O)},St.prototype.setCullFace=function(d){d.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(d.mode),this.frontFace.set(d.frontFace))},St.prototype.setDepthMode=function(d){d.func!==this.gl.ALWAYS||d.mask?(this.depthTest.set(!0),this.depthFunc.set(d.func),this.depthMask.set(d.mask),this.depthRange.set(d.range)):this.depthTest.set(!1)},St.prototype.setStencilMode=function(d){d.test.func!==this.gl.ALWAYS||d.mask?(this.stencilTest.set(!0),this.stencilMask.set(d.mask),this.stencilOp.set([d.fail,d.depthFail,d.pass]),this.stencilFunc.set({func:d.test.func,ref:d.ref,mask:d.test.mask})):this.stencilTest.set(!1)},St.prototype.setColorMode=function(d){i.deepEqual(d.blendFunction,Qt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(d.blendFunction),this.blendColor.set(d.blendColor)),this.colorMask.set(d.mask)},St.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var jt=function(d){function y(m,T,O){var U=this;d.call(this),this.id=m,this.dispatcher=O,this.on("data",function(j){j.dataType==="source"&&j.sourceDataType==="metadata"&&(U._sourceLoaded=!0),U._sourceLoaded&&!U._paused&&j.dataType==="source"&&j.sourceDataType==="content"&&(U.reload(),U.transform&&U.update(U.transform))}),this.on("error",function(){U._sourceErrored=!0}),this._source=function(j,K,it,pt){var Et=new Xe[K.type](j,K,it,pt);if(Et.id!==j)throw new Error("Expected Source id to be "+j+" instead of "+Et.id);return i.bindAll(["load","abort","unload","serialize","prepare"],Et),Et}(m,T,O,this),this._tiles={},this._cache=new wt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new i.SourceFeatureState}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.onAdd=function(m){this.map=m,this._maxTileCacheSize=m?m._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(m)},y.prototype.onRemove=function(m){this._source&&this._source.onRemove&&this._source.onRemove(m)},y.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var m in this._tiles){var T=this._tiles[m];if(T.state!=="loaded"&&T.state!=="errored")return!1}return!0},y.prototype.getSource=function(){return this._source},y.prototype.pause=function(){this._paused=!0},y.prototype.resume=function(){if(this._paused){var m=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,m&&this.reload(),this.transform&&this.update(this.transform)}},y.prototype._loadTile=function(m,T){return this._source.loadTile(m,T)},y.prototype._unloadTile=function(m){if(this._source.unloadTile)return this._source.unloadTile(m,function(){})},y.prototype._abortTile=function(m){if(this._source.abortTile)return this._source.abortTile(m,function(){})},y.prototype.serialize=function(){return this._source.serialize()},y.prototype.prepare=function(m){for(var T in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var O=this._tiles[T];O.upload(m),O.prepare(this.map.style.imageManager)}},y.prototype.getIds=function(){return i.values(this._tiles).map(function(m){return m.tileID}).sort(ce).map(function(m){return m.key})},y.prototype.getRenderableIds=function(m){var T=this,O=[];for(var U in this._tiles)this._isIdRenderable(U,m)&&O.push(this._tiles[U]);return m?O.sort(function(j,K){var it=j.tileID,pt=K.tileID,Et=new i.Point(it.canonical.x,it.canonical.y)._rotate(T.transform.angle),Ct=new i.Point(pt.canonical.x,pt.canonical.y)._rotate(T.transform.angle);return it.overscaledZ-pt.overscaledZ||Ct.y-Et.y||Ct.x-Et.x}).map(function(j){return j.tileID.key}):O.map(function(j){return j.tileID}).sort(ce).map(function(j){return j.key})},y.prototype.hasRenderableParent=function(m){var T=this.findLoadedParent(m,0);return!!T&&this._isIdRenderable(T.tileID.key)},y.prototype._isIdRenderable=function(m,T){return this._tiles[m]&&this._tiles[m].hasData()&&!this._coveredTiles[m]&&(T||!this._tiles[m].holdingForFade())},y.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var m in this._cache.reset(),this._tiles)this._tiles[m].state!=="errored"&&this._reloadTile(m,"reloading")},y.prototype._reloadTile=function(m,T){var O=this._tiles[m];O&&(O.state!=="loading"&&(O.state=T),this._loadTile(O,this._tileLoaded.bind(this,O,m,T)))},y.prototype._tileLoaded=function(m,T,O,U){if(U)return m.state="errored",void(U.status!==404?this._source.fire(new i.ErrorEvent(U,{tile:m})):this.update(this.transform));m.timeAdded=i.browser.now(),O==="expired"&&(m.refreshedUponExpiration=!0),this._setTileReloadTimer(T,m),this.getSource().type==="raster-dem"&&m.dem&&this._backfillDEM(m),this._state.initializeTileState(m,this.map?this.map.painter:null),this._source.fire(new i.Event("data",{dataType:"source",tile:m,coord:m.tileID}))},y.prototype._backfillDEM=function(m){for(var T=this.getRenderableIds(),O=0;O<T.length;O++){var U=T[O];if(m.neighboringTiles&&m.neighboringTiles[U]){var j=this.getTileByID(U);K(m,j),K(j,m)}}function K(it,pt){it.needsHillshadePrepare=!0;var Et=pt.tileID.canonical.x-it.tileID.canonical.x,Ct=pt.tileID.canonical.y-it.tileID.canonical.y,Pt=Math.pow(2,it.tileID.canonical.z),Vt=pt.tileID.key;Et===0&&Ct===0||Math.abs(Ct)>1||(Math.abs(Et)>1&&(Math.abs(Et+Pt)===1?Et+=Pt:Math.abs(Et-Pt)===1&&(Et-=Pt)),pt.dem&&it.dem&&(it.dem.backfillBorder(pt.dem,Et,Ct),it.neighboringTiles&&it.neighboringTiles[Vt]&&(it.neighboringTiles[Vt].backfilled=!0)))}},y.prototype.getTile=function(m){return this.getTileByID(m.key)},y.prototype.getTileByID=function(m){return this._tiles[m]},y.prototype._retainLoadedChildren=function(m,T,O,U){for(var j in this._tiles){var K=this._tiles[j];if(!(U[j]||!K.hasData()||K.tileID.overscaledZ<=T||K.tileID.overscaledZ>O)){for(var it=K.tileID;K&&K.tileID.overscaledZ>T+1;){var pt=K.tileID.scaledTo(K.tileID.overscaledZ-1);(K=this._tiles[pt.key])&&K.hasData()&&(it=pt)}for(var Et=it;Et.overscaledZ>T;)if(m[(Et=Et.scaledTo(Et.overscaledZ-1)).key]){U[it.key]=it;break}}}},y.prototype.findLoadedParent=function(m,T){if(m.key in this._loadedParentTiles){var O=this._loadedParentTiles[m.key];return O&&O.tileID.overscaledZ>=T?O:null}for(var U=m.overscaledZ-1;U>=T;U--){var j=m.scaledTo(U),K=this._getLoadedTile(j);if(K)return K}},y.prototype._getLoadedTile=function(m){var T=this._tiles[m.key];return T&&T.hasData()?T:this._cache.getByKey(m.wrapped().key)},y.prototype.updateCacheSize=function(m){var T=Math.ceil(m.width/this._source.tileSize)+1,O=Math.ceil(m.height/this._source.tileSize)+1,U=Math.floor(T*O*5),j=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,U):U;this._cache.setMaxSize(j)},y.prototype.handleWrapJump=function(m){var T=Math.round((m-(this._prevLng===void 0?m:this._prevLng))/360);if(this._prevLng=m,T){var O={};for(var U in this._tiles){var j=this._tiles[U];j.tileID=j.tileID.unwrapTo(j.tileID.wrap+T),O[j.tileID.key]=j}for(var K in this._tiles=O,this._timers)clearTimeout(this._timers[K]),delete this._timers[K];for(var it in this._tiles)this._setTileReloadTimer(it,this._tiles[it])}},y.prototype.update=function(m){var T=this;if(this.transform=m,this._sourceLoaded&&!this._paused){var O;this.updateCacheSize(m),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?O=m.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Ve){return new i.OverscaledTileID(Ve.canonical.z,Ve.wrap,Ve.canonical.z,Ve.canonical.x,Ve.canonical.y)}):(O=m.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(O=O.filter(function(Ve){return T._source.hasTile(Ve)}))):O=[];var U=m.coveringZoomLevel(this._source),j=Math.max(U-y.maxOverzooming,this._source.minzoom),K=Math.max(U+y.maxUnderzooming,this._source.minzoom),it=this._updateRetainedTiles(O,U);if(je(this._source.type)){for(var pt={},Et={},Ct=0,Pt=Object.keys(it);Ct<Pt.length;Ct+=1){var Vt=Pt[Ct],Ft=it[Vt],Yt=this._tiles[Vt];if(Yt&&!(Yt.fadeEndTime&&Yt.fadeEndTime<=i.browser.now())){var Dt=this.findLoadedParent(Ft,j);Dt&&(this._addTile(Dt.tileID),pt[Dt.tileID.key]=Dt.tileID),Et[Vt]=Ft}}for(var Xt in this._retainLoadedChildren(Et,U,K,it),pt)it[Xt]||(this._coveredTiles[Xt]=!0,it[Xt]=pt[Xt])}for(var te in it)this._tiles[te].clearFadeHold();for(var le=0,be=i.keysDifference(this._tiles,it);le<be.length;le+=1){var Ae=be[le],Me=this._tiles[Ae];Me.hasSymbolBuckets&&!Me.holdingForFade()?Me.setHoldDuration(this.map._fadeDuration):Me.hasSymbolBuckets&&!Me.symbolFadeFinished()||this._removeTile(Ae)}this._updateLoadedParentTileCache()}},y.prototype.releaseSymbolFadeTiles=function(){for(var m in this._tiles)this._tiles[m].holdingForFade()&&this._removeTile(m)},y.prototype._updateRetainedTiles=function(m,T){for(var O={},U={},j=Math.max(T-y.maxOverzooming,this._source.minzoom),K=Math.max(T+y.maxUnderzooming,this._source.minzoom),it={},pt=0,Et=m;pt<Et.length;pt+=1){var Ct=Et[pt],Pt=this._addTile(Ct);O[Ct.key]=Ct,Pt.hasData()||T<this._source.maxzoom&&(it[Ct.key]=Ct)}this._retainLoadedChildren(it,T,K,O);for(var Vt=0,Ft=m;Vt<Ft.length;Vt+=1){var Yt=Ft[Vt],Dt=this._tiles[Yt.key];if(!Dt.hasData()){if(T+1>this._source.maxzoom){var Xt=Yt.children(this._source.maxzoom)[0],te=this.getTile(Xt);if(te&&te.hasData()){O[Xt.key]=Xt;continue}}else{var le=Yt.children(this._source.maxzoom);if(O[le[0].key]&&O[le[1].key]&&O[le[2].key]&&O[le[3].key])continue}for(var be=Dt.wasRequested(),Ae=Yt.overscaledZ-1;Ae>=j;--Ae){var Me=Yt.scaledTo(Ae);if(U[Me.key]||(U[Me.key]=!0,!(Dt=this.getTile(Me))&&be&&(Dt=this._addTile(Me)),Dt&&(O[Me.key]=Me,be=Dt.wasRequested(),Dt.hasData())))break}}}return O},y.prototype._updateLoadedParentTileCache=function(){for(var m in this._loadedParentTiles={},this._tiles){for(var T=[],O=void 0,U=this._tiles[m].tileID;U.overscaledZ>0;){if(U.key in this._loadedParentTiles){O=this._loadedParentTiles[U.key];break}T.push(U.key);var j=U.scaledTo(U.overscaledZ-1);if(O=this._getLoadedTile(j))break;U=j}for(var K=0,it=T;K<it.length;K+=1)this._loadedParentTiles[it[K]]=O}},y.prototype._addTile=function(m){var T=this._tiles[m.key];if(T)return T;(T=this._cache.getAndRemove(m))&&(this._setTileReloadTimer(m.key,T),T.tileID=m,this._state.initializeTileState(T,this.map?this.map.painter:null),this._cacheTimers[m.key]&&(clearTimeout(this._cacheTimers[m.key]),delete this._cacheTimers[m.key],this._setTileReloadTimer(m.key,T)));var O=Boolean(T);return O||(T=new i.Tile(m,this._source.tileSize*m.overscaleFactor()),this._loadTile(T,this._tileLoaded.bind(this,T,m.key,T.state))),T?(T.uses++,this._tiles[m.key]=T,O||this._source.fire(new i.Event("dataloading",{tile:T,coord:T.tileID,dataType:"source"})),T):null},y.prototype._setTileReloadTimer=function(m,T){var O=this;m in this._timers&&(clearTimeout(this._timers[m]),delete this._timers[m]);var U=T.getExpiryTimeout();U&&(this._timers[m]=setTimeout(function(){O._reloadTile(m,"expired"),delete O._timers[m]},U))},y.prototype._removeTile=function(m){var T=this._tiles[m];T&&(T.uses--,delete this._tiles[m],this._timers[m]&&(clearTimeout(this._timers[m]),delete this._timers[m]),T.uses>0||(T.hasData()&&T.state!=="reloading"?this._cache.add(T.tileID,T,T.getExpiryTimeout()):(T.aborted=!0,this._abortTile(T),this._unloadTile(T))))},y.prototype.clearTiles=function(){for(var m in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(m);this._cache.reset()},y.prototype.tilesIn=function(m,T,O){var U=this,j=[],K=this.transform;if(!K)return j;for(var it=O?K.getCameraQueryGeometry(m):m,pt=m.map(function(Ae){return K.pointCoordinate(Ae)}),Et=it.map(function(Ae){return K.pointCoordinate(Ae)}),Ct=this.getIds(),Pt=1/0,Vt=1/0,Ft=-1/0,Yt=-1/0,Dt=0,Xt=Et;Dt<Xt.length;Dt+=1){var te=Xt[Dt];Pt=Math.min(Pt,te.x),Vt=Math.min(Vt,te.y),Ft=Math.max(Ft,te.x),Yt=Math.max(Yt,te.y)}for(var le=function(Ae){var Me=U._tiles[Ct[Ae]];if(!Me.holdingForFade()){var Ve=Me.tileID,Je=Math.pow(2,K.zoom-Me.tileID.overscaledZ),$e=T*Me.queryPadding*i.EXTENT/Me.tileSize/Je,wr=[Ve.getTilePoint(new i.MercatorCoordinate(Pt,Vt)),Ve.getTilePoint(new i.MercatorCoordinate(Ft,Yt))];if(wr[0].x-$e<i.EXTENT&&wr[0].y-$e<i.EXTENT&&wr[1].x+$e>=0&&wr[1].y+$e>=0){var qr=pt.map(function(Kr){return Ve.getTilePoint(Kr)}),$r=Et.map(function(Kr){return Ve.getTilePoint(Kr)});j.push({tile:Me,tileID:Ve,queryGeometry:qr,cameraQueryGeometry:$r,scale:Je})}}},be=0;be<Ct.length;be++)le(be);return j},y.prototype.getVisibleCoordinates=function(m){for(var T=this,O=this.getRenderableIds(m).map(function(it){return T._tiles[it].tileID}),U=0,j=O;U<j.length;U+=1){var K=j[U];K.posMatrix=this.transform.calculatePosMatrix(K.toUnwrapped())}return O},y.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(je(this._source.type))for(var m in this._tiles){var T=this._tiles[m];if(T.fadeEndTime!==void 0&&T.fadeEndTime>=i.browser.now())return!0}return!1},y.prototype.setFeatureState=function(m,T,O){this._state.updateState(m=m||"_geojsonTileLayer",T,O)},y.prototype.removeFeatureState=function(m,T,O){this._state.removeFeatureState(m=m||"_geojsonTileLayer",T,O)},y.prototype.getFeatureState=function(m,T){return this._state.getState(m=m||"_geojsonTileLayer",T)},y.prototype.setDependencies=function(m,T,O){var U=this._tiles[m];U&&U.setDependencies(T,O)},y.prototype.reloadTilesForDependencies=function(m,T){for(var O in this._tiles)this._tiles[O].hasDependency(m,T)&&this._reloadTile(O,"reloading");this._cache.filter(function(U){return!U.hasDependency(m,T)})},y}(i.Evented);function ce(d,y){var m=Math.abs(2*d.wrap)-+(d.wrap<0),T=Math.abs(2*y.wrap)-+(y.wrap<0);return d.overscaledZ-y.overscaledZ||T-m||y.canonical.y-d.canonical.y||y.canonical.x-d.canonical.x}function je(d){return d==="raster"||d==="image"||d==="video"}function Ge(){return new i.window.Worker(Bu.workerUrl)}jt.maxOverzooming=10,jt.maxUnderzooming=3;var Pe="mapboxgl_preloaded_worker_pool",We=function(){this.active={}};We.prototype.acquire=function(d){if(!this.workers)for(this.workers=[];this.workers.length<We.workerCount;)this.workers.push(new Ge);return this.active[d]=!0,this.workers.slice()},We.prototype.release=function(d){delete this.active[d],this.numActive()===0&&(this.workers.forEach(function(y){y.terminate()}),this.workers=null)},We.prototype.isPreloaded=function(){return!!this.active[Pe]},We.prototype.numActive=function(){return Object.keys(this.active).length};var Rr,Cr=Math.floor(i.browser.hardwareConcurrency/2);function Re(){return Rr||(Rr=new We),Rr}function yr(d,y){var m={};for(var T in d)T!=="ref"&&(m[T]=d[T]);return i.refProperties.forEach(function(O){O in y&&(m[O]=y[O])}),m}function tr(d){d=d.slice();for(var y=Object.create(null),m=0;m<d.length;m++)y[d[m].id]=d[m];for(var T=0;T<d.length;T++)"ref"in d[T]&&(d[T]=yr(d[T],y[d[T].ref]));return d}We.workerCount=Math.max(Math.min(Cr,6),1);var cr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function wn(d,y,m){m.push({command:cr.addSource,args:[d,y[d]]})}function fr(d,y,m){y.push({command:cr.removeSource,args:[d]}),m[d]=!0}function On(d,y,m,T){fr(d,m,T),wn(d,y,m)}function Ci(d,y,m){var T;for(T in d[m])if(d[m].hasOwnProperty(T)&&T!=="data"&&!i.deepEqual(d[m][T],y[m][T]))return!1;for(T in y[m])if(y[m].hasOwnProperty(T)&&T!=="data"&&!i.deepEqual(d[m][T],y[m][T]))return!1;return!0}function Bn(d,y,m,T,O,U){var j;for(j in y=y||{},d=d||{})d.hasOwnProperty(j)&&(i.deepEqual(d[j],y[j])||m.push({command:U,args:[T,j,y[j],O]}));for(j in y)y.hasOwnProperty(j)&&!d.hasOwnProperty(j)&&(i.deepEqual(d[j],y[j])||m.push({command:U,args:[T,j,y[j],O]}))}function Zn(d){return d.id}function Yn(d,y){return d[y.id]=y,d}var Ns=function(d,y){this.reset(d,y)};Ns.prototype.reset=function(d,y){this.points=d||[],this._distances=[0];for(var m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(y||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Ns.prototype.lerp=function(d){if(this.points.length===1)return this.points[0];d=i.clamp(d,0,1);for(var y=1,m=this._distances[y],T=d*this.paddedLength+this.padding;m<T&&y<this._distances.length;)m=this._distances[++y];var O=y-1,U=this._distances[O],j=m-U,K=j>0?(T-U)/j:0;return this.points[O].mult(1-K).add(this.points[y].mult(K))};var di=function(d,y,m){var T=this.boxCells=[],O=this.circleCells=[];this.xCellCount=Math.ceil(d/m),this.yCellCount=Math.ceil(y/m);for(var U=0;U<this.xCellCount*this.yCellCount;U++)T.push([]),O.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=d,this.height=y,this.xScale=this.xCellCount/d,this.yScale=this.yCellCount/y,this.boxUid=0,this.circleUid=0};function yo(d,y,m,T,O){var U=i.create();return y?(i.scale(U,U,[1/O,1/O,1]),m||i.rotateZ(U,U,T.angle)):i.multiply(U,T.labelPlaneMatrix,d),U}function Pi(d,y,m,T,O){if(y){var U=i.clone(d);return i.scale(U,U,[O,O,1]),m||i.rotateZ(U,U,-T.angle),U}return T.glCoordMatrix}function Dn(d,y){var m=[d.x,d.y,0,1];ms(m,m,y);var T=m[3];return{point:new i.Point(m[0]/T,m[1]/T),signedDistanceFromCamera:T}}function ci(d,y){return .5+d/y*.5}function pa(d,y){var m=d[0]/d[3],T=d[1]/d[3];return m>=-y[0]&&m<=y[0]&&T>=-y[1]&&T<=y[1]}function lh(d,y,m,T,O,U,j,K){var it=T?d.textSizeData:d.iconSizeData,pt=i.evaluateSizeForZoom(it,m.transform.zoom),Et=[256/m.width*2+1,256/m.height*2+1],Ct=T?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;Ct.clear();for(var Pt=d.lineVertexArray,Vt=T?d.text.placedSymbolArray:d.icon.placedSymbolArray,Ft=m.transform.width/m.transform.height,Yt=!1,Dt=0;Dt<Vt.length;Dt++){var Xt=Vt.get(Dt);if(Xt.hidden||Xt.writingMode===i.WritingMode.vertical&&!Yt)Zs(Xt.numGlyphs,Ct);else{Yt=!1;var te=[Xt.anchorX,Xt.anchorY,0,1];if(i.transformMat4(te,te,y),pa(te,Et)){var le=ci(m.transform.cameraToCenterDistance,te[3]),be=i.evaluateSizeForFeature(it,pt,Xt),Ae=j?be/le:be*le,Me=new i.Point(Xt.anchorX,Xt.anchorY),Ve=Dn(Me,O).point,Je={},$e=tf(Xt,Ae,!1,K,y,O,U,d.glyphOffsetArray,Pt,Ct,Ve,Me,Je,Ft);Yt=$e.useVertical,($e.notEnoughRoom||Yt||$e.needsFlipping&&tf(Xt,Ae,!0,K,y,O,U,d.glyphOffsetArray,Pt,Ct,Ve,Me,Je,Ft).notEnoughRoom)&&Zs(Xt.numGlyphs,Ct)}else Zs(Xt.numGlyphs,Ct)}}T?d.text.dynamicLayoutVertexBuffer.updateData(Ct):d.icon.dynamicLayoutVertexBuffer.updateData(Ct)}function ns(d,y,m,T,O,U,j,K,it,pt,Et){var Ct=K.glyphStartIndex+K.numGlyphs,Pt=K.lineStartIndex,Vt=K.lineStartIndex+K.lineLength,Ft=y.getoffsetX(K.glyphStartIndex),Yt=y.getoffsetX(Ct-1),Dt=Xi(d*Ft,m,T,O,U,j,K.segment,Pt,Vt,it,pt,Et);if(!Dt)return null;var Xt=Xi(d*Yt,m,T,O,U,j,K.segment,Pt,Vt,it,pt,Et);return Xt?{first:Dt,last:Xt}:null}function ks(d,y,m,T){return d===i.WritingMode.horizontal&&Math.abs(m.y-y.y)>Math.abs(m.x-y.x)*T?{useVertical:!0}:(d===i.WritingMode.vertical?y.y<m.y:y.x>m.x)?{needsFlipping:!0}:null}function tf(d,y,m,T,O,U,j,K,it,pt,Et,Ct,Pt,Vt){var Ft,Yt=y/24,Dt=d.lineOffsetX*Yt,Xt=d.lineOffsetY*Yt;if(d.numGlyphs>1){var te=d.glyphStartIndex+d.numGlyphs,le=d.lineStartIndex,be=d.lineStartIndex+d.lineLength,Ae=ns(Yt,K,Dt,Xt,m,Et,Ct,d,it,U,Pt);if(!Ae)return{notEnoughRoom:!0};var Me=Dn(Ae.first.point,j).point,Ve=Dn(Ae.last.point,j).point;if(T&&!m){var Je=ks(d.writingMode,Me,Ve,Vt);if(Je)return Je}Ft=[Ae.first];for(var $e=d.glyphStartIndex+1;$e<te-1;$e++)Ft.push(Xi(Yt*K.getoffsetX($e),Dt,Xt,m,Et,Ct,d.segment,le,be,it,U,Pt));Ft.push(Ae.last)}else{if(T&&!m){var wr=Dn(Ct,O).point,qr=d.lineStartIndex+d.segment+1,$r=new i.Point(it.getx(qr),it.gety(qr)),Kr=Dn($r,O),ei=Kr.signedDistanceFromCamera>0?Kr.point:ws(Ct,$r,wr,1,O),Sr=ks(d.writingMode,wr,ei,Vt);if(Sr)return Sr}var mn=Xi(Yt*K.getoffsetX(d.glyphStartIndex),Dt,Xt,m,Et,Ct,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,it,U,Pt);if(!mn)return{notEnoughRoom:!0};Ft=[mn]}for(var An=0,cn=Ft;An<cn.length;An+=1){var ln=cn[An];i.addDynamicAttributes(pt,ln.point,ln.angle)}return{}}function ws(d,y,m,T,O){var U=Dn(d.add(d.sub(y)._unit()),O).point,j=m.sub(U);return m.add(j._mult(T/j.mag()))}function Xi(d,y,m,T,O,U,j,K,it,pt,Et,Ct){var Pt=T?d-y:d+y,Vt=Pt>0?1:-1,Ft=0;T&&(Vt*=-1,Ft=Math.PI),Vt<0&&(Ft+=Math.PI);for(var Yt=Vt>0?K+j:K+j+1,Dt=O,Xt=O,te=0,le=0,be=Math.abs(Pt),Ae=[];te+le<=be;){if((Yt+=Vt)<K||Yt>=it)return null;if(Xt=Dt,Ae.push(Dt),(Dt=Ct[Yt])===void 0){var Me=new i.Point(pt.getx(Yt),pt.gety(Yt)),Ve=Dn(Me,Et);if(Ve.signedDistanceFromCamera>0)Dt=Ct[Yt]=Ve.point;else{var Je=Yt-Vt;Dt=ws(te===0?U:new i.Point(pt.getx(Je),pt.gety(Je)),Me,Xt,be-te+1,Et)}}te+=le,le=Xt.dist(Dt)}var $e=(be-te)/le,wr=Dt.sub(Xt),qr=wr.mult($e)._add(Xt);qr._add(wr._unit()._perp()._mult(m*Vt));var $r=Ft+Math.atan2(Dt.y-Xt.y,Dt.x-Xt.x);return Ae.push(qr),{point:qr,angle:$r,path:Ae}}di.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},di.prototype.insert=function(d,y,m,T,O){this._forEachCell(y,m,T,O,this._insertBoxCell,this.boxUid++),this.boxKeys.push(d),this.bboxes.push(y),this.bboxes.push(m),this.bboxes.push(T),this.bboxes.push(O)},di.prototype.insertCircle=function(d,y,m,T){this._forEachCell(y-T,m-T,y+T,m+T,this._insertCircleCell,this.circleUid++),this.circleKeys.push(d),this.circles.push(y),this.circles.push(m),this.circles.push(T)},di.prototype._insertBoxCell=function(d,y,m,T,O,U){this.boxCells[O].push(U)},di.prototype._insertCircleCell=function(d,y,m,T,O,U){this.circleCells[O].push(U)},di.prototype._query=function(d,y,m,T,O,U){if(m<0||d>this.width||T<0||y>this.height)return!O&&[];var j=[];if(d<=0&&y<=0&&this.width<=m&&this.height<=T){if(O)return!0;for(var K=0;K<this.boxKeys.length;K++)j.push({key:this.boxKeys[K],x1:this.bboxes[4*K],y1:this.bboxes[4*K+1],x2:this.bboxes[4*K+2],y2:this.bboxes[4*K+3]});for(var it=0;it<this.circleKeys.length;it++){var pt=this.circles[3*it],Et=this.circles[3*it+1],Ct=this.circles[3*it+2];j.push({key:this.circleKeys[it],x1:pt-Ct,y1:Et-Ct,x2:pt+Ct,y2:Et+Ct})}return U?j.filter(U):j}return this._forEachCell(d,y,m,T,this._queryCell,j,{hitTest:O,seenUids:{box:{},circle:{}}},U),O?j.length>0:j},di.prototype._queryCircle=function(d,y,m,T,O){var U=d-m,j=d+m,K=y-m,it=y+m;if(j<0||U>this.width||it<0||K>this.height)return!T&&[];var pt=[];return this._forEachCell(U,K,j,it,this._queryCellCircle,pt,{hitTest:T,circle:{x:d,y,radius:m},seenUids:{box:{},circle:{}}},O),T?pt.length>0:pt},di.prototype.query=function(d,y,m,T,O){return this._query(d,y,m,T,!1,O)},di.prototype.hitTest=function(d,y,m,T,O){return this._query(d,y,m,T,!0,O)},di.prototype.hitTestCircle=function(d,y,m,T){return this._queryCircle(d,y,m,!0,T)},di.prototype._queryCell=function(d,y,m,T,O,U,j,K){var it=j.seenUids,pt=this.boxCells[O];if(pt!==null)for(var Et=this.bboxes,Ct=0,Pt=pt;Ct<Pt.length;Ct+=1){var Vt=Pt[Ct];if(!it.box[Vt]){it.box[Vt]=!0;var Ft=4*Vt;if(d<=Et[Ft+2]&&y<=Et[Ft+3]&&m>=Et[Ft+0]&&T>=Et[Ft+1]&&(!K||K(this.boxKeys[Vt]))){if(j.hitTest)return U.push(!0),!0;U.push({key:this.boxKeys[Vt],x1:Et[Ft],y1:Et[Ft+1],x2:Et[Ft+2],y2:Et[Ft+3]})}}}var Yt=this.circleCells[O];if(Yt!==null)for(var Dt=this.circles,Xt=0,te=Yt;Xt<te.length;Xt+=1){var le=te[Xt];if(!it.circle[le]){it.circle[le]=!0;var be=3*le;if(this._circleAndRectCollide(Dt[be],Dt[be+1],Dt[be+2],d,y,m,T)&&(!K||K(this.circleKeys[le]))){if(j.hitTest)return U.push(!0),!0;var Ae=Dt[be],Me=Dt[be+1],Ve=Dt[be+2];U.push({key:this.circleKeys[le],x1:Ae-Ve,y1:Me-Ve,x2:Ae+Ve,y2:Me+Ve})}}}},di.prototype._queryCellCircle=function(d,y,m,T,O,U,j,K){var it=j.circle,pt=j.seenUids,Et=this.boxCells[O];if(Et!==null)for(var Ct=this.bboxes,Pt=0,Vt=Et;Pt<Vt.length;Pt+=1){var Ft=Vt[Pt];if(!pt.box[Ft]){pt.box[Ft]=!0;var Yt=4*Ft;if(this._circleAndRectCollide(it.x,it.y,it.radius,Ct[Yt+0],Ct[Yt+1],Ct[Yt+2],Ct[Yt+3])&&(!K||K(this.boxKeys[Ft])))return U.push(!0),!0}}var Dt=this.circleCells[O];if(Dt!==null)for(var Xt=this.circles,te=0,le=Dt;te<le.length;te+=1){var be=le[te];if(!pt.circle[be]){pt.circle[be]=!0;var Ae=3*be;if(this._circlesCollide(Xt[Ae],Xt[Ae+1],Xt[Ae+2],it.x,it.y,it.radius)&&(!K||K(this.circleKeys[be])))return U.push(!0),!0}}},di.prototype._forEachCell=function(d,y,m,T,O,U,j,K){for(var it=this._convertToXCellCoord(d),pt=this._convertToYCellCoord(y),Et=this._convertToXCellCoord(m),Ct=this._convertToYCellCoord(T),Pt=it;Pt<=Et;Pt++)for(var Vt=pt;Vt<=Ct;Vt++)if(O.call(this,d,y,m,T,this.xCellCount*Vt+Pt,U,j,K))return},di.prototype._convertToXCellCoord=function(d){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(d*this.xScale)))},di.prototype._convertToYCellCoord=function(d){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(d*this.yScale)))},di.prototype._circlesCollide=function(d,y,m,T,O,U){var j=T-d,K=O-y,it=m+U;return it*it>j*j+K*K},di.prototype._circleAndRectCollide=function(d,y,m,T,O,U,j){var K=(U-T)/2,it=Math.abs(d-(T+K));if(it>K+m)return!1;var pt=(j-O)/2,Et=Math.abs(y-(O+pt));if(Et>pt+m)return!1;if(it<=K||Et<=pt)return!0;var Ct=it-K,Pt=Et-pt;return Ct*Ct+Pt*Pt<=m*m};var Yl=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Zs(d,y){for(var m=0;m<d;m++){var T=y.length;y.resize(T+4),y.float32.set(Yl,3*T)}}function ms(d,y,m){var T=y[0],O=y[1];return d[0]=m[0]*T+m[4]*O+m[12],d[1]=m[1]*T+m[5]*O+m[13],d[3]=m[3]*T+m[7]*O+m[15],d}var Sa=function(d,y,m){y===void 0&&(y=new di(d.width+200,d.height+200,25)),m===void 0&&(m=new di(d.width+200,d.height+200,25)),this.transform=d,this.grid=y,this.ignoredGrid=m,this.pitchfactor=Math.cos(d._pitch)*d.cameraToCenterDistance,this.screenRightBoundary=d.width+100,this.screenBottomBoundary=d.height+100,this.gridRightBoundary=d.width+200,this.gridBottomBoundary=d.height+200};function Yi(d,y,m){return y*(i.EXTENT/(d.tileSize*Math.pow(2,m-d.tileID.overscaledZ)))}Sa.prototype.placeCollisionBox=function(d,y,m,T,O){var U=this.projectAndGetPerspectiveRatio(T,d.anchorPointX,d.anchorPointY),j=m*U.perspectiveRatio,K=d.x1*j+U.point.x,it=d.y1*j+U.point.y,pt=d.x2*j+U.point.x,Et=d.y2*j+U.point.y;return!this.isInsideGrid(K,it,pt,Et)||!y&&this.grid.hitTest(K,it,pt,Et,O)?{box:[],offscreen:!1}:{box:[K,it,pt,Et],offscreen:this.isOffscreen(K,it,pt,Et)}},Sa.prototype.placeCollisionCircles=function(d,y,m,T,O,U,j,K,it,pt,Et,Ct,Pt){var Vt=[],Ft=new i.Point(y.anchorX,y.anchorY),Yt=Dn(Ft,U),Dt=ci(this.transform.cameraToCenterDistance,Yt.signedDistanceFromCamera),Xt=(pt?O/Dt:O*Dt)/i.ONE_EM,te=Dn(Ft,j).point,le=ns(Xt,T,y.lineOffsetX*Xt,y.lineOffsetY*Xt,!1,te,Ft,y,m,j,{}),be=!1,Ae=!1,Me=!0;if(le){for(var Ve=.5*Ct*Dt+Pt,Je=new i.Point(-100,-100),$e=new i.Point(this.screenRightBoundary,this.screenBottomBoundary),wr=new Ns,qr=le.first,$r=le.last,Kr=[],ei=qr.path.length-1;ei>=1;ei--)Kr.push(qr.path[ei]);for(var Sr=1;Sr<$r.path.length;Sr++)Kr.push($r.path[Sr]);var mn=2.5*Ve;if(K){var An=Kr.map(function(Dc){return Dn(Dc,K)});Kr=An.some(function(Dc){return Dc.signedDistanceFromCamera<=0})?[]:An.map(function(Dc){return Dc.point})}var cn=[];if(Kr.length>0){for(var ln=Kr[0].clone(),Tn=Kr[0].clone(),an=1;an<Kr.length;an++)ln.x=Math.min(ln.x,Kr[an].x),ln.y=Math.min(ln.y,Kr[an].y),Tn.x=Math.max(Tn.x,Kr[an].x),Tn.y=Math.max(Tn.y,Kr[an].y);cn=ln.x>=Je.x&&Tn.x<=$e.x&&ln.y>=Je.y&&Tn.y<=$e.y?[Kr]:Tn.x<Je.x||ln.x>$e.x||Tn.y<Je.y||ln.y>$e.y?[]:i.clipLine([Kr],Je.x,Je.y,$e.x,$e.y)}for(var en=0,gs=cn;en<gs.length;en+=1){var Fi;wr.reset(gs[en],.25*Ve),Fi=wr.length<=.5*Ve?1:Math.ceil(wr.paddedLength/mn)+1;for(var Vs=0;Vs<Fi;Vs++){var _s=Vs/Math.max(Fi-1,1),vo=wr.lerp(_s),Uo=vo.x+100,Ka=vo.y+100;Vt.push(Uo,Ka,Ve,0);var ga=Uo-Ve,Du=Ka-Ve,La=Uo+Ve,sl=Ka+Ve;if(Me=Me&&this.isOffscreen(ga,Du,La,sl),Ae=Ae||this.isInsideGrid(ga,Du,La,sl),!d&&this.grid.hitTestCircle(Uo,Ka,Ve,Et)&&(be=!0,!it))return{circles:[],offscreen:!1,collisionDetected:be}}}}return{circles:!it&&be||!Ae?[]:Vt,offscreen:Me,collisionDetected:be}},Sa.prototype.queryRenderedSymbols=function(d){if(d.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var y=[],m=1/0,T=1/0,O=-1/0,U=-1/0,j=0,K=d;j<K.length;j+=1){var it=K[j],pt=new i.Point(it.x+100,it.y+100);m=Math.min(m,pt.x),T=Math.min(T,pt.y),O=Math.max(O,pt.x),U=Math.max(U,pt.y),y.push(pt)}for(var Et={},Ct={},Pt=0,Vt=this.grid.query(m,T,O,U).concat(this.ignoredGrid.query(m,T,O,U));Pt<Vt.length;Pt+=1){var Ft=Vt[Pt],Yt=Ft.key;if(Et[Yt.bucketInstanceId]===void 0&&(Et[Yt.bucketInstanceId]={}),!Et[Yt.bucketInstanceId][Yt.featureIndex]){var Dt=[new i.Point(Ft.x1,Ft.y1),new i.Point(Ft.x2,Ft.y1),new i.Point(Ft.x2,Ft.y2),new i.Point(Ft.x1,Ft.y2)];i.polygonIntersectsPolygon(y,Dt)&&(Et[Yt.bucketInstanceId][Yt.featureIndex]=!0,Ct[Yt.bucketInstanceId]===void 0&&(Ct[Yt.bucketInstanceId]=[]),Ct[Yt.bucketInstanceId].push(Yt.featureIndex))}}return Ct},Sa.prototype.insertCollisionBox=function(d,y,m,T,O){(y?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:T,collisionGroupID:O},d[0],d[1],d[2],d[3])},Sa.prototype.insertCollisionCircles=function(d,y,m,T,O){for(var U=y?this.ignoredGrid:this.grid,j={bucketInstanceId:m,featureIndex:T,collisionGroupID:O},K=0;K<d.length;K+=4)U.insertCircle(j,d[K],d[K+1],d[K+2])},Sa.prototype.projectAndGetPerspectiveRatio=function(d,y,m){var T=[y,m,0,1];return ms(T,T,d),{point:new i.Point((T[0]/T[3]+1)/2*this.transform.width+100,(-T[1]/T[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/T[3]*.5}},Sa.prototype.isOffscreen=function(d,y,m,T){return m<100||d>=this.screenRightBoundary||T<100||y>this.screenBottomBoundary},Sa.prototype.isInsideGrid=function(d,y,m,T){return m>=0&&d<this.gridRightBoundary&&T>=0&&y<this.gridBottomBoundary},Sa.prototype.getViewportMatrix=function(){var d=i.identity([]);return i.translate(d,d,[-100,-100,0]),d};var Ca=function(d,y,m,T){this.opacity=d?Math.max(0,Math.min(1,d.opacity+(d.placed?y:-y))):T&&m?1:0,this.placed=m};Ca.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Pa=function(d,y,m,T,O){this.text=new Ca(d?d.text:null,y,m,O),this.icon=new Ca(d?d.icon:null,y,T,O)};Pa.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var yA=function(d,y,m){this.text=d,this.icon=y,this.skipFade=m},fc=function(){this.invProjMatrix=i.create(),this.viewportMatrix=i.create(),this.circles=[]},Rc=function(d,y,m,T,O){this.bucketInstanceId=d,this.featureIndex=y,this.sourceLayerIndex=m,this.bucketIndex=T,this.tileID=O},rl=function(d){this.crossSourceCollisions=d,this.maxGroupID=0,this.collisionGroups={}};function ko(d,y,m,T,O){var U=i.getAnchorAlignment(d),j=-(U.horizontalAlign-.5)*y,K=-(U.verticalAlign-.5)*m,it=i.evaluateVariableOffset(d,T);return new i.Point(j+it[0]*O,K+it[1]*O)}function nl(d,y,m,T,O,U){var j=d.x1,K=d.x2,it=d.y1,pt=d.y2,Et=d.anchorPointX,Ct=d.anchorPointY,Pt=new i.Point(y,m);return T&&Pt._rotate(O?U:-U),{x1:j+Pt.x,y1:it+Pt.y,x2:K+Pt.x,y2:pt+Pt.y,anchorPointX:Et,anchorPointY:Ct}}rl.prototype.get=function(d){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[d]){var y=++this.maxGroupID;this.collisionGroups[d]={ID:y,predicate:function(m){return m.collisionGroupID===y}}}return this.collisionGroups[d]};var $s=function(d,y,m,T){this.transform=d.clone(),this.collisionIndex=new Sa(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=y,this.retainedQueryData={},this.collisionGroups=new rl(m),this.collisionCircleArrays={},this.prevPlacement=T,T&&(T.prevPlacement=void 0),this.placedOrientations={}};function Ha(d,y,m,T,O){d.emplaceBack(y?1:0,m?1:0,T||0,O||0),d.emplaceBack(y?1:0,m?1:0,T||0,O||0),d.emplaceBack(y?1:0,m?1:0,T||0,O||0),d.emplaceBack(y?1:0,m?1:0,T||0,O||0)}$s.prototype.getBucketParts=function(d,y,m,T){var O=m.getBucket(y),U=m.latestFeatureIndex;if(O&&U&&y.id===O.layerIds[0]){var j=m.collisionBoxArray,K=O.layers[0].layout,it=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),pt=m.tileSize/i.EXTENT,Et=this.transform.calculatePosMatrix(m.tileID.toUnwrapped()),Ct=K.get("text-pitch-alignment")==="map",Pt=K.get("text-rotation-alignment")==="map",Vt=Yi(m,1,this.transform.zoom),Ft=yo(Et,Ct,Pt,this.transform,Vt),Yt=null;if(Ct){var Dt=Pi(Et,Ct,Pt,this.transform,Vt);Yt=i.multiply([],this.transform.labelPlaneMatrix,Dt)}this.retainedQueryData[O.bucketInstanceId]=new Rc(O.bucketInstanceId,U,O.sourceLayerIndex,O.index,m.tileID);var Xt={bucket:O,layout:K,posMatrix:Et,textLabelPlaneMatrix:Ft,labelToScreenMatrix:Yt,scale:it,textPixelRatio:pt,holdingForFade:m.holdingForFade(),collisionBoxArray:j,partiallyEvaluatedTextSize:i.evaluateSizeForZoom(O.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(O.sourceID)};if(T)for(var te=0,le=O.sortKeyRanges;te<le.length;te+=1){var be=le[te];d.push({sortKey:be.sortKey,symbolInstanceStart:be.symbolInstanceStart,symbolInstanceEnd:be.symbolInstanceEnd,parameters:Xt})}else d.push({symbolInstanceStart:0,symbolInstanceEnd:O.symbolInstances.length,parameters:Xt})}},$s.prototype.attemptAnchorPlacement=function(d,y,m,T,O,U,j,K,it,pt,Et,Ct,Pt,Vt,Ft){var Yt,Dt=[Ct.textOffset0,Ct.textOffset1],Xt=ko(d,m,T,Dt,O),te=this.collisionIndex.placeCollisionBox(nl(y,Xt.x,Xt.y,U,j,this.transform.angle),Et,K,it,pt.predicate);if(!Ft||this.collisionIndex.placeCollisionBox(nl(Ft,Xt.x,Xt.y,U,j,this.transform.angle),Et,K,it,pt.predicate).box.length!==0)return te.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Ct.crossTileID]&&this.prevPlacement.placements[Ct.crossTileID]&&this.prevPlacement.placements[Ct.crossTileID].text&&(Yt=this.prevPlacement.variableOffsets[Ct.crossTileID].anchor),this.variableOffsets[Ct.crossTileID]={textOffset:Dt,width:m,height:T,anchor:d,textBoxScale:O,prevAnchor:Yt},this.markUsedJustification(Pt,d,Ct,Vt),Pt.allowVerticalPlacement&&(this.markUsedOrientation(Pt,Vt,Ct),this.placedOrientations[Ct.crossTileID]=Vt),{shift:Xt,placedGlyphBoxes:te}):void 0},$s.prototype.placeLayerBucketPart=function(d,y,m){var T=this,O=d.parameters,U=O.bucket,j=O.layout,K=O.posMatrix,it=O.textLabelPlaneMatrix,pt=O.labelToScreenMatrix,Et=O.textPixelRatio,Ct=O.holdingForFade,Pt=O.collisionBoxArray,Vt=O.partiallyEvaluatedTextSize,Ft=O.collisionGroup,Yt=j.get("text-optional"),Dt=j.get("icon-optional"),Xt=j.get("text-allow-overlap"),te=j.get("icon-allow-overlap"),le=j.get("text-rotation-alignment")==="map",be=j.get("text-pitch-alignment")==="map",Ae=j.get("icon-text-fit")!=="none",Me=j.get("symbol-z-order")==="viewport-y",Ve=Xt&&(te||!U.hasIconData()||Dt),Je=te&&(Xt||!U.hasTextData()||Yt);!U.collisionArrays&&Pt&&U.deserializeCollisionBoxes(Pt);var $e=function(Sr,mn){if(!y[Sr.crossTileID])if(Ct)T.placements[Sr.crossTileID]=new yA(!1,!1,!1);else{var An,cn=!1,ln=!1,Tn=!0,an=null,en={box:null,offscreen:null},gs={box:null,offscreen:null},Fi=null,Vs=null,_s=0,vo=0,Uo=0;mn.textFeatureIndex?_s=mn.textFeatureIndex:Sr.useRuntimeCollisionCircles&&(_s=Sr.featureIndex),mn.verticalTextFeatureIndex&&(vo=mn.verticalTextFeatureIndex);var Ka=mn.textBox;if(Ka){var ga=function(gi){var Za=i.WritingMode.horizontal;if(U.allowVerticalPlacement&&!gi&&T.prevPlacement){var _a=T.prevPlacement.placedOrientations[Sr.crossTileID];_a&&(T.placedOrientations[Sr.crossTileID]=_a,T.markUsedOrientation(U,Za=_a,Sr))}return Za},Du=function(gi,Za){if(U.allowVerticalPlacement&&Sr.numVerticalGlyphVertices>0&&mn.verticalTextBox)for(var _a=0,Fu=U.writingModes;_a<Fu.length&&(Fu[_a]===i.WritingMode.vertical?(en=Za(),gs=en):en=gi(),!(en&&en.box&&en.box.length));_a+=1);else en=gi()};if(j.get("text-variable-anchor")){var La=j.get("text-variable-anchor");if(T.prevPlacement&&T.prevPlacement.variableOffsets[Sr.crossTileID]){var sl=T.prevPlacement.variableOffsets[Sr.crossTileID];La.indexOf(sl.anchor)>0&&(La=La.filter(function(gi){return gi!==sl.anchor})).unshift(sl.anchor)}var Dc=function(gi,Za,_a){for(var Fu=gi.x2-gi.x1,Ng=gi.y2-gi.y1,Wd=Sr.textBoxScale,Cx=Ae&&!te?Za:null,Tp={box:[],offscreen:!1},kg=Xt?2*La.length:La.length,_f=0;_f<kg;++_f){var al=T.attemptAnchorPlacement(La[_f%La.length],gi,Fu,Ng,Wd,le,be,Et,K,Ft,_f>=La.length,Sr,U,_a,Cx);if(al&&(Tp=al.placedGlyphBoxes)&&Tp.box&&Tp.box.length){cn=!0,an=al.shift;break}}return Tp};Du(function(){return Dc(Ka,mn.iconBox,i.WritingMode.horizontal)},function(){var gi=mn.verticalTextBox;return U.allowVerticalPlacement&&!(en&&en.box&&en.box.length)&&Sr.numVerticalGlyphVertices>0&&gi?Dc(gi,mn.verticalIconBox,i.WritingMode.vertical):{box:null,offscreen:null}}),en&&(cn=en.box,Tn=en.offscreen);var bp=ga(en&&en.box);if(!cn&&T.prevPlacement){var Af=T.prevPlacement.variableOffsets[Sr.crossTileID];Af&&(T.variableOffsets[Sr.crossTileID]=Af,T.markUsedJustification(U,Af.anchor,Sr,bp))}}else{var Nu=function(gi,Za){var _a=T.collisionIndex.placeCollisionBox(gi,Xt,Et,K,Ft.predicate);return _a&&_a.box&&_a.box.length&&(T.markUsedOrientation(U,Za,Sr),T.placedOrientations[Sr.crossTileID]=Za),_a};Du(function(){return Nu(Ka,i.WritingMode.horizontal)},function(){var gi=mn.verticalTextBox;return U.allowVerticalPlacement&&Sr.numVerticalGlyphVertices>0&&gi?Nu(gi,i.WritingMode.vertical):{box:null,offscreen:null}}),ga(en&&en.box&&en.box.length)}}if(cn=(An=en)&&An.box&&An.box.length>0,Tn=An&&An.offscreen,Sr.useRuntimeCollisionCircles){var xh=U.text.placedSymbolArray.get(Sr.centerJustifiedTextSymbolIndex),gf=i.evaluateSizeForFeature(U.textSizeData,Vt,xh),Ki=j.get("text-padding");Fi=T.collisionIndex.placeCollisionCircles(Xt,xh,U.lineVertexArray,U.glyphOffsetArray,gf,K,it,pt,m,be,Ft.predicate,Sr.collisionCircleDiameter,Ki),cn=Xt||Fi.circles.length>0&&!Fi.collisionDetected,Tn=Tn&&Fi.offscreen}if(mn.iconFeatureIndex&&(Uo=mn.iconFeatureIndex),mn.iconBox){var wp=function(gi){var Za=Ae&&an?nl(gi,an.x,an.y,le,be,T.transform.angle):gi;return T.collisionIndex.placeCollisionBox(Za,te,Et,K,Ft.predicate)};ln=gs&&gs.box&&gs.box.length&&mn.verticalIconBox?(Vs=wp(mn.verticalIconBox)).box.length>0:(Vs=wp(mn.iconBox)).box.length>0,Tn=Tn&&Vs.offscreen}var Pl=Yt||Sr.numHorizontalGlyphVertices===0&&Sr.numVerticalGlyphVertices===0,Ro=Dt||Sr.numIconVertices===0;if(Pl||Ro?Ro?Pl||(ln=ln&&cn):cn=ln&&cn:ln=cn=ln&&cn,cn&&An&&An.box&&T.collisionIndex.insertCollisionBox(An.box,j.get("text-ignore-placement"),U.bucketInstanceId,gs&&gs.box&&vo?vo:_s,Ft.ID),ln&&Vs&&T.collisionIndex.insertCollisionBox(Vs.box,j.get("icon-ignore-placement"),U.bucketInstanceId,Uo,Ft.ID),Fi&&(cn&&T.collisionIndex.insertCollisionCircles(Fi.circles,j.get("text-ignore-placement"),U.bucketInstanceId,_s,Ft.ID),m)){var ys=U.bucketInstanceId,ku=T.collisionCircleArrays[ys];ku===void 0&&(ku=T.collisionCircleArrays[ys]=new fc);for(var vh=0;vh<Fi.circles.length;vh+=4)ku.circles.push(Fi.circles[vh+0]),ku.circles.push(Fi.circles[vh+1]),ku.circles.push(Fi.circles[vh+2]),ku.circles.push(Fi.collisionDetected?1:0)}T.placements[Sr.crossTileID]=new yA(cn||Ve,ln||Je,Tn||U.justReloaded),y[Sr.crossTileID]=!0}};if(Me)for(var wr=U.getSortedSymbolIndexes(this.transform.angle),qr=wr.length-1;qr>=0;--qr){var $r=wr[qr];$e(U.symbolInstances.get($r),U.collisionArrays[$r])}else for(var Kr=d.symbolInstanceStart;Kr<d.symbolInstanceEnd;Kr++)$e(U.symbolInstances.get(Kr),U.collisionArrays[Kr]);if(m&&U.bucketInstanceId in this.collisionCircleArrays){var ei=this.collisionCircleArrays[U.bucketInstanceId];i.invert(ei.invProjMatrix,K),ei.viewportMatrix=this.collisionIndex.getViewportMatrix()}U.justReloaded=!1},$s.prototype.markUsedJustification=function(d,y,m,T){var O;O=T===i.WritingMode.vertical?m.verticalPlacedTextSymbolIndex:{left:m.leftJustifiedTextSymbolIndex,center:m.centerJustifiedTextSymbolIndex,right:m.rightJustifiedTextSymbolIndex}[i.getAnchorJustification(y)];for(var U=0,j=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex,m.verticalPlacedTextSymbolIndex];U<j.length;U+=1){var K=j[U];K>=0&&(d.text.placedSymbolArray.get(K).crossTileID=O>=0&&K!==O?0:m.crossTileID)}},$s.prototype.markUsedOrientation=function(d,y,m){for(var T=y===i.WritingMode.horizontal||y===i.WritingMode.horizontalOnly?y:0,O=y===i.WritingMode.vertical?y:0,U=0,j=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex];U<j.length;U+=1)d.text.placedSymbolArray.get(j[U]).placedOrientation=T;m.verticalPlacedTextSymbolIndex&&(d.text.placedSymbolArray.get(m.verticalPlacedTextSymbolIndex).placedOrientation=O)},$s.prototype.commit=function(d){this.commitTime=d,this.zoomAtLastRecencyCheck=this.transform.zoom;var y=this.prevPlacement,m=!1;this.prevZoomAdjustment=y?y.zoomAdjustment(this.transform.zoom):0;var T=y?y.symbolFadeChange(d):1,O=y?y.opacities:{},U=y?y.variableOffsets:{},j=y?y.placedOrientations:{};for(var K in this.placements){var it=this.placements[K],pt=O[K];pt?(this.opacities[K]=new Pa(pt,T,it.text,it.icon),m=m||it.text!==pt.text.placed||it.icon!==pt.icon.placed):(this.opacities[K]=new Pa(null,T,it.text,it.icon,it.skipFade),m=m||it.text||it.icon)}for(var Et in O){var Ct=O[Et];if(!this.opacities[Et]){var Pt=new Pa(Ct,T,!1,!1);Pt.isHidden()||(this.opacities[Et]=Pt,m=m||Ct.text.placed||Ct.icon.placed)}}for(var Vt in U)this.variableOffsets[Vt]||!this.opacities[Vt]||this.opacities[Vt].isHidden()||(this.variableOffsets[Vt]=U[Vt]);for(var Ft in j)this.placedOrientations[Ft]||!this.opacities[Ft]||this.opacities[Ft].isHidden()||(this.placedOrientations[Ft]=j[Ft]);m?this.lastPlacementChangeTime=d:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=y?y.lastPlacementChangeTime:d)},$s.prototype.updateLayerOpacities=function(d,y){for(var m={},T=0,O=y;T<O.length;T+=1){var U=O[T],j=U.getBucket(d);j&&U.latestFeatureIndex&&d.id===j.layerIds[0]&&this.updateBucketOpacities(j,m,U.collisionBoxArray)}},$s.prototype.updateBucketOpacities=function(d,y,m){var T=this;d.hasTextData()&&d.text.opacityVertexArray.clear(),d.hasIconData()&&d.icon.opacityVertexArray.clear(),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexArray.clear(),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexArray.clear();var O=d.layers[0].layout,U=new Pa(null,0,!1,!1,!0),j=O.get("text-allow-overlap"),K=O.get("icon-allow-overlap"),it=O.get("text-variable-anchor"),pt=O.get("text-rotation-alignment")==="map",Et=O.get("text-pitch-alignment")==="map",Ct=O.get("icon-text-fit")!=="none",Pt=new Pa(null,0,j&&(K||!d.hasIconData()||O.get("icon-optional")),K&&(j||!d.hasTextData()||O.get("text-optional")),!0);!d.collisionArrays&&m&&(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData())&&d.deserializeCollisionBoxes(m);for(var Vt=function(Xt,te,le){for(var be=0;be<te/4;be++)Xt.opacityVertexArray.emplaceBack(le)},Ft=function(Xt){var te=d.symbolInstances.get(Xt),le=te.numHorizontalGlyphVertices,be=te.numVerticalGlyphVertices,Ae=te.crossTileID,Me=T.opacities[Ae];y[Ae]?Me=U:Me||(T.opacities[Ae]=Me=Pt),y[Ae]=!0;var Ve=te.numIconVertices>0,Je=T.placedOrientations[te.crossTileID],$e=Je===i.WritingMode.vertical,wr=Je===i.WritingMode.horizontal||Je===i.WritingMode.horizontalOnly;if(le>0||be>0){var qr=Dd(Me.text);Vt(d.text,le,$e?uh:qr),Vt(d.text,be,wr?uh:qr);var $r=Me.text.isHidden();[te.rightJustifiedTextSymbolIndex,te.centerJustifiedTextSymbolIndex,te.leftJustifiedTextSymbolIndex].forEach(function(en){en>=0&&(d.text.placedSymbolArray.get(en).hidden=$r||$e?1:0)}),te.verticalPlacedTextSymbolIndex>=0&&(d.text.placedSymbolArray.get(te.verticalPlacedTextSymbolIndex).hidden=$r||wr?1:0);var Kr=T.variableOffsets[te.crossTileID];Kr&&T.markUsedJustification(d,Kr.anchor,te,Je);var ei=T.placedOrientations[te.crossTileID];ei&&(T.markUsedJustification(d,"left",te,ei),T.markUsedOrientation(d,ei,te))}if(Ve){var Sr=Dd(Me.icon),mn=!(Ct&&te.verticalPlacedIconSymbolIndex&&$e);te.placedIconSymbolIndex>=0&&(Vt(d.icon,te.numIconVertices,mn?Sr:uh),d.icon.placedSymbolArray.get(te.placedIconSymbolIndex).hidden=Me.icon.isHidden()),te.verticalPlacedIconSymbolIndex>=0&&(Vt(d.icon,te.numVerticalIconVertices,mn?uh:Sr),d.icon.placedSymbolArray.get(te.verticalPlacedIconSymbolIndex).hidden=Me.icon.isHidden())}if(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData()){var An=d.collisionArrays[Xt];if(An){var cn=new i.Point(0,0);if(An.textBox||An.verticalTextBox){var ln=!0;if(it){var Tn=T.variableOffsets[Ae];Tn?(cn=ko(Tn.anchor,Tn.width,Tn.height,Tn.textOffset,Tn.textBoxScale),pt&&cn._rotate(Et?T.transform.angle:-T.transform.angle)):ln=!1}An.textBox&&Ha(d.textCollisionBox.collisionVertexArray,Me.text.placed,!ln||$e,cn.x,cn.y),An.verticalTextBox&&Ha(d.textCollisionBox.collisionVertexArray,Me.text.placed,!ln||wr,cn.x,cn.y)}var an=Boolean(!wr&&An.verticalIconBox);An.iconBox&&Ha(d.iconCollisionBox.collisionVertexArray,Me.icon.placed,an,Ct?cn.x:0,Ct?cn.y:0),An.verticalIconBox&&Ha(d.iconCollisionBox.collisionVertexArray,Me.icon.placed,!an,Ct?cn.x:0,Ct?cn.y:0)}}},Yt=0;Yt<d.symbolInstances.length;Yt++)Ft(Yt);if(d.sortFeatures(this.transform.angle),this.retainedQueryData[d.bucketInstanceId]&&(this.retainedQueryData[d.bucketInstanceId].featureSortOrder=d.featureSortOrder),d.hasTextData()&&d.text.opacityVertexBuffer&&d.text.opacityVertexBuffer.updateData(d.text.opacityVertexArray),d.hasIconData()&&d.icon.opacityVertexBuffer&&d.icon.opacityVertexBuffer.updateData(d.icon.opacityVertexArray),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexBuffer&&d.iconCollisionBox.collisionVertexBuffer.updateData(d.iconCollisionBox.collisionVertexArray),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexBuffer&&d.textCollisionBox.collisionVertexBuffer.updateData(d.textCollisionBox.collisionVertexArray),d.bucketInstanceId in this.collisionCircleArrays){var Dt=this.collisionCircleArrays[d.bucketInstanceId];d.placementInvProjMatrix=Dt.invProjMatrix,d.placementViewportMatrix=Dt.viewportMatrix,d.collisionCircleArray=Dt.circles,delete this.collisionCircleArrays[d.bucketInstanceId]}},$s.prototype.symbolFadeChange=function(d){return this.fadeDuration===0?1:(d-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},$s.prototype.zoomAdjustment=function(d){return Math.max(0,(this.transform.zoom-d)/1.5)},$s.prototype.hasTransitions=function(d){return this.stale||d-this.lastPlacementChangeTime<this.fadeDuration},$s.prototype.stillRecent=function(d,y){var m=this.zoomAtLastRecencyCheck===y?1-this.zoomAdjustment(y):1;return this.zoomAtLastRecencyCheck=y,this.commitTime+this.fadeDuration*m>d},$s.prototype.setStale=function(){this.stale=!0};var wu=Math.pow(2,25),Id=Math.pow(2,24),Rd=Math.pow(2,17),ef=Math.pow(2,16),Ld=Math.pow(2,9),Od=Math.pow(2,8),Bd=Math.pow(2,1);function Dd(d){if(d.opacity===0&&!d.placed)return 0;if(d.opacity===1&&d.placed)return 4294967295;var y=d.placed?1:0,m=Math.floor(127*d.opacity);return m*wu+y*Id+m*Rd+y*ef+m*Ld+y*Od+m*Bd+y}var uh=0,hp=function(d){this._sortAcrossTiles=d.layout.get("symbol-z-order")!=="viewport-y"&&d.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};hp.prototype.continuePlacement=function(d,y,m,T,O){for(var U=this._bucketParts;this._currentTileIndex<d.length;)if(y.getBucketParts(U,T,d[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,O())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,U.sort(function(j,K){return j.sortKey-K.sortKey}));this._currentPartIndex<U.length;)if(y.placeLayerBucketPart(U[this._currentPartIndex],this._seenCrossTileIDs,m),this._currentPartIndex++,O())return!0;return!1};var rf=function(d,y,m,T,O,U,j){this.placement=new $s(d,O,U,j),this._currentPlacementIndex=y.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=T,this._done=!1};rf.prototype.isDone=function(){return this._done},rf.prototype.continuePlacement=function(d,y,m){for(var T=this,O=i.browser.now(),U=function(){var it=i.browser.now()-O;return!T._forceFullPlacement&&it>2};this._currentPlacementIndex>=0;){var j=y[d[this._currentPlacementIndex]],K=this.placement.collisionIndex.transform.zoom;if(j.type==="symbol"&&(!j.minzoom||j.minzoom<=K)&&(!j.maxzoom||j.maxzoom>K)){if(this._inProgressLayer||(this._inProgressLayer=new hp(j)),this._inProgressLayer.continuePlacement(m[j.source],this.placement,this._showCollisionBoxes,j,U))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},rf.prototype.commit=function(d){return this.placement.commit(d),this.placement};var xA=512/i.EXTENT/2,hh=function(d,y,m){this.tileID=d,this.indexedSymbolInstances={},this.bucketInstanceId=m;for(var T=0;T<y.length;T++){var O=y.get(T),U=O.key;this.indexedSymbolInstances[U]||(this.indexedSymbolInstances[U]=[]),this.indexedSymbolInstances[U].push({crossTileID:O.crossTileID,coord:this.getScaledCoordinates(O,d)})}};hh.prototype.getScaledCoordinates=function(d,y){var m=xA/Math.pow(2,y.canonical.z-this.tileID.canonical.z);return{x:Math.floor((y.canonical.x*i.EXTENT+d.anchorX)*m),y:Math.floor((y.canonical.y*i.EXTENT+d.anchorY)*m)}},hh.prototype.findMatches=function(d,y,m){for(var T=this.tileID.canonical.z<y.canonical.z?1:Math.pow(2,this.tileID.canonical.z-y.canonical.z),O=0;O<d.length;O++){var U=d.get(O);if(!U.crossTileID){var j=this.indexedSymbolInstances[U.key];if(j)for(var K=this.getScaledCoordinates(U,y),it=0,pt=j;it<pt.length;it+=1){var Et=pt[it];if(Math.abs(Et.coord.x-K.x)<=T&&Math.abs(Et.coord.y-K.y)<=T&&!m[Et.crossTileID]){m[Et.crossTileID]=!0,U.crossTileID=Et.crossTileID;break}}}}};var pc=function(){this.maxCrossTileID=0};pc.prototype.generate=function(){return++this.maxCrossTileID};var Kl=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Kl.prototype.handleWrapJump=function(d){var y=Math.round((d-this.lng)/360);if(y!==0)for(var m in this.indexes){var T=this.indexes[m],O={};for(var U in T){var j=T[U];j.tileID=j.tileID.unwrapTo(j.tileID.wrap+y),O[j.tileID.key]=j}this.indexes[m]=O}this.lng=d},Kl.prototype.addBucket=function(d,y,m){if(this.indexes[d.overscaledZ]&&this.indexes[d.overscaledZ][d.key]){if(this.indexes[d.overscaledZ][d.key].bucketInstanceId===y.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(d.overscaledZ,this.indexes[d.overscaledZ][d.key])}for(var T=0;T<y.symbolInstances.length;T++)y.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[d.overscaledZ]||(this.usedCrossTileIDs[d.overscaledZ]={});var O=this.usedCrossTileIDs[d.overscaledZ];for(var U in this.indexes){var j=this.indexes[U];if(Number(U)>d.overscaledZ)for(var K in j){var it=j[K];it.tileID.isChildOf(d)&&it.findMatches(y.symbolInstances,d,O)}else{var pt=j[d.scaledTo(Number(U)).key];pt&&pt.findMatches(y.symbolInstances,d,O)}}for(var Et=0;Et<y.symbolInstances.length;Et++){var Ct=y.symbolInstances.get(Et);Ct.crossTileID||(Ct.crossTileID=m.generate(),O[Ct.crossTileID]=!0)}return this.indexes[d.overscaledZ]===void 0&&(this.indexes[d.overscaledZ]={}),this.indexes[d.overscaledZ][d.key]=new hh(d,y.symbolInstances,y.bucketInstanceId),!0},Kl.prototype.removeBucketCrossTileIDs=function(d,y){for(var m in y.indexedSymbolInstances)for(var T=0,O=y.indexedSymbolInstances[m];T<O.length;T+=1)delete this.usedCrossTileIDs[d][O[T].crossTileID]},Kl.prototype.removeStaleBuckets=function(d){var y=!1;for(var m in this.indexes){var T=this.indexes[m];for(var O in T)d[T[O].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,T[O]),delete T[O],y=!0)}return y};var Zl=function(){this.layerIndexes={},this.crossTileIDs=new pc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Zl.prototype.addLayer=function(d,y,m){var T=this.layerIndexes[d.id];T===void 0&&(T=this.layerIndexes[d.id]=new Kl);var O=!1,U={};T.handleWrapJump(m);for(var j=0,K=y;j<K.length;j+=1){var it=K[j],pt=it.getBucket(d);pt&&d.id===pt.layerIds[0]&&(pt.bucketInstanceId||(pt.bucketInstanceId=++this.maxBucketInstanceId),T.addBucket(it.tileID,pt,this.crossTileIDs)&&(O=!0),U[pt.bucketInstanceId]=!0)}return T.removeStaleBuckets(U)&&(O=!0),O},Zl.prototype.pruneUnusedLayers=function(d){var y={};for(var m in d.forEach(function(T){y[T]=!0}),this.layerIndexes)y[m]||delete this.layerIndexes[m]};var Tu=function(d,y){return i.emitValidationErrors(d,y&&y.filter(function(m){return m.identifier!=="source.canvas"}))},$l=i.pick(cr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ql=i.pick(cr,["setCenter","setZoom","setBearing","setPitch"]),fp=function(){var d={},y=i.styleSpec.$version;for(var m in i.styleSpec.$root){var T,O=i.styleSpec.$root[m];O.required&&(T=m==="version"?y:O.type==="array"?[]:{})!=null&&(d[m]=T)}return d}(),da=function(d){function y(m,T){var O=this;T===void 0&&(T={}),d.call(this),this.map=m,this.dispatcher=new Mt(Re(),this),this.imageManager=new D,this.imageManager.setEventedParent(this),this.glyphManager=new ut(m._requestManager,T.localIdeographFontFamily),this.lineAtlas=new mt(256,512),this.crossTileSymbolIndex=new Zl,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new i.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",i.getReferrer());var U=this;this._rtlTextPluginCallback=y.registerForPluginStateChange(function(j){U.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:j.pluginStatus,pluginURL:j.pluginURL},function(K,it){if(i.triggerPluginCompletionEvent(K),it&&it.every(function(Et){return Et}))for(var pt in U.sourceCaches)U.sourceCaches[pt].reload()})}),this.on("data",function(j){if(j.dataType==="source"&&j.sourceDataType==="metadata"){var K=O.sourceCaches[j.sourceId];if(K){var it=K.getSource();if(it&&it.vectorLayerIds)for(var pt in O._layers){var Et=O._layers[pt];Et.source===it.id&&O._validateLayer(Et)}}}})}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.loadURL=function(m,T){var O=this;T===void 0&&(T={}),this.fire(new i.Event("dataloading",{dataType:"style"}));var U=typeof T.validate=="boolean"?T.validate:!i.isMapboxURL(m);m=this.map._requestManager.normalizeStyleURL(m,T.accessToken);var j=this.map._requestManager.transformRequest(m,i.ResourceType.Style);this._request=i.getJSON(j,function(K,it){O._request=null,K?O.fire(new i.ErrorEvent(K)):it&&O._load(it,U)})},y.prototype.loadJSON=function(m,T){var O=this;T===void 0&&(T={}),this.fire(new i.Event("dataloading",{dataType:"style"})),this._request=i.browser.frame(function(){O._request=null,O._load(m,T.validate!==!1)})},y.prototype.loadEmpty=function(){this.fire(new i.Event("dataloading",{dataType:"style"})),this._load(fp,!1)},y.prototype._load=function(m,T){if(!T||!Tu(this,i.validateStyle(m))){for(var O in this._loaded=!0,this.stylesheet=m,m.sources)this.addSource(O,m.sources[O],{validate:!1});m.sprite?this._loadSprite(m.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(m.glyphs);var U=tr(this.stylesheet.layers);this._order=U.map(function(pt){return pt.id}),this._layers={},this._serializedLayers={};for(var j=0,K=U;j<K.length;j+=1){var it=K[j];(it=i.createStyleLayer(it)).setEventedParent(this,{layer:{id:it.id}}),this._layers[it.id]=it,this._serializedLayers[it.id]=it.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new G(this.stylesheet.light),this.fire(new i.Event("data",{dataType:"style"})),this.fire(new i.Event("style.load"))}},y.prototype._loadSprite=function(m){var T=this;this._spriteRequest=function(O,U,j){var K,it,pt,Et=i.browser.devicePixelRatio>1?"@2x":"",Ct=i.getJSON(U.transformRequest(U.normalizeSpriteURL(O,Et,".json"),i.ResourceType.SpriteJSON),function(Ft,Yt){Ct=null,pt||(pt=Ft,K=Yt,Vt())}),Pt=i.getImage(U.transformRequest(U.normalizeSpriteURL(O,Et,".png"),i.ResourceType.SpriteImage),function(Ft,Yt){Pt=null,pt||(pt=Ft,it=Yt,Vt())});function Vt(){if(pt)j(pt);else if(K&&it){var Ft=i.browser.getImageData(it),Yt={};for(var Dt in K){var Xt=K[Dt],te=Xt.width,le=Xt.height,be=Xt.x,Ae=Xt.y,Me=Xt.sdf,Ve=Xt.pixelRatio,Je=Xt.stretchX,$e=Xt.stretchY,wr=Xt.content,qr=new i.RGBAImage({width:te,height:le});i.RGBAImage.copy(Ft,qr,{x:be,y:Ae},{x:0,y:0},{width:te,height:le}),Yt[Dt]={data:qr,pixelRatio:Ve,sdf:Me,stretchX:Je,stretchY:$e,content:wr}}j(null,Yt)}}return{cancel:function(){Ct&&(Ct.cancel(),Ct=null),Pt&&(Pt.cancel(),Pt=null)}}}(m,this.map._requestManager,function(O,U){if(T._spriteRequest=null,O)T.fire(new i.ErrorEvent(O));else if(U)for(var j in U)T.imageManager.addImage(j,U[j]);T.imageManager.setLoaded(!0),T._availableImages=T.imageManager.listImages(),T.dispatcher.broadcast("setImages",T._availableImages),T.fire(new i.Event("data",{dataType:"style"}))})},y.prototype._validateLayer=function(m){var T=this.sourceCaches[m.source];if(T){var O=m.sourceLayer;if(O){var U=T.getSource();(U.type==="geojson"||U.vectorLayerIds&&U.vectorLayerIds.indexOf(O)===-1)&&this.fire(new i.ErrorEvent(new Error('Source layer "'+O+'" does not exist on source "'+U.id+'" as specified by style layer "'+m.id+'"')))}}},y.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var m in this.sourceCaches)if(!this.sourceCaches[m].loaded())return!1;return!!this.imageManager.isLoaded()},y.prototype._serializeLayers=function(m){for(var T=[],O=0,U=m;O<U.length;O+=1){var j=this._layers[U[O]];j.type!=="custom"&&T.push(j.serialize())}return T},y.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var m in this.sourceCaches)if(this.sourceCaches[m].hasTransition())return!0;for(var T in this._layers)if(this._layers[T].hasTransition())return!0;return!1},y.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},y.prototype.update=function(m){if(this._loaded){var T=this._changed;if(this._changed){var O=Object.keys(this._updatedLayers),U=Object.keys(this._removedLayers);for(var j in(O.length||U.length)&&this._updateWorkerLayers(O,U),this._updatedSources){var K=this._updatedSources[j];K==="reload"?this._reloadSource(j):K==="clear"&&this._clearSource(j)}for(var it in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[it].updateTransitions(m);this.light.updateTransitions(m),this._resetUpdates()}var pt={};for(var Et in this.sourceCaches){var Ct=this.sourceCaches[Et];pt[Et]=Ct.used,Ct.used=!1}for(var Pt=0,Vt=this._order;Pt<Vt.length;Pt+=1){var Ft=this._layers[Vt[Pt]];Ft.recalculate(m,this._availableImages),!Ft.isHidden(m.zoom)&&Ft.source&&(this.sourceCaches[Ft.source].used=!0)}for(var Yt in pt){var Dt=this.sourceCaches[Yt];pt[Yt]!==Dt.used&&Dt.fire(new i.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Yt}))}this.light.recalculate(m),this.z=m.zoom,T&&this.fire(new i.Event("data",{dataType:"style"}))}},y.prototype._updateTilesForChangedImages=function(){var m=Object.keys(this._changedImages);if(m.length){for(var T in this.sourceCaches)this.sourceCaches[T].reloadTilesForDependencies(["icons","patterns"],m);this._changedImages={}}},y.prototype._updateWorkerLayers=function(m,T){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(m),removedIds:T})},y.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},y.prototype.setState=function(m){var T=this;if(this._checkLoaded(),Tu(this,i.validateStyle(m)))return!1;(m=i.clone$1(m)).layers=tr(m.layers);var O=function(j,K){if(!j)return[{command:cr.setStyle,args:[K]}];var it=[];try{if(!i.deepEqual(j.version,K.version))return[{command:cr.setStyle,args:[K]}];i.deepEqual(j.center,K.center)||it.push({command:cr.setCenter,args:[K.center]}),i.deepEqual(j.zoom,K.zoom)||it.push({command:cr.setZoom,args:[K.zoom]}),i.deepEqual(j.bearing,K.bearing)||it.push({command:cr.setBearing,args:[K.bearing]}),i.deepEqual(j.pitch,K.pitch)||it.push({command:cr.setPitch,args:[K.pitch]}),i.deepEqual(j.sprite,K.sprite)||it.push({command:cr.setSprite,args:[K.sprite]}),i.deepEqual(j.glyphs,K.glyphs)||it.push({command:cr.setGlyphs,args:[K.glyphs]}),i.deepEqual(j.transition,K.transition)||it.push({command:cr.setTransition,args:[K.transition]}),i.deepEqual(j.light,K.light)||it.push({command:cr.setLight,args:[K.light]});var pt={},Et=[];(function(Pt,Vt,Ft,Yt){var Dt;for(Dt in Vt=Vt||{},Pt=Pt||{})Pt.hasOwnProperty(Dt)&&(Vt.hasOwnProperty(Dt)||fr(Dt,Ft,Yt));for(Dt in Vt)Vt.hasOwnProperty(Dt)&&(Pt.hasOwnProperty(Dt)?i.deepEqual(Pt[Dt],Vt[Dt])||(Pt[Dt].type==="geojson"&&Vt[Dt].type==="geojson"&&Ci(Pt,Vt,Dt)?Ft.push({command:cr.setGeoJSONSourceData,args:[Dt,Vt[Dt].data]}):On(Dt,Vt,Ft,Yt)):wn(Dt,Vt,Ft))})(j.sources,K.sources,Et,pt);var Ct=[];j.layers&&j.layers.forEach(function(Pt){pt[Pt.source]?it.push({command:cr.removeLayer,args:[Pt.id]}):Ct.push(Pt)}),it=it.concat(Et),function(Pt,Vt,Ft){Vt=Vt||[];var Yt,Dt,Xt,te,le,be,Ae,Me=(Pt=Pt||[]).map(Zn),Ve=Vt.map(Zn),Je=Pt.reduce(Yn,{}),$e=Vt.reduce(Yn,{}),wr=Me.slice(),qr=Object.create(null);for(Yt=0,Dt=0;Yt<Me.length;Yt++)$e.hasOwnProperty(Xt=Me[Yt])?Dt++:(Ft.push({command:cr.removeLayer,args:[Xt]}),wr.splice(wr.indexOf(Xt,Dt),1));for(Yt=0,Dt=0;Yt<Ve.length;Yt++)wr[wr.length-1-Yt]!==(Xt=Ve[Ve.length-1-Yt])&&(Je.hasOwnProperty(Xt)?(Ft.push({command:cr.removeLayer,args:[Xt]}),wr.splice(wr.lastIndexOf(Xt,wr.length-Dt),1)):Dt++,Ft.push({command:cr.addLayer,args:[$e[Xt],be=wr[wr.length-Yt]]}),wr.splice(wr.length-Yt,0,Xt),qr[Xt]=!0);for(Yt=0;Yt<Ve.length;Yt++)if(te=Je[Xt=Ve[Yt]],le=$e[Xt],!qr[Xt]&&!i.deepEqual(te,le))if(i.deepEqual(te.source,le.source)&&i.deepEqual(te["source-layer"],le["source-layer"])&&i.deepEqual(te.type,le.type)){for(Ae in Bn(te.layout,le.layout,Ft,Xt,null,cr.setLayoutProperty),Bn(te.paint,le.paint,Ft,Xt,null,cr.setPaintProperty),i.deepEqual(te.filter,le.filter)||Ft.push({command:cr.setFilter,args:[Xt,le.filter]}),i.deepEqual(te.minzoom,le.minzoom)&&i.deepEqual(te.maxzoom,le.maxzoom)||Ft.push({command:cr.setLayerZoomRange,args:[Xt,le.minzoom,le.maxzoom]}),te)te.hasOwnProperty(Ae)&&Ae!=="layout"&&Ae!=="paint"&&Ae!=="filter"&&Ae!=="metadata"&&Ae!=="minzoom"&&Ae!=="maxzoom"&&(Ae.indexOf("paint.")===0?Bn(te[Ae],le[Ae],Ft,Xt,Ae.slice(6),cr.setPaintProperty):i.deepEqual(te[Ae],le[Ae])||Ft.push({command:cr.setLayerProperty,args:[Xt,Ae,le[Ae]]}));for(Ae in le)le.hasOwnProperty(Ae)&&!te.hasOwnProperty(Ae)&&Ae!=="layout"&&Ae!=="paint"&&Ae!=="filter"&&Ae!=="metadata"&&Ae!=="minzoom"&&Ae!=="maxzoom"&&(Ae.indexOf("paint.")===0?Bn(te[Ae],le[Ae],Ft,Xt,Ae.slice(6),cr.setPaintProperty):i.deepEqual(te[Ae],le[Ae])||Ft.push({command:cr.setLayerProperty,args:[Xt,Ae,le[Ae]]}))}else Ft.push({command:cr.removeLayer,args:[Xt]}),be=wr[wr.lastIndexOf(Xt)+1],Ft.push({command:cr.addLayer,args:[le,be]})}(Ct,K.layers,it)}catch(Pt){console.warn("Unable to compute style diff:",Pt),it=[{command:cr.setStyle,args:[K]}]}return it}(this.serialize(),m).filter(function(j){return!(j.command in Ql)});if(O.length===0)return!1;var U=O.filter(function(j){return!(j.command in $l)});if(U.length>0)throw new Error("Unimplemented: "+U.map(function(j){return j.command}).join(", ")+".");return O.forEach(function(j){j.command!=="setTransition"&&T[j.command].apply(T,j.args)}),this.stylesheet=m,!0},y.prototype.addImage=function(m,T){if(this.getImage(m))return this.fire(new i.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(m,T),this._afterImageUpdated(m)},y.prototype.updateImage=function(m,T){this.imageManager.updateImage(m,T)},y.prototype.getImage=function(m){return this.imageManager.getImage(m)},y.prototype.removeImage=function(m){if(!this.getImage(m))return this.fire(new i.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(m),this._afterImageUpdated(m)},y.prototype._afterImageUpdated=function(m){this._availableImages=this.imageManager.listImages(),this._changedImages[m]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new i.Event("data",{dataType:"style"}))},y.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},y.prototype.addSource=function(m,T,O){var U=this;if(O===void 0&&(O={}),this._checkLoaded(),this.sourceCaches[m]!==void 0)throw new Error("There is already a source with this ID");if(!T.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(T).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(T.type)>=0&&this._validate(i.validateStyle.source,"sources."+m,T,null,O))){this.map&&this.map._collectResourceTiming&&(T.collectResourceTiming=!0);var j=this.sourceCaches[m]=new jt(m,T,this.dispatcher);j.style=this,j.setEventedParent(this,function(){return{isSourceLoaded:U.loaded(),source:j.serialize(),sourceId:m}}),j.onAdd(this.map),this._changed=!0}},y.prototype.removeSource=function(m){if(this._checkLoaded(),this.sourceCaches[m]===void 0)throw new Error("There is no source with this ID");for(var T in this._layers)if(this._layers[T].source===m)return this.fire(new i.ErrorEvent(new Error('Source "'+m+'" cannot be removed while layer "'+T+'" is using it.')));var O=this.sourceCaches[m];delete this.sourceCaches[m],delete this._updatedSources[m],O.fire(new i.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:m})),O.setEventedParent(null),O.clearTiles(),O.onRemove&&O.onRemove(this.map),this._changed=!0},y.prototype.setGeoJSONSourceData=function(m,T){this._checkLoaded(),this.sourceCaches[m].getSource().setData(T),this._changed=!0},y.prototype.getSource=function(m){return this.sourceCaches[m]&&this.sourceCaches[m].getSource()},y.prototype.addLayer=function(m,T,O){O===void 0&&(O={}),this._checkLoaded();var U=m.id;if(this.getLayer(U))this.fire(new i.ErrorEvent(new Error('Layer with id "'+U+'" already exists on this map')));else{var j;if(m.type==="custom"){if(Tu(this,i.validateCustomStyleLayer(m)))return;j=i.createStyleLayer(m)}else{if(typeof m.source=="object"&&(this.addSource(U,m.source),m=i.clone$1(m),m=i.extend(m,{source:U})),this._validate(i.validateStyle.layer,"layers."+U,m,{arrayIndex:-1},O))return;j=i.createStyleLayer(m),this._validateLayer(j),j.setEventedParent(this,{layer:{id:U}}),this._serializedLayers[j.id]=j.serialize()}var K=T?this._order.indexOf(T):this._order.length;if(T&&K===-1)this.fire(new i.ErrorEvent(new Error('Layer with id "'+T+'" does not exist on this map.')));else{if(this._order.splice(K,0,U),this._layerOrderChanged=!0,this._layers[U]=j,this._removedLayers[U]&&j.source&&j.type!=="custom"){var it=this._removedLayers[U];delete this._removedLayers[U],it.type!==j.type?this._updatedSources[j.source]="clear":(this._updatedSources[j.source]="reload",this.sourceCaches[j.source].pause())}this._updateLayer(j),j.onAdd&&j.onAdd(this.map)}}},y.prototype.moveLayer=function(m,T){if(this._checkLoaded(),this._changed=!0,this._layers[m]){if(m!==T){var O=this._order.indexOf(m);this._order.splice(O,1);var U=T?this._order.indexOf(T):this._order.length;T&&U===-1?this.fire(new i.ErrorEvent(new Error('Layer with id "'+T+'" does not exist on this map.'))):(this._order.splice(U,0,m),this._layerOrderChanged=!0)}}else this.fire(new i.ErrorEvent(new Error("The layer '"+m+"' does not exist in the map's style and cannot be moved.")))},y.prototype.removeLayer=function(m){this._checkLoaded();var T=this._layers[m];if(T){T.setEventedParent(null);var O=this._order.indexOf(m);this._order.splice(O,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[m]=T,delete this._layers[m],delete this._serializedLayers[m],delete this._updatedLayers[m],delete this._updatedPaintProps[m],T.onRemove&&T.onRemove(this.map)}else this.fire(new i.ErrorEvent(new Error("The layer '"+m+"' does not exist in the map's style and cannot be removed.")))},y.prototype.getLayer=function(m){return this._layers[m]},y.prototype.hasLayer=function(m){return m in this._layers},y.prototype.setLayerZoomRange=function(m,T,O){this._checkLoaded();var U=this.getLayer(m);U?U.minzoom===T&&U.maxzoom===O||(T!=null&&(U.minzoom=T),O!=null&&(U.maxzoom=O),this._updateLayer(U)):this.fire(new i.ErrorEvent(new Error("The layer '"+m+"' does not exist in the map's style and cannot have zoom extent.")))},y.prototype.setFilter=function(m,T,O){O===void 0&&(O={}),this._checkLoaded();var U=this.getLayer(m);if(U){if(!i.deepEqual(U.filter,T))return T==null?(U.filter=void 0,void this._updateLayer(U)):void(this._validate(i.validateStyle.filter,"layers."+U.id+".filter",T,null,O)||(U.filter=i.clone$1(T),this._updateLayer(U)))}else this.fire(new i.ErrorEvent(new Error("The layer '"+m+"' does not exist in the map's style and cannot be filtered.")))},y.prototype.getFilter=function(m){return i.clone$1(this.getLayer(m).filter)},y.prototype.setLayoutProperty=function(m,T,O,U){U===void 0&&(U={}),this._checkLoaded();var j=this.getLayer(m);j?i.deepEqual(j.getLayoutProperty(T),O)||(j.setLayoutProperty(T,O,U),this._updateLayer(j)):this.fire(new i.ErrorEvent(new Error("The layer '"+m+"' does not exist in the map's style and cannot be styled.")))},y.prototype.getLayoutProperty=function(m,T){var O=this.getLayer(m);if(O)return O.getLayoutProperty(T);this.fire(new i.ErrorEvent(new Error("The layer '"+m+"' does not exist in the map's style.")))},y.prototype.setPaintProperty=function(m,T,O,U){U===void 0&&(U={}),this._checkLoaded();var j=this.getLayer(m);j?i.deepEqual(j.getPaintProperty(T),O)||(j.setPaintProperty(T,O,U)&&this._updateLayer(j),this._changed=!0,this._updatedPaintProps[m]=!0):this.fire(new i.ErrorEvent(new Error("The layer '"+m+"' does not exist in the map's style and cannot be styled.")))},y.prototype.getPaintProperty=function(m,T){return this.getLayer(m).getPaintProperty(T)},y.prototype.setFeatureState=function(m,T){this._checkLoaded();var O=m.source,U=m.sourceLayer,j=this.sourceCaches[O];if(j!==void 0){var K=j.getSource().type;K==="geojson"&&U?this.fire(new i.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):K!=="vector"||U?(m.id===void 0&&this.fire(new i.ErrorEvent(new Error("The feature id parameter must be provided."))),j.setFeatureState(U,m.id,T)):this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new i.ErrorEvent(new Error("The source '"+O+"' does not exist in the map's style.")))},y.prototype.removeFeatureState=function(m,T){this._checkLoaded();var O=m.source,U=this.sourceCaches[O];if(U!==void 0){var j=U.getSource().type,K=j==="vector"?m.sourceLayer:void 0;j!=="vector"||K?T&&typeof m.id!="string"&&typeof m.id!="number"?this.fire(new i.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):U.removeFeatureState(K,m.id,T):this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new i.ErrorEvent(new Error("The source '"+O+"' does not exist in the map's style.")))},y.prototype.getFeatureState=function(m){this._checkLoaded();var T=m.source,O=m.sourceLayer,U=this.sourceCaches[T];if(U!==void 0){if(U.getSource().type!=="vector"||O)return m.id===void 0&&this.fire(new i.ErrorEvent(new Error("The feature id parameter must be provided."))),U.getFeatureState(O,m.id);this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new i.ErrorEvent(new Error("The source '"+T+"' does not exist in the map's style.")))},y.prototype.getTransition=function(){return i.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},y.prototype.serialize=function(){return i.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:i.mapObject(this.sourceCaches,function(m){return m.serialize()}),layers:this._serializeLayers(this._order)},function(m){return m!==void 0})},y.prototype._updateLayer=function(m){this._updatedLayers[m.id]=!0,m.source&&!this._updatedSources[m.source]&&this.sourceCaches[m.source].getSource().type!=="raster"&&(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause()),this._changed=!0},y.prototype._flattenAndSortRenderedFeatures=function(m){for(var T=this,O=function(Je){return T._layers[Je].type==="fill-extrusion"},U={},j=[],K=this._order.length-1;K>=0;K--){var it=this._order[K];if(O(it)){U[it]=K;for(var pt=0,Et=m;pt<Et.length;pt+=1){var Ct=Et[pt][it];if(Ct)for(var Pt=0,Vt=Ct;Pt<Vt.length;Pt+=1)j.push(Vt[Pt])}}}j.sort(function(Je,$e){return $e.intersectionZ-Je.intersectionZ});for(var Ft=[],Yt=this._order.length-1;Yt>=0;Yt--){var Dt=this._order[Yt];if(O(Dt))for(var Xt=j.length-1;Xt>=0;Xt--){var te=j[Xt].feature;if(U[te.layer.id]<Yt)break;Ft.push(te),j.pop()}else for(var le=0,be=m;le<be.length;le+=1){var Ae=be[le][Dt];if(Ae)for(var Me=0,Ve=Ae;Me<Ve.length;Me+=1)Ft.push(Ve[Me].feature)}}return Ft},y.prototype.queryRenderedFeatures=function(m,T,O){T&&T.filter&&this._validate(i.validateStyle.filter,"queryRenderedFeatures.filter",T.filter,null,T);var U={};if(T&&T.layers){if(!Array.isArray(T.layers))return this.fire(new i.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var j=0,K=T.layers;j<K.length;j+=1){var it=K[j],pt=this._layers[it];if(!pt)return this.fire(new i.ErrorEvent(new Error("The layer '"+it+"' does not exist in the map's style and cannot be queried for features."))),[];U[pt.source]=!0}}var Et=[];for(var Ct in T.availableImages=this._availableImages,this.sourceCaches)T.layers&&!U[Ct]||Et.push(_n(this.sourceCaches[Ct],this._layers,this._serializedLayers,m,T,O));return this.placement&&Et.push(function(Pt,Vt,Ft,Yt,Dt,Xt,te){for(var le={},be=Xt.queryRenderedSymbols(Yt),Ae=[],Me=0,Ve=Object.keys(be).map(Number);Me<Ve.length;Me+=1)Ae.push(te[Ve[Me]]);Ae.sort(dt);for(var Je=function(){var Kr=wr[$e],ei=Kr.featureIndex.lookupSymbolFeatures(be[Kr.bucketInstanceId],Vt,Kr.bucketIndex,Kr.sourceLayerIndex,Dt.filter,Dt.layers,Dt.availableImages,Pt);for(var Sr in ei){var mn=le[Sr]=le[Sr]||[],An=ei[Sr];An.sort(function(Tn,an){var en=Kr.featureSortOrder;if(en){var gs=en.indexOf(Tn.featureIndex);return en.indexOf(an.featureIndex)-gs}return an.featureIndex-Tn.featureIndex});for(var cn=0,ln=An;cn<ln.length;cn+=1)mn.push(ln[cn])}},$e=0,wr=Ae;$e<wr.length;$e+=1)Je();var qr=function(Kr){le[Kr].forEach(function(ei){var Sr=ei.feature,mn=Ft[Pt[Kr].source].getFeatureState(Sr.layer["source-layer"],Sr.id);Sr.source=Sr.layer.source,Sr.layer["source-layer"]&&(Sr.sourceLayer=Sr.layer["source-layer"]),Sr.state=mn})};for(var $r in le)qr($r);return le}(this._layers,this._serializedLayers,this.sourceCaches,m,T,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Et)},y.prototype.querySourceFeatures=function(m,T){T&&T.filter&&this._validate(i.validateStyle.filter,"querySourceFeatures.filter",T.filter,null,T);var O=this.sourceCaches[m];return O?function(U,j){for(var K=U.getRenderableIds().map(function(Vt){return U.getTileByID(Vt)}),it=[],pt={},Et=0;Et<K.length;Et++){var Ct=K[Et],Pt=Ct.tileID.canonical.key;pt[Pt]||(pt[Pt]=!0,Ct.querySourceFeatures(it,j))}return it}(O,T):[]},y.prototype.addSourceType=function(m,T,O){return y.getSourceType(m)?O(new Error('A source type called "'+m+'" already exists.')):(y.setSourceType(m,T),T.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:m,url:T.workerSourceURL},O):O(null,null))},y.prototype.getLight=function(){return this.light.getLight()},y.prototype.setLight=function(m,T){T===void 0&&(T={}),this._checkLoaded();var O=this.light.getLight(),U=!1;for(var j in m)if(!i.deepEqual(m[j],O[j])){U=!0;break}if(U){var K={now:i.browser.now(),transition:i.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(m,T),this.light.updateTransitions(K)}},y.prototype._validate=function(m,T,O,U,j){return j===void 0&&(j={}),(!j||j.validate!==!1)&&Tu(this,m.call(i.validateStyle,i.extend({key:T,style:this.serialize(),value:O,styleSpec:i.styleSpec},U)))},y.prototype._remove=function(){for(var m in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[m].setEventedParent(null);for(var T in this.sourceCaches)this.sourceCaches[T].clearTiles(),this.sourceCaches[T].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},y.prototype._clearSource=function(m){this.sourceCaches[m].clearTiles()},y.prototype._reloadSource=function(m){this.sourceCaches[m].resume(),this.sourceCaches[m].reload()},y.prototype._updateSources=function(m){for(var T in this.sourceCaches)this.sourceCaches[T].update(m)},y.prototype._generateCollisionBoxes=function(){for(var m in this.sourceCaches)this._reloadSource(m)},y.prototype._updatePlacement=function(m,T,O,U,j){j===void 0&&(j=!1);for(var K=!1,it=!1,pt={},Et=0,Ct=this._order;Et<Ct.length;Et+=1){var Pt=this._layers[Ct[Et]];if(Pt.type==="symbol"){if(!pt[Pt.source]){var Vt=this.sourceCaches[Pt.source];pt[Pt.source]=Vt.getRenderableIds(!0).map(function(te){return Vt.getTileByID(te)}).sort(function(te,le){return le.tileID.overscaledZ-te.tileID.overscaledZ||(te.tileID.isLessThan(le.tileID)?-1:1)})}var Ft=this.crossTileSymbolIndex.addLayer(Pt,pt[Pt.source],m.center.lng);K=K||Ft}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((j=j||this._layerOrderChanged||O===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.browser.now(),m.zoom))&&(this.pauseablePlacement=new rf(m,this._order,j,T,O,U,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,pt),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.browser.now()),it=!0),K&&this.pauseablePlacement.placement.setStale()),it||K)for(var Yt=0,Dt=this._order;Yt<Dt.length;Yt+=1){var Xt=this._layers[Dt[Yt]];Xt.type==="symbol"&&this.placement.updateLayerOpacities(Xt,pt[Xt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.browser.now())},y.prototype._releaseSymbolFadeTiles=function(){for(var m in this.sourceCaches)this.sourceCaches[m].releaseSymbolFadeTiles()},y.prototype.getImages=function(m,T,O){this.imageManager.getImages(T.icons,O),this._updateTilesForChangedImages();var U=this.sourceCaches[T.source];U&&U.setDependencies(T.tileID.key,T.type,T.icons)},y.prototype.getGlyphs=function(m,T,O){this.glyphManager.getGlyphs(T.stacks,O)},y.prototype.getResource=function(m,T,O){return i.makeRequest(T,O)},y}(i.Evented);da.getSourceType=function(d){return Xe[d]},da.setSourceType=function(d,y){Xe[d]=y},da.registerForPluginStateChange=i.registerForPluginStateChange;var xo=i.createLayout([{name:"a_pos",type:"Int16",components:2}]),Eu=ae(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),pp=ae(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),vA=ae(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),bA=ae(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),nf=ae("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Nd=ae(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),kd=ae(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Fd=ae("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),fh=ae("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),zd=ae("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Ud=ae(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),of=ae(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),sf=ae(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),wA=ae(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),R=ae(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),V=ae(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Y=ae(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),tt=ae(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),ht=ae(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),ft=ae(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),xt=ae(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Kt=ae(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Wt=ae(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),oe=ae(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Oe=ae(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Fe=ae(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function ae(d,y){var m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,T=y.match(/attribute ([\w]+) ([\w]+)/g),O=d.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),U=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),j=U?U.concat(O):O,K={};return{fragmentSource:d=d.replace(m,function(it,pt,Et,Ct,Pt){return K[Pt]=!0,pt==="define"?`
#ifndef HAS_UNIFORM_u_`+Pt+`
varying `+Et+" "+Ct+" "+Pt+`;
#else
uniform `+Et+" "+Ct+" u_"+Pt+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Pt+`
    `+Et+" "+Ct+" "+Pt+" = u_"+Pt+`;
#endif
`}),vertexSource:y=y.replace(m,function(it,pt,Et,Ct,Pt){var Vt=Ct==="float"?"vec2":"vec4",Ft=Pt.match(/color/)?"color":Vt;return K[Pt]?pt==="define"?`
#ifndef HAS_UNIFORM_u_`+Pt+`
uniform lowp float u_`+Pt+`_t;
attribute `+Et+" "+Vt+" a_"+Pt+`;
varying `+Et+" "+Ct+" "+Pt+`;
#else
uniform `+Et+" "+Ct+" u_"+Pt+`;
#endif
`:Ft==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Pt+`
    `+Pt+" = a_"+Pt+`;
#else
    `+Et+" "+Ct+" "+Pt+" = u_"+Pt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Pt+`
    `+Pt+" = unpack_mix_"+Ft+"(a_"+Pt+", u_"+Pt+`_t);
#else
    `+Et+" "+Ct+" "+Pt+" = u_"+Pt+`;
#endif
`:pt==="define"?`
#ifndef HAS_UNIFORM_u_`+Pt+`
uniform lowp float u_`+Pt+`_t;
attribute `+Et+" "+Vt+" a_"+Pt+`;
#else
uniform `+Et+" "+Ct+" u_"+Pt+`;
#endif
`:Ft==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Pt+`
    `+Et+" "+Ct+" "+Pt+" = a_"+Pt+`;
#else
    `+Et+" "+Ct+" "+Pt+" = u_"+Pt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Pt+`
    `+Et+" "+Ct+" "+Pt+" = unpack_mix_"+Ft+"(a_"+Pt+", u_"+Pt+`_t);
#else
    `+Et+" "+Ct+" "+Pt+" = u_"+Pt+`;
#endif
`}),staticAttributes:T,staticUniforms:j}}var rr=Object.freeze({__proto__:null,prelude:Eu,background:pp,backgroundPattern:vA,circle:bA,clippingMask:nf,heatmap:Nd,heatmapTexture:kd,collisionBox:Fd,collisionCircle:fh,debug:zd,fill:Ud,fillOutline:of,fillOutlinePattern:sf,fillPattern:wA,fillExtrusion:R,fillExtrusionPattern:V,hillshadePrepare:Y,hillshade:tt,line:ht,lineGradient:ft,linePattern:xt,lineSDF:Kt,raster:Wt,symbolIcon:oe,symbolSDF:Oe,symbolTextAndIcon:Fe}),fn=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function se(d){for(var y=[],m=0;m<d.length;m++)if(d[m]!==null){var T=d[m].split(" ");y.push(T.pop())}return y}fn.prototype.bind=function(d,y,m,T,O,U,j,K){this.context=d;for(var it=this.boundPaintVertexBuffers.length!==T.length,pt=0;!it&&pt<T.length;pt++)this.boundPaintVertexBuffers[pt]!==T[pt]&&(it=!0);d.extVertexArrayObject&&this.vao&&this.boundProgram===y&&this.boundLayoutVertexBuffer===m&&!it&&this.boundIndexBuffer===O&&this.boundVertexOffset===U&&this.boundDynamicVertexBuffer===j&&this.boundDynamicVertexBuffer2===K?(d.bindVertexArrayOES.set(this.vao),j&&j.bind(),O&&O.dynamicDraw&&O.bind(),K&&K.bind()):this.freshBind(y,m,T,O,U,j,K)},fn.prototype.freshBind=function(d,y,m,T,O,U,j){var K,it=d.numAttributes,pt=this.context,Et=pt.gl;if(pt.extVertexArrayObject)this.vao&&this.destroy(),this.vao=pt.extVertexArrayObject.createVertexArrayOES(),pt.bindVertexArrayOES.set(this.vao),K=0,this.boundProgram=d,this.boundLayoutVertexBuffer=y,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=T,this.boundVertexOffset=O,this.boundDynamicVertexBuffer=U,this.boundDynamicVertexBuffer2=j;else{K=pt.currentNumAttributes||0;for(var Ct=it;Ct<K;Ct++)Et.disableVertexAttribArray(Ct)}y.enableAttributes(Et,d);for(var Pt=0,Vt=m;Pt<Vt.length;Pt+=1)Vt[Pt].enableAttributes(Et,d);U&&U.enableAttributes(Et,d),j&&j.enableAttributes(Et,d),y.bind(),y.setVertexAttribPointers(Et,d,O);for(var Ft=0,Yt=m;Ft<Yt.length;Ft+=1){var Dt=Yt[Ft];Dt.bind(),Dt.setVertexAttribPointers(Et,d,O)}U&&(U.bind(),U.setVertexAttribPointers(Et,d,O)),T&&T.bind(),j&&(j.bind(),j.setVertexAttribPointers(Et,d,O)),pt.currentNumAttributes=it},fn.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var ve=function(d,y,m,T,O,U){var j=d.gl;this.program=j.createProgram();for(var K=se(m.staticAttributes),it=T?T.getBinderAttributes():[],pt=K.concat(it),Et=m.staticUniforms?se(m.staticUniforms):[],Ct=T?T.getBinderUniforms():[],Pt=[],Vt=0,Ft=Et.concat(Ct);Vt<Ft.length;Vt+=1){var Yt=Ft[Vt];Pt.indexOf(Yt)<0&&Pt.push(Yt)}var Dt=T?T.defines():[];U&&Dt.push("#define OVERDRAW_INSPECTOR;");var Xt=Dt.concat(Eu.fragmentSource,m.fragmentSource).join(`
`),te=Dt.concat(Eu.vertexSource,m.vertexSource).join(`
`),le=j.createShader(j.FRAGMENT_SHADER);if(j.isContextLost())this.failedToCreate=!0;else{j.shaderSource(le,Xt),j.compileShader(le),j.attachShader(this.program,le);var be=j.createShader(j.VERTEX_SHADER);if(j.isContextLost())this.failedToCreate=!0;else{j.shaderSource(be,te),j.compileShader(be),j.attachShader(this.program,be),this.attributes={};var Ae={};this.numAttributes=pt.length;for(var Me=0;Me<this.numAttributes;Me++)pt[Me]&&(j.bindAttribLocation(this.program,Me,pt[Me]),this.attributes[pt[Me]]=Me);j.linkProgram(this.program),j.deleteShader(be),j.deleteShader(le);for(var Ve=0;Ve<Pt.length;Ve++){var Je=Pt[Ve];if(Je&&!Ae[Je]){var $e=j.getUniformLocation(this.program,Je);$e&&(Ae[Je]=$e)}}this.fixedUniforms=O(d,Ae),this.binderUniforms=T?T.getUniforms(d,Ae):[]}}};function er(d,y,m){var T=1/Yi(m,1,y.transform.tileZoom),O=Math.pow(2,m.tileID.overscaledZ),U=m.tileSize*Math.pow(2,y.transform.tileZoom)/O,j=U*(m.tileID.canonical.x+m.tileID.wrap*O),K=U*m.tileID.canonical.y;return{u_image:0,u_texsize:m.imageAtlasTexture.size,u_scale:[T,d.fromScale,d.toScale],u_fade:d.t,u_pixel_coord_upper:[j>>16,K>>16],u_pixel_coord_lower:[65535&j,65535&K]}}ve.prototype.draw=function(d,y,m,T,O,U,j,K,it,pt,Et,Ct,Pt,Vt,Ft,Yt){var Dt,Xt=d.gl;if(!this.failedToCreate){for(var te in d.program.set(this.program),d.setDepthMode(m),d.setStencilMode(T),d.setColorMode(O),d.setCullFace(U),this.fixedUniforms)this.fixedUniforms[te].set(j[te]);Vt&&Vt.setUniforms(d,this.binderUniforms,Ct,{zoom:Pt});for(var le=(Dt={},Dt[Xt.LINES]=2,Dt[Xt.TRIANGLES]=3,Dt[Xt.LINE_STRIP]=1,Dt)[y],be=0,Ae=Et.get();be<Ae.length;be+=1){var Me=Ae[be],Ve=Me.vaos||(Me.vaos={});(Ve[K]||(Ve[K]=new fn)).bind(d,this,it,Vt?Vt.getPaintVertexBuffers():[],pt,Me.vertexOffset,Ft,Yt),Xt.drawElements(y,Me.primitiveLength*le,Xt.UNSIGNED_SHORT,Me.primitiveOffset*le*2)}}};var jr=function(d,y,m,T){var O=y.style.light,U=O.properties.get("position"),j=[U.x,U.y,U.z],K=i.create$1();O.properties.get("anchor")==="viewport"&&i.fromRotation(K,-y.transform.angle),i.transformMat3(j,j,K);var it=O.properties.get("color");return{u_matrix:d,u_lightpos:j,u_lightintensity:O.properties.get("intensity"),u_lightcolor:[it.r,it.g,it.b],u_vertical_gradient:+m,u_opacity:T}},_=function(d,y,m,T,O,U,j){return i.extend(jr(d,y,m,T),er(U,y,j),{u_height_factor:-Math.pow(2,O.overscaledZ)/j.tileSize/8})},Pn=function(d){return{u_matrix:d}},Ur=function(d,y,m,T){return i.extend(Pn(d),er(m,y,T))},Rt=function(d,y){return{u_matrix:d,u_world:y}},gn=function(d,y,m,T,O){return i.extend(Ur(d,y,m,T),{u_world:O})},ni=function(d,y,m,T){var O,U,j=d.transform;if(T.paint.get("circle-pitch-alignment")==="map"){var K=Yi(m,1,j.zoom);O=!0,U=[K,K]}else O=!1,U=j.pixelsToGLUnits;return{u_camera_to_center_distance:j.cameraToCenterDistance,u_scale_with_map:+(T.paint.get("circle-pitch-scale")==="map"),u_matrix:d.translatePosMatrix(y.posMatrix,m,T.paint.get("circle-translate"),T.paint.get("circle-translate-anchor")),u_pitch_with_map:+O,u_device_pixel_ratio:i.browser.devicePixelRatio,u_extrude_scale:U}},ji=function(d,y,m){var T=Yi(m,1,y.zoom),O=Math.pow(2,y.zoom-m.tileID.overscaledZ),U=m.tileID.overscaleFactor();return{u_matrix:d,u_camera_to_center_distance:y.cameraToCenterDistance,u_pixels_to_tile_units:T,u_extrude_scale:[y.pixelsToGLUnits[0]/(T*O),y.pixelsToGLUnits[1]/(T*O)],u_overscale_factor:U}},mi=function(d,y,m){return{u_matrix:d,u_inv_matrix:y,u_camera_to_center_distance:m.cameraToCenterDistance,u_viewport_size:[m.width,m.height]}},$n=function(d,y,m){return m===void 0&&(m=1),{u_matrix:d,u_color:y,u_overlay:0,u_overlay_scale:m}},Hi=function(d){return{u_matrix:d}},Nn=function(d,y,m,T){return{u_matrix:d,u_extrude_scale:Yi(y,1,m),u_intensity:T}},kn=function(d,y,m){var T=d.transform;return{u_matrix:Fo(d,y,m),u_ratio:1/Yi(y,1,T.zoom),u_device_pixel_ratio:i.browser.devicePixelRatio,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]]}},Kn=function(d,y,m,T){return i.extend(kn(d,y,m),{u_image:0,u_image_height:T})},Qs=function(d,y,m,T){var O=d.transform,U=Fs(y,O);return{u_matrix:Fo(d,y,m),u_texsize:y.imageAtlasTexture.size,u_ratio:1/Yi(y,1,O.zoom),u_device_pixel_ratio:i.browser.devicePixelRatio,u_image:0,u_scale:[U,T.fromScale,T.toScale],u_fade:T.t,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]]}},dp=function(d,y,m,T,O){var U=d.lineAtlas,j=Fs(y,d.transform),K=m.layout.get("line-cap")==="round",it=U.getDash(T.from,K),pt=U.getDash(T.to,K),Et=it.width*O.fromScale,Ct=pt.width*O.toScale;return i.extend(kn(d,y,m),{u_patternscale_a:[j/Et,-it.height/2],u_patternscale_b:[j/Ct,-pt.height/2],u_sdfgamma:U.width/(256*Math.min(Et,Ct)*i.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:it.y,u_tex_y_b:pt.y,u_mix:O.t})};function Fs(d,y){return 1/Yi(d,1,y.tileZoom)}function Fo(d,y,m){return d.translatePosMatrix(y.tileID.posMatrix,y,m.paint.get("line-translate"),m.paint.get("line-translate-anchor"))}var Mu=function(d,y,m,T,O){return{u_matrix:d,u_tl_parent:y,u_scale_parent:m,u_buffer_scale:1,u_fade_t:T.mix,u_opacity:T.opacity*O.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:O.paint.get("raster-brightness-min"),u_brightness_high:O.paint.get("raster-brightness-max"),u_saturation_factor:(j=O.paint.get("raster-saturation"),j>0?1-1/(1.001-j):-j),u_contrast_factor:(U=O.paint.get("raster-contrast"),U>0?1/(1-U):1+U),u_spin_weights:dc(O.paint.get("raster-hue-rotate"))};var U,j};function dc(d){d*=Math.PI/180;var y=Math.sin(d),m=Math.cos(d);return[(2*m+1)/3,(-Math.sqrt(3)*y-m+1)/3,(Math.sqrt(3)*y-m+1)/3]}var Su,Ai=function(d,y,m,T,O,U,j,K,it,pt){var Et=O.transform;return{u_is_size_zoom_constant:+(d==="constant"||d==="source"),u_is_size_feature_constant:+(d==="constant"||d==="camera"),u_size_t:y?y.uSizeT:0,u_size:y?y.uSize:0,u_camera_to_center_distance:Et.cameraToCenterDistance,u_pitch:Et.pitch/360*2*Math.PI,u_rotate_symbol:+m,u_aspect_ratio:Et.width/Et.height,u_fade_change:O.options.fadeDuration?O.symbolFadeChange:1,u_matrix:U,u_label_plane_matrix:j,u_coord_matrix:K,u_is_text:+it,u_pitch_with_map:+T,u_texsize:pt,u_texture:0}},ma=function(d,y,m,T,O,U,j,K,it,pt,Et){var Ct=O.transform;return i.extend(Ai(d,y,m,T,O,U,j,K,it,pt),{u_gamma_scale:T?Math.cos(Ct._pitch)*Ct.cameraToCenterDistance:1,u_device_pixel_ratio:i.browser.devicePixelRatio,u_is_halo:+Et})},pn=function(d,y,m,T,O,U,j,K,it,pt){return i.extend(ma(d,y,m,T,O,U,j,K,!0,it,!0),{u_texsize_icon:pt,u_texture_icon:1})},Bt=function(d,y,m){return{u_matrix:d,u_opacity:y,u_color:m}},dn=function(d,y,m,T,O,U){return i.extend(function(j,K,it,pt){var Et=it.imageManager.getPattern(j.from.toString()),Ct=it.imageManager.getPattern(j.to.toString()),Pt=it.imageManager.getPixelSize(),Vt=Pt.width,Ft=Pt.height,Yt=Math.pow(2,pt.tileID.overscaledZ),Dt=pt.tileSize*Math.pow(2,it.transform.tileZoom)/Yt,Xt=Dt*(pt.tileID.canonical.x+pt.tileID.wrap*Yt),te=Dt*pt.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Et.tl,u_pattern_br_a:Et.br,u_pattern_tl_b:Ct.tl,u_pattern_br_b:Ct.br,u_texsize:[Vt,Ft],u_mix:K.t,u_pattern_size_a:Et.displaySize,u_pattern_size_b:Ct.displaySize,u_scale_a:K.fromScale,u_scale_b:K.toScale,u_tile_units_to_pixels:1/Yi(pt,1,it.transform.tileZoom),u_pixel_coord_upper:[Xt>>16,te>>16],u_pixel_coord_lower:[65535&Xt,65535&te]}}(T,U,m,O),{u_matrix:d,u_opacity:y})},mp={fillExtrusion:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_lightpos:new i.Uniform3f(d,y.u_lightpos),u_lightintensity:new i.Uniform1f(d,y.u_lightintensity),u_lightcolor:new i.Uniform3f(d,y.u_lightcolor),u_vertical_gradient:new i.Uniform1f(d,y.u_vertical_gradient),u_opacity:new i.Uniform1f(d,y.u_opacity)}},fillExtrusionPattern:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_lightpos:new i.Uniform3f(d,y.u_lightpos),u_lightintensity:new i.Uniform1f(d,y.u_lightintensity),u_lightcolor:new i.Uniform3f(d,y.u_lightcolor),u_vertical_gradient:new i.Uniform1f(d,y.u_vertical_gradient),u_height_factor:new i.Uniform1f(d,y.u_height_factor),u_image:new i.Uniform1i(d,y.u_image),u_texsize:new i.Uniform2f(d,y.u_texsize),u_pixel_coord_upper:new i.Uniform2f(d,y.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(d,y.u_pixel_coord_lower),u_scale:new i.Uniform3f(d,y.u_scale),u_fade:new i.Uniform1f(d,y.u_fade),u_opacity:new i.Uniform1f(d,y.u_opacity)}},fill:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix)}},fillPattern:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_image:new i.Uniform1i(d,y.u_image),u_texsize:new i.Uniform2f(d,y.u_texsize),u_pixel_coord_upper:new i.Uniform2f(d,y.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(d,y.u_pixel_coord_lower),u_scale:new i.Uniform3f(d,y.u_scale),u_fade:new i.Uniform1f(d,y.u_fade)}},fillOutline:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_world:new i.Uniform2f(d,y.u_world)}},fillOutlinePattern:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_world:new i.Uniform2f(d,y.u_world),u_image:new i.Uniform1i(d,y.u_image),u_texsize:new i.Uniform2f(d,y.u_texsize),u_pixel_coord_upper:new i.Uniform2f(d,y.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(d,y.u_pixel_coord_lower),u_scale:new i.Uniform3f(d,y.u_scale),u_fade:new i.Uniform1f(d,y.u_fade)}},circle:function(d,y){return{u_camera_to_center_distance:new i.Uniform1f(d,y.u_camera_to_center_distance),u_scale_with_map:new i.Uniform1i(d,y.u_scale_with_map),u_pitch_with_map:new i.Uniform1i(d,y.u_pitch_with_map),u_extrude_scale:new i.Uniform2f(d,y.u_extrude_scale),u_device_pixel_ratio:new i.Uniform1f(d,y.u_device_pixel_ratio),u_matrix:new i.UniformMatrix4f(d,y.u_matrix)}},collisionBox:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_camera_to_center_distance:new i.Uniform1f(d,y.u_camera_to_center_distance),u_pixels_to_tile_units:new i.Uniform1f(d,y.u_pixels_to_tile_units),u_extrude_scale:new i.Uniform2f(d,y.u_extrude_scale),u_overscale_factor:new i.Uniform1f(d,y.u_overscale_factor)}},collisionCircle:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_inv_matrix:new i.UniformMatrix4f(d,y.u_inv_matrix),u_camera_to_center_distance:new i.Uniform1f(d,y.u_camera_to_center_distance),u_viewport_size:new i.Uniform2f(d,y.u_viewport_size)}},debug:function(d,y){return{u_color:new i.UniformColor(d,y.u_color),u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_overlay:new i.Uniform1i(d,y.u_overlay),u_overlay_scale:new i.Uniform1f(d,y.u_overlay_scale)}},clippingMask:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix)}},heatmap:function(d,y){return{u_extrude_scale:new i.Uniform1f(d,y.u_extrude_scale),u_intensity:new i.Uniform1f(d,y.u_intensity),u_matrix:new i.UniformMatrix4f(d,y.u_matrix)}},heatmapTexture:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_world:new i.Uniform2f(d,y.u_world),u_image:new i.Uniform1i(d,y.u_image),u_color_ramp:new i.Uniform1i(d,y.u_color_ramp),u_opacity:new i.Uniform1f(d,y.u_opacity)}},hillshade:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_image:new i.Uniform1i(d,y.u_image),u_latrange:new i.Uniform2f(d,y.u_latrange),u_light:new i.Uniform2f(d,y.u_light),u_shadow:new i.UniformColor(d,y.u_shadow),u_highlight:new i.UniformColor(d,y.u_highlight),u_accent:new i.UniformColor(d,y.u_accent)}},hillshadePrepare:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_image:new i.Uniform1i(d,y.u_image),u_dimension:new i.Uniform2f(d,y.u_dimension),u_zoom:new i.Uniform1f(d,y.u_zoom),u_unpack:new i.Uniform4f(d,y.u_unpack)}},line:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_ratio:new i.Uniform1f(d,y.u_ratio),u_device_pixel_ratio:new i.Uniform1f(d,y.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(d,y.u_units_to_pixels)}},lineGradient:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_ratio:new i.Uniform1f(d,y.u_ratio),u_device_pixel_ratio:new i.Uniform1f(d,y.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(d,y.u_units_to_pixels),u_image:new i.Uniform1i(d,y.u_image),u_image_height:new i.Uniform1f(d,y.u_image_height)}},linePattern:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_texsize:new i.Uniform2f(d,y.u_texsize),u_ratio:new i.Uniform1f(d,y.u_ratio),u_device_pixel_ratio:new i.Uniform1f(d,y.u_device_pixel_ratio),u_image:new i.Uniform1i(d,y.u_image),u_units_to_pixels:new i.Uniform2f(d,y.u_units_to_pixels),u_scale:new i.Uniform3f(d,y.u_scale),u_fade:new i.Uniform1f(d,y.u_fade)}},lineSDF:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_ratio:new i.Uniform1f(d,y.u_ratio),u_device_pixel_ratio:new i.Uniform1f(d,y.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(d,y.u_units_to_pixels),u_patternscale_a:new i.Uniform2f(d,y.u_patternscale_a),u_patternscale_b:new i.Uniform2f(d,y.u_patternscale_b),u_sdfgamma:new i.Uniform1f(d,y.u_sdfgamma),u_image:new i.Uniform1i(d,y.u_image),u_tex_y_a:new i.Uniform1f(d,y.u_tex_y_a),u_tex_y_b:new i.Uniform1f(d,y.u_tex_y_b),u_mix:new i.Uniform1f(d,y.u_mix)}},raster:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_tl_parent:new i.Uniform2f(d,y.u_tl_parent),u_scale_parent:new i.Uniform1f(d,y.u_scale_parent),u_buffer_scale:new i.Uniform1f(d,y.u_buffer_scale),u_fade_t:new i.Uniform1f(d,y.u_fade_t),u_opacity:new i.Uniform1f(d,y.u_opacity),u_image0:new i.Uniform1i(d,y.u_image0),u_image1:new i.Uniform1i(d,y.u_image1),u_brightness_low:new i.Uniform1f(d,y.u_brightness_low),u_brightness_high:new i.Uniform1f(d,y.u_brightness_high),u_saturation_factor:new i.Uniform1f(d,y.u_saturation_factor),u_contrast_factor:new i.Uniform1f(d,y.u_contrast_factor),u_spin_weights:new i.Uniform3f(d,y.u_spin_weights)}},symbolIcon:function(d,y){return{u_is_size_zoom_constant:new i.Uniform1i(d,y.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(d,y.u_is_size_feature_constant),u_size_t:new i.Uniform1f(d,y.u_size_t),u_size:new i.Uniform1f(d,y.u_size),u_camera_to_center_distance:new i.Uniform1f(d,y.u_camera_to_center_distance),u_pitch:new i.Uniform1f(d,y.u_pitch),u_rotate_symbol:new i.Uniform1i(d,y.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(d,y.u_aspect_ratio),u_fade_change:new i.Uniform1f(d,y.u_fade_change),u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(d,y.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(d,y.u_coord_matrix),u_is_text:new i.Uniform1i(d,y.u_is_text),u_pitch_with_map:new i.Uniform1i(d,y.u_pitch_with_map),u_texsize:new i.Uniform2f(d,y.u_texsize),u_texture:new i.Uniform1i(d,y.u_texture)}},symbolSDF:function(d,y){return{u_is_size_zoom_constant:new i.Uniform1i(d,y.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(d,y.u_is_size_feature_constant),u_size_t:new i.Uniform1f(d,y.u_size_t),u_size:new i.Uniform1f(d,y.u_size),u_camera_to_center_distance:new i.Uniform1f(d,y.u_camera_to_center_distance),u_pitch:new i.Uniform1f(d,y.u_pitch),u_rotate_symbol:new i.Uniform1i(d,y.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(d,y.u_aspect_ratio),u_fade_change:new i.Uniform1f(d,y.u_fade_change),u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(d,y.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(d,y.u_coord_matrix),u_is_text:new i.Uniform1i(d,y.u_is_text),u_pitch_with_map:new i.Uniform1i(d,y.u_pitch_with_map),u_texsize:new i.Uniform2f(d,y.u_texsize),u_texture:new i.Uniform1i(d,y.u_texture),u_gamma_scale:new i.Uniform1f(d,y.u_gamma_scale),u_device_pixel_ratio:new i.Uniform1f(d,y.u_device_pixel_ratio),u_is_halo:new i.Uniform1i(d,y.u_is_halo)}},symbolTextAndIcon:function(d,y){return{u_is_size_zoom_constant:new i.Uniform1i(d,y.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(d,y.u_is_size_feature_constant),u_size_t:new i.Uniform1f(d,y.u_size_t),u_size:new i.Uniform1f(d,y.u_size),u_camera_to_center_distance:new i.Uniform1f(d,y.u_camera_to_center_distance),u_pitch:new i.Uniform1f(d,y.u_pitch),u_rotate_symbol:new i.Uniform1i(d,y.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(d,y.u_aspect_ratio),u_fade_change:new i.Uniform1f(d,y.u_fade_change),u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(d,y.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(d,y.u_coord_matrix),u_is_text:new i.Uniform1i(d,y.u_is_text),u_pitch_with_map:new i.Uniform1i(d,y.u_pitch_with_map),u_texsize:new i.Uniform2f(d,y.u_texsize),u_texsize_icon:new i.Uniform2f(d,y.u_texsize_icon),u_texture:new i.Uniform1i(d,y.u_texture),u_texture_icon:new i.Uniform1i(d,y.u_texture_icon),u_gamma_scale:new i.Uniform1f(d,y.u_gamma_scale),u_device_pixel_ratio:new i.Uniform1f(d,y.u_device_pixel_ratio),u_is_halo:new i.Uniform1i(d,y.u_is_halo)}},background:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_opacity:new i.Uniform1f(d,y.u_opacity),u_color:new i.UniformColor(d,y.u_color)}},backgroundPattern:function(d,y){return{u_matrix:new i.UniformMatrix4f(d,y.u_matrix),u_opacity:new i.Uniform1f(d,y.u_opacity),u_image:new i.Uniform1i(d,y.u_image),u_pattern_tl_a:new i.Uniform2f(d,y.u_pattern_tl_a),u_pattern_br_a:new i.Uniform2f(d,y.u_pattern_br_a),u_pattern_tl_b:new i.Uniform2f(d,y.u_pattern_tl_b),u_pattern_br_b:new i.Uniform2f(d,y.u_pattern_br_b),u_texsize:new i.Uniform2f(d,y.u_texsize),u_mix:new i.Uniform1f(d,y.u_mix),u_pattern_size_a:new i.Uniform2f(d,y.u_pattern_size_a),u_pattern_size_b:new i.Uniform2f(d,y.u_pattern_size_b),u_scale_a:new i.Uniform1f(d,y.u_scale_a),u_scale_b:new i.Uniform1f(d,y.u_scale_b),u_pixel_coord_upper:new i.Uniform2f(d,y.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(d,y.u_pixel_coord_lower),u_tile_units_to_pixels:new i.Uniform1f(d,y.u_tile_units_to_pixels)}}};function Jl(d,y,m,T,O,U,j){for(var K=d.context,it=K.gl,pt=d.useProgram("collisionBox"),Et=[],Ct=0,Pt=0,Vt=0;Vt<T.length;Vt++){var Ft=T[Vt],Yt=y.getTile(Ft),Dt=Yt.getBucket(m);if(Dt){var Xt=Ft.posMatrix;O[0]===0&&O[1]===0||(Xt=d.translatePosMatrix(Ft.posMatrix,Yt,O,U));var te=j?Dt.textCollisionBox:Dt.iconCollisionBox,le=Dt.collisionCircleArray;if(le.length>0){var be=i.create(),Ae=Xt;i.mul(be,Dt.placementInvProjMatrix,d.transform.glCoordMatrix),i.mul(be,be,Dt.placementViewportMatrix),Et.push({circleArray:le,circleOffset:Pt,transform:Ae,invTransform:be}),Pt=Ct+=le.length/4}te&&pt.draw(K,it.LINES,Lt.disabled,vt.disabled,d.colorModeForRenderPass(),Jt.disabled,ji(Xt,d.transform,Yt),m.id,te.layoutVertexBuffer,te.indexBuffer,te.segments,null,d.transform.zoom,null,null,te.collisionVertexBuffer)}}if(j&&Et.length){var Me=d.useProgram("collisionCircle"),Ve=new i.StructArrayLayout2f1f2i16;Ve.resize(4*Ct),Ve._trim();for(var Je=0,$e=0,wr=Et;$e<wr.length;$e+=1)for(var qr=wr[$e],$r=0;$r<qr.circleArray.length/4;$r++){var Kr=4*$r,ei=qr.circleArray[Kr+0],Sr=qr.circleArray[Kr+1],mn=qr.circleArray[Kr+2],An=qr.circleArray[Kr+3];Ve.emplace(Je++,ei,Sr,mn,An,0),Ve.emplace(Je++,ei,Sr,mn,An,1),Ve.emplace(Je++,ei,Sr,mn,An,2),Ve.emplace(Je++,ei,Sr,mn,An,3)}(!Su||Su.length<2*Ct)&&(Su=function(Fi){var Vs=2*Fi,_s=new i.StructArrayLayout3ui6;_s.resize(Vs),_s._trim();for(var vo=0;vo<Vs;vo++){var Uo=6*vo;_s.uint16[Uo+0]=4*vo+0,_s.uint16[Uo+1]=4*vo+1,_s.uint16[Uo+2]=4*vo+2,_s.uint16[Uo+3]=4*vo+2,_s.uint16[Uo+4]=4*vo+3,_s.uint16[Uo+5]=4*vo+0}return _s}(Ct));for(var cn=K.createIndexBuffer(Su,!0),ln=K.createVertexBuffer(Ve,i.collisionCircleLayout.members,!0),Tn=0,an=Et;Tn<an.length;Tn+=1){var en=an[Tn],gs=mi(en.transform,en.invTransform,d.transform);Me.draw(K,it.TRIANGLES,Lt.disabled,vt.disabled,d.colorModeForRenderPass(),Jt.disabled,gs,m.id,ln,cn,i.SegmentVector.simpleSegment(0,2*en.circleOffset,en.circleArray.length,en.circleArray.length/2),null,d.transform.zoom,null,null,null)}ln.destroy(),cn.destroy()}}var Ts=i.identity(new Float32Array(16));function af(d,y,m,T,O,U){var j=i.getAnchorAlignment(d),K=-(j.horizontalAlign-.5)*y,it=-(j.verticalAlign-.5)*m,pt=i.evaluateVariableOffset(d,T);return new i.Point((K/O+pt[0])*U,(it/O+pt[1])*U)}function il(d,y,m,T,O,U,j,K,it,pt,Et){var Ct=d.text.placedSymbolArray,Pt=d.text.dynamicLayoutVertexArray,Vt=d.icon.dynamicLayoutVertexArray,Ft={};Pt.clear();for(var Yt=0;Yt<Ct.length;Yt++){var Dt=Ct.get(Yt),Xt=Dt.hidden||!Dt.crossTileID||d.allowVerticalPlacement&&!Dt.placedOrientation?null:T[Dt.crossTileID];if(Xt){var te=new i.Point(Dt.anchorX,Dt.anchorY),le=Dn(te,m?K:j),be=ci(U.cameraToCenterDistance,le.signedDistanceFromCamera),Ae=O.evaluateSizeForFeature(d.textSizeData,pt,Dt)*be/i.ONE_EM;m&&(Ae*=d.tilePixelRatio/it);for(var Me=af(Xt.anchor,Xt.width,Xt.height,Xt.textOffset,Xt.textBoxScale,Ae),Ve=m?Dn(te.add(Me),j).point:le.point.add(y?Me.rotate(-U.angle):Me),Je=d.allowVerticalPlacement&&Dt.placedOrientation===i.WritingMode.vertical?Math.PI/2:0,$e=0;$e<Dt.numGlyphs;$e++)i.addDynamicAttributes(Pt,Ve,Je);Et&&Dt.associatedIconIndex>=0&&(Ft[Dt.associatedIconIndex]={shiftedAnchor:Ve,angle:Je})}else Zs(Dt.numGlyphs,Pt)}if(Et){Vt.clear();for(var wr=d.icon.placedSymbolArray,qr=0;qr<wr.length;qr++){var $r=wr.get(qr);if($r.hidden)Zs($r.numGlyphs,Vt);else{var Kr=Ft[qr];if(Kr)for(var ei=0;ei<$r.numGlyphs;ei++)i.addDynamicAttributes(Vt,Kr.shiftedAnchor,Kr.angle);else Zs($r.numGlyphs,Vt)}}d.icon.dynamicLayoutVertexBuffer.updateData(Vt)}d.text.dynamicLayoutVertexBuffer.updateData(Pt)}function It(d,y,m){return m.iconsInText&&y?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function mc(d,y,m,T,O,U,j,K,it,pt,Et,Ct){for(var Pt=d.context,Vt=Pt.gl,Ft=d.transform,Yt=K==="map",Dt=it==="map",Xt=Yt&&m.layout.get("symbol-placement")!=="point",te=Yt&&!Dt&&!Xt,le=m.layout.get("symbol-sort-key").constantOr(1)!==void 0,be=!1,Ae=d.depthModeForSublayer(0,Lt.ReadOnly),Me=m.layout.get("text-variable-anchor"),Ve=[],Je=0,$e=T;Je<$e.length;Je+=1){var wr=$e[Je],qr=y.getTile(wr),$r=qr.getBucket(m);if($r){var Kr=O?$r.text:$r.icon;if(Kr&&Kr.segments.get().length){var ei=Kr.programConfigurations.get(m.id),Sr=O||$r.sdfIcons,mn=O?$r.textSizeData:$r.iconSizeData,An=Dt||Ft.pitch!==0,cn=d.useProgram(It(Sr,O,$r),ei),ln=i.evaluateSizeForZoom(mn,Ft.zoom),Tn=void 0,an=[0,0],en=void 0,gs=void 0,Fi=null,Vs=void 0;if(O)en=qr.glyphAtlasTexture,gs=Vt.LINEAR,Tn=qr.glyphAtlasTexture.size,$r.iconsInText&&(an=qr.imageAtlasTexture.size,Fi=qr.imageAtlasTexture,Vs=An||d.options.rotating||d.options.zooming||mn.kind==="composite"||mn.kind==="camera"?Vt.LINEAR:Vt.NEAREST);else{var _s=m.layout.get("icon-size").constantOr(0)!==1||$r.iconsNeedLinear;en=qr.imageAtlasTexture,gs=Sr||d.options.rotating||d.options.zooming||_s||An?Vt.LINEAR:Vt.NEAREST,Tn=qr.imageAtlasTexture.size}var vo=Yi(qr,1,d.transform.zoom),Uo=yo(wr.posMatrix,Dt,Yt,d.transform,vo),Ka=Pi(wr.posMatrix,Dt,Yt,d.transform,vo),ga=Me&&$r.hasTextData(),Du=m.layout.get("icon-text-fit")!=="none"&&ga&&$r.hasIconData();Xt&&lh($r,wr.posMatrix,d,O,Uo,Ka,Dt,pt);var La=d.translatePosMatrix(wr.posMatrix,qr,U,j),sl=Xt||O&&Me||Du?Ts:Uo,Dc=d.translatePosMatrix(Ka,qr,U,j,!0),bp=Sr&&m.paint.get(O?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Af={program:cn,buffers:Kr,uniformValues:Sr?$r.iconsInText?pn(mn.kind,ln,te,Dt,d,La,sl,Dc,Tn,an):ma(mn.kind,ln,te,Dt,d,La,sl,Dc,O,Tn,!0):Ai(mn.kind,ln,te,Dt,d,La,sl,Dc,O,Tn),atlasTexture:en,atlasTextureIcon:Fi,atlasInterpolation:gs,atlasInterpolationIcon:Vs,isSDF:Sr,hasHalo:bp};if(le&&$r.canOverlap){be=!0;for(var Nu=0,xh=Kr.segments.get();Nu<xh.length;Nu+=1){var gf=xh[Nu];Ve.push({segments:new i.SegmentVector([gf]),sortKey:gf.sortKey,state:Af})}}else Ve.push({segments:Kr.segments,sortKey:0,state:Af})}}}be&&Ve.sort(function(ku,vh){return ku.sortKey-vh.sortKey});for(var Ki=0,wp=Ve;Ki<wp.length;Ki+=1){var Pl=wp[Ki],Ro=Pl.state;if(Pt.activeTexture.set(Vt.TEXTURE0),Ro.atlasTexture.bind(Ro.atlasInterpolation,Vt.CLAMP_TO_EDGE),Ro.atlasTextureIcon&&(Pt.activeTexture.set(Vt.TEXTURE1),Ro.atlasTextureIcon&&Ro.atlasTextureIcon.bind(Ro.atlasInterpolationIcon,Vt.CLAMP_TO_EDGE)),Ro.isSDF){var ys=Ro.uniformValues;Ro.hasHalo&&(ys.u_is_halo=1,Tl(Ro.buffers,Pl.segments,m,d,Ro.program,Ae,Et,Ct,ys)),ys.u_is_halo=0}Tl(Ro.buffers,Pl.segments,m,d,Ro.program,Ae,Et,Ct,Ro.uniformValues)}}function Tl(d,y,m,T,O,U,j,K,it){var pt=T.context;O.draw(pt,pt.gl.TRIANGLES,U,j,K,Jt.disabled,it,m.id,d.layoutVertexBuffer,d.indexBuffer,y,m.paint,T.transform.zoom,d.programConfigurations.get(m.id),d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer)}function tu(d,y,m,T,O,U,j){var K,it,pt,Et,Ct,Pt=d.context.gl,Vt=m.paint.get("fill-pattern"),Ft=Vt&&Vt.constantOr(1),Yt=m.getCrossfadeParameters();j?(it=Ft&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",K=Pt.LINES):(it=Ft?"fillPattern":"fill",K=Pt.TRIANGLES);for(var Dt=0,Xt=T;Dt<Xt.length;Dt+=1){var te=Xt[Dt],le=y.getTile(te);if(!Ft||le.patternsLoaded()){var be=le.getBucket(m);if(be){var Ae=be.programConfigurations.get(m.id),Me=d.useProgram(it,Ae);Ft&&(d.context.activeTexture.set(Pt.TEXTURE0),le.imageAtlasTexture.bind(Pt.LINEAR,Pt.CLAMP_TO_EDGE),Ae.updatePaintBuffers(Yt));var Ve=Vt.constantOr(null);if(Ve&&le.imageAtlas){var Je=le.imageAtlas,$e=Je.patternPositions[Ve.to.toString()],wr=Je.patternPositions[Ve.from.toString()];$e&&wr&&Ae.setConstantPatternPositions($e,wr)}var qr=d.translatePosMatrix(te.posMatrix,le,m.paint.get("fill-translate"),m.paint.get("fill-translate-anchor"));if(j){Et=be.indexBuffer2,Ct=be.segments2;var $r=[Pt.drawingBufferWidth,Pt.drawingBufferHeight];pt=it==="fillOutlinePattern"&&Ft?gn(qr,d,Yt,le,$r):Rt(qr,$r)}else Et=be.indexBuffer,Ct=be.segments,pt=Ft?Ur(qr,d,Yt,le):Pn(qr);Me.draw(d.context,K,O,d.stencilModeForClipping(te),U,Jt.disabled,pt,m.id,be.layoutVertexBuffer,Et,Ct,m.paint,d.transform.zoom,Ae)}}}}function ph(d,y,m,T,O,U,j){for(var K=d.context,it=K.gl,pt=m.paint.get("fill-extrusion-pattern"),Et=pt.constantOr(1),Ct=m.getCrossfadeParameters(),Pt=m.paint.get("fill-extrusion-opacity"),Vt=0,Ft=T;Vt<Ft.length;Vt+=1){var Yt=Ft[Vt],Dt=y.getTile(Yt),Xt=Dt.getBucket(m);if(Xt){var te=Xt.programConfigurations.get(m.id),le=d.useProgram(Et?"fillExtrusionPattern":"fillExtrusion",te);Et&&(d.context.activeTexture.set(it.TEXTURE0),Dt.imageAtlasTexture.bind(it.LINEAR,it.CLAMP_TO_EDGE),te.updatePaintBuffers(Ct));var be=pt.constantOr(null);if(be&&Dt.imageAtlas){var Ae=Dt.imageAtlas,Me=Ae.patternPositions[be.to.toString()],Ve=Ae.patternPositions[be.from.toString()];Me&&Ve&&te.setConstantPatternPositions(Me,Ve)}var Je=d.translatePosMatrix(Yt.posMatrix,Dt,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),$e=m.paint.get("fill-extrusion-vertical-gradient"),wr=Et?_(Je,d,$e,Pt,Yt,Ct,Dt):jr(Je,d,$e,Pt);le.draw(K,K.gl.TRIANGLES,O,U,j,Jt.backCCW,wr,m.id,Xt.layoutVertexBuffer,Xt.indexBuffer,Xt.segments,m.paint,d.transform.zoom,te)}}}function cf(d,y,m,T,O,U){var j=d.context,K=j.gl,it=y.fbo;if(it){var pt=d.useProgram("hillshade");j.activeTexture.set(K.TEXTURE0),K.bindTexture(K.TEXTURE_2D,it.colorAttachment.get());var Et=function(Ct,Pt,Vt){var Ft=Vt.paint.get("hillshade-shadow-color"),Yt=Vt.paint.get("hillshade-highlight-color"),Dt=Vt.paint.get("hillshade-accent-color"),Xt=Vt.paint.get("hillshade-illumination-direction")*(Math.PI/180);Vt.paint.get("hillshade-illumination-anchor")==="viewport"&&(Xt-=Ct.transform.angle);var te,le,be,Ae=!Ct.options.moving;return{u_matrix:Ct.transform.calculatePosMatrix(Pt.tileID.toUnwrapped(),Ae),u_image:0,u_latrange:(te=Pt.tileID,le=Math.pow(2,te.canonical.z),be=te.canonical.y,[new i.MercatorCoordinate(0,be/le).toLngLat().lat,new i.MercatorCoordinate(0,(be+1)/le).toLngLat().lat]),u_light:[Vt.paint.get("hillshade-exaggeration"),Xt],u_shadow:Ft,u_highlight:Yt,u_accent:Dt}}(d,y,m);pt.draw(j,K.TRIANGLES,T,O,U,Jt.disabled,Et,m.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}}function lf(d,y,m,T,O,U){var j=d.context,K=j.gl,it=y.dem;if(it&&it.data){var pt=it.dim,Et=it.stride,Ct=it.getPixels();if(j.activeTexture.set(K.TEXTURE1),j.pixelStoreUnpackPremultiplyAlpha.set(!1),y.demTexture=y.demTexture||d.getTileTexture(Et),y.demTexture){var Pt=y.demTexture;Pt.update(Ct,{premultiply:!1}),Pt.bind(K.NEAREST,K.CLAMP_TO_EDGE)}else y.demTexture=new i.Texture(j,Ct,K.RGBA,{premultiply:!1}),y.demTexture.bind(K.NEAREST,K.CLAMP_TO_EDGE);j.activeTexture.set(K.TEXTURE0);var Vt=y.fbo;if(!Vt){var Ft=new i.Texture(j,{width:pt,height:pt,data:null},K.RGBA);Ft.bind(K.LINEAR,K.CLAMP_TO_EDGE),(Vt=y.fbo=j.createFramebuffer(pt,pt,!0)).colorAttachment.set(Ft.texture)}j.bindFramebuffer.set(Vt.framebuffer),j.viewport.set([0,0,pt,pt]),d.useProgram("hillshadePrepare").draw(j,K.TRIANGLES,T,O,U,Jt.disabled,function(Yt,Dt){var Xt=Dt.stride,te=i.create();return i.ortho(te,0,i.EXTENT,-i.EXTENT,0,0,1),i.translate(te,te,[0,-i.EXTENT,0]),{u_matrix:te,u_image:1,u_dimension:[Xt,Xt],u_zoom:Yt.overscaledZ,u_unpack:Dt.getUnpackVector()}}(y.tileID,it),m.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments),y.needsHillshadePrepare=!1}}function eu(d,y,m,T,O){var U=T.paint.get("raster-fade-duration");if(U>0){var j=i.browser.now(),K=(j-d.timeAdded)/U,it=y?(j-y.timeAdded)/U:-1,pt=m.getSource(),Et=O.coveringZoomLevel({tileSize:pt.tileSize,roundZoom:pt.roundZoom}),Ct=!y||Math.abs(y.tileID.overscaledZ-Et)>Math.abs(d.tileID.overscaledZ-Et),Pt=Ct&&d.refreshedUponExpiration?1:i.clamp(Ct?K:1-it,0,1);return d.refreshedUponExpiration&&K>=1&&(d.refreshedUponExpiration=!1),y?{opacity:1,mix:1-Pt}:{opacity:Pt,mix:0}}return{opacity:1,mix:0}}var Cu=new i.Color(1,0,0,1),Ap=new i.Color(0,1,0,1),Wa=new i.Color(0,0,1,1),Io=new i.Color(1,0,1,1),zt=new i.Color(0,1,1,1);function ne(d,y,m,T){Ie(d,0,y+m/2,d.transform.width,m,T)}function _e(d,y,m,T){Ie(d,y-m/2,0,m,d.transform.height,T)}function Ie(d,y,m,T,O,U){var j=d.context,K=j.gl;K.enable(K.SCISSOR_TEST),K.scissor(y*i.browser.devicePixelRatio,m*i.browser.devicePixelRatio,T*i.browser.devicePixelRatio,O*i.browser.devicePixelRatio),j.clear({color:U}),K.disable(K.SCISSOR_TEST)}function ze(d,y,m){var T=d.context,O=T.gl,U=m.posMatrix,j=d.useProgram("debug"),K=Lt.disabled,it=vt.disabled,pt=d.colorModeForRenderPass();T.activeTexture.set(O.TEXTURE0),d.emptyTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),j.draw(T,O.LINE_STRIP,K,it,pt,Jt.disabled,$n(U,i.Color.red),"$debug",d.debugBuffer,d.tileBorderIndexBuffer,d.debugSegments);var Et=y.getTileByID(m.key).latestRawTileData,Ct=Math.floor((Et&&Et.byteLength||0)/1024),Pt=y.getTile(m).tileSize,Vt=512/Math.min(Pt,512)*(m.overscaledZ/d.transform.zoom)*.5,Ft=m.canonical.toString();m.overscaledZ!==m.canonical.z&&(Ft+=" => "+m.overscaledZ),function(Yt,Dt){Yt.initDebugOverlayCanvas();var Xt=Yt.debugOverlayCanvas,te=Yt.context.gl,le=Yt.debugOverlayCanvas.getContext("2d");le.clearRect(0,0,Xt.width,Xt.height),le.shadowColor="white",le.shadowBlur=2,le.lineWidth=1.5,le.strokeStyle="white",le.textBaseline="top",le.font="bold 36px Open Sans, sans-serif",le.fillText(Dt,5,5),le.strokeText(Dt,5,5),Yt.debugOverlayTexture.update(Xt),Yt.debugOverlayTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE)}(d,Ft+" "+Ct+"kb"),j.draw(T,O.TRIANGLES,K,it,Qt.alphaBlended,Jt.disabled,$n(U,i.Color.transparent,Vt),"$debug",d.debugBuffer,d.quadTriangleIndexBuffer,d.debugSegments)}var hr={symbol:function(d,y,m,T,O){if(d.renderPass==="translucent"){var U=vt.disabled,j=d.colorModeForRenderPass();m.layout.get("text-variable-anchor")&&function(K,it,pt,Et,Ct,Pt,Vt){for(var Ft=it.transform,Yt=Ct==="map",Dt=Pt==="map",Xt=0,te=K;Xt<te.length;Xt+=1){var le=te[Xt],be=Et.getTile(le),Ae=be.getBucket(pt);if(Ae&&Ae.text&&Ae.text.segments.get().length){var Me=i.evaluateSizeForZoom(Ae.textSizeData,Ft.zoom),Ve=Yi(be,1,it.transform.zoom),Je=yo(le.posMatrix,Dt,Yt,it.transform,Ve),$e=pt.layout.get("icon-text-fit")!=="none"&&Ae.hasIconData();if(Me){var wr=Math.pow(2,Ft.zoom-be.tileID.overscaledZ);il(Ae,Yt,Dt,Vt,i.symbolSize,Ft,Je,le.posMatrix,wr,Me,$e)}}}}(T,d,m,y,m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),O),m.paint.get("icon-opacity").constantOr(1)!==0&&mc(d,y,m,T,!1,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),m.layout.get("icon-rotation-alignment"),m.layout.get("icon-pitch-alignment"),m.layout.get("icon-keep-upright"),U,j),m.paint.get("text-opacity").constantOr(1)!==0&&mc(d,y,m,T,!0,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),m.layout.get("text-keep-upright"),U,j),y.map.showCollisionBoxes&&(Jl(d,y,m,T,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),!0),Jl(d,y,m,T,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),!1))}},circle:function(d,y,m,T){if(d.renderPass==="translucent"){var O=m.paint.get("circle-opacity"),U=m.paint.get("circle-stroke-width"),j=m.paint.get("circle-stroke-opacity"),K=m.layout.get("circle-sort-key").constantOr(1)!==void 0;if(O.constantOr(1)!==0||U.constantOr(1)!==0&&j.constantOr(1)!==0){for(var it=d.context,pt=it.gl,Et=d.depthModeForSublayer(0,Lt.ReadOnly),Ct=vt.disabled,Pt=d.colorModeForRenderPass(),Vt=[],Ft=0;Ft<T.length;Ft++){var Yt=T[Ft],Dt=y.getTile(Yt),Xt=Dt.getBucket(m);if(Xt){var te=Xt.programConfigurations.get(m.id),le={programConfiguration:te,program:d.useProgram("circle",te),layoutVertexBuffer:Xt.layoutVertexBuffer,indexBuffer:Xt.indexBuffer,uniformValues:ni(d,Yt,Dt,m)};if(K)for(var be=0,Ae=Xt.segments.get();be<Ae.length;be+=1){var Me=Ae[be];Vt.push({segments:new i.SegmentVector([Me]),sortKey:Me.sortKey,state:le})}else Vt.push({segments:Xt.segments,sortKey:0,state:le})}}K&&Vt.sort(function(qr,$r){return qr.sortKey-$r.sortKey});for(var Ve=0,Je=Vt;Ve<Je.length;Ve+=1){var $e=Je[Ve],wr=$e.state;wr.program.draw(it,pt.TRIANGLES,Et,Ct,Pt,Jt.disabled,wr.uniformValues,m.id,wr.layoutVertexBuffer,wr.indexBuffer,$e.segments,m.paint,d.transform.zoom,wr.programConfiguration)}}}},heatmap:function(d,y,m,T){if(m.paint.get("heatmap-opacity")!==0)if(d.renderPass==="offscreen"){var O=d.context,U=O.gl,j=vt.disabled,K=new Qt([U.ONE,U.ONE],i.Color.transparent,[!0,!0,!0,!0]);(function(Vt,Ft,Yt){var Dt=Vt.gl;Vt.activeTexture.set(Dt.TEXTURE1),Vt.viewport.set([0,0,Ft.width/4,Ft.height/4]);var Xt=Yt.heatmapFbo;if(Xt)Dt.bindTexture(Dt.TEXTURE_2D,Xt.colorAttachment.get()),Vt.bindFramebuffer.set(Xt.framebuffer);else{var te=Dt.createTexture();Dt.bindTexture(Dt.TEXTURE_2D,te),Dt.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_WRAP_S,Dt.CLAMP_TO_EDGE),Dt.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_WRAP_T,Dt.CLAMP_TO_EDGE),Dt.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_MIN_FILTER,Dt.LINEAR),Dt.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_MAG_FILTER,Dt.LINEAR),Xt=Yt.heatmapFbo=Vt.createFramebuffer(Ft.width/4,Ft.height/4,!1),function(le,be,Ae,Me){var Ve=le.gl;Ve.texImage2D(Ve.TEXTURE_2D,0,Ve.RGBA,be.width/4,be.height/4,0,Ve.RGBA,le.extRenderToTextureHalfFloat?le.extTextureHalfFloat.HALF_FLOAT_OES:Ve.UNSIGNED_BYTE,null),Me.colorAttachment.set(Ae)}(Vt,Ft,te,Xt)}})(O,d,m),O.clear({color:i.Color.transparent});for(var it=0;it<T.length;it++){var pt=T[it];if(!y.hasRenderableParent(pt)){var Et=y.getTile(pt),Ct=Et.getBucket(m);if(Ct){var Pt=Ct.programConfigurations.get(m.id);d.useProgram("heatmap",Pt).draw(O,U.TRIANGLES,Lt.disabled,j,K,Jt.disabled,Nn(pt.posMatrix,Et,d.transform.zoom,m.paint.get("heatmap-intensity")),m.id,Ct.layoutVertexBuffer,Ct.indexBuffer,Ct.segments,m.paint,d.transform.zoom,Pt)}}}O.viewport.set([0,0,d.width,d.height])}else d.renderPass==="translucent"&&(d.context.setColorMode(d.colorModeForRenderPass()),function(Vt,Ft){var Yt=Vt.context,Dt=Yt.gl,Xt=Ft.heatmapFbo;if(Xt){Yt.activeTexture.set(Dt.TEXTURE0),Dt.bindTexture(Dt.TEXTURE_2D,Xt.colorAttachment.get()),Yt.activeTexture.set(Dt.TEXTURE1);var te=Ft.colorRampTexture;te||(te=Ft.colorRampTexture=new i.Texture(Yt,Ft.colorRamp,Dt.RGBA)),te.bind(Dt.LINEAR,Dt.CLAMP_TO_EDGE),Vt.useProgram("heatmapTexture").draw(Yt,Dt.TRIANGLES,Lt.disabled,vt.disabled,Vt.colorModeForRenderPass(),Jt.disabled,function(le,be,Ae,Me){var Ve=i.create();i.ortho(Ve,0,le.width,le.height,0,0,1);var Je=le.context.gl;return{u_matrix:Ve,u_world:[Je.drawingBufferWidth,Je.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:be.paint.get("heatmap-opacity")}}(Vt,Ft),Ft.id,Vt.viewportBuffer,Vt.quadTriangleIndexBuffer,Vt.viewportSegments,Ft.paint,Vt.transform.zoom)}}(d,m))},line:function(d,y,m,T){if(d.renderPass==="translucent"){var O=m.paint.get("line-opacity"),U=m.paint.get("line-width");if(O.constantOr(1)!==0&&U.constantOr(1)!==0)for(var j=d.depthModeForSublayer(0,Lt.ReadOnly),K=d.colorModeForRenderPass(),it=m.paint.get("line-dasharray"),pt=m.paint.get("line-pattern"),Et=pt.constantOr(1),Ct=m.paint.get("line-gradient"),Pt=m.getCrossfadeParameters(),Vt=Et?"linePattern":it?"lineSDF":Ct?"lineGradient":"line",Ft=d.context,Yt=Ft.gl,Dt=!0,Xt=0,te=T;Xt<te.length;Xt+=1){var le=te[Xt],be=y.getTile(le);if(!Et||be.patternsLoaded()){var Ae=be.getBucket(m);if(Ae){var Me=Ae.programConfigurations.get(m.id),Ve=d.context.program.get(),Je=d.useProgram(Vt,Me),$e=Dt||Je.program!==Ve,wr=pt.constantOr(null);if(wr&&be.imageAtlas){var qr=be.imageAtlas,$r=qr.patternPositions[wr.to.toString()],Kr=qr.patternPositions[wr.from.toString()];$r&&Kr&&Me.setConstantPatternPositions($r,Kr)}var ei=Et?Qs(d,be,m,Pt):it?dp(d,be,m,it,Pt):Ct?Kn(d,be,m,Ae.lineClipsArray.length):kn(d,be,m);if(Et)Ft.activeTexture.set(Yt.TEXTURE0),be.imageAtlasTexture.bind(Yt.LINEAR,Yt.CLAMP_TO_EDGE),Me.updatePaintBuffers(Pt);else if(it&&($e||d.lineAtlas.dirty))Ft.activeTexture.set(Yt.TEXTURE0),d.lineAtlas.bind(Ft);else if(Ct){var Sr=Ae.gradients[m.id],mn=Sr.texture;if(m.gradientVersion!==Sr.version){var An=256;if(m.stepInterpolant){var cn=y.getSource().maxzoom,ln=le.canonical.z===cn?Math.ceil(1<<d.transform.maxZoom-le.canonical.z):1;An=i.clamp(i.nextPowerOfTwo(Ae.maxLineLength/i.EXTENT*1024*ln),256,Ft.maxTextureSize)}Sr.gradient=i.renderColorRamp({expression:m.gradientExpression(),evaluationKey:"lineProgress",resolution:An,image:Sr.gradient||void 0,clips:Ae.lineClipsArray}),Sr.texture?Sr.texture.update(Sr.gradient):Sr.texture=new i.Texture(Ft,Sr.gradient,Yt.RGBA),Sr.version=m.gradientVersion,mn=Sr.texture}Ft.activeTexture.set(Yt.TEXTURE0),mn.bind(m.stepInterpolant?Yt.NEAREST:Yt.LINEAR,Yt.CLAMP_TO_EDGE)}Je.draw(Ft,Yt.TRIANGLES,j,d.stencilModeForClipping(le),K,Jt.disabled,ei,m.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,m.paint,d.transform.zoom,Me,Ae.layoutVertexBuffer2),Dt=!1}}}}},fill:function(d,y,m,T){var O=m.paint.get("fill-color"),U=m.paint.get("fill-opacity");if(U.constantOr(1)!==0){var j=d.colorModeForRenderPass(),K=m.paint.get("fill-pattern"),it=d.opaquePassEnabledForLayer()&&!K.constantOr(1)&&O.constantOr(i.Color.transparent).a===1&&U.constantOr(0)===1?"opaque":"translucent";if(d.renderPass===it){var pt=d.depthModeForSublayer(1,d.renderPass==="opaque"?Lt.ReadWrite:Lt.ReadOnly);tu(d,y,m,T,pt,j,!1)}if(d.renderPass==="translucent"&&m.paint.get("fill-antialias")){var Et=d.depthModeForSublayer(m.getPaintProperty("fill-outline-color")?2:0,Lt.ReadOnly);tu(d,y,m,T,Et,j,!0)}}},"fill-extrusion":function(d,y,m,T){var O=m.paint.get("fill-extrusion-opacity");if(O!==0&&d.renderPass==="translucent"){var U=new Lt(d.context.gl.LEQUAL,Lt.ReadWrite,d.depthRangeFor3D);if(O!==1||m.paint.get("fill-extrusion-pattern").constantOr(1))ph(d,y,m,T,U,vt.disabled,Qt.disabled),ph(d,y,m,T,U,d.stencilModeFor3D(),d.colorModeForRenderPass());else{var j=d.colorModeForRenderPass();ph(d,y,m,T,U,vt.disabled,j)}}},hillshade:function(d,y,m,T){if(d.renderPass==="offscreen"||d.renderPass==="translucent"){for(var O=d.context,U=d.depthModeForSublayer(0,Lt.ReadOnly),j=d.colorModeForRenderPass(),K=d.renderPass==="translucent"?d.stencilConfigForOverlap(T):[{},T],it=K[0],pt=0,Et=K[1];pt<Et.length;pt+=1){var Ct=Et[pt],Pt=y.getTile(Ct);Pt.needsHillshadePrepare&&d.renderPass==="offscreen"?lf(d,Pt,m,U,vt.disabled,j):d.renderPass==="translucent"&&cf(d,Pt,m,U,it[Ct.overscaledZ],j)}O.viewport.set([0,0,d.width,d.height])}},raster:function(d,y,m,T){if(d.renderPass==="translucent"&&m.paint.get("raster-opacity")!==0&&T.length)for(var O=d.context,U=O.gl,j=y.getSource(),K=d.useProgram("raster"),it=d.colorModeForRenderPass(),pt=j instanceof Xr?[{},T]:d.stencilConfigForOverlap(T),Et=pt[0],Ct=pt[1],Pt=Ct[Ct.length-1].overscaledZ,Vt=!d.options.moving,Ft=0,Yt=Ct;Ft<Yt.length;Ft+=1){var Dt=Yt[Ft],Xt=d.depthModeForSublayer(Dt.overscaledZ-Pt,m.paint.get("raster-opacity")===1?Lt.ReadWrite:Lt.ReadOnly,U.LESS),te=y.getTile(Dt),le=d.transform.calculatePosMatrix(Dt.toUnwrapped(),Vt);te.registerFadeDuration(m.paint.get("raster-fade-duration"));var be=y.findLoadedParent(Dt,0),Ae=eu(te,be,y,m,d.transform),Me=void 0,Ve=void 0,Je=m.paint.get("raster-resampling")==="nearest"?U.NEAREST:U.LINEAR;O.activeTexture.set(U.TEXTURE0),te.texture.bind(Je,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),O.activeTexture.set(U.TEXTURE1),be?(be.texture.bind(Je,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),Me=Math.pow(2,be.tileID.overscaledZ-te.tileID.overscaledZ),Ve=[te.tileID.canonical.x*Me%1,te.tileID.canonical.y*Me%1]):te.texture.bind(Je,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST);var $e=Mu(le,Ve||[0,0],Me||1,Ae,m);j instanceof Xr?K.draw(O,U.TRIANGLES,Xt,vt.disabled,it,Jt.disabled,$e,m.id,j.boundsBuffer,d.quadTriangleIndexBuffer,j.boundsSegments):K.draw(O,U.TRIANGLES,Xt,Et[Dt.overscaledZ],it,Jt.disabled,$e,m.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}},background:function(d,y,m){var T=m.paint.get("background-color"),O=m.paint.get("background-opacity");if(O!==0){var U=d.context,j=U.gl,K=d.transform,it=K.tileSize,pt=m.paint.get("background-pattern");if(!d.isPatternMissing(pt)){var Et=!pt&&T.a===1&&O===1&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass===Et){var Ct=vt.disabled,Pt=d.depthModeForSublayer(0,Et==="opaque"?Lt.ReadWrite:Lt.ReadOnly),Vt=d.colorModeForRenderPass(),Ft=d.useProgram(pt?"backgroundPattern":"background"),Yt=K.coveringTiles({tileSize:it});pt&&(U.activeTexture.set(j.TEXTURE0),d.imageManager.bind(d.context));for(var Dt=m.getCrossfadeParameters(),Xt=0,te=Yt;Xt<te.length;Xt+=1){var le=te[Xt],be=d.transform.calculatePosMatrix(le.toUnwrapped()),Ae=pt?dn(be,O,d,pt,{tileID:le,tileSize:it},Dt):Bt(be,O,T);Ft.draw(U,j.TRIANGLES,Pt,Ct,Vt,Jt.disabled,Ae,m.id,d.tileExtentBuffer,d.quadTriangleIndexBuffer,d.tileExtentSegments)}}}}},debug:function(d,y,m){for(var T=0;T<m.length;T++)ze(d,y,m[T])},custom:function(d,y,m){var T=d.context,O=m.implementation;if(d.renderPass==="offscreen"){var U=O.prerender;U&&(d.setCustomLayerDefaults(),T.setColorMode(d.colorModeForRenderPass()),U.call(O,T.gl,d.transform.customLayerMatrix()),T.setDirty(),d.setBaseState())}else if(d.renderPass==="translucent"){d.setCustomLayerDefaults(),T.setColorMode(d.colorModeForRenderPass()),T.setStencilMode(vt.disabled);var j=O.renderingMode==="3d"?new Lt(d.context.gl.LEQUAL,Lt.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,Lt.ReadOnly);T.setDepthMode(j),O.render(T.gl,d.transform.customLayerMatrix()),T.setDirty(),d.setBaseState(),T.bindFramebuffer.set(null)}}},nr=function(d,y){this.context=new St(d),this.transform=y,this._tileTextures={},this.setup(),this.numSublayers=jt.maxUnderzooming+jt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Zl,this.gpuTimers={}};nr.prototype.resize=function(d,y){if(this.width=d*i.browser.devicePixelRatio,this.height=y*i.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var m=0,T=this.style._order;m<T.length;m+=1)this.style._layers[T[m]].resize()},nr.prototype.setup=function(){var d=this.context,y=new i.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(i.EXTENT,0),y.emplaceBack(0,i.EXTENT),y.emplaceBack(i.EXTENT,i.EXTENT),this.tileExtentBuffer=d.createVertexBuffer(y,xo.members),this.tileExtentSegments=i.SegmentVector.simpleSegment(0,0,4,2);var m=new i.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(i.EXTENT,0),m.emplaceBack(0,i.EXTENT),m.emplaceBack(i.EXTENT,i.EXTENT),this.debugBuffer=d.createVertexBuffer(m,xo.members),this.debugSegments=i.SegmentVector.simpleSegment(0,0,4,5);var T=new i.StructArrayLayout4i8;T.emplaceBack(0,0,0,0),T.emplaceBack(i.EXTENT,0,i.EXTENT,0),T.emplaceBack(0,i.EXTENT,0,i.EXTENT),T.emplaceBack(i.EXTENT,i.EXTENT,i.EXTENT,i.EXTENT),this.rasterBoundsBuffer=d.createVertexBuffer(T,gr.members),this.rasterBoundsSegments=i.SegmentVector.simpleSegment(0,0,4,2);var O=new i.StructArrayLayout2i4;O.emplaceBack(0,0),O.emplaceBack(1,0),O.emplaceBack(0,1),O.emplaceBack(1,1),this.viewportBuffer=d.createVertexBuffer(O,xo.members),this.viewportSegments=i.SegmentVector.simpleSegment(0,0,4,2);var U=new i.StructArrayLayout1ui2;U.emplaceBack(0),U.emplaceBack(1),U.emplaceBack(3),U.emplaceBack(2),U.emplaceBack(0),this.tileBorderIndexBuffer=d.createIndexBuffer(U);var j=new i.StructArrayLayout3ui6;j.emplaceBack(0,1,2),j.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=d.createIndexBuffer(j),this.emptyTexture=new i.Texture(d,{width:1,height:1,data:new Uint8Array([0,0,0,0])},d.gl.RGBA);var K=this.context.gl;this.stencilClearMode=new vt({func:K.ALWAYS,mask:0},0,255,K.ZERO,K.ZERO,K.ZERO)},nr.prototype.clearStencil=function(){var d=this.context,y=d.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var m=i.create();i.ortho(m,0,this.width,this.height,0,0,1),i.scale(m,m,[y.drawingBufferWidth,y.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(d,y.TRIANGLES,Lt.disabled,this.stencilClearMode,Qt.disabled,Jt.disabled,Hi(m),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},nr.prototype._renderTileClippingMasks=function(d,y){if(this.currentStencilSource!==d.source&&d.isTileClipped()&&y&&y.length){this.currentStencilSource=d.source;var m=this.context,T=m.gl;this.nextStencilID+y.length>256&&this.clearStencil(),m.setColorMode(Qt.disabled),m.setDepthMode(Lt.disabled);var O=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var U=0,j=y;U<j.length;U+=1){var K=j[U],it=this._tileClippingMaskIDs[K.key]=this.nextStencilID++;O.draw(m,T.TRIANGLES,Lt.disabled,new vt({func:T.ALWAYS,mask:0},it,255,T.KEEP,T.KEEP,T.REPLACE),Qt.disabled,Jt.disabled,Hi(K.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},nr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var d=this.nextStencilID++,y=this.context.gl;return new vt({func:y.NOTEQUAL,mask:255},d,255,y.KEEP,y.KEEP,y.REPLACE)},nr.prototype.stencilModeForClipping=function(d){var y=this.context.gl;return new vt({func:y.EQUAL,mask:255},this._tileClippingMaskIDs[d.key],0,y.KEEP,y.KEEP,y.REPLACE)},nr.prototype.stencilConfigForOverlap=function(d){var y,m=this.context.gl,T=d.sort(function(it,pt){return pt.overscaledZ-it.overscaledZ}),O=T[T.length-1].overscaledZ,U=T[0].overscaledZ-O+1;if(U>1){this.currentStencilSource=void 0,this.nextStencilID+U>256&&this.clearStencil();for(var j={},K=0;K<U;K++)j[K+O]=new vt({func:m.GEQUAL,mask:255},K+this.nextStencilID,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID+=U,[j,T]}return[(y={},y[O]=vt.disabled,y),T]},nr.prototype.colorModeForRenderPass=function(){var d=this.context.gl;return this._showOverdrawInspector?new Qt([d.CONSTANT_COLOR,d.ONE],new i.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Qt.unblended:Qt.alphaBlended},nr.prototype.depthModeForSublayer=function(d,y,m){if(!this.opaquePassEnabledForLayer())return Lt.disabled;var T=1-((1+this.currentLayer)*this.numSublayers+d)*this.depthEpsilon;return new Lt(m||this.context.gl.LEQUAL,y,[T,T])},nr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},nr.prototype.render=function(d,y){var m=this;this.style=d,this.options=y,this.lineAtlas=d.lineAtlas,this.imageManager=d.imageManager,this.glyphManager=d.glyphManager,this.symbolFadeChange=d.placement.symbolFadeChange(i.browser.now()),this.imageManager.beginFrame();var T=this.style._order,O=this.style.sourceCaches;for(var U in O){var j=O[U];j.used&&j.prepare(this.context)}var K,it,pt={},Et={},Ct={};for(var Pt in O){var Vt=O[Pt];pt[Pt]=Vt.getVisibleCoordinates(),Et[Pt]=pt[Pt].slice().reverse(),Ct[Pt]=Vt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Ft=0;Ft<T.length;Ft++)if(this.style._layers[T[Ft]].is3D()){this.opaquePassCutoff=Ft;break}this.renderPass="offscreen";for(var Yt=0,Dt=T;Yt<Dt.length;Yt+=1){var Xt=this.style._layers[Dt[Yt]];if(Xt.hasOffscreenPass()&&!Xt.isHidden(this.transform.zoom)){var te=Et[Xt.source];(Xt.type==="custom"||te.length)&&this.renderLayer(this,O[Xt.source],Xt,te)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:y.showOverdrawInspector?i.Color.black:i.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=y.showOverdrawInspector,this.depthRangeFor3D=[0,1-(d._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=T.length-1;this.currentLayer>=0;this.currentLayer--){var le=this.style._layers[T[this.currentLayer]],be=O[le.source],Ae=pt[le.source];this._renderTileClippingMasks(le,Ae),this.renderLayer(this,be,le,Ae)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<T.length;this.currentLayer++){var Me=this.style._layers[T[this.currentLayer]],Ve=O[Me.source],Je=(Me.type==="symbol"?Ct:Et)[Me.source];this._renderTileClippingMasks(Me,pt[Me.source]),this.renderLayer(this,Ve,Me,Je)}this.options.showTileBoundaries&&(i.values(this.style._layers).forEach(function($e){$e.source&&!$e.isHidden(m.transform.zoom)&&($e.source!==(it&&it.id)&&(it=m.style.sourceCaches[$e.source]),(!K||K.getSource().maxzoom<it.getSource().maxzoom)&&(K=it))}),K&&hr.debug(this,K,K.getVisibleCoordinates())),this.options.showPadding&&function($e){var wr=$e.transform.padding;ne($e,$e.transform.height-(wr.top||0),3,Cu),ne($e,wr.bottom||0,3,Ap),_e($e,wr.left||0,3,Wa),_e($e,$e.transform.width-(wr.right||0),3,Io);var qr=$e.transform.centerPoint;(function($r,Kr,ei,Sr){Ie($r,Kr-1,ei-10,2,20,Sr),Ie($r,Kr-10,ei-1,20,2,Sr)})($e,qr.x,$e.transform.height-qr.y,zt)}(this),this.context.setDefault()},nr.prototype.renderLayer=function(d,y,m,T){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="custom"||T.length)&&(this.id=m.id,this.gpuTimingStart(m),hr[m.type](d,y,m,T,this.style.placement.variableOffsets),this.gpuTimingEnd())},nr.prototype.gpuTimingStart=function(d){if(this.options.gpuTiming){var y=this.context.extTimerQuery,m=this.gpuTimers[d.id];m||(m=this.gpuTimers[d.id]={calls:0,cpuTime:0,query:y.createQueryEXT()}),m.calls++,y.beginQueryEXT(y.TIME_ELAPSED_EXT,m.query)}},nr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var d=this.context.extTimerQuery;d.endQueryEXT(d.TIME_ELAPSED_EXT)}},nr.prototype.collectGpuTimers=function(){var d=this.gpuTimers;return this.gpuTimers={},d},nr.prototype.queryGpuTimers=function(d){var y={};for(var m in d){var T=d[m],O=this.context.extTimerQuery,U=O.getQueryObjectEXT(T.query,O.QUERY_RESULT_EXT)/1e6;O.deleteQueryEXT(T.query),y[m]=U}return y},nr.prototype.translatePosMatrix=function(d,y,m,T,O){if(!m[0]&&!m[1])return d;var U=O?T==="map"?this.transform.angle:0:T==="viewport"?-this.transform.angle:0;if(U){var j=Math.sin(U),K=Math.cos(U);m=[m[0]*K-m[1]*j,m[0]*j+m[1]*K]}var it=[O?m[0]:Yi(y,m[0],this.transform.zoom),O?m[1]:Yi(y,m[1],this.transform.zoom),0],pt=new Float32Array(16);return i.translate(pt,d,it),pt},nr.prototype.saveTileTexture=function(d){var y=this._tileTextures[d.size[0]];y?y.push(d):this._tileTextures[d.size[0]]=[d]},nr.prototype.getTileTexture=function(d){var y=this._tileTextures[d];return y&&y.length>0?y.pop():null},nr.prototype.isPatternMissing=function(d){if(!d)return!1;if(!d.from||!d.to)return!0;var y=this.imageManager.getPattern(d.from.toString()),m=this.imageManager.getPattern(d.to.toString());return!y||!m},nr.prototype.useProgram=function(d,y){this.cache=this.cache||{};var m=""+d+(y?y.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[m]||(this.cache[m]=new ve(this.context,d,rr[d],y,mp[d],this._showOverdrawInspector)),this.cache[m]},nr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},nr.prototype.setBaseState=function(){var d=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(d.FUNC_ADD)},nr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=i.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},nr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var pr=function(d,y){this.points=d,this.planes=y};pr.fromInvProjectionMatrix=function(d,y,m){var T=Math.pow(2,m),O=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(j){return i.transformMat4([],j,d)}).map(function(j){return i.scale$1([],j,1/j[3]/y*T)}),U=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(j){var K=i.sub([],O[j[0]],O[j[1]]),it=i.sub([],O[j[2]],O[j[1]]),pt=i.normalize([],i.cross([],K,it)),Et=-i.dot(pt,O[j[1]]);return pt.concat(Et)});return new pr(O,U)};var Pr=function(d,y){this.min=d,this.max=y,this.center=i.scale$2([],i.add([],this.min,this.max),.5)};Pr.prototype.quadrant=function(d){for(var y=[d%2==0,d<2],m=i.clone$2(this.min),T=i.clone$2(this.max),O=0;O<y.length;O++)m[O]=y[O]?this.min[O]:this.center[O],T[O]=y[O]?this.center[O]:this.max[O];return T[2]=this.max[2],new Pr(m,T)},Pr.prototype.distanceX=function(d){return Math.max(Math.min(this.max[0],d[0]),this.min[0])-d[0]},Pr.prototype.distanceY=function(d){return Math.max(Math.min(this.max[1],d[1]),this.min[1])-d[1]},Pr.prototype.intersects=function(d){for(var y=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],m=!0,T=0;T<d.planes.length;T++){for(var O=d.planes[T],U=0,j=0;j<y.length;j++)U+=i.dot$1(O,y[j])>=0;if(U===0)return 0;U!==y.length&&(m=!1)}if(m)return 2;for(var K=0;K<3;K++){for(var it=Number.MAX_VALUE,pt=-Number.MAX_VALUE,Et=0;Et<d.points.length;Et++){var Ct=d.points[Et][K]-this.min[K];it=Math.min(it,Ct),pt=Math.max(pt,Ct)}if(pt<0||it>this.max[K]-this.min[K])return 0}return 1};var Sn=function(d,y,m,T){if(d===void 0&&(d=0),y===void 0&&(y=0),m===void 0&&(m=0),T===void 0&&(T=0),isNaN(d)||d<0||isNaN(y)||y<0||isNaN(m)||m<0||isNaN(T)||T<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=d,this.bottom=y,this.left=m,this.right=T};Sn.prototype.interpolate=function(d,y,m){return y.top!=null&&d.top!=null&&(this.top=i.number(d.top,y.top,m)),y.bottom!=null&&d.bottom!=null&&(this.bottom=i.number(d.bottom,y.bottom,m)),y.left!=null&&d.left!=null&&(this.left=i.number(d.left,y.left,m)),y.right!=null&&d.right!=null&&(this.right=i.number(d.right,y.right,m)),this},Sn.prototype.getCenter=function(d,y){var m=i.clamp((this.left+d-this.right)/2,0,d),T=i.clamp((this.top+y-this.bottom)/2,0,y);return new i.Point(m,T)},Sn.prototype.equals=function(d){return this.top===d.top&&this.bottom===d.bottom&&this.left===d.left&&this.right===d.right},Sn.prototype.clone=function(){return new Sn(this.top,this.bottom,this.left,this.right)},Sn.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var dr=function(d,y,m,T,O){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=O===void 0||O,this._minZoom=d||0,this._maxZoom=y||22,this._minPitch=m??0,this._maxPitch=T??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new i.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Sn,this._posMatrixCache={},this._alignedPosMatrixCache={}},kr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};dr.prototype.clone=function(){var d=new dr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return d.tileSize=this.tileSize,d.latRange=this.latRange,d.width=this.width,d.height=this.height,d._center=this._center,d.zoom=this.zoom,d.angle=this.angle,d._fov=this._fov,d._pitch=this._pitch,d._unmodified=this._unmodified,d._edgeInsets=this._edgeInsets.clone(),d._calcMatrices(),d},kr.minZoom.get=function(){return this._minZoom},kr.minZoom.set=function(d){this._minZoom!==d&&(this._minZoom=d,this.zoom=Math.max(this.zoom,d))},kr.maxZoom.get=function(){return this._maxZoom},kr.maxZoom.set=function(d){this._maxZoom!==d&&(this._maxZoom=d,this.zoom=Math.min(this.zoom,d))},kr.minPitch.get=function(){return this._minPitch},kr.minPitch.set=function(d){this._minPitch!==d&&(this._minPitch=d,this.pitch=Math.max(this.pitch,d))},kr.maxPitch.get=function(){return this._maxPitch},kr.maxPitch.set=function(d){this._maxPitch!==d&&(this._maxPitch=d,this.pitch=Math.min(this.pitch,d))},kr.renderWorldCopies.get=function(){return this._renderWorldCopies},kr.renderWorldCopies.set=function(d){d===void 0?d=!0:d===null&&(d=!1),this._renderWorldCopies=d},kr.worldSize.get=function(){return this.tileSize*this.scale},kr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},kr.size.get=function(){return new i.Point(this.width,this.height)},kr.bearing.get=function(){return-this.angle/Math.PI*180},kr.bearing.set=function(d){var y=-i.wrap(d,-180,180)*Math.PI/180;this.angle!==y&&(this._unmodified=!1,this.angle=y,this._calcMatrices(),this.rotationMatrix=i.create$2(),i.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},kr.pitch.get=function(){return this._pitch/Math.PI*180},kr.pitch.set=function(d){var y=i.clamp(d,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==y&&(this._unmodified=!1,this._pitch=y,this._calcMatrices())},kr.fov.get=function(){return this._fov/Math.PI*180},kr.fov.set=function(d){d=Math.max(.01,Math.min(60,d)),this._fov!==d&&(this._unmodified=!1,this._fov=d/180*Math.PI,this._calcMatrices())},kr.zoom.get=function(){return this._zoom},kr.zoom.set=function(d){var y=Math.min(Math.max(d,this.minZoom),this.maxZoom);this._zoom!==y&&(this._unmodified=!1,this._zoom=y,this.scale=this.zoomScale(y),this.tileZoom=Math.floor(y),this.zoomFraction=y-this.tileZoom,this._constrain(),this._calcMatrices())},kr.center.get=function(){return this._center},kr.center.set=function(d){d.lat===this._center.lat&&d.lng===this._center.lng||(this._unmodified=!1,this._center=d,this._constrain(),this._calcMatrices())},kr.padding.get=function(){return this._edgeInsets.toJSON()},kr.padding.set=function(d){this._edgeInsets.equals(d)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,d,1),this._calcMatrices())},kr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},dr.prototype.isPaddingEqual=function(d){return this._edgeInsets.equals(d)},dr.prototype.interpolatePadding=function(d,y,m){this._unmodified=!1,this._edgeInsets.interpolate(d,y,m),this._constrain(),this._calcMatrices()},dr.prototype.coveringZoomLevel=function(d){var y=(d.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/d.tileSize));return Math.max(0,y)},dr.prototype.getVisibleUnwrappedCoordinates=function(d){var y=[new i.UnwrappedTileID(0,d)];if(this._renderWorldCopies)for(var m=this.pointCoordinate(new i.Point(0,0)),T=this.pointCoordinate(new i.Point(this.width,0)),O=this.pointCoordinate(new i.Point(this.width,this.height)),U=this.pointCoordinate(new i.Point(0,this.height)),j=Math.floor(Math.min(m.x,T.x,O.x,U.x)),K=Math.floor(Math.max(m.x,T.x,O.x,U.x)),it=j-1;it<=K+1;it++)it!==0&&y.push(new i.UnwrappedTileID(it,d));return y},dr.prototype.coveringTiles=function(d){var y=this.coveringZoomLevel(d),m=y;if(d.minzoom!==void 0&&y<d.minzoom)return[];d.maxzoom!==void 0&&y>d.maxzoom&&(y=d.maxzoom);var T=i.MercatorCoordinate.fromLngLat(this.center),O=Math.pow(2,y),U=[O*T.x,O*T.y,0],j=pr.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,y),K=d.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(K=y);var it=function($e){return{aabb:new Pr([$e*O,0,0],[($e+1)*O,O,0]),zoom:0,x:0,y:0,wrap:$e,fullyVisible:!1}},pt=[],Et=[],Ct=y,Pt=d.reparseOverscaled?m:y;if(this._renderWorldCopies)for(var Vt=1;Vt<=3;Vt++)pt.push(it(-Vt)),pt.push(it(Vt));for(pt.push(it(0));pt.length>0;){var Ft=pt.pop(),Yt=Ft.x,Dt=Ft.y,Xt=Ft.fullyVisible;if(!Xt){var te=Ft.aabb.intersects(j);if(te===0)continue;Xt=te===2}var le=Ft.aabb.distanceX(U),be=Ft.aabb.distanceY(U),Ae=Math.max(Math.abs(le),Math.abs(be));if(Ft.zoom===Ct||Ae>3+(1<<Ct-Ft.zoom)-2&&Ft.zoom>=K)Et.push({tileID:new i.OverscaledTileID(Ft.zoom===Ct?Pt:Ft.zoom,Ft.wrap,Ft.zoom,Yt,Dt),distanceSq:i.sqrLen([U[0]-.5-Yt,U[1]-.5-Dt])});else for(var Me=0;Me<4;Me++){var Ve=(Yt<<1)+Me%2,Je=(Dt<<1)+(Me>>1);pt.push({aabb:Ft.aabb.quadrant(Me),zoom:Ft.zoom+1,x:Ve,y:Je,wrap:Ft.wrap,fullyVisible:Xt})}}return Et.sort(function($e,wr){return $e.distanceSq-wr.distanceSq}).map(function($e){return $e.tileID})},dr.prototype.resize=function(d,y){this.width=d,this.height=y,this.pixelsToGLUnits=[2/d,-2/y],this._constrain(),this._calcMatrices()},kr.unmodified.get=function(){return this._unmodified},dr.prototype.zoomScale=function(d){return Math.pow(2,d)},dr.prototype.scaleZoom=function(d){return Math.log(d)/Math.LN2},dr.prototype.project=function(d){var y=i.clamp(d.lat,-this.maxValidLatitude,this.maxValidLatitude);return new i.Point(i.mercatorXfromLng(d.lng)*this.worldSize,i.mercatorYfromLat(y)*this.worldSize)},dr.prototype.unproject=function(d){return new i.MercatorCoordinate(d.x/this.worldSize,d.y/this.worldSize).toLngLat()},kr.point.get=function(){return this.project(this.center)},dr.prototype.setLocationAtPoint=function(d,y){var m=this.pointCoordinate(y),T=this.pointCoordinate(this.centerPoint),O=this.locationCoordinate(d),U=new i.MercatorCoordinate(O.x-(m.x-T.x),O.y-(m.y-T.y));this.center=this.coordinateLocation(U),this._renderWorldCopies&&(this.center=this.center.wrap())},dr.prototype.locationPoint=function(d){return this.coordinatePoint(this.locationCoordinate(d))},dr.prototype.pointLocation=function(d){return this.coordinateLocation(this.pointCoordinate(d))},dr.prototype.locationCoordinate=function(d){return i.MercatorCoordinate.fromLngLat(d)},dr.prototype.coordinateLocation=function(d){return d.toLngLat()},dr.prototype.pointCoordinate=function(d){var y=[d.x,d.y,0,1],m=[d.x,d.y,1,1];i.transformMat4(y,y,this.pixelMatrixInverse),i.transformMat4(m,m,this.pixelMatrixInverse);var T=y[3],O=m[3],U=y[1]/T,j=m[1]/O,K=y[2]/T,it=m[2]/O,pt=K===it?0:(0-K)/(it-K);return new i.MercatorCoordinate(i.number(y[0]/T,m[0]/O,pt)/this.worldSize,i.number(U,j,pt)/this.worldSize)},dr.prototype.coordinatePoint=function(d){var y=[d.x*this.worldSize,d.y*this.worldSize,0,1];return i.transformMat4(y,y,this.pixelMatrix),new i.Point(y[0]/y[3],y[1]/y[3])},dr.prototype.getBounds=function(){return new i.LngLatBounds().extend(this.pointLocation(new i.Point(0,0))).extend(this.pointLocation(new i.Point(this.width,0))).extend(this.pointLocation(new i.Point(this.width,this.height))).extend(this.pointLocation(new i.Point(0,this.height)))},dr.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new i.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},dr.prototype.setMaxBounds=function(d){d?(this.lngRange=[d.getWest(),d.getEast()],this.latRange=[d.getSouth(),d.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},dr.prototype.calculatePosMatrix=function(d,y){y===void 0&&(y=!1);var m=d.key,T=y?this._alignedPosMatrixCache:this._posMatrixCache;if(T[m])return T[m];var O=d.canonical,U=this.worldSize/this.zoomScale(O.z),j=O.x+Math.pow(2,O.z)*d.wrap,K=i.identity(new Float64Array(16));return i.translate(K,K,[j*U,O.y*U,0]),i.scale(K,K,[U/i.EXTENT,U/i.EXTENT,1]),i.multiply(K,y?this.alignedProjMatrix:this.projMatrix,K),T[m]=new Float32Array(K),T[m]},dr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},dr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var d,y,m,T,O=-90,U=90,j=-180,K=180,it=this.size,pt=this._unmodified;if(this.latRange){var Et=this.latRange;O=i.mercatorYfromLat(Et[1])*this.worldSize,d=(U=i.mercatorYfromLat(Et[0])*this.worldSize)-O<it.y?it.y/(U-O):0}if(this.lngRange){var Ct=this.lngRange;j=i.mercatorXfromLng(Ct[0])*this.worldSize,y=(K=i.mercatorXfromLng(Ct[1])*this.worldSize)-j<it.x?it.x/(K-j):0}var Pt=this.point,Vt=Math.max(y||0,d||0);if(Vt)return this.center=this.unproject(new i.Point(y?(K+j)/2:Pt.x,d?(U+O)/2:Pt.y)),this.zoom+=this.scaleZoom(Vt),this._unmodified=pt,void(this._constraining=!1);if(this.latRange){var Ft=Pt.y,Yt=it.y/2;Ft-Yt<O&&(T=O+Yt),Ft+Yt>U&&(T=U-Yt)}if(this.lngRange){var Dt=Pt.x,Xt=it.x/2;Dt-Xt<j&&(m=j+Xt),Dt+Xt>K&&(m=K-Xt)}m===void 0&&T===void 0||(this.center=this.unproject(new i.Point(m!==void 0?m:Pt.x,T!==void 0?T:Pt.y))),this._unmodified=pt,this._constraining=!1}},dr.prototype._calcMatrices=function(){if(this.height){var d=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var y=Math.PI/2+this._pitch,m=this._fov*(.5+d.y/this.height),T=Math.sin(m)*this.cameraToCenterDistance/Math.sin(i.clamp(Math.PI-y-m,.01,Math.PI-.01)),O=this.point,U=O.x,j=O.y,K=1.01*(Math.cos(Math.PI/2-this._pitch)*T+this.cameraToCenterDistance),it=this.height/50,pt=new Float64Array(16);i.perspective(pt,this._fov,this.width/this.height,it,K),pt[8]=2*-d.x/this.width,pt[9]=2*d.y/this.height,i.scale(pt,pt,[1,-1,1]),i.translate(pt,pt,[0,0,-this.cameraToCenterDistance]),i.rotateX(pt,pt,this._pitch),i.rotateZ(pt,pt,this.angle),i.translate(pt,pt,[-U,-j,0]),this.mercatorMatrix=i.scale([],pt,[this.worldSize,this.worldSize,this.worldSize]),i.scale(pt,pt,[1,1,i.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=pt,this.invProjMatrix=i.invert([],this.projMatrix);var Et=this.width%2/2,Ct=this.height%2/2,Pt=Math.cos(this.angle),Vt=Math.sin(this.angle),Ft=U-Math.round(U)+Pt*Et+Vt*Ct,Yt=j-Math.round(j)+Pt*Ct+Vt*Et,Dt=new Float64Array(pt);if(i.translate(Dt,Dt,[Ft>.5?Ft-1:Ft,Yt>.5?Yt-1:Yt,0]),this.alignedProjMatrix=Dt,pt=i.create(),i.scale(pt,pt,[this.width/2,-this.height/2,1]),i.translate(pt,pt,[1,-1,0]),this.labelPlaneMatrix=pt,pt=i.create(),i.scale(pt,pt,[1,-1,1]),i.translate(pt,pt,[-1,-1,0]),i.scale(pt,pt,[2/this.width,2/this.height,1]),this.glCoordMatrix=pt,this.pixelMatrix=i.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(pt=i.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=pt,this._posMatrixCache={},this._alignedPosMatrixCache={}}},dr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var d=this.pointCoordinate(new i.Point(0,0)),y=[d.x*this.worldSize,d.y*this.worldSize,0,1];return i.transformMat4(y,y,this.pixelMatrix)[3]/this.cameraToCenterDistance},dr.prototype.getCameraPoint=function(){var d=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.Point(0,d))},dr.prototype.getCameraQueryGeometry=function(d){var y=this.getCameraPoint();if(d.length===1)return[d[0],y];for(var m=y.x,T=y.y,O=y.x,U=y.y,j=0,K=d;j<K.length;j+=1){var it=K[j];m=Math.min(m,it.x),T=Math.min(T,it.y),O=Math.max(O,it.x),U=Math.max(U,it.y)}return[new i.Point(m,T),new i.Point(O,T),new i.Point(O,U),new i.Point(m,U),new i.Point(m,T)]},Object.defineProperties(dr.prototype,kr);var xn=function(d){var y,m,T,O;this._hashName=d&&encodeURIComponent(d),i.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(y=this._updateHashUnthrottled.bind(this),m=!1,T=null,O=function(){T=null,m&&(y(),T=setTimeout(O,300),m=!1)},function(){return m=!0,T||O(),T})};xn.prototype.addTo=function(d){return this._map=d,i.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},xn.prototype.remove=function(){return i.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},xn.prototype.getHashString=function(d){var y=this._map.getCenter(),m=Math.round(100*this._map.getZoom())/100,T=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),O=Math.pow(10,T),U=Math.round(y.lng*O)/O,j=Math.round(y.lat*O)/O,K=this._map.getBearing(),it=this._map.getPitch(),pt="";if(pt+=d?"/"+U+"/"+j+"/"+m:m+"/"+j+"/"+U,(K||it)&&(pt+="/"+Math.round(10*K)/10),it&&(pt+="/"+Math.round(it)),this._hashName){var Et=this._hashName,Ct=!1,Pt=i.window.location.hash.slice(1).split("&").map(function(Vt){var Ft=Vt.split("=")[0];return Ft===Et?(Ct=!0,Ft+"="+pt):Vt}).filter(function(Vt){return Vt});return Ct||Pt.push(Et+"="+pt),"#"+Pt.join("&")}return"#"+pt},xn.prototype._getCurrentHash=function(){var d,y=this,m=i.window.location.hash.replace("#","");return this._hashName?(m.split("&").map(function(T){return T.split("=")}).forEach(function(T){T[0]===y._hashName&&(d=T)}),(d&&d[1]||"").split("/")):m.split("/")},xn.prototype._onHashChange=function(){var d=this._getCurrentHash();if(d.length>=3&&!d.some(function(m){return isNaN(m)})){var y=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:y,pitch:+(d[4]||0)}),!0}return!1},xn.prototype._updateHashUnthrottled=function(){var d=i.window.location.href.replace(/(#.+)?$/,this.getHashString());try{i.window.history.replaceState(i.window.history.state,null,d)}catch{}};var sn={linearity:.3,easing:i.bezier(0,0,.3,1)},xi=i.extend({deceleration:2500,maxSpeed:1400},sn),Go=i.extend({deceleration:20,maxSpeed:1400},sn),zs=i.extend({deceleration:1e3,maxSpeed:360},sn),qa=i.extend({deceleration:1e3,maxSpeed:90},sn),Js=function(d){this._map=d,this.clear()};function Ac(d,y){(!d.duration||d.duration<y.duration)&&(d.duration=y.duration,d.easing=y.easing)}function po(d,y,m){var T=m.maxSpeed,O=m.linearity,U=m.deceleration,j=i.clamp(d*O/(y/1e3),-T,T),K=Math.abs(j)/(U*O);return{easing:m.easing,duration:1e3*K,amount:j*(K/2)}}Js.prototype.clear=function(){this._inertiaBuffer=[]},Js.prototype.record=function(d){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.browser.now(),settings:d})},Js.prototype._drainInertiaBuffer=function(){for(var d=this._inertiaBuffer,y=i.browser.now();d.length>0&&y-d[0].time>160;)d.shift()},Js.prototype._onMoveEnd=function(d){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var y={zoom:0,bearing:0,pitch:0,pan:new i.Point(0,0),pinchAround:void 0,around:void 0},m=0,T=this._inertiaBuffer;m<T.length;m+=1){var O=T[m].settings;y.zoom+=O.zoomDelta||0,y.bearing+=O.bearingDelta||0,y.pitch+=O.pitchDelta||0,O.panDelta&&y.pan._add(O.panDelta),O.around&&(y.around=O.around),O.pinchAround&&(y.pinchAround=O.pinchAround)}var U=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,j={};if(y.pan.mag()){var K=po(y.pan.mag(),U,i.extend({},xi,d||{}));j.offset=y.pan.mult(K.amount/y.pan.mag()),j.center=this._map.transform.center,Ac(j,K)}if(y.zoom){var it=po(y.zoom,U,Go);j.zoom=this._map.transform.zoom+it.amount,Ac(j,it)}if(y.bearing){var pt=po(y.bearing,U,zs);j.bearing=this._map.transform.bearing+i.clamp(pt.amount,-179,179),Ac(j,pt)}if(y.pitch){var Et=po(y.pitch,U,qa);j.pitch=this._map.transform.pitch+Et.amount,Ac(j,Et)}if(j.zoom||j.bearing){var Ct=y.pinchAround===void 0?y.around:y.pinchAround;j.around=Ct?this._map.unproject(Ct):this._map.getCenter()}return this.clear(),i.extend(j,{noMoveStart:!0})}};var is=function(d){function y(T,O,U,j){j===void 0&&(j={});var K=s.mousePos(O.getCanvasContainer(),U),it=O.unproject(K);d.call(this,T,i.extend({point:K,lngLat:it,originalEvent:U},j)),this._defaultPrevented=!1,this.target=O}d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y;var m={defaultPrevented:{configurable:!0}};return y.prototype.preventDefault=function(){this._defaultPrevented=!0},m.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(y.prototype,m),y}(i.Event),gp=function(d){function y(T,O,U){var j=T==="touchend"?U.changedTouches:U.touches,K=s.touchPos(O.getCanvasContainer(),j),it=K.map(function(Ct){return O.unproject(Ct)}),pt=K.reduce(function(Ct,Pt,Vt,Ft){return Ct.add(Pt.div(Ft.length))},new i.Point(0,0)),Et=O.unproject(pt);d.call(this,T,{points:K,point:pt,lngLats:it,lngLat:Et,originalEvent:U}),this._defaultPrevented=!1}d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y;var m={defaultPrevented:{configurable:!0}};return y.prototype.preventDefault=function(){this._defaultPrevented=!0},m.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(y.prototype,m),y}(i.Event),Dg=function(d){function y(T,O,U){d.call(this,T,{originalEvent:U}),this._defaultPrevented=!1}d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y;var m={defaultPrevented:{configurable:!0}};return y.prototype.preventDefault=function(){this._defaultPrevented=!0},m.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(y.prototype,m),y}(i.Event),li=function(d,y){this._map=d,this._clickTolerance=y.clickTolerance};li.prototype.reset=function(){delete this._mousedownPos},li.prototype.wheel=function(d){return this._firePreventable(new Dg(d.type,this._map,d))},li.prototype.mousedown=function(d,y){return this._mousedownPos=y,this._firePreventable(new is(d.type,this._map,d))},li.prototype.mouseup=function(d){this._map.fire(new is(d.type,this._map,d))},li.prototype.click=function(d,y){this._mousedownPos&&this._mousedownPos.dist(y)>=this._clickTolerance||this._map.fire(new is(d.type,this._map,d))},li.prototype.dblclick=function(d){return this._firePreventable(new is(d.type,this._map,d))},li.prototype.mouseover=function(d){this._map.fire(new is(d.type,this._map,d))},li.prototype.mouseout=function(d){this._map.fire(new is(d.type,this._map,d))},li.prototype.touchstart=function(d){return this._firePreventable(new gp(d.type,this._map,d))},li.prototype.touchmove=function(d){this._map.fire(new gp(d.type,this._map,d))},li.prototype.touchend=function(d){this._map.fire(new gp(d.type,this._map,d))},li.prototype.touchcancel=function(d){this._map.fire(new gp(d.type,this._map,d))},li.prototype._firePreventable=function(d){if(this._map.fire(d),d.defaultPrevented)return{}},li.prototype.isEnabled=function(){return!0},li.prototype.isActive=function(){return!1},li.prototype.enable=function(){},li.prototype.disable=function(){};var _r=function(d){this._map=d};_r.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},_r.prototype.mousemove=function(d){this._map.fire(new is(d.type,this._map,d))},_r.prototype.mousedown=function(){this._delayContextMenu=!0},_r.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new is("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},_r.prototype.contextmenu=function(d){this._delayContextMenu?this._contextMenuEvent=d:this._map.fire(new is(d.type,this._map,d)),this._map.listens("contextmenu")&&d.preventDefault()},_r.prototype.isEnabled=function(){return!0},_r.prototype.isActive=function(){return!1},_r.prototype.enable=function(){},_r.prototype.disable=function(){};var to=function(d,y){this._map=d,this._el=d.getCanvasContainer(),this._container=d.getContainer(),this._clickTolerance=y.clickTolerance||1};function uf(d,y){for(var m={},T=0;T<d.length;T++)m[d[T].identifier]=y[T];return m}to.prototype.isEnabled=function(){return!!this._enabled},to.prototype.isActive=function(){return!!this._active},to.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},to.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},to.prototype.mousedown=function(d,y){this.isEnabled()&&d.shiftKey&&d.button===0&&(s.disableDrag(),this._startPos=this._lastPos=y,this._active=!0)},to.prototype.mousemoveWindow=function(d,y){if(this._active){var m=y;if(!(this._lastPos.equals(m)||!this._box&&m.dist(this._startPos)<this._clickTolerance)){var T=this._startPos;this._lastPos=m,this._box||(this._box=s.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",d));var O=Math.min(T.x,m.x),U=Math.max(T.x,m.x),j=Math.min(T.y,m.y),K=Math.max(T.y,m.y);s.setTransform(this._box,"translate("+O+"px,"+j+"px)"),this._box.style.width=U-O+"px",this._box.style.height=K-j+"px"}}},to.prototype.mouseupWindow=function(d,y){var m=this;if(this._active&&d.button===0){var T=this._startPos,O=y;if(this.reset(),s.suppressClick(),T.x!==O.x||T.y!==O.y)return this._map.fire(new i.Event("boxzoomend",{originalEvent:d})),{cameraAnimation:function(U){return U.fitScreenCoordinates(T,O,m._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",d)}},to.prototype.keydown=function(d){this._active&&d.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",d))},to.prototype.blur=function(){this.reset()},to.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(s.remove(this._box),this._box=null),s.enableDrag(),delete this._startPos,delete this._lastPos},to.prototype._fireEvent=function(d,y){return this._map.fire(new i.Event(d,{originalEvent:y}))};var dh=function(d){this.reset(),this.numTouches=d.numTouches};dh.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},dh.prototype.touchstart=function(d,y,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=d.timeStamp),m.length===this.numTouches&&(this.centroid=function(T){for(var O=new i.Point(0,0),U=0,j=T;U<j.length;U+=1)O._add(j[U]);return O.div(T.length)}(y),this.touches=uf(m,y)))},dh.prototype.touchmove=function(d,y,m){if(!this.aborted&&this.centroid){var T=uf(m,y);for(var O in this.touches){var U=T[O];(!U||U.dist(this.touches[O])>30)&&(this.aborted=!0)}}},dh.prototype.touchend=function(d,y,m){if((!this.centroid||d.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){var T=!this.aborted&&this.centroid;if(this.reset(),T)return T}};var Ga=function(d){this.singleTap=new dh(d),this.numTaps=d.numTaps,this.reset()};Ga.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Ga.prototype.touchstart=function(d,y,m){this.singleTap.touchstart(d,y,m)},Ga.prototype.touchmove=function(d,y,m){this.singleTap.touchmove(d,y,m)},Ga.prototype.touchend=function(d,y,m){var T=this.singleTap.touchend(d,y,m);if(T){var O=d.timeStamp-this.lastTime<500,U=!this.lastTap||this.lastTap.dist(T)<30;if(O&&U||this.reset(),this.count++,this.lastTime=d.timeStamp,this.lastTap=T,this.count===this.numTaps)return this.reset(),T}};var Xa=function(){this._zoomIn=new Ga({numTouches:1,numTaps:2}),this._zoomOut=new Ga({numTouches:2,numTaps:1}),this.reset()};Xa.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Xa.prototype.touchstart=function(d,y,m){this._zoomIn.touchstart(d,y,m),this._zoomOut.touchstart(d,y,m)},Xa.prototype.touchmove=function(d,y,m){this._zoomIn.touchmove(d,y,m),this._zoomOut.touchmove(d,y,m)},Xa.prototype.touchend=function(d,y,m){var T=this,O=this._zoomIn.touchend(d,y,m),U=this._zoomOut.touchend(d,y,m);return O?(this._active=!0,d.preventDefault(),setTimeout(function(){return T.reset()},0),{cameraAnimation:function(j){return j.easeTo({duration:300,zoom:j.getZoom()+1,around:j.unproject(O)},{originalEvent:d})}}):U?(this._active=!0,d.preventDefault(),setTimeout(function(){return T.reset()},0),{cameraAnimation:function(j){return j.easeTo({duration:300,zoom:j.getZoom()-1,around:j.unproject(U)},{originalEvent:d})}}):void 0},Xa.prototype.touchcancel=function(){this.reset()},Xa.prototype.enable=function(){this._enabled=!0},Xa.prototype.disable=function(){this._enabled=!1,this.reset()},Xa.prototype.isEnabled=function(){return this._enabled},Xa.prototype.isActive=function(){return this._active};var TA={0:1,2:2},lr=function(d){this.reset(),this._clickTolerance=d.clickTolerance||1};lr.prototype.blur=function(){this.reset()},lr.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},lr.prototype._correctButton=function(d,y){return!1},lr.prototype._move=function(d,y){return{}},lr.prototype.mousedown=function(d,y){if(!this._lastPoint){var m=s.mouseButton(d);this._correctButton(d,m)&&(this._lastPoint=y,this._eventButton=m)}},lr.prototype.mousemoveWindow=function(d,y){var m=this._lastPoint;if(m){if(d.preventDefault(),function(T,O){var U=TA[O];return T.buttons===void 0||(T.buttons&U)!==U}(d,this._eventButton))this.reset();else if(this._moved||!(y.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=y,this._move(m,y)}},lr.prototype.mouseupWindow=function(d){this._lastPoint&&s.mouseButton(d)===this._eventButton&&(this._moved&&s.suppressClick(),this.reset())},lr.prototype.enable=function(){this._enabled=!0},lr.prototype.disable=function(){this._enabled=!1,this.reset()},lr.prototype.isEnabled=function(){return this._enabled},lr.prototype.isActive=function(){return this._active};var Vd=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.mousedown=function(m,T){d.prototype.mousedown.call(this,m,T),this._lastPoint&&(this._active=!0)},y.prototype._correctButton=function(m,T){return T===0&&!m.ctrlKey},y.prototype._move=function(m,T){return{around:T,panDelta:T.sub(m)}},y}(lr),mh=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype._correctButton=function(m,T){return T===0&&m.ctrlKey||T===2},y.prototype._move=function(m,T){var O=.8*(T.x-m.x);if(O)return this._active=!0,{bearingDelta:O}},y.prototype.contextmenu=function(m){m.preventDefault()},y}(lr),ru=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype._correctButton=function(m,T){return T===0&&m.ctrlKey||T===2},y.prototype._move=function(m,T){var O=-.5*(T.y-m.y);if(O)return this._active=!0,{pitchDelta:O}},y.prototype.contextmenu=function(m){m.preventDefault()},y}(lr),gc=function(d){this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset()};gc.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new i.Point(0,0)},gc.prototype.touchstart=function(d,y,m){return this._calculateTransform(d,y,m)},gc.prototype.touchmove=function(d,y,m){if(this._active&&!(m.length<this._minTouches))return d.preventDefault(),this._calculateTransform(d,y,m)},gc.prototype.touchend=function(d,y,m){this._calculateTransform(d,y,m),this._active&&m.length<this._minTouches&&this.reset()},gc.prototype.touchcancel=function(){this.reset()},gc.prototype._calculateTransform=function(d,y,m){m.length>0&&(this._active=!0);var T=uf(m,y),O=new i.Point(0,0),U=new i.Point(0,0),j=0;for(var K in T){var it=T[K],pt=this._touches[K];pt&&(O._add(it),U._add(it.sub(pt)),j++,T[K]=it)}if(this._touches=T,!(j<this._minTouches)&&U.mag()){var Et=U.div(j);if(this._sum._add(Et),!(this._sum.mag()<this._clickTolerance))return{around:O.div(j),panDelta:Et}}},gc.prototype.enable=function(){this._enabled=!0},gc.prototype.disable=function(){this._enabled=!1,this.reset()},gc.prototype.isEnabled=function(){return this._enabled},gc.prototype.isActive=function(){return this._active};var Ia=function(){this.reset()};function Ah(d,y,m){for(var T=0;T<d.length;T++)if(d[T].identifier===m)return y[T]}function El(d,y){return Math.log(d/y)/Math.LN2}Ia.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ia.prototype._start=function(d){},Ia.prototype._move=function(d,y,m){return{}},Ia.prototype.touchstart=function(d,y,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([y[0],y[1]]))},Ia.prototype.touchmove=function(d,y,m){if(this._firstTwoTouches){d.preventDefault();var T=this._firstTwoTouches,O=T[1],U=Ah(m,y,T[0]),j=Ah(m,y,O);if(U&&j){var K=this._aroundCenter?null:U.add(j).div(2);return this._move([U,j],K,d)}}},Ia.prototype.touchend=function(d,y,m){if(this._firstTwoTouches){var T=this._firstTwoTouches,O=T[1],U=Ah(m,y,T[0]),j=Ah(m,y,O);U&&j||(this._active&&s.suppressClick(),this.reset())}},Ia.prototype.touchcancel=function(){this.reset()},Ia.prototype.enable=function(d){this._enabled=!0,this._aroundCenter=!!d&&d.around==="center"},Ia.prototype.disable=function(){this._enabled=!1,this.reset()},Ia.prototype.isEnabled=function(){return this._enabled},Ia.prototype.isActive=function(){return this._active};var os=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.reset=function(){d.prototype.reset.call(this),delete this._distance,delete this._startDistance},y.prototype._start=function(m){this._startDistance=this._distance=m[0].dist(m[1])},y.prototype._move=function(m,T){var O=this._distance;if(this._distance=m[0].dist(m[1]),this._active||!(Math.abs(El(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:El(this._distance,O),pinchAround:T}},y}(Ia);function Ml(d,y){return 180*d.angleWith(y)/Math.PI}var EA=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.reset=function(){d.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},y.prototype._start=function(m){this._startVector=this._vector=m[0].sub(m[1]),this._minDiameter=m[0].dist(m[1])},y.prototype._move=function(m,T){var O=this._vector;if(this._vector=m[0].sub(m[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ml(this._vector,O),pinchAround:T}},y.prototype._isBelowThreshold=function(m){this._minDiameter=Math.min(this._minDiameter,m.mag());var T=25/(Math.PI*this._minDiameter)*360,O=Ml(m,this._startVector);return Math.abs(O)<T},y}(Ia);function gh(d){return Math.abs(d.y)>Math.abs(d.x)}var MA=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.reset=function(){d.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},y.prototype._start=function(m){this._lastPoints=m,gh(m[0].sub(m[1]))&&(this._valid=!1)},y.prototype._move=function(m,T,O){var U=m[0].sub(this._lastPoints[0]),j=m[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(U,j,O.timeStamp),this._valid)return this._lastPoints=m,this._active=!0,{pitchDelta:(U.y+j.y)/2*-.5}},y.prototype.gestureBeginsVertically=function(m,T,O){if(this._valid!==void 0)return this._valid;var U=m.mag()>=2,j=T.mag()>=2;if(U||j){if(!U||!j)return this._firstMove===void 0&&(this._firstMove=O),O-this._firstMove<100&&void 0;var K=m.y>0==T.y>0;return gh(m)&&gh(T)&&K}},y}(Ia),SA={panStep:100,bearingStep:15,pitchStep:10},Lc=function(){var d=SA;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1};function _c(d){return d*(2-d)}Lc.prototype.blur=function(){this.reset()},Lc.prototype.reset=function(){this._active=!1},Lc.prototype.keydown=function(d){var y=this;if(!(d.altKey||d.ctrlKey||d.metaKey)){var m=0,T=0,O=0,U=0,j=0;switch(d.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:d.shiftKey?T=-1:(d.preventDefault(),U=-1);break;case 39:d.shiftKey?T=1:(d.preventDefault(),U=1);break;case 38:d.shiftKey?O=1:(d.preventDefault(),j=-1);break;case 40:d.shiftKey?O=-1:(d.preventDefault(),j=1);break;default:return}return this._rotationDisabled&&(T=0,O=0),{cameraAnimation:function(K){var it=K.getZoom();K.easeTo({duration:300,easeId:"keyboardHandler",easing:_c,zoom:m?Math.round(it)+m*(d.shiftKey?2:1):it,bearing:K.getBearing()+T*y._bearingStep,pitch:K.getPitch()+O*y._pitchStep,offset:[-U*y._panStep,-j*y._panStep],center:K.getCenter()},{originalEvent:d})}}}},Lc.prototype.enable=function(){this._enabled=!0},Lc.prototype.disable=function(){this._enabled=!1,this.reset()},Lc.prototype.isEnabled=function(){return this._enabled},Lc.prototype.isActive=function(){return this._active},Lc.prototype.disableRotation=function(){this._rotationDisabled=!0},Lc.prototype.enableRotation=function(){this._rotationDisabled=!1};var Un=function(d,y){this._map=d,this._el=d.getCanvasContainer(),this._handler=y,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,i.bindAll(["_onTimeout"],this)};Un.prototype.setZoomRate=function(d){this._defaultZoomRate=d},Un.prototype.setWheelZoomRate=function(d){this._wheelZoomRate=d},Un.prototype.isEnabled=function(){return!!this._enabled},Un.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Un.prototype.isZooming=function(){return!!this._zooming},Un.prototype.enable=function(d){this.isEnabled()||(this._enabled=!0,this._aroundCenter=d&&d.around==="center")},Un.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Un.prototype.wheel=function(d){if(this.isEnabled()){var y=d.deltaMode===i.window.WheelEvent.DOM_DELTA_LINE?40*d.deltaY:d.deltaY,m=i.browser.now(),T=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,y!==0&&y%4.000244140625==0?this._type="wheel":y!==0&&Math.abs(y)<4?this._type="trackpad":T>400?(this._type=null,this._lastValue=y,this._timeout=setTimeout(this._onTimeout,40,d)):this._type||(this._type=Math.abs(T*y)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,y+=this._lastValue)),d.shiftKey&&y&&(y/=4),this._type&&(this._lastWheelEvent=d,this._delta-=y,this._active||this._start(d)),d.preventDefault()}},Un.prototype._onTimeout=function(d){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},Un.prototype._start=function(d){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var y=s.mousePos(this._el,d);this._around=i.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(y)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Un.prototype.renderFrame=function(){var d=this;if(this._frameId&&(this._frameId=null,this.isActive())){var y=this._map.transform;if(this._delta!==0){var m=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,T=2/(1+Math.exp(-Math.abs(this._delta*m)));this._delta<0&&T!==0&&(T=1/T);var O=typeof this._targetZoom=="number"?y.zoomScale(this._targetZoom):y.scale;this._targetZoom=Math.min(y.maxZoom,Math.max(y.minZoom,y.scaleZoom(O*T))),this._type==="wheel"&&(this._startZoom=y.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var U,j=typeof this._targetZoom=="number"?this._targetZoom:y.zoom,K=this._startZoom,it=this._easing,pt=!1;if(this._type==="wheel"&&K&&it){var Et=Math.min((i.browser.now()-this._lastWheelEventTime)/200,1),Ct=it(Et);U=i.number(K,j,Ct),Et<1?this._frameId||(this._frameId=!0):pt=!0}else U=j,pt=!0;return this._active=!0,pt&&(this._active=!1,this._finishTimeout=setTimeout(function(){d._zooming=!1,d._handler._triggerRenderFrame(),delete d._targetZoom,delete d._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!pt,zoomDelta:U-y.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Un.prototype._smoothOutEasing=function(d){var y=i.ease;if(this._prevEase){var m=this._prevEase,T=(i.browser.now()-m.start)/m.duration,O=m.easing(T+.01)-m.easing(T),U=.27/Math.sqrt(O*O+1e-4)*.01,j=Math.sqrt(.0729-U*U);y=i.bezier(U,j,.25,1)}return this._prevEase={start:i.browser.now(),duration:d,easing:y},y},Un.prototype.blur=function(){this.reset()},Un.prototype.reset=function(){this._active=!1};var Sl=function(d,y){this._clickZoom=d,this._tapZoom=y};Sl.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Sl.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Sl.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Sl.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Oc=function(){this.reset()};Oc.prototype.reset=function(){this._active=!1},Oc.prototype.blur=function(){this.reset()},Oc.prototype.dblclick=function(d,y){return d.preventDefault(),{cameraAnimation:function(m){m.easeTo({duration:300,zoom:m.getZoom()+(d.shiftKey?-1:1),around:m.unproject(y)},{originalEvent:d})}}},Oc.prototype.enable=function(){this._enabled=!0},Oc.prototype.disable=function(){this._enabled=!1,this.reset()},Oc.prototype.isEnabled=function(){return this._enabled},Oc.prototype.isActive=function(){return this._active};var Us=function(){this._tap=new Ga({numTouches:1,numTaps:1}),this.reset()};Us.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Us.prototype.touchstart=function(d,y,m){this._swipePoint||(this._tapTime&&d.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=y[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(d,y,m))},Us.prototype.touchmove=function(d,y,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;var T=y[0],O=T.y-this._swipePoint.y;return this._swipePoint=T,d.preventDefault(),this._active=!0,{zoomDelta:O/128}}}else this._tap.touchmove(d,y,m)},Us.prototype.touchend=function(d,y,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(d,y,m)&&(this._tapTime=d.timeStamp)},Us.prototype.touchcancel=function(){this.reset()},Us.prototype.enable=function(){this._enabled=!0},Us.prototype.disable=function(){this._enabled=!1,this.reset()},Us.prototype.isEnabled=function(){return this._enabled},Us.prototype.isActive=function(){return this._active};var _h=function(d,y,m){this._el=d,this._mousePan=y,this._touchPan=m};_h.prototype.enable=function(d){this._inertiaOptions=d||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},_h.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},_h.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},_h.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Pu=function(d,y,m){this._pitchWithRotate=d.pitchWithRotate,this._mouseRotate=y,this._mousePitch=m};Pu.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Pu.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Pu.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Pu.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ol=function(d,y,m,T){this._el=d,this._touchZoom=y,this._touchRotate=m,this._tapDragZoom=T,this._rotationDisabled=!1,this._enabled=!0};ol.prototype.enable=function(d){this._touchZoom.enable(d),this._rotationDisabled||this._touchRotate.enable(d),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ol.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ol.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ol.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ol.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ol.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Es=function(d){return d.zoom||d.drag||d.pitch||d.rotate},_p=function(d){function y(){d.apply(this,arguments)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y}(i.Event);function Wr(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}var Or=function(d,y){this._map=d,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Js(d),this._bearingSnap=y.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(y),i.bindAll(["handleEvent","handleWindowEvent"],this);var m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[i.window.document,"mousemove",{capture:!0}],[i.window.document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[i.window,"blur",void 0]];for(var T=0,O=this._listeners;T<O.length;T+=1){var U=O[T],j=U[0];s.addEventListener(j,U[1],j===i.window.document?this.handleWindowEvent:this.handleEvent,U[2])}};Or.prototype.destroy=function(){for(var d=0,y=this._listeners;d<y.length;d+=1){var m=y[d],T=m[0];s.removeEventListener(T,m[1],T===i.window.document?this.handleWindowEvent:this.handleEvent,m[2])}},Or.prototype._addDefaultHandlers=function(d){var y=this._map,m=y.getCanvasContainer();this._add("mapEvent",new li(y,d));var T=y.boxZoom=new to(y,d);this._add("boxZoom",T);var O=new Xa,U=new Oc;y.doubleClickZoom=new Sl(U,O),this._add("tapZoom",O),this._add("clickZoom",U);var j=new Us;this._add("tapDragZoom",j);var K=y.touchPitch=new MA;this._add("touchPitch",K);var it=new mh(d),pt=new ru(d);y.dragRotate=new Pu(d,it,pt),this._add("mouseRotate",it,["mousePitch"]),this._add("mousePitch",pt,["mouseRotate"]);var Et=new Vd(d),Ct=new gc(d);y.dragPan=new _h(m,Et,Ct),this._add("mousePan",Et),this._add("touchPan",Ct,["touchZoom","touchRotate"]);var Pt=new EA,Vt=new os;y.touchZoomRotate=new ol(m,Vt,Pt,j),this._add("touchRotate",Pt,["touchPan","touchZoom"]),this._add("touchZoom",Vt,["touchPan","touchRotate"]);var Ft=y.scrollZoom=new Un(y,this);this._add("scrollZoom",Ft,["mousePan"]);var Yt=y.keyboard=new Lc;this._add("keyboard",Yt),this._add("blockableMapEvent",new _r(y));for(var Dt=0,Xt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Dt<Xt.length;Dt+=1){var te=Xt[Dt];d.interactive&&d[te]&&y[te].enable(d[te])}},Or.prototype._add=function(d,y,m){this._handlers.push({handlerName:d,handler:y,allowed:m}),this._handlersById[d]=y},Or.prototype.stop=function(d){if(!this._updatingCamera){for(var y=0,m=this._handlers;y<m.length;y+=1)m[y].handler.reset();this._inertia.clear(),this._fireEvents({},{},d),this._changes=[]}},Or.prototype.isActive=function(){for(var d=0,y=this._handlers;d<y.length;d+=1)if(y[d].handler.isActive())return!0;return!1},Or.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Or.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Or.prototype.isMoving=function(){return Boolean(Es(this._eventsInProgress))||this.isZooming()},Or.prototype._blockedByActive=function(d,y,m){for(var T in d)if(T!==m&&(!y||y.indexOf(T)<0))return!0;return!1},Or.prototype.handleWindowEvent=function(d){this.handleEvent(d,d.type+"Window")},Or.prototype._getMapTouches=function(d){for(var y=[],m=0,T=d;m<T.length;m+=1){var O=T[m];this._el.contains(O.target)&&y.push(O)}return y},Or.prototype.handleEvent=function(d,y){this._updatingCamera=!0;for(var m=d.type==="renderFrame"?void 0:d,T={needsRenderFrame:!1},O={},U={},j=d.touches?this._getMapTouches(d.touches):void 0,K=j?s.touchPos(this._el,j):s.mousePos(this._el,d),it=0,pt=this._handlers;it<pt.length;it+=1){var Et=pt[it],Ct=Et.handlerName,Pt=Et.handler,Vt=Et.allowed;if(Pt.isEnabled()){var Ft=void 0;this._blockedByActive(U,Vt,Ct)?Pt.reset():Pt[y||d.type]&&(Ft=Pt[y||d.type](d,K,j),this.mergeHandlerResult(T,O,Ft,Ct,m),Ft&&Ft.needsRenderFrame&&this._triggerRenderFrame()),(Ft||Pt.isActive())&&(U[Ct]=Pt)}}var Yt={};for(var Dt in this._previousActiveHandlers)U[Dt]||(Yt[Dt]=m);this._previousActiveHandlers=U,(Object.keys(Yt).length||Wr(T))&&(this._changes.push([T,O,Yt]),this._triggerRenderFrame()),(Object.keys(U).length||Wr(T))&&this._map._stop(!0),this._updatingCamera=!1;var Xt=T.cameraAnimation;Xt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Xt(this._map))},Or.prototype.mergeHandlerResult=function(d,y,m,T,O){if(m){i.extend(d,m);var U={handlerName:T,originalEvent:m.originalEvent||O};m.zoomDelta!==void 0&&(y.zoom=U),m.panDelta!==void 0&&(y.drag=U),m.pitchDelta!==void 0&&(y.pitch=U),m.bearingDelta!==void 0&&(y.rotate=U)}},Or.prototype._applyChanges=function(){for(var d={},y={},m={},T=0,O=this._changes;T<O.length;T+=1){var U=O[T],j=U[0],K=U[1],it=U[2];j.panDelta&&(d.panDelta=(d.panDelta||new i.Point(0,0))._add(j.panDelta)),j.zoomDelta&&(d.zoomDelta=(d.zoomDelta||0)+j.zoomDelta),j.bearingDelta&&(d.bearingDelta=(d.bearingDelta||0)+j.bearingDelta),j.pitchDelta&&(d.pitchDelta=(d.pitchDelta||0)+j.pitchDelta),j.around!==void 0&&(d.around=j.around),j.pinchAround!==void 0&&(d.pinchAround=j.pinchAround),j.noInertia&&(d.noInertia=j.noInertia),i.extend(y,K),i.extend(m,it)}this._updateMapTransform(d,y,m),this._changes=[]},Or.prototype._updateMapTransform=function(d,y,m){var T=this._map,O=T.transform;if(!Wr(d))return this._fireEvents(y,m,!0);var U=d.panDelta,j=d.zoomDelta,K=d.bearingDelta,it=d.pitchDelta,pt=d.around,Et=d.pinchAround;Et!==void 0&&(pt=Et),T._stop(!0),pt=pt||T.transform.centerPoint;var Ct=O.pointLocation(U?pt.sub(U):pt);K&&(O.bearing+=K),it&&(O.pitch+=it),j&&(O.zoom+=j),O.setLocationAtPoint(Ct,pt),this._map._update(),d.noInertia||this._inertia.record(d),this._fireEvents(y,m,!0)},Or.prototype._fireEvents=function(d,y,m){var T=this,O=Es(this._eventsInProgress),U=Es(d),j={};for(var K in d)this._eventsInProgress[K]||(j[K+"start"]=d[K].originalEvent),this._eventsInProgress[K]=d[K];for(var it in!O&&U&&this._fireEvent("movestart",U.originalEvent),j)this._fireEvent(it,j[it]);for(var pt in U&&this._fireEvent("move",U.originalEvent),d)this._fireEvent(pt,d[pt].originalEvent);var Et,Ct={};for(var Pt in this._eventsInProgress){var Vt=this._eventsInProgress[Pt],Ft=Vt.handlerName,Yt=Vt.originalEvent;this._handlersById[Ft].isActive()||(delete this._eventsInProgress[Pt],Ct[Pt+"end"]=Et=y[Ft]||Yt)}for(var Dt in Ct)this._fireEvent(Dt,Ct[Dt]);var Xt=Es(this._eventsInProgress);if(m&&(O||U)&&!Xt){this._updatingCamera=!0;var te=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),le=function(be){return be!==0&&-T._bearingSnap<be&&be<T._bearingSnap};te?(le(te.bearing||this._map.getBearing())&&(te.bearing=0),this._map.easeTo(te,{originalEvent:Et})):(this._map.fire(new i.Event("moveend",{originalEvent:Et})),le(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Or.prototype._fireEvent=function(d,y){this._map.fire(new i.Event(d,y?{originalEvent:y}:{}))},Or.prototype._requestFrame=function(){var d=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(y){delete d._frameId,d.handleEvent(new _p("renderFrame",{timeStamp:y})),d._applyChanges()})},Or.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Iu=function(d){function y(m,T){d.call(this),this._moving=!1,this._zooming=!1,this.transform=m,this._bearingSnap=T.bearingSnap,i.bindAll(["_renderFrameCallback"],this)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.getCenter=function(){return new i.LngLat(this.transform.center.lng,this.transform.center.lat)},y.prototype.setCenter=function(m,T){return this.jumpTo({center:m},T)},y.prototype.panBy=function(m,T,O){return m=i.Point.convert(m).mult(-1),this.panTo(this.transform.center,i.extend({offset:m},T),O)},y.prototype.panTo=function(m,T,O){return this.easeTo(i.extend({center:m},T),O)},y.prototype.getZoom=function(){return this.transform.zoom},y.prototype.setZoom=function(m,T){return this.jumpTo({zoom:m},T),this},y.prototype.zoomTo=function(m,T,O){return this.easeTo(i.extend({zoom:m},T),O)},y.prototype.zoomIn=function(m,T){return this.zoomTo(this.getZoom()+1,m,T),this},y.prototype.zoomOut=function(m,T){return this.zoomTo(this.getZoom()-1,m,T),this},y.prototype.getBearing=function(){return this.transform.bearing},y.prototype.setBearing=function(m,T){return this.jumpTo({bearing:m},T),this},y.prototype.getPadding=function(){return this.transform.padding},y.prototype.setPadding=function(m,T){return this.jumpTo({padding:m},T),this},y.prototype.rotateTo=function(m,T,O){return this.easeTo(i.extend({bearing:m},T),O)},y.prototype.resetNorth=function(m,T){return this.rotateTo(0,i.extend({duration:1e3},m),T),this},y.prototype.resetNorthPitch=function(m,T){return this.easeTo(i.extend({bearing:0,pitch:0,duration:1e3},m),T),this},y.prototype.snapToNorth=function(m,T){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(m,T):this},y.prototype.getPitch=function(){return this.transform.pitch},y.prototype.setPitch=function(m,T){return this.jumpTo({pitch:m},T),this},y.prototype.cameraForBounds=function(m,T){m=i.LngLatBounds.convert(m);var O=T&&T.bearing||0;return this._cameraForBoxAndBearing(m.getNorthWest(),m.getSouthEast(),O,T)},y.prototype._cameraForBoxAndBearing=function(m,T,O,U){var j={top:0,bottom:0,right:0,left:0};if(typeof(U=i.extend({padding:j,offset:[0,0],maxZoom:this.transform.maxZoom},U)).padding=="number"){var K=U.padding;U.padding={top:K,bottom:K,right:K,left:K}}U.padding=i.extend(j,U.padding);var it=this.transform,pt=it.padding,Et=it.project(i.LngLat.convert(m)),Ct=it.project(i.LngLat.convert(T)),Pt=Et.rotate(-O*Math.PI/180),Vt=Ct.rotate(-O*Math.PI/180),Ft=new i.Point(Math.max(Pt.x,Vt.x),Math.max(Pt.y,Vt.y)),Yt=new i.Point(Math.min(Pt.x,Vt.x),Math.min(Pt.y,Vt.y)),Dt=Ft.sub(Yt),Xt=(it.width-(pt.left+pt.right+U.padding.left+U.padding.right))/Dt.x,te=(it.height-(pt.top+pt.bottom+U.padding.top+U.padding.bottom))/Dt.y;if(!(te<0||Xt<0)){var le=Math.min(it.scaleZoom(it.scale*Math.min(Xt,te)),U.maxZoom),be=typeof U.offset.x=="number"?new i.Point(U.offset.x,U.offset.y):i.Point.convert(U.offset),Ae=new i.Point((U.padding.left-U.padding.right)/2,(U.padding.top-U.padding.bottom)/2).rotate(O*Math.PI/180),Me=be.add(Ae).mult(it.scale/it.zoomScale(le));return{center:it.unproject(Et.add(Ct).div(2).sub(Me)),zoom:le,bearing:O}}i.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},y.prototype.fitBounds=function(m,T,O){return this._fitInternal(this.cameraForBounds(m,T),T,O)},y.prototype.fitScreenCoordinates=function(m,T,O,U,j){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(i.Point.convert(m)),this.transform.pointLocation(i.Point.convert(T)),O,U),U,j)},y.prototype._fitInternal=function(m,T,O){return m?(delete(T=i.extend(m,T)).padding,T.linear?this.easeTo(T,O):this.flyTo(T,O)):this},y.prototype.jumpTo=function(m,T){this.stop();var O=this.transform,U=!1,j=!1,K=!1;return"zoom"in m&&O.zoom!==+m.zoom&&(U=!0,O.zoom=+m.zoom),m.center!==void 0&&(O.center=i.LngLat.convert(m.center)),"bearing"in m&&O.bearing!==+m.bearing&&(j=!0,O.bearing=+m.bearing),"pitch"in m&&O.pitch!==+m.pitch&&(K=!0,O.pitch=+m.pitch),m.padding==null||O.isPaddingEqual(m.padding)||(O.padding=m.padding),this.fire(new i.Event("movestart",T)).fire(new i.Event("move",T)),U&&this.fire(new i.Event("zoomstart",T)).fire(new i.Event("zoom",T)).fire(new i.Event("zoomend",T)),j&&this.fire(new i.Event("rotatestart",T)).fire(new i.Event("rotate",T)).fire(new i.Event("rotateend",T)),K&&this.fire(new i.Event("pitchstart",T)).fire(new i.Event("pitch",T)).fire(new i.Event("pitchend",T)),this.fire(new i.Event("moveend",T))},y.prototype.easeTo=function(m,T){var O=this;this._stop(!1,m.easeId),((m=i.extend({offset:[0,0],duration:500,easing:i.ease},m)).animate===!1||!m.essential&&i.browser.prefersReducedMotion)&&(m.duration=0);var U=this.transform,j=this.getZoom(),K=this.getBearing(),it=this.getPitch(),pt=this.getPadding(),Et="zoom"in m?+m.zoom:j,Ct="bearing"in m?this._normalizeBearing(m.bearing,K):K,Pt="pitch"in m?+m.pitch:it,Vt="padding"in m?m.padding:U.padding,Ft=i.Point.convert(m.offset),Yt=U.centerPoint.add(Ft),Dt=U.pointLocation(Yt),Xt=i.LngLat.convert(m.center||Dt);this._normalizeCenter(Xt);var te,le,be=U.project(Dt),Ae=U.project(Xt).sub(be),Me=U.zoomScale(Et-j);m.around&&(te=i.LngLat.convert(m.around),le=U.locationPoint(te));var Ve={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Et!==j,this._rotating=this._rotating||K!==Ct,this._pitching=this._pitching||Pt!==it,this._padding=!U.isPaddingEqual(Vt),this._easeId=m.easeId,this._prepareEase(T,m.noMoveStart,Ve),this._ease(function(Je){if(O._zooming&&(U.zoom=i.number(j,Et,Je)),O._rotating&&(U.bearing=i.number(K,Ct,Je)),O._pitching&&(U.pitch=i.number(it,Pt,Je)),O._padding&&(U.interpolatePadding(pt,Vt,Je),Yt=U.centerPoint.add(Ft)),te)U.setLocationAtPoint(te,le);else{var $e=U.zoomScale(U.zoom-j),wr=Et>j?Math.min(2,Me):Math.max(.5,Me),qr=Math.pow(wr,1-Je),$r=U.unproject(be.add(Ae.mult(Je*qr)).mult($e));U.setLocationAtPoint(U.renderWorldCopies?$r.wrap():$r,Yt)}O._fireMoveEvents(T)},function(Je){O._afterEase(T,Je)},m),this},y.prototype._prepareEase=function(m,T,O){O===void 0&&(O={}),this._moving=!0,T||O.moving||this.fire(new i.Event("movestart",m)),this._zooming&&!O.zooming&&this.fire(new i.Event("zoomstart",m)),this._rotating&&!O.rotating&&this.fire(new i.Event("rotatestart",m)),this._pitching&&!O.pitching&&this.fire(new i.Event("pitchstart",m))},y.prototype._fireMoveEvents=function(m){this.fire(new i.Event("move",m)),this._zooming&&this.fire(new i.Event("zoom",m)),this._rotating&&this.fire(new i.Event("rotate",m)),this._pitching&&this.fire(new i.Event("pitch",m))},y.prototype._afterEase=function(m,T){if(!this._easeId||!T||this._easeId!==T){delete this._easeId;var O=this._zooming,U=this._rotating,j=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,O&&this.fire(new i.Event("zoomend",m)),U&&this.fire(new i.Event("rotateend",m)),j&&this.fire(new i.Event("pitchend",m)),this.fire(new i.Event("moveend",m))}},y.prototype.flyTo=function(m,T){var O=this;if(!m.essential&&i.browser.prefersReducedMotion){var U=i.pick(m,["center","zoom","bearing","pitch","around"]);return this.jumpTo(U,T)}this.stop(),m=i.extend({offset:[0,0],speed:1.2,curve:1.42,easing:i.ease},m);var j=this.transform,K=this.getZoom(),it=this.getBearing(),pt=this.getPitch(),Et=this.getPadding(),Ct="zoom"in m?i.clamp(+m.zoom,j.minZoom,j.maxZoom):K,Pt="bearing"in m?this._normalizeBearing(m.bearing,it):it,Vt="pitch"in m?+m.pitch:pt,Ft="padding"in m?m.padding:j.padding,Yt=j.zoomScale(Ct-K),Dt=i.Point.convert(m.offset),Xt=j.centerPoint.add(Dt),te=j.pointLocation(Xt),le=i.LngLat.convert(m.center||te);this._normalizeCenter(le);var be=j.project(te),Ae=j.project(le).sub(be),Me=m.curve,Ve=Math.max(j.width,j.height),Je=Ve/Yt,$e=Ae.mag();if("minZoom"in m){var wr=i.clamp(Math.min(m.minZoom,K,Ct),j.minZoom,j.maxZoom),qr=Ve/j.zoomScale(wr-K);Me=Math.sqrt(qr/$e*2)}var $r=Me*Me;function Kr(an){var en=(Je*Je-Ve*Ve+(an?-1:1)*$r*$r*$e*$e)/(2*(an?Je:Ve)*$r*$e);return Math.log(Math.sqrt(en*en+1)-en)}function ei(an){return(Math.exp(an)-Math.exp(-an))/2}function Sr(an){return(Math.exp(an)+Math.exp(-an))/2}var mn=Kr(0),An=function(an){return Sr(mn)/Sr(mn+Me*an)},cn=function(an){return Ve*((Sr(mn)*(ei(en=mn+Me*an)/Sr(en))-ei(mn))/$r)/$e;var en},ln=(Kr(1)-mn)/Me;if(Math.abs($e)<1e-6||!isFinite(ln)){if(Math.abs(Ve-Je)<1e-6)return this.easeTo(m,T);var Tn=Je<Ve?-1:1;ln=Math.abs(Math.log(Je/Ve))/Me,cn=function(){return 0},An=function(an){return Math.exp(Tn*Me*an)}}return m.duration="duration"in m?+m.duration:1e3*ln/("screenSpeed"in m?+m.screenSpeed/Me:+m.speed),m.maxDuration&&m.duration>m.maxDuration&&(m.duration=0),this._zooming=!0,this._rotating=it!==Pt,this._pitching=Vt!==pt,this._padding=!j.isPaddingEqual(Ft),this._prepareEase(T,!1),this._ease(function(an){var en=an*ln,gs=1/An(en);j.zoom=an===1?Ct:K+j.scaleZoom(gs),O._rotating&&(j.bearing=i.number(it,Pt,an)),O._pitching&&(j.pitch=i.number(pt,Vt,an)),O._padding&&(j.interpolatePadding(Et,Ft,an),Xt=j.centerPoint.add(Dt));var Fi=an===1?le:j.unproject(be.add(Ae.mult(cn(en))).mult(gs));j.setLocationAtPoint(j.renderWorldCopies?Fi.wrap():Fi,Xt),O._fireMoveEvents(T)},function(){return O._afterEase(T)},m),this},y.prototype.isEasing=function(){return!!this._easeFrameId},y.prototype.stop=function(){return this._stop()},y.prototype._stop=function(m,T){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var O=this._onEaseEnd;delete this._onEaseEnd,O.call(this,T)}if(!m){var U=this.handlers;U&&U.stop(!1)}return this},y.prototype._ease=function(m,T,O){O.animate===!1||O.duration===0?(m(1),T()):(this._easeStart=i.browser.now(),this._easeOptions=O,this._onEaseFrame=m,this._onEaseEnd=T,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},y.prototype._renderFrameCallback=function(){var m=Math.min((i.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(m)),m<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},y.prototype._normalizeBearing=function(m,T){m=i.wrap(m,-180,180);var O=Math.abs(m-T);return Math.abs(m-360-T)<O&&(m-=360),Math.abs(m+360-T)<O&&(m+=360),m},y.prototype._normalizeCenter=function(m){var T=this.transform;if(T.renderWorldCopies&&!T.lngRange){var O=m.lng-T.center.lng;m.lng+=O>180?-360:O<-180?360:0}},y}(i.Evented),Aa=function(d){d===void 0&&(d={}),this.options=d,i.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Aa.prototype.getDefaultPosition=function(){return"bottom-right"},Aa.prototype.onAdd=function(d){var y=this.options&&this.options.compact;return this._map=d,this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=s.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=s.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),y&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),y===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Aa.prototype.onRemove=function(){s.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Aa.prototype._setElementTitle=function(d,y){var m=this._map._getUIString("AttributionControl."+y);d.title=m,d.setAttribute("aria-label",m)},Aa.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Aa.prototype._updateEditLink=function(){var d=this._editLink;d||(d=this._editLink=this._container.querySelector(".mapbox-improve-map"));var y=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.config.ACCESS_TOKEN}];if(d){var m=y.reduce(function(T,O,U){return O.value&&(T+=O.key+"="+O.value+(U<y.length-1?"&":"")),T},"?");d.href=i.config.FEEDBACK_URL+"/"+m+(this._map._hash?this._map._hash.getHashString(!0):""),d.rel="noopener nofollow",this._setElementTitle(d,"MapFeedback")}},Aa.prototype._updateData=function(d){!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Aa.prototype._updateAttributions=function(){if(this._map.style){var d=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?d=d.concat(this.options.customAttribution.map(function(K){return typeof K!="string"?"":K})):typeof this.options.customAttribution=="string"&&d.push(this.options.customAttribution)),this._map.style.stylesheet){var y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}var m=this._map.style.sourceCaches;for(var T in m){var O=m[T];if(O.used){var U=O.getSource();U.attribution&&d.indexOf(U.attribution)<0&&d.push(U.attribution)}}d.sort(function(K,it){return K.length-it.length});var j=(d=d.filter(function(K,it){for(var pt=it+1;pt<d.length;pt++)if(d[pt].indexOf(K)>=0)return!1;return!0})).join(" | ");j!==this._attribHTML&&(this._attribHTML=j,d.length?(this._innerContainer.innerHTML=j,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Aa.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var yc=function(){i.bindAll(["_updateLogo"],this),i.bindAll(["_updateCompact"],this)};yc.prototype.onAdd=function(d){this._map=d,this._container=s.create("div","mapboxgl-ctrl");var y=s.create("a","mapboxgl-ctrl-logo");return y.target="_blank",y.rel="noopener nofollow",y.href="https://www.mapbox.com/",y.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),y.setAttribute("rel","noopener nofollow"),this._container.appendChild(y),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},yc.prototype.onRemove=function(){s.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},yc.prototype.getDefaultPosition=function(){return"bottom-left"},yc.prototype._updateLogo=function(d){d&&d.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},yc.prototype._logoRequired=function(){if(this._map.style){var d=this._map.style.sourceCaches;for(var y in d)if(d[y].getSource().mapbox_logo)return!0;return!1}},yc.prototype._updateCompact=function(){var d=this._container.children;if(d.length){var y=d[0];this._map.getCanvasContainer().offsetWidth<250?y.classList.add("mapboxgl-compact"):y.classList.remove("mapboxgl-compact")}};var Ms=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Ms.prototype.add=function(d){var y=++this._id;return this._queue.push({callback:d,id:y,cancelled:!1}),y},Ms.prototype.remove=function(d){for(var y=this._currentlyRunning,m=0,T=y?this._queue.concat(y):this._queue;m<T.length;m+=1){var O=T[m];if(O.id===d)return void(O.cancelled=!0)}},Ms.prototype.run=function(d){d===void 0&&(d=0);var y=this._currentlyRunning=this._queue;this._queue=[];for(var m=0,T=y;m<T.length;m+=1){var O=T[m];if(!O.cancelled&&(O.callback(d),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Ms.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ra={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},CA=i.window.HTMLImageElement,hf=i.window.HTMLElement,vi=i.window.ImageBitmap,Ss={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},PA=function(d){function y(T){var O=this;if((T=i.extend({},Ss,T)).minZoom!=null&&T.maxZoom!=null&&T.minZoom>T.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(T.minPitch!=null&&T.maxPitch!=null&&T.minPitch>T.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(T.minPitch!=null&&T.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(T.maxPitch!=null&&T.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var U=new dr(T.minZoom,T.maxZoom,T.minPitch,T.maxPitch,T.renderWorldCopies);if(d.call(this,U,T),this._interactive=T.interactive,this._maxTileCacheSize=T.maxTileCacheSize,this._failIfMajorPerformanceCaveat=T.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=T.preserveDrawingBuffer,this._antialias=T.antialias,this._trackResize=T.trackResize,this._bearingSnap=T.bearingSnap,this._refreshExpiredTiles=T.refreshExpiredTiles,this._fadeDuration=T.fadeDuration,this._crossSourceCollisions=T.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=T.collectResourceTiming,this._renderTaskQueue=new Ms,this._controls=[],this._mapId=i.uniqueId(),this._locale=i.extend({},Ra,T.locale),this._clickTolerance=T.clickTolerance,this._requestManager=new i.RequestManager(T.transformRequest,T.accessToken),typeof T.container=="string"){if(this._container=i.window.document.getElementById(T.container),!this._container)throw new Error("Container '"+T.container+"' not found.")}else{if(!(T.container instanceof hf))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=T.container}if(T.maxBounds&&this.setMaxBounds(T.maxBounds),i.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return O._update(!1)}),this.on("moveend",function(){return O._update(!1)}),this.on("zoom",function(){return O._update(!0)}),i.window!==void 0&&(i.window.addEventListener("online",this._onWindowOnline,!1),i.window.addEventListener("resize",this._onWindowResize,!1),i.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Or(this,T),this._hash=T.hash&&new xn(typeof T.hash=="string"&&T.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:T.center,zoom:T.zoom,bearing:T.bearing,pitch:T.pitch}),T.bounds&&(this.resize(),this.fitBounds(T.bounds,i.extend({},T.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=T.localIdeographFontFamily,T.style&&this.setStyle(T.style,{localIdeographFontFamily:T.localIdeographFontFamily}),T.attributionControl&&this.addControl(new Aa({customAttribution:T.customAttribution})),this.addControl(new yc,T.logoPosition),this.on("style.load",function(){O.transform.unmodified&&O.jumpTo(O.style.stylesheet)}),this.on("data",function(j){O._update(j.dataType==="style"),O.fire(new i.Event(j.dataType+"data",j))}),this.on("dataloading",function(j){O.fire(new i.Event(j.dataType+"dataloading",j))})}d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y;var m={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return y.prototype._getMapId=function(){return this._mapId},y.prototype.addControl=function(T,O){if(O===void 0&&(O=T.getDefaultPosition?T.getDefaultPosition():"top-right"),!T||!T.onAdd)return this.fire(new i.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var U=T.onAdd(this);this._controls.push(T);var j=this._controlPositions[O];return O.indexOf("bottom")!==-1?j.insertBefore(U,j.firstChild):j.appendChild(U),this},y.prototype.removeControl=function(T){if(!T||!T.onRemove)return this.fire(new i.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var O=this._controls.indexOf(T);return O>-1&&this._controls.splice(O,1),T.onRemove(this),this},y.prototype.hasControl=function(T){return this._controls.indexOf(T)>-1},y.prototype.resize=function(T){var O=this._containerDimensions(),U=O[0],j=O[1];if(U===this.transform.width&&j===this.transform.height)return this;this._resizeCanvas(U,j),this.transform.resize(U,j),this.painter.resize(U,j);var K=!this._moving;return K&&this.fire(new i.Event("movestart",T)).fire(new i.Event("move",T)),this.fire(new i.Event("resize",T)),K&&this.fire(new i.Event("moveend",T)),this},y.prototype.getBounds=function(){return this.transform.getBounds()},y.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},y.prototype.setMaxBounds=function(T){return this.transform.setMaxBounds(i.LngLatBounds.convert(T)),this._update()},y.prototype.setMinZoom=function(T){if((T=T??-2)>=-2&&T<=this.transform.maxZoom)return this.transform.minZoom=T,this._update(),this.getZoom()<T&&this.setZoom(T),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},y.prototype.getMinZoom=function(){return this.transform.minZoom},y.prototype.setMaxZoom=function(T){if((T=T??22)>=this.transform.minZoom)return this.transform.maxZoom=T,this._update(),this.getZoom()>T&&this.setZoom(T),this;throw new Error("maxZoom must be greater than the current minZoom")},y.prototype.getMaxZoom=function(){return this.transform.maxZoom},y.prototype.setMinPitch=function(T){if((T=T??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(T>=0&&T<=this.transform.maxPitch)return this.transform.minPitch=T,this._update(),this.getPitch()<T&&this.setPitch(T),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},y.prototype.getMinPitch=function(){return this.transform.minPitch},y.prototype.setMaxPitch=function(T){if((T=T??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(T>=this.transform.minPitch)return this.transform.maxPitch=T,this._update(),this.getPitch()>T&&this.setPitch(T),this;throw new Error("maxPitch must be greater than the current minPitch")},y.prototype.getMaxPitch=function(){return this.transform.maxPitch},y.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},y.prototype.setRenderWorldCopies=function(T){return this.transform.renderWorldCopies=T,this._update()},y.prototype.project=function(T){return this.transform.locationPoint(i.LngLat.convert(T))},y.prototype.unproject=function(T){return this.transform.pointLocation(i.Point.convert(T))},y.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},y.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},y.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},y.prototype._createDelegatedListener=function(T,O,U){var j,K=this;if(T==="mouseenter"||T==="mouseover"){var it=!1;return{layer:O,listener:U,delegates:{mousemove:function(Et){var Ct=K.getLayer(O)?K.queryRenderedFeatures(Et.point,{layers:[O]}):[];Ct.length?it||(it=!0,U.call(K,new is(T,K,Et.originalEvent,{features:Ct}))):it=!1},mouseout:function(){it=!1}}}}if(T==="mouseleave"||T==="mouseout"){var pt=!1;return{layer:O,listener:U,delegates:{mousemove:function(Et){(K.getLayer(O)?K.queryRenderedFeatures(Et.point,{layers:[O]}):[]).length?pt=!0:pt&&(pt=!1,U.call(K,new is(T,K,Et.originalEvent)))},mouseout:function(Et){pt&&(pt=!1,U.call(K,new is(T,K,Et.originalEvent)))}}}}return{layer:O,listener:U,delegates:(j={},j[T]=function(Et){var Ct=K.getLayer(O)?K.queryRenderedFeatures(Et.point,{layers:[O]}):[];Ct.length&&(Et.features=Ct,U.call(K,Et),delete Et.features)},j)}},y.prototype.on=function(T,O,U){if(U===void 0)return d.prototype.on.call(this,T,O);var j=this._createDelegatedListener(T,O,U);for(var K in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[T]=this._delegatedListeners[T]||[],this._delegatedListeners[T].push(j),j.delegates)this.on(K,j.delegates[K]);return this},y.prototype.once=function(T,O,U){if(U===void 0)return d.prototype.once.call(this,T,O);var j=this._createDelegatedListener(T,O,U);for(var K in j.delegates)this.once(K,j.delegates[K]);return this},y.prototype.off=function(T,O,U){var j=this;return U===void 0?d.prototype.off.call(this,T,O):(this._delegatedListeners&&this._delegatedListeners[T]&&function(K){for(var it=K[T],pt=0;pt<it.length;pt++){var Et=it[pt];if(Et.layer===O&&Et.listener===U){for(var Ct in Et.delegates)j.off(Ct,Et.delegates[Ct]);return it.splice(pt,1),j}}}(this._delegatedListeners),this)},y.prototype.queryRenderedFeatures=function(T,O){if(!this.style)return[];var U;if(O!==void 0||T===void 0||T instanceof i.Point||Array.isArray(T)||(O=T,T=void 0),O=O||{},(T=T||[[0,0],[this.transform.width,this.transform.height]])instanceof i.Point||typeof T[0]=="number")U=[i.Point.convert(T)];else{var j=i.Point.convert(T[0]),K=i.Point.convert(T[1]);U=[j,new i.Point(K.x,j.y),K,new i.Point(j.x,K.y),j]}return this.style.queryRenderedFeatures(U,O,this.transform)},y.prototype.querySourceFeatures=function(T,O){return this.style.querySourceFeatures(T,O)},y.prototype.setStyle=function(T,O){return(O=i.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},O)).diff!==!1&&O.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&T?(this._diffStyle(T,O),this):(this._localIdeographFontFamily=O.localIdeographFontFamily,this._updateStyle(T,O))},y.prototype._getUIString=function(T){var O=this._locale[T];if(O==null)throw new Error("Missing UI string '"+T+"'");return O},y.prototype._updateStyle=function(T,O){return this.style&&(this.style.setEventedParent(null),this.style._remove()),T?(this.style=new da(this,O||{}),this.style.setEventedParent(this,{style:this.style}),typeof T=="string"?this.style.loadURL(T):this.style.loadJSON(T),this):(delete this.style,this)},y.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new da(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},y.prototype._diffStyle=function(T,O){var U=this;if(typeof T=="string"){var j=this._requestManager.normalizeStyleURL(T),K=this._requestManager.transformRequest(j,i.ResourceType.Style);i.getJSON(K,function(it,pt){it?U.fire(new i.ErrorEvent(it)):pt&&U._updateDiff(pt,O)})}else typeof T=="object"&&this._updateDiff(T,O)},y.prototype._updateDiff=function(T,O){try{this.style.setState(T)&&this._update(!0)}catch(U){i.warnOnce("Unable to perform style diff: "+(U.message||U.error||U)+".  Rebuilding the style from scratch."),this._updateStyle(T,O)}},y.prototype.getStyle=function(){if(this.style)return this.style.serialize()},y.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():i.warnOnce("There is no style added to the map.")},y.prototype.addSource=function(T,O){return this._lazyInitEmptyStyle(),this.style.addSource(T,O),this._update(!0)},y.prototype.isSourceLoaded=function(T){var O=this.style&&this.style.sourceCaches[T];if(O!==void 0)return O.loaded();this.fire(new i.ErrorEvent(new Error("There is no source with ID '"+T+"'")))},y.prototype.areTilesLoaded=function(){var T=this.style&&this.style.sourceCaches;for(var O in T){var U=T[O]._tiles;for(var j in U){var K=U[j];if(K.state!=="loaded"&&K.state!=="errored")return!1}}return!0},y.prototype.addSourceType=function(T,O,U){return this._lazyInitEmptyStyle(),this.style.addSourceType(T,O,U)},y.prototype.removeSource=function(T){return this.style.removeSource(T),this._update(!0)},y.prototype.getSource=function(T){return this.style.getSource(T)},y.prototype.addImage=function(T,O,U){U===void 0&&(U={});var j=U.pixelRatio;j===void 0&&(j=1);var K=U.sdf;K===void 0&&(K=!1);var it=U.stretchX,pt=U.stretchY,Et=U.content;if(this._lazyInitEmptyStyle(),O instanceof CA||vi&&O instanceof vi){var Ct=i.browser.getImageData(O);this.style.addImage(T,{data:new i.RGBAImage({width:Ct.width,height:Ct.height},Ct.data),pixelRatio:j,stretchX:it,stretchY:pt,content:Et,sdf:K,version:0})}else{if(O.width===void 0||O.height===void 0)return this.fire(new i.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Pt=O;this.style.addImage(T,{data:new i.RGBAImage({width:O.width,height:O.height},new Uint8Array(O.data)),pixelRatio:j,stretchX:it,stretchY:pt,content:Et,sdf:K,version:0,userImage:Pt}),Pt.onAdd&&Pt.onAdd(this,T)}},y.prototype.updateImage=function(T,O){var U=this.style.getImage(T);if(!U)return this.fire(new i.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var j=O instanceof CA||vi&&O instanceof vi?i.browser.getImageData(O):O,K=j.width,it=j.height,pt=j.data;return K===void 0||it===void 0?this.fire(new i.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):K!==U.data.width||it!==U.data.height?this.fire(new i.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(U.data.replace(pt,!(O instanceof CA||vi&&O instanceof vi)),void this.style.updateImage(T,U))},y.prototype.hasImage=function(T){return T?!!this.style.getImage(T):(this.fire(new i.ErrorEvent(new Error("Missing required image id"))),!1)},y.prototype.removeImage=function(T){this.style.removeImage(T)},y.prototype.loadImage=function(T,O){i.getImage(this._requestManager.transformRequest(T,i.ResourceType.Image),O)},y.prototype.listImages=function(){return this.style.listImages()},y.prototype.addLayer=function(T,O){return this._lazyInitEmptyStyle(),this.style.addLayer(T,O),this._update(!0)},y.prototype.moveLayer=function(T,O){return this.style.moveLayer(T,O),this._update(!0)},y.prototype.removeLayer=function(T){return this.style.removeLayer(T),this._update(!0)},y.prototype.getLayer=function(T){return this.style.getLayer(T)},y.prototype.setLayerZoomRange=function(T,O,U){return this.style.setLayerZoomRange(T,O,U),this._update(!0)},y.prototype.setFilter=function(T,O,U){return U===void 0&&(U={}),this.style.setFilter(T,O,U),this._update(!0)},y.prototype.getFilter=function(T){return this.style.getFilter(T)},y.prototype.setPaintProperty=function(T,O,U,j){return j===void 0&&(j={}),this.style.setPaintProperty(T,O,U,j),this._update(!0)},y.prototype.getPaintProperty=function(T,O){return this.style.getPaintProperty(T,O)},y.prototype.setLayoutProperty=function(T,O,U,j){return j===void 0&&(j={}),this.style.setLayoutProperty(T,O,U,j),this._update(!0)},y.prototype.getLayoutProperty=function(T,O){return this.style.getLayoutProperty(T,O)},y.prototype.setLight=function(T,O){return O===void 0&&(O={}),this._lazyInitEmptyStyle(),this.style.setLight(T,O),this._update(!0)},y.prototype.getLight=function(){return this.style.getLight()},y.prototype.setFeatureState=function(T,O){return this.style.setFeatureState(T,O),this._update()},y.prototype.removeFeatureState=function(T,O){return this.style.removeFeatureState(T,O),this._update()},y.prototype.getFeatureState=function(T){return this.style.getFeatureState(T)},y.prototype.getContainer=function(){return this._container},y.prototype.getCanvasContainer=function(){return this._canvasContainer},y.prototype.getCanvas=function(){return this._canvas},y.prototype._containerDimensions=function(){var T=0,O=0;return this._container&&(T=this._container.clientWidth||400,O=this._container.clientHeight||300),[T,O]},y.prototype._detectMissingCSS=function(){i.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},y.prototype._setupContainer=function(){var T=this._container;T.classList.add("mapboxgl-map"),(this._missingCSSCanary=s.create("div","mapboxgl-canary",T)).style.visibility="hidden",this._detectMissingCSS();var O=this._canvasContainer=s.create("div","mapboxgl-canvas-container",T);this._interactive&&O.classList.add("mapboxgl-interactive"),this._canvas=s.create("canvas","mapboxgl-canvas",O),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var U=this._containerDimensions();this._resizeCanvas(U[0],U[1]);var j=this._controlContainer=s.create("div","mapboxgl-control-container",T),K=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(it){K[it]=s.create("div","mapboxgl-ctrl-"+it,j)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},y.prototype._resizeCanvas=function(T,O){var U=i.browser.devicePixelRatio||1;this._canvas.width=U*T,this._canvas.height=U*O,this._canvas.style.width=T+"px",this._canvas.style.height=O+"px"},y.prototype._setupPainter=function(){var T=i.extend({},o.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),O=this._canvas.getContext("webgl",T)||this._canvas.getContext("experimental-webgl",T);O?(this.painter=new nr(O,this.transform),i.webpSupported.testSupport(O)):this.fire(new i.ErrorEvent(new Error("Failed to initialize WebGL")))},y.prototype._contextLost=function(T){T.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.Event("webglcontextlost",{originalEvent:T}))},y.prototype._contextRestored=function(T){this._setupPainter(),this.resize(),this._update(),this.fire(new i.Event("webglcontextrestored",{originalEvent:T}))},y.prototype._onMapScroll=function(T){if(T.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},y.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},y.prototype._update=function(T){return this.style?(this._styleDirty=this._styleDirty||T,this._sourcesDirty=!0,this.triggerRepaint(),this):this},y.prototype._requestRenderFrame=function(T){return this._update(),this._renderTaskQueue.add(T)},y.prototype._cancelRenderFrame=function(T){this._renderTaskQueue.remove(T)},y.prototype._render=function(T){var O,U=this,j=0,K=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(O=K.createQueryEXT(),K.beginQueryEXT(K.TIME_ELAPSED_EXT,O),j=i.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(T),!this._removed){var it=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var pt=this.transform.zoom,Et=i.browser.now();this.style.zoomHistory.update(pt,Et);var Ct=new i.EvaluationParameters(pt,{now:Et,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Pt=Ct.crossFadingFactor();Pt===1&&Pt===this._crossFadingFactor||(it=!0,this._crossFadingFactor=Pt),this.style.update(Ct)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new i.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new i.Event("load"))),this.style&&(this.style.hasTransitions()||it)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Vt=i.browser.now()-j;K.endQueryEXT(K.TIME_ELAPSED_EXT,O),setTimeout(function(){var Dt=K.getQueryObjectEXT(O,K.QUERY_RESULT_EXT)/1e6;K.deleteQueryEXT(O),U.fire(new i.Event("gpu-timing-frame",{cpuTime:Vt,gpuTime:Dt}))},50)}if(this.listens("gpu-timing-layer")){var Ft=this.painter.collectGpuTimers();setTimeout(function(){var Dt=U.painter.queryGpuTimers(Ft);U.fire(new i.Event("gpu-timing-layer",{layerTimes:Dt}))},50)}var Yt=this._sourcesDirty||this._styleDirty||this._placementDirty;return Yt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new i.Event("idle")),!this._loaded||this._fullyLoaded||Yt||(this._fullyLoaded=!0),this}},y.prototype.remove=function(){this._hash&&this._hash.remove();for(var T=0,O=this._controls;T<O.length;T+=1)O[T].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),i.window!==void 0&&(i.window.removeEventListener("resize",this._onWindowResize,!1),i.window.removeEventListener("orientationchange",this._onWindowResize,!1),i.window.removeEventListener("online",this._onWindowOnline,!1));var U=this.painter.context.gl.getExtension("WEBGL_lose_context");U&&U.loseContext(),nu(this._canvasContainer),nu(this._controlContainer),nu(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new i.Event("remove"))},y.prototype.triggerRepaint=function(){var T=this;this.style&&!this._frame&&(this._frame=i.browser.frame(function(O){T._frame=null,T._render(O)}))},y.prototype._onWindowOnline=function(){this._update()},y.prototype._onWindowResize=function(T){this._trackResize&&this.resize({originalEvent:T})._update()},m.showTileBoundaries.get=function(){return!!this._showTileBoundaries},m.showTileBoundaries.set=function(T){this._showTileBoundaries!==T&&(this._showTileBoundaries=T,this._update())},m.showPadding.get=function(){return!!this._showPadding},m.showPadding.set=function(T){this._showPadding!==T&&(this._showPadding=T,this._update())},m.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},m.showCollisionBoxes.set=function(T){this._showCollisionBoxes!==T&&(this._showCollisionBoxes=T,T?this.style._generateCollisionBoxes():this._update())},m.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},m.showOverdrawInspector.set=function(T){this._showOverdrawInspector!==T&&(this._showOverdrawInspector=T,this._update())},m.repaint.get=function(){return!!this._repaint},m.repaint.set=function(T){this._repaint!==T&&(this._repaint=T,this.triggerRepaint())},m.vertices.get=function(){return!!this._vertices},m.vertices.set=function(T){this._vertices=T,this._update()},y.prototype._setCacheLimits=function(T,O){i.setCacheLimits(T,O)},m.version.get=function(){return i.version},Object.defineProperties(y.prototype,m),y}(Iu);function nu(d){d.parentNode&&d.parentNode.removeChild(d)}var yp={showCompass:!0,showZoom:!0,visualizePitch:!1},Bc=function(d){var y=this;this.options=i.extend({},yp,d),this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(m){return m.preventDefault()}),this.options.showZoom&&(i.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(m){return y._map.zoomIn({},{originalEvent:m})}),s.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(m){return y._map.zoomOut({},{originalEvent:m})}),s.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(i.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(m){y.options.visualizePitch?y._map.resetNorthPitch({},{originalEvent:m}):y._map.resetNorth({},{originalEvent:m})}),this._compassIcon=s.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Bc.prototype._updateZoomButtons=function(){var d=this._map.getZoom(),y=d===this._map.getMaxZoom(),m=d===this._map.getMinZoom();this._zoomInButton.disabled=y,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",y.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())},Bc.prototype._rotateCompassArrow=function(){var d=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=d},Bc.prototype.onAdd=function(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ii(this._map,this._compass,this.options.visualizePitch)),this._container},Bc.prototype.onRemove=function(){s.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Bc.prototype._createButton=function(d,y){var m=s.create("button",d,this._container);return m.type="button",m.addEventListener("click",y),m},Bc.prototype._setButtonTitle=function(d,y){var m=this._map._getUIString("NavigationControl."+y);d.title=m,d.setAttribute("aria-label",m)};var ii=function(d,y,m){m===void 0&&(m=!1),this._clickTolerance=10,this.element=y,this.mouseRotate=new mh({clickTolerance:d.dragRotate._mouseRotate._clickTolerance}),this.map=d,m&&(this.mousePitch=new ru({clickTolerance:d.dragRotate._mousePitch._clickTolerance})),i.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),s.addEventListener(y,"mousedown",this.mousedown),s.addEventListener(y,"touchstart",this.touchstart,{passive:!1}),s.addEventListener(y,"touchmove",this.touchmove),s.addEventListener(y,"touchend",this.touchend),s.addEventListener(y,"touchcancel",this.reset)};function ff(d,y,m){if(d=new i.LngLat(d.lng,d.lat),y){var T=new i.LngLat(d.lng-360,d.lat),O=new i.LngLat(d.lng+360,d.lat),U=m.locationPoint(d).distSqr(y);m.locationPoint(T).distSqr(y)<U?d=T:m.locationPoint(O).distSqr(y)<U&&(d=O)}for(;Math.abs(d.lng-m.center.lng)>180;){var j=m.locationPoint(d);if(j.x>=0&&j.y>=0&&j.x<=m.width&&j.y<=m.height)break;d.lng>m.center.lng?d.lng-=360:d.lng+=360}return d}ii.prototype.down=function(d,y){this.mouseRotate.mousedown(d,y),this.mousePitch&&this.mousePitch.mousedown(d,y),s.disableDrag()},ii.prototype.move=function(d,y){var m=this.map,T=this.mouseRotate.mousemoveWindow(d,y);if(T&&T.bearingDelta&&m.setBearing(m.getBearing()+T.bearingDelta),this.mousePitch){var O=this.mousePitch.mousemoveWindow(d,y);O&&O.pitchDelta&&m.setPitch(m.getPitch()+O.pitchDelta)}},ii.prototype.off=function(){var d=this.element;s.removeEventListener(d,"mousedown",this.mousedown),s.removeEventListener(d,"touchstart",this.touchstart,{passive:!1}),s.removeEventListener(d,"touchmove",this.touchmove),s.removeEventListener(d,"touchend",this.touchend),s.removeEventListener(d,"touchcancel",this.reset),this.offTemp()},ii.prototype.offTemp=function(){s.enableDrag(),s.removeEventListener(i.window,"mousemove",this.mousemove),s.removeEventListener(i.window,"mouseup",this.mouseup)},ii.prototype.mousedown=function(d){this.down(i.extend({},d,{ctrlKey:!0,preventDefault:function(){return d.preventDefault()}}),s.mousePos(this.element,d)),s.addEventListener(i.window,"mousemove",this.mousemove),s.addEventListener(i.window,"mouseup",this.mouseup)},ii.prototype.mousemove=function(d){this.move(d,s.mousePos(this.element,d))},ii.prototype.mouseup=function(d){this.mouseRotate.mouseupWindow(d),this.mousePitch&&this.mousePitch.mouseupWindow(d),this.offTemp()},ii.prototype.touchstart=function(d){d.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=s.touchPos(this.element,d.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return d.preventDefault()}},this._startPos))},ii.prototype.touchmove=function(d){d.targetTouches.length!==1?this.reset():(this._lastPos=s.touchPos(this.element,d.targetTouches)[0],this.move({preventDefault:function(){return d.preventDefault()}},this._lastPos))},ii.prototype.touchend=function(d){d.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},ii.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Cl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function jd(d,y,m){var T=d.classList;for(var O in Cl)T.remove("mapboxgl-"+m+"-anchor-"+O);T.add("mapboxgl-"+m+"-anchor-"+y)}var pf,xp=function(d){function y(m,T){if(d.call(this),(m instanceof i.window.HTMLElement||T)&&(m=i.extend({element:m},T)),i.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=m&&m.anchor||"center",this._color=m&&m.color||"#3FB1CE",this._scale=m&&m.scale||1,this._draggable=m&&m.draggable||!1,this._clickTolerance=m&&m.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=m&&m.rotation||0,this._rotationAlignment=m&&m.rotationAlignment||"auto",this._pitchAlignment=m&&m.pitchAlignment&&m.pitchAlignment!=="auto"?m.pitchAlignment:this._rotationAlignment,m&&m.element)this._element=m.element,this._offset=i.Point.convert(m&&m.offset||[0,0]);else{this._defaultMarker=!0,this._element=s.create("div"),this._element.setAttribute("aria-label","Map marker");var O=s.createNS("http://www.w3.org/2000/svg","svg");O.setAttributeNS(null,"display","block"),O.setAttributeNS(null,"height","41px"),O.setAttributeNS(null,"width","27px"),O.setAttributeNS(null,"viewBox","0 0 27 41");var U=s.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"stroke","none"),U.setAttributeNS(null,"stroke-width","1"),U.setAttributeNS(null,"fill","none"),U.setAttributeNS(null,"fill-rule","evenodd");var j=s.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"fill-rule","nonzero");var K=s.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"transform","translate(3.0, 29.0)"),K.setAttributeNS(null,"fill","#000000");for(var it=0,pt=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];it<pt.length;it+=1){var Et=pt[it],Ct=s.createNS("http://www.w3.org/2000/svg","ellipse");Ct.setAttributeNS(null,"opacity","0.04"),Ct.setAttributeNS(null,"cx","10.5"),Ct.setAttributeNS(null,"cy","5.80029008"),Ct.setAttributeNS(null,"rx",Et.rx),Ct.setAttributeNS(null,"ry",Et.ry),K.appendChild(Ct)}var Pt=s.createNS("http://www.w3.org/2000/svg","g");Pt.setAttributeNS(null,"fill",this._color);var Vt=s.createNS("http://www.w3.org/2000/svg","path");Vt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Pt.appendChild(Vt);var Ft=s.createNS("http://www.w3.org/2000/svg","g");Ft.setAttributeNS(null,"opacity","0.25"),Ft.setAttributeNS(null,"fill","#000000");var Yt=s.createNS("http://www.w3.org/2000/svg","path");Yt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Ft.appendChild(Yt);var Dt=s.createNS("http://www.w3.org/2000/svg","g");Dt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Dt.setAttributeNS(null,"fill","#FFFFFF");var Xt=s.createNS("http://www.w3.org/2000/svg","g");Xt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var te=s.createNS("http://www.w3.org/2000/svg","circle");te.setAttributeNS(null,"fill","#000000"),te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"cx","5.5"),te.setAttributeNS(null,"cy","5.5"),te.setAttributeNS(null,"r","5.4999962");var le=s.createNS("http://www.w3.org/2000/svg","circle");le.setAttributeNS(null,"fill","#FFFFFF"),le.setAttributeNS(null,"cx","5.5"),le.setAttributeNS(null,"cy","5.5"),le.setAttributeNS(null,"r","5.4999962"),Xt.appendChild(te),Xt.appendChild(le),j.appendChild(K),j.appendChild(Pt),j.appendChild(Ft),j.appendChild(Dt),j.appendChild(Xt),O.appendChild(j),O.setAttributeNS(null,"height",41*this._scale+"px"),O.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(O),this._offset=i.Point.convert(m&&m.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(be){be.preventDefault()}),this._element.addEventListener("mousedown",function(be){be.preventDefault()}),jd(this._element,this._anchor,"marker"),this._popup=null}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.addTo=function(m){return this.remove(),this._map=m,m.getCanvasContainer().appendChild(this._element),m.on("move",this._update),m.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},y.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),s.remove(this._element),this._popup&&this._popup.remove(),this},y.prototype.getLngLat=function(){return this._lngLat},y.prototype.setLngLat=function(m){return this._lngLat=i.LngLat.convert(m),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},y.prototype.getElement=function(){return this._element},y.prototype.setPopup=function(m){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),m){if(!("offset"in m.options)){var T=Math.sqrt(Math.pow(13.5,2)/2);m.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[T,-1*(24.6+T)],"bottom-right":[-T,-1*(24.6+T)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=m,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},y.prototype._onKeyPress=function(m){var T=m.code,O=m.charCode||m.keyCode;T!=="Space"&&T!=="Enter"&&O!==32&&O!==13||this.togglePopup()},y.prototype._onMapClick=function(m){var T=m.originalEvent.target,O=this._element;this._popup&&(T===O||O.contains(T))&&this.togglePopup()},y.prototype.getPopup=function(){return this._popup},y.prototype.togglePopup=function(){var m=this._popup;return m?(m.isOpen()?m.remove():m.addTo(this._map),this):this},y.prototype._update=function(m){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ff(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var T="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?T="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(T="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var O="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?O="rotateX(0deg)":this._pitchAlignment==="map"&&(O="rotateX("+this._map.getPitch()+"deg)"),m&&m.type!=="moveend"||(this._pos=this._pos.round()),s.setTransform(this._element,Cl[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+O+" "+T)}},y.prototype.getOffset=function(){return this._offset},y.prototype.setOffset=function(m){return this._offset=i.Point.convert(m),this._update(),this},y.prototype._onMove=function(m){if(!this._isDragging){var T=this._clickTolerance||this._map._clickTolerance;this._isDragging=m.point.dist(this._pointerdownPos)>=T}this._isDragging&&(this._pos=m.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.Event("dragstart"))),this.fire(new i.Event("drag")))},y.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new i.Event("dragend")),this._state="inactive"},y.prototype._addDragHandler=function(m){this._element.contains(m.originalEvent.target)&&(m.preventDefault(),this._positionDelta=m.point.sub(this._pos).add(this._offset),this._pointerdownPos=m.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},y.prototype.setDraggable=function(m){return this._draggable=!!m,this._map&&(m?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},y.prototype.isDraggable=function(){return this._draggable},y.prototype.setRotation=function(m){return this._rotation=m||0,this._update(),this},y.prototype.getRotation=function(){return this._rotation},y.prototype.setRotationAlignment=function(m){return this._rotationAlignment=m||"auto",this._update(),this},y.prototype.getRotationAlignment=function(){return this._rotationAlignment},y.prototype.setPitchAlignment=function(m){return this._pitchAlignment=m&&m!=="auto"?m:this._rotationAlignment,this._update(),this},y.prototype.getPitchAlignment=function(){return this._pitchAlignment},y}(i.Evented),IA={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},df=0,As=!1,vp=function(d){function y(m){d.call(this),this.options=i.extend({},IA,m),i.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.onAdd=function(m){var T;return this._map=m,this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),T=this._setupUI,pf!==void 0?T(pf):i.window.navigator.permissions!==void 0?i.window.navigator.permissions.query({name:"geolocation"}).then(function(O){T(pf=O.state!=="denied")}):T(pf=!!i.window.navigator.geolocation),this._container},y.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(i.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),s.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,df=0,As=!1},y.prototype._isOutOfMapMaxBounds=function(m){var T=this._map.getMaxBounds(),O=m.coords;return T&&(O.longitude<T.getWest()||O.longitude>T.getEast()||O.latitude<T.getSouth()||O.latitude>T.getNorth())},y.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},y.prototype._onSuccess=function(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new i.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new i.Event("geolocate",m)),this._finish()}},y.prototype._updateCamera=function(m){var T=new i.LngLat(m.coords.longitude,m.coords.latitude),O=m.coords.accuracy,U=this._map.getBearing(),j=i.extend({bearing:U},this.options.fitBoundsOptions);this._map.fitBounds(T.toBounds(O),j,{geolocateSource:!0})},y.prototype._updateMarker=function(m){if(m){var T=new i.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(T).addTo(this._map),this._userLocationDotMarker.setLngLat(T).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},y.prototype._updateCircleRadius=function(){var m=this._map._container.clientHeight/2,T=this._map.unproject([0,m]),O=this._map.unproject([1,m]),U=T.distanceTo(O),j=Math.ceil(2*this._accuracy/U);this._circleElement.style.width=j+"px",this._circleElement.style.height=j+"px"},y.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},y.prototype._onError=function(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var T=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=T,this._geolocateButton.setAttribute("aria-label",T),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&As)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new i.Event("error",m)),this._finish()}},y.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},y.prototype._setupUI=function(m){var T=this;if(this._container.addEventListener("contextmenu",function(j){return j.preventDefault()}),this._geolocateButton=s.create("button","mapboxgl-ctrl-geolocate",this._container),s.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",m===!1){i.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var O=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=O,this._geolocateButton.setAttribute("aria-label",O)}else{var U=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=U,this._geolocateButton.setAttribute("aria-label",U)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=s.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new xp(this._dotElement),this._circleElement=s.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new xp({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(j){j.geolocateSource||T._watchState!=="ACTIVE_LOCK"||j.originalEvent&&j.originalEvent.type==="resize"||(T._watchState="BACKGROUND",T._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),T._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),T.fire(new i.Event("trackuserlocationend")))})},y.prototype.trigger=function(){if(!this._setup)return i.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":df--,As=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++df>1?(m={maximumAge:6e5,timeout:0},As=!0):(m=this.options.positionOptions,As=!1),this._geolocationWatchID=i.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m)}}else i.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},y.prototype._clearWatch=function(){i.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},y}(i.Evented),Ya={maxWidth:100,unit:"metric"},Ru=function(d){this.options=i.extend({},Ya,d),i.bindAll(["_onMove","setUnit"],this)};function mf(d,y,m){var T=m&&m.maxWidth||100,O=d._container.clientHeight/2,U=d.unproject([0,O]),j=d.unproject([T,O]),K=U.distanceTo(j);if(m&&m.unit==="imperial"){var it=3.2808*K;it>5280?Lu(y,T,it/5280,d._getUIString("ScaleControl.Miles")):Lu(y,T,it,d._getUIString("ScaleControl.Feet"))}else m&&m.unit==="nautical"?Lu(y,T,K/1852,d._getUIString("ScaleControl.NauticalMiles")):K>=1e3?Lu(y,T,K/1e3,d._getUIString("ScaleControl.Kilometers")):Lu(y,T,K,d._getUIString("ScaleControl.Meters"))}function Lu(d,y,m,T){var O,U,j,K=(O=m,(U=Math.pow(10,(""+Math.floor(O)).length-1))*(j=(j=O/U)>=10?10:j>=5?5:j>=3?3:j>=2?2:j>=1?1:function(it){var pt=Math.pow(10,Math.ceil(-Math.log(it)/Math.LN10));return Math.round(it*pt)/pt}(j)));d.style.width=y*(K/m)+"px",d.innerHTML=K+"&nbsp;"+T}Ru.prototype.getDefaultPosition=function(){return"bottom-left"},Ru.prototype._onMove=function(){mf(this._map,this._container,this.options)},Ru.prototype.onAdd=function(d){return this._map=d,this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ru.prototype.onRemove=function(){s.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ru.prototype.setUnit=function(d){this.options.unit=d,mf(this._map,this._container,this.options)};var zo=function(d){this._fullscreen=!1,d&&d.container&&(d.container instanceof i.window.HTMLElement?this._container=d.container:i.warnOnce("Full screen control 'container' must be a DOM element.")),i.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in i.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in i.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in i.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in i.window.document&&(this._fullscreenchange="MSFullscreenChange")};zo.prototype.onAdd=function(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},zo.prototype.onRemove=function(){s.remove(this._controlContainer),this._map=null,i.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},zo.prototype._checkFullscreenSupport=function(){return!!(i.window.document.fullscreenEnabled||i.window.document.mozFullScreenEnabled||i.window.document.msFullscreenEnabled||i.window.document.webkitFullscreenEnabled)},zo.prototype._setupUI=function(){var d=this._fullscreenButton=s.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);s.create("span","mapboxgl-ctrl-icon",d).setAttribute("aria-hidden",!0),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),i.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},zo.prototype._updateTitle=function(){var d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.title=d},zo.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},zo.prototype._isFullscreen=function(){return this._fullscreen},zo.prototype._changeIcon=function(){(i.window.document.fullscreenElement||i.window.document.mozFullScreenElement||i.window.document.webkitFullscreenElement||i.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},zo.prototype._onClickFullscreen=function(){this._isFullscreen()?i.window.document.exitFullscreen?i.window.document.exitFullscreen():i.window.document.mozCancelFullScreen?i.window.document.mozCancelFullScreen():i.window.document.msExitFullscreen?i.window.document.msExitFullscreen():i.window.document.webkitCancelFullScreen&&i.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Hd={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},yh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Ou=function(d){function y(m){d.call(this),this.options=i.extend(Object.create(Hd),m),i.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return d&&(y.__proto__=d),(y.prototype=Object.create(d&&d.prototype)).constructor=y,y.prototype.addTo=function(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new i.Event("open")),this},y.prototype.isOpen=function(){return!!this._map},y.prototype.remove=function(){return this._content&&s.remove(this._content),this._container&&(s.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new i.Event("close")),this},y.prototype.getLngLat=function(){return this._lngLat},y.prototype.setLngLat=function(m){return this._lngLat=i.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},y.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},y.prototype.getElement=function(){return this._container},y.prototype.setText=function(m){return this.setDOMContent(i.window.document.createTextNode(m))},y.prototype.setHTML=function(m){var T,O=i.window.document.createDocumentFragment(),U=i.window.document.createElement("body");for(U.innerHTML=m;T=U.firstChild;)O.appendChild(T);return this.setDOMContent(O)},y.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},y.prototype.setMaxWidth=function(m){return this.options.maxWidth=m,this._update(),this},y.prototype.setDOMContent=function(m){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=s.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(m),this._createCloseButton(),this._update(),this._focusFirstElement(),this},y.prototype.addClassName=function(m){this._container&&this._container.classList.add(m)},y.prototype.removeClassName=function(m){this._container&&this._container.classList.remove(m)},y.prototype.setOffset=function(m){return this.options.offset=m,this._update(),this},y.prototype.toggleClassName=function(m){if(this._container)return this._container.classList.toggle(m)},y.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=s.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},y.prototype._onMouseUp=function(m){this._update(m.point)},y.prototype._onMouseMove=function(m){this._update(m.point)},y.prototype._onDrag=function(m){this._update(m.point)},y.prototype._update=function(m){var T=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=s.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=s.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Ct){return T._container.classList.add(Ct)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ff(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||m)){var O=this._pos=this._trackPointer&&m?m:this._map.project(this._lngLat),U=this.options.anchor,j=function Ct(Pt){if(Pt){if(typeof Pt=="number"){var Vt=Math.round(Math.sqrt(.5*Math.pow(Pt,2)));return{center:new i.Point(0,0),top:new i.Point(0,Pt),"top-left":new i.Point(Vt,Vt),"top-right":new i.Point(-Vt,Vt),bottom:new i.Point(0,-Pt),"bottom-left":new i.Point(Vt,-Vt),"bottom-right":new i.Point(-Vt,-Vt),left:new i.Point(Pt,0),right:new i.Point(-Pt,0)}}if(Pt instanceof i.Point||Array.isArray(Pt)){var Ft=i.Point.convert(Pt);return{center:Ft,top:Ft,"top-left":Ft,"top-right":Ft,bottom:Ft,"bottom-left":Ft,"bottom-right":Ft,left:Ft,right:Ft}}return{center:i.Point.convert(Pt.center||[0,0]),top:i.Point.convert(Pt.top||[0,0]),"top-left":i.Point.convert(Pt["top-left"]||[0,0]),"top-right":i.Point.convert(Pt["top-right"]||[0,0]),bottom:i.Point.convert(Pt.bottom||[0,0]),"bottom-left":i.Point.convert(Pt["bottom-left"]||[0,0]),"bottom-right":i.Point.convert(Pt["bottom-right"]||[0,0]),left:i.Point.convert(Pt.left||[0,0]),right:i.Point.convert(Pt.right||[0,0])}}return Ct(new i.Point(0,0))}(this.options.offset);if(!U){var K,it=this._container.offsetWidth,pt=this._container.offsetHeight;K=O.y+j.bottom.y<pt?["top"]:O.y>this._map.transform.height-pt?["bottom"]:[],O.x<it/2?K.push("left"):O.x>this._map.transform.width-it/2&&K.push("right"),U=K.length===0?"bottom":K.join("-")}var Et=O.add(j[U]).round();s.setTransform(this._container,Cl[U]+" translate("+Et.x+"px,"+Et.y+"px)"),jd(this._container,U,"popup")}},y.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var m=this._container.querySelector(yh);m&&m.focus()}},y.prototype._onClose=function(){this.remove()},y}(i.Evented),Bu={version:i.version,supported:o,setRTLTextPlugin:i.setRTLTextPlugin,getRTLTextPluginStatus:i.getRTLTextPluginStatus,Map:PA,NavigationControl:Bc,GeolocateControl:vp,AttributionControl:Aa,ScaleControl:Ru,FullscreenControl:zo,Popup:Ou,Marker:xp,Style:da,LngLat:i.LngLat,LngLatBounds:i.LngLatBounds,Point:i.Point,MercatorCoordinate:i.MercatorCoordinate,Evented:i.Evented,config:i.config,prewarm:function(){Re().acquire(Pe)},clearPrewarmedResources:function(){var d=Rr;d&&(d.isPreloaded()&&d.numActive()===1?(d.release(Pe),Rr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return i.config.ACCESS_TOKEN},set accessToken(d){i.config.ACCESS_TOKEN=d},get baseApiUrl(){return i.config.API_URL},set baseApiUrl(d){i.config.API_URL=d},get workerCount(){return We.workerCount},set workerCount(d){We.workerCount=d},get maxParallelImageRequests(){return i.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){i.config.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage:function(d){i.clearTileCache(d)},workerUrl:""};return Bu}),r})});var BG=Ye((Dfe,FD)=>{"use strict";FD.exports=h3;FD.exports.default=h3;function h3(e,t,r){r=r||2;var n=t&&t.length,i=n?t[0]*r:e.length,o=RG(e,0,i,r,!0),s=[];if(!o||o.next===o.prev)return s;var c,l,h,p,x,w,E;if(n&&(o=y2t(e,t,o,r)),e.length>80*r){c=h=e[0],l=p=e[1];for(var P=r;P<i;P+=r)x=e[P],w=e[P+1],x<c&&(c=x),w<l&&(l=w),x>h&&(h=x),w>p&&(p=w);E=Math.max(h-c,p-l),E=E!==0?32767/E:0}return db(o,s,r,c,l,E,0),s}function RG(e,t,r,n,i){var o,s;if(i===kD(e,t,r,n)>0)for(o=t;o<r;o+=n)s=IG(o,e[o],e[o+1],s);else for(o=r-n;o>=t;o-=n)s=IG(o,e[o],e[o+1],s);return s&&f3(s,s.next)&&(Ab(s),s=s.next),s}function M0(e,t){if(!e)return e;t||(t=e);var r=e,n;do if(n=!1,!r.steiner&&(f3(r,r.next)||Rs(r.prev,r,r.next)===0)){if(Ab(r),r=t=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==t);return t}function db(e,t,r,n,i,o,s){if(e){!s&&o&&T2t(e,n,i,o);for(var c=e,l,h;e.prev!==e.next;){if(l=e.prev,h=e.next,o?A2t(e,n,i,o):m2t(e)){t.push(l.i/r|0),t.push(e.i/r|0),t.push(h.i/r|0),Ab(e),e=h.next,c=h.next;continue}if(e=h,e===c){s?s===1?(e=g2t(M0(e),t,r),db(e,t,r,n,i,o,2)):s===2&&_2t(e,t,r,n,i,o):db(M0(e),t,r,n,i,o,1);break}}}}function m2t(e){var t=e.prev,r=e,n=e.next;if(Rs(t,r,n)>=0)return!1;for(var i=t.x,o=r.x,s=n.x,c=t.y,l=r.y,h=n.y,p=i<o?i<s?i:s:o<s?o:s,x=c<l?c<h?c:h:l<h?l:h,w=i>o?i>s?i:s:o>s?o:s,E=c>l?c>h?c:h:l>h?l:h,P=n.next;P!==t;){if(P.x>=p&&P.x<=w&&P.y>=x&&P.y<=E&&my(i,c,o,l,s,h,P.x,P.y)&&Rs(P.prev,P,P.next)>=0)return!1;P=P.next}return!0}function A2t(e,t,r,n){var i=e.prev,o=e,s=e.next;if(Rs(i,o,s)>=0)return!1;for(var c=i.x,l=o.x,h=s.x,p=i.y,x=o.y,w=s.y,E=c<l?c<h?c:h:l<h?l:h,P=p<x?p<w?p:w:x<w?x:w,B=c>l?c>h?c:h:l>h?l:h,D=p>x?p>w?p:w:x>w?x:w,W=DD(E,P,t,r,n),X=DD(B,D,t,r,n),q=e.prevZ,$=e.nextZ;q&&q.z>=W&&$&&$.z<=X;){if(q.x>=E&&q.x<=B&&q.y>=P&&q.y<=D&&q!==i&&q!==s&&my(c,p,l,x,h,w,q.x,q.y)&&Rs(q.prev,q,q.next)>=0||(q=q.prevZ,$.x>=E&&$.x<=B&&$.y>=P&&$.y<=D&&$!==i&&$!==s&&my(c,p,l,x,h,w,$.x,$.y)&&Rs($.prev,$,$.next)>=0))return!1;$=$.nextZ}for(;q&&q.z>=W;){if(q.x>=E&&q.x<=B&&q.y>=P&&q.y<=D&&q!==i&&q!==s&&my(c,p,l,x,h,w,q.x,q.y)&&Rs(q.prev,q,q.next)>=0)return!1;q=q.prevZ}for(;$&&$.z<=X;){if($.x>=E&&$.x<=B&&$.y>=P&&$.y<=D&&$!==i&&$!==s&&my(c,p,l,x,h,w,$.x,$.y)&&Rs($.prev,$,$.next)>=0)return!1;$=$.nextZ}return!0}function g2t(e,t,r){var n=e;do{var i=n.prev,o=n.next.next;!f3(i,o)&&LG(i,n,n.next,o)&&mb(i,o)&&mb(o,i)&&(t.push(i.i/r|0),t.push(n.i/r|0),t.push(o.i/r|0),Ab(n),Ab(n.next),n=e=o),n=n.next}while(n!==e);return M0(n)}function _2t(e,t,r,n,i,o){var s=e;do{for(var c=s.next.next;c!==s.prev;){if(s.i!==c.i&&S2t(s,c)){var l=OG(s,c);s=M0(s,s.next),l=M0(l,l.next),db(s,t,r,n,i,o,0),db(l,t,r,n,i,o,0);return}c=c.next}s=s.next}while(s!==e)}function y2t(e,t,r,n){var i=[],o,s,c,l,h;for(o=0,s=t.length;o<s;o++)c=t[o]*n,l=o<s-1?t[o+1]*n:e.length,h=RG(e,c,l,n,!1),h===h.next&&(h.steiner=!0),i.push(M2t(h));for(i.sort(x2t),o=0;o<i.length;o++)r=v2t(i[o],r);return r}function x2t(e,t){return e.x-t.x}function v2t(e,t){var r=b2t(e,t);if(!r)return t;var n=OG(r,e);return M0(n,n.next),M0(r,r.next)}function b2t(e,t){var r=t,n=e.x,i=e.y,o=-1/0,s;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var c=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(c<=n&&c>o&&(o=c,s=r.x<r.next.x?r:r.next,c===n))return s}r=r.next}while(r!==t);if(!s)return null;var l=s,h=s.x,p=s.y,x=1/0,w;r=s;do n>=r.x&&r.x>=h&&n!==r.x&&my(i<p?n:o,i,h,p,i<p?o:n,i,r.x,r.y)&&(w=Math.abs(i-r.y)/(n-r.x),mb(r,e)&&(w<x||w===x&&(r.x>s.x||r.x===s.x&&w2t(s,r)))&&(s=r,x=w)),r=r.next;while(r!==l);return s}function w2t(e,t){return Rs(e.prev,e,t.prev)<0&&Rs(t.next,e,e.next)<0}function T2t(e,t,r,n){var i=e;do i.z===0&&(i.z=DD(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,E2t(i)}function E2t(e){var t,r,n,i,o,s,c,l,h=1;do{for(r=e,e=null,o=null,s=0;r;){for(s++,n=r,c=0,t=0;t<h&&(c++,n=n.nextZ,!!n);t++);for(l=h;c>0||l>0&&n;)c!==0&&(l===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,c--):(i=n,n=n.nextZ,l--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;r=n}o.nextZ=null,h*=2}while(s>1);return e}function DD(e,t,r,n,i){return e=(e-r)*i|0,t=(t-n)*i|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function M2t(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function my(e,t,r,n,i,o,s,c){return(i-s)*(t-c)>=(e-s)*(o-c)&&(e-s)*(n-c)>=(r-s)*(t-c)&&(r-s)*(o-c)>=(i-s)*(n-c)}function S2t(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!C2t(e,t)&&(mb(e,t)&&mb(t,e)&&P2t(e,t)&&(Rs(e.prev,e,t.prev)||Rs(e,t.prev,t))||f3(e,t)&&Rs(e.prev,e,e.next)>0&&Rs(t.prev,t,t.next)>0)}function Rs(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function f3(e,t){return e.x===t.x&&e.y===t.y}function LG(e,t,r,n){var i=u3(Rs(e,t,r)),o=u3(Rs(e,t,n)),s=u3(Rs(r,n,e)),c=u3(Rs(r,n,t));return!!(i!==o&&s!==c||i===0&&l3(e,r,t)||o===0&&l3(e,n,t)||s===0&&l3(r,e,n)||c===0&&l3(r,t,n))}function l3(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function u3(e){return e>0?1:e<0?-1:0}function C2t(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&LG(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function mb(e,t){return Rs(e.prev,e,e.next)<0?Rs(e,t,e.next)>=0&&Rs(e,e.prev,t)>=0:Rs(e,t,e.prev)<0||Rs(e,e.next,t)<0}function P2t(e,t){var r=e,n=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==e);return n}function OG(e,t){var r=new ND(e.i,e.x,e.y),n=new ND(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function IG(e,t,r,n){var i=new ND(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Ab(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function ND(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}h3.deviation=function(e,t,r,n){var i=t&&t.length,o=i?t[0]*r:e.length,s=Math.abs(kD(e,0,o,r));if(i)for(var c=0,l=t.length;c<l;c++){var h=t[c]*r,p=c<l-1?t[c+1]*r:e.length;s-=Math.abs(kD(e,h,p,r))}var x=0;for(c=0;c<n.length;c+=3){var w=n[c]*r,E=n[c+1]*r,P=n[c+2]*r;x+=Math.abs((e[w]-e[P])*(e[E+1]-e[w+1])-(e[w]-e[E])*(e[P+1]-e[w+1]))}return s===0&&x===0?0:Math.abs((x-s)/s)};function kD(e,t,r,n){for(var i=0,o=t,s=r-n;o<r;o+=n)i+=(e[s]-e[o])*(e[o+1]+e[s+1]),s=o;return i}h3.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var s=0;s<t;s++)r.vertices.push(e[i][o][s]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r}});var H3=Ye(nd=>{"use strict";var JY=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",Vbt=JY+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",tK="["+JY+"]["+Vbt+"]*",jbt=new RegExp("^"+tK+"$"),Hbt=function(e,t){let r=[],n=t.exec(e);for(;n;){let i=[];i.startIndex=t.lastIndex-n[0].length;let o=n.length;for(let s=0;s<o;s++)i.push(n[s]);r.push(i),n=t.exec(e)}return r},Wbt=function(e){let t=jbt.exec(e);return!(t===null||typeof t>"u")};nd.isExist=function(e){return typeof e<"u"};nd.isEmptyObject=function(e){return Object.keys(e).length===0};nd.merge=function(e,t,r){if(t){let n=Object.keys(t),i=n.length;for(let o=0;o<i;o++)r==="strict"?e[n[o]]=[t[n[o]]]:e[n[o]]=t[n[o]]}};nd.getValue=function(e){return nd.isExist(e)?e:""};nd.isName=Wbt;nd.getAllMatches=Hbt;nd.nameRegexp=tK});var QD=Ye(oK=>{"use strict";var $D=H3(),qbt={allowBooleanAttributes:!1,unpairedTags:[]};oK.validate=function(e,t){t=Object.assign({},qbt,t);let r=[],n=!1,i=!1;e[0]==="\uFEFF"&&(e=e.substr(1));for(let o=0;o<e.length;o++)if(e[o]==="<"&&e[o+1]==="?"){if(o+=2,o=rK(e,o),o.err)return o}else if(e[o]==="<"){let s=o;if(o++,e[o]==="!"){o=nK(e,o);continue}else{let c=!1;e[o]==="/"&&(c=!0,o++);let l="";for(;o<e.length&&e[o]!==">"&&e[o]!==" "&&e[o]!=="	"&&e[o]!==`
`&&e[o]!=="\r";o++)l+=e[o];if(l=l.trim(),l[l.length-1]==="/"&&(l=l.substring(0,l.length-1),o--),!Jbt(l)){let x;return l.trim().length===0?x="Invalid space after '<'.":x="Tag '"+l+"' is an invalid name.",ia("InvalidTag",x,ml(e,o))}let h=Ybt(e,o);if(h===!1)return ia("InvalidAttr","Attributes for '"+l+"' have open quote.",ml(e,o));let p=h.value;if(o=h.index,p[p.length-1]==="/"){let x=o-p.length;p=p.substring(0,p.length-1);let w=iK(p,t);if(w===!0)n=!0;else return ia(w.err.code,w.err.msg,ml(e,x+w.err.line))}else if(c)if(h.tagClosed){if(p.trim().length>0)return ia("InvalidTag","Closing tag '"+l+"' can't have attributes or invalid starting.",ml(e,s));if(r.length===0)return ia("InvalidTag","Closing tag '"+l+"' has not been opened.",ml(e,s));{let x=r.pop();if(l!==x.tagName){let w=ml(e,x.tagStartPos);return ia("InvalidTag","Expected closing tag '"+x.tagName+"' (opened in line "+w.line+", col "+w.col+") instead of closing tag '"+l+"'.",ml(e,s))}r.length==0&&(i=!0)}}else return ia("InvalidTag","Closing tag '"+l+"' doesn't have proper closing.",ml(e,o));else{let x=iK(p,t);if(x!==!0)return ia(x.err.code,x.err.msg,ml(e,o-p.length+x.err.line));if(i===!0)return ia("InvalidXml","Multiple possible root nodes found.",ml(e,o));t.unpairedTags.indexOf(l)!==-1||r.push({tagName:l,tagStartPos:s}),n=!0}for(o++;o<e.length;o++)if(e[o]==="<")if(e[o+1]==="!"){o++,o=nK(e,o);continue}else if(e[o+1]==="?"){if(o=rK(e,++o),o.err)return o}else break;else if(e[o]==="&"){let x=$bt(e,o);if(x==-1)return ia("InvalidChar","char '&' is not expected.",ml(e,o));o=x}else if(i===!0&&!eK(e[o]))return ia("InvalidXml","Extra text at the end",ml(e,o));e[o]==="<"&&o--}}else{if(eK(e[o]))continue;return ia("InvalidChar","char '"+e[o]+"' is not expected.",ml(e,o))}if(n){if(r.length==1)return ia("InvalidTag","Unclosed tag '"+r[0].tagName+"'.",ml(e,r[0].tagStartPos));if(r.length>0)return ia("InvalidXml","Invalid '"+JSON.stringify(r.map(o=>o.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return ia("InvalidXml","Start tag expected.",1);return!0};function eK(e){return e===" "||e==="	"||e===`
`||e==="\r"}function rK(e,t){let r=t;for(;t<e.length;t++)if(e[t]=="?"||e[t]==" "){let n=e.substr(r,t-r);if(t>5&&n==="xml")return ia("InvalidXml","XML declaration allowed only at the start of the document.",ml(e,t));if(e[t]=="?"&&e[t+1]==">"){t++;break}else continue}return t}function nK(e,t){if(e.length>t+5&&e[t+1]==="-"&&e[t+2]==="-"){for(t+=3;t<e.length;t++)if(e[t]==="-"&&e[t+1]==="-"&&e[t+2]===">"){t+=2;break}}else if(e.length>t+8&&e[t+1]==="D"&&e[t+2]==="O"&&e[t+3]==="C"&&e[t+4]==="T"&&e[t+5]==="Y"&&e[t+6]==="P"&&e[t+7]==="E"){let r=1;for(t+=8;t<e.length;t++)if(e[t]==="<")r++;else if(e[t]===">"&&(r--,r===0))break}else if(e.length>t+9&&e[t+1]==="["&&e[t+2]==="C"&&e[t+3]==="D"&&e[t+4]==="A"&&e[t+5]==="T"&&e[t+6]==="A"&&e[t+7]==="["){for(t+=8;t<e.length;t++)if(e[t]==="]"&&e[t+1]==="]"&&e[t+2]===">"){t+=2;break}}return t}var Gbt='"',Xbt="'";function Ybt(e,t){let r="",n="",i=!1;for(;t<e.length;t++){if(e[t]===Gbt||e[t]===Xbt)n===""?n=e[t]:n!==e[t]||(n="");else if(e[t]===">"&&n===""){i=!0;break}r+=e[t]}return n!==""?!1:{value:r,index:t,tagClosed:i}}var Kbt=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function iK(e,t){let r=$D.getAllMatches(e,Kbt),n={};for(let i=0;i<r.length;i++){if(r[i][1].length===0)return ia("InvalidAttr","Attribute '"+r[i][2]+"' has no space in starting.",kb(r[i]));if(r[i][3]!==void 0&&r[i][4]===void 0)return ia("InvalidAttr","Attribute '"+r[i][2]+"' is without value.",kb(r[i]));if(r[i][3]===void 0&&!t.allowBooleanAttributes)return ia("InvalidAttr","boolean attribute '"+r[i][2]+"' is not allowed.",kb(r[i]));let o=r[i][2];if(!Qbt(o))return ia("InvalidAttr","Attribute '"+o+"' is an invalid name.",kb(r[i]));if(!n.hasOwnProperty(o))n[o]=1;else return ia("InvalidAttr","Attribute '"+o+"' is repeated.",kb(r[i]))}return!0}function Zbt(e,t){let r=/\d/;for(e[t]==="x"&&(t++,r=/[\da-fA-F]/);t<e.length;t++){if(e[t]===";")return t;if(!e[t].match(r))break}return-1}function $bt(e,t){if(t++,e[t]===";")return-1;if(e[t]==="#")return t++,Zbt(e,t);let r=0;for(;t<e.length;t++,r++)if(!(e[t].match(/\w/)&&r<20)){if(e[t]===";")break;return-1}return t}function ia(e,t,r){return{err:{code:e,msg:t,line:r.line||r,col:r.col}}}function Qbt(e){return $D.isName(e)}function Jbt(e){return $D.isName(e)}function ml(e,t){let r=e.substring(0,t).split(/\r?\n/);return{line:r.length,col:r[r.length-1].length+1}}function kb(e){return e.startIndex+e[1].length}});var aK=Ye(JD=>{var sK={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(e,t,r){return e}},twt=function(e){return Object.assign({},sK,e)};JD.buildOptions=twt;JD.defaultOptions=sK});var lK=Ye((a0e,cK)=>{"use strict";var tN=class{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,r){t==="__proto__"&&(t="#__proto__"),this.child.push({[t]:r})}addChild(t){t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,[":@"]:t[":@"]}):this.child.push({[t.tagname]:t.child})}};cK.exports=tN});var hK=Ye((c0e,uK)=>{var ewt=H3();function rwt(e,t){let r={};if(e[t+3]==="O"&&e[t+4]==="C"&&e[t+5]==="T"&&e[t+6]==="Y"&&e[t+7]==="P"&&e[t+8]==="E"){t=t+9;let n=1,i=!1,o=!1,s="";for(;t<e.length;t++)if(e[t]==="<"&&!o){if(i&&owt(e,t))t+=7,[entityName,val,t]=nwt(e,t+1),val.indexOf("&")===-1&&(r[lwt(entityName)]={regx:RegExp(`&${entityName};`,"g"),val});else if(i&&swt(e,t))t+=8;else if(i&&awt(e,t))t+=8;else if(i&&cwt(e,t))t+=9;else if(iwt)o=!0;else throw new Error("Invalid DOCTYPE");n++,s=""}else if(e[t]===">"){if(o?e[t-1]==="-"&&e[t-2]==="-"&&(o=!1,n--):n--,n===0)break}else e[t]==="["?i=!0:s+=e[t];if(n!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:r,i:t}}function nwt(e,t){let r="";for(;t<e.length&&e[t]!=="'"&&e[t]!=='"';t++)r+=e[t];if(r=r.trim(),r.indexOf(" ")!==-1)throw new Error("External entites are not supported");let n=e[t++],i="";for(;t<e.length&&e[t]!==n;t++)i+=e[t];return[r,i,t]}function iwt(e,t){return e[t+1]==="!"&&e[t+2]==="-"&&e[t+3]==="-"}function owt(e,t){return e[t+1]==="!"&&e[t+2]==="E"&&e[t+3]==="N"&&e[t+4]==="T"&&e[t+5]==="I"&&e[t+6]==="T"&&e[t+7]==="Y"}function swt(e,t){return e[t+1]==="!"&&e[t+2]==="E"&&e[t+3]==="L"&&e[t+4]==="E"&&e[t+5]==="M"&&e[t+6]==="E"&&e[t+7]==="N"&&e[t+8]==="T"}function awt(e,t){return e[t+1]==="!"&&e[t+2]==="A"&&e[t+3]==="T"&&e[t+4]==="T"&&e[t+5]==="L"&&e[t+6]==="I"&&e[t+7]==="S"&&e[t+8]==="T"}function cwt(e,t){return e[t+1]==="!"&&e[t+2]==="N"&&e[t+3]==="O"&&e[t+4]==="T"&&e[t+5]==="A"&&e[t+6]==="T"&&e[t+7]==="I"&&e[t+8]==="O"&&e[t+9]==="N"}function lwt(e){if(ewt.isName(e))return e;throw new Error(`Invalid entity name ${e}`)}uK.exports=rwt});var pK=Ye((l0e,fK)=>{var uwt=/^[-+]?0x[a-fA-F0-9]+$/,hwt=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);var fwt={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function pwt(e,t={}){if(t=Object.assign({},fwt,t),!e||typeof e!="string")return e;let r=e.trim();if(t.skipLike!==void 0&&t.skipLike.test(r))return e;if(t.hex&&uwt.test(r))return Number.parseInt(r,16);{let n=hwt.exec(r);if(n){let i=n[1],o=n[2],s=dwt(n[3]),c=n[4]||n[6];if(!t.leadingZeros&&o.length>0&&i&&r[2]!==".")return e;if(!t.leadingZeros&&o.length>0&&!i&&r[1]!==".")return e;{let l=Number(r),h=""+l;return h.search(/[eE]/)!==-1||c?t.eNotation?l:e:r.indexOf(".")!==-1?h==="0"&&s===""||h===s||i&&h==="-"+s?l:e:o?s===h||i+s===h?l:e:r===h||r===i+h?l:e}}else return e}}function dwt(e){return e&&e.indexOf(".")!==-1&&(e=e.replace(/0+$/,""),e==="."?e="0":e[0]==="."?e="0"+e:e[e.length-1]==="."&&(e=e.substr(0,e.length-1))),e}fK.exports=pwt});var AK=Ye((u0e,mK)=>{"use strict";var dK=H3(),Fb=lK(),mwt=hK(),Awt=pK(),eN=class{constructor(t){this.options=t,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"\xA2"},pound:{regex:/&(pound|#163);/g,val:"\xA3"},yen:{regex:/&(yen|#165);/g,val:"\xA5"},euro:{regex:/&(euro|#8364);/g,val:"\u20AC"},copyright:{regex:/&(copy|#169);/g,val:"\xA9"},reg:{regex:/&(reg|#174);/g,val:"\xAE"},inr:{regex:/&(inr|#8377);/g,val:"\u20B9"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(r,n)=>String.fromCharCode(Number.parseInt(n,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(r,n)=>String.fromCharCode(Number.parseInt(n,16))}},this.addExternalEntities=gwt,this.parseXml=bwt,this.parseTextData=_wt,this.resolveNameSpace=ywt,this.buildAttributesMap=vwt,this.isItStopNode=Mwt,this.replaceEntitiesValue=Twt,this.readStopNodeData=Cwt,this.saveTextToParentTag=Ewt,this.addChild=wwt}};function gwt(e){let t=Object.keys(e);for(let r=0;r<t.length;r++){let n=t[r];this.lastEntities[n]={regex:new RegExp("&"+n+";","g"),val:e[n]}}}function _wt(e,t,r,n,i,o,s){if(e!==void 0&&(this.options.trimValues&&!n&&(e=e.trim()),e.length>0)){s||(e=this.replaceEntitiesValue(e));let c=this.options.tagValueProcessor(t,e,r,i,o);return c==null?e:typeof c!=typeof e||c!==e?c:this.options.trimValues?nN(e,this.options.parseTagValue,this.options.numberParseOptions):e.trim()===e?nN(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function ywt(e){if(this.options.removeNSPrefix){let t=e.split(":"),r=e.charAt(0)==="/"?"/":"";if(t[0]==="xmlns")return"";t.length===2&&(e=r+t[1])}return e}var xwt=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function vwt(e,t,r){if(!this.options.ignoreAttributes&&typeof e=="string"){let n=dK.getAllMatches(e,xwt),i=n.length,o={};for(let s=0;s<i;s++){let c=this.resolveNameSpace(n[s][1]),l=n[s][4],h=this.options.attributeNamePrefix+c;if(c.length)if(this.options.transformAttributeName&&(h=this.options.transformAttributeName(h)),h==="__proto__"&&(h="#__proto__"),l!==void 0){this.options.trimValues&&(l=l.trim()),l=this.replaceEntitiesValue(l);let p=this.options.attributeValueProcessor(c,l,t);p==null?o[h]=l:typeof p!=typeof l||p!==l?o[h]=p:o[h]=nN(l,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(o[h]=!0)}if(!Object.keys(o).length)return;if(this.options.attributesGroupName){let s={};return s[this.options.attributesGroupName]=o,s}return o}}var bwt=function(e){e=e.replace(/\r\n?/g,`
`);let t=new Fb("!xml"),r=t,n="",i="";for(let o=0;o<e.length;o++)if(e[o]==="<")if(e[o+1]==="/"){let c=P0(e,">",o,"Closing Tag is not closed."),l=e.substring(o+2,c).trim();if(this.options.removeNSPrefix){let x=l.indexOf(":");x!==-1&&(l=l.substr(x+1))}this.options.transformTagName&&(l=this.options.transformTagName(l)),r&&(n=this.saveTextToParentTag(n,r,i));let h=i.substring(i.lastIndexOf(".")+1);if(l&&this.options.unpairedTags.indexOf(l)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${l}>`);let p=0;h&&this.options.unpairedTags.indexOf(h)!==-1?(p=i.lastIndexOf(".",i.lastIndexOf(".")-1),this.tagsNodeStack.pop()):p=i.lastIndexOf("."),i=i.substring(0,p),r=this.tagsNodeStack.pop(),n="",o=c}else if(e[o+1]==="?"){let c=rN(e,o,!1,"?>");if(!c)throw new Error("Pi Tag is not closed.");if(n=this.saveTextToParentTag(n,r,i),!(this.options.ignoreDeclaration&&c.tagName==="?xml"||this.options.ignorePiTags)){let l=new Fb(c.tagName);l.add(this.options.textNodeName,""),c.tagName!==c.tagExp&&c.attrExpPresent&&(l[":@"]=this.buildAttributesMap(c.tagExp,i,c.tagName)),this.addChild(r,l,i)}o=c.closeIndex+1}else if(e.substr(o+1,3)==="!--"){let c=P0(e,"-->",o+4,"Comment is not closed.");if(this.options.commentPropName){let l=e.substring(o+4,c-2);n=this.saveTextToParentTag(n,r,i),r.add(this.options.commentPropName,[{[this.options.textNodeName]:l}])}o=c}else if(e.substr(o+1,2)==="!D"){let c=mwt(e,o);this.docTypeEntities=c.entities,o=c.i}else if(e.substr(o+1,2)==="!["){let c=P0(e,"]]>",o,"CDATA is not closed.")-2,l=e.substring(o+9,c);n=this.saveTextToParentTag(n,r,i);let h=this.parseTextData(l,r.tagname,i,!0,!1,!0,!0);h==null&&(h=""),this.options.cdataPropName?r.add(this.options.cdataPropName,[{[this.options.textNodeName]:l}]):r.add(this.options.textNodeName,h),o=c+2}else{let c=rN(e,o,this.options.removeNSPrefix),l=c.tagName,h=c.rawTagName,p=c.tagExp,x=c.attrExpPresent,w=c.closeIndex;this.options.transformTagName&&(l=this.options.transformTagName(l)),r&&n&&r.tagname!=="!xml"&&(n=this.saveTextToParentTag(n,r,i,!1));let E=r;if(E&&this.options.unpairedTags.indexOf(E.tagname)!==-1&&(r=this.tagsNodeStack.pop(),i=i.substring(0,i.lastIndexOf("."))),l!==t.tagname&&(i+=i?"."+l:l),this.isItStopNode(this.options.stopNodes,i,l)){let P="";if(p.length>0&&p.lastIndexOf("/")===p.length-1)l[l.length-1]==="/"?(l=l.substr(0,l.length-1),i=i.substr(0,i.length-1),p=l):p=p.substr(0,p.length-1),o=c.closeIndex;else if(this.options.unpairedTags.indexOf(l)!==-1)o=c.closeIndex;else{let D=this.readStopNodeData(e,h,w+1);if(!D)throw new Error(`Unexpected end of ${h}`);o=D.i,P=D.tagContent}let B=new Fb(l);l!==p&&x&&(B[":@"]=this.buildAttributesMap(p,i,l)),P&&(P=this.parseTextData(P,l,i,!0,x,!0,!0)),i=i.substr(0,i.lastIndexOf(".")),B.add(this.options.textNodeName,P),this.addChild(r,B,i)}else{if(p.length>0&&p.lastIndexOf("/")===p.length-1){l[l.length-1]==="/"?(l=l.substr(0,l.length-1),i=i.substr(0,i.length-1),p=l):p=p.substr(0,p.length-1),this.options.transformTagName&&(l=this.options.transformTagName(l));let P=new Fb(l);l!==p&&x&&(P[":@"]=this.buildAttributesMap(p,i,l)),this.addChild(r,P,i),i=i.substr(0,i.lastIndexOf("."))}else{let P=new Fb(l);this.tagsNodeStack.push(r),l!==p&&x&&(P[":@"]=this.buildAttributesMap(p,i,l)),this.addChild(r,P,i),r=P}n="",o=w}}else n+=e[o];return t.child};function wwt(e,t,r){let n=this.options.updateTag(t.tagname,r,t[":@"]);n===!1||(typeof n=="string"&&(t.tagname=n),e.addChild(t))}var Twt=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){let r=this.docTypeEntities[t];e=e.replace(r.regx,r.val)}for(let t in this.lastEntities){let r=this.lastEntities[t];e=e.replace(r.regex,r.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){let r=this.htmlEntities[t];e=e.replace(r.regex,r.val)}e=e.replace(this.ampEntity.regex,this.ampEntity.val)}return e};function Ewt(e,t,r,n){return e&&(n===void 0&&(n=Object.keys(t.child).length===0),e=this.parseTextData(e,t.tagname,r,!1,t[":@"]?Object.keys(t[":@"]).length!==0:!1,n),e!==void 0&&e!==""&&t.add(this.options.textNodeName,e),e=""),e}function Mwt(e,t,r){let n="*."+r;for(let i in e){let o=e[i];if(n===o||t===o)return!0}return!1}function Swt(e,t,r=">"){let n,i="";for(let o=t;o<e.length;o++){let s=e[o];if(n)s===n&&(n="");else if(s==='"'||s==="'")n=s;else if(s===r[0])if(r[1]){if(e[o+1]===r[1])return{data:i,index:o}}else return{data:i,index:o};else s==="	"&&(s=" ");i+=s}}function P0(e,t,r,n){let i=e.indexOf(t,r);if(i===-1)throw new Error(n);return i+t.length-1}function rN(e,t,r,n=">"){let i=Swt(e,t+1,n);if(!i)return;let o=i.data,s=i.index,c=o.search(/\s/),l=o,h=!0;c!==-1&&(l=o.substring(0,c),o=o.substring(c+1).trimStart());let p=l;if(r){let x=l.indexOf(":");x!==-1&&(l=l.substr(x+1),h=l!==i.data.substr(x+1))}return{tagName:l,tagExp:o,closeIndex:s,attrExpPresent:h,rawTagName:p}}function Cwt(e,t,r){let n=r,i=1;for(;r<e.length;r++)if(e[r]==="<")if(e[r+1]==="/"){let o=P0(e,">",r,`${t} is not closed`);if(e.substring(r+2,o).trim()===t&&(i--,i===0))return{tagContent:e.substring(n,r),i:o};r=o}else if(e[r+1]==="?")r=P0(e,"?>",r+1,"StopNode is not closed.");else if(e.substr(r+1,3)==="!--")r=P0(e,"-->",r+3,"StopNode is not closed.");else if(e.substr(r+1,2)==="![")r=P0(e,"]]>",r,"StopNode is not closed.")-2;else{let o=rN(e,r,">");o&&((o&&o.tagName)===t&&o.tagExp[o.tagExp.length-1]!=="/"&&i++,r=o.closeIndex)}}function nN(e,t,r){if(t&&typeof e=="string"){let n=e.trim();return n==="true"?!0:n==="false"?!1:Awt(e,r)}else return dK.isExist(e)?e:""}mK.exports=eN});var yK=Ye(_K=>{"use strict";function Pwt(e,t){return gK(e,t)}function gK(e,t,r){let n,i={};for(let o=0;o<e.length;o++){let s=e[o],c=Iwt(s),l="";if(r===void 0?l=c:l=r+"."+c,c===t.textNodeName)n===void 0?n=s[c]:n+=""+s[c];else{if(c===void 0)continue;if(s[c]){let h=gK(s[c],t,l),p=Lwt(h,t);s[":@"]?Rwt(h,s[":@"],l,t):Object.keys(h).length===1&&h[t.textNodeName]!==void 0&&!t.alwaysCreateTextNode?h=h[t.textNodeName]:Object.keys(h).length===0&&(t.alwaysCreateTextNode?h[t.textNodeName]="":h=""),i[c]!==void 0&&i.hasOwnProperty(c)?(Array.isArray(i[c])||(i[c]=[i[c]]),i[c].push(h)):t.isArray(c,l,p)?i[c]=[h]:i[c]=h}}}return typeof n=="string"?n.length>0&&(i[t.textNodeName]=n):n!==void 0&&(i[t.textNodeName]=n),i}function Iwt(e){let t=Object.keys(e);for(let r=0;r<t.length;r++){let n=t[r];if(n!==":@")return n}}function Rwt(e,t,r,n){if(t){let i=Object.keys(t),o=i.length;for(let s=0;s<o;s++){let c=i[s];n.isArray(c,r+"."+c,!0,!0)?e[c]=[t[c]]:e[c]=t[c]}}}function Lwt(e,t){let{textNodeName:r}=t,n=Object.keys(e).length;return!!(n===0||n===1&&(e[r]||typeof e[r]=="boolean"||e[r]===0))}_K.prettify=Pwt});var vK=Ye((f0e,xK)=>{var{buildOptions:Owt}=aK(),Bwt=AK(),{prettify:Dwt}=yK(),Nwt=QD(),iN=class{constructor(t){this.externalEntities={},this.options=Owt(t)}parse(t,r){if(typeof t!="string")if(t.toString)t=t.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(r){r===!0&&(r={});let o=Nwt.validate(t,r);if(o!==!0)throw Error(`${o.err.msg}:${o.err.line}:${o.err.col}`)}let n=new Bwt(this.options);n.addExternalEntities(this.externalEntities);let i=n.parseXml(t);return this.options.preserveOrder||i===void 0?i:Dwt(i,this.options)}addEntity(t,r){if(r.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(t.indexOf("&")!==-1||t.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(r==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[t]=r}};xK.exports=iN});var MK=Ye((p0e,EK)=>{var kwt=`
`;function Fwt(e,t){let r="";return t.format&&t.indentBy.length>0&&(r=kwt),wK(e,t,"",r)}function wK(e,t,r,n){let i="",o=!1;for(let s=0;s<e.length;s++){let c=e[s],l=zwt(c);if(l===void 0)continue;let h="";if(r.length===0?h=l:h=`${r}.${l}`,l===t.textNodeName){let P=c[l];Uwt(h,t)||(P=t.tagValueProcessor(l,P),P=TK(P,t)),o&&(i+=n),i+=P,o=!1;continue}else if(l===t.cdataPropName){o&&(i+=n),i+=`<![CDATA[${c[l][0][t.textNodeName]}]]>`,o=!1;continue}else if(l===t.commentPropName){i+=n+`<!--${c[l][0][t.textNodeName]}-->`,o=!0;continue}else if(l[0]==="?"){let P=bK(c[":@"],t),B=l==="?xml"?"":n,D=c[l][0][t.textNodeName];D=D.length!==0?" "+D:"",i+=B+`<${l}${D}${P}?>`,o=!0;continue}let p=n;p!==""&&(p+=t.indentBy);let x=bK(c[":@"],t),w=n+`<${l}${x}`,E=wK(c[l],t,h,p);t.unpairedTags.indexOf(l)!==-1?t.suppressUnpairedNode?i+=w+">":i+=w+"/>":(!E||E.length===0)&&t.suppressEmptyNode?i+=w+"/>":E&&E.endsWith(">")?i+=w+`>${E}${n}</${l}>`:(i+=w+">",E&&n!==""&&(E.includes("/>")||E.includes("</"))?i+=n+t.indentBy+E+n:i+=E,i+=`</${l}>`),o=!0}return i}function zwt(e){let t=Object.keys(e);for(let r=0;r<t.length;r++){let n=t[r];if(e.hasOwnProperty(n)&&n!==":@")return n}}function bK(e,t){let r="";if(e&&!t.ignoreAttributes)for(let n in e){if(!e.hasOwnProperty(n))continue;let i=t.attributeValueProcessor(n,e[n]);i=TK(i,t),i===!0&&t.suppressBooleanAttributes?r+=` ${n.substr(t.attributeNamePrefix.length)}`:r+=` ${n.substr(t.attributeNamePrefix.length)}="${i}"`}return r}function Uwt(e,t){e=e.substr(0,e.length-t.textNodeName.length-1);let r=e.substr(e.lastIndexOf(".")+1);for(let n in t.stopNodes)if(t.stopNodes[n]===e||t.stopNodes[n]==="*."+r)return!0;return!1}function TK(e,t){if(e&&e.length>0&&t.processEntities)for(let r=0;r<t.entities.length;r++){let n=t.entities[r];e=e.replace(n.regex,n.val)}return e}EK.exports=Fwt});var CK=Ye((d0e,SK)=>{"use strict";var Vwt=MK(),jwt={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function Pm(e){this.options=Object.assign({},jwt,e),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=qwt),this.processTextOrObjNode=Hwt,this.options.format?(this.indentate=Wwt,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}Pm.prototype.build=function(e){return this.options.preserveOrder?Vwt(e,this.options):(Array.isArray(e)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(e={[this.options.arrayNodeName]:e}),this.j2x(e,0).val)};Pm.prototype.j2x=function(e,t){let r="",n="";for(let i in e)if(Object.prototype.hasOwnProperty.call(e,i))if(typeof e[i]>"u")this.isAttribute(i)&&(n+="");else if(e[i]===null)this.isAttribute(i)?n+="":i[0]==="?"?n+=this.indentate(t)+"<"+i+"?"+this.tagEndChar:n+=this.indentate(t)+"<"+i+"/"+this.tagEndChar;else if(e[i]instanceof Date)n+=this.buildTextValNode(e[i],i,"",t);else if(typeof e[i]!="object"){let o=this.isAttribute(i);if(o)r+=this.buildAttrPairStr(o,""+e[i]);else if(i===this.options.textNodeName){let s=this.options.tagValueProcessor(i,""+e[i]);n+=this.replaceEntitiesValue(s)}else n+=this.buildTextValNode(e[i],i,"",t)}else if(Array.isArray(e[i])){let o=e[i].length,s="",c="";for(let l=0;l<o;l++){let h=e[i][l];if(!(typeof h>"u"))if(h===null)i[0]==="?"?n+=this.indentate(t)+"<"+i+"?"+this.tagEndChar:n+=this.indentate(t)+"<"+i+"/"+this.tagEndChar;else if(typeof h=="object")if(this.options.oneListGroup){let p=this.j2x(h,t+1);s+=p.val,this.options.attributesGroupName&&h.hasOwnProperty(this.options.attributesGroupName)&&(c+=p.attrStr)}else s+=this.processTextOrObjNode(h,i,t);else if(this.options.oneListGroup){let p=this.options.tagValueProcessor(i,h);p=this.replaceEntitiesValue(p),s+=p}else s+=this.buildTextValNode(h,i,"",t)}this.options.oneListGroup&&(s=this.buildObjectNode(s,i,c,t)),n+=s}else if(this.options.attributesGroupName&&i===this.options.attributesGroupName){let o=Object.keys(e[i]),s=o.length;for(let c=0;c<s;c++)r+=this.buildAttrPairStr(o[c],""+e[i][o[c]])}else n+=this.processTextOrObjNode(e[i],i,t);return{attrStr:r,val:n}};Pm.prototype.buildAttrPairStr=function(e,t){return t=this.options.attributeValueProcessor(e,""+t),t=this.replaceEntitiesValue(t),this.options.suppressBooleanAttributes&&t==="true"?" "+e:" "+e+'="'+t+'"'};function Hwt(e,t,r){let n=this.j2x(e,r+1);return e[this.options.textNodeName]!==void 0&&Object.keys(e).length===1?this.buildTextValNode(e[this.options.textNodeName],t,n.attrStr,r):this.buildObjectNode(n.val,t,n.attrStr,r)}Pm.prototype.buildObjectNode=function(e,t,r,n){if(e==="")return t[0]==="?"?this.indentate(n)+"<"+t+r+"?"+this.tagEndChar:this.indentate(n)+"<"+t+r+this.closeTag(t)+this.tagEndChar;{let i="</"+t+this.tagEndChar,o="";return t[0]==="?"&&(o="?",i=""),(r||r==="")&&e.indexOf("<")===-1?this.indentate(n)+"<"+t+r+o+">"+e+i:this.options.commentPropName!==!1&&t===this.options.commentPropName&&o.length===0?this.indentate(n)+`<!--${e}-->`+this.newLine:this.indentate(n)+"<"+t+r+o+this.tagEndChar+e+this.indentate(n)+i}};Pm.prototype.closeTag=function(e){let t="";return this.options.unpairedTags.indexOf(e)!==-1?this.options.suppressUnpairedNode||(t="/"):this.options.suppressEmptyNode?t="/":t=`></${e}`,t};Pm.prototype.buildTextValNode=function(e,t,r,n){if(this.options.cdataPropName!==!1&&t===this.options.cdataPropName)return this.indentate(n)+`<![CDATA[${e}]]>`+this.newLine;if(this.options.commentPropName!==!1&&t===this.options.commentPropName)return this.indentate(n)+`<!--${e}-->`+this.newLine;if(t[0]==="?")return this.indentate(n)+"<"+t+r+"?"+this.tagEndChar;{let i=this.options.tagValueProcessor(t,e);return i=this.replaceEntitiesValue(i),i===""?this.indentate(n)+"<"+t+r+this.closeTag(t)+this.tagEndChar:this.indentate(n)+"<"+t+r+">"+i+"</"+t+this.tagEndChar}};Pm.prototype.replaceEntitiesValue=function(e){if(e&&e.length>0&&this.options.processEntities)for(let t=0;t<this.options.entities.length;t++){let r=this.options.entities[t];e=e.replace(r.regex,r.val)}return e};function Wwt(e){return this.options.indentBy.repeat(e)}function qwt(e){return e.startsWith(this.options.attributeNamePrefix)&&e!==this.options.textNodeName?e.substr(this.attrPrefixLen):!1}SK.exports=Pm});var IK=Ye((m0e,PK)=>{"use strict";var Gwt=QD(),Xwt=vK(),Ywt=CK();PK.exports={XMLParser:Xwt,XMLValidator:Gwt,XMLBuilder:Ywt}});var dN=Ye((jK,Wb)=>{(function(e,t){typeof define=="function"&&define.amd?define([],t):typeof tV=="function"&&typeof Wb=="object"&&Wb&&Wb.exports?Wb.exports=t():(e.dcodeIO=e.dcodeIO||{}).Long=t()})(jK,function(){"use strict";function e(J,G,mt){this.low=J|0,this.high=G|0,this.unsigned=!!mt}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1});function t(J){return(J&&J.__isLong__)===!0}e.isLong=t;var r={},n={};function i(J,G){var mt,Mt,ct;return G?(J>>>=0,(ct=0<=J&&J<256)&&(Mt=n[J],Mt)?Mt:(mt=s(J,(J|0)<0?-1:0,!0),ct&&(n[J]=mt),mt)):(J|=0,(ct=-128<=J&&J<128)&&(Mt=r[J],Mt)?Mt:(mt=s(J,J<0?-1:0,!1),ct&&(r[J]=mt),mt))}e.fromInt=i;function o(J,G){if(isNaN(J)||!isFinite(J))return G?W:D;if(G){if(J<0)return W;if(J>=E)return F}else{if(J<=-P)return ut;if(J+1>=P)return et}return J<0?o(-J,G).neg():s(J%w|0,J/w|0,G)}e.fromNumber=o;function s(J,G,mt){return new e(J,G,mt)}e.fromBits=s;var c=Math.pow;function l(J,G,mt){if(J.length===0)throw Error("empty string");if(J==="NaN"||J==="Infinity"||J==="+Infinity"||J==="-Infinity")return D;if(typeof G=="number"?(mt=G,G=!1):G=!!G,mt=mt||10,mt<2||36<mt)throw RangeError("radix");var Mt;if((Mt=J.indexOf("-"))>0)throw Error("interior hyphen");if(Mt===0)return l(J.substring(1),G,mt).neg();for(var ct=o(c(mt,8)),gt=D,ee=0;ee<J.length;ee+=8){var Ne=Math.min(8,J.length-ee),Ue=parseInt(J.substring(ee,ee+Ne),mt);if(Ne<8){var sr=o(c(mt,Ne));gt=gt.mul(sr).add(o(Ue))}else gt=gt.mul(ct),gt=gt.add(o(Ue))}return gt.unsigned=G,gt}e.fromString=l;function h(J){return J instanceof e?J:typeof J=="number"?o(J):typeof J=="string"?l(J):s(J.low,J.high,J.unsigned)}e.fromValue=h;var p=1<<16,x=1<<24,w=p*p,E=w*w,P=E/2,B=i(x),D=i(0);e.ZERO=D;var W=i(0,!0);e.UZERO=W;var X=i(1);e.ONE=X;var q=i(1,!0);e.UONE=q;var $=i(-1);e.NEG_ONE=$;var et=s(-1,2147483647,!1);e.MAX_VALUE=et;var F=s(-1,-1,!0);e.MAX_UNSIGNED_VALUE=F;var ut=s(0,-2147483648,!1);e.MIN_VALUE=ut;var ot=e.prototype;return ot.toInt=function(){return this.unsigned?this.low>>>0:this.low},ot.toNumber=function(){return this.unsigned?(this.high>>>0)*w+(this.low>>>0):this.high*w+(this.low>>>0)},ot.toString=function(G){if(G=G||10,G<2||36<G)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ut)){var mt=o(G),Mt=this.div(mt),ct=Mt.mul(mt).sub(this);return Mt.toString(G)+ct.toInt().toString(G)}else return"-"+this.neg().toString(G);for(var gt=o(c(G,6),this.unsigned),ee=this,Ne="";;){var Ue=ee.div(gt),sr=ee.sub(Ue.mul(gt)).toInt()>>>0,gr=sr.toString(G);if(ee=Ue,ee.isZero())return gr+Ne;for(;gr.length<6;)gr="0"+gr;Ne=""+gr+Ne}},ot.getHighBits=function(){return this.high},ot.getHighBitsUnsigned=function(){return this.high>>>0},ot.getLowBits=function(){return this.low},ot.getLowBitsUnsigned=function(){return this.low>>>0},ot.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ut)?64:this.neg().getNumBitsAbs();for(var G=this.high!=0?this.high:this.low,mt=31;mt>0&&!(G&1<<mt);mt--);return this.high!=0?mt+33:mt+1},ot.isZero=function(){return this.high===0&&this.low===0},ot.isNegative=function(){return!this.unsigned&&this.high<0},ot.isPositive=function(){return this.unsigned||this.high>=0},ot.isOdd=function(){return(this.low&1)===1},ot.isEven=function(){return(this.low&1)===0},ot.equals=function(G){return t(G)||(G=h(G)),this.unsigned!==G.unsigned&&this.high>>>31===1&&G.high>>>31===1?!1:this.high===G.high&&this.low===G.low},ot.eq=ot.equals,ot.notEquals=function(G){return!this.eq(G)},ot.neq=ot.notEquals,ot.lessThan=function(G){return this.comp(G)<0},ot.lt=ot.lessThan,ot.lessThanOrEqual=function(G){return this.comp(G)<=0},ot.lte=ot.lessThanOrEqual,ot.greaterThan=function(G){return this.comp(G)>0},ot.gt=ot.greaterThan,ot.greaterThanOrEqual=function(G){return this.comp(G)>=0},ot.gte=ot.greaterThanOrEqual,ot.compare=function(G){if(t(G)||(G=h(G)),this.eq(G))return 0;var mt=this.isNegative(),Mt=G.isNegative();return mt&&!Mt?-1:!mt&&Mt?1:this.unsigned?G.high>>>0>this.high>>>0||G.high===this.high&&G.low>>>0>this.low>>>0?-1:1:this.sub(G).isNegative()?-1:1},ot.comp=ot.compare,ot.negate=function(){return!this.unsigned&&this.eq(ut)?ut:this.not().add(X)},ot.neg=ot.negate,ot.add=function(G){t(G)||(G=h(G));var mt=this.high>>>16,Mt=this.high&65535,ct=this.low>>>16,gt=this.low&65535,ee=G.high>>>16,Ne=G.high&65535,Ue=G.low>>>16,sr=G.low&65535,gr=0,Xr=0,ir=0,on=0;return on+=gt+sr,ir+=on>>>16,on&=65535,ir+=ct+Ue,Xr+=ir>>>16,ir&=65535,Xr+=Mt+Ne,gr+=Xr>>>16,Xr&=65535,gr+=mt+ee,gr&=65535,s(ir<<16|on,gr<<16|Xr,this.unsigned)},ot.subtract=function(G){return t(G)||(G=h(G)),this.add(G.neg())},ot.sub=ot.subtract,ot.multiply=function(G){if(this.isZero()||(t(G)||(G=h(G)),G.isZero()))return D;if(this.eq(ut))return G.isOdd()?ut:D;if(G.eq(ut))return this.isOdd()?ut:D;if(this.isNegative())return G.isNegative()?this.neg().mul(G.neg()):this.neg().mul(G).neg();if(G.isNegative())return this.mul(G.neg()).neg();if(this.lt(B)&&G.lt(B))return o(this.toNumber()*G.toNumber(),this.unsigned);var mt=this.high>>>16,Mt=this.high&65535,ct=this.low>>>16,gt=this.low&65535,ee=G.high>>>16,Ne=G.high&65535,Ue=G.low>>>16,sr=G.low&65535,gr=0,Xr=0,ir=0,on=0;return on+=gt*sr,ir+=on>>>16,on&=65535,ir+=ct*sr,Xr+=ir>>>16,ir&=65535,ir+=gt*Ue,Xr+=ir>>>16,ir&=65535,Xr+=Mt*sr,gr+=Xr>>>16,Xr&=65535,Xr+=ct*Ue,gr+=Xr>>>16,Xr&=65535,Xr+=gt*Ne,gr+=Xr>>>16,Xr&=65535,gr+=mt*sr+Mt*Ue+ct*Ne+gt*ee,gr&=65535,s(ir<<16|on,gr<<16|Xr,this.unsigned)},ot.mul=ot.multiply,ot.divide=function(G){if(t(G)||(G=h(G)),G.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?W:D;var mt,Mt,ct;if(this.unsigned){if(G.unsigned||(G=G.toUnsigned()),G.gt(this))return W;if(G.gt(this.shru(1)))return q;ct=W}else{if(this.eq(ut)){if(G.eq(X)||G.eq($))return ut;if(G.eq(ut))return X;var gt=this.shr(1);return mt=gt.div(G).shl(1),mt.eq(D)?G.isNegative()?X:$:(Mt=this.sub(G.mul(mt)),ct=mt.add(Mt.div(G)),ct)}else if(G.eq(ut))return this.unsigned?W:D;if(this.isNegative())return G.isNegative()?this.neg().div(G.neg()):this.neg().div(G).neg();if(G.isNegative())return this.div(G.neg()).neg();ct=D}for(Mt=this;Mt.gte(G);){mt=Math.max(1,Math.floor(Mt.toNumber()/G.toNumber()));for(var ee=Math.ceil(Math.log(mt)/Math.LN2),Ne=ee<=48?1:c(2,ee-48),Ue=o(mt),sr=Ue.mul(G);sr.isNegative()||sr.gt(Mt);)mt-=Ne,Ue=o(mt,this.unsigned),sr=Ue.mul(G);Ue.isZero()&&(Ue=X),ct=ct.add(Ue),Mt=Mt.sub(sr)}return ct},ot.div=ot.divide,ot.modulo=function(G){return t(G)||(G=h(G)),this.sub(this.div(G).mul(G))},ot.mod=ot.modulo,ot.not=function(){return s(~this.low,~this.high,this.unsigned)},ot.and=function(G){return t(G)||(G=h(G)),s(this.low&G.low,this.high&G.high,this.unsigned)},ot.or=function(G){return t(G)||(G=h(G)),s(this.low|G.low,this.high|G.high,this.unsigned)},ot.xor=function(G){return t(G)||(G=h(G)),s(this.low^G.low,this.high^G.high,this.unsigned)},ot.shiftLeft=function(G){return t(G)&&(G=G.toInt()),(G&=63)===0?this:G<32?s(this.low<<G,this.high<<G|this.low>>>32-G,this.unsigned):s(0,this.low<<G-32,this.unsigned)},ot.shl=ot.shiftLeft,ot.shiftRight=function(G){return t(G)&&(G=G.toInt()),(G&=63)===0?this:G<32?s(this.low>>>G|this.high<<32-G,this.high>>G,this.unsigned):s(this.high>>G-32,this.high>=0?0:-1,this.unsigned)},ot.shr=ot.shiftRight,ot.shiftRightUnsigned=function(G){if(t(G)&&(G=G.toInt()),G&=63,G===0)return this;var mt=this.high;if(G<32){var Mt=this.low;return s(Mt>>>G|mt<<32-G,mt>>>G,this.unsigned)}else return G===32?s(mt,0,this.unsigned):s(mt>>>G-32,0,this.unsigned)},ot.shru=ot.shiftRightUnsigned,ot.toSigned=function(){return this.unsigned?s(this.low,this.high,!1):this},ot.toUnsigned=function(){return this.unsigned?this:s(this.low,this.high,!0)},ot.toBytes=function(J){return J?this.toBytesLE():this.toBytesBE()},ot.toBytesLE=function(){var J=this.high,G=this.low;return[G&255,G>>>8&255,G>>>16&255,G>>>24&255,J&255,J>>>8&255,J>>>16&255,J>>>24&255]},ot.toBytesBE=function(){var J=this.high,G=this.low;return[J>>>24&255,J>>>16&255,J>>>8&255,J&255,G>>>24&255,G>>>16&255,G>>>8&255,G&255]},e})});var xit=Ye(M5=>{M5.read=function(e,t,r,n,i){var o,s,c=i*8-n-1,l=(1<<c)-1,h=l>>1,p=-7,x=r?i-1:0,w=r?-1:1,E=e[t+x];for(x+=w,o=E&(1<<-p)-1,E>>=-p,p+=c;p>0;o=o*256+e[t+x],x+=w,p-=8);for(s=o&(1<<-p)-1,o>>=-p,p+=n;p>0;s=s*256+e[t+x],x+=w,p-=8);if(o===0)o=1-h;else{if(o===l)return s?NaN:(E?-1:1)*(1/0);s=s+Math.pow(2,n),o=o-h}return(E?-1:1)*s*Math.pow(2,o-n)};M5.write=function(e,t,r,n,i,o){var s,c,l,h=o*8-i-1,p=(1<<h)-1,x=p>>1,w=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=n?0:o-1,P=n?1:-1,B=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(c=isNaN(t)?1:0,s=p):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+x>=1?t+=w/l:t+=w*Math.pow(2,1-x),t*l>=2&&(s++,l/=2),s+x>=p?(c=0,s=p):s+x>=1?(c=(t*l-1)*Math.pow(2,i),s=s+x):(c=t*Math.pow(2,x-1)*Math.pow(2,i),s=0));i>=8;e[r+E]=c&255,E+=P,c/=256,i-=8);for(s=s<<i|c,h+=i;h>0;e[r+E]=s&255,E+=P,s/=256,h-=8);e[r+E-P]|=B*128}});var Mit=Ye((gBe,Eit)=>{"use strict";Eit.exports=uo;var nI=xit();function uo(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}uo.Varint=0;uo.Fixed64=1;uo.Bytes=2;uo.Fixed32=5;var S5=(1<<16)*(1<<16),vit=1/S5,GBt=12,Tit=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");uo.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=n&7,e(i,t,this),this.pos===o&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=iI(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=wit(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=iI(this.buf,this.pos)+iI(this.buf,this.pos+4)*S5;return this.pos+=8,e},readSFixed64:function(){var e=iI(this.buf,this.pos)+wit(this.buf,this.pos+4)*S5;return this.pos+=8,e},readFloat:function(){var e=nI.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=nI.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t=this.buf,r,n;return n=t[this.pos++],r=n&127,n<128||(n=t[this.pos++],r|=(n&127)<<7,n<128)||(n=t[this.pos++],r|=(n&127)<<14,n<128)||(n=t[this.pos++],r|=(n&127)<<21,n<128)?r:(n=t[this.pos],r|=(n&15)<<28,XBt(r,e,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2===1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=GBt&&Tit?a4t(this.buf,t,e):s4t(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==uo.Bytes)return e.push(this.readVarint(t));var r=_d(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==uo.Bytes)return e.push(this.readSVarint());var t=_d(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==uo.Bytes)return e.push(this.readBoolean());var t=_d(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==uo.Bytes)return e.push(this.readFloat());var t=_d(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==uo.Bytes)return e.push(this.readDouble());var t=_d(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==uo.Bytes)return e.push(this.readFixed32());var t=_d(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==uo.Bytes)return e.push(this.readSFixed32());var t=_d(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==uo.Bytes)return e.push(this.readFixed64());var t=_d(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==uo.Bytes)return e.push(this.readSFixed64());var t=_d(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=e&7;if(t===uo.Varint)for(;this.buf[this.pos++]>127;);else if(t===uo.Bytes)this.pos=this.readVarint()+this.pos;else if(t===uo.Fixed32)this.pos+=4;else if(t===uo.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+t)},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),M1(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),M1(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),M1(this.buf,e&-1,this.pos),M1(this.buf,Math.floor(e*vit),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),M1(this.buf,e&-1,this.pos),M1(this.buf,Math.floor(e*vit),this.pos+4),this.pos+=8},writeVarint:function(e){if(e=+e||0,e>268435455||e<0){YBt(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))},writeSVarint:function(e){this.writeVarint(e<0?-e*2-1:e*2)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(e.length*4),this.pos++;var t=this.pos;this.pos=c4t(this.buf,e,this.pos);var r=this.pos-t;r>=128&&bit(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),nI.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),nI.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&bit(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,uo.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,$Bt,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,QBt,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,e4t,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,JBt,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,t4t,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,r4t,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,n4t,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,i4t,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,o4t,t)},writeBytesField:function(e,t){this.writeTag(e,uo.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,uo.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,uo.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,uo.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,uo.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,uo.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,uo.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,uo.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,uo.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,uo.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};function XBt(e,t,r){var n=r.buf,i,o;if(o=n[r.pos++],i=(o&112)>>4,o<128||(o=n[r.pos++],i|=(o&127)<<3,o<128)||(o=n[r.pos++],i|=(o&127)<<10,o<128)||(o=n[r.pos++],i|=(o&127)<<17,o<128)||(o=n[r.pos++],i|=(o&127)<<24,o<128)||(o=n[r.pos++],i|=(o&1)<<31,o<128))return E1(e,i,t);throw new Error("Expected varint not more than 10 bytes")}function _d(e){return e.type===uo.Bytes?e.readVarint()+e.pos:e.pos+1}function E1(e,t,r){return r?t*4294967296+(e>>>0):(t>>>0)*4294967296+(e>>>0)}function YBt(e,t){var r,n;if(e>=0?(r=e%4294967296|0,n=e/4294967296|0):(r=~(-e%4294967296),n=~(-e/4294967296),r^4294967295?r=r+1|0:(r=0,n=n+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),KBt(r,n,t),ZBt(n,t)}function KBt(e,t,r){r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos]=e&127}function ZBt(e,t){var r=(e&7)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127)))))}function bit(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(Math.LN2*7));r.realloc(n);for(var i=r.pos-1;i>=e;i--)r.buf[i+n]=r.buf[i]}function $Bt(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function QBt(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function JBt(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function t4t(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function e4t(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function r4t(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function n4t(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function i4t(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function o4t(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function iI(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+e[t+3]*16777216}function M1(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function wit(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function s4t(e,t,r){for(var n="",i=t;i<r;){var o=e[i],s=null,c=o>239?4:o>223?3:o>191?2:1;if(i+c>r)break;var l,h,p;c===1?o<128&&(s=o):c===2?(l=e[i+1],(l&192)===128&&(s=(o&31)<<6|l&63,s<=127&&(s=null))):c===3?(l=e[i+1],h=e[i+2],(l&192)===128&&(h&192)===128&&(s=(o&15)<<12|(l&63)<<6|h&63,(s<=2047||s>=55296&&s<=57343)&&(s=null))):c===4&&(l=e[i+1],h=e[i+2],p=e[i+3],(l&192)===128&&(h&192)===128&&(p&192)===128&&(s=(o&15)<<18|(l&63)<<12|(h&63)<<6|p&63,(s<=65535||s>=1114112)&&(s=null))),s===null?(s=65533,c=1):s>65535&&(s-=65536,n+=String.fromCharCode(s>>>10&1023|55296),s=56320|s&1023),n+=String.fromCharCode(s),i+=c}return n}function a4t(e,t,r){return Tit.decode(e.subarray(t,r))}function c4t(e,t,r){for(var n=0,i,o;n<t.length;n++){if(i=t.charCodeAt(n),i>55295&&i<57344)if(o)if(i<56320){e[r++]=239,e[r++]=191,e[r++]=189,o=i;continue}else i=o-55296<<10|i-56320|65536,o=null;else{i>56319||n+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):o=i;continue}else o&&(e[r++]=239,e[r++]=191,e[r++]=189,o=null);i<128?e[r++]=i:(i<2048?e[r++]=i>>6|192:(i<65536?e[r++]=i>>12|224:(e[r++]=i>>18|240,e[r++]=i>>12&63|128),e[r++]=i>>6&63|128),e[r++]=i&63|128)}return r}});var Kit=Ye((zw,fI)=>{(function(e){"use strict";var t="Compound",r="Identifier",n="MemberExpression",i="Literal",o="ThisExpression",s="CallExpression",c="UnaryExpression",l="BinaryExpression",h="LogicalExpression",p="ConditionalExpression",x="ArrayExpression",w=46,E=44,P=39,B=34,D=40,W=41,X=91,q=93,$=63,et=59,F=58,ut=function(Xe,He){var _n=new Error(Xe+" at character "+He);throw _n.index=He,_n.description=Xe,_n},ot=!0,J={"-":ot,"!":ot,"~":ot,"+":ot},G={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},mt=function(Xe){var He=0,_n;for(var dt in Xe)(_n=dt.length)>He&&Xe.hasOwnProperty(dt)&&(He=_n);return He},Mt=mt(J),ct=mt(G),gt={true:!0,false:!1,null:null},ee="this",Ne=function(Xe){return G[Xe]||0},Ue=function(Xe,He,_n){var dt=Xe==="||"||Xe==="&&"?h:l;return{type:dt,operator:Xe,left:He,right:_n}},sr=function(Xe){return Xe>=48&&Xe<=57},gr=function(Xe){return Xe===36||Xe===95||Xe>=65&&Xe<=90||Xe>=97&&Xe<=122||Xe>=128&&!G[String.fromCharCode(Xe)]},Xr=function(Xe){return Xe===36||Xe===95||Xe>=65&&Xe<=90||Xe>=97&&Xe<=122||Xe>=48&&Xe<=57||Xe>=128&&!G[String.fromCharCode(Xe)]},ir=function(Xe){for(var He=0,_n=Xe.charAt,dt=Xe.charCodeAt,wt=function(ar){return _n.call(Xe,ar)},Ht=function(ar){return dt.call(Xe,ar)},ue=Xe.length,Le=function(){for(var ar=Ht(He);ar===32||ar===9||ar===10||ar===13;)ar=Ht(++He)},Ee=function(){var ar=bn(),zr,hn;if(Le(),Ht(He)===$){if(He++,zr=Ee(),zr||ut("Expected expression",He),Le(),Ht(He)===F)return He++,hn=Ee(),hn||ut("Expected expression",He),{type:p,test:ar,consequent:zr,alternate:hn};ut("Expected :",He)}else return ar},Jr=function(){Le();for(var ar,zr=Xe.substr(He,ct),hn=zr.length;hn>0;){if(G.hasOwnProperty(zr)&&(!gr(Ht(He))||He+zr.length<Xe.length&&!Xr(Ht(He+zr.length))))return He+=hn,zr;zr=zr.substr(0,--hn)}return!1},bn=function(){var ar,zr,hn,ho,ki,ds,es,rs,No,ha;if(es=ai(),hn=Jr(),!hn)return es;for(ds={value:hn,prec:Ne(hn)},rs=ai(),rs||ut("Expected expression after "+hn,He),ki=[es,ds,rs];(hn=Jr())&&(ho=Ne(hn),ho!==0);){for(ds={value:hn,prec:ho},ha=hn;ki.length>2&&ho<=ki[ki.length-2].prec;)rs=ki.pop(),hn=ki.pop().value,es=ki.pop(),zr=Ue(hn,es,rs),ki.push(zr);zr=ai(),zr||ut("Expected expression after "+ha,He),ki.push(ds,zr)}for(No=ki.length-1,zr=ki[No];No>1;)zr=Ue(ki[No-1].value,ki[No-2],zr),No-=2;return zr},ai=function(){var ar,zr,hn;if(Le(),ar=Ht(He),sr(ar)||ar===w)return qo();if(ar===P||ar===B)return _i();if(ar===X)return Cn();for(zr=Xe.substr(He,Mt),hn=zr.length;hn>0;){if(J.hasOwnProperty(zr)&&(!gr(Ht(He))||He+zr.length<Xe.length&&!Xr(Ht(He+zr.length))))return He+=hn,{type:c,operator:zr,argument:ai(),prefix:!0};zr=zr.substr(0,--hn)}return gr(ar)||ar===D?bs():!1},qo=function(){for(var ar="",zr,hn;sr(Ht(He));)ar+=wt(He++);if(Ht(He)===w)for(ar+=wt(He++);sr(Ht(He));)ar+=wt(He++);if(zr=wt(He),zr==="e"||zr==="E"){for(ar+=wt(He++),zr=wt(He),(zr==="+"||zr==="-")&&(ar+=wt(He++));sr(Ht(He));)ar+=wt(He++);sr(Ht(He-1))||ut("Expected exponent ("+ar+wt(He)+")",He)}return hn=Ht(He),gr(hn)?ut("Variable names cannot start with a number ("+ar+wt(He)+")",He):hn===w&&ut("Unexpected period",He),{type:i,value:parseFloat(ar),raw:ar}},_i=function(){for(var ar="",zr=wt(He++),hn=!1,ho;He<ue;)if(ho=wt(He++),ho===zr){hn=!0;break}else if(ho==="\\")switch(ho=wt(He++),ho){case"n":ar+=`
`;break;case"r":ar+="\r";break;case"t":ar+="	";break;case"b":ar+="\b";break;case"f":ar+="\f";break;case"v":ar+="\v";break;default:ar+=ho}else ar+=ho;return hn||ut('Unclosed quote after "'+ar+'"',He),{type:i,value:ar,raw:zr+ar+zr}},Xn=function(){var ar=Ht(He),zr=He,hn;for(gr(ar)?He++:ut("Unexpected "+wt(He),He);He<ue&&(ar=Ht(He),Xr(ar));)He++;return hn=Xe.slice(zr,He),gt.hasOwnProperty(hn)?{type:i,value:gt[hn],raw:hn}:hn===ee?{type:o}:{type:r,name:hn}},Ui=function(ar){for(var zr,hn=[],ho,ki=!1,ds=0;He<ue;)if(Le(),zr=Ht(He),zr===ar){ki=!0,He++,ar===W&&ds&&ds>=hn.length&&ut("Unexpected token "+String.fromCharCode(ar),He);break}else if(zr===E){if(He++,ds++,ds!==hn.length){if(ar===W)ut("Unexpected token ,",He);else if(ar===q)for(var es=hn.length;es<ds;es++)hn.push(null)}}else ho=Ee(),(!ho||ho.type===t)&&ut("Expected comma",He),hn.push(ho);return ki||ut("Expected "+String.fromCharCode(ar),He),hn},bs=function(){var ar,zr;for(ar=Ht(He),ar===D?zr=Vi():zr=Xn(),Le(),ar=Ht(He);ar===w||ar===X||ar===D;)He++,ar===w?(Le(),zr={type:n,computed:!1,object:zr,property:Xn()}):ar===X?(zr={type:n,computed:!0,object:zr,property:Ee()},Le(),ar=Ht(He),ar!==q&&ut("Unclosed [",He),He++):ar===D&&(zr={type:s,arguments:Ui(W),callee:zr}),Le(),ar=Ht(He);return zr},Vi=function(){He++;var ar=Ee();if(Le(),Ht(He)===W)return He++,ar;ut("Unclosed (",He)},Cn=function(){return He++,{type:x,elements:Ui(q)}},yi=[],_o,Nr;He<ue;)_o=Ht(He),_o===et||_o===E?He++:(Nr=Ee())?yi.push(Nr):He<ue&&ut('Unexpected "'+wt(He)+'"',He);return yi.length===1?yi[0]:{type:t,body:yi}};if(ir.version="0.3.5",ir.toString=function(){return"JavaScript Expression Parser (JSEP) v"+ir.version},ir.addUnaryOp=function(Xe){return Mt=Math.max(Xe.length,Mt),J[Xe]=ot,this},ir.addBinaryOp=function(Xe,He){return ct=Math.max(Xe.length,ct),G[Xe]=He,this},ir.addLiteral=function(Xe,He){return gt[Xe]=He,this},ir.removeUnaryOp=function(Xe){return delete J[Xe],Xe.length===Mt&&(Mt=mt(J)),this},ir.removeAllUnaryOps=function(){return J={},Mt=0,this},ir.removeBinaryOp=function(Xe){return delete G[Xe],Xe.length===ct&&(ct=mt(G)),this},ir.removeAllBinaryOps=function(){return G={},ct=0,this},ir.removeLiteral=function(Xe){return delete gt[Xe],this},ir.removeAllLiterals=function(){return gt={},this},typeof zw>"u"){var on=e.jsep;e.jsep=ir,ir.noConflict=function(){return e.jsep===ir&&(e.jsep=on),ir}}else typeof fI<"u"&&fI.exports?zw=fI.exports=ir:zw.parse=ir})(zw)});var Tot=Ye(EI=>{"use strict";EI.byteLength=TDt;EI.toByteArray=MDt;EI.fromByteArray=PDt;var sp=[],oh=[],wDt=typeof Uint8Array<"u"?Uint8Array:Array,r6="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(hg=0,bot=r6.length;hg<bot;++hg)sp[hg]=r6[hg],oh[r6.charCodeAt(hg)]=hg;var hg,bot;oh["-".charCodeAt(0)]=62;oh["_".charCodeAt(0)]=63;function wot(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");r===-1&&(r=t);var n=r===t?0:4-r%4;return[r,n]}function TDt(e){var t=wot(e),r=t[0],n=t[1];return(r+n)*3/4-n}function EDt(e,t,r){return(t+r)*3/4-r}function MDt(e){var t,r=wot(e),n=r[0],i=r[1],o=new wDt(EDt(e,n,i)),s=0,c=i>0?n-4:n,l;for(l=0;l<c;l+=4)t=oh[e.charCodeAt(l)]<<18|oh[e.charCodeAt(l+1)]<<12|oh[e.charCodeAt(l+2)]<<6|oh[e.charCodeAt(l+3)],o[s++]=t>>16&255,o[s++]=t>>8&255,o[s++]=t&255;return i===2&&(t=oh[e.charCodeAt(l)]<<2|oh[e.charCodeAt(l+1)]>>4,o[s++]=t&255),i===1&&(t=oh[e.charCodeAt(l)]<<10|oh[e.charCodeAt(l+1)]<<4|oh[e.charCodeAt(l+2)]>>2,o[s++]=t>>8&255,o[s++]=t&255),o}function SDt(e){return sp[e>>18&63]+sp[e>>12&63]+sp[e>>6&63]+sp[e&63]}function CDt(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(e[o+2]&255),i.push(SDt(n));return i.join("")}function PDt(e){for(var t,r=e.length,n=r%3,i=[],o=16383,s=0,c=r-n;s<c;s+=o)i.push(CDt(e,s,s+o>c?c:s+o));return n===1?(t=e[r-1],i.push(sp[t>>2]+sp[t<<4&63]+"==")):n===2&&(t=(e[r-2]<<8)+e[r-1],i.push(sp[t>>10]+sp[t>>4&63]+sp[t<<2&63]+"=")),i.join("")}});var B1=Ye((MI,Eot)=>{(function(e,t){typeof MI=="object"&&typeof Eot<"u"?t(MI):typeof define=="function"&&define.amd?define(["exports"],t):(e=typeof globalThis<"u"?globalThis:e||self,t(e.lumino_coreutils={}))})(MI,function(e){"use strict";e.JSONExt=void 0,function(s){s.emptyObject=Object.freeze({}),s.emptyArray=Object.freeze([]);function c(D){return D===null||typeof D=="boolean"||typeof D=="number"||typeof D=="string"}s.isPrimitive=c;function l(D){return Array.isArray(D)}s.isArray=l;function h(D){return!c(D)&&!l(D)}s.isObject=h;function p(D,W){if(D===W)return!0;if(c(D)||c(W))return!1;var X=l(D),q=l(W);return X!==q?!1:X&&q?w(D,W):E(D,W)}s.deepEqual=p;function x(D){return c(D)?D:l(D)?P(D):B(D)}s.deepCopy=x;function w(D,W){if(D===W)return!0;if(D.length!==W.length)return!1;for(var X=0,q=D.length;X<q;++X)if(!p(D[X],W[X]))return!1;return!0}function E(D,W){if(D===W)return!0;for(var X in D)if(D[X]!==void 0&&!(X in W))return!1;for(var X in W)if(W[X]!==void 0&&!(X in D))return!1;for(var X in D){var q=D[X],$=W[X];if(!(q===void 0&&$===void 0)&&(q===void 0||$===void 0||!p(q,$)))return!1}return!0}function P(D){for(var W=new Array(D.length),X=0,q=D.length;X<q;++X)W[X]=x(D[X]);return W}function B(D){var W={};for(var X in D){var q=D[X];q!==void 0&&(W[X]=x(q))}return W}}(e.JSONExt||(e.JSONExt={}));var t=function(){function s(){this._types=[],this._values=[]}return s.prototype.types=function(){return this._types.slice()},s.prototype.hasData=function(c){return this._types.indexOf(c)!==-1},s.prototype.getData=function(c){var l=this._types.indexOf(c);return l!==-1?this._values[l]:void 0},s.prototype.setData=function(c,l){this.clearData(c),this._types.push(c),this._values.push(l)},s.prototype.clearData=function(c){var l=this._types.indexOf(c);l!==-1&&(this._types.splice(l,1),this._values.splice(l,1))},s.prototype.clear=function(){this._types.length=0,this._values.length=0},s}(),r=function(){function s(){var c=this;this.promise=new Promise(function(l,h){c._resolve=l,c._reject=h})}return s.prototype.resolve=function(c){var l=this._resolve;l(c)},s.prototype.reject=function(c){var l=this._reject;l(c)},s}(),n=function(){function s(c){this.name=c,this._tokenStructuralPropertyT=null}return s}();function i(s){for(var c=0,l=0,h=s.length;l<h;++l)l%4===0&&(c=Math.random()*4294967295>>>0),s[l]=c&255,c>>>=8}e.Random=void 0,function(s){s.getRandomValues=function(){var c=typeof window<"u"&&(window.crypto||window.msCrypto)||null;return c&&typeof c.getRandomValues=="function"?function(h){return c.getRandomValues(h)}:i}()}(e.Random||(e.Random={}));function o(s){for(var c=new Uint8Array(16),l=new Array(256),h=0;h<16;++h)l[h]="0"+h.toString(16);for(var h=16;h<256;++h)l[h]=h.toString(16);return function(){return s(c),c[6]=64|c[6]&15,c[8]=128|c[8]&63,l[c[0]]+l[c[1]]+l[c[2]]+l[c[3]]+"-"+l[c[4]]+l[c[5]]+"-"+l[c[6]]+l[c[7]]+"-"+l[c[8]]+l[c[9]]+"-"+l[c[10]]+l[c[11]]+l[c[12]]+l[c[13]]+l[c[14]]+l[c[15]]}}e.UUID=void 0,function(s){s.uuid4=o(e.Random.getRandomValues)}(e.UUID||(e.UUID={})),e.MimeData=t,e.PromiseDelegate=r,e.Token=n,Object.defineProperty(e,"__esModule",{value:!0})})});var Sot=Ye((fNe,Mot)=>{function IDt(){this.__data__=[],this.size=0}Mot.exports=IDt});var n6=Ye((pNe,Cot)=>{function RDt(e,t){return e===t||e!==e&&t!==t}Cot.exports=RDt});var jw=Ye((dNe,Pot)=>{var LDt=n6();function ODt(e,t){for(var r=e.length;r--;)if(LDt(e[r][0],t))return r;return-1}Pot.exports=ODt});var Rot=Ye((mNe,Iot)=>{var BDt=jw(),DDt=Array.prototype,NDt=DDt.splice;function kDt(e){var t=this.__data__,r=BDt(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():NDt.call(t,r,1),--this.size,!0}Iot.exports=kDt});var Oot=Ye((ANe,Lot)=>{var FDt=jw();function zDt(e){var t=this.__data__,r=FDt(t,e);return r<0?void 0:t[r][1]}Lot.exports=zDt});var Dot=Ye((gNe,Bot)=>{var UDt=jw();function VDt(e){return UDt(this.__data__,e)>-1}Bot.exports=VDt});var kot=Ye((_Ne,Not)=>{var jDt=jw();function HDt(e,t){var r=this.__data__,n=jDt(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}Not.exports=HDt});var Hw=Ye((yNe,Fot)=>{var WDt=Sot(),qDt=Rot(),GDt=Oot(),XDt=Dot(),YDt=kot();function D1(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}D1.prototype.clear=WDt;D1.prototype.delete=qDt;D1.prototype.get=GDt;D1.prototype.has=XDt;D1.prototype.set=YDt;Fot.exports=D1});var Uot=Ye((xNe,zot)=>{var KDt=Hw();function ZDt(){this.__data__=new KDt,this.size=0}zot.exports=ZDt});var jot=Ye((vNe,Vot)=>{function $Dt(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}Vot.exports=$Dt});var Wot=Ye((bNe,Hot)=>{function QDt(e){return this.__data__.get(e)}Hot.exports=QDt});var Got=Ye((wNe,qot)=>{function JDt(e){return this.__data__.has(e)}qot.exports=JDt});var i6=Ye((TNe,Xot)=>{var tNt=typeof global=="object"&&global&&global.Object===Object&&global;Xot.exports=tNt});var ap=Ye((ENe,Yot)=>{var eNt=i6(),rNt=typeof self=="object"&&self&&self.Object===Object&&self,nNt=eNt||rNt||Function("return this")();Yot.exports=nNt});var SI=Ye((MNe,Kot)=>{var iNt=ap(),oNt=iNt.Symbol;Kot.exports=oNt});var Jot=Ye((SNe,Qot)=>{var Zot=SI(),$ot=Object.prototype,sNt=$ot.hasOwnProperty,aNt=$ot.toString,Ww=Zot?Zot.toStringTag:void 0;function cNt(e){var t=sNt.call(e,Ww),r=e[Ww];try{e[Ww]=void 0;var n=!0}catch{}var i=aNt.call(e);return n&&(t?e[Ww]=r:delete e[Ww]),i}Qot.exports=cNt});var est=Ye((CNe,tst)=>{var lNt=Object.prototype,uNt=lNt.toString;function hNt(e){return uNt.call(e)}tst.exports=hNt});var N1=Ye((PNe,ist)=>{var rst=SI(),fNt=Jot(),pNt=est(),dNt="[object Null]",mNt="[object Undefined]",nst=rst?rst.toStringTag:void 0;function ANt(e){return e==null?e===void 0?mNt:dNt:nst&&nst in Object(e)?fNt(e):pNt(e)}ist.exports=ANt});var o6=Ye((INe,ost)=>{function gNt(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}ost.exports=gNt});var s6=Ye((RNe,sst)=>{var _Nt=N1(),yNt=o6(),xNt="[object AsyncFunction]",vNt="[object Function]",bNt="[object GeneratorFunction]",wNt="[object Proxy]";function TNt(e){if(!yNt(e))return!1;var t=_Nt(e);return t==vNt||t==bNt||t==xNt||t==wNt}sst.exports=TNt});var cst=Ye((LNe,ast)=>{var ENt=ap(),MNt=ENt["__core-js_shared__"];ast.exports=MNt});var hst=Ye((ONe,ust)=>{var a6=cst(),lst=function(){var e=/[^.]+$/.exec(a6&&a6.keys&&a6.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function SNt(e){return!!lst&&lst in e}ust.exports=SNt});var c6=Ye((BNe,fst)=>{var CNt=Function.prototype,PNt=CNt.toString;function INt(e){if(e!=null){try{return PNt.call(e)}catch{}try{return e+""}catch{}}return""}fst.exports=INt});var dst=Ye((DNe,pst)=>{var RNt=s6(),LNt=hst(),ONt=o6(),BNt=c6(),DNt=/[\\^$.*+?()[\]{}|]/g,NNt=/^\[object .+?Constructor\]$/,kNt=Function.prototype,FNt=Object.prototype,zNt=kNt.toString,UNt=FNt.hasOwnProperty,VNt=RegExp("^"+zNt.call(UNt).replace(DNt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function jNt(e){if(!ONt(e)||LNt(e))return!1;var t=RNt(e)?VNt:NNt;return t.test(BNt(e))}pst.exports=jNt});var Ast=Ye((NNe,mst)=>{function HNt(e,t){return e?.[t]}mst.exports=HNt});var fg=Ye((kNe,gst)=>{var WNt=dst(),qNt=Ast();function GNt(e,t){var r=qNt(e,t);return WNt(r)?r:void 0}gst.exports=GNt});var CI=Ye((FNe,_st)=>{var XNt=fg(),YNt=ap(),KNt=XNt(YNt,"Map");_st.exports=KNt});var qw=Ye((zNe,yst)=>{var ZNt=fg(),$Nt=ZNt(Object,"create");yst.exports=$Nt});var bst=Ye((UNe,vst)=>{var xst=qw();function QNt(){this.__data__=xst?xst(null):{},this.size=0}vst.exports=QNt});var Tst=Ye((VNe,wst)=>{function JNt(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}wst.exports=JNt});var Mst=Ye((jNe,Est)=>{var tkt=qw(),ekt="__lodash_hash_undefined__",rkt=Object.prototype,nkt=rkt.hasOwnProperty;function ikt(e){var t=this.__data__;if(tkt){var r=t[e];return r===ekt?void 0:r}return nkt.call(t,e)?t[e]:void 0}Est.exports=ikt});var Cst=Ye((HNe,Sst)=>{var okt=qw(),skt=Object.prototype,akt=skt.hasOwnProperty;function ckt(e){var t=this.__data__;return okt?t[e]!==void 0:akt.call(t,e)}Sst.exports=ckt});var Ist=Ye((WNe,Pst)=>{var lkt=qw(),ukt="__lodash_hash_undefined__";function hkt(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=lkt&&t===void 0?ukt:t,this}Pst.exports=hkt});var Lst=Ye((qNe,Rst)=>{var fkt=bst(),pkt=Tst(),dkt=Mst(),mkt=Cst(),Akt=Ist();function k1(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}k1.prototype.clear=fkt;k1.prototype.delete=pkt;k1.prototype.get=dkt;k1.prototype.has=mkt;k1.prototype.set=Akt;Rst.exports=k1});var Dst=Ye((GNe,Bst)=>{var Ost=Lst(),gkt=Hw(),_kt=CI();function ykt(){this.size=0,this.__data__={hash:new Ost,map:new(_kt||gkt),string:new Ost}}Bst.exports=ykt});var kst=Ye((XNe,Nst)=>{function xkt(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}Nst.exports=xkt});var Gw=Ye((YNe,Fst)=>{var vkt=kst();function bkt(e,t){var r=e.__data__;return vkt(t)?r[typeof t=="string"?"string":"hash"]:r.map}Fst.exports=bkt});var Ust=Ye((KNe,zst)=>{var wkt=Gw();function Tkt(e){var t=wkt(this,e).delete(e);return this.size-=t?1:0,t}zst.exports=Tkt});var jst=Ye((ZNe,Vst)=>{var Ekt=Gw();function Mkt(e){return Ekt(this,e).get(e)}Vst.exports=Mkt});var Wst=Ye(($Ne,Hst)=>{var Skt=Gw();function Ckt(e){return Skt(this,e).has(e)}Hst.exports=Ckt});var Gst=Ye((QNe,qst)=>{var Pkt=Gw();function Ikt(e,t){var r=Pkt(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}qst.exports=Ikt});var l6=Ye((JNe,Xst)=>{var Rkt=Dst(),Lkt=Ust(),Okt=jst(),Bkt=Wst(),Dkt=Gst();function F1(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}F1.prototype.clear=Rkt;F1.prototype.delete=Lkt;F1.prototype.get=Okt;F1.prototype.has=Bkt;F1.prototype.set=Dkt;Xst.exports=F1});var Kst=Ye((tke,Yst)=>{var Nkt=Hw(),kkt=CI(),Fkt=l6(),zkt=200;function Ukt(e,t){var r=this.__data__;if(r instanceof Nkt){var n=r.__data__;if(!kkt||n.length<zkt-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Fkt(n)}return r.set(e,t),this.size=r.size,this}Yst.exports=Ukt});var $st=Ye((eke,Zst)=>{var Vkt=Hw(),jkt=Uot(),Hkt=jot(),Wkt=Wot(),qkt=Got(),Gkt=Kst();function z1(e){var t=this.__data__=new Vkt(e);this.size=t.size}z1.prototype.clear=jkt;z1.prototype.delete=Hkt;z1.prototype.get=Wkt;z1.prototype.has=qkt;z1.prototype.set=Gkt;Zst.exports=z1});var Jst=Ye((rke,Qst)=>{var Xkt="__lodash_hash_undefined__";function Ykt(e){return this.__data__.set(e,Xkt),this}Qst.exports=Ykt});var eat=Ye((nke,tat)=>{function Kkt(e){return this.__data__.has(e)}tat.exports=Kkt});var nat=Ye((ike,rat)=>{var Zkt=l6(),$kt=Jst(),Qkt=eat();function PI(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Zkt;++t<r;)this.add(e[t])}PI.prototype.add=PI.prototype.push=$kt;PI.prototype.has=Qkt;rat.exports=PI});var oat=Ye((oke,iat)=>{function Jkt(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}iat.exports=Jkt});var aat=Ye((ske,sat)=>{function tFt(e,t){return e.has(t)}sat.exports=tFt});var u6=Ye((ake,cat)=>{var eFt=nat(),rFt=oat(),nFt=aat(),iFt=1,oFt=2;function sFt(e,t,r,n,i,o){var s=r&iFt,c=e.length,l=t.length;if(c!=l&&!(s&&l>c))return!1;var h=o.get(e),p=o.get(t);if(h&&p)return h==t&&p==e;var x=-1,w=!0,E=r&oFt?new eFt:void 0;for(o.set(e,t),o.set(t,e);++x<c;){var P=e[x],B=t[x];if(n)var D=s?n(B,P,x,t,e,o):n(P,B,x,e,t,o);if(D!==void 0){if(D)continue;w=!1;break}if(E){if(!rFt(t,function(W,X){if(!nFt(E,X)&&(P===W||i(P,W,r,n,o)))return E.push(X)})){w=!1;break}}else if(!(P===B||i(P,B,r,n,o))){w=!1;break}}return o.delete(e),o.delete(t),w}cat.exports=sFt});var uat=Ye((cke,lat)=>{var aFt=ap(),cFt=aFt.Uint8Array;lat.exports=cFt});var fat=Ye((lke,hat)=>{function lFt(e){var t=-1,r=Array(e.size);return e.forEach(function(n,i){r[++t]=[i,n]}),r}hat.exports=lFt});var dat=Ye((uke,pat)=>{function uFt(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}pat.exports=uFt});var yat=Ye((hke,_at)=>{var mat=SI(),Aat=uat(),hFt=n6(),fFt=u6(),pFt=fat(),dFt=dat(),mFt=1,AFt=2,gFt="[object Boolean]",_Ft="[object Date]",yFt="[object Error]",xFt="[object Map]",vFt="[object Number]",bFt="[object RegExp]",wFt="[object Set]",TFt="[object String]",EFt="[object Symbol]",MFt="[object ArrayBuffer]",SFt="[object DataView]",gat=mat?mat.prototype:void 0,h6=gat?gat.valueOf:void 0;function CFt(e,t,r,n,i,o,s){switch(r){case SFt:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case MFt:return!(e.byteLength!=t.byteLength||!o(new Aat(e),new Aat(t)));case gFt:case _Ft:case vFt:return hFt(+e,+t);case yFt:return e.name==t.name&&e.message==t.message;case bFt:case TFt:return e==t+"";case xFt:var c=pFt;case wFt:var l=n&mFt;if(c||(c=dFt),e.size!=t.size&&!l)return!1;var h=s.get(e);if(h)return h==t;n|=AFt,s.set(e,t);var p=fFt(c(e),c(t),n,i,o,s);return s.delete(e),p;case EFt:if(h6)return h6.call(e)==h6.call(t)}return!1}_at.exports=CFt});var vat=Ye((fke,xat)=>{function PFt(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}xat.exports=PFt});var II=Ye((pke,bat)=>{var IFt=Array.isArray;bat.exports=IFt});var Tat=Ye((dke,wat)=>{var RFt=vat(),LFt=II();function OFt(e,t,r){var n=t(e);return LFt(e)?n:RFt(n,r(e))}wat.exports=OFt});var Mat=Ye((mke,Eat)=>{function BFt(e,t){for(var r=-1,n=e==null?0:e.length,i=0,o=[];++r<n;){var s=e[r];t(s,r,e)&&(o[i++]=s)}return o}Eat.exports=BFt});var Cat=Ye((Ake,Sat)=>{function DFt(){return[]}Sat.exports=DFt});var Rat=Ye((gke,Iat)=>{var NFt=Mat(),kFt=Cat(),FFt=Object.prototype,zFt=FFt.propertyIsEnumerable,Pat=Object.getOwnPropertySymbols,UFt=Pat?function(e){return e==null?[]:(e=Object(e),NFt(Pat(e),function(t){return zFt.call(e,t)}))}:kFt;Iat.exports=UFt});var Oat=Ye((_ke,Lat)=>{function VFt(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}Lat.exports=VFt});var U1=Ye((yke,Bat)=>{function jFt(e){return e!=null&&typeof e=="object"}Bat.exports=jFt});var Nat=Ye((xke,Dat)=>{var HFt=N1(),WFt=U1(),qFt="[object Arguments]";function GFt(e){return WFt(e)&&HFt(e)==qFt}Dat.exports=GFt});var Uat=Ye((vke,zat)=>{var kat=Nat(),XFt=U1(),Fat=Object.prototype,YFt=Fat.hasOwnProperty,KFt=Fat.propertyIsEnumerable,ZFt=kat(function(){return arguments}())?kat:function(e){return XFt(e)&&YFt.call(e,"callee")&&!KFt.call(e,"callee")};zat.exports=ZFt});var jat=Ye((bke,Vat)=>{function $Ft(){return!1}Vat.exports=$Ft});var f6=Ye((Xw,V1)=>{var QFt=ap(),JFt=jat(),qat=typeof Xw=="object"&&Xw&&!Xw.nodeType&&Xw,Hat=qat&&typeof V1=="object"&&V1&&!V1.nodeType&&V1,t5t=Hat&&Hat.exports===qat,Wat=t5t?QFt.Buffer:void 0,e5t=Wat?Wat.isBuffer:void 0,r5t=e5t||JFt;V1.exports=r5t});var Xat=Ye((wke,Gat)=>{var n5t=9007199254740991,i5t=/^(?:0|[1-9]\d*)$/;function o5t(e,t){var r=typeof e;return t=t??n5t,!!t&&(r=="number"||r!="symbol"&&i5t.test(e))&&e>-1&&e%1==0&&e<t}Gat.exports=o5t});var p6=Ye((Tke,Yat)=>{var s5t=9007199254740991;function a5t(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=s5t}Yat.exports=a5t});var Zat=Ye((Eke,Kat)=>{var c5t=N1(),l5t=p6(),u5t=U1(),h5t="[object Arguments]",f5t="[object Array]",p5t="[object Boolean]",d5t="[object Date]",m5t="[object Error]",A5t="[object Function]",g5t="[object Map]",_5t="[object Number]",y5t="[object Object]",x5t="[object RegExp]",v5t="[object Set]",b5t="[object String]",w5t="[object WeakMap]",T5t="[object ArrayBuffer]",E5t="[object DataView]",M5t="[object Float32Array]",S5t="[object Float64Array]",C5t="[object Int8Array]",P5t="[object Int16Array]",I5t="[object Int32Array]",R5t="[object Uint8Array]",L5t="[object Uint8ClampedArray]",O5t="[object Uint16Array]",B5t="[object Uint32Array]",fs={};fs[M5t]=fs[S5t]=fs[C5t]=fs[P5t]=fs[I5t]=fs[R5t]=fs[L5t]=fs[O5t]=fs[B5t]=!0;fs[h5t]=fs[f5t]=fs[T5t]=fs[p5t]=fs[E5t]=fs[d5t]=fs[m5t]=fs[A5t]=fs[g5t]=fs[_5t]=fs[y5t]=fs[x5t]=fs[v5t]=fs[b5t]=fs[w5t]=!1;function D5t(e){return u5t(e)&&l5t(e.length)&&!!fs[c5t(e)]}Kat.exports=D5t});var Qat=Ye((Mke,$at)=>{function N5t(e){return function(t){return e(t)}}$at.exports=N5t});var tct=Ye((Yw,j1)=>{var k5t=i6(),Jat=typeof Yw=="object"&&Yw&&!Yw.nodeType&&Yw,Kw=Jat&&typeof j1=="object"&&j1&&!j1.nodeType&&j1,F5t=Kw&&Kw.exports===Jat,d6=F5t&&k5t.process,z5t=function(){try{var e=Kw&&Kw.require&&Kw.require("util").types;return e||d6&&d6.binding&&d6.binding("util")}catch{}}();j1.exports=z5t});var m6=Ye((Ske,nct)=>{var U5t=Zat(),V5t=Qat(),ect=tct(),rct=ect&&ect.isTypedArray,j5t=rct?V5t(rct):U5t;nct.exports=j5t});var oct=Ye((Cke,ict)=>{var H5t=Oat(),W5t=Uat(),q5t=II(),G5t=f6(),X5t=Xat(),Y5t=m6(),K5t=Object.prototype,Z5t=K5t.hasOwnProperty;function $5t(e,t){var r=q5t(e),n=!r&&W5t(e),i=!r&&!n&&G5t(e),o=!r&&!n&&!i&&Y5t(e),s=r||n||i||o,c=s?H5t(e.length,String):[],l=c.length;for(var h in e)(t||Z5t.call(e,h))&&!(s&&(h=="length"||i&&(h=="offset"||h=="parent")||o&&(h=="buffer"||h=="byteLength"||h=="byteOffset")||X5t(h,l)))&&c.push(h);return c}ict.exports=$5t});var act=Ye((Pke,sct)=>{var Q5t=Object.prototype;function J5t(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Q5t;return e===r}sct.exports=J5t});var A6=Ye((Ike,cct)=>{function t6t(e,t){return function(r){return e(t(r))}}cct.exports=t6t});var uct=Ye((Rke,lct)=>{var e6t=A6(),r6t=e6t(Object.keys,Object);lct.exports=r6t});var fct=Ye((Lke,hct)=>{var n6t=act(),i6t=uct(),o6t=Object.prototype,s6t=o6t.hasOwnProperty;function a6t(e){if(!n6t(e))return i6t(e);var t=[];for(var r in Object(e))s6t.call(e,r)&&r!="constructor"&&t.push(r);return t}hct.exports=a6t});var dct=Ye((Oke,pct)=>{var c6t=s6(),l6t=p6();function u6t(e){return e!=null&&l6t(e.length)&&!c6t(e)}pct.exports=u6t});var Act=Ye((Bke,mct)=>{var h6t=oct(),f6t=fct(),p6t=dct();function d6t(e){return p6t(e)?h6t(e):f6t(e)}mct.exports=d6t});var _ct=Ye((Dke,gct)=>{var m6t=Tat(),A6t=Rat(),g6t=Act();function _6t(e){return m6t(e,g6t,A6t)}gct.exports=_6t});var vct=Ye((Nke,xct)=>{var yct=_ct(),y6t=1,x6t=Object.prototype,v6t=x6t.hasOwnProperty;function b6t(e,t,r,n,i,o){var s=r&y6t,c=yct(e),l=c.length,h=yct(t),p=h.length;if(l!=p&&!s)return!1;for(var x=l;x--;){var w=c[x];if(!(s?w in t:v6t.call(t,w)))return!1}var E=o.get(e),P=o.get(t);if(E&&P)return E==t&&P==e;var B=!0;o.set(e,t),o.set(t,e);for(var D=s;++x<l;){w=c[x];var W=e[w],X=t[w];if(n)var q=s?n(X,W,w,t,e,o):n(W,X,w,e,t,o);if(!(q===void 0?W===X||i(W,X,r,n,o):q)){B=!1;break}D||(D=w=="constructor")}if(B&&!D){var $=e.constructor,et=t.constructor;$!=et&&"constructor"in e&&"constructor"in t&&!(typeof $=="function"&&$ instanceof $&&typeof et=="function"&&et instanceof et)&&(B=!1)}return o.delete(e),o.delete(t),B}xct.exports=b6t});var wct=Ye((kke,bct)=>{var w6t=fg(),T6t=ap(),E6t=w6t(T6t,"DataView");bct.exports=E6t});var Ect=Ye((Fke,Tct)=>{var M6t=fg(),S6t=ap(),C6t=M6t(S6t,"Promise");Tct.exports=C6t});var Sct=Ye((zke,Mct)=>{var P6t=fg(),I6t=ap(),R6t=P6t(I6t,"Set");Mct.exports=R6t});var Pct=Ye((Uke,Cct)=>{var L6t=fg(),O6t=ap(),B6t=L6t(O6t,"WeakMap");Cct.exports=B6t});var kct=Ye((Vke,Nct)=>{var g6=wct(),_6=CI(),y6=Ect(),x6=Sct(),v6=Pct(),Dct=N1(),H1=c6(),Ict="[object Map]",D6t="[object Object]",Rct="[object Promise]",Lct="[object Set]",Oct="[object WeakMap]",Bct="[object DataView]",N6t=H1(g6),k6t=H1(_6),F6t=H1(y6),z6t=H1(x6),U6t=H1(v6),pg=Dct;(g6&&pg(new g6(new ArrayBuffer(1)))!=Bct||_6&&pg(new _6)!=Ict||y6&&pg(y6.resolve())!=Rct||x6&&pg(new x6)!=Lct||v6&&pg(new v6)!=Oct)&&(pg=function(e){var t=Dct(e),r=t==D6t?e.constructor:void 0,n=r?H1(r):"";if(n)switch(n){case N6t:return Bct;case k6t:return Ict;case F6t:return Rct;case z6t:return Lct;case U6t:return Oct}return t});Nct.exports=pg});var qct=Ye((jke,Wct)=>{var b6=$st(),V6t=u6(),j6t=yat(),H6t=vct(),Fct=kct(),zct=II(),Uct=f6(),W6t=m6(),q6t=1,Vct="[object Arguments]",jct="[object Array]",RI="[object Object]",G6t=Object.prototype,Hct=G6t.hasOwnProperty;function X6t(e,t,r,n,i,o){var s=zct(e),c=zct(t),l=s?jct:Fct(e),h=c?jct:Fct(t);l=l==Vct?RI:l,h=h==Vct?RI:h;var p=l==RI,x=h==RI,w=l==h;if(w&&Uct(e)){if(!Uct(t))return!1;s=!0,p=!1}if(w&&!p)return o||(o=new b6),s||W6t(e)?V6t(e,t,r,n,i,o):j6t(e,t,l,r,n,i,o);if(!(r&q6t)){var E=p&&Hct.call(e,"__wrapped__"),P=x&&Hct.call(t,"__wrapped__");if(E||P){var B=E?e.value():e,D=P?t.value():t;return o||(o=new b6),i(B,D,r,n,o)}}return w?(o||(o=new b6),H6t(e,t,r,n,i,o)):!1}Wct.exports=X6t});var Kct=Ye((Hke,Yct)=>{var Y6t=qct(),Gct=U1();function Xct(e,t,r,n,i){return e===t?!0:e==null||t==null||!Gct(e)&&!Gct(t)?e!==e&&t!==t:Y6t(e,t,r,n,Xct,i)}Yct.exports=Xct});var $ct=Ye((Wke,Zct)=>{var K6t=Kct();function Z6t(e,t){return K6t(e,t)}Zct.exports=Z6t});var Jct=Ye((qke,Qct)=>{var $6t=A6(),Q6t=$6t(Object.getPrototypeOf,Object);Qct.exports=Q6t});var rlt=Ye((Gke,elt)=>{var J6t=N1(),tzt=Jct(),ezt=U1(),rzt="[object Object]",nzt=Function.prototype,izt=Object.prototype,tlt=nzt.toString,ozt=izt.hasOwnProperty,szt=tlt.call(Object);function azt(e){if(!ezt(e)||J6t(e)!=rzt)return!1;var t=tzt(e);if(t===null)return!0;var r=ozt.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&tlt.call(r)==szt}elt.exports=azt});var Jw,C6,tT,NI,P6,plt,lp,vd,dlt,I6,mlt,Alt,R6,L6,O6,glt,_lt,kI,B6,ylt,ps=Te(()=>{Jw="1.13.7",C6=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},tT=Array.prototype,NI=Object.prototype,P6=typeof Symbol<"u"?Symbol.prototype:null,plt=tT.push,lp=tT.slice,vd=NI.toString,dlt=NI.hasOwnProperty,I6=typeof ArrayBuffer<"u",mlt=typeof DataView<"u",Alt=Array.isArray,R6=Object.keys,L6=Object.create,O6=I6&&ArrayBuffer.isView,glt=isNaN,_lt=isFinite,kI=!{toString:null}.propertyIsEnumerable("toString"),B6=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],ylt=Math.pow(2,53)-1});function Co(e,t){return t=t==null?e.length-1:+t,function(){for(var r=Math.max(arguments.length-t,0),n=Array(r),i=0;i<r;i++)n[i]=arguments[i+t];switch(t){case 0:return e.call(this,n);case 1:return e.call(this,arguments[0],n);case 2:return e.call(this,arguments[0],arguments[1],n)}var o=Array(t+1);for(i=0;i<t;i++)o[i]=arguments[i];return o[t]=n,e.apply(this,o)}}var Vl=Te(()=>{});function Qc(e){var t=typeof e;return t==="function"||t==="object"&&!!e}var eA=Te(()=>{});function FI(e){return e===null}var xlt=Te(()=>{});function G1(e){return e===void 0}var D6=Te(()=>{});function X1(e){return e===!0||e===!1||vd.call(e)==="[object Boolean]"}var N6=Te(()=>{ps()});function zI(e){return!!(e&&e.nodeType===1)}var vlt=Te(()=>{});function Qi(e){var t="[object "+e+"]";return function(r){return vd.call(r)===t}}var Pc=Te(()=>{ps()});var dg,UI=Te(()=>{Pc();dg=Qi("String")});var eT,k6=Te(()=>{Pc();eT=Qi("Number")});var F6,blt=Te(()=>{Pc();F6=Qi("Date")});var z6,wlt=Te(()=>{Pc();z6=Qi("RegExp")});var U6,Tlt=Te(()=>{Pc();U6=Qi("Error")});var rT,V6=Te(()=>{Pc();rT=Qi("Symbol")});var nT,j6=Te(()=>{Pc();nT=Qi("ArrayBuffer")});var Elt,hzt,Do,du=Te(()=>{Pc();ps();Elt=Qi("Function"),hzt=C6.document&&C6.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof hzt!="function"&&(Elt=function(e){return typeof e=="function"||!1});Do=Elt});var H6,Mlt=Te(()=>{Pc();H6=Qi("Object")});var VI,Y1,K1=Te(()=>{ps();Mlt();VI=mlt&&(!/\[native code\]/.test(String(DataView))||H6(new DataView(new ArrayBuffer(8)))),Y1=typeof Map<"u"&&H6(new Map)});function pzt(e){return e!=null&&Do(e.getInt8)&&nT(e.buffer)}var fzt,rA,jI=Te(()=>{Pc();du();j6();K1();fzt=Qi("DataView");rA=VI?pzt:fzt});var gl,nA=Te(()=>{ps();Pc();gl=Alt||Qi("Array")});function Ic(e,t){return e!=null&&dlt.call(e,t)}var bd=Te(()=>{ps()});var W6,mg,HI=Te(()=>{Pc();bd();W6=Qi("Arguments");(function(){W6(arguments)||(W6=function(e){return Ic(e,"callee")})})();mg=W6});function WI(e){return!rT(e)&&_lt(e)&&!isNaN(parseFloat(e))}var Slt=Te(()=>{ps();V6()});function Z1(e){return eT(e)&&glt(e)}var q6=Te(()=>{ps();k6()});function $1(e){return function(){return e}}var G6=Te(()=>{});function iT(e){return function(t){var r=e(t);return typeof r=="number"&&r>=0&&r<=ylt}}var X6=Te(()=>{ps()});function oT(e){return function(t){return t?.[e]}}var Y6=Te(()=>{});var Ag,qI=Te(()=>{Y6();Ag=oT("byteLength")});var Clt,Plt=Te(()=>{X6();qI();Clt=iT(Ag)});function mzt(e){return O6?O6(e)&&!rA(e):Clt(e)&&dzt.test(vd.call(e))}var dzt,sT,K6=Te(()=>{ps();jI();G6();Plt();dzt=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;sT=I6?mzt:$1(!1)});var Jo,mu=Te(()=>{Y6();Jo=oT("length")});function Azt(e){for(var t={},r=e.length,n=0;n<r;++n)t[e[n]]=!0;return{contains:function(i){return t[i]===!0},push:function(i){return t[i]=!0,e.push(i)}}}function aT(e,t){t=Azt(t);var r=B6.length,n=e.constructor,i=Do(n)&&n.prototype||NI,o="constructor";for(Ic(e,o)&&!t.contains(o)&&t.push(o);r--;)o=B6[r],o in e&&e[o]!==i[o]&&!t.contains(o)&&t.push(o)}var Z6=Te(()=>{ps();du();bd()});function Bi(e){if(!Qc(e))return[];if(R6)return R6(e);var t=[];for(var r in e)Ic(e,r)&&t.push(r);return kI&&aT(e,t),t}var ac=Te(()=>{eA();ps();bd();Z6()});function GI(e){if(e==null)return!0;var t=Jo(e);return typeof t=="number"&&(gl(e)||dg(e)||mg(e))?t===0:Jo(Bi(e))===0}var Ilt=Te(()=>{mu();nA();UI();HI();ac()});function Q1(e,t){var r=Bi(t),n=r.length;if(e==null)return!n;for(var i=Object(e),o=0;o<n;o++){var s=r[o];if(t[s]!==i[s]||!(s in i))return!1}return!0}var $6=Te(()=>{ac()});function ri(e){if(e instanceof ri)return e;if(!(this instanceof ri))return new ri(e);this._wrapped=e}var jl=Te(()=>{ps();ri.VERSION=Jw;ri.prototype.value=function(){return this._wrapped};ri.prototype.valueOf=ri.prototype.toJSON=ri.prototype.value;ri.prototype.toString=function(){return String(this._wrapped)}});function XI(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,Ag(e))}var Rlt=Te(()=>{qI()});function Q6(e,t,r,n){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var i=typeof e;return i!=="function"&&i!=="object"&&typeof t!="object"?!1:Olt(e,t,r,n)}function Olt(e,t,r,n){e instanceof ri&&(e=e._wrapped),t instanceof ri&&(t=t._wrapped);var i=vd.call(e);if(i!==vd.call(t))return!1;if(VI&&i=="[object Object]"&&rA(e)){if(!rA(t))return!1;i=Llt}switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return P6.valueOf.call(e)===P6.valueOf.call(t);case"[object ArrayBuffer]":case Llt:return Olt(XI(e),XI(t),r,n)}var o=i==="[object Array]";if(!o&&sT(e)){var s=Ag(e);if(s!==Ag(t))return!1;if(e.buffer===t.buffer&&e.byteOffset===t.byteOffset)return!0;o=!0}if(!o){if(typeof e!="object"||typeof t!="object")return!1;var c=e.constructor,l=t.constructor;if(c!==l&&!(Do(c)&&c instanceof c&&Do(l)&&l instanceof l)&&"constructor"in e&&"constructor"in t)return!1}r=r||[],n=n||[];for(var h=r.length;h--;)if(r[h]===e)return n[h]===t;if(r.push(e),n.push(t),o){if(h=e.length,h!==t.length)return!1;for(;h--;)if(!Q6(e[h],t[h],r,n))return!1}else{var p=Bi(e),x;if(h=p.length,Bi(t).length!==h)return!1;for(;h--;)if(x=p[h],!(Ic(t,x)&&Q6(e[x],t[x],r,n)))return!1}return r.pop(),n.pop(),!0}function YI(e,t){return Q6(e,t)}var Llt,Blt=Te(()=>{jl();ps();qI();K6();du();K1();jI();ac();bd();Rlt();Llt="[object DataView]"});function sh(e){if(!Qc(e))return[];var t=[];for(var r in e)t.push(r);return kI&&aT(e,t),t}var J1=Te(()=>{eA();ps();Z6()});function tx(e){var t=Jo(e);return function(r){if(r==null)return!1;var n=sh(r);if(Jo(n))return!1;for(var i=0;i<t;i++)if(!Do(r[e[i]]))return!1;return e!==ez||!Do(r[J6])}}var J6,Dlt,tz,Nlt,klt,ez,Flt,KI=Te(()=>{mu();du();J1();J6="forEach",Dlt="has",tz=["clear","delete"],Nlt=["get",Dlt,"set"],klt=tz.concat(J6,Nlt),ez=tz.concat(Nlt),Flt=["add"].concat(tz,J6,Dlt)});var rz,zlt=Te(()=>{Pc();K1();KI();rz=Y1?tx(klt):Qi("Map")});var nz,Ult=Te(()=>{Pc();K1();KI();nz=Y1?tx(ez):Qi("WeakMap")});var iz,Vlt=Te(()=>{Pc();K1();KI();iz=Y1?tx(Flt):Qi("Set")});var oz,jlt=Te(()=>{Pc();oz=Qi("WeakSet")});function Hl(e){for(var t=Bi(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=e[t[i]];return n}var gg=Te(()=>{ac()});function ZI(e){for(var t=Bi(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=[t[i],e[t[i]]];return n}var Hlt=Te(()=>{ac()});function ex(e){for(var t={},r=Bi(e),n=0,i=r.length;n<i;n++)t[e[r[n]]]=r[n];return t}var sz=Te(()=>{ac()});function _g(e){var t=[];for(var r in e)Do(e[r])&&t.push(r);return t.sort()}var az=Te(()=>{du()});function yg(e,t){return function(r){var n=arguments.length;if(t&&(r=Object(r)),n<2||r==null)return r;for(var i=1;i<n;i++)for(var o=arguments[i],s=e(o),c=s.length,l=0;l<c;l++){var h=s[l];(!t||r[h]===void 0)&&(r[h]=o[h])}return r}}var $I=Te(()=>{});var cT,cz=Te(()=>{$I();J1();cT=yg(sh)});var iA,QI=Te(()=>{$I();ac();iA=yg(Bi)});var lT,lz=Te(()=>{$I();J1();lT=yg(sh,!0)});function gzt(){return function(){}}function uT(e){if(!Qc(e))return{};if(L6)return L6(e);var t=gzt();t.prototype=e;var r=new t;return t.prototype=null,r}var uz=Te(()=>{eA();ps()});function JI(e,t){var r=uT(e);return t&&iA(r,t),r}var Wlt=Te(()=>{uz();QI()});function tR(e){return Qc(e)?gl(e)?e.slice():cT({},e):e}var qlt=Te(()=>{eA();nA();cz()});function eR(e,t){return t(e),e}var Glt=Te(()=>{});function hT(e){return gl(e)?e:[e]}var hz=Te(()=>{jl();nA();ri.toPath=hT});function Yh(e){return ri.toPath(e)}var rx=Te(()=>{jl();hz()});function xg(e,t){for(var r=t.length,n=0;n<r;n++){if(e==null)return;e=e[t[n]]}return r?e:void 0}var rR=Te(()=>{});function nx(e,t,r){var n=xg(e,Yh(t));return G1(n)?r:n}var fz=Te(()=>{rx();rR();D6()});function nR(e,t){t=Yh(t);for(var r=t.length,n=0;n<r;n++){var i=t[n];if(!Ic(e,i))return!1;e=e[i]}return!!r}var Xlt=Te(()=>{bd();rx()});function oA(e){return e}var iR=Te(()=>{});function Kh(e){return e=iA({},e),function(t){return Q1(t,e)}}var fT=Te(()=>{QI();$6()});function sA(e){return e=Yh(e),function(t){return xg(t,e)}}var oR=Te(()=>{rR();rx()});function Zh(e,t,r){if(t===void 0)return e;switch(r??3){case 1:return function(n){return e.call(t,n)};case 3:return function(n,i,o){return e.call(t,n,i,o)};case 4:return function(n,i,o,s){return e.call(t,n,i,o,s)}}return function(){return e.apply(t,arguments)}}var ix=Te(()=>{});function pT(e,t,r){return e==null?oA:Do(e)?Zh(e,t,r):Qc(e)&&!gl(e)?Kh(e):sA(e)}var pz=Te(()=>{iR();du();eA();nA();fT();oR();ix()});function vg(e,t){return pT(e,t,1/0)}var dz=Te(()=>{jl();pz();ri.iteratee=vg});function Po(e,t,r){return ri.iteratee!==vg?ri.iteratee(e,t):pT(e,t,r)}var _l=Te(()=>{jl();pz();dz()});function sR(e,t,r){t=Po(t,r);for(var n=Bi(e),i=n.length,o={},s=0;s<i;s++){var c=n[s];o[c]=t(e[c],c,e)}return o}var Ylt=Te(()=>{_l();ac()});function ox(){}var mz=Te(()=>{});function aR(e){return e==null?ox:function(t){return nx(e,t)}}var Klt=Te(()=>{mz();fz()});function cR(e,t,r){var n=Array(Math.max(0,e));t=Zh(t,r,1);for(var i=0;i<e;i++)n[i]=t(i);return n}var Zlt=Te(()=>{ix()});function bg(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}var Az=Te(()=>{});var wd,lR=Te(()=>{wd=Date.now||function(){return new Date().getTime()}});function dT(e){var t=function(o){return e[o]},r="(?:"+Bi(e).join("|")+")",n=RegExp(r),i=RegExp(r,"g");return function(o){return o=o==null?"":""+o,n.test(o)?o.replace(i,t):o}}var gz=Te(()=>{ac()});var uR,_z=Te(()=>{uR={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"}});var yz,$lt=Te(()=>{gz();_z();yz=dT(uR)});var Qlt,Jlt=Te(()=>{sz();_z();Qlt=ex(uR)});var xz,tut=Te(()=>{gz();Jlt();xz=dT(Qlt)});var vz,bz=Te(()=>{jl();vz=ri.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g}});function xzt(e){return"\\"+_zt[e]}function hR(e,t,r){!t&&r&&(t=r),t=lT({},t,ri.templateSettings);var n=RegExp([(t.escape||wz).source,(t.interpolate||wz).source,(t.evaluate||wz).source].join("|")+"|$","g"),i=0,o="__p+='";e.replace(n,function(h,p,x,w,E){return o+=e.slice(i,E).replace(yzt,xzt),i=E+h.length,p?o+=`'+
((__t=(`+p+`))==null?'':_.escape(__t))+
'`:x?o+=`'+
((__t=(`+x+`))==null?'':__t)+
'`:w&&(o+=`';
`+w+`
__p+='`),h}),o+=`';
`;var s=t.variable;if(s){if(!vzt.test(s))throw new Error("variable is not a bare identifier: "+s)}else o=`with(obj||{}){
`+o+`}
`,s="obj";o=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+o+`return __p;
`;var c;try{c=new Function(s,"_",o)}catch(h){throw h.source=o,h}var l=function(h){return c.call(this,h,ri)};return l.source="function("+s+`){
`+o+"}",l}var wz,_zt,yzt,vzt,eut=Te(()=>{lz();jl();bz();wz=/(.)^/,_zt={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},yzt=/\\|'|\r|\n|\u2028|\u2029/g;vzt=/^\s*(\w|\$)+\s*$/});function fR(e,t,r){t=Yh(t);var n=t.length;if(!n)return Do(r)?r.call(e):r;for(var i=0;i<n;i++){var o=e?.[t[i]];o===void 0&&(o=r,i=n),e=Do(o)?o.call(e):o}return e}var rut=Te(()=>{du();rx()});function pR(e){var t=++bzt+"";return e?e+t:t}var bzt,nut=Te(()=>{bzt=0});function dR(e){var t=ri(e);return t._chain=!0,t}var iut=Te(()=>{jl()});function mT(e,t,r,n,i){if(!(n instanceof t))return e.apply(r,i);var o=uT(e.prototype),s=e.apply(o,i);return Qc(s)?s:o}var Tz=Te(()=>{uz();eA()});var Ez,Td,AT=Te(()=>{Vl();Tz();jl();Ez=Co(function(e,t){var r=Ez.placeholder,n=function(){for(var i=0,o=t.length,s=Array(o),c=0;c<o;c++)s[c]=t[c]===r?arguments[i++]:t[c];for(;i<arguments.length;)s.push(arguments[i++]);return mT(e,n,this,this,s)};return n});Ez.placeholder=ri;Td=Ez});var gT,Mz=Te(()=>{Vl();du();Tz();gT=Co(function(e,t,r){if(!Do(e))throw new TypeError("Bind must be called on a function");var n=Co(function(i){return mT(e,n,t,this,r.concat(i))});return n})});var ts,Wl=Te(()=>{X6();mu();ts=iT(Jo)});function ql(e,t,r,n){if(n=n||[],!t&&t!==0)t=1/0;else if(t<=0)return n.concat(e);for(var i=n.length,o=0,s=Jo(e);o<s;o++){var c=e[o];if(ts(c)&&(gl(c)||mg(c)))if(t>1)ql(c,t-1,r,n),i=n.length;else for(var l=0,h=c.length;l<h;)n[i++]=c[l++];else r||(n[i++]=c)}return n}var wg=Te(()=>{mu();Wl();nA();HI()});var Sz,out=Te(()=>{Vl();wg();Mz();Sz=Co(function(e,t){t=ql(t,!1,!1);var r=t.length;if(r<1)throw new Error("bindAll must be passed function names");for(;r--;){var n=t[r];e[n]=gT(e[n],e)}return e})});function mR(e,t){var r=function(n){var i=r.cache,o=""+(t?t.apply(this,arguments):n);return Ic(i,o)||(i[o]=e.apply(this,arguments)),i[o]};return r.cache={},r}var sut=Te(()=>{bd()});var _T,Cz=Te(()=>{Vl();_T=Co(function(e,t,r){return setTimeout(function(){return e.apply(null,r)},t)})});var Pz,aut=Te(()=>{AT();Cz();jl();Pz=Td(_T,ri,1)});function AR(e,t,r){var n,i,o,s,c=0;r||(r={});var l=function(){c=r.leading===!1?0:wd(),n=null,s=e.apply(i,o),n||(i=o=null)},h=function(){var p=wd();!c&&r.leading===!1&&(c=p);var x=t-(p-c);return i=this,o=arguments,x<=0||x>t?(n&&(clearTimeout(n),n=null),c=p,s=e.apply(i,o),n||(i=o=null)):!n&&r.trailing!==!1&&(n=setTimeout(l,x)),s};return h.cancel=function(){clearTimeout(n),c=0,n=i=o=null},h}var cut=Te(()=>{lR()});function gR(e,t,r){var n,i,o,s,c,l=function(){var p=wd()-i;t>p?n=setTimeout(l,t-p):(n=null,r||(s=e.apply(c,o)),n||(o=c=null))},h=Co(function(p){return c=this,o=p,i=wd(),n||(n=setTimeout(l,t),r&&(s=e.apply(c,o))),s});return h.cancel=function(){clearTimeout(n),n=o=c=null},h}var lut=Te(()=>{Vl();lR()});function _R(e,t){return Td(t,e)}var uut=Te(()=>{AT()});function aA(e){return function(){return!e.apply(this,arguments)}}var yR=Te(()=>{});function xR(){var e=arguments,t=e.length-1;return function(){for(var r=t,n=e[t].apply(this,arguments);r--;)n=e[r].call(this,n);return n}}var hut=Te(()=>{});function vR(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}var fut=Te(()=>{});function sx(e,t){var r;return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=null),r}}var Iz=Te(()=>{});var Rz,put=Te(()=>{AT();Iz();Rz=Td(sx,2)});function ax(e,t,r){t=Po(t,r);for(var n=Bi(e),i,o=0,s=n.length;o<s;o++)if(i=n[o],t(e[i],i,e))return i}var Lz=Te(()=>{_l();ac()});function yT(e){return function(t,r,n){r=Po(r,n);for(var i=Jo(t),o=e>0?0:i-1;o>=0&&o<i;o+=e)if(r(t[o],o,t))return o;return-1}}var Oz=Te(()=>{_l();mu()});var Tg,bR=Te(()=>{Oz();Tg=yT(1)});var xT,Bz=Te(()=>{Oz();xT=yT(-1)});function cx(e,t,r,n){r=Po(r,n,1);for(var i=r(t),o=0,s=Jo(e);o<s;){var c=Math.floor((o+s)/2);r(e[c])<i?o=c+1:s=c}return o}var Dz=Te(()=>{_l();mu()});function vT(e,t,r){return function(n,i,o){var s=0,c=Jo(n);if(typeof o=="number")e>0?s=o>=0?o:Math.max(o+c,s):c=o>=0?Math.min(o+1,c):o+c+1;else if(r&&o&&c)return o=r(n,i),n[o]===i?o:-1;if(i!==i)return o=t(lp.call(n,s,c),Z1),o>=0?o+s:-1;for(o=e>0?s:c-1;o>=0&&o<c;o+=e)if(n[o]===i)return o;return-1}}var Nz=Te(()=>{mu();ps();q6()});var bT,kz=Te(()=>{Dz();bR();Nz();bT=vT(1,Tg,cx)});var Fz,dut=Te(()=>{Bz();Nz();Fz=vT(-1,xT)});function Eg(e,t,r){var n=ts(e)?Tg:ax,i=n(e,t,r);if(i!==void 0&&i!==-1)return e[i]}var zz=Te(()=>{Wl();bR();Lz()});function wR(e,t){return Eg(e,Kh(t))}var mut=Te(()=>{zz();fT()});function cc(e,t,r){t=Zh(t,r);var n,i;if(ts(e))for(n=0,i=e.length;n<i;n++)t(e[n],n,e);else{var o=Bi(e);for(n=0,i=o.length;n<i;n++)t(e[o[n]],o[n],e)}return e}var cA=Te(()=>{ix();Wl();ac()});function yl(e,t,r){t=Po(t,r);for(var n=!ts(e)&&Bi(e),i=(n||e).length,o=Array(i),s=0;s<i;s++){var c=n?n[s]:s;o[s]=t(e[c],c,e)}return o}var Mg=Te(()=>{_l();Wl();ac()});function wT(e){var t=function(r,n,i,o){var s=!ts(r)&&Bi(r),c=(s||r).length,l=e>0?0:c-1;for(o||(i=r[s?s[l]:l],l+=e);l>=0&&l<c;l+=e){var h=s?s[l]:l;i=n(i,r[h],h,r)}return i};return function(r,n,i,o){var s=arguments.length>=3;return t(r,Zh(n,o,4),i,s)}}var Uz=Te(()=>{Wl();ac();ix()});var TT,Aut=Te(()=>{Uz();TT=wT(1)});var TR,gut=Te(()=>{Uz();TR=wT(-1)});function Au(e,t,r){var n=[];return t=Po(t,r),cc(e,function(i,o,s){t(i,o,s)&&n.push(i)}),n}var lx=Te(()=>{_l();cA()});function ER(e,t,r){return Au(e,aA(Po(t)),r)}var _ut=Te(()=>{lx();yR();_l()});function ET(e,t,r){t=Po(t,r);for(var n=!ts(e)&&Bi(e),i=(n||e).length,o=0;o<i;o++){var s=n?n[o]:o;if(!t(e[s],s,e))return!1}return!0}var yut=Te(()=>{_l();Wl();ac()});function MT(e,t,r){t=Po(t,r);for(var n=!ts(e)&&Bi(e),i=(n||e).length,o=0;o<i;o++){var s=n?n[o]:o;if(t(e[s],s,e))return!0}return!1}var xut=Te(()=>{_l();Wl();ac()});function Jc(e,t,r,n){return ts(e)||(e=Hl(e)),(typeof r!="number"||n)&&(r=0),bT(e,t,r)>=0}var ux=Te(()=>{Wl();gg();kz()});var Vz,vut=Te(()=>{Vl();du();Mg();rR();rx();Vz=Co(function(e,t,r){var n,i;return Do(t)?i=t:(t=Yh(t),n=t.slice(0,-1),t=t[t.length-1]),yl(e,function(o){var s=i;if(!s){if(n&&n.length&&(o=xg(o,n)),o==null)return;s=o[t]}return s==null?s:s.apply(o,r)})})});function lA(e,t){return yl(e,sA(t))}var MR=Te(()=>{Mg();oR()});function SR(e,t){return Au(e,Kh(t))}var but=Te(()=>{lx();fT()});function hx(e,t,r){var n=-1/0,i=-1/0,o,s;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=ts(e)?e:Hl(e);for(var c=0,l=e.length;c<l;c++)o=e[c],o!=null&&o>n&&(n=o)}else t=Po(t,r),cc(e,function(h,p,x){s=t(h,p,x),(s>i||s===-1/0&&n===-1/0)&&(n=h,i=s)});return n}var jz=Te(()=>{Wl();gg();_l();cA()});function CR(e,t,r){var n=1/0,i=1/0,o,s;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=ts(e)?e:Hl(e);for(var c=0,l=e.length;c<l;c++)o=e[c],o!=null&&o<n&&(n=o)}else t=Po(t,r),cc(e,function(h,p,x){s=t(h,p,x),(s<i||s===1/0&&n===1/0)&&(n=h,i=s)});return n}var wut=Te(()=>{Wl();gg();_l();cA()});function fx(e){return e?gl(e)?lp.call(e):dg(e)?e.match(wzt):ts(e)?yl(e,oA):Hl(e):[]}var wzt,Hz=Te(()=>{nA();ps();UI();Wl();Mg();iR();gg();wzt=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g});function px(e,t,r){if(t==null||r)return ts(e)||(e=Hl(e)),e[bg(e.length-1)];var n=fx(e),i=Jo(n);t=Math.max(Math.min(t,i),0);for(var o=i-1,s=0;s<t;s++){var c=bg(s,o),l=n[s];n[s]=n[c],n[c]=l}return n.slice(0,t)}var Wz=Te(()=>{Wl();gg();mu();Az();Hz()});function PR(e){return px(e,1/0)}var Tut=Te(()=>{Wz()});function IR(e,t,r){var n=0;return t=Po(t,r),lA(yl(e,function(i,o,s){return{value:i,index:n++,criteria:t(i,o,s)}}).sort(function(i,o){var s=i.criteria,c=o.criteria;if(s!==c){if(s>c||s===void 0)return 1;if(s<c||c===void 0)return-1}return i.index-o.index}),"value")}var Eut=Te(()=>{_l();MR();Mg()});function Ed(e,t){return function(r,n,i){var o=t?[[],[]]:{};return n=Po(n,i),cc(r,function(s,c){var l=n(s,c,r);e(o,s,l)}),o}}var ST=Te(()=>{_l();cA()});var qz,Mut=Te(()=>{ST();bd();qz=Ed(function(e,t,r){Ic(e,r)?e[r].push(t):e[r]=[t]})});var Gz,Sut=Te(()=>{ST();Gz=Ed(function(e,t,r){e[r]=t})});var Xz,Cut=Te(()=>{ST();bd();Xz=Ed(function(e,t,r){Ic(e,r)?e[r]++:e[r]=1})});var Yz,Put=Te(()=>{ST();Yz=Ed(function(e,t,r){e[r?0:1].push(t)},!0)});function RR(e){return e==null?0:ts(e)?e.length:Bi(e).length}var Iut=Te(()=>{Wl();ac()});function Kz(e,t,r){return t in r}var Rut=Te(()=>{});var CT,Zz=Te(()=>{Vl();du();ix();J1();Rut();wg();CT=Co(function(e,t){var r={},n=t[0];if(e==null)return r;Do(n)?(t.length>1&&(n=Zh(n,t[1])),t=sh(e)):(n=Kz,t=ql(t,!1,!1),e=Object(e));for(var i=0,o=t.length;i<o;i++){var s=t[i],c=e[s];n(c,s,e)&&(r[s]=c)}return r})});var $z,Lut=Te(()=>{Vl();du();yR();Mg();wg();ux();Zz();$z=Co(function(e,t){var r=t[0],n;return Do(r)?(r=aA(r),t.length>1&&(n=t[1])):(t=yl(ql(t,!1,!1),String),r=function(i,o){return!Jc(t,o)}),CT(e,r,n)})});function dx(e,t,r){return lp.call(e,0,Math.max(0,e.length-(t==null||r?1:t)))}var Qz=Te(()=>{ps()});function mx(e,t,r){return e==null||e.length<1?t==null||r?void 0:[]:t==null||r?e[0]:dx(e,e.length-t)}var Out=Te(()=>{Qz()});function uA(e,t,r){return lp.call(e,t==null||r?1:t)}var Jz=Te(()=>{ps()});function LR(e,t,r){return e==null||e.length<1?t==null||r?void 0:[]:t==null||r?e[e.length-1]:uA(e,Math.max(0,e.length-t))}var But=Te(()=>{Jz()});function OR(e){return Au(e,Boolean)}var Dut=Te(()=>{lx()});function BR(e,t){return ql(e,t,!1)}var Nut=Te(()=>{wg()});var PT,t8=Te(()=>{Vl();wg();lx();ux();PT=Co(function(e,t){return t=ql(t,!0,!0),Au(e,function(r){return!Jc(t,r)})})});var e8,kut=Te(()=>{Vl();t8();e8=Co(function(e,t){return PT(e,t)})});function Sg(e,t,r,n){X1(t)||(n=r,r=t,t=!1),r!=null&&(r=Po(r,n));for(var i=[],o=[],s=0,c=Jo(e);s<c;s++){var l=e[s],h=r?r(l,s,e):l;t&&!r?((!s||o!==h)&&i.push(l),o=h):r?Jc(o,h)||(o.push(h),i.push(l)):Jc(i,l)||i.push(l)}return i}var r8=Te(()=>{N6();_l();mu();ux()});var n8,Fut=Te(()=>{Vl();r8();wg();n8=Co(function(e){return Sg(ql(e,!0,!0))})});function DR(e){for(var t=[],r=arguments.length,n=0,i=Jo(e);n<i;n++){var o=e[n];if(!Jc(t,o)){var s;for(s=1;s<r&&Jc(arguments[s],o);s++);s===r&&t.push(o)}}return t}var zut=Te(()=>{mu();ux()});function Cg(e){for(var t=e&&hx(e,Jo).length||0,r=Array(t),n=0;n<t;n++)r[n]=lA(e,n);return r}var i8=Te(()=>{jz();mu();MR()});var o8,Uut=Te(()=>{Vl();i8();o8=Co(Cg)});function NR(e,t){for(var r={},n=0,i=Jo(e);n<i;n++)t?r[e[n]]=t[n]:r[e[n][0]]=e[n][1];return r}var Vut=Te(()=>{mu()});function kR(e,t,r){t==null&&(t=e||0,e=0),r||(r=t<e?-1:1);for(var n=Math.max(Math.ceil((t-e)/r),0),i=Array(n),o=0;o<n;o++,e+=r)i[o]=e;return i}var jut=Te(()=>{});function FR(e,t){if(t==null||t<1)return[];for(var r=[],n=0,i=e.length;n<i;)r.push(lp.call(e,n,n+=t));return r}var Hut=Te(()=>{ps()});function Ax(e,t){return e._chain?ri(t).chain():t}var s8=Te(()=>{jl()});function gx(e){return cc(_g(e),function(t){var r=ri[t]=e[t];ri.prototype[t]=function(){var n=[this._wrapped];return plt.apply(n,arguments),Ax(this,r.apply(ri,n))}}),ri}var Wut=Te(()=>{jl();cA();az();ps();s8()});var qut,Gut=Te(()=>{jl();cA();ps();s8();cc(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=tT[e];ri.prototype[e]=function(){var r=this._wrapped;return r!=null&&(t.apply(r,arguments),(e==="shift"||e==="splice")&&r.length===0&&delete r[0]),Ax(this,r)}});cc(["concat","join","slice"],function(e){var t=tT[e];ri.prototype[e]=function(){var r=this._wrapped;return r!=null&&(r=t.apply(r,arguments)),Ax(this,r)}});qut=ri});var a8={};Lo(a8,{VERSION:()=>Jw,after:()=>vR,all:()=>ET,allKeys:()=>sh,any:()=>MT,assign:()=>iA,before:()=>sx,bind:()=>gT,bindAll:()=>Sz,chain:()=>dR,chunk:()=>FR,clone:()=>tR,collect:()=>yl,compact:()=>OR,compose:()=>xR,constant:()=>$1,contains:()=>Jc,countBy:()=>Xz,create:()=>JI,debounce:()=>gR,default:()=>qut,defaults:()=>lT,defer:()=>Pz,delay:()=>_T,detect:()=>Eg,difference:()=>PT,drop:()=>uA,each:()=>cc,escape:()=>yz,every:()=>ET,extend:()=>cT,extendOwn:()=>iA,filter:()=>Au,find:()=>Eg,findIndex:()=>Tg,findKey:()=>ax,findLastIndex:()=>xT,findWhere:()=>wR,first:()=>mx,flatten:()=>BR,foldl:()=>TT,foldr:()=>TR,forEach:()=>cc,functions:()=>_g,get:()=>nx,groupBy:()=>qz,has:()=>nR,head:()=>mx,identity:()=>oA,include:()=>Jc,includes:()=>Jc,indexBy:()=>Gz,indexOf:()=>bT,initial:()=>dx,inject:()=>TT,intersection:()=>DR,invert:()=>ex,invoke:()=>Vz,isArguments:()=>mg,isArray:()=>gl,isArrayBuffer:()=>nT,isBoolean:()=>X1,isDataView:()=>rA,isDate:()=>F6,isElement:()=>zI,isEmpty:()=>GI,isEqual:()=>YI,isError:()=>U6,isFinite:()=>WI,isFunction:()=>Do,isMap:()=>rz,isMatch:()=>Q1,isNaN:()=>Z1,isNull:()=>FI,isNumber:()=>eT,isObject:()=>Qc,isRegExp:()=>z6,isSet:()=>iz,isString:()=>dg,isSymbol:()=>rT,isTypedArray:()=>sT,isUndefined:()=>G1,isWeakMap:()=>nz,isWeakSet:()=>oz,iteratee:()=>vg,keys:()=>Bi,last:()=>LR,lastIndexOf:()=>Fz,map:()=>yl,mapObject:()=>sR,matcher:()=>Kh,matches:()=>Kh,max:()=>hx,memoize:()=>mR,methods:()=>_g,min:()=>CR,mixin:()=>gx,negate:()=>aA,noop:()=>ox,now:()=>wd,object:()=>NR,omit:()=>$z,once:()=>Rz,pairs:()=>ZI,partial:()=>Td,partition:()=>Yz,pick:()=>CT,pluck:()=>lA,property:()=>sA,propertyOf:()=>aR,random:()=>bg,range:()=>kR,reduce:()=>TT,reduceRight:()=>TR,reject:()=>ER,rest:()=>uA,restArguments:()=>Co,result:()=>fR,sample:()=>px,select:()=>Au,shuffle:()=>PR,size:()=>RR,some:()=>MT,sortBy:()=>IR,sortedIndex:()=>cx,tail:()=>uA,take:()=>mx,tap:()=>eR,template:()=>hR,templateSettings:()=>vz,throttle:()=>AR,times:()=>cR,toArray:()=>fx,toPath:()=>hT,transpose:()=>Cg,unescape:()=>xz,union:()=>n8,uniq:()=>Sg,unique:()=>Sg,uniqueId:()=>pR,unzip:()=>Cg,values:()=>Hl,where:()=>SR,without:()=>e8,wrap:()=>_R,zip:()=>o8});var zR=Te(()=>{ps();Vl();eA();xlt();D6();N6();vlt();UI();k6();blt();wlt();Tlt();V6();j6();jI();nA();du();HI();Slt();q6();K6();Ilt();$6();Blt();zlt();Ult();Vlt();jlt();ac();J1();gg();Hlt();sz();az();cz();QI();lz();Wlt();qlt();Glt();fz();Xlt();Ylt();iR();G6();mz();hz();oR();Klt();fT();Zlt();Az();lR();$lt();tut();bz();eut();rut();nut();iut();dz();AT();Mz();out();sut();Cz();aut();cut();lut();uut();yR();hut();fut();Iz();put();Lz();bR();Bz();Dz();kz();dut();zz();mut();cA();Mg();Aut();gut();lx();_ut();yut();xut();ux();vut();MR();but();jz();wut();Tut();Wz();Eut();Mut();Sut();Cut();Put();Hz();Iut();Zz();Lut();Out();Qz();But();Jz();Dut();Nut();kut();r8();Fut();zut();t8();i8();Uut();Vut();jut();Hut();Wut();Gut()});var c8,Xut,Yut=Te(()=>{zR();zR();c8=gx(a8);c8._=c8;Xut=c8});var Kut={};Lo(Kut,{VERSION:()=>Jw,after:()=>vR,all:()=>ET,allKeys:()=>sh,any:()=>MT,assign:()=>iA,before:()=>sx,bind:()=>gT,bindAll:()=>Sz,chain:()=>dR,chunk:()=>FR,clone:()=>tR,collect:()=>yl,compact:()=>OR,compose:()=>xR,constant:()=>$1,contains:()=>Jc,countBy:()=>Xz,create:()=>JI,debounce:()=>gR,default:()=>Xut,defaults:()=>lT,defer:()=>Pz,delay:()=>_T,detect:()=>Eg,difference:()=>PT,drop:()=>uA,each:()=>cc,escape:()=>yz,every:()=>ET,extend:()=>cT,extendOwn:()=>iA,filter:()=>Au,find:()=>Eg,findIndex:()=>Tg,findKey:()=>ax,findLastIndex:()=>xT,findWhere:()=>wR,first:()=>mx,flatten:()=>BR,foldl:()=>TT,foldr:()=>TR,forEach:()=>cc,functions:()=>_g,get:()=>nx,groupBy:()=>qz,has:()=>nR,head:()=>mx,identity:()=>oA,include:()=>Jc,includes:()=>Jc,indexBy:()=>Gz,indexOf:()=>bT,initial:()=>dx,inject:()=>TT,intersection:()=>DR,invert:()=>ex,invoke:()=>Vz,isArguments:()=>mg,isArray:()=>gl,isArrayBuffer:()=>nT,isBoolean:()=>X1,isDataView:()=>rA,isDate:()=>F6,isElement:()=>zI,isEmpty:()=>GI,isEqual:()=>YI,isError:()=>U6,isFinite:()=>WI,isFunction:()=>Do,isMap:()=>rz,isMatch:()=>Q1,isNaN:()=>Z1,isNull:()=>FI,isNumber:()=>eT,isObject:()=>Qc,isRegExp:()=>z6,isSet:()=>iz,isString:()=>dg,isSymbol:()=>rT,isTypedArray:()=>sT,isUndefined:()=>G1,isWeakMap:()=>nz,isWeakSet:()=>oz,iteratee:()=>vg,keys:()=>Bi,last:()=>LR,lastIndexOf:()=>Fz,map:()=>yl,mapObject:()=>sR,matcher:()=>Kh,matches:()=>Kh,max:()=>hx,memoize:()=>mR,methods:()=>_g,min:()=>CR,mixin:()=>gx,negate:()=>aA,noop:()=>ox,now:()=>wd,object:()=>NR,omit:()=>$z,once:()=>Rz,pairs:()=>ZI,partial:()=>Td,partition:()=>Yz,pick:()=>CT,pluck:()=>lA,property:()=>sA,propertyOf:()=>aR,random:()=>bg,range:()=>kR,reduce:()=>TT,reduceRight:()=>TR,reject:()=>ER,rest:()=>uA,restArguments:()=>Co,result:()=>fR,sample:()=>px,select:()=>Au,shuffle:()=>PR,size:()=>RR,some:()=>MT,sortBy:()=>IR,sortedIndex:()=>cx,tail:()=>uA,take:()=>mx,tap:()=>eR,template:()=>hR,templateSettings:()=>vz,throttle:()=>AR,times:()=>cR,toArray:()=>fx,toPath:()=>hT,transpose:()=>Cg,unescape:()=>xz,union:()=>n8,uniq:()=>Sg,unique:()=>Sg,uniqueId:()=>pR,unzip:()=>Cg,values:()=>Hl,where:()=>SR,without:()=>e8,wrap:()=>_R,zip:()=>o8});var Zut=Te(()=>{Yut();zR()});var l8=Ye(($ut,UR)=>{(function(e,t){"use strict";typeof UR=="object"&&typeof UR.exports=="object"?UR.exports=e.document?t(e,!0):function(r){if(!r.document)throw new Error("jQuery requires a window with a document");return t(r)}:t(e)})(typeof window<"u"?window:$ut,function(e,t){"use strict";var r=[],n=Object.getPrototypeOf,i=r.slice,o=r.flat?function(R){return r.flat.call(R)}:function(R){return r.concat.apply([],R)},s=r.push,c=r.indexOf,l={},h=l.toString,p=l.hasOwnProperty,x=p.toString,w=x.call(Object),E={},P=function(V){return typeof V=="function"&&typeof V.nodeType!="number"&&typeof V.item!="function"},B=function(V){return V!=null&&V===V.window},D=e.document,W={type:!0,src:!0,nonce:!0,noModule:!0};function X(R,V,Y){Y=Y||D;var tt,ht,ft=Y.createElement("script");if(ft.text=R,V)for(tt in W)ht=V[tt]||V.getAttribute&&V.getAttribute(tt),ht&&ft.setAttribute(tt,ht);Y.head.appendChild(ft).parentNode.removeChild(ft)}function q(R){return R==null?R+"":typeof R=="object"||typeof R=="function"?l[h.call(R)]||"object":typeof R}var $="3.7.1",et=/HTML$/i,F=function(R,V){return new F.fn.init(R,V)};F.fn=F.prototype={jquery:$,constructor:F,length:0,toArray:function(){return i.call(this)},get:function(R){return R==null?i.call(this):R<0?this[R+this.length]:this[R]},pushStack:function(R){var V=F.merge(this.constructor(),R);return V.prevObject=this,V},each:function(R){return F.each(this,R)},map:function(R){return this.pushStack(F.map(this,function(V,Y){return R.call(V,Y,V)}))},slice:function(){return this.pushStack(i.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(F.grep(this,function(R,V){return(V+1)%2}))},odd:function(){return this.pushStack(F.grep(this,function(R,V){return V%2}))},eq:function(R){var V=this.length,Y=+R+(R<0?V:0);return this.pushStack(Y>=0&&Y<V?[this[Y]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:r.sort,splice:r.splice},F.extend=F.fn.extend=function(){var R,V,Y,tt,ht,ft,xt=arguments[0]||{},Kt=1,Wt=arguments.length,oe=!1;for(typeof xt=="boolean"&&(oe=xt,xt=arguments[Kt]||{},Kt++),typeof xt!="object"&&!P(xt)&&(xt={}),Kt===Wt&&(xt=this,Kt--);Kt<Wt;Kt++)if((R=arguments[Kt])!=null)for(V in R)tt=R[V],!(V==="__proto__"||xt===tt)&&(oe&&tt&&(F.isPlainObject(tt)||(ht=Array.isArray(tt)))?(Y=xt[V],ht&&!Array.isArray(Y)?ft=[]:!ht&&!F.isPlainObject(Y)?ft={}:ft=Y,ht=!1,xt[V]=F.extend(oe,ft,tt)):tt!==void 0&&(xt[V]=tt));return xt},F.extend({expando:"jQuery"+($+Math.random()).replace(/\D/g,""),isReady:!0,error:function(R){throw new Error(R)},noop:function(){},isPlainObject:function(R){var V,Y;return!R||h.call(R)!=="[object Object]"?!1:(V=n(R),V?(Y=p.call(V,"constructor")&&V.constructor,typeof Y=="function"&&x.call(Y)===w):!0)},isEmptyObject:function(R){var V;for(V in R)return!1;return!0},globalEval:function(R,V,Y){X(R,{nonce:V&&V.nonce},Y)},each:function(R,V){var Y,tt=0;if(ut(R))for(Y=R.length;tt<Y&&V.call(R[tt],tt,R[tt])!==!1;tt++);else for(tt in R)if(V.call(R[tt],tt,R[tt])===!1)break;return R},text:function(R){var V,Y="",tt=0,ht=R.nodeType;if(!ht)for(;V=R[tt++];)Y+=F.text(V);return ht===1||ht===11?R.textContent:ht===9?R.documentElement.textContent:ht===3||ht===4?R.nodeValue:Y},makeArray:function(R,V){var Y=V||[];return R!=null&&(ut(Object(R))?F.merge(Y,typeof R=="string"?[R]:R):s.call(Y,R)),Y},inArray:function(R,V,Y){return V==null?-1:c.call(V,R,Y)},isXMLDoc:function(R){var V=R&&R.namespaceURI,Y=R&&(R.ownerDocument||R).documentElement;return!et.test(V||Y&&Y.nodeName||"HTML")},merge:function(R,V){for(var Y=+V.length,tt=0,ht=R.length;tt<Y;tt++)R[ht++]=V[tt];return R.length=ht,R},grep:function(R,V,Y){for(var tt,ht=[],ft=0,xt=R.length,Kt=!Y;ft<xt;ft++)tt=!V(R[ft],ft),tt!==Kt&&ht.push(R[ft]);return ht},map:function(R,V,Y){var tt,ht,ft=0,xt=[];if(ut(R))for(tt=R.length;ft<tt;ft++)ht=V(R[ft],ft,Y),ht!=null&&xt.push(ht);else for(ft in R)ht=V(R[ft],ft,Y),ht!=null&&xt.push(ht);return o(xt)},guid:1,support:E}),typeof Symbol=="function"&&(F.fn[Symbol.iterator]=r[Symbol.iterator]),F.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(R,V){l["[object "+V+"]"]=V.toLowerCase()});function ut(R){var V=!!R&&"length"in R&&R.length,Y=q(R);return P(R)||B(R)?!1:Y==="array"||V===0||typeof V=="number"&&V>0&&V-1 in R}function ot(R,V){return R.nodeName&&R.nodeName.toLowerCase()===V.toLowerCase()}var J=r.pop,G=r.sort,mt=r.splice,Mt="[\\x20\\t\\r\\n\\f]",ct=new RegExp("^"+Mt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Mt+"+$","g");F.contains=function(R,V){var Y=V&&V.parentNode;return R===Y||!!(Y&&Y.nodeType===1&&(R.contains?R.contains(Y):R.compareDocumentPosition&&R.compareDocumentPosition(Y)&16))};var gt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function ee(R,V){return V?R==="\0"?"\uFFFD":R.slice(0,-1)+"\\"+R.charCodeAt(R.length-1).toString(16)+" ":"\\"+R}F.escapeSelector=function(R){return(R+"").replace(gt,ee)};var Ne=D,Ue=s;(function(){var R,V,Y,tt,ht,ft=Ue,xt,Kt,Wt,oe,Oe,Fe=F.expando,ae=0,rr=0,fn=ma(),se=ma(),ve=ma(),er=ma(),jr=function(zt,ne){return zt===ne&&(ht=!0),0},_="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Pn="(?:\\\\[\\da-fA-F]{1,6}"+Mt+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",Ur="\\["+Mt+"*("+Pn+")(?:"+Mt+"*([*^$|!~]?=)"+Mt+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+Pn+"))|)"+Mt+"*\\]",Rt=":("+Pn+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Ur+")*)|.*)\\)|)",gn=new RegExp(Mt+"+","g"),ni=new RegExp("^"+Mt+"*,"+Mt+"*"),ji=new RegExp("^"+Mt+"*([>+~]|"+Mt+")"+Mt+"*"),mi=new RegExp(Mt+"|>"),$n=new RegExp(Rt),Hi=new RegExp("^"+Pn+"$"),Nn={ID:new RegExp("^#("+Pn+")"),CLASS:new RegExp("^\\.("+Pn+")"),TAG:new RegExp("^("+Pn+"|[*])"),ATTR:new RegExp("^"+Ur),PSEUDO:new RegExp("^"+Rt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Mt+"*(even|odd|(([+-]|)(\\d*)n|)"+Mt+"*(?:([+-]|)"+Mt+"*(\\d+)|))"+Mt+"*\\)|)","i"),bool:new RegExp("^(?:"+_+")$","i"),needsContext:new RegExp("^"+Mt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Mt+"*((?:-\\d)?\\d*)"+Mt+"*\\)|)(?=[^-]|$)","i")},kn=/^(?:input|select|textarea|button)$/i,Kn=/^h\d$/i,Qs=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,dp=/[+~]/,Fs=new RegExp("\\\\[\\da-fA-F]{1,6}"+Mt+"?|\\\\([^\\r\\n\\f])","g"),Fo=function(zt,ne){var _e="0x"+zt.slice(1)-65536;return ne||(_e<0?String.fromCharCode(_e+65536):String.fromCharCode(_e>>10|55296,_e&1023|56320))},Mu=function(){il()},dc=tu(function(zt){return zt.disabled===!0&&ot(zt,"fieldset")},{dir:"parentNode",next:"legend"});function Su(){try{return xt.activeElement}catch{}}try{ft.apply(r=i.call(Ne.childNodes),Ne.childNodes),r[Ne.childNodes.length].nodeType}catch{ft={apply:function(ne,_e){Ue.apply(ne,i.call(_e))},call:function(ne){Ue.apply(ne,i.call(arguments,1))}}}function Ai(zt,ne,_e,Ie){var ze,hr,nr,pr,Pr,Sn,dr,kr=ne&&ne.ownerDocument,xn=ne?ne.nodeType:9;if(_e=_e||[],typeof zt!="string"||!zt||xn!==1&&xn!==9&&xn!==11)return _e;if(!Ie&&(il(ne),ne=ne||xt,Wt)){if(xn!==11&&(Pr=Qs.exec(zt)))if(ze=Pr[1]){if(xn===9)if(nr=ne.getElementById(ze)){if(nr.id===ze)return ft.call(_e,nr),_e}else return _e;else if(kr&&(nr=kr.getElementById(ze))&&Ai.contains(ne,nr)&&nr.id===ze)return ft.call(_e,nr),_e}else{if(Pr[2])return ft.apply(_e,ne.getElementsByTagName(zt)),_e;if((ze=Pr[3])&&ne.getElementsByClassName)return ft.apply(_e,ne.getElementsByClassName(ze)),_e}if(!er[zt+" "]&&(!oe||!oe.test(zt))){if(dr=zt,kr=ne,xn===1&&(mi.test(zt)||ji.test(zt))){for(kr=dp.test(zt)&&af(ne.parentNode)||ne,(kr!=ne||!E.scope)&&((pr=ne.getAttribute("id"))?pr=F.escapeSelector(pr):ne.setAttribute("id",pr=Fe)),Sn=mc(zt),hr=Sn.length;hr--;)Sn[hr]=(pr?"#"+pr:":scope")+" "+Tl(Sn[hr]);dr=Sn.join(",")}try{return ft.apply(_e,kr.querySelectorAll(dr)),_e}catch{er(zt,!0)}finally{pr===Fe&&ne.removeAttribute("id")}}}return Io(zt.replace(ct,"$1"),ne,_e,Ie)}function ma(){var zt=[];function ne(_e,Ie){return zt.push(_e+" ")>V.cacheLength&&delete ne[zt.shift()],ne[_e+" "]=Ie}return ne}function pn(zt){return zt[Fe]=!0,zt}function Bt(zt){var ne=xt.createElement("fieldset");try{return!!zt(ne)}catch{return!1}finally{ne.parentNode&&ne.parentNode.removeChild(ne),ne=null}}function dn(zt){return function(ne){return ot(ne,"input")&&ne.type===zt}}function mp(zt){return function(ne){return(ot(ne,"input")||ot(ne,"button"))&&ne.type===zt}}function Jl(zt){return function(ne){return"form"in ne?ne.parentNode&&ne.disabled===!1?"label"in ne?"label"in ne.parentNode?ne.parentNode.disabled===zt:ne.disabled===zt:ne.isDisabled===zt||ne.isDisabled!==!zt&&dc(ne)===zt:ne.disabled===zt:"label"in ne?ne.disabled===zt:!1}}function Ts(zt){return pn(function(ne){return ne=+ne,pn(function(_e,Ie){for(var ze,hr=zt([],_e.length,ne),nr=hr.length;nr--;)_e[ze=hr[nr]]&&(_e[ze]=!(Ie[ze]=_e[ze]))})})}function af(zt){return zt&&typeof zt.getElementsByTagName<"u"&&zt}function il(zt){var ne,_e=zt?zt.ownerDocument||zt:Ne;return _e==xt||_e.nodeType!==9||!_e.documentElement||(xt=_e,Kt=xt.documentElement,Wt=!F.isXMLDoc(xt),Oe=Kt.matches||Kt.webkitMatchesSelector||Kt.msMatchesSelector,Kt.msMatchesSelector&&Ne!=xt&&(ne=xt.defaultView)&&ne.top!==ne&&ne.addEventListener("unload",Mu),E.getById=Bt(function(Ie){return Kt.appendChild(Ie).id=F.expando,!xt.getElementsByName||!xt.getElementsByName(F.expando).length}),E.disconnectedMatch=Bt(function(Ie){return Oe.call(Ie,"*")}),E.scope=Bt(function(){return xt.querySelectorAll(":scope")}),E.cssHas=Bt(function(){try{return xt.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),E.getById?(V.filter.ID=function(Ie){var ze=Ie.replace(Fs,Fo);return function(hr){return hr.getAttribute("id")===ze}},V.find.ID=function(Ie,ze){if(typeof ze.getElementById<"u"&&Wt){var hr=ze.getElementById(Ie);return hr?[hr]:[]}}):(V.filter.ID=function(Ie){var ze=Ie.replace(Fs,Fo);return function(hr){var nr=typeof hr.getAttributeNode<"u"&&hr.getAttributeNode("id");return nr&&nr.value===ze}},V.find.ID=function(Ie,ze){if(typeof ze.getElementById<"u"&&Wt){var hr,nr,pr,Pr=ze.getElementById(Ie);if(Pr){if(hr=Pr.getAttributeNode("id"),hr&&hr.value===Ie)return[Pr];for(pr=ze.getElementsByName(Ie),nr=0;Pr=pr[nr++];)if(hr=Pr.getAttributeNode("id"),hr&&hr.value===Ie)return[Pr]}return[]}}),V.find.TAG=function(Ie,ze){return typeof ze.getElementsByTagName<"u"?ze.getElementsByTagName(Ie):ze.querySelectorAll(Ie)},V.find.CLASS=function(Ie,ze){if(typeof ze.getElementsByClassName<"u"&&Wt)return ze.getElementsByClassName(Ie)},oe=[],Bt(function(Ie){var ze;Kt.appendChild(Ie).innerHTML="<a id='"+Fe+"' href='' disabled='disabled'></a><select id='"+Fe+"-\r\\' disabled='disabled'><option selected=''></option></select>",Ie.querySelectorAll("[selected]").length||oe.push("\\["+Mt+"*(?:value|"+_+")"),Ie.querySelectorAll("[id~="+Fe+"-]").length||oe.push("~="),Ie.querySelectorAll("a#"+Fe+"+*").length||oe.push(".#.+[+~]"),Ie.querySelectorAll(":checked").length||oe.push(":checked"),ze=xt.createElement("input"),ze.setAttribute("type","hidden"),Ie.appendChild(ze).setAttribute("name","D"),Kt.appendChild(Ie).disabled=!0,Ie.querySelectorAll(":disabled").length!==2&&oe.push(":enabled",":disabled"),ze=xt.createElement("input"),ze.setAttribute("name",""),Ie.appendChild(ze),Ie.querySelectorAll("[name='']").length||oe.push("\\["+Mt+"*name"+Mt+"*="+Mt+`*(?:''|"")`)}),E.cssHas||oe.push(":has"),oe=oe.length&&new RegExp(oe.join("|")),jr=function(Ie,ze){if(Ie===ze)return ht=!0,0;var hr=!Ie.compareDocumentPosition-!ze.compareDocumentPosition;return hr||(hr=(Ie.ownerDocument||Ie)==(ze.ownerDocument||ze)?Ie.compareDocumentPosition(ze):1,hr&1||!E.sortDetached&&ze.compareDocumentPosition(Ie)===hr?Ie===xt||Ie.ownerDocument==Ne&&Ai.contains(Ne,Ie)?-1:ze===xt||ze.ownerDocument==Ne&&Ai.contains(Ne,ze)?1:tt?c.call(tt,Ie)-c.call(tt,ze):0:hr&4?-1:1)}),xt}Ai.matches=function(zt,ne){return Ai(zt,null,null,ne)},Ai.matchesSelector=function(zt,ne){if(il(zt),Wt&&!er[ne+" "]&&(!oe||!oe.test(ne)))try{var _e=Oe.call(zt,ne);if(_e||E.disconnectedMatch||zt.document&&zt.document.nodeType!==11)return _e}catch{er(ne,!0)}return Ai(ne,xt,null,[zt]).length>0},Ai.contains=function(zt,ne){return(zt.ownerDocument||zt)!=xt&&il(zt),F.contains(zt,ne)},Ai.attr=function(zt,ne){(zt.ownerDocument||zt)!=xt&&il(zt);var _e=V.attrHandle[ne.toLowerCase()],Ie=_e&&p.call(V.attrHandle,ne.toLowerCase())?_e(zt,ne,!Wt):void 0;return Ie!==void 0?Ie:zt.getAttribute(ne)},Ai.error=function(zt){throw new Error("Syntax error, unrecognized expression: "+zt)},F.uniqueSort=function(zt){var ne,_e=[],Ie=0,ze=0;if(ht=!E.sortStable,tt=!E.sortStable&&i.call(zt,0),G.call(zt,jr),ht){for(;ne=zt[ze++];)ne===zt[ze]&&(Ie=_e.push(ze));for(;Ie--;)mt.call(zt,_e[Ie],1)}return tt=null,zt},F.fn.uniqueSort=function(){return this.pushStack(F.uniqueSort(i.apply(this)))},V=F.expr={cacheLength:50,createPseudo:pn,match:Nn,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(zt){return zt[1]=zt[1].replace(Fs,Fo),zt[3]=(zt[3]||zt[4]||zt[5]||"").replace(Fs,Fo),zt[2]==="~="&&(zt[3]=" "+zt[3]+" "),zt.slice(0,4)},CHILD:function(zt){return zt[1]=zt[1].toLowerCase(),zt[1].slice(0,3)==="nth"?(zt[3]||Ai.error(zt[0]),zt[4]=+(zt[4]?zt[5]+(zt[6]||1):2*(zt[3]==="even"||zt[3]==="odd")),zt[5]=+(zt[7]+zt[8]||zt[3]==="odd")):zt[3]&&Ai.error(zt[0]),zt},PSEUDO:function(zt){var ne,_e=!zt[6]&&zt[2];return Nn.CHILD.test(zt[0])?null:(zt[3]?zt[2]=zt[4]||zt[5]||"":_e&&$n.test(_e)&&(ne=mc(_e,!0))&&(ne=_e.indexOf(")",_e.length-ne)-_e.length)&&(zt[0]=zt[0].slice(0,ne),zt[2]=_e.slice(0,ne)),zt.slice(0,3))}},filter:{TAG:function(zt){var ne=zt.replace(Fs,Fo).toLowerCase();return zt==="*"?function(){return!0}:function(_e){return ot(_e,ne)}},CLASS:function(zt){var ne=fn[zt+" "];return ne||(ne=new RegExp("(^|"+Mt+")"+zt+"("+Mt+"|$)"))&&fn(zt,function(_e){return ne.test(typeof _e.className=="string"&&_e.className||typeof _e.getAttribute<"u"&&_e.getAttribute("class")||"")})},ATTR:function(zt,ne,_e){return function(Ie){var ze=Ai.attr(Ie,zt);return ze==null?ne==="!=":ne?(ze+="",ne==="="?ze===_e:ne==="!="?ze!==_e:ne==="^="?_e&&ze.indexOf(_e)===0:ne==="*="?_e&&ze.indexOf(_e)>-1:ne==="$="?_e&&ze.slice(-_e.length)===_e:ne==="~="?(" "+ze.replace(gn," ")+" ").indexOf(_e)>-1:ne==="|="?ze===_e||ze.slice(0,_e.length+1)===_e+"-":!1):!0}},CHILD:function(zt,ne,_e,Ie,ze){var hr=zt.slice(0,3)!=="nth",nr=zt.slice(-4)!=="last",pr=ne==="of-type";return Ie===1&&ze===0?function(Pr){return!!Pr.parentNode}:function(Pr,Sn,dr){var kr,xn,sn,xi,Go,zs=hr!==nr?"nextSibling":"previousSibling",qa=Pr.parentNode,Js=pr&&Pr.nodeName.toLowerCase(),Ac=!dr&&!pr,po=!1;if(qa){if(hr){for(;zs;){for(sn=Pr;sn=sn[zs];)if(pr?ot(sn,Js):sn.nodeType===1)return!1;Go=zs=zt==="only"&&!Go&&"nextSibling"}return!0}if(Go=[nr?qa.firstChild:qa.lastChild],nr&&Ac){for(xn=qa[Fe]||(qa[Fe]={}),kr=xn[zt]||[],xi=kr[0]===ae&&kr[1],po=xi&&kr[2],sn=xi&&qa.childNodes[xi];sn=++xi&&sn&&sn[zs]||(po=xi=0)||Go.pop();)if(sn.nodeType===1&&++po&&sn===Pr){xn[zt]=[ae,xi,po];break}}else if(Ac&&(xn=Pr[Fe]||(Pr[Fe]={}),kr=xn[zt]||[],xi=kr[0]===ae&&kr[1],po=xi),po===!1)for(;(sn=++xi&&sn&&sn[zs]||(po=xi=0)||Go.pop())&&!((pr?ot(sn,Js):sn.nodeType===1)&&++po&&(Ac&&(xn=sn[Fe]||(sn[Fe]={}),xn[zt]=[ae,po]),sn===Pr)););return po-=ze,po===Ie||po%Ie===0&&po/Ie>=0}}},PSEUDO:function(zt,ne){var _e,Ie=V.pseudos[zt]||V.setFilters[zt.toLowerCase()]||Ai.error("unsupported pseudo: "+zt);return Ie[Fe]?Ie(ne):Ie.length>1?(_e=[zt,zt,"",ne],V.setFilters.hasOwnProperty(zt.toLowerCase())?pn(function(ze,hr){for(var nr,pr=Ie(ze,ne),Pr=pr.length;Pr--;)nr=c.call(ze,pr[Pr]),ze[nr]=!(hr[nr]=pr[Pr])}):function(ze){return Ie(ze,0,_e)}):Ie}},pseudos:{not:pn(function(zt){var ne=[],_e=[],Ie=Wa(zt.replace(ct,"$1"));return Ie[Fe]?pn(function(ze,hr,nr,pr){for(var Pr,Sn=Ie(ze,null,pr,[]),dr=ze.length;dr--;)(Pr=Sn[dr])&&(ze[dr]=!(hr[dr]=Pr))}):function(ze,hr,nr){return ne[0]=ze,Ie(ne,null,nr,_e),ne[0]=null,!_e.pop()}}),has:pn(function(zt){return function(ne){return Ai(zt,ne).length>0}}),contains:pn(function(zt){return zt=zt.replace(Fs,Fo),function(ne){return(ne.textContent||F.text(ne)).indexOf(zt)>-1}}),lang:pn(function(zt){return Hi.test(zt||"")||Ai.error("unsupported lang: "+zt),zt=zt.replace(Fs,Fo).toLowerCase(),function(ne){var _e;do if(_e=Wt?ne.lang:ne.getAttribute("xml:lang")||ne.getAttribute("lang"))return _e=_e.toLowerCase(),_e===zt||_e.indexOf(zt+"-")===0;while((ne=ne.parentNode)&&ne.nodeType===1);return!1}}),target:function(zt){var ne=e.location&&e.location.hash;return ne&&ne.slice(1)===zt.id},root:function(zt){return zt===Kt},focus:function(zt){return zt===Su()&&xt.hasFocus()&&!!(zt.type||zt.href||~zt.tabIndex)},enabled:Jl(!1),disabled:Jl(!0),checked:function(zt){return ot(zt,"input")&&!!zt.checked||ot(zt,"option")&&!!zt.selected},selected:function(zt){return zt.parentNode&&zt.parentNode.selectedIndex,zt.selected===!0},empty:function(zt){for(zt=zt.firstChild;zt;zt=zt.nextSibling)if(zt.nodeType<6)return!1;return!0},parent:function(zt){return!V.pseudos.empty(zt)},header:function(zt){return Kn.test(zt.nodeName)},input:function(zt){return kn.test(zt.nodeName)},button:function(zt){return ot(zt,"input")&&zt.type==="button"||ot(zt,"button")},text:function(zt){var ne;return ot(zt,"input")&&zt.type==="text"&&((ne=zt.getAttribute("type"))==null||ne.toLowerCase()==="text")},first:Ts(function(){return[0]}),last:Ts(function(zt,ne){return[ne-1]}),eq:Ts(function(zt,ne,_e){return[_e<0?_e+ne:_e]}),even:Ts(function(zt,ne){for(var _e=0;_e<ne;_e+=2)zt.push(_e);return zt}),odd:Ts(function(zt,ne){for(var _e=1;_e<ne;_e+=2)zt.push(_e);return zt}),lt:Ts(function(zt,ne,_e){var Ie;for(_e<0?Ie=_e+ne:_e>ne?Ie=ne:Ie=_e;--Ie>=0;)zt.push(Ie);return zt}),gt:Ts(function(zt,ne,_e){for(var Ie=_e<0?_e+ne:_e;++Ie<ne;)zt.push(Ie);return zt})}},V.pseudos.nth=V.pseudos.eq;for(R in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})V.pseudos[R]=dn(R);for(R in{submit:!0,reset:!0})V.pseudos[R]=mp(R);function It(){}It.prototype=V.filters=V.pseudos,V.setFilters=new It;function mc(zt,ne){var _e,Ie,ze,hr,nr,pr,Pr,Sn=se[zt+" "];if(Sn)return ne?0:Sn.slice(0);for(nr=zt,pr=[],Pr=V.preFilter;nr;){(!_e||(Ie=ni.exec(nr)))&&(Ie&&(nr=nr.slice(Ie[0].length)||nr),pr.push(ze=[])),_e=!1,(Ie=ji.exec(nr))&&(_e=Ie.shift(),ze.push({value:_e,type:Ie[0].replace(ct," ")}),nr=nr.slice(_e.length));for(hr in V.filter)(Ie=Nn[hr].exec(nr))&&(!Pr[hr]||(Ie=Pr[hr](Ie)))&&(_e=Ie.shift(),ze.push({value:_e,type:hr,matches:Ie}),nr=nr.slice(_e.length));if(!_e)break}return ne?nr.length:nr?Ai.error(zt):se(zt,pr).slice(0)}function Tl(zt){for(var ne=0,_e=zt.length,Ie="";ne<_e;ne++)Ie+=zt[ne].value;return Ie}function tu(zt,ne,_e){var Ie=ne.dir,ze=ne.next,hr=ze||Ie,nr=_e&&hr==="parentNode",pr=rr++;return ne.first?function(Pr,Sn,dr){for(;Pr=Pr[Ie];)if(Pr.nodeType===1||nr)return zt(Pr,Sn,dr);return!1}:function(Pr,Sn,dr){var kr,xn,sn=[ae,pr];if(dr){for(;Pr=Pr[Ie];)if((Pr.nodeType===1||nr)&&zt(Pr,Sn,dr))return!0}else for(;Pr=Pr[Ie];)if(Pr.nodeType===1||nr)if(xn=Pr[Fe]||(Pr[Fe]={}),ze&&ot(Pr,ze))Pr=Pr[Ie]||Pr;else{if((kr=xn[hr])&&kr[0]===ae&&kr[1]===pr)return sn[2]=kr[2];if(xn[hr]=sn,sn[2]=zt(Pr,Sn,dr))return!0}return!1}}function ph(zt){return zt.length>1?function(ne,_e,Ie){for(var ze=zt.length;ze--;)if(!zt[ze](ne,_e,Ie))return!1;return!0}:zt[0]}function cf(zt,ne,_e){for(var Ie=0,ze=ne.length;Ie<ze;Ie++)Ai(zt,ne[Ie],_e);return _e}function lf(zt,ne,_e,Ie,ze){for(var hr,nr=[],pr=0,Pr=zt.length,Sn=ne!=null;pr<Pr;pr++)(hr=zt[pr])&&(!_e||_e(hr,Ie,ze))&&(nr.push(hr),Sn&&ne.push(pr));return nr}function eu(zt,ne,_e,Ie,ze,hr){return Ie&&!Ie[Fe]&&(Ie=eu(Ie)),ze&&!ze[Fe]&&(ze=eu(ze,hr)),pn(function(nr,pr,Pr,Sn){var dr,kr,xn,sn,xi=[],Go=[],zs=pr.length,qa=nr||cf(ne||"*",Pr.nodeType?[Pr]:Pr,[]),Js=zt&&(nr||!ne)?lf(qa,xi,zt,Pr,Sn):qa;if(_e?(sn=ze||(nr?zt:zs||Ie)?[]:pr,_e(Js,sn,Pr,Sn)):sn=Js,Ie)for(dr=lf(sn,Go),Ie(dr,[],Pr,Sn),kr=dr.length;kr--;)(xn=dr[kr])&&(sn[Go[kr]]=!(Js[Go[kr]]=xn));if(nr){if(ze||zt){if(ze){for(dr=[],kr=sn.length;kr--;)(xn=sn[kr])&&dr.push(Js[kr]=xn);ze(null,sn=[],dr,Sn)}for(kr=sn.length;kr--;)(xn=sn[kr])&&(dr=ze?c.call(nr,xn):xi[kr])>-1&&(nr[dr]=!(pr[dr]=xn))}}else sn=lf(sn===pr?sn.splice(zs,sn.length):sn),ze?ze(null,pr,sn,Sn):ft.apply(pr,sn)})}function Cu(zt){for(var ne,_e,Ie,ze=zt.length,hr=V.relative[zt[0].type],nr=hr||V.relative[" "],pr=hr?1:0,Pr=tu(function(kr){return kr===ne},nr,!0),Sn=tu(function(kr){return c.call(ne,kr)>-1},nr,!0),dr=[function(kr,xn,sn){var xi=!hr&&(sn||xn!=Y)||((ne=xn).nodeType?Pr(kr,xn,sn):Sn(kr,xn,sn));return ne=null,xi}];pr<ze;pr++)if(_e=V.relative[zt[pr].type])dr=[tu(ph(dr),_e)];else{if(_e=V.filter[zt[pr].type].apply(null,zt[pr].matches),_e[Fe]){for(Ie=++pr;Ie<ze&&!V.relative[zt[Ie].type];Ie++);return eu(pr>1&&ph(dr),pr>1&&Tl(zt.slice(0,pr-1).concat({value:zt[pr-2].type===" "?"*":""})).replace(ct,"$1"),_e,pr<Ie&&Cu(zt.slice(pr,Ie)),Ie<ze&&Cu(zt=zt.slice(Ie)),Ie<ze&&Tl(zt))}dr.push(_e)}return ph(dr)}function Ap(zt,ne){var _e=ne.length>0,Ie=zt.length>0,ze=function(hr,nr,pr,Pr,Sn){var dr,kr,xn,sn=0,xi="0",Go=hr&&[],zs=[],qa=Y,Js=hr||Ie&&V.find.TAG("*",Sn),Ac=ae+=qa==null?1:Math.random()||.1,po=Js.length;for(Sn&&(Y=nr==xt||nr||Sn);xi!==po&&(dr=Js[xi])!=null;xi++){if(Ie&&dr){for(kr=0,!nr&&dr.ownerDocument!=xt&&(il(dr),pr=!Wt);xn=zt[kr++];)if(xn(dr,nr||xt,pr)){ft.call(Pr,dr);break}Sn&&(ae=Ac)}_e&&((dr=!xn&&dr)&&sn--,hr&&Go.push(dr))}if(sn+=xi,_e&&xi!==sn){for(kr=0;xn=ne[kr++];)xn(Go,zs,nr,pr);if(hr){if(sn>0)for(;xi--;)Go[xi]||zs[xi]||(zs[xi]=J.call(Pr));zs=lf(zs)}ft.apply(Pr,zs),Sn&&!hr&&zs.length>0&&sn+ne.length>1&&F.uniqueSort(Pr)}return Sn&&(ae=Ac,Y=qa),Go};return _e?pn(ze):ze}function Wa(zt,ne){var _e,Ie=[],ze=[],hr=ve[zt+" "];if(!hr){for(ne||(ne=mc(zt)),_e=ne.length;_e--;)hr=Cu(ne[_e]),hr[Fe]?Ie.push(hr):ze.push(hr);hr=ve(zt,Ap(ze,Ie)),hr.selector=zt}return hr}function Io(zt,ne,_e,Ie){var ze,hr,nr,pr,Pr,Sn=typeof zt=="function"&&zt,dr=!Ie&&mc(zt=Sn.selector||zt);if(_e=_e||[],dr.length===1){if(hr=dr[0]=dr[0].slice(0),hr.length>2&&(nr=hr[0]).type==="ID"&&ne.nodeType===9&&Wt&&V.relative[hr[1].type]){if(ne=(V.find.ID(nr.matches[0].replace(Fs,Fo),ne)||[])[0],ne)Sn&&(ne=ne.parentNode);else return _e;zt=zt.slice(hr.shift().value.length)}for(ze=Nn.needsContext.test(zt)?0:hr.length;ze--&&(nr=hr[ze],!V.relative[pr=nr.type]);)if((Pr=V.find[pr])&&(Ie=Pr(nr.matches[0].replace(Fs,Fo),dp.test(hr[0].type)&&af(ne.parentNode)||ne))){if(hr.splice(ze,1),zt=Ie.length&&Tl(hr),!zt)return ft.apply(_e,Ie),_e;break}}return(Sn||Wa(zt,dr))(Ie,ne,!Wt,_e,!ne||dp.test(zt)&&af(ne.parentNode)||ne),_e}E.sortStable=Fe.split("").sort(jr).join("")===Fe,il(),E.sortDetached=Bt(function(zt){return zt.compareDocumentPosition(xt.createElement("fieldset"))&1}),F.find=Ai,F.expr[":"]=F.expr.pseudos,F.unique=F.uniqueSort,Ai.compile=Wa,Ai.select=Io,Ai.setDocument=il,Ai.tokenize=mc,Ai.escape=F.escapeSelector,Ai.getText=F.text,Ai.isXML=F.isXMLDoc,Ai.selectors=F.expr,Ai.support=F.support,Ai.uniqueSort=F.uniqueSort})();var sr=function(R,V,Y){for(var tt=[],ht=Y!==void 0;(R=R[V])&&R.nodeType!==9;)if(R.nodeType===1){if(ht&&F(R).is(Y))break;tt.push(R)}return tt},gr=function(R,V){for(var Y=[];R;R=R.nextSibling)R.nodeType===1&&R!==V&&Y.push(R);return Y},Xr=F.expr.match.needsContext,ir=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function on(R,V,Y){return P(V)?F.grep(R,function(tt,ht){return!!V.call(tt,ht,tt)!==Y}):V.nodeType?F.grep(R,function(tt){return tt===V!==Y}):typeof V!="string"?F.grep(R,function(tt){return c.call(V,tt)>-1!==Y}):F.filter(V,R,Y)}F.filter=function(R,V,Y){var tt=V[0];return Y&&(R=":not("+R+")"),V.length===1&&tt.nodeType===1?F.find.matchesSelector(tt,R)?[tt]:[]:F.find.matches(R,F.grep(V,function(ht){return ht.nodeType===1}))},F.fn.extend({find:function(R){var V,Y,tt=this.length,ht=this;if(typeof R!="string")return this.pushStack(F(R).filter(function(){for(V=0;V<tt;V++)if(F.contains(ht[V],this))return!0}));for(Y=this.pushStack([]),V=0;V<tt;V++)F.find(R,ht[V],Y);return tt>1?F.uniqueSort(Y):Y},filter:function(R){return this.pushStack(on(this,R||[],!1))},not:function(R){return this.pushStack(on(this,R||[],!0))},is:function(R){return!!on(this,typeof R=="string"&&Xr.test(R)?F(R):R||[],!1).length}});var Xe,He=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,_n=F.fn.init=function(R,V,Y){var tt,ht;if(!R)return this;if(Y=Y||Xe,typeof R=="string")if(R[0]==="<"&&R[R.length-1]===">"&&R.length>=3?tt=[null,R,null]:tt=He.exec(R),tt&&(tt[1]||!V))if(tt[1]){if(V=V instanceof F?V[0]:V,F.merge(this,F.parseHTML(tt[1],V&&V.nodeType?V.ownerDocument||V:D,!0)),ir.test(tt[1])&&F.isPlainObject(V))for(tt in V)P(this[tt])?this[tt](V[tt]):this.attr(tt,V[tt]);return this}else return ht=D.getElementById(tt[2]),ht&&(this[0]=ht,this.length=1),this;else return!V||V.jquery?(V||Y).find(R):this.constructor(V).find(R);else{if(R.nodeType)return this[0]=R,this.length=1,this;if(P(R))return Y.ready!==void 0?Y.ready(R):R(F)}return F.makeArray(R,this)};_n.prototype=F.fn,Xe=F(D);var dt=/^(?:parents|prev(?:Until|All))/,wt={children:!0,contents:!0,next:!0,prev:!0};F.fn.extend({has:function(R){var V=F(R,this),Y=V.length;return this.filter(function(){for(var tt=0;tt<Y;tt++)if(F.contains(this,V[tt]))return!0})},closest:function(R,V){var Y,tt=0,ht=this.length,ft=[],xt=typeof R!="string"&&F(R);if(!Xr.test(R)){for(;tt<ht;tt++)for(Y=this[tt];Y&&Y!==V;Y=Y.parentNode)if(Y.nodeType<11&&(xt?xt.index(Y)>-1:Y.nodeType===1&&F.find.matchesSelector(Y,R))){ft.push(Y);break}}return this.pushStack(ft.length>1?F.uniqueSort(ft):ft)},index:function(R){return R?typeof R=="string"?c.call(F(R),this[0]):c.call(this,R.jquery?R[0]:R):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(R,V){return this.pushStack(F.uniqueSort(F.merge(this.get(),F(R,V))))},addBack:function(R){return this.add(R==null?this.prevObject:this.prevObject.filter(R))}});function Ht(R,V){for(;(R=R[V])&&R.nodeType!==1;);return R}F.each({parent:function(R){var V=R.parentNode;return V&&V.nodeType!==11?V:null},parents:function(R){return sr(R,"parentNode")},parentsUntil:function(R,V,Y){return sr(R,"parentNode",Y)},next:function(R){return Ht(R,"nextSibling")},prev:function(R){return Ht(R,"previousSibling")},nextAll:function(R){return sr(R,"nextSibling")},prevAll:function(R){return sr(R,"previousSibling")},nextUntil:function(R,V,Y){return sr(R,"nextSibling",Y)},prevUntil:function(R,V,Y){return sr(R,"previousSibling",Y)},siblings:function(R){return gr((R.parentNode||{}).firstChild,R)},children:function(R){return gr(R.firstChild)},contents:function(R){return R.contentDocument!=null&&n(R.contentDocument)?R.contentDocument:(ot(R,"template")&&(R=R.content||R),F.merge([],R.childNodes))}},function(R,V){F.fn[R]=function(Y,tt){var ht=F.map(this,V,Y);return R.slice(-5)!=="Until"&&(tt=Y),tt&&typeof tt=="string"&&(ht=F.filter(tt,ht)),this.length>1&&(wt[R]||F.uniqueSort(ht),dt.test(R)&&ht.reverse()),this.pushStack(ht)}});var ue=/[^\x20\t\r\n\f]+/g;function Le(R){var V={};return F.each(R.match(ue)||[],function(Y,tt){V[tt]=!0}),V}F.Callbacks=function(R){R=typeof R=="string"?Le(R):F.extend({},R);var V,Y,tt,ht,ft=[],xt=[],Kt=-1,Wt=function(){for(ht=ht||R.once,tt=V=!0;xt.length;Kt=-1)for(Y=xt.shift();++Kt<ft.length;)ft[Kt].apply(Y[0],Y[1])===!1&&R.stopOnFalse&&(Kt=ft.length,Y=!1);R.memory||(Y=!1),V=!1,ht&&(Y?ft=[]:ft="")},oe={add:function(){return ft&&(Y&&!V&&(Kt=ft.length-1,xt.push(Y)),function Oe(Fe){F.each(Fe,function(ae,rr){P(rr)?(!R.unique||!oe.has(rr))&&ft.push(rr):rr&&rr.length&&q(rr)!=="string"&&Oe(rr)})}(arguments),Y&&!V&&Wt()),this},remove:function(){return F.each(arguments,function(Oe,Fe){for(var ae;(ae=F.inArray(Fe,ft,ae))>-1;)ft.splice(ae,1),ae<=Kt&&Kt--}),this},has:function(Oe){return Oe?F.inArray(Oe,ft)>-1:ft.length>0},empty:function(){return ft&&(ft=[]),this},disable:function(){return ht=xt=[],ft=Y="",this},disabled:function(){return!ft},lock:function(){return ht=xt=[],!Y&&!V&&(ft=Y=""),this},locked:function(){return!!ht},fireWith:function(Oe,Fe){return ht||(Fe=Fe||[],Fe=[Oe,Fe.slice?Fe.slice():Fe],xt.push(Fe),V||Wt()),this},fire:function(){return oe.fireWith(this,arguments),this},fired:function(){return!!tt}};return oe};function Ee(R){return R}function Jr(R){throw R}function bn(R,V,Y,tt){var ht;try{R&&P(ht=R.promise)?ht.call(R).done(V).fail(Y):R&&P(ht=R.then)?ht.call(R,V,Y):V.apply(void 0,[R].slice(tt))}catch(ft){Y.apply(void 0,[ft])}}F.extend({Deferred:function(R){var V=[["notify","progress",F.Callbacks("memory"),F.Callbacks("memory"),2],["resolve","done",F.Callbacks("once memory"),F.Callbacks("once memory"),0,"resolved"],["reject","fail",F.Callbacks("once memory"),F.Callbacks("once memory"),1,"rejected"]],Y="pending",tt={state:function(){return Y},always:function(){return ht.done(arguments).fail(arguments),this},catch:function(ft){return tt.then(null,ft)},pipe:function(){var ft=arguments;return F.Deferred(function(xt){F.each(V,function(Kt,Wt){var oe=P(ft[Wt[4]])&&ft[Wt[4]];ht[Wt[1]](function(){var Oe=oe&&oe.apply(this,arguments);Oe&&P(Oe.promise)?Oe.promise().progress(xt.notify).done(xt.resolve).fail(xt.reject):xt[Wt[0]+"With"](this,oe?[Oe]:arguments)})}),ft=null}).promise()},then:function(ft,xt,Kt){var Wt=0;function oe(Oe,Fe,ae,rr){return function(){var fn=this,se=arguments,ve=function(){var jr,_;if(!(Oe<Wt)){if(jr=ae.apply(fn,se),jr===Fe.promise())throw new TypeError("Thenable self-resolution");_=jr&&(typeof jr=="object"||typeof jr=="function")&&jr.then,P(_)?rr?_.call(jr,oe(Wt,Fe,Ee,rr),oe(Wt,Fe,Jr,rr)):(Wt++,_.call(jr,oe(Wt,Fe,Ee,rr),oe(Wt,Fe,Jr,rr),oe(Wt,Fe,Ee,Fe.notifyWith))):(ae!==Ee&&(fn=void 0,se=[jr]),(rr||Fe.resolveWith)(fn,se))}},er=rr?ve:function(){try{ve()}catch(jr){F.Deferred.exceptionHook&&F.Deferred.exceptionHook(jr,er.error),Oe+1>=Wt&&(ae!==Jr&&(fn=void 0,se=[jr]),Fe.rejectWith(fn,se))}};Oe?er():(F.Deferred.getErrorHook?er.error=F.Deferred.getErrorHook():F.Deferred.getStackHook&&(er.error=F.Deferred.getStackHook()),e.setTimeout(er))}}return F.Deferred(function(Oe){V[0][3].add(oe(0,Oe,P(Kt)?Kt:Ee,Oe.notifyWith)),V[1][3].add(oe(0,Oe,P(ft)?ft:Ee)),V[2][3].add(oe(0,Oe,P(xt)?xt:Jr))}).promise()},promise:function(ft){return ft!=null?F.extend(ft,tt):tt}},ht={};return F.each(V,function(ft,xt){var Kt=xt[2],Wt=xt[5];tt[xt[1]]=Kt.add,Wt&&Kt.add(function(){Y=Wt},V[3-ft][2].disable,V[3-ft][3].disable,V[0][2].lock,V[0][3].lock),Kt.add(xt[3].fire),ht[xt[0]]=function(){return ht[xt[0]+"With"](this===ht?void 0:this,arguments),this},ht[xt[0]+"With"]=Kt.fireWith}),tt.promise(ht),R&&R.call(ht,ht),ht},when:function(R){var V=arguments.length,Y=V,tt=Array(Y),ht=i.call(arguments),ft=F.Deferred(),xt=function(Kt){return function(Wt){tt[Kt]=this,ht[Kt]=arguments.length>1?i.call(arguments):Wt,--V||ft.resolveWith(tt,ht)}};if(V<=1&&(bn(R,ft.done(xt(Y)).resolve,ft.reject,!V),ft.state()==="pending"||P(ht[Y]&&ht[Y].then)))return ft.then();for(;Y--;)bn(ht[Y],xt(Y),ft.reject);return ft.promise()}});var ai=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;F.Deferred.exceptionHook=function(R,V){e.console&&e.console.warn&&R&&ai.test(R.name)&&e.console.warn("jQuery.Deferred exception: "+R.message,R.stack,V)},F.readyException=function(R){e.setTimeout(function(){throw R})};var qo=F.Deferred();F.fn.ready=function(R){return qo.then(R).catch(function(V){F.readyException(V)}),this},F.extend({isReady:!1,readyWait:1,ready:function(R){(R===!0?--F.readyWait:F.isReady)||(F.isReady=!0,!(R!==!0&&--F.readyWait>0)&&qo.resolveWith(D,[F]))}}),F.ready.then=qo.then;function _i(){D.removeEventListener("DOMContentLoaded",_i),e.removeEventListener("load",_i),F.ready()}D.readyState==="complete"||D.readyState!=="loading"&&!D.documentElement.doScroll?e.setTimeout(F.ready):(D.addEventListener("DOMContentLoaded",_i),e.addEventListener("load",_i));var Xn=function(R,V,Y,tt,ht,ft,xt){var Kt=0,Wt=R.length,oe=Y==null;if(q(Y)==="object"){ht=!0;for(Kt in Y)Xn(R,V,Kt,Y[Kt],!0,ft,xt)}else if(tt!==void 0&&(ht=!0,P(tt)||(xt=!0),oe&&(xt?(V.call(R,tt),V=null):(oe=V,V=function(Oe,Fe,ae){return oe.call(F(Oe),ae)})),V))for(;Kt<Wt;Kt++)V(R[Kt],Y,xt?tt:tt.call(R[Kt],Kt,V(R[Kt],Y)));return ht?R:oe?V.call(R):Wt?V(R[0],Y):ft},Ui=/^-ms-/,bs=/-([a-z])/g;function Vi(R,V){return V.toUpperCase()}function Cn(R){return R.replace(Ui,"ms-").replace(bs,Vi)}var yi=function(R){return R.nodeType===1||R.nodeType===9||!+R.nodeType};function _o(){this.expando=F.expando+_o.uid++}_o.uid=1,_o.prototype={cache:function(R){var V=R[this.expando];return V||(V={},yi(R)&&(R.nodeType?R[this.expando]=V:Object.defineProperty(R,this.expando,{value:V,configurable:!0}))),V},set:function(R,V,Y){var tt,ht=this.cache(R);if(typeof V=="string")ht[Cn(V)]=Y;else for(tt in V)ht[Cn(tt)]=V[tt];return ht},get:function(R,V){return V===void 0?this.cache(R):R[this.expando]&&R[this.expando][Cn(V)]},access:function(R,V,Y){return V===void 0||V&&typeof V=="string"&&Y===void 0?this.get(R,V):(this.set(R,V,Y),Y!==void 0?Y:V)},remove:function(R,V){var Y,tt=R[this.expando];if(tt!==void 0){if(V!==void 0)for(Array.isArray(V)?V=V.map(Cn):(V=Cn(V),V=V in tt?[V]:V.match(ue)||[]),Y=V.length;Y--;)delete tt[V[Y]];(V===void 0||F.isEmptyObject(tt))&&(R.nodeType?R[this.expando]=void 0:delete R[this.expando])}},hasData:function(R){var V=R[this.expando];return V!==void 0&&!F.isEmptyObject(V)}};var Nr=new _o,ar=new _o,zr=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,hn=/[A-Z]/g;function ho(R){return R==="true"?!0:R==="false"?!1:R==="null"?null:R===+R+""?+R:zr.test(R)?JSON.parse(R):R}function ki(R,V,Y){var tt;if(Y===void 0&&R.nodeType===1)if(tt="data-"+V.replace(hn,"-$&").toLowerCase(),Y=R.getAttribute(tt),typeof Y=="string"){try{Y=ho(Y)}catch{}ar.set(R,V,Y)}else Y=void 0;return Y}F.extend({hasData:function(R){return ar.hasData(R)||Nr.hasData(R)},data:function(R,V,Y){return ar.access(R,V,Y)},removeData:function(R,V){ar.remove(R,V)},_data:function(R,V,Y){return Nr.access(R,V,Y)},_removeData:function(R,V){Nr.remove(R,V)}}),F.fn.extend({data:function(R,V){var Y,tt,ht,ft=this[0],xt=ft&&ft.attributes;if(R===void 0){if(this.length&&(ht=ar.get(ft),ft.nodeType===1&&!Nr.get(ft,"hasDataAttrs"))){for(Y=xt.length;Y--;)xt[Y]&&(tt=xt[Y].name,tt.indexOf("data-")===0&&(tt=Cn(tt.slice(5)),ki(ft,tt,ht[tt])));Nr.set(ft,"hasDataAttrs",!0)}return ht}return typeof R=="object"?this.each(function(){ar.set(this,R)}):Xn(this,function(Kt){var Wt;if(ft&&Kt===void 0)return Wt=ar.get(ft,R),Wt!==void 0||(Wt=ki(ft,R),Wt!==void 0)?Wt:void 0;this.each(function(){ar.set(this,R,Kt)})},null,V,arguments.length>1,null,!0)},removeData:function(R){return this.each(function(){ar.remove(this,R)})}}),F.extend({queue:function(R,V,Y){var tt;if(R)return V=(V||"fx")+"queue",tt=Nr.get(R,V),Y&&(!tt||Array.isArray(Y)?tt=Nr.access(R,V,F.makeArray(Y)):tt.push(Y)),tt||[]},dequeue:function(R,V){V=V||"fx";var Y=F.queue(R,V),tt=Y.length,ht=Y.shift(),ft=F._queueHooks(R,V),xt=function(){F.dequeue(R,V)};ht==="inprogress"&&(ht=Y.shift(),tt--),ht&&(V==="fx"&&Y.unshift("inprogress"),delete ft.stop,ht.call(R,xt,ft)),!tt&&ft&&ft.empty.fire()},_queueHooks:function(R,V){var Y=V+"queueHooks";return Nr.get(R,Y)||Nr.access(R,Y,{empty:F.Callbacks("once memory").add(function(){Nr.remove(R,[V+"queue",Y])})})}}),F.fn.extend({queue:function(R,V){var Y=2;return typeof R!="string"&&(V=R,R="fx",Y--),arguments.length<Y?F.queue(this[0],R):V===void 0?this:this.each(function(){var tt=F.queue(this,R,V);F._queueHooks(this,R),R==="fx"&&tt[0]!=="inprogress"&&F.dequeue(this,R)})},dequeue:function(R){return this.each(function(){F.dequeue(this,R)})},clearQueue:function(R){return this.queue(R||"fx",[])},promise:function(R,V){var Y,tt=1,ht=F.Deferred(),ft=this,xt=this.length,Kt=function(){--tt||ht.resolveWith(ft,[ft])};for(typeof R!="string"&&(V=R,R=void 0),R=R||"fx";xt--;)Y=Nr.get(ft[xt],R+"queueHooks"),Y&&Y.empty&&(tt++,Y.empty.add(Kt));return Kt(),ht.promise(V)}});var ds=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,es=new RegExp("^(?:([+-])=|)("+ds+")([a-z%]*)$","i"),rs=["Top","Right","Bottom","Left"],No=D.documentElement,ha=function(R){return F.contains(R.ownerDocument,R)},ch={composed:!0};No.getRootNode&&(ha=function(R){return F.contains(R.ownerDocument,R)||R.getRootNode(ch)===R.ownerDocument});var Xl=function(R,V){return R=V||R,R.style.display==="none"||R.style.display===""&&ha(R)&&F.css(R,"display")==="none"};function vu(R,V,Y,tt){var ht,ft,xt=20,Kt=tt?function(){return tt.cur()}:function(){return F.css(R,V,"")},Wt=Kt(),oe=Y&&Y[3]||(F.cssNumber[V]?"":"px"),Oe=R.nodeType&&(F.cssNumber[V]||oe!=="px"&&+Wt)&&es.exec(F.css(R,V));if(Oe&&Oe[3]!==oe){for(Wt=Wt/2,oe=oe||Oe[3],Oe=+Wt||1;xt--;)F.style(R,V,Oe+oe),(1-ft)*(1-(ft=Kt()/Wt||.5))<=0&&(xt=0),Oe=Oe/ft;Oe=Oe*2,F.style(R,V,Oe+oe),Y=Y||[]}return Y&&(Oe=+Oe||+Wt||0,ht=Y[1]?Oe+(Y[1]+1)*Y[2]:+Y[2],tt&&(tt.unit=oe,tt.start=Oe,tt.end=ht)),ht}var wl={};function el(R){var V,Y=R.ownerDocument,tt=R.nodeName,ht=wl[tt];return ht||(V=Y.body.appendChild(Y.createElement(tt)),ht=F.css(V,"display"),V.parentNode.removeChild(V),ht==="none"&&(ht="block"),wl[tt]=ht,ht)}function fa(R,V){for(var Y,tt,ht=[],ft=0,xt=R.length;ft<xt;ft++)tt=R[ft],tt.style&&(Y=tt.style.display,V?(Y==="none"&&(ht[ft]=Nr.get(tt,"display")||null,ht[ft]||(tt.style.display="")),tt.style.display===""&&Xl(tt)&&(ht[ft]=el(tt))):Y!=="none"&&(ht[ft]="none",Nr.set(tt,"display",Y)));for(ft=0;ft<xt;ft++)ht[ft]!=null&&(R[ft].style.display=ht[ft]);return R}F.fn.extend({show:function(){return fa(this,!0)},hide:function(){return fa(this)},toggle:function(R){return typeof R=="boolean"?R?this.show():this.hide():this.each(function(){Xl(this)?F(this).show():F(this).hide()})}});var hc=/^(?:checkbox|radio)$/i,bu=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,fo=/^$|^module$|\/(?:java|ecma)script/i;(function(){var R=D.createDocumentFragment(),V=R.appendChild(D.createElement("div")),Y=D.createElement("input");Y.setAttribute("type","radio"),Y.setAttribute("checked","checked"),Y.setAttribute("name","t"),V.appendChild(Y),E.checkClone=V.cloneNode(!0).cloneNode(!0).lastChild.checked,V.innerHTML="<textarea>x</textarea>",E.noCloneChecked=!!V.cloneNode(!0).lastChild.defaultValue,V.innerHTML="<option></option>",E.option=!!V.lastChild})();var at={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};at.tbody=at.tfoot=at.colgroup=at.caption=at.thead,at.th=at.td,E.option||(at.optgroup=at.option=[1,"<select multiple='multiple'>","</select>"]);function At(R,V){var Y;return typeof R.getElementsByTagName<"u"?Y=R.getElementsByTagName(V||"*"):typeof R.querySelectorAll<"u"?Y=R.querySelectorAll(V||"*"):Y=[],V===void 0||V&&ot(R,V)?F.merge([R],Y):Y}function bt(R,V){for(var Y=0,tt=R.length;Y<tt;Y++)Nr.set(R[Y],"globalEval",!V||Nr.get(V[Y],"globalEval"))}var Lt=/<|&#?\w+;/;function vt(R,V,Y,tt,ht){for(var ft,xt,Kt,Wt,oe,Oe,Fe=V.createDocumentFragment(),ae=[],rr=0,fn=R.length;rr<fn;rr++)if(ft=R[rr],ft||ft===0)if(q(ft)==="object")F.merge(ae,ft.nodeType?[ft]:ft);else if(!Lt.test(ft))ae.push(V.createTextNode(ft));else{for(xt=xt||Fe.appendChild(V.createElement("div")),Kt=(bu.exec(ft)||["",""])[1].toLowerCase(),Wt=at[Kt]||at._default,xt.innerHTML=Wt[1]+F.htmlPrefilter(ft)+Wt[2],Oe=Wt[0];Oe--;)xt=xt.lastChild;F.merge(ae,xt.childNodes),xt=Fe.firstChild,xt.textContent=""}for(Fe.textContent="",rr=0;ft=ae[rr++];){if(tt&&F.inArray(ft,tt)>-1){ht&&ht.push(ft);continue}if(oe=ha(ft),xt=At(Fe.appendChild(ft),"script"),oe&&bt(xt),Y)for(Oe=0;ft=xt[Oe++];)fo.test(ft.type||"")&&Y.push(ft)}return Fe}var Qt=/^([^.]*)(?:\.(.+)|)/;function Jt(){return!0}function St(){return!1}function jt(R,V,Y,tt,ht,ft){var xt,Kt;if(typeof V=="object"){typeof Y!="string"&&(tt=tt||Y,Y=void 0);for(Kt in V)jt(R,Kt,Y,tt,V[Kt],ft);return R}if(tt==null&&ht==null?(ht=Y,tt=Y=void 0):ht==null&&(typeof Y=="string"?(ht=tt,tt=void 0):(ht=tt,tt=Y,Y=void 0)),ht===!1)ht=St;else if(!ht)return R;return ft===1&&(xt=ht,ht=function(Wt){return F().off(Wt),xt.apply(this,arguments)},ht.guid=xt.guid||(xt.guid=F.guid++)),R.each(function(){F.event.add(this,V,ht,tt,Y)})}F.event={global:{},add:function(R,V,Y,tt,ht){var ft,xt,Kt,Wt,oe,Oe,Fe,ae,rr,fn,se,ve=Nr.get(R);if(yi(R))for(Y.handler&&(ft=Y,Y=ft.handler,ht=ft.selector),ht&&F.find.matchesSelector(No,ht),Y.guid||(Y.guid=F.guid++),(Wt=ve.events)||(Wt=ve.events=Object.create(null)),(xt=ve.handle)||(xt=ve.handle=function(er){return typeof F<"u"&&F.event.triggered!==er.type?F.event.dispatch.apply(R,arguments):void 0}),V=(V||"").match(ue)||[""],oe=V.length;oe--;)Kt=Qt.exec(V[oe])||[],rr=se=Kt[1],fn=(Kt[2]||"").split(".").sort(),rr&&(Fe=F.event.special[rr]||{},rr=(ht?Fe.delegateType:Fe.bindType)||rr,Fe=F.event.special[rr]||{},Oe=F.extend({type:rr,origType:se,data:tt,handler:Y,guid:Y.guid,selector:ht,needsContext:ht&&F.expr.match.needsContext.test(ht),namespace:fn.join(".")},ft),(ae=Wt[rr])||(ae=Wt[rr]=[],ae.delegateCount=0,(!Fe.setup||Fe.setup.call(R,tt,fn,xt)===!1)&&R.addEventListener&&R.addEventListener(rr,xt)),Fe.add&&(Fe.add.call(R,Oe),Oe.handler.guid||(Oe.handler.guid=Y.guid)),ht?ae.splice(ae.delegateCount++,0,Oe):ae.push(Oe),F.event.global[rr]=!0)},remove:function(R,V,Y,tt,ht){var ft,xt,Kt,Wt,oe,Oe,Fe,ae,rr,fn,se,ve=Nr.hasData(R)&&Nr.get(R);if(!(!ve||!(Wt=ve.events))){for(V=(V||"").match(ue)||[""],oe=V.length;oe--;){if(Kt=Qt.exec(V[oe])||[],rr=se=Kt[1],fn=(Kt[2]||"").split(".").sort(),!rr){for(rr in Wt)F.event.remove(R,rr+V[oe],Y,tt,!0);continue}for(Fe=F.event.special[rr]||{},rr=(tt?Fe.delegateType:Fe.bindType)||rr,ae=Wt[rr]||[],Kt=Kt[2]&&new RegExp("(^|\\.)"+fn.join("\\.(?:.*\\.|)")+"(\\.|$)"),xt=ft=ae.length;ft--;)Oe=ae[ft],(ht||se===Oe.origType)&&(!Y||Y.guid===Oe.guid)&&(!Kt||Kt.test(Oe.namespace))&&(!tt||tt===Oe.selector||tt==="**"&&Oe.selector)&&(ae.splice(ft,1),Oe.selector&&ae.delegateCount--,Fe.remove&&Fe.remove.call(R,Oe));xt&&!ae.length&&((!Fe.teardown||Fe.teardown.call(R,fn,ve.handle)===!1)&&F.removeEvent(R,rr,ve.handle),delete Wt[rr])}F.isEmptyObject(Wt)&&Nr.remove(R,"handle events")}},dispatch:function(R){var V,Y,tt,ht,ft,xt,Kt=new Array(arguments.length),Wt=F.event.fix(R),oe=(Nr.get(this,"events")||Object.create(null))[Wt.type]||[],Oe=F.event.special[Wt.type]||{};for(Kt[0]=Wt,V=1;V<arguments.length;V++)Kt[V]=arguments[V];if(Wt.delegateTarget=this,!(Oe.preDispatch&&Oe.preDispatch.call(this,Wt)===!1)){for(xt=F.event.handlers.call(this,Wt,oe),V=0;(ht=xt[V++])&&!Wt.isPropagationStopped();)for(Wt.currentTarget=ht.elem,Y=0;(ft=ht.handlers[Y++])&&!Wt.isImmediatePropagationStopped();)(!Wt.rnamespace||ft.namespace===!1||Wt.rnamespace.test(ft.namespace))&&(Wt.handleObj=ft,Wt.data=ft.data,tt=((F.event.special[ft.origType]||{}).handle||ft.handler).apply(ht.elem,Kt),tt!==void 0&&(Wt.result=tt)===!1&&(Wt.preventDefault(),Wt.stopPropagation()));return Oe.postDispatch&&Oe.postDispatch.call(this,Wt),Wt.result}},handlers:function(R,V){var Y,tt,ht,ft,xt,Kt=[],Wt=V.delegateCount,oe=R.target;if(Wt&&oe.nodeType&&!(R.type==="click"&&R.button>=1)){for(;oe!==this;oe=oe.parentNode||this)if(oe.nodeType===1&&!(R.type==="click"&&oe.disabled===!0)){for(ft=[],xt={},Y=0;Y<Wt;Y++)tt=V[Y],ht=tt.selector+" ",xt[ht]===void 0&&(xt[ht]=tt.needsContext?F(ht,this).index(oe)>-1:F.find(ht,this,null,[oe]).length),xt[ht]&&ft.push(tt);ft.length&&Kt.push({elem:oe,handlers:ft})}}return oe=this,Wt<V.length&&Kt.push({elem:oe,handlers:V.slice(Wt)}),Kt},addProp:function(R,V){Object.defineProperty(F.Event.prototype,R,{enumerable:!0,configurable:!0,get:P(V)?function(){if(this.originalEvent)return V(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[R]},set:function(Y){Object.defineProperty(this,R,{enumerable:!0,configurable:!0,writable:!0,value:Y})}})},fix:function(R){return R[F.expando]?R:new F.Event(R)},special:{load:{noBubble:!0},click:{setup:function(R){var V=this||R;return hc.test(V.type)&&V.click&&ot(V,"input")&&ce(V,"click",!0),!1},trigger:function(R){var V=this||R;return hc.test(V.type)&&V.click&&ot(V,"input")&&ce(V,"click"),!0},_default:function(R){var V=R.target;return hc.test(V.type)&&V.click&&ot(V,"input")&&Nr.get(V,"click")||ot(V,"a")}},beforeunload:{postDispatch:function(R){R.result!==void 0&&R.originalEvent&&(R.originalEvent.returnValue=R.result)}}}};function ce(R,V,Y){if(!Y){Nr.get(R,V)===void 0&&F.event.add(R,V,Jt);return}Nr.set(R,V,!1),F.event.add(R,V,{namespace:!1,handler:function(tt){var ht,ft=Nr.get(this,V);if(tt.isTrigger&1&&this[V]){if(ft)(F.event.special[V]||{}).delegateType&&tt.stopPropagation();else if(ft=i.call(arguments),Nr.set(this,V,ft),this[V](),ht=Nr.get(this,V),Nr.set(this,V,!1),ft!==ht)return tt.stopImmediatePropagation(),tt.preventDefault(),ht}else ft&&(Nr.set(this,V,F.event.trigger(ft[0],ft.slice(1),this)),tt.stopPropagation(),tt.isImmediatePropagationStopped=Jt)}})}F.removeEvent=function(R,V,Y){R.removeEventListener&&R.removeEventListener(V,Y)},F.Event=function(R,V){if(!(this instanceof F.Event))return new F.Event(R,V);R&&R.type?(this.originalEvent=R,this.type=R.type,this.isDefaultPrevented=R.defaultPrevented||R.defaultPrevented===void 0&&R.returnValue===!1?Jt:St,this.target=R.target&&R.target.nodeType===3?R.target.parentNode:R.target,this.currentTarget=R.currentTarget,this.relatedTarget=R.relatedTarget):this.type=R,V&&F.extend(this,V),this.timeStamp=R&&R.timeStamp||Date.now(),this[F.expando]=!0},F.Event.prototype={constructor:F.Event,isDefaultPrevented:St,isPropagationStopped:St,isImmediatePropagationStopped:St,isSimulated:!1,preventDefault:function(){var R=this.originalEvent;this.isDefaultPrevented=Jt,R&&!this.isSimulated&&R.preventDefault()},stopPropagation:function(){var R=this.originalEvent;this.isPropagationStopped=Jt,R&&!this.isSimulated&&R.stopPropagation()},stopImmediatePropagation:function(){var R=this.originalEvent;this.isImmediatePropagationStopped=Jt,R&&!this.isSimulated&&R.stopImmediatePropagation(),this.stopPropagation()}},F.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},F.event.addProp),F.each({focus:"focusin",blur:"focusout"},function(R,V){function Y(tt){if(D.documentMode){var ht=Nr.get(this,"handle"),ft=F.event.fix(tt);ft.type=tt.type==="focusin"?"focus":"blur",ft.isSimulated=!0,ht(tt),ft.target===ft.currentTarget&&ht(ft)}else F.event.simulate(V,tt.target,F.event.fix(tt))}F.event.special[R]={setup:function(){var tt;if(ce(this,R,!0),D.documentMode)tt=Nr.get(this,V),tt||this.addEventListener(V,Y),Nr.set(this,V,(tt||0)+1);else return!1},trigger:function(){return ce(this,R),!0},teardown:function(){var tt;if(D.documentMode)tt=Nr.get(this,V)-1,tt?Nr.set(this,V,tt):(this.removeEventListener(V,Y),Nr.remove(this,V));else return!1},_default:function(tt){return Nr.get(tt.target,R)},delegateType:V},F.event.special[V]={setup:function(){var tt=this.ownerDocument||this.document||this,ht=D.documentMode?this:tt,ft=Nr.get(ht,V);ft||(D.documentMode?this.addEventListener(V,Y):tt.addEventListener(R,Y,!0)),Nr.set(ht,V,(ft||0)+1)},teardown:function(){var tt=this.ownerDocument||this.document||this,ht=D.documentMode?this:tt,ft=Nr.get(ht,V)-1;ft?Nr.set(ht,V,ft):(D.documentMode?this.removeEventListener(V,Y):tt.removeEventListener(R,Y,!0),Nr.remove(ht,V))}}}),F.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(R,V){F.event.special[R]={delegateType:V,bindType:V,handle:function(Y){var tt,ht=this,ft=Y.relatedTarget,xt=Y.handleObj;return(!ft||ft!==ht&&!F.contains(ht,ft))&&(Y.type=xt.origType,tt=xt.handler.apply(this,arguments),Y.type=V),tt}}}),F.fn.extend({on:function(R,V,Y,tt){return jt(this,R,V,Y,tt)},one:function(R,V,Y,tt){return jt(this,R,V,Y,tt,1)},off:function(R,V,Y){var tt,ht;if(R&&R.preventDefault&&R.handleObj)return tt=R.handleObj,F(R.delegateTarget).off(tt.namespace?tt.origType+"."+tt.namespace:tt.origType,tt.selector,tt.handler),this;if(typeof R=="object"){for(ht in R)this.off(ht,V,R[ht]);return this}return(V===!1||typeof V=="function")&&(Y=V,V=void 0),Y===!1&&(Y=St),this.each(function(){F.event.remove(this,R,Y,V)})}});var je=/<script|<style|<link/i,Ge=/checked\s*(?:[^=]|=\s*.checked.)/i,Pe=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function We(R,V){return ot(R,"table")&&ot(V.nodeType!==11?V:V.firstChild,"tr")&&F(R).children("tbody")[0]||R}function Rr(R){return R.type=(R.getAttribute("type")!==null)+"/"+R.type,R}function Cr(R){return(R.type||"").slice(0,5)==="true/"?R.type=R.type.slice(5):R.removeAttribute("type"),R}function Re(R,V){var Y,tt,ht,ft,xt,Kt,Wt;if(V.nodeType===1){if(Nr.hasData(R)&&(ft=Nr.get(R),Wt=ft.events,Wt)){Nr.remove(V,"handle events");for(ht in Wt)for(Y=0,tt=Wt[ht].length;Y<tt;Y++)F.event.add(V,ht,Wt[ht][Y])}ar.hasData(R)&&(xt=ar.access(R),Kt=F.extend({},xt),ar.set(V,Kt))}}function yr(R,V){var Y=V.nodeName.toLowerCase();Y==="input"&&hc.test(R.type)?V.checked=R.checked:(Y==="input"||Y==="textarea")&&(V.defaultValue=R.defaultValue)}function tr(R,V,Y,tt){V=o(V);var ht,ft,xt,Kt,Wt,oe,Oe=0,Fe=R.length,ae=Fe-1,rr=V[0],fn=P(rr);if(fn||Fe>1&&typeof rr=="string"&&!E.checkClone&&Ge.test(rr))return R.each(function(se){var ve=R.eq(se);fn&&(V[0]=rr.call(this,se,ve.html())),tr(ve,V,Y,tt)});if(Fe&&(ht=vt(V,R[0].ownerDocument,!1,R,tt),ft=ht.firstChild,ht.childNodes.length===1&&(ht=ft),ft||tt)){for(xt=F.map(At(ht,"script"),Rr),Kt=xt.length;Oe<Fe;Oe++)Wt=ht,Oe!==ae&&(Wt=F.clone(Wt,!0,!0),Kt&&F.merge(xt,At(Wt,"script"))),Y.call(R[Oe],Wt,Oe);if(Kt)for(oe=xt[xt.length-1].ownerDocument,F.map(xt,Cr),Oe=0;Oe<Kt;Oe++)Wt=xt[Oe],fo.test(Wt.type||"")&&!Nr.access(Wt,"globalEval")&&F.contains(oe,Wt)&&(Wt.src&&(Wt.type||"").toLowerCase()!=="module"?F._evalUrl&&!Wt.noModule&&F._evalUrl(Wt.src,{nonce:Wt.nonce||Wt.getAttribute("nonce")},oe):X(Wt.textContent.replace(Pe,""),Wt,oe))}return R}function cr(R,V,Y){for(var tt,ht=V?F.filter(V,R):R,ft=0;(tt=ht[ft])!=null;ft++)!Y&&tt.nodeType===1&&F.cleanData(At(tt)),tt.parentNode&&(Y&&ha(tt)&&bt(At(tt,"script")),tt.parentNode.removeChild(tt));return R}F.extend({htmlPrefilter:function(R){return R},clone:function(R,V,Y){var tt,ht,ft,xt,Kt=R.cloneNode(!0),Wt=ha(R);if(!E.noCloneChecked&&(R.nodeType===1||R.nodeType===11)&&!F.isXMLDoc(R))for(xt=At(Kt),ft=At(R),tt=0,ht=ft.length;tt<ht;tt++)yr(ft[tt],xt[tt]);if(V)if(Y)for(ft=ft||At(R),xt=xt||At(Kt),tt=0,ht=ft.length;tt<ht;tt++)Re(ft[tt],xt[tt]);else Re(R,Kt);return xt=At(Kt,"script"),xt.length>0&&bt(xt,!Wt&&At(R,"script")),Kt},cleanData:function(R){for(var V,Y,tt,ht=F.event.special,ft=0;(Y=R[ft])!==void 0;ft++)if(yi(Y)){if(V=Y[Nr.expando]){if(V.events)for(tt in V.events)ht[tt]?F.event.remove(Y,tt):F.removeEvent(Y,tt,V.handle);Y[Nr.expando]=void 0}Y[ar.expando]&&(Y[ar.expando]=void 0)}}}),F.fn.extend({detach:function(R){return cr(this,R,!0)},remove:function(R){return cr(this,R)},text:function(R){return Xn(this,function(V){return V===void 0?F.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=V)})},null,R,arguments.length)},append:function(){return tr(this,arguments,function(R){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var V=We(this,R);V.appendChild(R)}})},prepend:function(){return tr(this,arguments,function(R){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var V=We(this,R);V.insertBefore(R,V.firstChild)}})},before:function(){return tr(this,arguments,function(R){this.parentNode&&this.parentNode.insertBefore(R,this)})},after:function(){return tr(this,arguments,function(R){this.parentNode&&this.parentNode.insertBefore(R,this.nextSibling)})},empty:function(){for(var R,V=0;(R=this[V])!=null;V++)R.nodeType===1&&(F.cleanData(At(R,!1)),R.textContent="");return this},clone:function(R,V){return R=R??!1,V=V??R,this.map(function(){return F.clone(this,R,V)})},html:function(R){return Xn(this,function(V){var Y=this[0]||{},tt=0,ht=this.length;if(V===void 0&&Y.nodeType===1)return Y.innerHTML;if(typeof V=="string"&&!je.test(V)&&!at[(bu.exec(V)||["",""])[1].toLowerCase()]){V=F.htmlPrefilter(V);try{for(;tt<ht;tt++)Y=this[tt]||{},Y.nodeType===1&&(F.cleanData(At(Y,!1)),Y.innerHTML=V);Y=0}catch{}}Y&&this.empty().append(V)},null,R,arguments.length)},replaceWith:function(){var R=[];return tr(this,arguments,function(V){var Y=this.parentNode;F.inArray(this,R)<0&&(F.cleanData(At(this)),Y&&Y.replaceChild(V,this))},R)}}),F.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(R,V){F.fn[R]=function(Y){for(var tt,ht=[],ft=F(Y),xt=ft.length-1,Kt=0;Kt<=xt;Kt++)tt=Kt===xt?this:this.clone(!0),F(ft[Kt])[V](tt),s.apply(ht,tt.get());return this.pushStack(ht)}});var wn=new RegExp("^("+ds+")(?!px)[a-z%]+$","i"),fr=/^--/,On=function(R){var V=R.ownerDocument.defaultView;return(!V||!V.opener)&&(V=e),V.getComputedStyle(R)},Ci=function(R,V,Y){var tt,ht,ft={};for(ht in V)ft[ht]=R.style[ht],R.style[ht]=V[ht];tt=Y.call(R);for(ht in V)R.style[ht]=ft[ht];return tt},Bn=new RegExp(rs.join("|"),"i");(function(){function R(){if(oe){Wt.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",oe.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",No.appendChild(Wt).appendChild(oe);var Oe=e.getComputedStyle(oe);Y=Oe.top!=="1%",Kt=V(Oe.marginLeft)===12,oe.style.right="60%",ft=V(Oe.right)===36,tt=V(Oe.width)===36,oe.style.position="absolute",ht=V(oe.offsetWidth/3)===12,No.removeChild(Wt),oe=null}}function V(Oe){return Math.round(parseFloat(Oe))}var Y,tt,ht,ft,xt,Kt,Wt=D.createElement("div"),oe=D.createElement("div");oe.style&&(oe.style.backgroundClip="content-box",oe.cloneNode(!0).style.backgroundClip="",E.clearCloneStyle=oe.style.backgroundClip==="content-box",F.extend(E,{boxSizingReliable:function(){return R(),tt},pixelBoxStyles:function(){return R(),ft},pixelPosition:function(){return R(),Y},reliableMarginLeft:function(){return R(),Kt},scrollboxSize:function(){return R(),ht},reliableTrDimensions:function(){var Oe,Fe,ae,rr;return xt==null&&(Oe=D.createElement("table"),Fe=D.createElement("tr"),ae=D.createElement("div"),Oe.style.cssText="position:absolute;left:-11111px;border-collapse:separate",Fe.style.cssText="box-sizing:content-box;border:1px solid",Fe.style.height="1px",ae.style.height="9px",ae.style.display="block",No.appendChild(Oe).appendChild(Fe).appendChild(ae),rr=e.getComputedStyle(Fe),xt=parseInt(rr.height,10)+parseInt(rr.borderTopWidth,10)+parseInt(rr.borderBottomWidth,10)===Fe.offsetHeight,No.removeChild(Oe)),xt}}))})();function Zn(R,V,Y){var tt,ht,ft,xt,Kt=fr.test(V),Wt=R.style;return Y=Y||On(R),Y&&(xt=Y.getPropertyValue(V)||Y[V],Kt&&xt&&(xt=xt.replace(ct,"$1")||void 0),xt===""&&!ha(R)&&(xt=F.style(R,V)),!E.pixelBoxStyles()&&wn.test(xt)&&Bn.test(V)&&(tt=Wt.width,ht=Wt.minWidth,ft=Wt.maxWidth,Wt.minWidth=Wt.maxWidth=Wt.width=xt,xt=Y.width,Wt.width=tt,Wt.minWidth=ht,Wt.maxWidth=ft)),xt!==void 0?xt+"":xt}function Yn(R,V){return{get:function(){if(R()){delete this.get;return}return(this.get=V).apply(this,arguments)}}}var Ns=["Webkit","Moz","ms"],di=D.createElement("div").style,yo={};function Pi(R){for(var V=R[0].toUpperCase()+R.slice(1),Y=Ns.length;Y--;)if(R=Ns[Y]+V,R in di)return R}function Dn(R){var V=F.cssProps[R]||yo[R];return V||(R in di?R:yo[R]=Pi(R)||R)}var ci=/^(none|table(?!-c[ea]).+)/,pa={position:"absolute",visibility:"hidden",display:"block"},lh={letterSpacing:"0",fontWeight:"400"};function ns(R,V,Y){var tt=es.exec(V);return tt?Math.max(0,tt[2]-(Y||0))+(tt[3]||"px"):V}function ks(R,V,Y,tt,ht,ft){var xt=V==="width"?1:0,Kt=0,Wt=0,oe=0;if(Y===(tt?"border":"content"))return 0;for(;xt<4;xt+=2)Y==="margin"&&(oe+=F.css(R,Y+rs[xt],!0,ht)),tt?(Y==="content"&&(Wt-=F.css(R,"padding"+rs[xt],!0,ht)),Y!=="margin"&&(Wt-=F.css(R,"border"+rs[xt]+"Width",!0,ht))):(Wt+=F.css(R,"padding"+rs[xt],!0,ht),Y!=="padding"?Wt+=F.css(R,"border"+rs[xt]+"Width",!0,ht):Kt+=F.css(R,"border"+rs[xt]+"Width",!0,ht));return!tt&&ft>=0&&(Wt+=Math.max(0,Math.ceil(R["offset"+V[0].toUpperCase()+V.slice(1)]-ft-Wt-Kt-.5))||0),Wt+oe}function tf(R,V,Y){var tt=On(R),ht=!E.boxSizingReliable()||Y,ft=ht&&F.css(R,"boxSizing",!1,tt)==="border-box",xt=ft,Kt=Zn(R,V,tt),Wt="offset"+V[0].toUpperCase()+V.slice(1);if(wn.test(Kt)){if(!Y)return Kt;Kt="auto"}return(!E.boxSizingReliable()&&ft||!E.reliableTrDimensions()&&ot(R,"tr")||Kt==="auto"||!parseFloat(Kt)&&F.css(R,"display",!1,tt)==="inline")&&R.getClientRects().length&&(ft=F.css(R,"boxSizing",!1,tt)==="border-box",xt=Wt in R,xt&&(Kt=R[Wt])),Kt=parseFloat(Kt)||0,Kt+ks(R,V,Y||(ft?"border":"content"),xt,tt,Kt)+"px"}F.extend({cssHooks:{opacity:{get:function(R,V){if(V){var Y=Zn(R,"opacity");return Y===""?"1":Y}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(R,V,Y,tt){if(!(!R||R.nodeType===3||R.nodeType===8||!R.style)){var ht,ft,xt,Kt=Cn(V),Wt=fr.test(V),oe=R.style;if(Wt||(V=Dn(Kt)),xt=F.cssHooks[V]||F.cssHooks[Kt],Y!==void 0){if(ft=typeof Y,ft==="string"&&(ht=es.exec(Y))&&ht[1]&&(Y=vu(R,V,ht),ft="number"),Y==null||Y!==Y)return;ft==="number"&&!Wt&&(Y+=ht&&ht[3]||(F.cssNumber[Kt]?"":"px")),!E.clearCloneStyle&&Y===""&&V.indexOf("background")===0&&(oe[V]="inherit"),(!xt||!("set"in xt)||(Y=xt.set(R,Y,tt))!==void 0)&&(Wt?oe.setProperty(V,Y):oe[V]=Y)}else return xt&&"get"in xt&&(ht=xt.get(R,!1,tt))!==void 0?ht:oe[V]}},css:function(R,V,Y,tt){var ht,ft,xt,Kt=Cn(V),Wt=fr.test(V);return Wt||(V=Dn(Kt)),xt=F.cssHooks[V]||F.cssHooks[Kt],xt&&"get"in xt&&(ht=xt.get(R,!0,Y)),ht===void 0&&(ht=Zn(R,V,tt)),ht==="normal"&&V in lh&&(ht=lh[V]),Y===""||Y?(ft=parseFloat(ht),Y===!0||isFinite(ft)?ft||0:ht):ht}}),F.each(["height","width"],function(R,V){F.cssHooks[V]={get:function(Y,tt,ht){if(tt)return ci.test(F.css(Y,"display"))&&(!Y.getClientRects().length||!Y.getBoundingClientRect().width)?Ci(Y,pa,function(){return tf(Y,V,ht)}):tf(Y,V,ht)},set:function(Y,tt,ht){var ft,xt=On(Y),Kt=!E.scrollboxSize()&&xt.position==="absolute",Wt=Kt||ht,oe=Wt&&F.css(Y,"boxSizing",!1,xt)==="border-box",Oe=ht?ks(Y,V,ht,oe,xt):0;return oe&&Kt&&(Oe-=Math.ceil(Y["offset"+V[0].toUpperCase()+V.slice(1)]-parseFloat(xt[V])-ks(Y,V,"border",!1,xt)-.5)),Oe&&(ft=es.exec(tt))&&(ft[3]||"px")!=="px"&&(Y.style[V]=tt,tt=F.css(Y,V)),ns(Y,tt,Oe)}}}),F.cssHooks.marginLeft=Yn(E.reliableMarginLeft,function(R,V){if(V)return(parseFloat(Zn(R,"marginLeft"))||R.getBoundingClientRect().left-Ci(R,{marginLeft:0},function(){return R.getBoundingClientRect().left}))+"px"}),F.each({margin:"",padding:"",border:"Width"},function(R,V){F.cssHooks[R+V]={expand:function(Y){for(var tt=0,ht={},ft=typeof Y=="string"?Y.split(" "):[Y];tt<4;tt++)ht[R+rs[tt]+V]=ft[tt]||ft[tt-2]||ft[0];return ht}},R!=="margin"&&(F.cssHooks[R+V].set=ns)}),F.fn.extend({css:function(R,V){return Xn(this,function(Y,tt,ht){var ft,xt,Kt={},Wt=0;if(Array.isArray(tt)){for(ft=On(Y),xt=tt.length;Wt<xt;Wt++)Kt[tt[Wt]]=F.css(Y,tt[Wt],!1,ft);return Kt}return ht!==void 0?F.style(Y,tt,ht):F.css(Y,tt)},R,V,arguments.length>1)}});function ws(R,V,Y,tt,ht){return new ws.prototype.init(R,V,Y,tt,ht)}F.Tween=ws,ws.prototype={constructor:ws,init:function(R,V,Y,tt,ht,ft){this.elem=R,this.prop=Y,this.easing=ht||F.easing._default,this.options=V,this.start=this.now=this.cur(),this.end=tt,this.unit=ft||(F.cssNumber[Y]?"":"px")},cur:function(){var R=ws.propHooks[this.prop];return R&&R.get?R.get(this):ws.propHooks._default.get(this)},run:function(R){var V,Y=ws.propHooks[this.prop];return this.options.duration?this.pos=V=F.easing[this.easing](R,this.options.duration*R,0,1,this.options.duration):this.pos=V=R,this.now=(this.end-this.start)*V+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),Y&&Y.set?Y.set(this):ws.propHooks._default.set(this),this}},ws.prototype.init.prototype=ws.prototype,ws.propHooks={_default:{get:function(R){var V;return R.elem.nodeType!==1||R.elem[R.prop]!=null&&R.elem.style[R.prop]==null?R.elem[R.prop]:(V=F.css(R.elem,R.prop,""),!V||V==="auto"?0:V)},set:function(R){F.fx.step[R.prop]?F.fx.step[R.prop](R):R.elem.nodeType===1&&(F.cssHooks[R.prop]||R.elem.style[Dn(R.prop)]!=null)?F.style(R.elem,R.prop,R.now+R.unit):R.elem[R.prop]=R.now}}},ws.propHooks.scrollTop=ws.propHooks.scrollLeft={set:function(R){R.elem.nodeType&&R.elem.parentNode&&(R.elem[R.prop]=R.now)}},F.easing={linear:function(R){return R},swing:function(R){return .5-Math.cos(R*Math.PI)/2},_default:"swing"},F.fx=ws.prototype.init,F.fx.step={};var Xi,Yl,Zs=/^(?:toggle|show|hide)$/,ms=/queueHooks$/;function Sa(){Yl&&(D.hidden===!1&&e.requestAnimationFrame?e.requestAnimationFrame(Sa):e.setTimeout(Sa,F.fx.interval),F.fx.tick())}function Yi(){return e.setTimeout(function(){Xi=void 0}),Xi=Date.now()}function Ca(R,V){var Y,tt=0,ht={height:R};for(V=V?1:0;tt<4;tt+=2-V)Y=rs[tt],ht["margin"+Y]=ht["padding"+Y]=R;return V&&(ht.opacity=ht.width=R),ht}function Pa(R,V,Y){for(var tt,ht=(Rc.tweeners[V]||[]).concat(Rc.tweeners["*"]),ft=0,xt=ht.length;ft<xt;ft++)if(tt=ht[ft].call(Y,V,R))return tt}function yA(R,V,Y){var tt,ht,ft,xt,Kt,Wt,oe,Oe,Fe="width"in V||"height"in V,ae=this,rr={},fn=R.style,se=R.nodeType&&Xl(R),ve=Nr.get(R,"fxshow");Y.queue||(xt=F._queueHooks(R,"fx"),xt.unqueued==null&&(xt.unqueued=0,Kt=xt.empty.fire,xt.empty.fire=function(){xt.unqueued||Kt()}),xt.unqueued++,ae.always(function(){ae.always(function(){xt.unqueued--,F.queue(R,"fx").length||xt.empty.fire()})}));for(tt in V)if(ht=V[tt],Zs.test(ht)){if(delete V[tt],ft=ft||ht==="toggle",ht===(se?"hide":"show"))if(ht==="show"&&ve&&ve[tt]!==void 0)se=!0;else continue;rr[tt]=ve&&ve[tt]||F.style(R,tt)}if(Wt=!F.isEmptyObject(V),!(!Wt&&F.isEmptyObject(rr))){Fe&&R.nodeType===1&&(Y.overflow=[fn.overflow,fn.overflowX,fn.overflowY],oe=ve&&ve.display,oe==null&&(oe=Nr.get(R,"display")),Oe=F.css(R,"display"),Oe==="none"&&(oe?Oe=oe:(fa([R],!0),oe=R.style.display||oe,Oe=F.css(R,"display"),fa([R]))),(Oe==="inline"||Oe==="inline-block"&&oe!=null)&&F.css(R,"float")==="none"&&(Wt||(ae.done(function(){fn.display=oe}),oe==null&&(Oe=fn.display,oe=Oe==="none"?"":Oe)),fn.display="inline-block")),Y.overflow&&(fn.overflow="hidden",ae.always(function(){fn.overflow=Y.overflow[0],fn.overflowX=Y.overflow[1],fn.overflowY=Y.overflow[2]})),Wt=!1;for(tt in rr)Wt||(ve?"hidden"in ve&&(se=ve.hidden):ve=Nr.access(R,"fxshow",{display:oe}),ft&&(ve.hidden=!se),se&&fa([R],!0),ae.done(function(){se||fa([R]),Nr.remove(R,"fxshow");for(tt in rr)F.style(R,tt,rr[tt])})),Wt=Pa(se?ve[tt]:0,tt,ae),tt in ve||(ve[tt]=Wt.start,se&&(Wt.end=Wt.start,Wt.start=0))}}function fc(R,V){var Y,tt,ht,ft,xt;for(Y in R)if(tt=Cn(Y),ht=V[tt],ft=R[Y],Array.isArray(ft)&&(ht=ft[1],ft=R[Y]=ft[0]),Y!==tt&&(R[tt]=ft,delete R[Y]),xt=F.cssHooks[tt],xt&&"expand"in xt){ft=xt.expand(ft),delete R[tt];for(Y in ft)Y in R||(R[Y]=ft[Y],V[Y]=ht)}else V[tt]=ht}function Rc(R,V,Y){var tt,ht,ft=0,xt=Rc.prefilters.length,Kt=F.Deferred().always(function(){delete Wt.elem}),Wt=function(){if(ht)return!1;for(var Fe=Xi||Yi(),ae=Math.max(0,oe.startTime+oe.duration-Fe),rr=ae/oe.duration||0,fn=1-rr,se=0,ve=oe.tweens.length;se<ve;se++)oe.tweens[se].run(fn);return Kt.notifyWith(R,[oe,fn,ae]),fn<1&&ve?ae:(ve||Kt.notifyWith(R,[oe,1,0]),Kt.resolveWith(R,[oe]),!1)},oe=Kt.promise({elem:R,props:F.extend({},V),opts:F.extend(!0,{specialEasing:{},easing:F.easing._default},Y),originalProperties:V,originalOptions:Y,startTime:Xi||Yi(),duration:Y.duration,tweens:[],createTween:function(Fe,ae){var rr=F.Tween(R,oe.opts,Fe,ae,oe.opts.specialEasing[Fe]||oe.opts.easing);return oe.tweens.push(rr),rr},stop:function(Fe){var ae=0,rr=Fe?oe.tweens.length:0;if(ht)return this;for(ht=!0;ae<rr;ae++)oe.tweens[ae].run(1);return Fe?(Kt.notifyWith(R,[oe,1,0]),Kt.resolveWith(R,[oe,Fe])):Kt.rejectWith(R,[oe,Fe]),this}}),Oe=oe.props;for(fc(Oe,oe.opts.specialEasing);ft<xt;ft++)if(tt=Rc.prefilters[ft].call(oe,R,Oe,oe.opts),tt)return P(tt.stop)&&(F._queueHooks(oe.elem,oe.opts.queue).stop=tt.stop.bind(tt)),tt;return F.map(Oe,Pa,oe),P(oe.opts.start)&&oe.opts.start.call(R,oe),oe.progress(oe.opts.progress).done(oe.opts.done,oe.opts.complete).fail(oe.opts.fail).always(oe.opts.always),F.fx.timer(F.extend(Wt,{elem:R,anim:oe,queue:oe.opts.queue})),oe}F.Animation=F.extend(Rc,{tweeners:{"*":[function(R,V){var Y=this.createTween(R,V);return vu(Y.elem,R,es.exec(V),Y),Y}]},tweener:function(R,V){P(R)?(V=R,R=["*"]):R=R.match(ue);for(var Y,tt=0,ht=R.length;tt<ht;tt++)Y=R[tt],Rc.tweeners[Y]=Rc.tweeners[Y]||[],Rc.tweeners[Y].unshift(V)},prefilters:[yA],prefilter:function(R,V){V?Rc.prefilters.unshift(R):Rc.prefilters.push(R)}}),F.speed=function(R,V,Y){var tt=R&&typeof R=="object"?F.extend({},R):{complete:Y||!Y&&V||P(R)&&R,duration:R,easing:Y&&V||V&&!P(V)&&V};return F.fx.off?tt.duration=0:typeof tt.duration!="number"&&(tt.duration in F.fx.speeds?tt.duration=F.fx.speeds[tt.duration]:tt.duration=F.fx.speeds._default),(tt.queue==null||tt.queue===!0)&&(tt.queue="fx"),tt.old=tt.complete,tt.complete=function(){P(tt.old)&&tt.old.call(this),tt.queue&&F.dequeue(this,tt.queue)},tt},F.fn.extend({fadeTo:function(R,V,Y,tt){return this.filter(Xl).css("opacity",0).show().end().animate({opacity:V},R,Y,tt)},animate:function(R,V,Y,tt){var ht=F.isEmptyObject(R),ft=F.speed(V,Y,tt),xt=function(){var Kt=Rc(this,F.extend({},R),ft);(ht||Nr.get(this,"finish"))&&Kt.stop(!0)};return xt.finish=xt,ht||ft.queue===!1?this.each(xt):this.queue(ft.queue,xt)},stop:function(R,V,Y){var tt=function(ht){var ft=ht.stop;delete ht.stop,ft(Y)};return typeof R!="string"&&(Y=V,V=R,R=void 0),V&&this.queue(R||"fx",[]),this.each(function(){var ht=!0,ft=R!=null&&R+"queueHooks",xt=F.timers,Kt=Nr.get(this);if(ft)Kt[ft]&&Kt[ft].stop&&tt(Kt[ft]);else for(ft in Kt)Kt[ft]&&Kt[ft].stop&&ms.test(ft)&&tt(Kt[ft]);for(ft=xt.length;ft--;)xt[ft].elem===this&&(R==null||xt[ft].queue===R)&&(xt[ft].anim.stop(Y),ht=!1,xt.splice(ft,1));(ht||!Y)&&F.dequeue(this,R)})},finish:function(R){return R!==!1&&(R=R||"fx"),this.each(function(){var V,Y=Nr.get(this),tt=Y[R+"queue"],ht=Y[R+"queueHooks"],ft=F.timers,xt=tt?tt.length:0;for(Y.finish=!0,F.queue(this,R,[]),ht&&ht.stop&&ht.stop.call(this,!0),V=ft.length;V--;)ft[V].elem===this&&ft[V].queue===R&&(ft[V].anim.stop(!0),ft.splice(V,1));for(V=0;V<xt;V++)tt[V]&&tt[V].finish&&tt[V].finish.call(this);delete Y.finish})}}),F.each(["toggle","show","hide"],function(R,V){var Y=F.fn[V];F.fn[V]=function(tt,ht,ft){return tt==null||typeof tt=="boolean"?Y.apply(this,arguments):this.animate(Ca(V,!0),tt,ht,ft)}}),F.each({slideDown:Ca("show"),slideUp:Ca("hide"),slideToggle:Ca("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(R,V){F.fn[R]=function(Y,tt,ht){return this.animate(V,Y,tt,ht)}}),F.timers=[],F.fx.tick=function(){var R,V=0,Y=F.timers;for(Xi=Date.now();V<Y.length;V++)R=Y[V],!R()&&Y[V]===R&&Y.splice(V--,1);Y.length||F.fx.stop(),Xi=void 0},F.fx.timer=function(R){F.timers.push(R),F.fx.start()},F.fx.interval=13,F.fx.start=function(){Yl||(Yl=!0,Sa())},F.fx.stop=function(){Yl=null},F.fx.speeds={slow:600,fast:200,_default:400},F.fn.delay=function(R,V){return R=F.fx&&F.fx.speeds[R]||R,V=V||"fx",this.queue(V,function(Y,tt){var ht=e.setTimeout(Y,R);tt.stop=function(){e.clearTimeout(ht)}})},function(){var R=D.createElement("input"),V=D.createElement("select"),Y=V.appendChild(D.createElement("option"));R.type="checkbox",E.checkOn=R.value!=="",E.optSelected=Y.selected,R=D.createElement("input"),R.value="t",R.type="radio",E.radioValue=R.value==="t"}();var rl,ko=F.expr.attrHandle;F.fn.extend({attr:function(R,V){return Xn(this,F.attr,R,V,arguments.length>1)},removeAttr:function(R){return this.each(function(){F.removeAttr(this,R)})}}),F.extend({attr:function(R,V,Y){var tt,ht,ft=R.nodeType;if(!(ft===3||ft===8||ft===2)){if(typeof R.getAttribute>"u")return F.prop(R,V,Y);if((ft!==1||!F.isXMLDoc(R))&&(ht=F.attrHooks[V.toLowerCase()]||(F.expr.match.bool.test(V)?rl:void 0)),Y!==void 0){if(Y===null){F.removeAttr(R,V);return}return ht&&"set"in ht&&(tt=ht.set(R,Y,V))!==void 0?tt:(R.setAttribute(V,Y+""),Y)}return ht&&"get"in ht&&(tt=ht.get(R,V))!==null?tt:(tt=F.find.attr(R,V),tt??void 0)}},attrHooks:{type:{set:function(R,V){if(!E.radioValue&&V==="radio"&&ot(R,"input")){var Y=R.value;return R.setAttribute("type",V),Y&&(R.value=Y),V}}}},removeAttr:function(R,V){var Y,tt=0,ht=V&&V.match(ue);if(ht&&R.nodeType===1)for(;Y=ht[tt++];)R.removeAttribute(Y)}}),rl={set:function(R,V,Y){return V===!1?F.removeAttr(R,Y):R.setAttribute(Y,Y),Y}},F.each(F.expr.match.bool.source.match(/\w+/g),function(R,V){var Y=ko[V]||F.find.attr;ko[V]=function(tt,ht,ft){var xt,Kt,Wt=ht.toLowerCase();return ft||(Kt=ko[Wt],ko[Wt]=xt,xt=Y(tt,ht,ft)!=null?Wt:null,ko[Wt]=Kt),xt}});var nl=/^(?:input|select|textarea|button)$/i,$s=/^(?:a|area)$/i;F.fn.extend({prop:function(R,V){return Xn(this,F.prop,R,V,arguments.length>1)},removeProp:function(R){return this.each(function(){delete this[F.propFix[R]||R]})}}),F.extend({prop:function(R,V,Y){var tt,ht,ft=R.nodeType;if(!(ft===3||ft===8||ft===2))return(ft!==1||!F.isXMLDoc(R))&&(V=F.propFix[V]||V,ht=F.propHooks[V]),Y!==void 0?ht&&"set"in ht&&(tt=ht.set(R,Y,V))!==void 0?tt:R[V]=Y:ht&&"get"in ht&&(tt=ht.get(R,V))!==null?tt:R[V]},propHooks:{tabIndex:{get:function(R){var V=F.find.attr(R,"tabindex");return V?parseInt(V,10):nl.test(R.nodeName)||$s.test(R.nodeName)&&R.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),E.optSelected||(F.propHooks.selected={get:function(R){var V=R.parentNode;return V&&V.parentNode&&V.parentNode.selectedIndex,null},set:function(R){var V=R.parentNode;V&&(V.selectedIndex,V.parentNode&&V.parentNode.selectedIndex)}}),F.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){F.propFix[this.toLowerCase()]=this});function Ha(R){var V=R.match(ue)||[];return V.join(" ")}function wu(R){return R.getAttribute&&R.getAttribute("class")||""}function Id(R){return Array.isArray(R)?R:typeof R=="string"?R.match(ue)||[]:[]}F.fn.extend({addClass:function(R){var V,Y,tt,ht,ft,xt;return P(R)?this.each(function(Kt){F(this).addClass(R.call(this,Kt,wu(this)))}):(V=Id(R),V.length?this.each(function(){if(tt=wu(this),Y=this.nodeType===1&&" "+Ha(tt)+" ",Y){for(ft=0;ft<V.length;ft++)ht=V[ft],Y.indexOf(" "+ht+" ")<0&&(Y+=ht+" ");xt=Ha(Y),tt!==xt&&this.setAttribute("class",xt)}}):this)},removeClass:function(R){var V,Y,tt,ht,ft,xt;return P(R)?this.each(function(Kt){F(this).removeClass(R.call(this,Kt,wu(this)))}):arguments.length?(V=Id(R),V.length?this.each(function(){if(tt=wu(this),Y=this.nodeType===1&&" "+Ha(tt)+" ",Y){for(ft=0;ft<V.length;ft++)for(ht=V[ft];Y.indexOf(" "+ht+" ")>-1;)Y=Y.replace(" "+ht+" "," ");xt=Ha(Y),tt!==xt&&this.setAttribute("class",xt)}}):this):this.attr("class","")},toggleClass:function(R,V){var Y,tt,ht,ft,xt=typeof R,Kt=xt==="string"||Array.isArray(R);return P(R)?this.each(function(Wt){F(this).toggleClass(R.call(this,Wt,wu(this),V),V)}):typeof V=="boolean"&&Kt?V?this.addClass(R):this.removeClass(R):(Y=Id(R),this.each(function(){if(Kt)for(ft=F(this),ht=0;ht<Y.length;ht++)tt=Y[ht],ft.hasClass(tt)?ft.removeClass(tt):ft.addClass(tt);else(R===void 0||xt==="boolean")&&(tt=wu(this),tt&&Nr.set(this,"__className__",tt),this.setAttribute&&this.setAttribute("class",tt||R===!1?"":Nr.get(this,"__className__")||""))}))},hasClass:function(R){var V,Y,tt=0;for(V=" "+R+" ";Y=this[tt++];)if(Y.nodeType===1&&(" "+Ha(wu(Y))+" ").indexOf(V)>-1)return!0;return!1}});var Rd=/\r/g;F.fn.extend({val:function(R){var V,Y,tt,ht=this[0];return arguments.length?(tt=P(R),this.each(function(ft){var xt;this.nodeType===1&&(tt?xt=R.call(this,ft,F(this).val()):xt=R,xt==null?xt="":typeof xt=="number"?xt+="":Array.isArray(xt)&&(xt=F.map(xt,function(Kt){return Kt==null?"":Kt+""})),V=F.valHooks[this.type]||F.valHooks[this.nodeName.toLowerCase()],(!V||!("set"in V)||V.set(this,xt,"value")===void 0)&&(this.value=xt))})):ht?(V=F.valHooks[ht.type]||F.valHooks[ht.nodeName.toLowerCase()],V&&"get"in V&&(Y=V.get(ht,"value"))!==void 0?Y:(Y=ht.value,typeof Y=="string"?Y.replace(Rd,""):Y??"")):void 0}}),F.extend({valHooks:{option:{get:function(R){var V=F.find.attr(R,"value");return V??Ha(F.text(R))}},select:{get:function(R){var V,Y,tt,ht=R.options,ft=R.selectedIndex,xt=R.type==="select-one",Kt=xt?null:[],Wt=xt?ft+1:ht.length;for(ft<0?tt=Wt:tt=xt?ft:0;tt<Wt;tt++)if(Y=ht[tt],(Y.selected||tt===ft)&&!Y.disabled&&(!Y.parentNode.disabled||!ot(Y.parentNode,"optgroup"))){if(V=F(Y).val(),xt)return V;Kt.push(V)}return Kt},set:function(R,V){for(var Y,tt,ht=R.options,ft=F.makeArray(V),xt=ht.length;xt--;)tt=ht[xt],(tt.selected=F.inArray(F.valHooks.option.get(tt),ft)>-1)&&(Y=!0);return Y||(R.selectedIndex=-1),ft}}}}),F.each(["radio","checkbox"],function(){F.valHooks[this]={set:function(R,V){if(Array.isArray(V))return R.checked=F.inArray(F(R).val(),V)>-1}},E.checkOn||(F.valHooks[this].get=function(R){return R.getAttribute("value")===null?"on":R.value})});var ef=e.location,Ld={guid:Date.now()},Od=/\?/;F.parseXML=function(R){var V,Y;if(!R||typeof R!="string")return null;try{V=new e.DOMParser().parseFromString(R,"text/xml")}catch{}return Y=V&&V.getElementsByTagName("parsererror")[0],(!V||Y)&&F.error("Invalid XML: "+(Y?F.map(Y.childNodes,function(tt){return tt.textContent}).join(`
`):R)),V};var Bd=/^(?:focusinfocus|focusoutblur)$/,Dd=function(R){R.stopPropagation()};F.extend(F.event,{trigger:function(R,V,Y,tt){var ht,ft,xt,Kt,Wt,oe,Oe,Fe,ae=[Y||D],rr=p.call(R,"type")?R.type:R,fn=p.call(R,"namespace")?R.namespace.split("."):[];if(ft=Fe=xt=Y=Y||D,!(Y.nodeType===3||Y.nodeType===8)&&!Bd.test(rr+F.event.triggered)&&(rr.indexOf(".")>-1&&(fn=rr.split("."),rr=fn.shift(),fn.sort()),Wt=rr.indexOf(":")<0&&"on"+rr,R=R[F.expando]?R:new F.Event(rr,typeof R=="object"&&R),R.isTrigger=tt?2:3,R.namespace=fn.join("."),R.rnamespace=R.namespace?new RegExp("(^|\\.)"+fn.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,R.result=void 0,R.target||(R.target=Y),V=V==null?[R]:F.makeArray(V,[R]),Oe=F.event.special[rr]||{},!(!tt&&Oe.trigger&&Oe.trigger.apply(Y,V)===!1))){if(!tt&&!Oe.noBubble&&!B(Y)){for(Kt=Oe.delegateType||rr,Bd.test(Kt+rr)||(ft=ft.parentNode);ft;ft=ft.parentNode)ae.push(ft),xt=ft;xt===(Y.ownerDocument||D)&&ae.push(xt.defaultView||xt.parentWindow||e)}for(ht=0;(ft=ae[ht++])&&!R.isPropagationStopped();)Fe=ft,R.type=ht>1?Kt:Oe.bindType||rr,oe=(Nr.get(ft,"events")||Object.create(null))[R.type]&&Nr.get(ft,"handle"),oe&&oe.apply(ft,V),oe=Wt&&ft[Wt],oe&&oe.apply&&yi(ft)&&(R.result=oe.apply(ft,V),R.result===!1&&R.preventDefault());return R.type=rr,!tt&&!R.isDefaultPrevented()&&(!Oe._default||Oe._default.apply(ae.pop(),V)===!1)&&yi(Y)&&Wt&&P(Y[rr])&&!B(Y)&&(xt=Y[Wt],xt&&(Y[Wt]=null),F.event.triggered=rr,R.isPropagationStopped()&&Fe.addEventListener(rr,Dd),Y[rr](),R.isPropagationStopped()&&Fe.removeEventListener(rr,Dd),F.event.triggered=void 0,xt&&(Y[Wt]=xt)),R.result}},simulate:function(R,V,Y){var tt=F.extend(new F.Event,Y,{type:R,isSimulated:!0});F.event.trigger(tt,null,V)}}),F.fn.extend({trigger:function(R,V){return this.each(function(){F.event.trigger(R,V,this)})},triggerHandler:function(R,V){var Y=this[0];if(Y)return F.event.trigger(R,V,Y,!0)}});var uh=/\[\]$/,hp=/\r?\n/g,rf=/^(?:submit|button|image|reset|file)$/i,xA=/^(?:input|select|textarea|keygen)/i;function hh(R,V,Y,tt){var ht;if(Array.isArray(V))F.each(V,function(ft,xt){Y||uh.test(R)?tt(R,xt):hh(R+"["+(typeof xt=="object"&&xt!=null?ft:"")+"]",xt,Y,tt)});else if(!Y&&q(V)==="object")for(ht in V)hh(R+"["+ht+"]",V[ht],Y,tt);else tt(R,V)}F.param=function(R,V){var Y,tt=[],ht=function(ft,xt){var Kt=P(xt)?xt():xt;tt[tt.length]=encodeURIComponent(ft)+"="+encodeURIComponent(Kt??"")};if(R==null)return"";if(Array.isArray(R)||R.jquery&&!F.isPlainObject(R))F.each(R,function(){ht(this.name,this.value)});else for(Y in R)hh(Y,R[Y],V,ht);return tt.join("&")},F.fn.extend({serialize:function(){return F.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var R=F.prop(this,"elements");return R?F.makeArray(R):this}).filter(function(){var R=this.type;return this.name&&!F(this).is(":disabled")&&xA.test(this.nodeName)&&!rf.test(R)&&(this.checked||!hc.test(R))}).map(function(R,V){var Y=F(this).val();return Y==null?null:Array.isArray(Y)?F.map(Y,function(tt){return{name:V.name,value:tt.replace(hp,`\r
`)}}):{name:V.name,value:Y.replace(hp,`\r
`)}}).get()}});var pc=/%20/g,Kl=/#.*$/,Zl=/([?&])_=[^&]*/,Tu=/^(.*?):[ \t]*([^\r\n]*)$/mg,$l=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ql=/^(?:GET|HEAD)$/,fp=/^\/\//,da={},xo={},Eu="*/".concat("*"),pp=D.createElement("a");pp.href=ef.href;function vA(R){return function(V,Y){typeof V!="string"&&(Y=V,V="*");var tt,ht=0,ft=V.toLowerCase().match(ue)||[];if(P(Y))for(;tt=ft[ht++];)tt[0]==="+"?(tt=tt.slice(1)||"*",(R[tt]=R[tt]||[]).unshift(Y)):(R[tt]=R[tt]||[]).push(Y)}}function bA(R,V,Y,tt){var ht={},ft=R===xo;function xt(Kt){var Wt;return ht[Kt]=!0,F.each(R[Kt]||[],function(oe,Oe){var Fe=Oe(V,Y,tt);if(typeof Fe=="string"&&!ft&&!ht[Fe])return V.dataTypes.unshift(Fe),xt(Fe),!1;if(ft)return!(Wt=Fe)}),Wt}return xt(V.dataTypes[0])||!ht["*"]&&xt("*")}function nf(R,V){var Y,tt,ht=F.ajaxSettings.flatOptions||{};for(Y in V)V[Y]!==void 0&&((ht[Y]?R:tt||(tt={}))[Y]=V[Y]);return tt&&F.extend(!0,R,tt),R}function Nd(R,V,Y){for(var tt,ht,ft,xt,Kt=R.contents,Wt=R.dataTypes;Wt[0]==="*";)Wt.shift(),tt===void 0&&(tt=R.mimeType||V.getResponseHeader("Content-Type"));if(tt){for(ht in Kt)if(Kt[ht]&&Kt[ht].test(tt)){Wt.unshift(ht);break}}if(Wt[0]in Y)ft=Wt[0];else{for(ht in Y){if(!Wt[0]||R.converters[ht+" "+Wt[0]]){ft=ht;break}xt||(xt=ht)}ft=ft||xt}if(ft)return ft!==Wt[0]&&Wt.unshift(ft),Y[ft]}function kd(R,V,Y,tt){var ht,ft,xt,Kt,Wt,oe={},Oe=R.dataTypes.slice();if(Oe[1])for(xt in R.converters)oe[xt.toLowerCase()]=R.converters[xt];for(ft=Oe.shift();ft;)if(R.responseFields[ft]&&(Y[R.responseFields[ft]]=V),!Wt&&tt&&R.dataFilter&&(V=R.dataFilter(V,R.dataType)),Wt=ft,ft=Oe.shift(),ft){if(ft==="*")ft=Wt;else if(Wt!=="*"&&Wt!==ft){if(xt=oe[Wt+" "+ft]||oe["* "+ft],!xt){for(ht in oe)if(Kt=ht.split(" "),Kt[1]===ft&&(xt=oe[Wt+" "+Kt[0]]||oe["* "+Kt[0]],xt)){xt===!0?xt=oe[ht]:oe[ht]!==!0&&(ft=Kt[0],Oe.unshift(Kt[1]));break}}if(xt!==!0)if(xt&&R.throws)V=xt(V);else try{V=xt(V)}catch(Fe){return{state:"parsererror",error:xt?Fe:"No conversion from "+Wt+" to "+ft}}}}return{state:"success",data:V}}F.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ef.href,type:"GET",isLocal:$l.test(ef.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Eu,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":F.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(R,V){return V?nf(nf(R,F.ajaxSettings),V):nf(F.ajaxSettings,R)},ajaxPrefilter:vA(da),ajaxTransport:vA(xo),ajax:function(R,V){typeof R=="object"&&(V=R,R=void 0),V=V||{};var Y,tt,ht,ft,xt,Kt,Wt,oe,Oe,Fe,ae=F.ajaxSetup({},V),rr=ae.context||ae,fn=ae.context&&(rr.nodeType||rr.jquery)?F(rr):F.event,se=F.Deferred(),ve=F.Callbacks("once memory"),er=ae.statusCode||{},jr={},_={},Pn="canceled",Ur={readyState:0,getResponseHeader:function(gn){var ni;if(Wt){if(!ft)for(ft={};ni=Tu.exec(ht);)ft[ni[1].toLowerCase()+" "]=(ft[ni[1].toLowerCase()+" "]||[]).concat(ni[2]);ni=ft[gn.toLowerCase()+" "]}return ni==null?null:ni.join(", ")},getAllResponseHeaders:function(){return Wt?ht:null},setRequestHeader:function(gn,ni){return Wt==null&&(gn=_[gn.toLowerCase()]=_[gn.toLowerCase()]||gn,jr[gn]=ni),this},overrideMimeType:function(gn){return Wt==null&&(ae.mimeType=gn),this},statusCode:function(gn){var ni;if(gn)if(Wt)Ur.always(gn[Ur.status]);else for(ni in gn)er[ni]=[er[ni],gn[ni]];return this},abort:function(gn){var ni=gn||Pn;return Y&&Y.abort(ni),Rt(0,ni),this}};if(se.promise(Ur),ae.url=((R||ae.url||ef.href)+"").replace(fp,ef.protocol+"//"),ae.type=V.method||V.type||ae.method||ae.type,ae.dataTypes=(ae.dataType||"*").toLowerCase().match(ue)||[""],ae.crossDomain==null){Kt=D.createElement("a");try{Kt.href=ae.url,Kt.href=Kt.href,ae.crossDomain=pp.protocol+"//"+pp.host!=Kt.protocol+"//"+Kt.host}catch{ae.crossDomain=!0}}if(ae.data&&ae.processData&&typeof ae.data!="string"&&(ae.data=F.param(ae.data,ae.traditional)),bA(da,ae,V,Ur),Wt)return Ur;oe=F.event&&ae.global,oe&&F.active++===0&&F.event.trigger("ajaxStart"),ae.type=ae.type.toUpperCase(),ae.hasContent=!Ql.test(ae.type),tt=ae.url.replace(Kl,""),ae.hasContent?ae.data&&ae.processData&&(ae.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(ae.data=ae.data.replace(pc,"+")):(Fe=ae.url.slice(tt.length),ae.data&&(ae.processData||typeof ae.data=="string")&&(tt+=(Od.test(tt)?"&":"?")+ae.data,delete ae.data),ae.cache===!1&&(tt=tt.replace(Zl,"$1"),Fe=(Od.test(tt)?"&":"?")+"_="+Ld.guid+++Fe),ae.url=tt+Fe),ae.ifModified&&(F.lastModified[tt]&&Ur.setRequestHeader("If-Modified-Since",F.lastModified[tt]),F.etag[tt]&&Ur.setRequestHeader("If-None-Match",F.etag[tt])),(ae.data&&ae.hasContent&&ae.contentType!==!1||V.contentType)&&Ur.setRequestHeader("Content-Type",ae.contentType),Ur.setRequestHeader("Accept",ae.dataTypes[0]&&ae.accepts[ae.dataTypes[0]]?ae.accepts[ae.dataTypes[0]]+(ae.dataTypes[0]!=="*"?", "+Eu+"; q=0.01":""):ae.accepts["*"]);for(Oe in ae.headers)Ur.setRequestHeader(Oe,ae.headers[Oe]);if(ae.beforeSend&&(ae.beforeSend.call(rr,Ur,ae)===!1||Wt))return Ur.abort();if(Pn="abort",ve.add(ae.complete),Ur.done(ae.success),Ur.fail(ae.error),Y=bA(xo,ae,V,Ur),!Y)Rt(-1,"No Transport");else{if(Ur.readyState=1,oe&&fn.trigger("ajaxSend",[Ur,ae]),Wt)return Ur;ae.async&&ae.timeout>0&&(xt=e.setTimeout(function(){Ur.abort("timeout")},ae.timeout));try{Wt=!1,Y.send(jr,Rt)}catch(gn){if(Wt)throw gn;Rt(-1,gn)}}function Rt(gn,ni,ji,mi){var $n,Hi,Nn,kn,Kn,Qs=ni;Wt||(Wt=!0,xt&&e.clearTimeout(xt),Y=void 0,ht=mi||"",Ur.readyState=gn>0?4:0,$n=gn>=200&&gn<300||gn===304,ji&&(kn=Nd(ae,Ur,ji)),!$n&&F.inArray("script",ae.dataTypes)>-1&&F.inArray("json",ae.dataTypes)<0&&(ae.converters["text script"]=function(){}),kn=kd(ae,kn,Ur,$n),$n?(ae.ifModified&&(Kn=Ur.getResponseHeader("Last-Modified"),Kn&&(F.lastModified[tt]=Kn),Kn=Ur.getResponseHeader("etag"),Kn&&(F.etag[tt]=Kn)),gn===204||ae.type==="HEAD"?Qs="nocontent":gn===304?Qs="notmodified":(Qs=kn.state,Hi=kn.data,Nn=kn.error,$n=!Nn)):(Nn=Qs,(gn||!Qs)&&(Qs="error",gn<0&&(gn=0))),Ur.status=gn,Ur.statusText=(ni||Qs)+"",$n?se.resolveWith(rr,[Hi,Qs,Ur]):se.rejectWith(rr,[Ur,Qs,Nn]),Ur.statusCode(er),er=void 0,oe&&fn.trigger($n?"ajaxSuccess":"ajaxError",[Ur,ae,$n?Hi:Nn]),ve.fireWith(rr,[Ur,Qs]),oe&&(fn.trigger("ajaxComplete",[Ur,ae]),--F.active||F.event.trigger("ajaxStop")))}return Ur},getJSON:function(R,V,Y){return F.get(R,V,Y,"json")},getScript:function(R,V){return F.get(R,void 0,V,"script")}}),F.each(["get","post"],function(R,V){F[V]=function(Y,tt,ht,ft){return P(tt)&&(ft=ft||ht,ht=tt,tt=void 0),F.ajax(F.extend({url:Y,type:V,dataType:ft,data:tt,success:ht},F.isPlainObject(Y)&&Y))}}),F.ajaxPrefilter(function(R){var V;for(V in R.headers)V.toLowerCase()==="content-type"&&(R.contentType=R.headers[V]||"")}),F._evalUrl=function(R,V,Y){return F.ajax({url:R,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(tt){F.globalEval(tt,V,Y)}})},F.fn.extend({wrapAll:function(R){var V;return this[0]&&(P(R)&&(R=R.call(this[0])),V=F(R,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&V.insertBefore(this[0]),V.map(function(){for(var Y=this;Y.firstElementChild;)Y=Y.firstElementChild;return Y}).append(this)),this},wrapInner:function(R){return P(R)?this.each(function(V){F(this).wrapInner(R.call(this,V))}):this.each(function(){var V=F(this),Y=V.contents();Y.length?Y.wrapAll(R):V.append(R)})},wrap:function(R){var V=P(R);return this.each(function(Y){F(this).wrapAll(V?R.call(this,Y):R)})},unwrap:function(R){return this.parent(R).not("body").each(function(){F(this).replaceWith(this.childNodes)}),this}}),F.expr.pseudos.hidden=function(R){return!F.expr.pseudos.visible(R)},F.expr.pseudos.visible=function(R){return!!(R.offsetWidth||R.offsetHeight||R.getClientRects().length)},F.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch{}};var Fd={0:200,1223:204},fh=F.ajaxSettings.xhr();E.cors=!!fh&&"withCredentials"in fh,E.ajax=fh=!!fh,F.ajaxTransport(function(R){var V,Y;if(E.cors||fh&&!R.crossDomain)return{send:function(tt,ht){var ft,xt=R.xhr();if(xt.open(R.type,R.url,R.async,R.username,R.password),R.xhrFields)for(ft in R.xhrFields)xt[ft]=R.xhrFields[ft];R.mimeType&&xt.overrideMimeType&&xt.overrideMimeType(R.mimeType),!R.crossDomain&&!tt["X-Requested-With"]&&(tt["X-Requested-With"]="XMLHttpRequest");for(ft in tt)xt.setRequestHeader(ft,tt[ft]);V=function(Kt){return function(){V&&(V=Y=xt.onload=xt.onerror=xt.onabort=xt.ontimeout=xt.onreadystatechange=null,Kt==="abort"?xt.abort():Kt==="error"?typeof xt.status!="number"?ht(0,"error"):ht(xt.status,xt.statusText):ht(Fd[xt.status]||xt.status,xt.statusText,(xt.responseType||"text")!=="text"||typeof xt.responseText!="string"?{binary:xt.response}:{text:xt.responseText},xt.getAllResponseHeaders()))}},xt.onload=V(),Y=xt.onerror=xt.ontimeout=V("error"),xt.onabort!==void 0?xt.onabort=Y:xt.onreadystatechange=function(){xt.readyState===4&&e.setTimeout(function(){V&&Y()})},V=V("abort");try{xt.send(R.hasContent&&R.data||null)}catch(Kt){if(V)throw Kt}},abort:function(){V&&V()}}}),F.ajaxPrefilter(function(R){R.crossDomain&&(R.contents.script=!1)}),F.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(R){return F.globalEval(R),R}}}),F.ajaxPrefilter("script",function(R){R.cache===void 0&&(R.cache=!1),R.crossDomain&&(R.type="GET")}),F.ajaxTransport("script",function(R){if(R.crossDomain||R.scriptAttrs){var V,Y;return{send:function(tt,ht){V=F("<script>").attr(R.scriptAttrs||{}).prop({charset:R.scriptCharset,src:R.url}).on("load error",Y=function(ft){V.remove(),Y=null,ft&&ht(ft.type==="error"?404:200,ft.type)}),D.head.appendChild(V[0])},abort:function(){Y&&Y()}}}});var zd=[],Ud=/(=)\?(?=&|$)|\?\?/;F.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var R=zd.pop()||F.expando+"_"+Ld.guid++;return this[R]=!0,R}}),F.ajaxPrefilter("json jsonp",function(R,V,Y){var tt,ht,ft,xt=R.jsonp!==!1&&(Ud.test(R.url)?"url":typeof R.data=="string"&&(R.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Ud.test(R.data)&&"data");if(xt||R.dataTypes[0]==="jsonp")return tt=R.jsonpCallback=P(R.jsonpCallback)?R.jsonpCallback():R.jsonpCallback,xt?R[xt]=R[xt].replace(Ud,"$1"+tt):R.jsonp!==!1&&(R.url+=(Od.test(R.url)?"&":"?")+R.jsonp+"="+tt),R.converters["script json"]=function(){return ft||F.error(tt+" was not called"),ft[0]},R.dataTypes[0]="json",ht=e[tt],e[tt]=function(){ft=arguments},Y.always(function(){ht===void 0?F(e).removeProp(tt):e[tt]=ht,R[tt]&&(R.jsonpCallback=V.jsonpCallback,zd.push(tt)),ft&&P(ht)&&ht(ft[0]),ft=ht=void 0}),"script"}),E.createHTMLDocument=function(){var R=D.implementation.createHTMLDocument("").body;return R.innerHTML="<form></form><form></form>",R.childNodes.length===2}(),F.parseHTML=function(R,V,Y){if(typeof R!="string")return[];typeof V=="boolean"&&(Y=V,V=!1);var tt,ht,ft;return V||(E.createHTMLDocument?(V=D.implementation.createHTMLDocument(""),tt=V.createElement("base"),tt.href=D.location.href,V.head.appendChild(tt)):V=D),ht=ir.exec(R),ft=!Y&&[],ht?[V.createElement(ht[1])]:(ht=vt([R],V,ft),ft&&ft.length&&F(ft).remove(),F.merge([],ht.childNodes))},F.fn.load=function(R,V,Y){var tt,ht,ft,xt=this,Kt=R.indexOf(" ");return Kt>-1&&(tt=Ha(R.slice(Kt)),R=R.slice(0,Kt)),P(V)?(Y=V,V=void 0):V&&typeof V=="object"&&(ht="POST"),xt.length>0&&F.ajax({url:R,type:ht||"GET",dataType:"html",data:V}).done(function(Wt){ft=arguments,xt.html(tt?F("<div>").append(F.parseHTML(Wt)).find(tt):Wt)}).always(Y&&function(Wt,oe){xt.each(function(){Y.apply(this,ft||[Wt.responseText,oe,Wt])})}),this},F.expr.pseudos.animated=function(R){return F.grep(F.timers,function(V){return R===V.elem}).length},F.offset={setOffset:function(R,V,Y){var tt,ht,ft,xt,Kt,Wt,oe,Oe=F.css(R,"position"),Fe=F(R),ae={};Oe==="static"&&(R.style.position="relative"),Kt=Fe.offset(),ft=F.css(R,"top"),Wt=F.css(R,"left"),oe=(Oe==="absolute"||Oe==="fixed")&&(ft+Wt).indexOf("auto")>-1,oe?(tt=Fe.position(),xt=tt.top,ht=tt.left):(xt=parseFloat(ft)||0,ht=parseFloat(Wt)||0),P(V)&&(V=V.call(R,Y,F.extend({},Kt))),V.top!=null&&(ae.top=V.top-Kt.top+xt),V.left!=null&&(ae.left=V.left-Kt.left+ht),"using"in V?V.using.call(R,ae):Fe.css(ae)}},F.fn.extend({offset:function(R){if(arguments.length)return R===void 0?this:this.each(function(ht){F.offset.setOffset(this,R,ht)});var V,Y,tt=this[0];if(tt)return tt.getClientRects().length?(V=tt.getBoundingClientRect(),Y=tt.ownerDocument.defaultView,{top:V.top+Y.pageYOffset,left:V.left+Y.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var R,V,Y,tt=this[0],ht={top:0,left:0};if(F.css(tt,"position")==="fixed")V=tt.getBoundingClientRect();else{for(V=this.offset(),Y=tt.ownerDocument,R=tt.offsetParent||Y.documentElement;R&&(R===Y.body||R===Y.documentElement)&&F.css(R,"position")==="static";)R=R.parentNode;R&&R!==tt&&R.nodeType===1&&(ht=F(R).offset(),ht.top+=F.css(R,"borderTopWidth",!0),ht.left+=F.css(R,"borderLeftWidth",!0))}return{top:V.top-ht.top-F.css(tt,"marginTop",!0),left:V.left-ht.left-F.css(tt,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var R=this.offsetParent;R&&F.css(R,"position")==="static";)R=R.offsetParent;return R||No})}}),F.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(R,V){var Y=V==="pageYOffset";F.fn[R]=function(tt){return Xn(this,function(ht,ft,xt){var Kt;if(B(ht)?Kt=ht:ht.nodeType===9&&(Kt=ht.defaultView),xt===void 0)return Kt?Kt[V]:ht[ft];Kt?Kt.scrollTo(Y?Kt.pageXOffset:xt,Y?xt:Kt.pageYOffset):ht[ft]=xt},R,tt,arguments.length)}}),F.each(["top","left"],function(R,V){F.cssHooks[V]=Yn(E.pixelPosition,function(Y,tt){if(tt)return tt=Zn(Y,V),wn.test(tt)?F(Y).position()[V]+"px":tt})}),F.each({Height:"height",Width:"width"},function(R,V){F.each({padding:"inner"+R,content:V,"":"outer"+R},function(Y,tt){F.fn[tt]=function(ht,ft){var xt=arguments.length&&(Y||typeof ht!="boolean"),Kt=Y||(ht===!0||ft===!0?"margin":"border");return Xn(this,function(Wt,oe,Oe){var Fe;return B(Wt)?tt.indexOf("outer")===0?Wt["inner"+R]:Wt.document.documentElement["client"+R]:Wt.nodeType===9?(Fe=Wt.documentElement,Math.max(Wt.body["scroll"+R],Fe["scroll"+R],Wt.body["offset"+R],Fe["offset"+R],Fe["client"+R])):Oe===void 0?F.css(Wt,oe,Kt):F.style(Wt,oe,Oe,Kt)},V,xt?ht:void 0,xt)}})}),F.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(R,V){F.fn[V]=function(Y){return this.on(V,Y)}}),F.fn.extend({bind:function(R,V,Y){return this.on(R,null,V,Y)},unbind:function(R,V){return this.off(R,null,V)},delegate:function(R,V,Y,tt){return this.on(V,R,Y,tt)},undelegate:function(R,V,Y){return arguments.length===1?this.off(R,"**"):this.off(V,R||"**",Y)},hover:function(R,V){return this.on("mouseenter",R).on("mouseleave",V||R)}}),F.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(R,V){F.fn[V]=function(Y,tt){return arguments.length>0?this.on(V,null,Y,tt):this.trigger(V)}});var of=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;F.proxy=function(R,V){var Y,tt,ht;if(typeof V=="string"&&(Y=R[V],V=R,R=Y),!!P(R))return tt=i.call(arguments,2),ht=function(){return R.apply(V||this,tt.concat(i.call(arguments)))},ht.guid=R.guid=R.guid||F.guid++,ht},F.holdReady=function(R){R?F.readyWait++:F.ready(!0)},F.isArray=Array.isArray,F.parseJSON=JSON.parse,F.nodeName=ot,F.isFunction=P,F.isWindow=B,F.camelCase=Cn,F.type=q,F.now=Date.now,F.isNumeric=function(R){var V=F.type(R);return(V==="number"||V==="string")&&!isNaN(R-parseFloat(R))},F.trim=function(R){return R==null?"":(R+"").replace(of,"$1")},typeof define=="function"&&define.amd&&define("jquery",[],function(){return F});var sf=e.jQuery,wA=e.$;return F.noConflict=function(R){return e.$===F&&(e.$=wA),R&&e.jQuery===F&&(e.jQuery=sf),F},typeof t>"u"&&(e.jQuery=e.$=F),F})});var h8=Ye(u8=>{(function(e){var t=typeof self=="object"&&self.self==self&&self||typeof global=="object"&&global.global==global&&global;if(typeof define=="function"&&define.amd)define(["underscore","jquery","exports"],function(i,o,s){t.Backbone=e(t,s,i,o)});else if(typeof u8<"u"){var r=(Zut(),rV(Kut)),n;try{n=l8()}catch{}e(t,u8,r,n)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)})(function(e,t,r,n){var i=e.Backbone,o=Array.prototype.slice;t.VERSION="1.2.3",t.$=n,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var s=function(dt,wt,Ht){switch(dt){case 1:return function(){return r[wt](this[Ht])};case 2:return function(ue){return r[wt](this[Ht],ue)};case 3:return function(ue,Le){return r[wt](this[Ht],l(ue,this),Le)};case 4:return function(ue,Le,Ee){return r[wt](this[Ht],l(ue,this),Le,Ee)};default:return function(){var ue=o.call(arguments);return ue.unshift(this[Ht]),r[wt].apply(r,ue)}}},c=function(dt,wt,Ht){r.each(wt,function(ue,Le){r[Le]&&(dt.prototype[Le]=s(ue,Le,Ht))})},l=function(dt,wt){return r.isFunction(dt)?dt:r.isObject(dt)&&!wt._isModel(dt)?h(dt):r.isString(dt)?function(Ht){return Ht.get(dt)}:dt},h=function(dt){var wt=r.matches(dt);return function(Ht){return wt(Ht.attributes)}},p=t.Events={},x=/\s+/,w=function(dt,wt,Ht,ue,Le){var Ee=0,Jr;if(Ht&&typeof Ht=="object")for(ue!==void 0&&("context"in Le)&&Le.context===void 0&&(Le.context=ue),Jr=r.keys(Ht);Ee<Jr.length;Ee++)wt=w(dt,wt,Jr[Ee],Ht[Jr[Ee]],Le);else if(Ht&&x.test(Ht))for(Jr=Ht.split(x);Ee<Jr.length;Ee++)wt=dt(wt,Jr[Ee],ue,Le);else wt=dt(wt,Ht,ue,Le);return wt};p.on=function(dt,wt,Ht){return E(this,dt,wt,Ht)};var E=function(dt,wt,Ht,ue,Le){if(dt._events=w(P,dt._events||{},wt,Ht,{context:ue,ctx:dt,listening:Le}),Le){var Ee=dt._listeners||(dt._listeners={});Ee[Le.id]=Le}return dt};p.listenTo=function(dt,wt,Ht){if(!dt)return this;var ue=dt._listenId||(dt._listenId=r.uniqueId("l")),Le=this._listeningTo||(this._listeningTo={}),Ee=Le[ue];if(!Ee){var Jr=this._listenId||(this._listenId=r.uniqueId("l"));Ee=Le[ue]={obj:dt,objId:ue,id:Jr,listeningTo:Le,count:0}}return E(dt,wt,Ht,this,Ee),this};var P=function(dt,wt,Ht,ue){if(Ht){var Le=dt[wt]||(dt[wt]=[]),Ee=ue.context,Jr=ue.ctx,bn=ue.listening;bn&&bn.count++,Le.push({callback:Ht,context:Ee,ctx:Ee||Jr,listening:bn})}return dt};p.off=function(dt,wt,Ht){return this._events?(this._events=w(B,this._events,dt,wt,{context:Ht,listeners:this._listeners}),this):this},p.stopListening=function(dt,wt,Ht){var ue=this._listeningTo;if(!ue)return this;for(var Le=dt?[dt._listenId]:r.keys(ue),Ee=0;Ee<Le.length;Ee++){var Jr=ue[Le[Ee]];if(!Jr)break;Jr.obj.off(wt,Ht,this)}return r.isEmpty(ue)&&(this._listeningTo=void 0),this};var B=function(dt,wt,Ht,ue){if(dt){var Le=0,Ee,Jr=ue.context,bn=ue.listeners;if(!wt&&!Ht&&!Jr){for(var ai=r.keys(bn);Le<ai.length;Le++)Ee=bn[ai[Le]],delete bn[Ee.id],delete Ee.listeningTo[Ee.objId];return}for(var qo=wt?[wt]:r.keys(dt);Le<qo.length;Le++){wt=qo[Le];var _i=dt[wt];if(!_i)break;for(var Xn=[],Ui=0;Ui<_i.length;Ui++){var bs=_i[Ui];Ht&&Ht!==bs.callback&&Ht!==bs.callback._callback||Jr&&Jr!==bs.context?Xn.push(bs):(Ee=bs.listening,Ee&&--Ee.count===0&&(delete bn[Ee.id],delete Ee.listeningTo[Ee.objId]))}Xn.length?dt[wt]=Xn:delete dt[wt]}if(r.size(dt))return dt}};p.once=function(dt,wt,Ht){var ue=w(D,{},dt,wt,r.bind(this.off,this));return this.on(ue,void 0,Ht)},p.listenToOnce=function(dt,wt,Ht){var ue=w(D,{},wt,Ht,r.bind(this.stopListening,this,dt));return this.listenTo(dt,ue)};var D=function(dt,wt,Ht,ue){if(Ht){var Le=dt[wt]=r.once(function(){ue(wt,Le),Ht.apply(this,arguments)});Le._callback=Ht}return dt};p.trigger=function(dt){if(!this._events)return this;for(var wt=Math.max(0,arguments.length-1),Ht=Array(wt),ue=0;ue<wt;ue++)Ht[ue]=arguments[ue+1];return w(W,this._events,dt,void 0,Ht),this};var W=function(dt,wt,Ht,ue){if(dt){var Le=dt[wt],Ee=dt.all;Le&&Ee&&(Ee=Ee.slice()),Le&&X(Le,ue),Ee&&X(Ee,[wt].concat(ue))}return dt},X=function(dt,wt){var Ht,ue=-1,Le=dt.length,Ee=wt[0],Jr=wt[1],bn=wt[2];switch(wt.length){case 0:for(;++ue<Le;)(Ht=dt[ue]).callback.call(Ht.ctx);return;case 1:for(;++ue<Le;)(Ht=dt[ue]).callback.call(Ht.ctx,Ee);return;case 2:for(;++ue<Le;)(Ht=dt[ue]).callback.call(Ht.ctx,Ee,Jr);return;case 3:for(;++ue<Le;)(Ht=dt[ue]).callback.call(Ht.ctx,Ee,Jr,bn);return;default:for(;++ue<Le;)(Ht=dt[ue]).callback.apply(Ht.ctx,wt);return}};p.bind=p.on,p.unbind=p.off,r.extend(t,p);var q=t.Model=function(dt,wt){var Ht=dt||{};wt||(wt={}),this.cid=r.uniqueId(this.cidPrefix),this.attributes={},wt.collection&&(this.collection=wt.collection),wt.parse&&(Ht=this.parse(Ht,wt)||{}),Ht=r.defaults({},Ht,r.result(this,"defaults")),this.set(Ht,wt),this.changed={},this.initialize.apply(this,arguments)};r.extend(q.prototype,p,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(dt){return r.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(dt){return this.attributes[dt]},escape:function(dt){return r.escape(this.get(dt))},has:function(dt){return this.get(dt)!=null},matches:function(dt){return!!r.iteratee(dt,this)(this.attributes)},set:function(dt,wt,Ht){if(dt==null)return this;var ue;if(typeof dt=="object"?(ue=dt,Ht=wt):(ue={})[dt]=wt,Ht||(Ht={}),!this._validate(ue,Ht))return!1;var Le=Ht.unset,Ee=Ht.silent,Jr=[],bn=this._changing;this._changing=!0,bn||(this._previousAttributes=r.clone(this.attributes),this.changed={});var ai=this.attributes,qo=this.changed,_i=this._previousAttributes;for(var Xn in ue)wt=ue[Xn],r.isEqual(ai[Xn],wt)||Jr.push(Xn),r.isEqual(_i[Xn],wt)?delete qo[Xn]:qo[Xn]=wt,Le?delete ai[Xn]:ai[Xn]=wt;if(this.id=this.get(this.idAttribute),!Ee){Jr.length&&(this._pending=Ht);for(var Ui=0;Ui<Jr.length;Ui++)this.trigger("change:"+Jr[Ui],this,ai[Jr[Ui]],Ht)}if(bn)return this;if(!Ee)for(;this._pending;)Ht=this._pending,this._pending=!1,this.trigger("change",this,Ht);return this._pending=!1,this._changing=!1,this},unset:function(dt,wt){return this.set(dt,void 0,r.extend({},wt,{unset:!0}))},clear:function(dt){var wt={};for(var Ht in this.attributes)wt[Ht]=void 0;return this.set(wt,r.extend({},dt,{unset:!0}))},hasChanged:function(dt){return dt==null?!r.isEmpty(this.changed):r.has(this.changed,dt)},changedAttributes:function(dt){if(!dt)return this.hasChanged()?r.clone(this.changed):!1;var wt=this._changing?this._previousAttributes:this.attributes,Ht={};for(var ue in dt){var Le=dt[ue];r.isEqual(wt[ue],Le)||(Ht[ue]=Le)}return r.size(Ht)?Ht:!1},previous:function(dt){return dt==null||!this._previousAttributes?null:this._previousAttributes[dt]},previousAttributes:function(){return r.clone(this._previousAttributes)},fetch:function(dt){dt=r.extend({parse:!0},dt);var wt=this,Ht=dt.success;return dt.success=function(ue){var Le=dt.parse?wt.parse(ue,dt):ue;if(!wt.set(Le,dt))return!1;Ht&&Ht.call(dt.context,wt,ue,dt),wt.trigger("sync",wt,ue,dt)},_n(this,dt),this.sync("read",this,dt)},save:function(dt,wt,Ht){var ue;dt==null||typeof dt=="object"?(ue=dt,Ht=wt):(ue={})[dt]=wt,Ht=r.extend({validate:!0,parse:!0},Ht);var Le=Ht.wait;if(ue&&!Le){if(!this.set(ue,Ht))return!1}else if(!this._validate(ue,Ht))return!1;var Ee=this,Jr=Ht.success,bn=this.attributes;Ht.success=function(_i){Ee.attributes=bn;var Xn=Ht.parse?Ee.parse(_i,Ht):_i;if(Le&&(Xn=r.extend({},ue,Xn)),Xn&&!Ee.set(Xn,Ht))return!1;Jr&&Jr.call(Ht.context,Ee,_i,Ht),Ee.trigger("sync",Ee,_i,Ht)},_n(this,Ht),ue&&Le&&(this.attributes=r.extend({},bn,ue));var ai=this.isNew()?"create":Ht.patch?"patch":"update";ai==="patch"&&!Ht.attrs&&(Ht.attrs=ue);var qo=this.sync(ai,this,Ht);return this.attributes=bn,qo},destroy:function(dt){dt=dt?r.clone(dt):{};var wt=this,Ht=dt.success,ue=dt.wait,Le=function(){wt.stopListening(),wt.trigger("destroy",wt,wt.collection,dt)};dt.success=function(Jr){ue&&Le(),Ht&&Ht.call(dt.context,wt,Jr,dt),wt.isNew()||wt.trigger("sync",wt,Jr,dt)};var Ee=!1;return this.isNew()?r.defer(dt.success):(_n(this,dt),Ee=this.sync("delete",this,dt)),ue||Le(),Ee},url:function(){var dt=r.result(this,"urlRoot")||r.result(this.collection,"url")||He();if(this.isNew())return dt;var wt=this.get(this.idAttribute);return dt.replace(/[^\/]$/,"$&/")+encodeURIComponent(wt)},parse:function(dt,wt){return dt},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(dt){return this._validate({},r.defaults({validate:!0},dt))},_validate:function(dt,wt){if(!wt.validate||!this.validate)return!0;dt=r.extend({},this.attributes,dt);var Ht=this.validationError=this.validate(dt,wt)||null;return Ht?(this.trigger("invalid",this,Ht,r.extend(wt,{validationError:Ht})),!1):!0}});var $={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};c(q,$,"attributes");var et=t.Collection=function(dt,wt){wt||(wt={}),wt.model&&(this.model=wt.model),wt.comparator!==void 0&&(this.comparator=wt.comparator),this._reset(),this.initialize.apply(this,arguments),dt&&this.reset(dt,r.extend({silent:!0},wt))},F={add:!0,remove:!0,merge:!0},ut={add:!0,remove:!1},ot=function(dt,wt,Ht){Ht=Math.min(Math.max(Ht,0),dt.length);for(var ue=Array(dt.length-Ht),Le=wt.length,Ee=0;Ee<ue.length;Ee++)ue[Ee]=dt[Ee+Ht];for(Ee=0;Ee<Le;Ee++)dt[Ee+Ht]=wt[Ee];for(Ee=0;Ee<ue.length;Ee++)dt[Ee+Le+Ht]=ue[Ee]};r.extend(et.prototype,p,{model:q,initialize:function(){},toJSON:function(dt){return this.map(function(wt){return wt.toJSON(dt)})},sync:function(){return t.sync.apply(this,arguments)},add:function(dt,wt){return this.set(dt,r.extend({merge:!1},wt,ut))},remove:function(dt,wt){wt=r.extend({},wt);var Ht=!r.isArray(dt);dt=Ht?[dt]:r.clone(dt);var ue=this._removeModels(dt,wt);return!wt.silent&&ue&&this.trigger("update",this,wt),Ht?ue[0]:ue},set:function(dt,wt){if(dt!=null){wt=r.defaults({},wt,F),wt.parse&&!this._isModel(dt)&&(dt=this.parse(dt,wt));var Ht=!r.isArray(dt);dt=Ht?[dt]:dt.slice();var ue=wt.at;ue!=null&&(ue=+ue),ue<0&&(ue+=this.length+1);for(var Le=[],Ee=[],Jr=[],bn={},ai=wt.add,qo=wt.merge,_i=wt.remove,Xn=!1,Ui=this.comparator&&ue==null&&wt.sort!==!1,bs=r.isString(this.comparator)?this.comparator:null,Vi,Cn=0;Cn<dt.length;Cn++){Vi=dt[Cn];var yi=this.get(Vi);if(yi){if(qo&&Vi!==yi){var _o=this._isModel(Vi)?Vi.attributes:Vi;wt.parse&&(_o=yi.parse(_o,wt)),yi.set(_o,wt),Ui&&!Xn&&(Xn=yi.hasChanged(bs))}bn[yi.cid]||(bn[yi.cid]=!0,Le.push(yi)),dt[Cn]=yi}else ai&&(Vi=dt[Cn]=this._prepareModel(Vi,wt),Vi&&(Ee.push(Vi),this._addReference(Vi,wt),bn[Vi.cid]=!0,Le.push(Vi)))}if(_i){for(Cn=0;Cn<this.length;Cn++)Vi=this.models[Cn],bn[Vi.cid]||Jr.push(Vi);Jr.length&&this._removeModels(Jr,wt)}var Nr=!1,ar=!Ui&&ai&&_i;if(Le.length&&ar?(Nr=this.length!=Le.length||r.some(this.models,function(zr,hn){return zr!==Le[hn]}),this.models.length=0,ot(this.models,Le,0),this.length=this.models.length):Ee.length&&(Ui&&(Xn=!0),ot(this.models,Ee,ue??this.length),this.length=this.models.length),Xn&&this.sort({silent:!0}),!wt.silent){for(Cn=0;Cn<Ee.length;Cn++)ue!=null&&(wt.index=ue+Cn),Vi=Ee[Cn],Vi.trigger("add",Vi,this,wt);(Xn||Nr)&&this.trigger("sort",this,wt),(Ee.length||Jr.length)&&this.trigger("update",this,wt)}return Ht?dt[0]:dt}},reset:function(dt,wt){wt=wt?r.clone(wt):{};for(var Ht=0;Ht<this.models.length;Ht++)this._removeReference(this.models[Ht],wt);return wt.previousModels=this.models,this._reset(),dt=this.add(dt,r.extend({silent:!0},wt)),wt.silent||this.trigger("reset",this,wt),dt},push:function(dt,wt){return this.add(dt,r.extend({at:this.length},wt))},pop:function(dt){var wt=this.at(this.length-1);return this.remove(wt,dt)},unshift:function(dt,wt){return this.add(dt,r.extend({at:0},wt))},shift:function(dt){var wt=this.at(0);return this.remove(wt,dt)},slice:function(){return o.apply(this.models,arguments)},get:function(dt){if(dt!=null){var wt=this.modelId(this._isModel(dt)?dt.attributes:dt);return this._byId[dt]||this._byId[wt]||this._byId[dt.cid]}},at:function(dt){return dt<0&&(dt+=this.length),this.models[dt]},where:function(dt,wt){return this[wt?"find":"filter"](dt)},findWhere:function(dt){return this.where(dt,!0)},sort:function(dt){var wt=this.comparator;if(!wt)throw new Error("Cannot sort a set without a comparator");dt||(dt={});var Ht=wt.length;return r.isFunction(wt)&&(wt=r.bind(wt,this)),Ht===1||r.isString(wt)?this.models=this.sortBy(wt):this.models.sort(wt),dt.silent||this.trigger("sort",this,dt),this},pluck:function(dt){return r.invoke(this.models,"get",dt)},fetch:function(dt){dt=r.extend({parse:!0},dt);var wt=dt.success,Ht=this;return dt.success=function(ue){var Le=dt.reset?"reset":"set";Ht[Le](ue,dt),wt&&wt.call(dt.context,Ht,ue,dt),Ht.trigger("sync",Ht,ue,dt)},_n(this,dt),this.sync("read",this,dt)},create:function(dt,wt){wt=wt?r.clone(wt):{};var Ht=wt.wait;if(dt=this._prepareModel(dt,wt),!dt)return!1;Ht||this.add(dt,wt);var ue=this,Le=wt.success;return wt.success=function(Ee,Jr,bn){Ht&&ue.add(Ee,bn),Le&&Le.call(bn.context,Ee,Jr,bn)},dt.save(null,wt),dt},parse:function(dt,wt){return dt},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(dt){return dt[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(dt,wt){if(this._isModel(dt))return dt.collection||(dt.collection=this),dt;wt=wt?r.clone(wt):{},wt.collection=this;var Ht=new this.model(dt,wt);return Ht.validationError?(this.trigger("invalid",this,Ht.validationError,wt),!1):Ht},_removeModels:function(dt,wt){for(var Ht=[],ue=0;ue<dt.length;ue++){var Le=this.get(dt[ue]);if(Le){var Ee=this.indexOf(Le);this.models.splice(Ee,1),this.length--,wt.silent||(wt.index=Ee,Le.trigger("remove",Le,this,wt)),Ht.push(Le),this._removeReference(Le,wt)}}return Ht.length?Ht:!1},_isModel:function(dt){return dt instanceof q},_addReference:function(dt,wt){this._byId[dt.cid]=dt;var Ht=this.modelId(dt.attributes);Ht!=null&&(this._byId[Ht]=dt),dt.on("all",this._onModelEvent,this)},_removeReference:function(dt,wt){delete this._byId[dt.cid];var Ht=this.modelId(dt.attributes);Ht!=null&&delete this._byId[Ht],this===dt.collection&&delete dt.collection,dt.off("all",this._onModelEvent,this)},_onModelEvent:function(dt,wt,Ht,ue){if(!((dt==="add"||dt==="remove")&&Ht!==this)){if(dt==="destroy"&&this.remove(wt,ue),dt==="change"){var Le=this.modelId(wt.previousAttributes()),Ee=this.modelId(wt.attributes);Le!==Ee&&(Le!=null&&delete this._byId[Le],Ee!=null&&(this._byId[Ee]=wt))}this.trigger.apply(this,arguments)}}});var J={forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3};c(et,J,"models");var G=t.View=function(dt){this.cid=r.uniqueId("view"),r.extend(this,r.pick(dt,Mt)),this._ensureElement(),this.initialize.apply(this,arguments)},mt=/^(\S+)\s*(.*)$/,Mt=["model","collection","el","id","attributes","className","tagName","events"];r.extend(G.prototype,p,{tagName:"div",$:function(dt){return this.$el.find(dt)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(dt){return this.undelegateEvents(),this._setElement(dt),this.delegateEvents(),this},_setElement:function(dt){this.$el=dt instanceof t.$?dt:t.$(dt),this.el=this.$el[0]},delegateEvents:function(dt){if(dt||(dt=r.result(this,"events")),!dt)return this;this.undelegateEvents();for(var wt in dt){var Ht=dt[wt];if(r.isFunction(Ht)||(Ht=this[Ht]),!!Ht){var ue=wt.match(mt);this.delegate(ue[1],ue[2],r.bind(Ht,this))}}return this},delegate:function(dt,wt,Ht){return this.$el.on(dt+".delegateEvents"+this.cid,wt,Ht),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(dt,wt,Ht){return this.$el.off(dt+".delegateEvents"+this.cid,wt,Ht),this},_createElement:function(dt){return document.createElement(dt)},_ensureElement:function(){if(this.el)this.setElement(r.result(this,"el"));else{var dt=r.extend({},r.result(this,"attributes"));this.id&&(dt.id=r.result(this,"id")),this.className&&(dt.class=r.result(this,"className")),this.setElement(this._createElement(r.result(this,"tagName"))),this._setAttributes(dt)}},_setAttributes:function(dt){this.$el.attr(dt)}}),t.sync=function(dt,wt,Ht){var ue=ct[dt];r.defaults(Ht||(Ht={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var Le={type:ue,dataType:"json"};if(Ht.url||(Le.url=r.result(wt,"url")||He()),Ht.data==null&&wt&&(dt==="create"||dt==="update"||dt==="patch")&&(Le.contentType="application/json",Le.data=JSON.stringify(Ht.attrs||wt.toJSON(Ht))),Ht.emulateJSON&&(Le.contentType="application/x-www-form-urlencoded",Le.data=Le.data?{model:Le.data}:{}),Ht.emulateHTTP&&(ue==="PUT"||ue==="DELETE"||ue==="PATCH")){Le.type="POST",Ht.emulateJSON&&(Le.data._method=ue);var Ee=Ht.beforeSend;Ht.beforeSend=function(ai){if(ai.setRequestHeader("X-HTTP-Method-Override",ue),Ee)return Ee.apply(this,arguments)}}Le.type!=="GET"&&!Ht.emulateJSON&&(Le.processData=!1);var Jr=Ht.error;Ht.error=function(ai,qo,_i){Ht.textStatus=qo,Ht.errorThrown=_i,Jr&&Jr.call(Ht.context,ai,qo,_i)};var bn=Ht.xhr=t.ajax(r.extend(Le,Ht));return wt.trigger("request",wt,bn,Ht),bn};var ct={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var gt=t.Router=function(dt){dt||(dt={}),dt.routes&&(this.routes=dt.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},ee=/\((.*?)\)/g,Ne=/(\(\?)?:\w+/g,Ue=/\*\w+/g,sr=/[\-{}\[\]+?.,\\\^$|#\s]/g;r.extend(gt.prototype,p,{initialize:function(){},route:function(dt,wt,Ht){r.isRegExp(dt)||(dt=this._routeToRegExp(dt)),r.isFunction(wt)&&(Ht=wt,wt=""),Ht||(Ht=this[wt]);var ue=this;return t.history.route(dt,function(Le){var Ee=ue._extractParameters(dt,Le);ue.execute(Ht,Ee,wt)!==!1&&(ue.trigger.apply(ue,["route:"+wt].concat(Ee)),ue.trigger("route",wt,Ee),t.history.trigger("route",ue,wt,Ee))}),this},execute:function(dt,wt,Ht){dt&&dt.apply(this,wt)},navigate:function(dt,wt){return t.history.navigate(dt,wt),this},_bindRoutes:function(){if(this.routes){this.routes=r.result(this,"routes");for(var dt,wt=r.keys(this.routes);(dt=wt.pop())!=null;)this.route(dt,this.routes[dt])}},_routeToRegExp:function(dt){return dt=dt.replace(sr,"\\$&").replace(ee,"(?:$1)?").replace(Ne,function(wt,Ht){return Ht?wt:"([^/?]+)"}).replace(Ue,"([^?]*?)"),new RegExp("^"+dt+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(dt,wt){var Ht=dt.exec(wt).slice(1);return r.map(Ht,function(ue,Le){return Le===Ht.length-1?ue||null:ue?decodeURIComponent(ue):null})}});var gr=t.History=function(){this.handlers=[],this.checkUrl=r.bind(this.checkUrl,this),typeof window<"u"&&(this.location=window.location,this.history=window.history)},Xr=/^[#\/]|\s+$/g,ir=/^\/+|\/+$/g,on=/#.*$/;gr.started=!1,r.extend(gr.prototype,p,{interval:50,atRoot:function(){var dt=this.location.pathname.replace(/[^\/]$/,"$&/");return dt===this.root&&!this.getSearch()},matchRoot:function(){var dt=this.decodeFragment(this.location.pathname),wt=dt.slice(0,this.root.length-1)+"/";return wt===this.root},decodeFragment:function(dt){return decodeURI(dt.replace(/%25/g,"%2525"))},getSearch:function(){var dt=this.location.href.replace(/#.*/,"").match(/\?.+/);return dt?dt[0]:""},getHash:function(dt){var wt=(dt||this).location.href.match(/#(.*)$/);return wt?wt[1]:""},getPath:function(){var dt=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return dt.charAt(0)==="/"?dt.slice(1):dt},getFragment:function(dt){return dt==null&&(this._usePushState||!this._wantsHashChange?dt=this.getPath():dt=this.getHash()),dt.replace(Xr,"")},start:function(dt){if(gr.started)throw new Error("Backbone.history has already been started");if(gr.started=!0,this.options=r.extend({root:"/"},this.options,dt),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(document.documentMode===void 0||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.history&&this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(ir,"/"),this._wantsHashChange&&this._wantsPushState)if(!this._hasPushState&&!this.atRoot()){var wt=this.root.slice(0,-1)||"/";return this.location.replace(wt+"#"+this.getPath()),!0}else this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0});if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var Ht=document.body,ue=Ht.insertBefore(this.iframe,Ht.firstChild).contentWindow;ue.document.open(),ue.document.close(),ue.location.hash="#"+this.fragment}var Le=window.addEventListener||function(Ee,Jr){return attachEvent("on"+Ee,Jr)};if(this._usePushState?Le("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?Le("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var dt=window.removeEventListener||function(wt,Ht){return detachEvent("on"+wt,Ht)};this._usePushState?dt("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&dt("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),gr.started=!1},route:function(dt,wt){this.handlers.unshift({route:dt,callback:wt})},checkUrl:function(dt){var wt=this.getFragment();if(wt===this.fragment&&this.iframe&&(wt=this.getHash(this.iframe.contentWindow)),wt===this.fragment)return!1;this.iframe&&this.navigate(wt),this.loadUrl()},loadUrl:function(dt){return this.matchRoot()?(dt=this.fragment=this.getFragment(dt),r.some(this.handlers,function(wt){if(wt.route.test(dt))return wt.callback(dt),!0})):!1},navigate:function(dt,wt){if(!gr.started)return!1;(!wt||wt===!0)&&(wt={trigger:!!wt}),dt=this.getFragment(dt||"");var Ht=this.root;(dt===""||dt.charAt(0)==="?")&&(Ht=Ht.slice(0,-1)||"/");var ue=Ht+dt;if(dt=this.decodeFragment(dt.replace(on,"")),this.fragment!==dt){if(this.fragment=dt,this._usePushState)this.history[wt.replace?"replaceState":"pushState"]({},document.title,ue);else if(this._wantsHashChange){if(this._updateHash(this.location,dt,wt.replace),this.iframe&&dt!==this.getHash(this.iframe.contentWindow)){var Le=this.iframe.contentWindow;wt.replace||(Le.document.open(),Le.document.close()),this._updateHash(Le.location,dt,wt.replace)}}else return this.location.assign(ue);if(wt.trigger)return this.loadUrl(dt)}},_updateHash:function(dt,wt,Ht){if(Ht){var ue=dt.href.replace(/(javascript:|#).*$/,"");dt.replace(ue+"#"+wt)}else dt.hash="#"+wt}}),t.history=new gr;var Xe=function(dt,wt){var Ht=this,ue;dt&&r.has(dt,"constructor")?ue=dt.constructor:ue=function(){return Ht.apply(this,arguments)},r.extend(ue,Ht,wt);var Le=function(){this.constructor=ue};return Le.prototype=Ht.prototype,ue.prototype=new Le,dt&&r.extend(ue.prototype,dt),ue.__super__=Ht.prototype,ue};q.extend=et.extend=gt.extend=G.extend=gr.extend=Xe;var He=function(){throw new Error('A "url" property or function must be specified')},_n=function(dt,wt){var Ht=wt.error;wt.error=function(ue){Ht&&Ht.call(wt.context,dt,ue,wt),dt.trigger("error",dt,ue,wt)}};return t})});var $zt={};Lo($zt,{JupyterTransportModel:()=>ght,JupyterTransportView:()=>xht,MODULE_NAME:()=>ev,MODULE_VERSION:()=>tv,createDeck:()=>wI,initPlayground:()=>TI,jupyterTransport:()=>ug,updateDeck:()=>vot});var tv=typeof __VERSION__>"u"?"untranspiled source":__VERSION__,ev="@deck.gl/jupyter-widget";var gE=class{schema;options;shape;length=0;rows=null;cursor=0;_headers=[];constructor(t,r){if(this.options=r,this.schema=t,!Array.isArray(t)){this._headers=[];for(let n in t)this._headers[t[n].index]=t[n].name}}rowCount(){return this.length}addArrayRow(t,r){Number.isFinite(r)&&(this.cursor=r),this.shape="array-row-table",this.rows=this.rows||new Array(100),this.rows[this.length]=t,this.length++}addObjectRow(t,r){Number.isFinite(r)&&(this.cursor=r),this.shape="object-row-table",this.rows=this.rows||new Array(100),this.rows[this.length]=t,this.length++}getBatch(){let t=this.rows;return t?(t=t.slice(0,this.length),this.rows=null,{shape:this.shape||"array-row-table",batchType:"data",data:t,length:this.length,schema:this.schema,cursor:this.cursor}):null}};function rv(e,t){if(!e)throw new Error("null row");let r={};if(t)for(let n=0;n<t.length;n++)r[t[n]]=e[n];else for(let n=0;n<e.length;n++){let i=`column-${n}`;r[i]=e[n]}return r}function nv(e,t){if(!e)throw new Error("null row");if(t){let r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=e[t[n]];return r}return Object.values(e)}function nV(e){let t=[];for(let r=0;r<e.length;r++){let n=`column-${r}`;t.push(n)}return t}function iV(e){return Object.keys(e)}var oV=100,_E=class{schema;options;length=0;objectRows=null;arrayRows=null;cursor=0;_headers=null;constructor(t,r){if(this.options=r,this.schema=t,t){this._headers=[];for(let n in t)this._headers[t[n].index]=t[n].name}}rowCount(){return this.length}addArrayRow(t,r){switch(Number.isFinite(r)&&(this.cursor=r),this._headers||=nV(t),this.options.shape){case"object-row-table":let n=rv(t,this._headers);this.addObjectRow(n,r);break;case"array-row-table":this.arrayRows=this.arrayRows||new Array(oV),this.arrayRows[this.length]=t,this.length++;break}}addObjectRow(t,r){switch(Number.isFinite(r)&&(this.cursor=r),this._headers||=iV(t),this.options.shape){case"array-row-table":let n=nv(t,this._headers);this.addArrayRow(n,r);break;case"object-row-table":this.objectRows=this.objectRows||new Array(oV),this.objectRows[this.length]=t,this.length++;break}}getBatch(){let t=this.arrayRows||this.objectRows;return t?(t=t.slice(0,this.length),this.arrayRows=null,this.objectRows=null,{shape:this.options.shape,batchType:"data",data:t,length:this.length,schema:this.schema,cursor:this.cursor}):null}};var yE=class{schema;length=0;allocated=0;columns={};constructor(t,r){this.schema=t,this._reallocateColumns()}rowCount(){return this.length}addArrayRow(t){this._reallocateColumns();let r=0;for(let n in this.columns)this.columns[n][this.length]=t[r++];this.length++}addObjectRow(t){this._reallocateColumns();for(let r in t)this.columns[r][this.length]=t[r];this.length++}getBatch(){this._pruneColumns();let t=Array.isArray(this.schema)?this.columns:{};if(!Array.isArray(this.schema))for(let n in this.schema){let i=this.schema[n];t[i.name]=this.columns[i.index]}return this.columns={},{shape:"columnar-table",batchType:"data",data:t,schema:this.schema,length:this.length}}_reallocateColumns(){if(!(this.length<this.allocated)){this.allocated=this.allocated>0?this.allocated*=2:100,this.columns={};for(let t in this.schema){let r=this.schema[t],n=r.type||Float32Array,i=this.columns[r.index];if(i&&ArrayBuffer.isView(i)){let o=new n(this.allocated);o.set(i),this.columns[r.index]=o}else i?(i.length=this.allocated,this.columns[r.index]=i):this.columns[r.index]=new n(this.allocated)}}}_pruneColumns(){for(let[t,r]of Object.entries(this.columns))this.columns[t]=r.slice(0,this.length)}};var Bft={shape:void 0,batchSize:"auto",batchDebounceMs:0,limit:0,_limitMB:0},Dft="TableBatchBuilder",xE=class{schema;options;aggregator=null;batchCount=0;bytesUsed=0;isChunkComplete=!1;lastBatchEmittedMs=Date.now();totalLength=0;totalBytes=0;rowBytes=0;constructor(t,r){this.schema=t,this.options={...Bft,...r}}limitReached(){return!!(Boolean(this.options?.limit)&&this.totalLength>=this.options.limit||Boolean(this.options?._limitMB)&&this.totalBytes/1e6>=this.options._limitMB)}addRow(t){this.limitReached()||(this.totalLength++,this.rowBytes=this.rowBytes||this._estimateRowMB(t),this.totalBytes+=this.rowBytes,Array.isArray(t)?this.addArrayRow(t):this.addObjectRow(t))}addArrayRow(t){if(!this.aggregator){let r=this._getTableBatchType();this.aggregator=new r(this.schema,this.options)}this.aggregator.addArrayRow(t)}addObjectRow(t){if(!this.aggregator){let r=this._getTableBatchType();this.aggregator=new r(this.schema,this.options)}this.aggregator.addObjectRow(t)}chunkComplete(t){t instanceof ArrayBuffer&&(this.bytesUsed+=t.byteLength),typeof t=="string"&&(this.bytesUsed+=t.length),this.isChunkComplete=!0}getFullBatch(t){return this._isFull()?this._getBatch(t):null}getFinalBatch(t){return this._getBatch(t)}_estimateRowMB(t){return Array.isArray(t)?t.length*8:Object.keys(t).length*8}_isFull(){if(!this.aggregator||this.aggregator.rowCount()===0)return!1;if(this.options.batchSize==="auto"){if(!this.isChunkComplete)return!1}else if(this.options.batchSize>this.aggregator.rowCount())return!1;return this.options.batchDebounceMs>Date.now()-this.lastBatchEmittedMs?!1:(this.isChunkComplete=!1,this.lastBatchEmittedMs=Date.now(),!0)}_getBatch(t){if(!this.aggregator)return null;t?.bytesUsed&&(this.bytesUsed=t.bytesUsed);let r=this.aggregator.getBatch();return r.count=this.batchCount,r.bytesUsed=this.bytesUsed,Object.assign(r,t),this.batchCount++,this.aggregator=null,r}_getTableBatchType(){switch(this.options.shape){case"array-row-table":case"object-row-table":return _E;case"columnar-table":return yE;case"arrow-table":if(!xE.ArrowBatch)throw new Error(Dft);return xE.ArrowBatch;default:return gE}}},u_=xE;Vr(u_,"ArrowBatch");function sV(e){switch(e.constructor){case Int8Array:return"int8";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int16Array:return"int16";case Uint16Array:return"uint16";case Int32Array:return"int32";case Uint32Array:return"uint32";case Float32Array:return"float32";case Float64Array:return"float64";default:return"null"}}function Bp(e){let t=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,s=-1/0,c=e.POSITION?e.POSITION.value:[],l=c&&c.length;for(let h=0;h<l;h+=3){let p=c[h],x=c[h+1],w=c[h+2];t=p<t?p:t,r=x<r?x:r,n=w<n?w:n,i=p>i?p:i,o=x>o?x:o,s=w>s?w:s}return[[t,r,n],[i,o,s]]}function bL(e,t,r){let n=sV(t.value),i=r||aV(t);return{name:e,type:{type:"fixed-size-list",listSize:t.size,children:[{name:"value",type:n}]},nullable:!1,metadata:i}}function aV(e){let t={};return"byteOffset"in e&&(t.byteOffset=e.byteOffset.toString(10)),"byteStride"in e&&(t.byteStride=e.byteStride.toString(10)),"normalized"in e&&(t.normalized=e.normalized.toString()),t}var vE=class extends Array{enqueue(t){return this.push(t)}dequeue(){return this.shift()}},h_=class{_values;_settlers;_closed;constructor(){this._values=new vE,this._settlers=new vE,this._closed=!1}close(){for(;this._settlers.length>0;)this._settlers.dequeue().resolve({done:!0});this._closed=!0}[Symbol.asyncIterator](){return this}enqueue(t){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");let r=this._settlers.dequeue();t instanceof Error?r.reject(t):r.resolve({value:t})}else this._values.enqueue(t)}next(){if(this._values.length>0){let t=this._values.dequeue();return t instanceof Error?Promise.reject(t):Promise.resolve({value:t})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0})}return new Promise((t,r)=>{this._settlers.enqueue({resolve:t,reject:r})})}};var cV="\uFEFF",Mf={parse:Nft,unparse:kft,RECORD_SEP:String.fromCharCode(30),UNIT_SEP:String.fromCharCode(31),BYTE_ORDER_MARK:cV,BAD_DELIMITERS:["\r",`
`,'"',cV],WORKERS_SUPPORTED:!1,NODE_STREAM_INPUT:1,LocalChunkSize:10485760,RemoteChunkSize:5242880,DefaultDelimiter:",",Parser:wL,ParserHandle:uV,ChunkStreamer:lV,StringStreamer:f_},p_=Mf;function Nft(e,t,r){t=t||{};var n=t.dynamicTyping||!1;if(ll(n)&&(t.dynamicTypingFunction=n,n={}),t.dynamicTyping=n,t.transform=ll(t.transform)?t.transform:!1,t.worker&&Mf.WORKERS_SUPPORTED){var i=newWorker();i.userStep=t.step,i.userChunk=t.chunk,i.userComplete=t.complete,i.userError=t.error,t.step=ll(t.step),t.chunk=ll(t.chunk),t.complete=ll(t.complete),t.error=ll(t.error),delete t.worker,i.postMessage({input:e,config:t,workerId:i.id});return}var o=null;return typeof e=="string"&&(o=new f_(t)),o||(o=new r(t)),o.stream(e)}function kft(e,t){var r=!1,n=!0,i=",",o=`\r
`,s='"',c=s+s,l=!1,h=null;x();var p=new RegExp(iv(s),"g");if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return E(null,e,l);if(typeof e[0]=="object")return E(h||w(e[0]),e,l)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:w(e.data[0])),!Array.isArray(e.data[0])&&typeof e.data[0]!="object"&&(e.data=[e.data])),E(e.fields||[],e.data||[],l);throw new Error("Unable to serialize unrecognized input");function x(){if(typeof t=="object"){if(typeof t.delimiter=="string"&&!Mf.BAD_DELIMITERS.filter(function(D){return t.delimiter.indexOf(D)!==-1}).length&&(i=t.delimiter),(typeof t.quotes=="boolean"||Array.isArray(t.quotes))&&(r=t.quotes),(typeof t.skipEmptyLines=="boolean"||typeof t.skipEmptyLines=="string")&&(l=t.skipEmptyLines),typeof t.newline=="string"&&(o=t.newline),typeof t.quoteChar=="string"&&(s=t.quoteChar),typeof t.header=="boolean"&&(n=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");h=t.columns}t.escapeChar!==void 0&&(c=t.escapeChar+s)}}function w(D){if(typeof D!="object")return[];var W=[];for(var X in D)W.push(X);return W}function E(D,W,X){var q="";typeof D=="string"&&(D=JSON.parse(D)),typeof W=="string"&&(W=JSON.parse(W));var $=Array.isArray(D)&&D.length>0,et=!Array.isArray(W[0]);if($&&n){for(var F=0;F<D.length;F++)F>0&&(q+=i),q+=P(D[F],F);W.length>0&&(q+=o)}for(var ut=0;ut<W.length;ut++){var ot=$?D.length:W[ut].length,J=!1,G=$?Object.keys(W[ut]).length===0:W[ut].length===0;if(X&&!$&&(J=X==="greedy"?W[ut].join("").trim()==="":W[ut].length===1&&W[ut][0].length===0),X==="greedy"&&$){for(var mt=[],Mt=0;Mt<ot;Mt++){var ct=et?D[Mt]:Mt;mt.push(W[ut][ct])}J=mt.join("").trim()===""}if(!J){for(var gt=0;gt<ot;gt++){gt>0&&!G&&(q+=i);var ee=$&&et?D[gt]:gt;q+=P(W[ut][ee],gt)}ut<W.length-1&&(!X||ot>0&&!G)&&(q+=o)}}return q}function P(D,W){if(typeof D>"u"||D===null)return"";if(D.constructor===Date)return JSON.stringify(D).slice(1,25);D=D.toString().replace(p,c);var X=typeof r=="boolean"&&r||Array.isArray(r)&&r[W]||B(D,Mf.BAD_DELIMITERS)||D.indexOf(i)>-1||D.charAt(0)===" "||D.charAt(D.length-1)===" ";return X?s+D+s:D}function B(D,W){for(var X=0;X<W.length;X++)if(D.indexOf(W[X])>-1)return!0;return!1}}function lV(e){this._handle=null,this._finished=!1,this._completed=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},t.call(this,e),this.parseChunk=function(r,n){if(this.isFirstChunk&&ll(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(r);i!==void 0&&(r=i)}this.isFirstChunk=!1;var o=this._partialLine+r;this._partialLine="";var s=this._handle.parse(o,this._baseIndex,!this._finished);if(!(this._handle.paused()||this._handle.aborted())){var c=s.meta.cursor;this._finished||(this._partialLine=o.substring(c-this._baseIndex),this._baseIndex=c),s&&s.data&&(this._rowCount+=s.data.length);var l=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(ll(this._config.chunk)&&!n){if(this._config.chunk(s,this._handle),this._handle.paused()||this._handle.aborted())return;s=void 0,this._completeResults=void 0}return!this._config.step&&!this._config.chunk&&(this._completeResults.data=this._completeResults.data.concat(s.data),this._completeResults.errors=this._completeResults.errors.concat(s.errors),this._completeResults.meta=s.meta),!this._completed&&l&&ll(this._config.complete)&&(!s||!s.meta.aborted)&&(this._config.complete(this._completeResults,this._input),this._completed=!0),!l&&(!s||!s.meta.paused)&&this._nextChunk(),s}},this._sendError=function(r){ll(this._config.error)&&this._config.error(r)};function t(r){var n=TL(r);n.chunkSize=parseInt(n.chunkSize),!r.step&&!r.chunk&&(n.chunkSize=null),this._handle=new uV(n),this._handle.streamer=this,this._config=n}}function f_(e){e=e||{},lV.call(this,e);var t;this.stream=function(r){return t=r,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var r=this._config.chunkSize,n=r?t.substr(0,r):t;return t=r?t.substr(r):"",this._finished=!t,this.parseChunk(n)}}}f_.prototype=Object.create(f_.prototype);f_.prototype.constructor=f_;function uV(e){var t=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,r=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,n=this,i=0,o=0,s,c,l=!1,h=!1,p,x=[],w={data:[],errors:[],meta:{}};if(ll(e.step)){var E=e.step;e.step=function(ot){if(w=ot,D())B();else{if(B(),!w.data||w.data.length===0)return;i+=ot.data.length,e.preview&&i>e.preview?c.abort():E(w,n)}}}this.parse=function(ot,J,G){var mt=e.quoteChar||'"';if(e.newline||(e.newline=F(ot,mt)),p=!1,e.delimiter)ll(e.delimiter)&&(e.delimiter=e.delimiter(ot),w.meta.delimiter=e.delimiter);else{var Mt=et(ot,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);Mt.successful?e.delimiter=Mt.bestDelimiter:(p=!0,e.delimiter=Mf.DefaultDelimiter),w.meta.delimiter=e.delimiter}var ct=TL(e);return e.preview&&e.header&&ct.preview++,s=ot,c=new wL(ct),w=c.parse(s,J,G),B(),l?{meta:{paused:!0}}:w||{meta:{paused:!1}}},this.paused=function(){return l},this.pause=function(){l=!0,c.abort(),s=s.substr(c.getCharIndex())},this.resume=function(){l=!1,n.streamer.parseChunk(s,!0)},this.aborted=function(){return h},this.abort=function(){h=!0,c.abort(),w.meta.aborted=!0,ll(e.complete)&&e.complete(w),s=""};function P(ot){return e.skipEmptyLines==="greedy"?ot.join("").trim()==="":ot.length===1&&ot[0].length===0}function B(){if(w&&p&&(ut("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+Mf.DefaultDelimiter+"'"),p=!1),e.skipEmptyLines)for(var ot=0;ot<w.data.length;ot++)P(w.data[ot])&&w.data.splice(ot--,1);return D()&&W(),$()}function D(){return e.header&&x.length===0}function W(){if(!w)return;function ot(G){ll(e.transformHeader)&&(G=e.transformHeader(G)),x.push(G)}if(Array.isArray(w.data[0])){for(var J=0;D()&&J<w.data.length;J++)w.data[J].forEach(ot);w.data.splice(0,1)}else w.data.forEach(ot)}function X(ot){return e.dynamicTypingFunction&&e.dynamicTyping[ot]===void 0&&(e.dynamicTyping[ot]=e.dynamicTypingFunction(ot)),(e.dynamicTyping[ot]||e.dynamicTyping)===!0}function q(ot,J){return X(ot)?J==="true"||J==="TRUE"?!0:J==="false"||J==="FALSE"?!1:t.test(J)?parseFloat(J):r.test(J)?new Date(J):J===""?null:J:J}function $(){if(!w||!w.data||!e.header&&!e.dynamicTyping&&!e.transform)return w;function ot(G,mt){var Mt=e.header?{}:[],ct;for(ct=0;ct<G.length;ct++){var gt=ct,ee=G[ct];e.header&&(gt=ct>=x.length?"__parsed_extra":x[ct]),e.transform&&(ee=e.transform(ee,gt)),ee=q(gt,ee),gt==="__parsed_extra"?(Mt[gt]=Mt[gt]||[],Mt[gt].push(ee)):Mt[gt]=ee}return e.header&&(ct>x.length?ut("FieldMismatch","TooManyFields","Too many fields: expected "+x.length+" fields but parsed "+ct,o+mt):ct<x.length&&ut("FieldMismatch","TooFewFields","Too few fields: expected "+x.length+" fields but parsed "+ct,o+mt)),Mt}var J=1;return!w.data[0]||Array.isArray(w.data[0])?(w.data=w.data.map(ot),J=w.data.length):w.data=ot(w.data,0),e.header&&w.meta&&(w.meta.fields=x),o+=J,w}function et(ot,J,G,mt,Mt){var ct,gt,ee;Mt=Mt||[",","	","|",";",Mf.RECORD_SEP,Mf.UNIT_SEP];for(var Ne=0;Ne<Mt.length;Ne++){var Ue=Mt[Ne],sr=0,gr=0,Xr=0;ee=void 0;for(var ir=new wL({comments:mt,delimiter:Ue,newline:J,preview:10}).parse(ot),on=0;on<ir.data.length;on++){if(G&&P(ir.data[on])){Xr++;continue}var Xe=ir.data[on].length;if(gr+=Xe,typeof ee>"u"){ee=0;continue}else Xe>1&&(sr+=Math.abs(Xe-ee),ee=Xe)}ir.data.length>0&&(gr/=ir.data.length-Xr),(typeof gt>"u"||sr>gt)&&gr>1.99&&(gt=sr,ct=Ue)}return e.delimiter=ct,{successful:!!ct,bestDelimiter:ct}}function F(ot,J){ot=ot.substr(0,1024*1024);var G=new RegExp(iv(J)+"([^]*?)"+iv(J),"gm");ot=ot.replace(G,"");var mt=ot.split("\r"),Mt=ot.split(`
`),ct=Mt.length>1&&Mt[0].length<mt[0].length;if(mt.length===1||ct)return`
`;for(var gt=0,ee=0;ee<mt.length;ee++)mt[ee][0]===`
`&&gt++;return gt>=mt.length/2?`\r
`:"\r"}function ut(ot,J,G,mt){w.errors.push({type:ot,code:J,message:G,row:mt})}}function iv(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function wL(e){e=e||{};var t=e.delimiter,r=e.newline,n=e.comments,i=e.step,o=e.preview,s=e.fastMode,c;e.quoteChar===void 0?c='"':c=e.quoteChar;var l=c;if(e.escapeChar!==void 0&&(l=e.escapeChar),(typeof t!="string"||Mf.BAD_DELIMITERS.indexOf(t)>-1)&&(t=","),n===t)throw new Error("Comment character same as delimiter");n===!0?n="#":(typeof n!="string"||Mf.BAD_DELIMITERS.indexOf(n)>-1)&&(n=!1),r!==`
`&&r!=="\r"&&r!==`\r
`&&(r=`
`);var h=0,p=!1;this.parse=function(x,w,E){if(typeof x!="string")throw new Error("Input must be a string");var P=x.length,B=t.length,D=r.length,W=n.length,X=ll(i);h=0;var q=[],$=[],et=[],F=0;if(!x)return ir();if(s||s!==!1&&x.indexOf(c)===-1){for(var ut=x.split(r),ot=0;ot<ut.length;ot++){if(et=ut[ot],h+=et.length,ot!==ut.length-1)h+=r.length;else if(E)return ir();if(!(n&&et.substr(0,W)===n)){if(X){if(q=[],Ue(et.split(t)),on(),p)return ir()}else Ue(et.split(t));if(o&&ot>=o)return q=q.slice(0,o),ir(!0)}}return ir()}for(var J=x.indexOf(t,h),G=x.indexOf(r,h),mt=new RegExp(iv(l)+iv(c),"g"),Mt;;){if(x[h]===c){for(Mt=h,h++;;){if(Mt=x.indexOf(c,Mt+1),Mt===-1)return E||$.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:q.length,index:h}),gr();if(Mt===P-1){var ct=x.substring(h,Mt).replace(mt,c);return gr(ct)}if(c===l&&x[Mt+1]===l){Mt++;continue}if(!(c!==l&&Mt!==0&&x[Mt-1]===l)){var gt=G===-1?J:Math.min(J,G),ee=sr(gt);if(x[Mt+1+ee]===t){if(et.push(x.substring(h,Mt).replace(mt,c)),h=Mt+1+ee+B,J=x.indexOf(t,h),G=x.indexOf(r,h),X&&(on(),p))return ir();if(o&&q.length>=o)return ir(!0);break}var Ne=sr(G);if(x.substr(Mt+1+Ne,D)===r){if(et.push(x.substring(h,Mt).replace(mt,c)),Xr(Mt+1+Ne+D),J=x.indexOf(t,h),X&&(on(),p))return ir();if(o&&q.length>=o)return ir(!0);break}$.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:q.length,index:h}),Mt++}}if(X&&(on(),p))return ir();if(o&&q.length>=o)return ir(!0);continue}if(n&&et.length===0&&x.substr(h,W)===n){if(G===-1)return ir();h=G+D,G=x.indexOf(r,h),J=x.indexOf(t,h);continue}if(J!==-1&&(J<G||G===-1)){et.push(x.substring(h,J)),h=J+B,J=x.indexOf(t,h);continue}if(G!==-1){if(et.push(x.substring(h,G)),Xr(G+D),X&&(on(),p))return ir();if(o&&q.length>=o)return ir(!0);continue}break}return gr();function Ue(Xe){q.push(Xe),F=h}function sr(Xe){var He=0;if(Xe!==-1){var _n=x.substring(Mt+1,Xe);_n&&_n.trim()===""&&(He=_n.length)}return He}function gr(Xe){return E||(typeof Xe>"u"&&(Xe=x.substr(h)),et.push(Xe),h=P,Ue(et),X&&on()),ir()}function Xr(Xe){h=Xe,Ue(et),et=[],G=x.indexOf(r,h)}function ir(Xe,He){var _n=He||!1;return{data:_n?q[0]:q,errors:$,meta:{delimiter:t,linebreak:r,aborted:p,truncated:!!Xe,cursor:F+(w||0)}}}function on(){i(ir(void 0,!0)),q=[],$=[]}},this.abort=function(){p=!0},this.getCharIndex=function(){return h}}function TL(e){if(typeof e!="object"||e===null)return e;var t=Array.isArray(e)?[]:{};for(var r in e)t[r]=TL(e[r]);return t}function ll(e){return typeof e=="function"}var{ChunkStreamer:hV}=p_;function d_(e){e=e||{},hV.call(this,e),this.textDecoder=new TextDecoder(this._config.encoding),this.stream=async function(t){this._input=t;try{for await(let r of t)this.parseChunk(this.getStringChunk(r));this._finished=!0,this.parseChunk("")}catch(r){this._sendError(r)}},this._nextChunk=function(){},this.getStringChunk=function(t){return typeof t=="string"?t:this.textDecoder.decode(t,{stream:!0})}}d_.prototype=Object.create(hV.prototype);d_.prototype.constructor=d_;var Fft="4.2.1",EL="object-row-table",ov={dataType:null,batchType:null,id:"csv",module:"csv",name:"CSV",version:Fft,extensions:["csv","tsv","dsv"],mimeTypes:["text/csv","text/tab-separated-values","text/dsv"],category:"table",parse:async(e,t)=>fV(new TextDecoder().decode(e),t),parseText:(e,t)=>fV(e,t),parseInBatches:zft,options:{csv:{shape:EL,optimizeMemoryUsage:!1,header:"auto",columnPrefix:"column",quoteChar:'"',escapeChar:'"',dynamicTyping:!0,comments:!1,skipEmptyLines:!0,delimitersToGuess:[",","	","|",";"]}}};async function fV(e,t){let r={...ov.options.csv,...t?.csv},n=Uft(e),o=r.header==="auto"?pV(n):Boolean(r.header),s={...r,header:o,download:!1,transformHeader:o?dV():void 0,error:x=>{throw new Error(x)}},c=p_.parse(e,s),l=c.data,h=c.meta.fields||mV(r.columnPrefix,n.length),p=r.shape||EL;switch(p){case"object-row-table":return{shape:"object-row-table",data:l.map(x=>Array.isArray(x)?rv(x,h):x)};case"array-row-table":return{shape:"array-row-table",data:l.map(x=>Array.isArray(x)?x:nv(x,h))};default:throw new Error(p)}}function zft(e,t){t={...t},t.batchSize==="auto"&&(t.batchSize=4e3);let r={...ov.options.csv,...t?.csv},n=new h_,i=!0,o=null,s=null,c=null,l={...r,header:!1,download:!1,chunkSize:1024*1024*5,skipEmptyLines:!1,step(h){let p=h.data;if(r.skipEmptyLines&&p.flat().join("").trim()==="")return;let x=h.meta.cursor;if(i&&!o&&(r.header==="auto"?pV(p):Boolean(r.header))){o=p.map(dV());return}i&&(i=!1,o||(o=mV(r.columnPrefix,p.length)),c=Vft(p,o)),r.optimizeMemoryUsage&&(p=JSON.parse(JSON.stringify(p)));let w=r.shape||EL;s=s||new u_(c,{shape:w,...t});try{s.addRow(p);let E=s&&s.getFullBatch({bytesUsed:x});E&&n.enqueue(E)}catch(E){n.enqueue(E)}},complete(h){try{let p=h.meta.cursor,x=s&&s.getFinalBatch({bytesUsed:p});x&&n.enqueue(x)}catch(p){n.enqueue(p)}n.close()}};return p_.parse(e,l,d_),n}function pV(e){return e&&e.every(t=>typeof t=="string")}function Uft(e){return p_.parse(e,{download:!1,dynamicTyping:!0,preview:1}).data[0]}function dV(){let e=new Set;return t=>{let r=t,n=1;for(;e.has(r);)r=`${t}.${n}`,n++;return e.add(r),r}}function mV(e,t=0){let r=[];for(let n=0;n<t;n++)r.push(`${e}${n+1}`);return r}function Vft(e,t){let r=t?{}:[];for(let n=0;n<e.length;n++){let i=t&&t[n]||n;switch(typeof e[n]){case"number":case"boolean":r[i]={name:String(i),index:n,type:Float32Array};break;case"string":default:r[i]={name:String(i),index:n,type:Array}}}return r}async function iu(e,t,r,n){return n._parse(e,t,r,n)}function Ti(e,t){if(!e)throw new Error(t||"loader assertion failed.")}var Sf={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},jft=Sf.self||Sf.window||Sf.global||{},Hft=Sf.window||Sf.self||Sf.global||{},Wft=Sf.global||Sf.self||Sf.window||{},qft=Sf.document||{};var Dp=Boolean(typeof process!="object"||String(process)!=="[object process]"||process.browser);var AV=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),Gft=AV&&parseFloat(AV[1])||0;var bE=globalThis,Xft=globalThis.document||{},wE=globalThis.process||{},Yft=globalThis.console,gV=globalThis.navigator||{};function TE(e){if(typeof window<"u"&&window.process?.type==="renderer"||typeof process<"u"&&Boolean(process.versions?.electron))return!0;let t=typeof navigator<"u"&&navigator.userAgent,r=e||t;return Boolean(r&&r.indexOf("Electron")>=0)}function ul(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process?.browser)||TE()}function ML(e){return!e&&!ul()?"Node":TE(e)?"Electron":(e||gV.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown"}var SL="4.1.0";function Zft(e){try{let t=window[e],r="__storage_test__";return t.setItem(r,r),t.removeItem(r),t}catch{return null}}var EE=class{constructor(t,r,n="sessionStorage"){this.storage=Zft(n),this.id=t,this.config=r,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){let r=JSON.stringify(this.config);this.storage.setItem(this.id,r)}}_loadConfiguration(){let t={};if(this.storage){let r=this.storage.getItem(this.id);t=r?JSON.parse(r):{}}return Object.assign(this.config,t),this}};function _V(e){let t;return e<10?t=`${e.toFixed(2)}ms`:e<100?t=`${e.toFixed(1)}ms`:e<1e3?t=`${e.toFixed(0)}ms`:t=`${(e/1e3).toFixed(2)}s`,t}function yV(e,t=8){let r=Math.max(t-e.length,0);return`${" ".repeat(r)}${e}`}var ME;(function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(ME||(ME={}));var $ft=10;function xV(e){return typeof e!="string"?e:(e=e.toUpperCase(),ME[e]||ME.WHITE)}function vV(e,t,r){return!ul&&typeof e=="string"&&(t&&(e=`\x1B[${xV(t)}m${e}\x1B[39m`),r&&(e=`\x1B[${xV(r)+$ft}m${e}\x1B[49m`)),e}function bV(e,t=["constructor"]){let r=Object.getPrototypeOf(e),n=Object.getOwnPropertyNames(r),i=e;for(let o of n){let s=i[o];typeof s=="function"&&(t.find(c=>o===c)||(i[o]=s.bind(e)))}}function sv(e,t){if(!e)throw new Error(t||"Assertion failed")}function kA(){let e;if(ul()&&bE.performance)e=bE?.performance?.now?.();else if("hrtime"in wE){let t=wE?.hrtime?.();e=t[0]*1e3+t[1]/1e6}else e=Date.now();return e}var m_={debug:ul()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Qft={enabled:!0,level:0};function A_(){}var wV={},TV={once:!0},Bl=class{constructor({id:t}={id:""}){this.VERSION=SL,this._startTs=kA(),this._deltaTs=kA(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=t,this.userData={},this._storage=new EE(`__probe-${this.id}__`,Qft),this.timeStamp(`${this.id} started`),bV(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((kA()-this._startTs).toPrecision(10))}getDelta(){return Number((kA()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.setConfiguration({enabled:t}),this}setLevel(t){return this._storage.setConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,r){this._storage.setConfiguration({[t]:r})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,r){if(!t)throw new Error(r||"Assertion failed")}warn(t){return this._getLogFunction(0,t,m_.warn,arguments,TV)}error(t){return this._getLogFunction(0,t,m_.error,arguments)}deprecated(t,r){return this.warn(`\`${t}\` is deprecated and will be removed in a later version. Use \`${r}\` instead`)}removed(t,r){return this.error(`\`${t}\` has been removed. Use \`${r}\` instead`)}probe(t,r){return this._getLogFunction(t,r,m_.log,arguments,{time:!0,once:!0})}log(t,r){return this._getLogFunction(t,r,m_.debug,arguments)}info(t,r){return this._getLogFunction(t,r,console.info,arguments)}once(t,r){return this._getLogFunction(t,r,m_.debug||m_.info,arguments,TV)}table(t,r,n){return r?this._getLogFunction(t,r,console.table||A_,n&&[n],{tag:tpt(r)}):A_}time(t,r){return this._getLogFunction(t,r,console.time?console.time:console.info)}timeEnd(t,r){return this._getLogFunction(t,r,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,r){return this._getLogFunction(t,r,console.timeStamp||A_)}group(t,r,n={collapsed:!1}){let i=EV({logLevel:t,message:r,opts:n}),{collapsed:o}=n;return i.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(t,r,n={}){return this.group(t,r,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||A_)}withGroup(t,r,n){this.group(t,r)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=MV(t)}_getLogFunction(t,r,n,i,o){if(this._shouldLog(t)){o=EV({logLevel:t,message:r,args:i,opts:o}),n=n||o.method,sv(n),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=kA();let s=o.tag||o.message;if(o.once&&s)if(!wV[s])wV[s]=kA();else return A_;return r=Jft(this.id,o.message,o),n.bind(console,r,...o.args)}return A_}};Bl.VERSION=SL;function MV(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return sv(Number.isFinite(t)&&t>=0),t}function EV(e){let{logLevel:t,message:r}=e;e.logLevel=MV(t);let n=e.args?Array.from(e.args):[];for(;n.length&&n.shift()!==r;);switch(typeof t){case"string":case"function":r!==void 0&&n.unshift(r),e.message=t;break;case"object":Object.assign(e,t);break;default:}typeof e.message=="function"&&(e.message=e.message());let i=typeof e.message;return sv(i==="string"||i==="object"),Object.assign(e,{args:n},e.opts)}function Jft(e,t,r){if(typeof t=="string"){let n=r.time?yV(_V(r.total)):"";t=r.time?`${e}: ${n}  ${t}`:`${e}: ${t}`,t=vV(t,r.color,r.background)}return t}function tpt(e){for(let t in e)for(let r in e[t])return r||"untitled";return"empty"}globalThis.probe={};var CL=new Bl({id:"@probe.gl/log"});function av(e,t){return SV(e||{},t)}function SV(e,t,r=0){if(r>3)return t;let n={...e};for(let[i,o]of Object.entries(t))o&&typeof o=="object"&&!Array.isArray(o)?n[i]=SV(n[i]||{},t[i],r+1):n[i]=t[i];return n}function PL(e){globalThis.loaders||={},globalThis.loaders.modules||={},Object.assign(globalThis.loaders.modules,e)}function IL(e){return globalThis.loaders?.modules?.[e]||null}var CV="latest";function ept(){return globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.2.1"),globalThis._loadersgl_.version}var cv=ept();function wc(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}var Cf={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},_Ut=Cf.self||Cf.window||Cf.global||{},yUt=Cf.window||Cf.self||Cf.global||{},xUt=Cf.global||Cf.self||Cf.window||{},vUt=Cf.document||{};var ec=typeof process!="object"||String(process)!=="[object process]"||process.browser,lv=typeof importScripts=="function",IV=typeof window<"u"&&typeof window.orientation<"u",PV=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),bUt=PV&&parseFloat(PV[1])||0;var uv=class{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(t,r){this.name=t,this.workerThread=r,this.result=new Promise((n,i)=>{this._resolve=n,this._reject=i})}postMessage(t,r){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:r})}done(t){wc(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){wc(this.isRunning),this.isRunning=!1,this._reject(t)}};var g_=class{terminate(){}};var RL=new Map;function RV(e){wc(e.source&&!e.url||!e.source&&e.url);let t=RL.get(e.source||e.url);return t||(e.url&&(t=rpt(e.url),RL.set(e.url,t)),e.source&&(t=LV(e.source),RL.set(e.source,t))),wc(t),t}function rpt(e){if(!e.startsWith("http"))return e;let t=npt(e);return LV(t)}function LV(e){let t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function npt(e){return`try {
  importScripts('${e}');
} catch (error) {
  console.error(error);
  throw error;
}`}function LL(e,t=!0,r){let n=r||new Set;if(e){if(OV(e))n.add(e);else if(OV(e.buffer))n.add(e.buffer);else if(!ArrayBuffer.isView(e)){if(t&&typeof e=="object")for(let i in e)LL(e[i],t,n)}}return r===void 0?Array.from(n):[]}function OV(e){return e?e instanceof ArrayBuffer||typeof MessagePort<"u"&&e instanceof MessagePort||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas:!1}var OL=()=>{},Yd=class{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return typeof Worker<"u"&&ec||typeof g_<"u"&&!ec}constructor(t){let{name:r,source:n,url:i}=t;wc(n||i),this.name=r,this.source=n,this.url=i,this.onMessage=OL,this.onError=o=>console.log(o),this.worker=ec?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=OL,this.onError=OL,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(t,r){r=r||LL(t),this.worker.postMessage(t,r)}_getErrorFromErrorEvent(t){let r="Failed to load ";return r+=`worker ${this.name} from ${this.url}. `,t.message&&(r+=`${t.message} in `),t.lineno&&(r+=`:${t.lineno}:${t.colno}`),new Error(r)}_createBrowserWorker(){this._loadableURL=RV({source:this.source,url:this.url});let t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=r=>{r.data?this.onMessage(r.data):this.onError(new Error("No data received"))},t.onerror=r=>{this.onError(this._getErrorFromErrorEvent(r)),this.terminated=!0},t.onmessageerror=r=>console.error(r),t}_createNodeWorker(){let t;if(this.url){let n=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;t=new g_(n,{eval:!1})}else if(this.source)t=new g_(this.source,{eval:!0});else throw new Error("no worker");return t.on("message",r=>{this.onMessage(r)}),t.on("error",r=>{this.onError(r)}),t.on("exit",r=>{}),t}};var hv=class{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return Yd.isSupported()}constructor(t){this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach(t=>t.destroy()),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},t.name!==void 0&&(this.name=t.name),t.maxConcurrency!==void 0&&(this.maxConcurrency=t.maxConcurrency),t.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=t.maxMobileConcurrency),t.reuseWorkers!==void 0&&(this.reuseWorkers=t.reuseWorkers),t.onDebug!==void 0&&(this.onDebug=t.onDebug)}async startJob(t,r=(i,o,s)=>i.done(s),n=(i,o)=>i.error(o)){let i=new Promise(o=>(this.jobQueue.push({name:t,onMessage:r,onError:n,onStart:o}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;let t=this._getAvailableWorker();if(!t)return;let r=this.jobQueue.shift();if(r){this.onDebug({message:"Starting job",name:r.name,workerThread:t,backlog:this.jobQueue.length});let n=new uv(r.name,t);t.onMessage=i=>r.onMessage(n,i.type,i.payload),t.onError=i=>r.onError(n,i),r.onStart(n);try{await n.result}catch(i){console.error(`Worker exception: ${i}`)}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){!ec||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;let t=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new Yd({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return IV?this.maxMobileConcurrency:this.maxConcurrency}};var ipt={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}},FA=class{props;workerPools=new Map;static isSupported(){return Yd.isSupported()}static getWorkerFarm(t={}){return FA._workerFarm=FA._workerFarm||new FA({}),FA._workerFarm.setProps(t),FA._workerFarm}constructor(t){this.props={...ipt},this.setProps(t),this.workerPools=new Map}destroy(){for(let t of this.workerPools.values())t.destroy();this.workerPools=new Map}setProps(t){this.props={...this.props,...t};for(let r of this.workerPools.values())r.setProps(this._getWorkerPoolProps())}getWorkerPool(t){let{name:r,source:n,url:i}=t,o=this.workerPools.get(r);return o||(o=new hv({name:r,source:n,url:i}),o.setProps(this._getWorkerPoolProps()),this.workerPools.set(r,o)),o}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}},Kd=FA;Vr(Kd,"_workerFarm");function BL(e,t={}){let r=t[e.id]||{},n=ec?`${e.id}-worker.js`:`${e.id}-worker-node.js`,i=r.workerUrl;if(!i&&e.id==="compression"&&(i=t.workerUrl),t._workerType==="test"&&(ec?i=`modules/${e.module}/dist/${n}`:i=`modules/${e.module}/src/workers/${e.id}-worker-node.ts`),!i){let o=e.version;o==="latest"&&(o=CV);let s=o?`@${o}`:"";i=`https://unpkg.com/@loaders.gl/${e.module}${s}/dist/${n}`}return wc(i),i}function DL(e,t=cv){wc(e,"no worker provided");let r=e.version;return!(!t||!r)}var NL={};async function Pf(e,t=null,r={},n=null){return t&&(e=BV(e,t,r,n)),NL[e]=NL[e]||opt(e),await NL[e]}function BV(e,t,r={},n=null){if(!r.useLocalLibraries&&e.startsWith("http"))return e;n=n||e;let i=r.modules||{};return i[n]?i[n]:ec?r.CDN?(wc(r.CDN.startsWith("http")),`${r.CDN}/${t}@${cv}/dist/libs/${n}`):lv?`../src/libs/${n}`:`modules/${t}/src/libs/${n}`:`modules/${t}/dist/libs/${n}`}async function opt(e){if(e.endsWith("wasm"))return await apt(e);if(!ec)try{let{requireFromFile:r}=globalThis.loaders||{};return await r?.(e)}catch(r){return console.error(r),null}if(lv)return importScripts(e);let t=await cpt(e);return spt(t,e)}function spt(e,t){if(!ec){let{requireFromString:n}=globalThis.loaders||{};return n?.(e,t)}if(lv)return eval.call(globalThis,e),null;let r=document.createElement("script");r.id=t;try{r.appendChild(document.createTextNode(e))}catch{r.text=e}return document.body.appendChild(r),null}async function apt(e){let{readFileAsArrayBuffer:t}=globalThis.loaders||{};return ec||!t||e.startsWith("http")?await(await fetch(e)).arrayBuffer():await t(e)}async function cpt(e){let{readFileAsText:t}=globalThis.loaders||{};return ec||!t||e.startsWith("http")?await(await fetch(e)).text():await t(e)}function kL(e,t){return!Kd.isSupported()||!ec&&!t?._nodeWorkers?!1:e.worker&&t?.worker}async function FL(e,t,r,n,i){let o=e.id,s=BL(e,r),l=Kd.getWorkerFarm(r).getWorkerPool({name:o,url:s});r=JSON.parse(JSON.stringify(r)),n=JSON.parse(JSON.stringify(n||{}));let h=await l.startJob("process-on-worker",lpt.bind(null,i));return h.postMessage("process",{input:t,options:r,context:n}),await(await h.result).result}async function lpt(e,t,r,n){switch(r){case"done":t.done(n);break;case"error":t.error(new Error(n.error));break;case"process":let{id:i,input:o,options:s}=n;try{let c=await e(o,s);t.postMessage("done",{id:i,result:c})}catch(c){let l=c instanceof Error?c.message:"unknown error";t.postMessage("error",{id:i,error:l})}break;default:console.warn(`parse-with-worker unknown message ${r}`)}}function NV(e,t=5){return typeof e=="string"?e.slice(0,t):ArrayBuffer.isView(e)?DV(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?DV(e,0,t):""}function DV(e,t,r){if(e.byteLength<=t+r)return"";let n=new DataView(e),i="";for(let o=0;o<r;o++)i+=String.fromCharCode(n.getUint8(t+o));return i}function zL(e){try{return JSON.parse(e)}catch{throw new Error(`Failed to parse JSON from data starting with "${NV(e)}"`)}}function UL(e,t,r){if(r=r||e.byteLength,e.byteLength<r||t.byteLength<r)return!1;let n=new Uint8Array(e),i=new Uint8Array(t);for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}function VL(...e){return kV(e)}function kV(e){let t=e.map(o=>o instanceof ArrayBuffer?new Uint8Array(o):o),r=t.reduce((o,s)=>o+s.byteLength,0),n=new Uint8Array(r),i=0;for(let o of t)n.set(o,i),i+=o.byteLength;return n.buffer}function fv(...e){let t=e,r=t&&t.length>1&&t[0].constructor||null;if(!r)throw new Error('"concatenateTypedArrays" - incorrect quantity of arguments or arguments have incompatible data types');let n=t.reduce((s,c)=>s+c.length,0),i=new r(n),o=0;for(let s of t)i.set(s,o),o+=s.length;return i}function zA(e,t,r){let n=r!==void 0?new Uint8Array(e).subarray(t,t+r):new Uint8Array(e).subarray(t);return new Uint8Array(n).buffer}function Zd(e,t){return Ti(e>=0),Ti(t>0),e+(t-1)&~(t-1)}function jL(e,t,r){let n;if(e instanceof ArrayBuffer)n=new Uint8Array(e);else{let i=e.byteOffset,o=e.byteLength;n=new Uint8Array(e.buffer||e.arrayBuffer,i,o)}return t.set(n,r),r+Zd(n.byteLength,4)}async function HL(e){let t=[];for await(let r of e)t.push(r);return VL(...t)}function pv(){let e;if(typeof window<"u"&&window.performance)e=window.performance.now();else if(typeof process<"u"&&process.hrtime){let t=process.hrtime();e=t[0]*1e3+t[1]/1e6}else e=Date.now();return e}var UA=class{constructor(t,r){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=t,this.type=r,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=pv(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(pv()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}};var Nc=class{constructor(t){this.stats={},this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t,r="count"){return this._getOrCreate({name:t,type:r})}get size(){return Object.keys(this.stats).length}reset(){for(let t of Object.values(this.stats))t.reset();return this}forEach(t){for(let r of Object.values(this.stats))t(r)}getTable(){let t={};return this.forEach(r=>{t[r.name]={time:r.time||0,count:r.count||0,average:r.getAverageTime()||0,hz:r.getHz()||0}}),t}_initializeStats(t=[]){t.forEach(r=>this._getOrCreate(r))}_getOrCreate(t){let{name:r,type:n}=t,i=this.stats[r];return i||(t instanceof UA?i=t:i=new UA(r,n),this.stats[r]=i),i}};var upt="Queued Requests",hpt="Active Requests",fpt="Cancelled Requests",ppt="Queued Requests Ever",dpt="Active Requests Ever",mpt={id:"request-scheduler",throttleRequests:!0,maxRequests:6,debounceTime:0},$d=class{props;stats;activeRequestCount=0;requestQueue=[];requestMap=new Map;updateTimer=null;constructor(t={}){this.props={...mpt,...t},this.stats=new Nc({id:this.props.id}),this.stats.get(upt),this.stats.get(hpt),this.stats.get(fpt),this.stats.get(ppt),this.stats.get(dpt)}scheduleRequest(t,r=()=>0){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(t))return this.requestMap.get(t);let n={handle:t,priority:0,getPriority:r},i=new Promise(o=>(n.resolve=o,n));return this.requestQueue.push(n),this.requestMap.set(t,i),this._issueNewRequests(),i}_issueRequest(t){let{handle:r,resolve:n}=t,i=!1,o=()=>{i||(i=!0,this.requestMap.delete(r),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:o}):Promise.resolve({done:o})}_issueNewRequests(){this.updateTimer!==null&&clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>this._issueNewRequestsAsync(),this.props.debounceTime)}_issueNewRequestsAsync(){this.updateTimer!==null&&clearTimeout(this.updateTimer),this.updateTimer=null;let t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(t!==0){this._updateAllRequests();for(let r=0;r<t;++r){let n=this.requestQueue.shift();n&&this._issueRequest(n)}}}_updateAllRequests(){let t=this.requestQueue;for(let r=0;r<t.length;++r){let n=t[r];this._updateRequest(n)||(t.splice(r,1),this.requestMap.delete(n.handle),r--)}t.sort((r,n)=>r.priority-n.priority)}_updateRequest(t){return t.priority=t.getPriority(t.handle),t.priority<0?(t.resolve(null),!1):!0}};var Apt="",FV={};function WL(e){for(let t in FV)if(e.startsWith(t)){let r=FV[t];e=e.replace(t,r)}return!e.startsWith("http://")&&!e.startsWith("https://")&&(e=`${Apt}${e}`),e}function zV(e){return e&&typeof e=="object"&&e.isBuffer}function SE(e){if(zV(e))return e;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if(typeof e=="string"){let t=e;return new TextEncoder().encode(t).buffer}if(e&&typeof e=="object"&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}var ou={};Lo(ou,{dirname:()=>_pt,filename:()=>gpt,join:()=>ypt,resolve:()=>xpt});function UV(){if(typeof process<"u"&&typeof process.cwd<"u")return process.cwd();let e=window.location?.pathname;return e?.slice(0,e.lastIndexOf("/")+1)||""}function gpt(e){let t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}function _pt(e){let t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}function ypt(...e){let t="/";return e=e.map((r,n)=>(n&&(r=r.replace(new RegExp(`^${t}`),"")),n!==e.length-1&&(r=r.replace(new RegExp(`${t}$`),"")),r)),e.join(t)}function xpt(...e){let t=[];for(let o=0;o<e.length;o++)t[o]=e[o];let r="",n=!1,i;for(let o=t.length-1;o>=-1&&!n;o--){let s;o>=0?s=t[o]:(i===void 0&&(i=UV()),s=i),s.length!==0&&(r=`${s}/${r}`,n=s.charCodeAt(0)===dv)}return r=vpt(r,!n),n?`/${r}`:r.length>0?r:"."}var dv=47,qL=46;function vpt(e,t){let r="",n=-1,i=0,o,s=!1;for(let c=0;c<=e.length;++c){if(c<e.length)o=e.charCodeAt(c);else{if(o===dv)break;o=dv}if(o===dv){if(!(n===c-1||i===1))if(n!==c-1&&i===2){if(r.length<2||!s||r.charCodeAt(r.length-1)!==qL||r.charCodeAt(r.length-2)!==qL){if(r.length>2){let l=r.length-1,h=l;for(;h>=0&&r.charCodeAt(h)!==dv;--h);if(h!==l){r=h===-1?"":r.slice(0,h),n=c,i=0,s=!1;continue}}else if(r.length===2||r.length===1){r="",n=c,i=0,s=!1;continue}}t&&(r.length>0?r+="/..":r="..",s=!0)}else{let l=e.slice(n+1,c);r.length>0?r+=`/${l}`:r=l,s=!1}n=c,i=0}else o===qL&&i!==-1?++i:i=-1}return r}var CE=class{fetch;loadOptions;_needsRefresh=!0;props;constructor(t){this.props={...t},this.loadOptions={...t.loadOptions},this.fetch=bpt(this.loadOptions)}setProps(t){this.props=Object.assign(this.props,t),this.setNeedsRefresh()}setNeedsRefresh(){this._needsRefresh=!0}getNeedsRefresh(t=!0){let r=this._needsRefresh;return t&&(this._needsRefresh=!1),r}};function bpt(e){let t=e?.fetch;if(t&&typeof t=="function")return(n,i)=>t(n,i);let r=e?.fetch;return r&&typeof r!="function"?n=>fetch(n,r):n=>fetch(n)}var Uu=class extends CE{};Vr(Uu,"type","template"),Vr(Uu,"testURL",t=>!1);var wpt=e=>typeof e=="boolean",mv=e=>typeof e=="function",VA=e=>e!==null&&typeof e=="object",XL=e=>VA(e)&&e.constructor==={}.constructor;var VV=e=>Boolean(e)&&typeof e[Symbol.iterator]=="function",jV=e=>e&&typeof e[Symbol.asyncIterator]=="function";var Vu=e=>typeof Response<"u"&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json;var ju=e=>typeof Blob<"u"&&e instanceof Blob,HV=e=>e&&typeof e=="object"&&e.isBuffer;var Tpt=e=>typeof ReadableStream<"u"&&e instanceof ReadableStream||VA(e)&&mv(e.tee)&&mv(e.cancel)&&mv(e.getReader);var Ept=e=>VA(e)&&mv(e.read)&&mv(e.pipe)&&wpt(e.readable),PE=e=>Tpt(e)||Ept(e);var IE=class extends Error{constructor(t,r){super(t),this.reason=r.reason,this.url=r.url,this.response=r.response}reason;url;response};var Mpt=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Spt=/^([-\w.]+\/[-\w.+]+)/;function YL(e,t){return e.toLowerCase()===t.toLowerCase()}function WV(e){let t=Spt.exec(e);return t?t[1]:e}function KL(e){let t=Mpt.exec(e);return t?t[1]:""}var qV=/\?.*/;function GV(e){let t=e.match(qV);return t&&t[0]}function __(e){return e.replace(qV,"")}function XV(e){if(e.length<50)return e;let t=e.slice(e.length-15);return`${e.substr(0,32)}...${t}`}function jA(e){return Vu(e)?e.url:ju(e)?e.name||"":typeof e=="string"?e:""}function Av(e){if(Vu(e)){let t=e,r=t.headers.get("content-type")||"",n=__(t.url);return WV(r)||KL(n)}return ju(e)?e.type||"":typeof e=="string"?KL(e):""}function YV(e){return Vu(e)?e.headers["content-length"]||-1:ju(e)?e.size:typeof e=="string"?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}async function RE(e){if(Vu(e))return e;let t={},r=YV(e);r>=0&&(t["content-length"]=String(r));let n=jA(e),i=Av(e);i&&(t["content-type"]=i);let o=await Ppt(e);o&&(t["x-first-bytes"]=o),typeof e=="string"&&(e=new TextEncoder().encode(e));let s=new Response(e,{headers:t});return Object.defineProperty(s,"url",{value:n}),s}async function KV(e){if(!e.ok)throw await Cpt(e)}async function Cpt(e){let t=XV(e.url),r=`Failed to fetch resource (${e.status}) ${e.statusText}: ${t}`;r=r.length>100?`${r.slice(0,100)}...`:r;let n={reason:e.statusText,url:e.url,response:e};try{let i=e.headers.get("Content-Type");n.reason=i?.includes("application/json")?await e.json():e.text()}catch{}return new IE(r,n)}async function Ppt(e){if(typeof e=="string")return`data:,${e.slice(0,5)}`;if(e instanceof Blob){let r=e.slice(0,5);return await new Promise(n=>{let i=new FileReader;i.onload=o=>n(o?.target?.result),i.readAsDataURL(r)})}if(e instanceof ArrayBuffer){let r=e.slice(0,5);return`data:base64,${Ipt(r)}`}return null}function Ipt(e){let t="",r=new Uint8Array(e);for(let n=0;n<r.byteLength;n++)t+=String.fromCharCode(r[n]);return btoa(t)}function Rpt(e){return!Lpt(e)&&!Opt(e)}function Lpt(e){return e.startsWith("http:")||e.startsWith("https:")}function Opt(e){return e.startsWith("data:")}async function y_(e,t){if(typeof e=="string"){let r=WL(e);return Rpt(r)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(r,t):await fetch(r,t)}return await RE(e)}var ZL=new Bl({id:"loaders.gl"}),LE=class{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}},OE=class{console;constructor(){this.console=console}log(...t){return this.console.log.bind(this.console,...t)}info(...t){return this.console.info.bind(this.console,...t)}warn(...t){return this.console.warn.bind(this.console,...t)}error(...t){return this.console.error.bind(this.console,...t)}};var $L={fetch:null,mimeType:void 0,nothrow:!1,log:new OE,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Dp,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},ZV={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function QL(){globalThis.loaders=globalThis.loaders||{};let{loaders:e}=globalThis;return e._state||(e._state={}),e._state}function JL(){let e=QL();return e.globalOptions=e.globalOptions||{...$L},e.globalOptions}function JV(e,t,r,n){return r=r||[],r=Array.isArray(r)?r:[r],Bpt(e,r),Npt(t,e,n)}function Bpt(e,t){$V(e,null,$L,ZV,t);for(let r of t){let n=e&&e[r.id]||{},i=r.options&&r.options[r.id]||{},o=r.deprecatedOptions&&r.deprecatedOptions[r.id]||{};$V(n,r.id,i,o,t)}}function $V(e,t,r,n,i){let o=t||"Top level",s=t?`${t}.`:"";for(let c in e){let l=!t&&VA(e[c]),h=c==="baseUri"&&!t,p=c==="workerUrl"&&t;if(!(c in r)&&!h&&!p){if(c in n)ZL.warn(`${o} loader option '${s}${c}' no longer supported, use '${n[c]}'`)();else if(!l){let x=Dpt(c,i);ZL.warn(`${o} loader option '${s}${c}' not recognized. ${x}`)()}}}}function Dpt(e,t){let r=e.toLowerCase(),n="";for(let i of t)for(let o in i.options){if(e===o)return`Did you mean '${i.id}.${o}'?`;let s=o.toLowerCase();(r.startsWith(s)||s.startsWith(r))&&(n=n||`Did you mean '${i.id}.${o}'?`)}return n}function Npt(e,t,r){let i={...e.options||{}};return kpt(i,r),i.log===null&&(i.log=new LE),QV(i,JL()),QV(i,t),i}function QV(e,t){for(let r in t)if(r in t){let n=t[r];XL(n)&&XL(e[r])?e[r]={...e[r],...t[r]}:e[r]=t[r]}}function kpt(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}function gv(e){return e?(Array.isArray(e)&&(e=e[0]),Array.isArray(e?.extensions)):!1}function _v(e){Ti(e,"null loader"),Ti(gv(e),"invalid loader");let t;return Array.isArray(e)&&(t=e[1],e=e[0],e={...e,options:{...e.options,...t}}),(e?.parseTextSync||e?.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}var t9=()=>{let e=QL();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};function HA(e){let t=t9();e=Array.isArray(e)?e:[e];for(let r of e){let n=_v(r);t.find(i=>n===i)||t.unshift(n)}}function e9(){return t9()}var r9=new Bl({id:"loaders.gl"});var Fpt=/\.([^.]+)$/;async function o9(e,t=[],r,n){if(!s9(e))return null;let i=n9(e,t,{...r,nothrow:!0},n);if(i)return i;if(ju(e)&&(e=await e.slice(0,10).arrayBuffer(),i=n9(e,t,r,n)),!i&&!r?.nothrow)throw new Error(a9(e));return i}function n9(e,t=[],r,n){if(!s9(e))return null;if(t&&!Array.isArray(t))return _v(t);let i=[];t&&(i=i.concat(t)),r?.ignoreRegisteredLoaders||i.push(...e9()),Upt(i);let o=zpt(e,i,r,n);if(!o&&!r?.nothrow)throw new Error(a9(e));return o}function zpt(e,t,r,n){let i=jA(e),o=Av(e),s=__(i)||n?.url,c=null,l="";return r?.mimeType&&(c=tO(t,r?.mimeType),l=`match forced by supplied MIME type ${r?.mimeType}`),c=c||Vpt(t,s),l=l||(c?`matched url ${s}`:""),c=c||tO(t,o),l=l||(c?`matched MIME type ${o}`:""),c=c||Hpt(t,e),l=l||(c?`matched initial data ${c9(e)}`:""),r?.fallbackMimeType&&(c=c||tO(t,r?.fallbackMimeType),l=l||(c?`matched fallback MIME type ${o}`:"")),l&&r9.log(1,`selectLoader selected ${c?.name}: ${l}.`),c}function s9(e){return!(e instanceof Response&&e.status===204)}function a9(e){let t=jA(e),r=Av(e),n="No valid loader found (";n+=t?`${ou.filename(t)}, `:"no url provided, ",n+=`MIME type: ${r?`"${r}"`:"not provided"}, `;let i=e?c9(e):"";return n+=i?` first bytes: "${i}"`:"first bytes: not available",n+=")",n}function Upt(e){for(let t of e)_v(t)}function Vpt(e,t){let r=t&&Fpt.exec(t),n=r&&r[1];return n?jpt(e,n):null}function jpt(e,t){t=t.toLowerCase();for(let r of e)for(let n of r.extensions)if(n.toLowerCase()===t)return r;return null}function tO(e,t){for(let r of e)if(r.mimeTypes?.some(n=>YL(t,n))||YL(t,`application/x.${r.id}`))return r;return null}function Hpt(e,t){if(!t)return null;for(let r of e)if(typeof t=="string"){if(Wpt(t,r))return r}else if(ArrayBuffer.isView(t)){if(i9(t.buffer,t.byteOffset,r))return r}else if(t instanceof ArrayBuffer&&i9(t,0,r))return r;return null}function Wpt(e,t){return t.testText?t.testText(e):(Array.isArray(t.tests)?t.tests:[t.tests]).some(n=>e.startsWith(n))}function i9(e,t,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some(i=>qpt(e,t,r,i))}function qpt(e,t,r,n){if(n instanceof ArrayBuffer)return UL(n,e,n.byteLength);switch(typeof n){case"function":return n(e);case"string":let i=eO(e,t,n.length);return n===i;default:return!1}}function c9(e,t=5){return typeof e=="string"?e.slice(0,t):ArrayBuffer.isView(e)?eO(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?eO(e,0,t):""}function eO(e,t,r){if(e.byteLength<t+r)return"";let n=new DataView(e),i="";for(let o=0;o<r;o++)i+=String.fromCharCode(n.getUint8(t+o));return i}function*l9(e,t){let r=t?.chunkSize||262144,n=0,i=new TextEncoder;for(;n<e.length;){let o=Math.min(e.length-n,r),s=e.slice(n,n+o);n+=o,yield i.encode(s)}}function*u9(e,t={}){let{chunkSize:r=262144}=t,n=0;for(;n<e.byteLength;){let i=Math.min(e.byteLength-n,r),o=new ArrayBuffer(i),s=new Uint8Array(e,n,i);new Uint8Array(o).set(s),n+=i,yield o}}async function*h9(e,t){let r=t?.chunkSize||1048576,n=0;for(;n<e.size;){let i=n+r,o=await e.slice(n,i).arrayBuffer();n=i,yield o}}function rO(e,t){return Dp?Gpt(e,t):Xpt(e,t)}async function*Gpt(e,t){let r=e.getReader(),n;try{for(;;){let i=n||r.read();t?._streamReadAhead&&(n=r.read());let{done:o,value:s}=await i;if(o)return;yield SE(s)}}catch{r.releaseLock()}}async function*Xpt(e,t){for await(let r of e)yield SE(r)}function f9(e,t){if(typeof e=="string")return l9(e,t);if(e instanceof ArrayBuffer)return u9(e,t);if(ju(e))return h9(e,t);if(PE(e))return rO(e,t);if(Vu(e))return rO(e.body,t);throw new Error("makeIterator")}var p9="Cannot convert supplied data type";function Ypt(e,t,r){if(t.text&&typeof e=="string")return e;if(HV(e)&&(e=e.buffer),e instanceof ArrayBuffer){let n=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let n=e.buffer,i=e.byteLength||e.length;return(e.byteOffset!==0||i!==n.byteLength)&&(n=n.slice(e.byteOffset,e.byteOffset+i)),n}throw new Error(p9)}async function d9(e,t,r){let n=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if(typeof e=="string"||n)return Ypt(e,t,r);if(ju(e)&&(e=await RE(e)),Vu(e)){let i=e;return await KV(i),t.binary?await i.arrayBuffer():await i.text()}if(PE(e)&&(e=f9(e,r)),VV(e)||jV(e))return HL(e);throw new Error(p9)}function BE(e,t){let r=JL(),n=e||r;return typeof n.fetch=="function"?n.fetch:VA(n.fetch)?i=>y_(i,n.fetch):t?.fetch?t?.fetch:y_}function m9(e,t,r){if(r)return r;let n={fetch:BE(t,e),...e};if(n.url){let i=__(n.url);n.baseUrl=i,n.queryString=GV(n.url),n.filename=ou.filename(i),n.baseUrl=ou.dirname(i)}return Array.isArray(n.loaders)||(n.loaders=null),n}function A9(e,t){if(e&&!Array.isArray(e))return e;let r;if(e&&(r=Array.isArray(e)?e:[e]),t&&t.loaders){let n=Array.isArray(t.loaders)?t.loaders:[t.loaders];r=r?[...r,...n]:n}return r&&r.length?r:void 0}async function Qd(e,t,r,n){t&&!Array.isArray(t)&&!gv(t)&&(n=void 0,r=t,t=void 0),e=await e,r=r||{};let i=jA(e),s=A9(t,n),c=await o9(e,s,r);return c?(r=JV(r,c,s,i),n=m9({url:i,_parse:Qd,loaders:s},r,n||null),await Kpt(c,e,r,n)):null}async function Kpt(e,t,r,n){if(DL(e),r=av(e.options,r),Vu(t)){let o=t,{ok:s,redirected:c,status:l,statusText:h,type:p,url:x}=o,w=Object.fromEntries(o.headers.entries());n.response={headers:w,ok:s,redirected:c,status:l,statusText:h,type:p,url:x}}t=await d9(t,e,r);let i=e;if(i.parseTextSync&&typeof t=="string")return i.parseTextSync(t,r,n);if(kL(e,r))return await FL(e,t,r,n,Qd);if(i.parseText&&typeof t=="string")return await i.parseText(t,r,n);if(i.parse)return await i.parse(t,r,n);throw wc(!i.parseSync),new Error(`${e.id} loader - no parser found and worker is disabled`)}async function xa(e,t,r,n){let i,o;!Array.isArray(t)&&!gv(t)?(i=[],o=t,n=void 0):(i=t,o=r);let s=BE(o),c=e;return typeof e=="string"&&(c=await s(e)),ju(e)&&(c=await s(e)),Array.isArray(i)?await Qd(c,i,o):await Qd(c,i,o)}var nO=class{stats=new Map;getStats(t){return this.get(t)}get(t){return this.stats.has(t)||this.stats.set(t,new Nc({id:t})),this.stats.get(t)}},DE=new nO;var qe=new Bl({id:"luma.gl"});var iO={};function Jd(e="id"){iO[e]=iO[e]||1;let t=iO[e]++;return`${e}-${t}`}var ti=class{toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor(t,r,n){if(!t)throw new Error("no device");this._device=t,this.props=Zpt(r,n);let i=this.props.id!=="undefined"?this.props.id:Jd(this[Symbol.toStringTag]);this.props.id=i,this.id=i,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(t){this._attachedResources.add(t)}detachResource(t){this._attachedResources.delete(t)}destroyAttachedResource(t){this._attachedResources.delete(t)&&t.destroy()}destroyAttachedResources(){for(let t of Object.values(this._attachedResources))t.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){let t=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];t.get(`${r}s Active`).decrementCount()}trackAllocatedMemory(t,r=this[Symbol.toStringTag]){let n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").addCount(t),n.get(`${r} Memory`).addCount(t),this.allocatedBytes=t}trackDeallocatedMemory(t=this[Symbol.toStringTag]){let r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").subtractCount(this.allocatedBytes),r.get(`${t} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){let t=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];t.get("Resources Created").incrementCount(),t.get(`${r}s Created`).incrementCount(),t.get(`${r}s Active`).incrementCount()}};Vr(ti,"defaultProps",{id:"undefined",handle:void 0,userData:void 0});function Zpt(e,t){let r={...t};for(let n in e)e[n]!==void 0&&(r[n]=e[n]);return r}var yv=class extends ti{get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor(t,r){let n={...r};(r.usage||0)&yv.INDEX&&!r.indexType&&(r.data instanceof Uint32Array?n.indexType="uint32":r.data instanceof Uint16Array&&(n.indexType="uint16")),delete n.data,super(t,n,yv.defaultProps),this.usage=n.usage||0,this.indexType=n.indexType,this.updateTimestamp=t.incrementTimestamp()}clone(t){return this.device.createBuffer({...this.props,...t})}readSyncWebGL(t,r){throw new Error("not implemented")}debugData=new ArrayBuffer(0);_setDebugData(t,r,n){let i=ArrayBuffer.isView(t)?t.buffer:t,o=Math.min(t?t.byteLength:n,yv.DEBUG_DATA_MAX_LENGTH);i===null?this.debugData=new ArrayBuffer(o):r===0&&n===i.byteLength?this.debugData=i.slice(0,o):this.debugData=i.slice(r,r+o)}},Vn=yv;Vr(Vn,"defaultProps",{...ti.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1}),Vr(Vn,"MAP_READ",1),Vr(Vn,"MAP_WRITE",2),Vr(Vn,"COPY_SRC",4),Vr(Vn,"COPY_DST",8),Vr(Vn,"INDEX",16),Vr(Vn,"VERTEX",32),Vr(Vn,"UNIFORM",64),Vr(Vn,"STORAGE",128),Vr(Vn,"INDIRECT",256),Vr(Vn,"QUERY_RESOLVE",512),Vr(Vn,"DEBUG_DATA_MAX_LENGTH",32);function NE(e){let t=g9[e],r=$pt(t),n=e.includes("norm"),i=!n&&!e.startsWith("float"),o=e.startsWith("s");return{dataType:g9[e],byteLength:r,integer:i,signed:o,normalized:n}}function $pt(e){return Qpt[e]}var g9={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},Qpt={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4};var kc="texture-compression-bc",Oo="texture-compression-astc",If="texture-compression-etc2",Jpt="texture-compression-etc1-webgl",kE="texture-compression-pvrtc-webgl",oO="texture-compression-atc-webgl",FE="float32-renderable-webgl",sO="float16-renderable-webgl",tdt="rgb9e5ufloat-renderable-webgl",aO="snorm8-renderable-webgl",xv="norm16-renderable-webgl",cO="snorm16-renderable-webgl",zE="float32-filterable",_9="float16-filterable-webgl";function UE(e){let t=edt[e];if(!t)throw new Error(`Unsupported texture format ${e}`);return t}var edt={r8unorm:{},r8snorm:{render:aO},r8uint:{},r8sint:{},rg8unorm:{},rg8snorm:{render:aO},rg8uint:{},rg8sint:{},r16uint:{},r16sint:{},r16float:{render:sO,filter:"float16-filterable-webgl"},"r16unorm-webgl":{f:xv},"r16snorm-webgl":{f:cO},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},"rgb8unorm-webgl":{},"rgb8snorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},rgba8snorm:{render:aO},rgba8uint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{},rg16sint:{},rg16float:{render:sO,filter:_9},"rg16unorm-webgl":{render:xv},"rg16snorm-webgl":{render:cO},r32uint:{},r32sint:{},r32float:{render:FE,filter:zE},rgb9e5ufloat:{channels:"rgb",packed:!0,render:tdt},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:FE},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},"rgb10a2uint-webgl":{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1,wgpu:!1},"rgb16unorm-webgl":{f:xv},"rgb16snorm-webgl":{f:xv},rg32uint:{},rg32sint:{},rg32float:{render:!1,filter:zE},rgba16uint:{},rgba16sint:{},rgba16float:{render:sO,filter:_9},"rgba16unorm-webgl":{render:xv},"rgba16snorm-webgl":{render:cO},"rgb32float-webgl":{render:FE,filter:zE},rgba32uint:{},rgba32sint:{},rgba32float:{render:FE,filter:zE},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0},"bc1-rgb-unorm-webgl":{f:kc},"bc1-rgb-unorm-srgb-webgl":{f:kc},"bc1-rgba-unorm":{f:kc},"bc1-rgba-unorm-srgb":{f:kc},"bc2-rgba-unorm":{f:kc},"bc2-rgba-unorm-srgb":{f:kc},"bc3-rgba-unorm":{f:kc},"bc3-rgba-unorm-srgb":{f:kc},"bc4-r-unorm":{f:kc},"bc4-r-snorm":{f:kc},"bc5-rg-unorm":{f:kc},"bc5-rg-snorm":{f:kc},"bc6h-rgb-ufloat":{f:kc},"bc6h-rgb-float":{f:kc},"bc7-rgba-unorm":{f:kc},"bc7-rgba-unorm-srgb":{f:kc},"etc2-rgb8unorm":{f:If},"etc2-rgb8unorm-srgb":{f:If},"etc2-rgb8a1unorm":{f:If},"etc2-rgb8a1unorm-srgb":{f:If},"etc2-rgba8unorm":{f:If},"etc2-rgba8unorm-srgb":{f:If},"eac-r11unorm":{f:If},"eac-r11snorm":{f:If},"eac-rg11unorm":{f:If},"eac-rg11snorm":{f:If},"astc-4x4-unorm":{f:Oo},"astc-4x4-unorm-srgb":{f:Oo},"astc-5x4-unorm":{f:Oo},"astc-5x4-unorm-srgb":{f:Oo},"astc-5x5-unorm":{f:Oo},"astc-5x5-unorm-srgb":{f:Oo},"astc-6x5-unorm":{f:Oo},"astc-6x5-unorm-srgb":{f:Oo},"astc-6x6-unorm":{f:Oo},"astc-6x6-unorm-srgb":{f:Oo},"astc-8x5-unorm":{f:Oo},"astc-8x5-unorm-srgb":{f:Oo},"astc-8x6-unorm":{f:Oo},"astc-8x6-unorm-srgb":{f:Oo},"astc-8x8-unorm":{f:Oo},"astc-8x8-unorm-srgb":{f:Oo},"astc-10x5-unorm":{f:Oo},"astc-10x5-unorm-srgb":{f:Oo},"astc-10x6-unorm":{f:Oo},"astc-10x6-unorm-srgb":{f:Oo},"astc-10x8-unorm":{f:Oo},"astc-10x8-unorm-srgb":{f:Oo},"astc-10x10-unorm":{f:Oo},"astc-10x10-unorm-srgb":{f:Oo},"astc-12x10-unorm":{f:Oo},"astc-12x10-unorm-srgb":{f:Oo},"astc-12x12-unorm":{f:Oo},"astc-12x12-unorm-srgb":{f:Oo},"pvrtc-rgb4unorm-webgl":{f:kE},"pvrtc-rgba4unorm-webgl":{f:kE},"pvrtc-rbg2unorm-webgl":{f:kE},"pvrtc-rgba2unorm-webgl":{f:kE},"etc1-rbg-unorm-webgl":{f:Jpt},"atc-rgb-unorm-webgl":{f:oO},"atc-rgba-unorm-webgl":{f:oO},"atc-rgbai-unorm-webgl":{f:oO}};var rdt=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],ndt=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;function lO(e){return rdt.some(t=>e.startsWith(t))}function x_(e){let t=idt(e);if(lO(e)){t.channels="rgb",t.components=3,t.bytesPerPixel=1,t.srgb=!1,t.compressed=!0;let n=odt(e);n&&(t.blockWidth=n.blockWidth,t.blockHeight=n.blockHeight)}let r=ndt.exec(e);if(r){let[,n,i,o,s,c]=r,l=`${o}${i}`,h=NE(l),p=h.byteLength*8,x=n.length,w=[p,x>=2?p:0,x>=3?p:0,x>=4?p:0];t={format:e,attachment:t.attachment,dataType:h.dataType,components:x,channels:n,integer:h.integer,signed:h.signed,normalized:h.normalized,bitsPerChannel:w,bytesPerPixel:h.byteLength*n.length,packed:t.packed,srgb:t.srgb},c==="-webgl"&&(t.webgl=!0),s==="-srgb"&&(t.srgb=!0)}return e.endsWith("-webgl")&&(t.webgl=!0),e.endsWith("-srgb")&&(t.srgb=!0),t}function idt(e){let t=UE(e),r=t.bytesPerPixel||1,n=t.bitsPerChannel||[8,8,8,8];return delete t.bitsPerChannel,delete t.bytesPerPixel,delete t.f,delete t.render,delete t.filter,delete t.blend,delete t.store,{...t,format:e,attachment:t.attachment||"color",channels:t.channels||"r",components:t.components||t.channels?.length||1,bytesPerPixel:r,bitsPerChannel:n,dataType:t.dataType||"uint8",srgb:t.srgb??!1,packed:t.packed??!1,webgl:t.webgl??!1,integer:t.integer??!1,signed:t.signed??!1,normalized:t.normalized??!1,compressed:t.compressed??!1}}function odt(e){let r=/.*-(\d+)x(\d+)-.*/.exec(e);if(r){let[,n,i]=r;return{blockWidth:Number(n),blockHeight:Number(i)}}return null}function y9(e){let t=UE(e),r={format:e,create:t.f??!0,render:t.render??!0,filter:t.filter??!0,blend:t.blend??!0,store:t.store??!0},n=x_(e),i=e.startsWith("depth")||e.startsWith("stencil"),o=n?.signed,s=n?.integer,c=n?.webgl;return r.render&&=!o,r.filter&&=!i&&!o&&!s&&!c,r}var vv=class{},bv=class{features;disabledFeatures;constructor(t=[],r){this.features=new Set(t),this.disabledFeatures=r||{}}*[Symbol.iterator](){yield*this.features}has(t){return!this.disabledFeatures?.[t]&&this.features.has(t)}},uO=class{get[Symbol.toStringTag](){return"Device"}constructor(t){this.props={...uO.defaultProps,...t},this.id=this.props.id||Jd(this[Symbol.toStringTag].toLowerCase())}id;props;userData={};statsManager=DE;timestamp=0;_lumaData={};getTextureFormatCapabilities(t){let r=y9(t),n=s=>(typeof s=="string"?this.features.has(s):s)??!0,i=n(r.create),o={format:t,create:i,render:i&&n(r.render),filter:i&&n(r.filter),blend:i&&n(r.blend),store:i&&n(r.store)};return this._getDeviceSpecificTextureFormatCapabilities(o)}isTextureFormatSupported(t,r){return this.getTextureFormatCapabilities(t).create}isTextureFormatFilterable(t){return this.getTextureFormatCapabilities(t).filter}isTextureFormatRenderable(t){return this.getTextureFormatCapabilities(t).render}isTextureFormatCompressed(t){return lO(t)}loseDevice(){return!1}reportError(t){this.props.onError(t)}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}createCommandEncoder(t={}){throw new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(t){this.props.onError(t)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(t,r){throw new Error("not implemented")}readPixelsToBufferWebGL(t,r){throw new Error("not implemented")}setParametersWebGL(t){throw new Error("not implemented")}getParametersWebGL(t){throw new Error("not implemented")}withParametersWebGL(t,r){throw new Error("not implemented")}clearWebGL(t){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}_normalizeBufferProps(t){(t instanceof ArrayBuffer||ArrayBuffer.isView(t))&&(t={data:t});let r={...t};return(t.usage||0)&Vn.INDEX&&!t.indexType&&(t.data instanceof Uint32Array?r.indexType="uint32":t.data instanceof Uint16Array?r.indexType="uint16":qe.warn("indices buffer content must be of integer type")()),r}},Dl=uO;Vr(Dl,"defaultProps",{id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,onError:t=>qe.error(t.message)(),_requestMaxLimits:!0,_factoryDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_resourceDefaults:{},webgl:{},debug:qe.get("debug")||void 0,debugShaders:qe.get("debug-shaders")||void 0,debugFramebuffers:Boolean(qe.get("debug-framebuffers")),debugWebGL:Boolean(qe.get("debug-webgl")),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_handle:void 0});var sdt=ul()&&typeof document<"u",adt=()=>sdt&&document.readyState==="complete",cdt="set luma.log.level=1 (or higher) to trace rendering",x9="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.",v_=class{stats=DE;log=qe;VERSION="9.1.0";spector;preregisteredAdapters=new Map;constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw qe.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),qe.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");qe.error("This version of luma.gl has already been initialized")()}qe.log(1,`${this.VERSION} - ${cdt}`)(),globalThis.luma=this}registerAdapters(t){for(let r of t)this.preregisteredAdapters.set(r.type,r)}getSupportedAdapters(t=[]){let r=this.getAdapterMap(t);return Array.from(r).map(([,n])=>n).filter(n=>n.isSupported?.()).map(n=>n.type)}getBestAvailableAdapter(t=[]){let r=this.getAdapterMap(t);return r.get("webgpu")?.isSupported?.()?"webgpu":r.get("webgl")?.isSupported?.()?"webgl":null}setDefaultDeviceProps(t){Object.assign(v_.defaultProps,t)}async createDevice(t={}){t={...v_.defaultProps,...t},t.waitForPageLoad&&await v_.pageLoaded;let r=this.getAdapterMap(t.adapters),n=t.type||"";n==="best-available"&&(n=this.getBestAvailableAdapter(t.adapters)||n);let s=await(this.getAdapterMap(t.adapters)||r).get(n)?.create?.(t);if(s)return s;throw new Error(x9)}async attachDevice(t){let r=this.getAdapterMap(t.adapters),n="";t.handle instanceof WebGL2RenderingContext&&(n="webgl"),t.createCanvasContext&&await v_.pageLoaded,t.handle===null&&(n="unknown");let o=await r.get(n)?.attach?.(null);if(o)return o;throw new Error(x9)}enforceWebGL2(t=!0,r=[]){let i=this.getAdapterMap(r).get("webgl");i||qe.warn("enforceWebGL2: webgl adapter not found")(),i?.enforceWebGL2?.(t)}getAdapterMap(t=[]){let r=new Map(this.preregisteredAdapters);for(let n of t)r.set(n.type,n);return r}registerDevices(t){qe.warn("luma.registerDevices() is deprecated, use luma.registerAdapters() instead");for(let r of t){let n=r.adapter;n&&this.preregisteredAdapters.set(n.type,n)}}},wv=v_;Vr(wv,"defaultProps",{...Dl.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0}),Vr(wv,"pageLoaded",ldt().then(()=>{qe.probe(2,"DOM is loaded")()}));var Rf=new wv;function ldt(){return adt()||typeof window>"u"?Promise.resolve():new Promise(e=>{window.addEventListener("load",()=>e())})}var Tv=class{};var hO=class{id;props;canvas;htmlCanvas;offscreenCanvas;type;width=1;height=1;resizeObserver;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};toString(){return`${this[Symbol.toStringTag]}(${this.id})`}constructor(t){if(this.props={...hO.defaultProps,...t},t=this.props,!ul()){this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,this.canvas=null;return}if(t.canvas)typeof t.canvas=="string"?this.canvas=hdt(t.canvas):this.canvas=t.canvas;else{let r=fdt(t),n=udt(t?.container||null);n.insertBefore(r,n.firstChild),this.canvas=r,t?.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&t.autoResize&&(this.resizeObserver=new ResizeObserver(r=>{for(let n of r)n.target===this.canvas&&this.update()}),this.resizeObserver.observe(this.canvas))}getDevicePixelRatio(t){return typeof OffscreenCanvas<"u"&&this.canvas instanceof OffscreenCanvas||(t=t===void 0?this.props.useDevicePixels:t,!t||t<=0)?1:t===!0?typeof window<"u"&&window.devicePixelRatio||1:t}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":let t=this.getDevicePixelRatio(),r=this.canvas;return r.parentElement?[r.clientWidth*t,r.clientHeight*t]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){let[t,r]=this.getPixelSize();return t/r}cssToDeviceRatio(){try{let[t]=this.getDrawingBufferSize(),r=this._canvasSizeInfo.clientWidth||this.htmlCanvas?.clientWidth;return r?t/r:1}catch{return 1}}cssToDevicePixels(t,r=!0){let n=this.cssToDeviceRatio(),[i,o]=this.getDrawingBufferSize();return pdt(t,n,i,o,r)}setDevicePixelRatio(t,r={}){if(!this.htmlCanvas)return;let n="width"in r?r.width:this.htmlCanvas.clientWidth,i="height"in r?r.height:this.htmlCanvas.clientHeight;(!n||!i)&&(qe.log(1,"Canvas clientWidth/clientHeight is 0")(),t=1,n=this.htmlCanvas.width||1,i=this.htmlCanvas.height||1);let o=this._canvasSizeInfo;if(o.clientWidth!==n||o.clientHeight!==i||o.devicePixelRatio!==t){let s=t,c=Math.floor(n*s),l=Math.floor(i*s);if(this.htmlCanvas.width=c,this.htmlCanvas.height=l,this.device.gl){let[p,x]=this.getDrawingBufferSize();(p!==c||x!==l)&&(s=Math.min(p/n,x/i),this.htmlCanvas.width=Math.floor(n*s),this.htmlCanvas.height=Math.floor(i*s),qe.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=n,this._canvasSizeInfo.clientHeight=i,this._canvasSizeInfo.devicePixelRatio=t}}}getDrawingBufferSize(){let t=this.device.gl;if(!t)throw new Error("canvas size");return[t.drawingBufferWidth,t.drawingBufferHeight]}_setAutoCreatedCanvasId(t){this.htmlCanvas?.id==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=t)}},b_=hO;Vr(b_,"defaultProps",{canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb"});function udt(e){if(typeof e=="string"){let t=document.getElementById(e);if(!t)throw new Error(`${e} is not an HTML element`);return t}else if(e)return e;return document.body}function hdt(e){let t=document.getElementById(e);if(!(t instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return t}function fdt(e){let{width:t,height:r}=e,n=document.createElement("canvas");return n.id=Jd("lumagl-auto-created-canvas"),n.width=t||1,n.height=r||1,n.style.width=Number.isFinite(t)?`${t}px`:"100%",n.style.height=Number.isFinite(r)?`${r}px`:"100%",n}function pdt(e,t,r,n,i){let o=e,s=v9(o[0],t,r),c=b9(o[1],t,n,i),l=v9(o[0]+1,t,r),h=l===r-1?l:l-1;l=b9(o[1]+1,t,n,i);let p;return i?(l=l===0?l:l+1,p=c,c=l):p=l===n-1?l:l-1,{x:s,y:c,width:Math.max(h-s+1,1),height:Math.max(p-c+1,1)}}function v9(e,t,r){return Math.min(Math.round(e*t),r-1)}function b9(e,t,r,n){return n?Math.max(0,r-1-Math.round(e*t)):Math.min(Math.round(e*t),r-1)}var Np=class extends ti{get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}dimension;format;width;height;depth;mipLevels;updateTimestamp;constructor(t,r){if(r=Np.normalizeProps(t,r),super(t,r,Np.defaultProps),this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.props.width===void 0||this.props.height===void 0){let n=Np.getTextureDataSize(this.props.data);this.width=n?.width||1,this.height=n?.height||1}this.props.mipmaps&&this.props.mipLevels===void 0&&(this.props.mipLevels="pyramid"),this.mipLevels=this.props.mipLevels==="pyramid"?Np.getMipLevelCount(this.width,this.height):this.props.mipLevels||1,this.updateTimestamp=t.incrementTimestamp()}clone(t){return this.device.createTexture({...this.props,...t})}static isExternalImage(t){return typeof ImageData<"u"&&t instanceof ImageData||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement||typeof VideoFrame<"u"&&t instanceof VideoFrame||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas}static getExternalImageSize(t){if(typeof ImageData<"u"&&t instanceof ImageData||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height};if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)return{width:t.naturalWidth,height:t.naturalHeight};if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)return{width:t.videoWidth,height:t.videoHeight};if(typeof VideoFrame<"u"&&t instanceof VideoFrame)return{width:t.displayWidth,height:t.displayHeight};throw new Error("Unknown image type")}static isTextureLevelData(t){let r=t?.data;return ArrayBuffer.isView(r)}static getTextureDataSize(t){if(!t||ArrayBuffer.isView(t))return null;if(Array.isArray(t))return Np.getTextureDataSize(t[0]);if(Np.isExternalImage(t))return Np.getExternalImageSize(t);if(t&&typeof t=="object"&&t.constructor===Object){let n=Object.values(t)[0];return{width:n.width,height:n.height}}throw new Error("texture size deduction failed")}static normalizeTextureData(t,r){let n;return ArrayBuffer.isView(t)?n=[{data:t,width:r.width,height:r.height}]:Array.isArray(t)?n=t:n=[t],n}static getMipLevelCount(t,r){return Math.floor(Math.log2(Math.max(t,r)))+1}static getCubeFaceDepth(t){switch(t){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(t)}}static normalizeProps(t,r){let n={...r},i=t?.props?._resourceDefaults?.texture||{};Object.assign(n,i);let{width:o,height:s}=n;return typeof o=="number"&&(n.width=Math.max(1,Math.ceil(o))),typeof s=="number"&&(n.height=Math.max(1,Math.ceil(s))),n}},fi=Np;Vr(fi,"COPY_SRC",1),Vr(fi,"COPY_DST",2),Vr(fi,"TEXTURE",4),Vr(fi,"STORAGE",8),Vr(fi,"RENDER_ATTACHMENT",16),Vr(fi,"CubeFaces",["+X","-X","+Y","-Y","+Z","-Z"]),Vr(fi,"defaultProps",{...ti.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!1,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,sampler:{},view:void 0,flipY:void 0}),Vr(fi,"defaultCopyExternalImageOptions",{image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1});var fO=class extends ti{get[Symbol.toStringTag](){return"TextureView"}constructor(t,r){super(t,r,fO.defaultProps)}},tm=fO;Vr(tm,"defaultProps",{...ti.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0});function T9(e,t,r){let n="",i=t.split(/\r?\n/),o=e.slice().sort((s,c)=>s.lineNum-c.lineNum);switch(r?.showSourceCode||"no"){case"all":let s=0;for(let c=1;c<=i.length;c++)for(n+=E9(i[c-1],c,r);o.length>s&&o[s].lineNum===c;){let l=o[s++];n+=w9(l,i,l.lineNum,{...r,inlineSource:!1})}return n;case"issues":case"no":for(let c of e)n+=w9(c,i,c.lineNum,{inlineSource:r?.showSourceCode!=="no"});return n}}function w9(e,t,r,n){if(n?.inlineSource){let o=ddt(t,r),s=e.linePos>0?`${" ".repeat(e.linePos+5)}^^^
`:"";return`
${o}${s}${e.type.toUpperCase()}: ${e.message}

`}let i=e.type==="error"?"red":"#8B4000";return n?.html?`<div class='luma-compiler-log-error' style="color:${i};"><b> ${e.type.toUpperCase()}: ${e.message}</b></div>`:`${e.type.toUpperCase()}: ${e.message}`}function ddt(e,t,r){let n="";for(let i=t-2;i<=t;i++){let o=e[i-1];o!==void 0&&(n+=E9(o,t,r))}return n}function E9(e,t,r){let n=r?.html?Adt(e):e;return`${mdt(String(t),4)}: ${n}${r?.html?"<br/>":`
`}`}function mdt(e,t){let r="";for(let n=e.length;n<t;++n)r+=" ";return r+e}function Adt(e){return e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}var pO=class extends ti{get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor(t,r){r={...r,debugShaders:r.debugShaders||t.props.debugShaders||"errors"},super(t,{id:gdt(r),...r},pO.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){let t=this.props.debugShaders;switch(t){case"never":return;case"errors":if(this.compilationStatus==="success")return;break;case"warnings":case"always":break}let r=await this.getCompilationInfo();t==="warnings"&&r?.length===0||this._displayShaderLog(r)}_displayShaderLog(t){if(typeof document>"u"||!document?.createElement)return;let r=M9(this.source),n=`${this.stage} ${r}`,i=T9(t,this.source,{showSourceCode:"all",html:!0}),o=this.getTranslatedSource();o&&(i+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${o}</pre></code>`);let s=document.createElement("Button");s.innerHTML=`
<h1>Shader Compilation Error in ${n}</h1><br /><br />
<code style="user-select:text;"><pre>
${i}
</pre></code>`,s.style.top="10px",s.style.left="10px",s.style.position="absolute",s.style.zIndex="9999",s.style.width="100%",s.style.textAlign="left",document.body.appendChild(s),document.getElementsByClassName("luma-compiler-log-error")[0]?.scrollIntoView(),s.onclick=()=>{let l=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(l)}}},em=pO;Vr(em,"defaultProps",{...ti.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0});function gdt(e){return M9(e.source)||e.id||Jd(`unnamed ${e.stage}-shader`)}function M9(e,t="unnamed"){let n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(e);return n?n[1]:t}var VE=class extends ti{get[Symbol.toStringTag](){return"Sampler"}constructor(t,r){r=VE.normalizeProps(t,r),super(t,r,VE.defaultProps)}static normalizeProps(t,r){let n=t?.props?._resourceDefaults?.sampler||{};return{...r,...n}}},rm=VE;Vr(rm,"defaultProps",{...ti.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1});var dO=class extends ti{get[Symbol.toStringTag](){return"Framebuffer"}width;height;constructor(t,r={}){super(t,r,dO.defaultProps),this.width=this.props.width,this.height=this.props.height}clone(t){let r=this.colorAttachments.map(i=>i.texture.clone(t)),n=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(t);return this.device.createFramebuffer({...this.props,colorAttachments:r,depthStencilAttachment:n})}resize(t){let r=!t;if(t){let[n,i]=Array.isArray(t)?t:[t.width,t.height];r=r||i!==this.height||n!==this.width,this.width=n,this.height=i}r&&(qe.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((r,n)=>{if(typeof r=="string"){let i=this.createColorTexture(r,n);return this.attachResource(i),i.view}return r instanceof fi?r.view:r});let t=this.props.depthStencilAttachment;if(t)if(typeof t=="string"){let r=this.createDepthStencilTexture(t);this.attachResource(r),this.depthStencilAttachment=r.view}else t instanceof fi?this.depthStencilAttachment=t.view:this.depthStencilAttachment=t}createColorTexture(t,r){return this.device.createTexture({id:`${this.id}-color-attachment-${r}`,usage:fi.RENDER_ATTACHMENT,format:t,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(t){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:fi.RENDER_ATTACHMENT,format:t,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(t,r){for(let n=0;n<this.colorAttachments.length;++n)if(this.colorAttachments[n]){let i=this.colorAttachments[n].texture.clone({width:t,height:r});this.destroyAttachedResource(this.colorAttachments[n]),this.colorAttachments[n]=i.view,this.attachResource(i.view)}if(this.depthStencilAttachment){let n=this.depthStencilAttachment.texture.clone({width:t,height:r});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=n.view,this.attachResource(n)}this.updateAttachments()}},Lf=dO;Vr(Lf,"defaultProps",{...ti.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null});var mO=class extends ti{get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor(t,r){super(t,r,mO.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}setUniformsWebGL(t){throw new Error("Use uniform blocks")}},Eh=mO;Vr(Eh,"defaultProps",{...ti.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}});var WA=class extends ti{get[Symbol.toStringTag](){return"RenderPass"}constructor(t,r){r=WA.normalizeProps(t,r),super(t,r,WA.defaultProps)}static normalizeProps(t,r){return{...t.props._resourceDefaults?.renderPass,...r}}},kp=WA;Vr(kp,"defaultClearColor",[0,0,0,1]),Vr(kp,"defaultClearDepth",1),Vr(kp,"defaultClearStencil",0),Vr(kp,"defaultProps",{...ti.defaultProps,framebuffer:null,parameters:void 0,clearColor:WA.defaultClearColor,clearColors:void 0,clearDepth:WA.defaultClearDepth,clearStencil:WA.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0});var AO=class extends ti{get[Symbol.toStringTag](){return"ComputePipeline"}hash="";shaderLayout;constructor(t,r){super(t,r,AO.defaultProps),this.shaderLayout=r.shaderLayout}},qA=AO;Vr(qA,"defaultProps",{...ti.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0});var gO=class extends ti{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(t,r){super(t,r,gO.defaultProps)}},w_=gO;Vr(w_,"defaultProps",{...ti.defaultProps,measureExecutionTime:void 0});var _O=class extends ti{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(t,r){super(t,r,_O.defaultProps)}},T_=_O;Vr(T_,"defaultProps",{...ti.defaultProps});function S9(e){let[t,r]=ydt[e],n=t==="i32"||t==="u32",i=t!=="u32",o=xdt[t]*r,s=_dt(t,r);return{dataType:t,components:r,defaultVertexFormat:s,byteLength:o,integer:n,signed:i}}function _dt(e,t){let r;switch(e){case"f32":r="float32";break;case"i32":r="sint32";break;case"u32":r="uint32";break;case"f16":return t<=2?"float16x2":"float16x4"}return t===1?r:`${r}x${t}`}var ydt={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},xdt={f32:4,f16:2,i32:4,u32:4};function yO(e){let t;e.endsWith("-webgl")&&(e.replace("-webgl",""),t=!0);let[r,n]=e.split("x"),i=r,o=n?parseInt(n):1,s=NE(i),c={type:i,components:o,byteLength:s.byteLength*o,integer:s.integer,signed:s.signed,normalized:s.normalized};return t&&(c.webglOnly=!0),c}function jE(e,t){let r={};for(let n of e.attributes){let i=vdt(e,t,n.name);i&&(r[n.name]=i)}return r}function C9(e,t,r=16){let n=jE(e,t),i=new Array(r).fill(null);for(let o of Object.values(n))i[o.location]=o;return i}function vdt(e,t,r){let n=bdt(e,r),i=wdt(t,r);if(!n)return null;let o=S9(n.type),s=i?.vertexFormat||o.defaultVertexFormat,c=yO(s);return{attributeName:i?.attributeName||n.name,bufferName:i?.bufferName||n.name,location:n.location,shaderType:n.type,shaderDataType:o.dataType,shaderComponents:o.components,vertexFormat:s,bufferDataType:c.type,bufferComponents:c.components,normalized:c.normalized,integer:o.integer,stepMode:i?.stepMode||n.stepMode||"vertex",byteOffset:i?.byteOffset||0,byteStride:i?.byteStride||0}}function bdt(e,t){let r=e.attributes.find(n=>n.name===t);return r||qe.warn(`shader layout attribute "${t}" not present in shader`),r||null}function wdt(e,t){Tdt(e);let r=Edt(e,t);return r||(r=Mdt(e,t),r)?r:(qe.warn(`layout for attribute "${t}" not present in buffer layout`),null)}function Tdt(e){for(let t of e)(t.attributes&&t.format||!t.attributes&&!t.format)&&qe.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function Edt(e,t){for(let r of e)if(r.format&&r.name===t)return{attributeName:r.name,bufferName:t,stepMode:r.stepMode,vertexFormat:r.format,byteOffset:0,byteStride:r.byteStride||0};return null}function Mdt(e,t){for(let r of e){let n=r.byteStride;if(typeof r.byteStride!="number")for(let o of r.attributes||[]){let s=yO(o.format);n+=s.byteLength}let i=r.attributes?.find(o=>o.attribute===t);if(i)return{attributeName:i.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:i.format,byteOffset:i.byteOffset,byteStride:n}}return null}var xO=class extends ti{get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(t,r){super(t,r,xO.defaultProps),this.maxVertexAttributes=t.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null);let{shaderLayout:n,bufferLayout:i}=r.renderPipeline||{};if(!n||!i)throw new Error("VertexArray");this.attributeInfos=C9(n,i,this.maxVertexAttributes)}setConstantWebGL(t,r){throw new Error("constant attributes not supported")}},E_=xO;Vr(E_,"defaultProps",{...ti.defaultProps,renderPipeline:null});var vO=class extends ti{get[Symbol.toStringTag](){return"TransformFeedback"}constructor(t,r){super(t,r,vO.defaultProps)}},M_=vO;Vr(M_,"defaultProps",{...ti.defaultProps,layout:void 0,buffers:{}});var bO=class extends ti{get[Symbol.toStringTag](){return"QuerySet"}constructor(t,r){super(t,r,bO.defaultProps)}},S_=bO;Vr(S_,"defaultProps",{...ti.defaultProps,type:void 0,count:void 0});var Sdt={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function P9(e){return Sdt[e]}function I9(e,t){switch(t){case 1:return e;case 2:return e+e%2;default:return e+(4-e%4)%4}}var HE;function wO(e){return(!HE||HE.byteLength<e)&&(HE=new ArrayBuffer(e)),HE}function TO(e,t){let r=wO(e.BYTES_PER_ELEMENT*t);return new e(r,0,t)}function Cdt(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function C_(e){return Array.isArray(e)?e.length===0||typeof e[0]=="number":Cdt(e)}var R9=1024,WE=class{layout={};byteLength;constructor(t){let r=0;for(let[i,o]of Object.entries(t)){let s=P9(o),{type:c,components:l}=s;r=I9(r,l);let h=r;r+=l,this.layout[i]={type:c,size:l,offset:h}}r+=(4-r%4)%4;let n=r*4;this.byteLength=Math.max(n,R9)}getData(t){let r=Math.max(this.byteLength,R9),n=wO(r),i={i32:new Int32Array(n),u32:new Uint32Array(n),f32:new Float32Array(n),f16:new Uint16Array(n)};for(let[o,s]of Object.entries(t)){let c=this.layout[o];if(!c){qe.warn(`Supplied uniform value ${o} not present in uniform block layout`)();continue}let{type:l,size:h,offset:p}=c,x=i[l];if(h===1){if(typeof s!="number"&&typeof s!="boolean"){qe.warn(`Supplied value for single component uniform ${o} is not a number: ${s}`)();continue}x[p]=Number(s)}else{if(!C_(s)){qe.warn(`Supplied value for multi component / array uniform ${o} is not a numeric array: ${s}`)();continue}x.set(s,p)}}return new Uint8Array(n)}has(t){return Boolean(this.layout[t])}get(t){return this.layout[t]}};function L9(e,t,r=16){if(e!==t)return!1;let n=e,i=t;if(!C_(n))return!1;if(C_(i)&&n.length===i.length){for(let o=0;o<n.length;++o)if(i[o]!==n[o])return!1}return!0}function O9(e){return C_(e)?e.slice():e}var qE=class{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor(t){if(this.name=t?.name||"unnamed",t?.name&&t?.shaderLayout){let r=t?.shaderLayout.bindings?.find(i=>i.type==="uniform"&&i.name===t?.name);if(!r)throw new Error(t?.name);let n=r;for(let i of n.uniforms||[])this.bindingLayout[i.name]=i}}setUniforms(t){for(let[r,n]of Object.entries(t))this._setUniform(r,n),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${r}=${n}`)}setNeedsRedraw(t){this.needsRedraw=this.needsRedraw||t}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(t,r){L9(this.uniforms[t],r)||(this.uniforms[t]=O9(r),this.modifiedUniforms[t]=!0,this.modified=!0)}};var Ev=class{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor(t){for(let[r,n]of Object.entries(t)){let i=r,o=new WE(n.uniformTypes||{});this.uniformBufferLayouts.set(i,o);let s=new qE({name:r});s.setUniforms(n.defaultUniforms||{}),this.uniformBlocks.set(i,s)}}destroy(){for(let t of this.uniformBuffers.values())t.destroy()}setUniforms(t){for(let[r,n]of Object.entries(t))this.uniformBlocks.get(r)?.setUniforms(n);this.updateUniformBuffers()}getUniformBufferByteLength(t){return this.uniformBufferLayouts.get(t)?.byteLength||0}getUniformBufferData(t){let r=this.uniformBlocks.get(t)?.getAllUniforms()||{};return this.uniformBufferLayouts.get(t)?.getData(r)}createUniformBuffer(t,r,n){n&&this.setUniforms(n);let i=this.getUniformBufferByteLength(r),o=t.createBuffer({usage:Vn.UNIFORM|Vn.COPY_DST,byteLength:i}),s=this.getUniformBufferData(r);return o.write(s),o}getManagedUniformBuffer(t,r){if(!this.uniformBuffers.get(r)){let n=this.getUniformBufferByteLength(r),i=t.createBuffer({usage:Vn.UNIFORM|Vn.COPY_DST,byteLength:n});this.uniformBuffers.set(r,i)}return this.uniformBuffers.get(r)}updateUniformBuffers(){let t=!1;for(let r of this.uniformBlocks.keys()){let n=this.updateUniformBuffer(r);t||=n}return t&&qe.log(3,`UniformStore.updateUniformBuffers(): ${t}`)(),t}updateUniformBuffer(t){let r=this.uniformBlocks.get(t),n=this.uniformBuffers.get(t),i=!1;if(n&&r?.needsRedraw){i||=r.needsRedraw;let o=this.getUniformBufferData(t);n=this.uniformBuffers.get(t),n?.write(o);let s=this.uniformBlocks.get(t)?.getAllUniforms();qe.log(4,`Writing to uniform buffer ${String(t)}`,o,s)()}return i}};function GE(e){let t=ArrayBuffer.isView(e)?e.constructor:e;switch(t){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(t.constructor.name)}}function Mv(e){switch(e){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(e)}}function EO(e,t,r){if(!t||t>4)throw new Error(`size ${t}`);let n=t,i=GE(e);if(i==="uint8"&&r&&n===1)return"unorm8-webgl";if(i==="uint8"&&r&&n===3)return"unorm8x3-webgl";if(i==="uint8"||i==="sint8"){if(n===1||n===3)throw new Error(`size: ${t}`);return r&&(i=i.replace("int","norm")),`${i}x${n}`}if(i==="uint16"||i==="sint16"){if(n===1||n===3)throw new Error(`size: ${t}`);return r&&(i=i.replace("int","norm")),`${i}x${n}`}return n===1?i:`${i}x${n}`}var GA=class{bufferLayouts;constructor(t){this.bufferLayouts=t}getBufferLayout(t){return this.bufferLayouts.find(r=>r.name===t)||null}getAttributeNamesForBuffer(t){return t.attributes?t.attributes?.map(r=>r.attribute):[t.name]}mergeBufferLayouts(t,r){let n=[...t];for(let i of r){let o=n.findIndex(s=>s.name===i.name);o<0?n.push(i):n[o]=i}return n}};var Of;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.R16_EXT=33322]="R16_EXT",e[e.RG16_EXT=33324]="RG16_EXT",e[e.RGB16_EXT=32852]="RGB16_EXT",e[e.RGBA16_EXT=32859]="RGBA16_EXT",e[e.R16_SNORM_EXT=36760]="R16_SNORM_EXT",e[e.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",e[e.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",e[e.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",e[e.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",e[e.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",e[e.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",e[e.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",e[e.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",e[e.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",e[e.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",e[e.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",e[e.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",e[e.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",e[e.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",e[e.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",e[e.LINE_WEBGL=6913]="LINE_WEBGL",e[e.FILL_WEBGL=6914]="FILL_WEBGL",e[e.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",e[e.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",e[e.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",e[e.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",e[e.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",e[e.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",e[e.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",e[e.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",e[e.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",e[e.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",e[e.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",e[e.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",e[e.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",e[e.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",e[e.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",e[e.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",e[e.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",e[e.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",e[e.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",e[e.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",e[e.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",e[e.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",e[e.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",e[e.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(Of||(Of={}));var Cv={[3042]:!1,[32773]:new Float32Array([0,0,0,0]),[32777]:32774,[34877]:32774,[32969]:1,[32968]:0,[32971]:1,[32970]:0,[3106]:new Float32Array([0,0,0,0]),[3107]:[!0,!0,!0,!0],[2884]:!1,[2885]:1029,[2929]:!1,[2931]:1,[2932]:513,[2928]:new Float32Array([0,1]),[2930]:!0,[3024]:!0,[35725]:null,[36006]:null,[36007]:null,[34229]:null,[34964]:null,[2886]:2305,[33170]:4352,[2849]:1,[32823]:!1,[32824]:0,[10752]:0,[32926]:!1,[32928]:!1,[32938]:1,[32939]:!1,[3089]:!1,[3088]:new Int32Array([0,0,1024,1024]),[2960]:!1,[2961]:0,[2968]:4294967295,[36005]:4294967295,[2962]:519,[2967]:0,[2963]:4294967295,[34816]:519,[36003]:0,[36004]:4294967295,[2964]:7680,[2965]:7680,[2966]:7680,[34817]:7680,[34818]:7680,[34819]:7680,[2978]:[0,0,1024,1024],[36389]:null,[36662]:null,[36663]:null,[35053]:null,[35055]:null,[35723]:4352,[36010]:null,[35977]:!1,[3333]:4,[3317]:4,[37440]:!1,[37441]:!1,[37443]:37444,[3330]:0,[3332]:0,[3331]:0,[3314]:0,[32878]:0,[3316]:0,[3315]:0,[32877]:0},va=(e,t,r)=>t?e.enable(r):e.disable(r),B9=(e,t,r)=>e.hint(r,t),su=(e,t,r)=>e.pixelStorei(r,t),D9=(e,t,r)=>{let n=r===36006?36009:36008;return e.bindFramebuffer(n,t)},Sv=(e,t,r)=>{let i={[34964]:34962,[36662]:36662,[36663]:36663,[35053]:35051,[35055]:35052}[r];e.bindBuffer(i,t)};function MO(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}var N9={[3042]:va,[32773]:(e,t)=>e.blendColor(...t),[32777]:"blendEquation",[34877]:"blendEquation",[32969]:"blendFunc",[32968]:"blendFunc",[32971]:"blendFunc",[32970]:"blendFunc",[3106]:(e,t)=>e.clearColor(...t),[3107]:(e,t)=>e.colorMask(...t),[2884]:va,[2885]:(e,t)=>e.cullFace(t),[2929]:va,[2931]:(e,t)=>e.clearDepth(t),[2932]:(e,t)=>e.depthFunc(t),[2928]:(e,t)=>e.depthRange(...t),[2930]:(e,t)=>e.depthMask(t),[3024]:va,[35723]:B9,[35725]:(e,t)=>e.useProgram(t),[36007]:(e,t)=>e.bindRenderbuffer(36161,t),[36389]:(e,t)=>e.bindTransformFeedback?.(36386,t),[34229]:(e,t)=>e.bindVertexArray(t),[36006]:D9,[36010]:D9,[34964]:Sv,[36662]:Sv,[36663]:Sv,[35053]:Sv,[35055]:Sv,[2886]:(e,t)=>e.frontFace(t),[33170]:B9,[2849]:(e,t)=>e.lineWidth(t),[32823]:va,[32824]:"polygonOffset",[10752]:"polygonOffset",[35977]:va,[32926]:va,[32928]:va,[32938]:"sampleCoverage",[32939]:"sampleCoverage",[3089]:va,[3088]:(e,t)=>e.scissor(...t),[2960]:va,[2961]:(e,t)=>e.clearStencil(t),[2968]:(e,t)=>e.stencilMaskSeparate(1028,t),[36005]:(e,t)=>e.stencilMaskSeparate(1029,t),[2962]:"stencilFuncFront",[2967]:"stencilFuncFront",[2963]:"stencilFuncFront",[34816]:"stencilFuncBack",[36003]:"stencilFuncBack",[36004]:"stencilFuncBack",[2964]:"stencilOpFront",[2965]:"stencilOpFront",[2966]:"stencilOpFront",[34817]:"stencilOpBack",[34818]:"stencilOpBack",[34819]:"stencilOpBack",[2978]:(e,t)=>e.viewport(...t),[34383]:va,[10754]:va,[12288]:va,[12289]:va,[12290]:va,[12291]:va,[12292]:va,[12293]:va,[12294]:va,[12295]:va,[3333]:su,[3317]:su,[37440]:su,[37441]:su,[37443]:su,[3330]:su,[3332]:su,[3331]:su,[3314]:su,[32878]:su,[3316]:su,[3315]:su,[32877]:su,framebuffer:(e,t)=>{let r=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(36160,r)},blend:(e,t)=>t?e.enable(3042):e.disable(3042),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{let r=typeof t=="number"?[t,t]:t;e.blendEquationSeparate(...r)},blendFunc:(e,t)=>{let r=t?.length===2?[...t,...t]:t;e.blendFuncSeparate(...r)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(2884):e.disable(2884),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(2929):e.disable(2929),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(3024):e.disable(3024),derivativeHint:(e,t)=>{e.hint(35723,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(33170,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(32823):e.disable(32823),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(t[0],t[1]||!1),scissorTest:(e,t)=>t?e.enable(3089):e.disable(3089),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(2960):e.disable(2960),stencilMask:(e,t)=>{t=MO(t)?t:[t,t];let[r,n]=t;e.stencilMaskSeparate(1028,r),e.stencilMaskSeparate(1029,n)},stencilFunc:(e,t)=>{t=MO(t)&&t.length===3?[...t,...t]:t;let[r,n,i,o,s,c]=t;e.stencilFuncSeparate(1028,r,n,i),e.stencilFuncSeparate(1029,o,s,c)},stencilOp:(e,t)=>{t=MO(t)&&t.length===3?[...t,...t]:t;let[r,n,i,o,s,c]=t;e.stencilOpSeparate(1028,r,n,i),e.stencilOpSeparate(1029,o,s,c)},viewport:(e,t)=>e.viewport(...t)};function Ws(e,t,r){return t[e]!==void 0?t[e]:r[e]}var k9={blendEquation:(e,t,r)=>e.blendEquationSeparate(Ws(32777,t,r),Ws(34877,t,r)),blendFunc:(e,t,r)=>e.blendFuncSeparate(Ws(32969,t,r),Ws(32968,t,r),Ws(32971,t,r),Ws(32970,t,r)),polygonOffset:(e,t,r)=>e.polygonOffset(Ws(32824,t,r),Ws(10752,t,r)),sampleCoverage:(e,t,r)=>e.sampleCoverage(Ws(32938,t,r),Ws(32939,t,r)),stencilFuncFront:(e,t,r)=>e.stencilFuncSeparate(1028,Ws(2962,t,r),Ws(2967,t,r),Ws(2963,t,r)),stencilFuncBack:(e,t,r)=>e.stencilFuncSeparate(1029,Ws(34816,t,r),Ws(36003,t,r),Ws(36004,t,r)),stencilOpFront:(e,t,r)=>e.stencilOpSeparate(1028,Ws(2964,t,r),Ws(2965,t,r),Ws(2966,t,r)),stencilOpBack:(e,t,r)=>e.stencilOpSeparate(1029,Ws(34817,t,r),Ws(34818,t,r),Ws(34819,t,r))},SO={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,r)=>e({[t]:r}),hint:(e,t,r)=>e({[t]:r}),useProgram:(e,t)=>e({[35725]:t}),bindRenderbuffer:(e,t,r)=>e({[36007]:r}),bindTransformFeedback:(e,t,r)=>e({[36389]:r}),bindVertexArray:(e,t)=>e({[34229]:t}),bindFramebuffer:(e,t,r)=>{switch(t){case 36160:return e({[36006]:r,[36010]:r});case 36009:return e({[36006]:r});case 36008:return e({[36010]:r});default:return null}},bindBuffer:(e,t,r)=>{let n={[34962]:[34964],[36662]:[36662],[36663]:[36663],[35051]:[35053],[35052]:[35055]}[t];return n?e({[n]:r}):{valueChanged:!0}},blendColor:(e,t,r,n,i)=>e({[32773]:new Float32Array([t,r,n,i])}),blendEquation:(e,t)=>e({[32777]:t,[34877]:t}),blendEquationSeparate:(e,t,r)=>e({[32777]:t,[34877]:r}),blendFunc:(e,t,r)=>e({[32969]:t,[32968]:r,[32971]:t,[32970]:r}),blendFuncSeparate:(e,t,r,n,i)=>e({[32969]:t,[32968]:r,[32971]:n,[32970]:i}),clearColor:(e,t,r,n,i)=>e({[3106]:new Float32Array([t,r,n,i])}),clearDepth:(e,t)=>e({[2931]:t}),clearStencil:(e,t)=>e({[2961]:t}),colorMask:(e,t,r,n,i)=>e({[3107]:[t,r,n,i]}),cullFace:(e,t)=>e({[2885]:t}),depthFunc:(e,t)=>e({[2932]:t}),depthRange:(e,t,r)=>e({[2928]:new Float32Array([t,r])}),depthMask:(e,t)=>e({[2930]:t}),frontFace:(e,t)=>e({[2886]:t}),lineWidth:(e,t)=>e({[2849]:t}),polygonOffset:(e,t,r)=>e({[32824]:t,[10752]:r}),sampleCoverage:(e,t,r)=>e({[32938]:t,[32939]:r}),scissor:(e,t,r,n,i)=>e({[3088]:new Int32Array([t,r,n,i])}),stencilMask:(e,t)=>e({[2968]:t,[36005]:t}),stencilMaskSeparate:(e,t,r)=>e({[t===1028?2968:36005]:r}),stencilFunc:(e,t,r,n)=>e({[2962]:t,[2967]:r,[2963]:n,[34816]:t,[36003]:r,[36004]:n}),stencilFuncSeparate:(e,t,r,n,i)=>e({[t===1028?2962:34816]:r,[t===1028?2967:36003]:n,[t===1028?2963:36004]:i}),stencilOp:(e,t,r,n)=>e({[2964]:t,[2965]:r,[2966]:n,[34817]:t,[34818]:r,[34819]:n}),stencilOpSeparate:(e,t,r,n,i)=>e({[t===1028?2964:34817]:r,[t===1028?2965:34818]:n,[t===1028?2966:34819]:i}),viewport:(e,t,r,n,i)=>e({[2978]:[t,r,n,i]})},Bf=(e,t)=>e.isEnabled(t),CO={[3042]:Bf,[2884]:Bf,[2929]:Bf,[3024]:Bf,[32823]:Bf,[32926]:Bf,[32928]:Bf,[3089]:Bf,[2960]:Bf,[35977]:Bf},F9=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function Mh(e,t){if(Pdt(t))return;let r={};for(let i in t){let o=Number(i),s=N9[i];s&&(typeof s=="string"?r[s]=!0:s(e,t[i],o))}let n=e.state&&e.state.cache;if(n)for(let i in r){let o=k9[i];o(e,t,n)}}function XE(e,t=Cv){if(typeof t=="number"){let i=t,o=CO[i];return o?o(e,i):e.getParameter(i)}let r=Array.isArray(t)?t:Object.keys(t),n={};for(let i of r){let o=CO[i];n[i]=o?o(e,Number(i)):e.getParameter(Number(i))}return n}function z9(e){Mh(e,Cv)}function Pdt(e){for(let t in e)return!1;return!0}function U9(e,t){if(e===t)return!0;let r=Array.isArray(e)||ArrayBuffer.isView(e),n=Array.isArray(t)||ArrayBuffer.isView(t);if(r&&n&&e.length===t.length){for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}return!1}var Sh=class{static get(t){return t.state}gl;program=null;stateStack=[];enable=!0;cache=null;log;initialized=!1;constructor(t,r){this.gl=t,this.log=r?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(t={}){this.stateStack.push({})}pop(){let t=this.stateStack[this.stateStack.length-1];Mh(this.gl,t),this.stateStack.pop()}trackState(t,r){if(this.cache=r.copyState?XE(t):Object.assign({},Cv),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,Rdt(t);for(let n in SO){let i=SO[n];Idt(t,n,i)}V9(t,"getParameter"),V9(t,"isEnabled")}_updateCache(t){let r=!1,n,i=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(let o in t){let s=t[o],c=this.cache[o];U9(s,c)||(r=!0,n=c,i&&!(o in i)&&(i[o]=c),this.cache[o]=s)}return{valueChanged:r,oldValue:n}}};function V9(e,t){let r=e[t].bind(e);e[t]=function(i){if(i===void 0||F9.has(i))return r(i);let o=Sh.get(e);return i in o.cache||(o.cache[i]=r(i)),o.enable?o.cache[i]:r(i)},Object.defineProperty(e[t],"name",{value:`${t}-from-cache`,configurable:!1})}function Idt(e,t,r){if(!e[t])return;let n=e[t].bind(e);e[t]=function(...o){let s=Sh.get(e),{valueChanged:c,oldValue:l}=r(s._updateCache,...o);return c&&n(...o),l},Object.defineProperty(e[t],"name",{value:`${t}-to-cache`,configurable:!1})}function Rdt(e){let t=e.useProgram.bind(e);e.useProgram=function(n){let i=Sh.get(e);i.program!==n&&(t(n),i.program=n)}}function j9(e,t,r){let n="",i={preserveDrawingBuffer:!0,...r},o=null;if(o||=e.getContext("webgl2",i),i.failIfMajorPerformanceCaveat&&(n||="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow."),!o&&!r.failIfMajorPerformanceCaveat&&(i.failIfMajorPerformanceCaveat=!1,o=e.getContext("webgl2",i),o.luma||={},o.luma.softwareRenderer=!0),o||(o=e.getContext("webgl",{}),o&&(o=null,n||="Your browser only supports WebGL1")),!o)throw n||="Your browser does not support WebGL",new Error(`Failed to create WebGL context: ${n}`);let{onContextLost:s,onContextRestored:c}=t;return e.addEventListener("webglcontextlost",l=>s(l),!1),e.addEventListener("webglcontextrestored",l=>c(l),!1),o.luma||={},o}function Df(e,t,r){return r[t]===void 0&&(r[t]=e.getExtension(t)||null),r[t]}function H9(e,t){let r=e.getParameter(7936),n=e.getParameter(7937);Df(e,"WEBGL_debug_renderer_info",t);let i=t.WEBGL_debug_renderer_info,o=e.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936),s=e.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937),c=o||r,l=s||n,h=e.getParameter(7938),p=W9(c,l),x=Ldt(c,l),w=Odt(c,l);return{type:"webgl",gpu:p,gpuType:w,gpuBackend:x,vendor:c,renderer:l,version:h,shadingLanguage:"glsl",shadingLanguageVersion:300}}function W9(e,t){return/NVIDIA/i.exec(e)||/NVIDIA/i.exec(t)?"nvidia":/INTEL/i.exec(e)||/INTEL/i.exec(t)?"intel":/Apple/i.exec(e)||/Apple/i.exec(t)?"apple":/AMD/i.exec(e)||/AMD/i.exec(t)||/ATI/i.exec(e)||/ATI/i.exec(t)?"amd":/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t)?"software":"unknown"}function Ldt(e,t){return/Metal/i.exec(e)||/Metal/i.exec(t)?"metal":/ANGLE/i.exec(e)||/ANGLE/i.exec(t)?"opengl":"unknown"}function Odt(e,t){if(/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t))return"cpu";switch(W9(e,t)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function YE(e){switch(e){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(e))}var Pv="WEBGL_compressed_texture_s3tc",Iv="WEBGL_compressed_texture_s3tc_srgb",P_="EXT_texture_compression_rgtc",I_="EXT_texture_compression_bptc",Bdt="WEBGL_compressed_texture_etc",Ddt="WEBGL_compressed_texture_astc",Ndt="WEBGL_compressed_texture_etc1",kdt="WEBGL_compressed_texture_pvrtc",Fdt="WEBGL_compressed_texture_atc",q9="EXT_texture_norm16",G9="EXT_render_snorm",zdt="EXT_color_buffer_float",KE={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[G9],"norm16-renderable-webgl":[q9],"snorm16-renderable-webgl":[q9,G9],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[Pv,Iv,P_,I_],"texture-compression-bc5-webgl":[P_],"texture-compression-bc7-webgl":[I_],"texture-compression-etc2":[Bdt],"texture-compression-astc":[Ddt],"texture-compression-etc1-webgl":[Ndt],"texture-compression-pvrtc-webgl":[kdt],"texture-compression-atc-webgl":[Fdt]};function X9(e){return e in KE}function Y9(e,t,r){return(KE[t]||[]).every(i=>Df(e,i,r))}var PO={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},"r16unorm-webgl":{gl:33322,rb:!0},"r16snorm-webgl":{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},"rg16unorm-webgl":{gl:33324},"rg16snorm-webgl":{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},"rgb10a2uint-webgl":{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},"rgba16unorm-webgl":{gl:32859,rb:!0},"rgba16snorm-webgl":{gl:36763},"rgb32float-webgl":{gl:34837,x:zdt,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:Pv},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:Iv},"bc1-rgba-unorm":{gl:33777,x:Pv},"bc1-rgba-unorm-srgb":{gl:35916,x:Iv},"bc2-rgba-unorm":{gl:33778,x:Pv},"bc2-rgba-unorm-srgb":{gl:35918,x:Iv},"bc3-rgba-unorm":{gl:33779,x:Pv},"bc3-rgba-unorm-srgb":{gl:35919,x:Iv},"bc4-r-unorm":{gl:36283,x:P_},"bc4-r-snorm":{gl:36284,x:P_},"bc5-rg-unorm":{gl:36285,x:P_},"bc5-rg-snorm":{gl:36286,x:P_},"bc6h-rgb-ufloat":{gl:36495,x:I_},"bc6h-rgb-float":{gl:36494,x:I_},"bc7-rgba-unorm":{gl:36492,x:I_},"bc7-rgba-unorm-srgb":{gl:36493,x:I_},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function K9(e,t,r){let n=t.create,i=PO[t.format];return i?.gl===void 0&&(n=!1),i?.x&&(n=n&&Boolean(Df(e,i.x,r))),{format:t.format,create:n&&t.create,render:n&&t.render,filter:n&&t.filter,blend:n&&t.blend,store:n&&t.store}}function ZE(e){let t=PO[e],r=Vdt(e),n=x_(e);return{internalFormat:r,format:t?.dataFormat||Udt(n.channels,n.integer,n.normalized,r),type:n.dataType?YE(n.dataType):t?.types?.[0]||5121,compressed:n.compressed||!1}}function Z9(e){switch(x_(e).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error(`Not a depth stencil format: ${e}`)}}function Udt(e,t,r,n){if(n===6408||n===6407)return n;switch(e){case"r":return t&&!r?36244:6403;case"rg":return t&&!r?33320:33319;case"rgb":return t&&!r?36248:6407;case"rgba":return t&&!r?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}function Vdt(e){let r=PO[e]?.gl;if(r===void 0)throw new Error(`Unsupported texture format ${e}`);return r}var $9={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"},$E=class extends bv{gl;extensions;testedFeatures=new Set;constructor(t,r,n){super([],n),this.gl=t,this.extensions=r,Df(t,"EXT_color_buffer_float",r)}*[Symbol.iterator](){let t=this.getFeatures();for(let r of t)this.has(r)&&(yield r);return[]}has(t){return this.disabledFeatures?.[t]?!1:(this.testedFeatures.has(t)||(this.testedFeatures.add(t),X9(t)&&Y9(this.gl,t,this.extensions)&&this.features.add(t),this.getWebGLFeature(t)&&this.features.add(t)),this.features.has(t))}initializeFeatures(){let t=this.getFeatures().filter(r=>r!=="polygon-mode-webgl");for(let r of t)this.has(r)}getFeatures(){return[...Object.keys($9),...Object.keys(KE)]}getWebGLFeature(t){let r=$9[t];return Boolean(typeof r=="string"?Df(this.gl,r,this.extensions):r)}};var QE=class extends vv{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(t){super(),this.gl=t}getParameter(t){return this.limits[t]===void 0&&(this.limits[t]=this.gl.getParameter(t)),this.limits[t]||0}};var Nf=class extends Lf{device;gl;handle;colorAttachments=[];depthStencilAttachment=null;constructor(t,r){super(t,r);let n=r.handle===null;this.device=t,this.gl=t.gl,this.handle=this.props.handle||n?this.props.handle:this.gl.createFramebuffer(),n||(t.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}updateAttachments(){let t=this.gl.bindFramebuffer(36160,this.handle);for(let r=0;r<this.colorAttachments.length;++r){let n=this.colorAttachments[r];if(n){let i=36064+r;this._attachTextureView(i,n)}}if(this.depthStencilAttachment){let r=Z9(this.depthStencilAttachment.props.format);this._attachTextureView(r,this.depthStencilAttachment)}if(this.device.props.debug){let r=this.gl.checkFramebufferStatus(36160);if(r!==36053)throw new Error(`Framebuffer ${Hdt(r)}`)}this.gl.bindFramebuffer(36160,t)}_attachTextureView(t,r){let{gl:n}=this.device,{texture:i}=r,o=r.props.baseMipLevel,s=r.props.baseArrayLayer;switch(n.bindTexture(i.glTarget,i.handle),i.glTarget){case 35866:case 32879:n.framebufferTextureLayer(36160,t,i.handle,o,s);break;case 34067:let c=jdt(s);n.framebufferTexture2D(36160,t,c,i.handle,o);break;case 3553:n.framebufferTexture2D(36160,t,3553,i.handle,o);break;default:throw new Error("Illegal texture type")}n.bindTexture(i.glTarget,null)}};function jdt(e){return e<34069?e+34069:e}function Hdt(e){switch(e){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${e}`}}var JE=class extends b_{device;format="rgba8unorm";depthStencilFormat="depth24plus";presentationSize;_framebuffer=null;get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor(t,r){super(r),this.device=t,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new Nf(this.device,{handle:null}),this._framebuffer}update(){let t=this.getPixelSize();(t[0]!==this.presentationSize[0]||t[1]!==this.presentationSize[1])&&(this.presentationSize=t,this.resize())}resize(t){if(this.device.gl&&this.canvas){let r=this.getDevicePixelRatio(t?.useDevicePixels);this.setDevicePixelRatio(r,t);return}}commit(){}};async function tM(e,t){let r=document.getElementsByTagName("head")[0];if(!r)throw new Error("loadScript");let n=document.createElement("script");return n.setAttribute("type","text/javascript"),n.setAttribute("src",e),t&&(n.id=t),new Promise((i,o)=>{n.onload=i,n.onerror=s=>o(new Error(`Unable to load script '${e}': ${s}`)),r.appendChild(n)})}var Wdt=1,au=null,Q9=!1,eM={debugSpectorJS:qe.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};async function J9(e){if(!globalThis.SPECTOR)try{await tM(e.debugSpectorJSUrl||eM.debugSpectorJSUrl)}catch(t){qe.warn(String(t))}}function t7(e){if(e={...eM,...e},!e.debugSpectorJS)return null;if(!au&&globalThis.SPECTOR&&!globalThis.luma?.spector){qe.probe(Wdt,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();let{Spector:t}=globalThis.SPECTOR;au=new t,globalThis.luma&&(globalThis.luma.spector=au)}if(!au)return null;if(Q9||(Q9=!0,au.spyCanvases(),au?.onCaptureStarted.add(t=>qe.info("Spector capture started:",t)()),au?.onCapture.add(t=>{qe.info("Spector capture complete:",t)(),au?.getResultUI(),au?.resultView.display(),au?.resultView.addCapture(t)})),e.gl){let t=e.gl,r=t.device;au?.startCapture(e.gl,500),t.device=r,new Promise(n=>setTimeout(n,2e3)).then(n=>{qe.info("Spector capture stopped after 2 seconds")(),au?.stopCapture()})}return au}var qdt="https://unpkg.com/webgl-debug@2.0.1/index.js";function r7(e){return e.luma=e.luma||{},e.luma}async function n7(){ul()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await tM(qdt))}function i7(e,t={}){return t.debugWebGL||t.traceWebGL?Xdt(e,t):Gdt(e)}function Gdt(e){let t=r7(e);return t.realContext?t.realContext:e}function Xdt(e,t){if(!globalThis.WebGLDebugUtils)return qe.warn("webgl-debug not loaded")(),e;let r=r7(e);if(r.debugContext)return r.debugContext;globalThis.WebGLDebugUtils.init({...Of,...e});let n=globalThis.WebGLDebugUtils.makeDebugContext(e,Ydt.bind(null,t),Kdt.bind(null,t));for(let s in Of)!(s in n)&&typeof Of[s]=="number"&&(n[s]=Of[s]);class i{}Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.setPrototypeOf(i,n);let o=Object.create(i);return r.realContext=e,r.debugContext=o,o.debug=!0,o}function e7(e,t){t=Array.from(t).map(n=>n===void 0?"undefined":n);let r=globalThis.WebGLDebugUtils.glFunctionArgsToString(e,t);return r=`${r.slice(0,100)}${r.length>100?"...":""}`,`gl.${e}(${r})`}function Ydt(e,t,r,n){n=Array.from(n).map(c=>c===void 0?"undefined":c);let i=globalThis.WebGLDebugUtils.glEnumToString(t),o=globalThis.WebGLDebugUtils.glFunctionArgsToString(r,n),s=`${i} in gl.${r}(${o})`;qe.error(s)();debugger}function Kdt(e,t,r){let n="";qe.level>=1&&(n=e7(t,r),e.traceWebGL&&qe.log(1,n)());for(let i of r)if(i===void 0){n=n||e7(t,r);debugger}}var IO={};function o7(e="id"){IO[e]=IO[e]||1;let t=IO[e]++;return`${e}-${t}`}var Ch=class extends Vn{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength;bytesUsed;constructor(t,r={}){super(t,r),this.device=t,this.gl=this.device.gl;let n=typeof r=="object"?r.handle:void 0;this.handle=n||this.gl.createBuffer(),t.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=Zdt(this.props.usage),this.glUsage=$dt(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,r.data?this._initWithData(r.data,r.byteOffset,r.byteLength):this._initWithByteLength(r.byteLength||0)}_initWithData(t,r=0,n=t.byteLength+r){let i=this.glTarget;this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.glUsage),this.gl.bufferSubData(i,r,t),this.gl.bindBuffer(i,null),this.bytesUsed=n,this.byteLength=n,this._setDebugData(t,r,n),this.trackAllocatedMemory(n)}_initWithByteLength(t){let r=t;t===0&&(r=new Float32Array(0));let n=this.glTarget;return this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,r,this.glUsage),this.gl.bindBuffer(n,null),this.bytesUsed=t,this.byteLength=t,this._setDebugData(null,0,t),this.trackAllocatedMemory(t),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(t,r=0){this.gl.bindBuffer(36663,this.handle),this.gl.bufferSubData(36663,r,t),this.gl.bindBuffer(36663,null),this._setDebugData(t,r,t.byteLength)}async readAsync(t=0,r){return this.readSyncWebGL(t,r)}readSyncWebGL(t=0,r){r=r??this.byteLength-t;let n=new Uint8Array(r),i=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,n,i,r),this.gl.bindBuffer(36662,null),this._setDebugData(n,t,r),n}};function Zdt(e){return e&Vn.INDEX?34963:e&Vn.VERTEX?34962:e&Vn.UNIFORM?35345:34962}function $dt(e){return e&Vn.INDEX||e&Vn.VERTEX?35044:e&Vn.UNIFORM?35048:35044}function a7(e){let t=e.split(/\r?\n/),r=[];for(let n of t){if(n.length<=1)continue;let i=n.split(":");if(i.length===2){let[x,w]=i;r.push({message:w.trim(),type:s7(x),lineNum:0,linePos:0});continue}let[o,s,c,...l]=i,h=parseInt(c,10);isNaN(h)&&(h=0);let p=parseInt(s,10);isNaN(p)&&(p=0),r.push({message:l.join(":").trim(),type:s7(o),lineNum:h,linePos:p})}return r}function s7(e){let t=["warning","error","info"],r=e.toLowerCase();return t.includes(r)?r:"info"}var rM=class extends em{device;handle;constructor(t,r){switch(super(t,r),this.device=t,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>this.compilationStatus)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){let t=this.device.gl.getShaderInfoLog(this.handle);return t?a7(t):[]}getTranslatedSource(){return this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders?.getTranslatedShaderSource(this.handle)||null}async _compile(t){t=t.startsWith("#version ")?t:`#version 300 es
${t}`;let{gl:r}=this.device;if(r.shaderSource(this.handle,t),r.compileShader(this.handle),!this.device.props.debug){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}qe.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),qe.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){let t=async i=>await new Promise(o=>setTimeout(o,i));if(!this.device.features.has("compilation-status-async-webgl")){await t(10);return}let{gl:n}=this.device;for(;;){if(n.getShaderParameter(this.handle,37297))return;await t(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}};function l7(e,t,r,n){if(emt(t))return n(e);let i=e;i.pushState();try{return Qdt(e,t),Mh(i.gl,r),n(e)}finally{i.popState()}}function Qdt(e,t){let r=e,{gl:n}=r;if(t.cullMode)switch(t.cullMode){case"none":n.disable(2884);break;case"front":n.enable(2884),n.cullFace(1028);break;case"back":n.enable(2884),n.cullFace(1029);break}if(t.frontFace&&n.frontFace(XA("frontFace",t.frontFace,{ccw:2305,cw:2304})),t.unclippedDepth&&e.features.has("depth-clip-control")&&n.enable(34383),t.depthBias!==void 0&&(n.enable(32823),n.polygonOffset(t.depthBias,t.depthBiasSlopeScale||0)),t.provokingVertex&&e.features.has("provoking-vertex-webgl")){let o=r.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,s=XA("provokingVertex",t.provokingVertex,{first:36429,last:36430});o?.provokingVertexWEBGL(s)}if((t.polygonMode||t.polygonOffsetLine)&&e.features.has("polygon-mode-webgl")){if(t.polygonMode){let o=r.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,s=XA("polygonMode",t.polygonMode,{fill:6914,line:6913});o?.polygonModeWEBGL(1028,s),o?.polygonModeWEBGL(1029,s)}t.polygonOffsetLine&&n.enable(10754)}if(e.features.has("shader-clip-cull-distance-webgl")&&(t.clipDistance0&&n.enable(12288),t.clipDistance1&&n.enable(12289),t.clipDistance2&&n.enable(12290),t.clipDistance3&&n.enable(12291),t.clipDistance4&&n.enable(12292),t.clipDistance5&&n.enable(12293),t.clipDistance6&&n.enable(12294),t.clipDistance7&&n.enable(12295)),t.depthWriteEnabled!==void 0&&n.depthMask(tmt("depthWriteEnabled",t.depthWriteEnabled)),t.depthCompare&&(t.depthCompare!=="always"?n.enable(2929):n.disable(2929),n.depthFunc(iM("depthCompare",t.depthCompare))),t.stencilWriteMask){let i=t.stencilWriteMask;n.stencilMaskSeparate(1028,i),n.stencilMaskSeparate(1029,i)}if(t.stencilReadMask&&qe.warn("stencilReadMask not supported under WebGL"),t.stencilCompare){let i=t.stencilReadMask||4294967295,o=iM("depthCompare",t.stencilCompare);t.stencilCompare!=="always"?n.enable(2960):n.disable(2960),n.stencilFuncSeparate(1028,o,0,i),n.stencilFuncSeparate(1029,o,0,i)}if(t.stencilPassOperation&&t.stencilFailOperation&&t.stencilDepthFailOperation){let i=RO("stencilPassOperation",t.stencilPassOperation),o=RO("stencilFailOperation",t.stencilFailOperation),s=RO("stencilDepthFailOperation",t.stencilDepthFailOperation);n.stencilOpSeparate(1028,o,s,i),n.stencilOpSeparate(1029,o,s,i)}switch(t.blend){case!0:n.enable(3042);break;case!1:n.disable(3042);break;default:}if(t.blendColorOperation||t.blendAlphaOperation){let i=c7("blendColorOperation",t.blendColorOperation||"add"),o=c7("blendAlphaOperation",t.blendAlphaOperation||"add");n.blendEquationSeparate(i,o);let s=nM("blendColorSrcFactor",t.blendColorSrcFactor||"one"),c=nM("blendColorDstFactor",t.blendColorDstFactor||"zero"),l=nM("blendAlphaSrcFactor",t.blendAlphaSrcFactor||"one"),h=nM("blendAlphaDstFactor",t.blendAlphaDstFactor||"zero");n.blendFuncSeparate(s,c,l,h)}}function iM(e,t){return XA(e,t,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function RO(e,t){return XA(e,t,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function c7(e,t){return XA(e,t,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function nM(e,t){return XA(e,t,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function Jdt(e,t){return`Illegal parameter ${t} for ${e}`}function XA(e,t,r){if(!(t in r))throw new Error(Jdt(e,t));return r[t]}function tmt(e,t){return t}function emt(e){let t=!0;for(let r in e){t=!1;break}return t}function oM(e){let t={};return e.addressModeU&&(t[10242]=LO(e.addressModeU)),e.addressModeV&&(t[10243]=LO(e.addressModeV)),e.addressModeW&&(t[32882]=LO(e.addressModeW)),e.magFilter&&(t[10240]=OO(e.magFilter)),(e.minFilter||e.mipmapFilter)&&(t[10241]=rmt(e.minFilter||"linear",e.mipmapFilter)),e.lodMinClamp!==void 0&&(t[33082]=e.lodMinClamp),e.lodMaxClamp!==void 0&&(t[33083]=e.lodMaxClamp),e.type==="comparison-sampler"&&(t[34892]=34894),e.compare&&(t[34893]=iM("compare",e.compare)),e.maxAnisotropy&&(t[34046]=e.maxAnisotropy),t}function LO(e){switch(e){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function OO(e){switch(e){case"nearest":return 9728;case"linear":return 9729}}function rmt(e,t="none"){if(!t)return OO(e);switch(t){case"none":return OO(e);case"nearest":return e==="nearest"?9984:9986;case"linear":return e==="nearest"?9985:9987}}var YA=class extends rm{device;handle;parameters;constructor(t,r){super(t,r),this.device=t,this.parameters=oM(r),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(t){for(let[r,n]of Object.entries(t)){let i=Number(r);switch(i){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,i,n);break;default:this.device.gl.samplerParameteri(this.handle,i,n);break}}}};var kf=class extends tm{device;gl;handle;texture;constructor(t,r){super(t,{...fi.defaultProps,...r}),this.device=t,this.gl=this.device.gl,this.handle=null,this.texture=r.texture}};var nmt="Failed to deduce GL constant from typed array";function u7(e){switch(ArrayBuffer.isView(e)?e.constructor:e){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(nmt)}}function h7(e,t){let{clamped:r=!0}=t||{};switch(e){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return r?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function BO(e){switch(e){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function f7(e){switch(e){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}function KA(e,t,r){if(imt(t))return r(e);let{nocatch:n=!0}=t,i=Sh.get(e);i.push(),Mh(e,t);let o;if(n)o=r(e),i.pop();else try{o=r(e)}finally{i.pop()}return o}function imt(e){for(let t in e)return!1;return!0}function p7(e,t,r){let{dimension:n,width:i,height:o,depth:s=0}=r,{glInternalFormat:c}=r,l=r.glTarget;switch(n){case"2d-array":case"3d":e.texStorage3D(l,t,c,i,o,s);break;default:e.texStorage2D(l,t,c,i,o)}}function DO(e,t,r,n){let{width:i,height:o}=n,{dimension:s,depth:c=0,mipLevel:l=0}=n,{x:h=0,y:p=0,z:x=0}=n,{glFormat:w,glType:E}=n,P=m7(n.glTarget,s,c),B=n.flipY?{[37440]:!0}:{};KA(e,B,()=>{switch(s){case"2d-array":case"3d":e.bindTexture(P,t),e.texSubImage3D(P,l,h,p,x,i,o,c,w,E,r),e.bindTexture(P,null);break;case"2d":case"cube":e.bindTexture(P,t),e.texSubImage2D(P,l,h,p,i,o,w,E,r),e.bindTexture(P,null);break;default:throw new Error(s)}})}function NO(e,t,r){let{dimension:n,width:i,height:o,depth:s=0,mipLevel:c=0,byteOffset:l=0}=r,{x:h=0,y:p=0,z:x=0}=r,{glFormat:w,glType:E,compressed:P}=r,B=m7(r.glTarget,n,s);switch(n){case"2d-array":case"3d":P?e.compressedTexSubImage3D(B,c,h,p,x,i,o,s,w,t,l):e.texSubImage3D(B,c,h,p,x,i,o,s,w,E,t,l);break;case"2d":case"cube":P?e.compressedTexSubImage2D(B,c,h,p,i,o,w,t,l):e.texSubImage2D(B,c,h,p,i,o,w,E,t,l);break;default:throw new Error(n)}}function d7(e){switch(e){case"1d":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866;case"cube-array":break}throw new Error(e)}function m7(e,t,r){return t==="cube"?34069+r:e}function A7(e,t){let{sourceX:r=0,sourceY:n=0,sourceAttachment:i=0}=t||{},{target:o=null,sourceWidth:s,sourceHeight:c,sourceDepth:l,sourceFormat:h,sourceType:p}=t||{},{framebuffer:x,deleteFramebuffer:w}=_7(e),{gl:E,handle:P}=x;s||=x.width,c||=x.height;let B=x.colorAttachments[i]?.texture;if(!B)throw new Error(`Invalid framebuffer attachment ${i}`);l=B?.depth||1,h||=B?.glFormat||6408,p||=B?.glType||5121,o=smt(o,p,h,s,c,l),p=p||u7(o);let D=E.bindFramebuffer(36160,P);return E.readBuffer(36064+i),E.readPixels(r,n,s,c,h,p,o),E.readBuffer(36064),E.bindFramebuffer(36160,D||null),w&&x.destroy(),o}function g7(e,t){let{target:r,sourceX:n=0,sourceY:i=0,sourceFormat:o=6408,targetByteOffset:s=0}=t||{},{sourceWidth:c,sourceHeight:l,sourceType:h}=t||{},{framebuffer:p,deleteFramebuffer:x}=_7(e);c=c||p.width,l=l||p.height;let w=p;h=h||5121;let E=r;if(!E){let B=BO(o),D=f7(h),W=s+c*l*B*D;E=w.device.createBuffer({byteLength:W})}let P=e.device.createCommandEncoder();return P.copyTextureToBuffer({sourceTexture:e,width:c,height:l,origin:[n,i],destinationBuffer:E,byteOffset:s}),P.destroy(),x&&p.destroy(),E}function _7(e){return e instanceof Lf?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:omt(e),deleteFramebuffer:!0}}function omt(e,t){let{device:r,width:n,height:i,id:o}=e;return r.createFramebuffer({...t,id:`framebuffer-for-${o}`,width:n,height:i,colorAttachments:[e]})}function smt(e,t,r,n,i,o){if(e)return e;t||=5121;let s=h7(t,{clamped:!1}),c=BO(r);return new s(n*i*c)}var Ff=class extends fi{device;gl;handle;sampler=void 0;view=void 0;mipmaps;compressed;glTarget;glFormat;glType;glInternalFormat;textureUnit=0;constructor(t,r){super(t,r);let n={...this.props};n.data=r.data,this.device=t,this.gl=this.device.gl,this.glTarget=d7(this.props.dimension);let i=ZE(this.props.format);this.glInternalFormat=i.internalFormat,this.glFormat=i.format,this.glType=i.type,this.compressed=i.compressed,this.mipmaps=Boolean(this.props.mipmaps),this._initialize(n),Object.seal(this)}_initialize(t){this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:t.data});let{width:r,height:n}=t;if(!r||!n){let i=fi.getTextureDataSize(t.data);r=i?.width||1,n=i?.height||1}if(this.width=r,this.height=n,this.depth=t.depth,this.setSampler(t.sampler),this.view=new kf(this.device,{...this.props,texture:this}),this.bind(),p7(this.gl,this.mipLevels,this),t.data)switch(t.dimension){case"1d":this.setTexture1DData(t.data);break;case"2d":this.setTexture2DData(t.data);break;case"3d":this.setTexture3DData(t.data);break;case"cube":this.setTextureCubeData(t.data);break;case"2d-array":this.setTextureArrayData(t.data);break;case"cube-array":this.setTextureCubeArrayData(t.data);break;default:throw new Error(t.dimension)}this.mipmaps&&this.generateMipmap()}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(t){return new kf(this.device,{...t,texture:this})}setSampler(t={}){let r;t instanceof YA?(this.sampler=t,r=t.props):(this.sampler=new YA(this.device,t),r=t);let n=oM(r);this._setSamplerParameters(n)}generateMipmap(t){if(!(!(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format))&&(qe.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),!t?.force)))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(n){qe.warn(`Error generating mipmap for ${this}: ${n.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}copyExternalImage(t){let r=fi.getExternalImageSize(t.image),n={...fi.defaultCopyExternalImageOptions,...r,...t},{image:i,depth:o,mipLevel:s,x:c,y:l,z:h,flipY:p}=n,{width:x,height:w}=n,{dimension:E,glTarget:P,glFormat:B,glInternalFormat:D,glType:W}=this;if(x=Math.min(x,this.width-c),w=Math.min(w,this.height-l),t.sourceX||t.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");return DO(this.device.gl,this.handle,i,{dimension:E,mipLevel:s,x:c,y:l,z:h,width:x,height:w,depth:o,glFormat:B,glInternalFormat:D,glType:W,glTarget:P,flipY:p}),{width:n.width,height:n.height}}setTexture1DData(t){throw new Error("setTexture1DData not supported in WebGL.")}setTexture2DData(t,r=0){this.bind();let n=fi.normalizeTextureData(t,this);n.length>1&&this.props.mipmaps!==!1&&qe.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let i=0;i<n.length;i++){let o=n[i];this._setMipLevel(r,i,o)}this.unbind()}setTexture3DData(t){if(this.props.dimension!=="3d")throw new Error(this.id);ArrayBuffer.isView(t)&&(this.bind(),NO(this.device.gl,t,this),this.unbind())}setTextureCubeData(t,r=0){if(this.props.dimension!=="cube")throw new Error(this.id);for(let n of fi.CubeFaces)this.setTextureCubeFaceData(t[n],n)}setTextureArrayData(t){throw this.props.dimension!=="2d-array"?new Error(this.id):new Error("setTextureArrayData not implemented.")}setTextureCubeArrayData(t){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}setTextureCubeFaceData(t,r,n=0){Array.isArray(t)&&t.length>1&&this.props.mipmaps!==!1&&qe.warn(`${this.id} has mipmap and multiple LODs.`)();let i=fi.CubeFaces.indexOf(r);this.setTexture2DData(t,i)}update(){throw new Error("Texture.update() not implemented. Use ExternalTexture")}setImageDataForFace(t){let{face:r,width:n,height:i,pixels:o,data:s,format:c=6408,type:l=5121}=t,{gl:h}=this,p=o||s;this.bind(),p instanceof Promise?p.then(x=>this.setImageDataForFace(Object.assign({},t,{face:r,data:x,pixels:x}))):this.width||this.height?h.texImage2D(r,0,c,n,i,0,c,l,p):h.texImage2D(r,0,c,c,l,p)}_getImageDataMap(t){for(let r=0;r<fi.CubeFaces.length;++r){let n=fi.CubeFaces[r];t[n]&&(t[34069+r]=t[n],delete t[n])}return t}_setSamplerParameters(t){qe.log(1,`${this.id} sampler parameters`,this.device.getGLKeys(t))(),this.gl.bindTexture(this.glTarget,this.handle);for(let[r,n]of Object.entries(t)){let i=Number(r),o=n;switch(i){case 33082:case 33083:this.gl.texParameterf(this.glTarget,i,o);break;case 10241:this.gl.texParameteri(this.glTarget,i,o);break;case 10242:case 10243:this.gl.texParameteri(this.glTarget,i,o);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,i,o);break;default:this.gl.texParameteri(this.glTarget,i,o);break}}this.gl.bindTexture(this.glTarget,null)}_setMipLevel(t,r,n,i=this.glTarget){if(fi.isExternalImage(n)){DO(this.device.gl,this.handle,n,{...this,depth:t,mipLevel:r,glTarget:i,flipY:this.props.flipY});return}if(fi.isTextureLevelData(n)){NO(this.device.gl,n.data,{...this,depth:t,mipLevel:r,glTarget:i});return}throw new Error("Texture: invalid image data")}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(t){let{gl:r}=this;return t!==void 0&&(this.textureUnit=t,r.activeTexture(33984+t)),r.bindTexture(this.glTarget,this.handle),t}unbind(t){let{gl:r}=this;return t!==void 0&&(this.textureUnit=t,r.activeTexture(33984+t)),r.bindTexture(this.glTarget,null),t}};var amt=[1,2,4,8],sM=class extends kp{device;glParameters;constructor(t,r){super(t,r),this.device=t;let n;if(!r?.parameters?.viewport)if(r?.framebuffer){let{width:i,height:o}=r.framebuffer;n=[0,0,i,o]}else{let[i,o]=t.getCanvasContext().getDrawingBufferSize();n=[0,0,i,o]}if(this.device.pushState(),this.setParameters({viewport:n,...this.props.parameters}),this.props.framebuffer){let i=this.props.framebuffer.colorAttachments.map((o,s)=>36064+s);this.device.gl.drawBuffers(i)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(t){}popDebugGroup(){}insertDebugMarker(t){}setParameters(t={}){let r={...this.glParameters};r.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(r.depthMask=!this.props.depthReadOnly),r.stencilMask=this.props.stencilReadOnly?0:1,r[35977]=this.props.discard,t.viewport&&(t.viewport.length>=6?(r.viewport=t.viewport.slice(0,4),r.depthRange=[t.viewport[4],t.viewport[5]]):r.viewport=t.viewport),t.scissorRect&&(r.scissorTest=!0,r.scissor=t.scissorRect),t.blendConstant&&(r.blendColor=t.blendConstant),t.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),t[2967]=t.stencilReference),t.colorMask&&(r.colorMask=amt.map(n=>Boolean(n&t.colorMask))),this.glParameters=r,Mh(this.device.gl,r)}beginOcclusionQuery(t){this.props.occlusionQuerySet?.beginOcclusionQuery()}endOcclusionQuery(){this.props.occlusionQuerySet?.endOcclusionQuery()}clear(){let t={...this.glParameters},r=0;this.props.clearColors&&this.props.clearColors.forEach((n,i)=>{n&&this.clearColorBuffer(i,n)}),this.props.clearColor!==!1&&this.props.clearColors===void 0&&(r|=16384,t.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(r|=256,t.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(r|=1024,t.clearStencil=this.props.clearStencil),r!==0&&KA(this.device.gl,t,()=>{this.device.gl.clear(r)})}clearColorBuffer(t=0,r=[0,0,0,0]){KA(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(r.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,t,r);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,t,r);break;case Float32Array:this.device.gl.clearBufferfv(6144,t,r);break;default:throw new Error("clearColorBuffer: color must be typed array")}})}};function y7(e){return cmt.includes(e)}var cmt=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],x7={[5126]:[5126,1,"float","f32","float32"],[35664]:[5126,2,"vec2","vec2<f32>","float32x2"],[35665]:[5126,3,"vec3","vec3<f32>","float32x3"],[35666]:[5126,4,"vec4","vec4<f32>","float32x4"],[5124]:[5124,1,"int","i32","sint32"],[35667]:[5124,2,"ivec2","vec2<i32>","sint32x2"],[35668]:[5124,3,"ivec3","vec3<i32>","sint32x3"],[35669]:[5124,4,"ivec4","vec4<i32>","sint32x4"],[5125]:[5125,1,"uint","u32","uint32"],[36294]:[5125,2,"uvec2","vec2<u32>","uint32x2"],[36295]:[5125,3,"uvec3","vec3<u32>","uint32x3"],[36296]:[5125,4,"uvec4","vec4<u32>","uint32x4"],[35670]:[5126,1,"bool","f32","float32"],[35671]:[5126,2,"bvec2","vec2<f32>","float32x2"],[35672]:[5126,3,"bvec3","vec3<f32>","float32x3"],[35673]:[5126,4,"bvec4","vec4<f32>","float32x4"],[35674]:[5126,8,"mat2","mat2x2<f32>"],[35685]:[5126,8,"mat2x3","mat2x3<f32>"],[35686]:[5126,8,"mat2x4","mat2x4<f32>"],[35687]:[5126,12,"mat3x2","mat3x2<f32>"],[35675]:[5126,12,"mat3","mat3x3<f32>"],[35688]:[5126,12,"mat3x4","mat3x4<f32>"],[35689]:[5126,16,"mat4x2","mat4x2<f32>"],[35690]:[5126,16,"mat4x3","mat4x3<f32>"],[35676]:[5126,16,"mat4","mat4x4<f32>"]};function kO(e){let t=x7[e];if(!t)throw new Error("uniform");let[r,n,,i]=t;return{format:i,components:n,glType:r}}function v7(e){let t=x7[e];if(!t)throw new Error("attribute");let[,r,,n,i]=t;return{attributeType:n,vertexFormat:i,components:r}}function b7(e,t){let r={attributes:[],bindings:[]};r.attributes=lmt(e,t);let n=fmt(e,t);for(let c of n){let l=c.uniforms.map(h=>({name:h.name,format:h.format,byteOffset:h.byteOffset,byteStride:h.byteStride,arrayLength:h.arrayLength}));r.bindings.push({type:"uniform",name:c.name,group:0,location:c.location,visibility:(c.vertex?1:0)&(c.fragment?2:0),minBindingSize:c.byteLength,uniforms:l})}let i=hmt(e,t),o=0;for(let c of i)if(y7(c.type)){let{viewDimension:l,sampleType:h}=dmt(c.type);r.bindings.push({type:"texture",name:c.name,group:0,location:o,viewDimension:l,sampleType:h}),c.textureUnit=o,o+=1}i.length&&(r.uniforms=i);let s=umt(e,t);return s?.length&&(r.varyings=s),r}function lmt(e,t){let r=[],n=e.getProgramParameter(t,35721);for(let i=0;i<n;i++){let o=e.getActiveAttrib(t,i);if(!o)throw new Error("activeInfo");let{name:s,type:c}=o,l=e.getAttribLocation(t,s);if(l>=0){let{attributeType:h}=v7(c),p=/instance/i.test(s)?"instance":"vertex";r.push({name:s,location:l,stepMode:p,type:h})}}return r.sort((i,o)=>i.location-o.location),r}function umt(e,t){let r=[],n=e.getProgramParameter(t,35971);for(let i=0;i<n;i++){let o=e.getTransformFeedbackVarying(t,i);if(!o)throw new Error("activeInfo");let{name:s,type:c,size:l}=o,{glType:h,components:p}=kO(c),x={location:i,name:s,type:h,size:l*p};r.push(x)}return r.sort((i,o)=>i.location-o.location),r}function hmt(e,t){let r=[],n=e.getProgramParameter(t,35718);for(let i=0;i<n;i++){let o=e.getActiveUniform(t,i);if(!o)throw new Error("activeInfo");let{name:s,size:c,type:l}=o,{name:h,isArray:p}=mmt(s),x=e.getUniformLocation(t,h),w={location:x,name:h,size:c,type:l,isArray:p};if(r.push(w),w.size>1)for(let E=0;E<w.size;E++){let P=`${h}[${E}]`;x=e.getUniformLocation(t,P);let B={...w,name:P,location:x};r.push(B)}}return r}function fmt(e,t){let r=(o,s)=>e.getActiveUniformBlockParameter(t,o,s),n=[],i=e.getProgramParameter(t,35382);for(let o=0;o<i;o++){let s={name:e.getActiveUniformBlockName(t,o)||"",location:r(o,35391),byteLength:r(o,35392),vertex:r(o,35396),fragment:r(o,35398),uniformCount:r(o,35394),uniforms:[]},c=r(o,35395)||[],l=e.getActiveUniforms(t,c,35383),h=e.getActiveUniforms(t,c,35384),p=e.getActiveUniforms(t,c,35387),x=e.getActiveUniforms(t,c,35388);for(let w=0;w<s.uniformCount;++w){let E=e.getActiveUniform(t,c[w]);if(!E)throw new Error("activeInfo");s.uniforms.push({name:E.name,format:kO(l[w]).format,type:l[w],arrayLength:h[w],byteOffset:p[w],byteStride:x[w]})}n.push(s)}return n.sort((o,s)=>o.location-s.location),n}var pmt={[35678]:["2d","float"],[35680]:["cube","float"],[35679]:["3d","float"],[35682]:["3d","depth"],[36289]:["2d-array","float"],[36292]:["2d-array","depth"],[36293]:["cube","float"],[36298]:["2d","sint"],[36299]:["3d","sint"],[36300]:["cube","sint"],[36303]:["2d-array","uint"],[36306]:["2d","uint"],[36307]:["3d","uint"],[36308]:["cube","uint"],[36311]:["2d-array","uint"]};function dmt(e){let t=pmt[e];if(!t)throw new Error("sampler");let[r,n]=t;return{viewDimension:r,sampleType:n}}function mmt(e){if(e[e.length-1]!=="]")return{name:e,length:1,isArray:!1};let r=/([^[]*)(\[[0-9]+\])?/.exec(e);if(!r||r.length<2)throw new Error(`Failed to parse GLSL uniform name ${e}`);return{name:r[1],length:r[2]?1:0,isArray:Boolean(r[2])}}function w7(e,t,r,n){let i=e,o=n;o===!0&&(o=1),o===!1&&(o=0);let s=typeof o=="number"?[o]:o;switch(r){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof n!="number")throw new Error("samplers must be set to integers");return e.uniform1i(t,n);case 5126:return e.uniform1fv(t,s);case 35664:return e.uniform2fv(t,s);case 35665:return e.uniform3fv(t,s);case 35666:return e.uniform4fv(t,s);case 5124:return e.uniform1iv(t,s);case 35667:return e.uniform2iv(t,s);case 35668:return e.uniform3iv(t,s);case 35669:return e.uniform4iv(t,s);case 35670:return e.uniform1iv(t,s);case 35671:return e.uniform2iv(t,s);case 35672:return e.uniform3iv(t,s);case 35673:return e.uniform4iv(t,s);case 5125:return i.uniform1uiv(t,s,1);case 36294:return i.uniform2uiv(t,s,2);case 36295:return i.uniform3uiv(t,s,3);case 36296:return i.uniform4uiv(t,s,4);case 35674:return e.uniformMatrix2fv(t,!1,s);case 35675:return e.uniformMatrix3fv(t,!1,s);case 35676:return e.uniformMatrix4fv(t,!1,s);case 35685:return i.uniformMatrix2x3fv(t,!1,s);case 35686:return i.uniformMatrix2x4fv(t,!1,s);case 35687:return i.uniformMatrix3x2fv(t,!1,s);case 35688:return i.uniformMatrix3x4fv(t,!1,s);case 35689:return i.uniformMatrix4x2fv(t,!1,s);case 35690:return i.uniformMatrix4x3fv(t,!1,s)}throw new Error("Illegal uniform")}function T7(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function E7(e){return Array.isArray(e)?e.length===0||typeof e[0]=="number":!1}function Rv(e){return T7(e)||E7(e)}function Amt(e){return Rv(e)!==null||typeof e=="number"||typeof e=="boolean"}function M7(e){let t={bindings:{},uniforms:{}};return Object.keys(e).forEach(r=>{let n=e[r];Amt(n)?t.uniforms[r]=n:t.bindings[r]=n}),t}function S7(e){switch(e){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(e)}}function C7(e){switch(e){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;default:throw new Error(e)}}var P7=4,aM=class extends Eh{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};constructor(t,r){super(t,r),this.device=t,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=r.vs,this.fs=r.fs;let{varyings:n,bufferMode:i=35981}=r;n&&n.length>0&&(this.varyings=n,this.device.gl.transformFeedbackVaryings(this.handle,n,i)),this._linkShaders(),qe.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=b7(this.device.gl,this.handle),qe.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=gmt(this.introspectedLayout,r.shaderLayout)}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(t,r){for(let[n,i]of Object.entries(t)){let o=this.shaderLayout.bindings.find(s=>s.name===n)||this.shaderLayout.bindings.find(s=>s.name===`${n}Uniforms`);if(!o){let s=this.shaderLayout.bindings.map(c=>`"${c.name}"`).join(", ");r?.disableWarnings||qe.warn(`No binding "${n}" in render pipeline "${this.id}", expected one of ${s}`,i)();continue}switch(i||qe.warn(`Unsetting binding "${n}" in render pipeline "${this.id}"`)(),o.type){case"uniform":if(!(i instanceof Ch)&&!(i.buffer instanceof Ch))throw new Error("buffer value");break;case"texture":if(!(i instanceof kf||i instanceof Ff||i instanceof Nf))throw new Error("texture value");break;case"sampler":qe.warn(`Ignoring sampler ${n}`)();break;default:throw new Error(o.type)}this.bindings[n]=i}}draw(t){let{renderPass:r,parameters:n=this.props.parameters,topology:i=this.props.topology,vertexArray:o,vertexCount:s,instanceCount:c,isInstanced:l=!1,firstVertex:h=0,transformFeedback:p}=t,x=S7(i),w=Boolean(o.indexBuffer),E=o.indexBuffer?.glIndexType;if(this.linkStatus!=="success")return qe.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return qe.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),o.bindBeforeRender(r),p&&p.begin(this.props.topology),this._applyBindings(),this._applyUniforms();let P=r;return l7(this.device,n,P.glParameters,()=>{w&&l?this.device.gl.drawElementsInstanced(x,s||0,E,h,c||0):w?this.device.gl.drawElements(x,s||0,E,h):l?this.device.gl.drawArraysInstanced(x,h,s||0,c||0):this.device.gl.drawArrays(x,h,s||0),p&&p.end()}),o.unbindAfterRender(r),!0}setUniformsWebGL(t){let{bindings:r}=M7(t);Object.keys(r).forEach(n=>{qe.warn(`Unsupported value "${JSON.stringify(r[n])}" used in setUniforms() for key ${n}. Use setBindings() instead?`)()}),Object.assign(this.uniforms,t)}async _linkShaders(){let{gl:t}=this.device;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),qe.time(P7,`linkProgram for ${this.id}`)(),t.linkProgram(this.handle),qe.timeEnd(P7,`linkProgram for ${this.id}`)(),qe.level,!this.device.features.has("compilation-status-async-webgl")){let n=this._getLinkStatus();this._reportLinkStatus(n);return}qe.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),qe.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();let r=this._getLinkStatus();this._reportLinkStatus(r)}async _reportLinkStatus(t){switch(t){case"success":return;default:switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`);case"pending":this.vs.asyncCompilationStatus.then(()=>this.vs.debugShader());break;case"success":break}switch(this.fs?.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`);case"pending":this.fs.asyncCompilationStatus.then(()=>this.fs.debugShader());break;case"success":break}let r=this.device.gl.getProgramInfoLog(this.handle);throw new Error(`Error during ${t}: ${r}`)}}_getLinkStatus(){let{gl:t}=this.device;return t.getProgramParameter(this.handle,35714)?(t.validateProgram(this.handle),t.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")):(this.linkStatus="error","linking")}async _waitForLinkComplete(){let t=async i=>await new Promise(o=>setTimeout(o,i));if(!this.device.features.has("compilation-status-async-webgl")){await t(10);return}let{gl:n}=this.device;for(;;){if(n.getProgramParameter(this.handle,37297))return;await t(10)}}_areTexturesRenderable(){let t=!0;for(let r of this.shaderLayout.bindings)!this.bindings[r.name]&&!this.bindings[r.name.replace(/Uniforms$/,"")]&&(qe.warn(`Binding ${r.name} not found in ${this.id}`)(),t=!1);return t}_applyBindings(){if(this.linkStatus!=="success")return;let{gl:t}=this.device;t.useProgram(this.handle);let r=0,n=0;for(let i of this.shaderLayout.bindings){let o=this.bindings[i.name]||this.bindings[i.name.replace(/Uniforms$/,"")];if(!o)throw new Error(`No value for binding ${i.name} in ${this.id}`);switch(i.type){case"uniform":let{name:s}=i,c=t.getUniformBlockIndex(this.handle,s);if(c===4294967295)throw new Error(`Invalid uniform block name ${s}`);t.uniformBlockBinding(this.handle,n,c),o instanceof Ch?t.bindBufferBase(35345,n,o.handle):t.bindBufferRange(35345,n,o.buffer.handle,o.offset||0,o.size||o.buffer.byteLength-o.offset),n+=1;break;case"texture":if(!(o instanceof kf||o instanceof Ff||o instanceof Nf))throw new Error("texture");let l;if(o instanceof kf)l=o.texture;else if(o instanceof Ff)l=o;else if(o instanceof Nf&&o.colorAttachments[0]instanceof kf)qe.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),l=o.colorAttachments[0].texture;else throw new Error("No texture");t.activeTexture(33984+r),t.bindTexture(l.glTarget,l.handle),r+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${i.type}' not supported in WebGL`)}}}_applyUniforms(){for(let t of this.shaderLayout.uniforms||[]){let{name:r,location:n,type:i,textureUnit:o}=t,s=this.uniforms[r]??o;s!==void 0&&w7(this.device.gl,n,i,s)}}};function gmt(e,t){let r={...e,attributes:e.attributes.map(n=>({...n}))};for(let n of t?.attributes||[]){let i=r.attributes.find(o=>o.name===n.name);i?(i.type=n.type||i.type,i.stepMode=n.stepMode||i.stepMode):qe.warn(`shader layout attribute ${n.name} not present in shader`)}return r}var cM=class extends T_{device;commands=[];constructor(t){super(t,{}),this.device=t}submitCommands(t=this.commands){for(let r of t)switch(r.name){case"copy-buffer-to-buffer":_mt(this.device,r.options);break;case"copy-buffer-to-texture":ymt(this.device,r.options);break;case"copy-texture-to-buffer":xmt(this.device,r.options);break;case"copy-texture-to-texture":vmt(this.device,r.options);break;default:throw new Error(r.name)}}};function _mt(e,t){let r=t.sourceBuffer,n=t.destinationBuffer;e.gl.bindBuffer(36662,r.handle),e.gl.bindBuffer(36663,n.handle),e.gl.copyBufferSubData(36662,36663,t.sourceOffset??0,t.destinationOffset??0,t.size),e.gl.bindBuffer(36662,null),e.gl.bindBuffer(36663,null)}function ymt(e,t){throw new Error("Not implemented")}function xmt(e,t){let{sourceTexture:r,mipLevel:n=0,aspect:i="all",width:o=t.sourceTexture.width,height:s=t.sourceTexture.height,depthOrArrayLayers:c=0,origin:l=[0,0],destinationBuffer:h,byteOffset:p=0,bytesPerRow:x,rowsPerImage:w}=t;if(i!=="all")throw new Error("aspect not supported in WebGL");if(n!==0||c!==0||x||w)throw new Error("not implemented");let{framebuffer:E,destroyFramebuffer:P}=I7(r),B;try{let D=h,W=o||E.width,X=s||E.height,q=ZE(E.colorAttachments[0].texture.props.format),$=q.format,et=q.type;e.gl.bindBuffer(35051,D.handle),B=e.gl.bindFramebuffer(36160,E.handle),e.gl.readPixels(l[0],l[1],W,X,$,et,p)}finally{e.gl.bindBuffer(35051,null),B!==void 0&&e.gl.bindFramebuffer(36160,B),P&&E.destroy()}}function vmt(e,t){let{sourceTexture:r,destinationMipLevel:n=0,origin:i=[0,0],destinationOrigin:o=[0,0],destinationTexture:s}=t,{width:c=t.destinationTexture.width,height:l=t.destinationTexture.height}=t,{framebuffer:h,destroyFramebuffer:p}=I7(r),[x,w]=i,[E,P,B]=o,D=e.gl.bindFramebuffer(36160,h.handle),W=null,X;if(s instanceof Ff)W=s,c=Number.isFinite(c)?c:W.width,l=Number.isFinite(l)?l:W.height,W.bind(0),X=W.glTarget;else throw new Error("invalid destination");switch(X){case 3553:case 34067:e.gl.copyTexSubImage2D(X,n,E,P,x,w,c,l);break;case 35866:case 32879:e.gl.copyTexSubImage3D(X,n,E,P,B,x,w,c,l);break;default:}W&&W.unbind(),e.gl.bindFramebuffer(36160,D),p&&h.destroy()}function I7(e){if(e instanceof fi){let{width:t,height:r,id:n}=e;return{framebuffer:e.device.createFramebuffer({id:`framebuffer-for-${n}`,width:t,height:r,colorAttachments:[e]}),destroyFramebuffer:!0}}return{framebuffer:e,destroyFramebuffer:!1}}var lM=class extends w_{device;commandBuffer;constructor(t,r){super(t,r),this.device=t,this.commandBuffer=new cM(t)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(t){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:t})}copyBufferToTexture(t){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:t})}copyTextureToBuffer(t){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:t})}copyTextureToTexture(t){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:t})}pushDebugGroup(t){}popDebugGroup(){}insertDebugMarker(t){}resolveQuerySet(t,r,n){}};function R7(e){let{target:t,source:r,start:n=0,count:i=1}=e,o=r.length,s=i*o,c=0;for(let l=n;c<o;c++)t[l++]=r[c];for(;c<s;)c<s-c?(t.copyWithin(n+c,n,n+c),c*=2):(t.copyWithin(n+c,n,n+s-c),c=s);return e.target}var R_=class extends E_{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(t){return ML()==="Chrome"}constructor(t,r){super(t,r),this.device=t,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(t){let r=t;if(r&&r.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,r?r.handle:null),this.indexBuffer=r,this.device.gl.bindVertexArray(null)}setBuffer(t,r){let n=r;if(n.glTarget===34963)throw new Error("Use .setIndexBuffer()");let{size:i,type:o,stride:s,offset:c,normalized:l,integer:h,divisor:p}=this._getAccessor(t);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,n.handle),h?this.device.gl.vertexAttribIPointer(t,i,o,s,c):this.device.gl.vertexAttribPointer(t,i,o,l,s,c),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(t),this.device.gl.vertexAttribDivisor(t,p||0),this.attributes[t]=n,this.device.gl.bindVertexArray(null)}setConstantWebGL(t,r){this._enable(t,!1),this.attributes[t]=r}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let t=0;t<this.maxVertexAttributes;++t){let r=this.attributes[t];ArrayBuffer.isView(r)&&this.device.setConstantAttributeWebGL(t,r)}}_getAccessor(t){let r=this.attributeInfos[t];if(!r)throw new Error(`Unknown attribute location ${t}`);let n=YE(r.bufferDataType);return{size:r.bufferComponents,type:n,stride:r.byteStride,offset:r.byteOffset,normalized:r.normalized,integer:r.integer,divisor:r.stepMode==="instance"?1:0}}_enable(t,r=!0){let i=R_.isConstantAttributeZeroSupported(this.device)||t!==0;(r||i)&&(t=Number(t),this.device.gl.bindVertexArray(this.handle),r?this.device.gl.enableVertexAttribArray(t):this.device.gl.disableVertexAttribArray(t),this.device.gl.bindVertexArray(null))}getConstantBuffer(t,r){let n=bmt(r),i=n.byteLength*t,o=n.length*t;if(this.buffer&&i!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${i} !== ${this.buffer.byteLength}.`);let s=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:i}),s=s||!wmt(n,this.bufferValue),s){let c=TO(r.constructor,o);R7({target:c,source:n,start:0,count:o}),this.buffer.write(c),this.bufferValue=r}return this.buffer}};function bmt(e){return Array.isArray(e)?new Float32Array(e):e}function wmt(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}var uM=class extends M_{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(t,r){super(t,r),this.device=t,this.gl=t.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,r.buffers&&this.setBuffers(r.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(t="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(C7(t))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(t){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(let r in t)this.setBuffer(r,t[r])})}setBuffer(t,r){let n=this._getVaryingIndex(t),{buffer:i,byteLength:o,byteOffset:s}=this._getBufferRange(r);if(n<0){this.unusedBuffers[t]=i,qe.warn(`${this.id} unusedBuffers varying buffer ${t}`)();return}this.buffers[n]={buffer:i,byteLength:o,byteOffset:s},this.bindOnUse||this._bindBuffer(n,i,s,o)}getBuffer(t){if(L7(t))return this.buffers[t]||null;let r=this._getVaryingIndex(t);return r>=0?this.buffers[r]:null}bind(t=this.handle){if(typeof t!="function")return this.gl.bindTransformFeedback(36386,t),this;let r;return this._bound?r=t():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,r=t(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),r}unbind(){this.bind(null)}_getBufferRange(t){if(t instanceof Ch)return{buffer:t,byteOffset:0,byteLength:t.byteLength};let{buffer:r,byteOffset:n=0,byteLength:i=t.buffer.byteLength}=t;return{buffer:r,byteOffset:n,byteLength:i}}_getVaryingIndex(t){if(L7(t))return Number(t);for(let r of this.layout.varyings)if(t===r.name)return r.location;return-1}_bindBuffers(){for(let t in this.buffers){let{buffer:r,byteLength:n,byteOffset:i}=this._getBufferRange(this.buffers[t]);this._bindBuffer(Number(t),r,i,n)}}_unbindBuffers(){for(let t in this.buffers)this.gl.bindBufferBase(35982,Number(t),null)}_bindBuffer(t,r,n=0,i){let o=r&&r.handle;!o||i===void 0?this.gl.bindBufferBase(35982,t,o):this.gl.bindBufferRange(35982,t,o,n,i)}};function L7(e){return typeof e=="number"?Number.isInteger(e):/^\d+$/.test(e)}var hM=class extends S_{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(t,r){if(super(t,r),this.device=t,r.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(t){return this._begin(t?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(t){this._queryPending||(this.target=t,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;let t=this.device.gl.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(t=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let r=0;return this._pollingPromise=new Promise((n,i)=>{let o=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):r++>t?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(o)};requestAnimationFrame(o)}),this._pollingPromise}};var Na=class extends Dl{type="webgl";handle;features;limits;info;canvasContext;lost;_resolveContextLost;gl;debug=!1;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};_extensions={};_polyfilled=!1;spectorJS;constructor(t){if(super({...t,id:t.id||o7("webgl-device")}),!t.createCanvasContext)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let r=t.createCanvasContext===!0?{}:t.createCanvasContext,n=r.canvas?.gl?.device;if(n)throw new Error(`WebGL context already attached to device ${n.id}`);this.canvasContext=new JE(this,r),this.lost=new Promise(p=>{this._resolveContextLost=p});let i={...t.webgl};r.alphaMode==="premultiplied"&&(i.premultipliedAlpha=!0),t.powerPreference!==void 0&&(i.powerPreference=t.powerPreference);let s=this.props._handle||j9(this.canvasContext.canvas,{onContextLost:p=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."}),onContextRestored:p=>console.log("WebGL context restored")},i);if(!s)throw new Error("WebGL context creation failed");if(n=s.device,n)throw new Error(`WebGL context already attached to device ${n.id}`);this.handle=s,this.gl=s,this.spectorJS=t7({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=H9(this.gl,this._extensions),this.limits=new QE(this.gl),this.features=new $E(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),r.autoResize!==!1&&this.canvasContext.resize(),new Sh(this.gl,{log:(...p)=>qe.log(1,...p)()}).trackState(this.gl,{copyState:!1});let l=t.debugWebGL||t.debug,h=t.debugWebGL;l&&(this.gl=i7(this.gl,{debugWebGL:l,traceWebGL:h}),qe.warn("WebGL debug mode activated. Performance reduced.")(),t.debugWebGL&&(qe.level=Math.max(qe.level,1)))}destroy(){}get isLost(){return this.gl.isContextLost()}createCanvasContext(t){throw new Error("WebGL only supports a single canvas")}createBuffer(t){let r=this._normalizeBufferProps(t);return new Ch(this,r)}createTexture(t){return new Ff(this,t)}createExternalTexture(t){throw new Error("createExternalTexture() not implemented")}createSampler(t){return new YA(this,t)}createShader(t){return new rM(this,t)}createFramebuffer(t){return new Nf(this,t)}createVertexArray(t){return new R_(this,t)}createTransformFeedback(t){return new uM(this,t)}createQuerySet(t){return new hM(this,t)}createRenderPipeline(t){return new aM(this,t)}beginRenderPass(t){return new sM(this,t)}createComputePipeline(t){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(t){throw new Error("ComputePass not supported in WebGL")}renderPass=null;createCommandEncoder(t={}){return new lM(this,t)}submit(){this.renderPass?.end(),this.renderPass=null}readPixelsToArrayWebGL(t,r){return A7(t,r)}readPixelsToBufferWebGL(t,r){return g7(t,r)}setParametersWebGL(t){Mh(this.gl,t)}getParametersWebGL(t){return XE(this.gl,t)}withParametersWebGL(t,r){return KA(this.gl,t,r)}resetWebGL(){qe.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),z9(this.gl)}_getDeviceSpecificTextureFormatCapabilities(t){return K9(this.gl,t,this._extensions)}loseDevice(){let t=!1,n=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return n&&(t=!0,n.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),t}pushState(){Sh.get(this.gl).push()}popState(){Sh.get(this.gl).pop()}setSpectorMetadata(t,r){t.__SPECTOR_Metadata=r}getGLKey(t,r){let n=Number(t);for(let i in this.gl)if(this.gl[i]===n)return`GL.${i}`;return r?.emptyIfUnknown?"":String(t)}getGLKeys(t){let r={emptyIfUnknown:!0};return Object.entries(t).reduce((n,[i,o])=>(n[`${i}:${this.getGLKey(i,r)}`]=`${o}:${this.getGLKey(o,r)}`,n),{})}_constants;setConstantAttributeWebGL(t,r){let n=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(n).fill(null);let i=this._constants[t];switch(i&&Smt(i,r)&&qe.info(1,`setConstantAttributeWebGL(${t}) could have been skipped, value unchanged`)(),this._constants[t]=r,r.constructor){case Float32Array:Tmt(this,t,r);break;case Int32Array:Emt(this,t,r);break;case Uint32Array:Mmt(this,t,r);break;default:throw new Error("constant")}}getExtension(t){return Df(this.gl,t,this._extensions),this._extensions}};function Tmt(e,t,r){switch(r.length){case 1:e.gl.vertexAttrib1fv(t,r);break;case 2:e.gl.vertexAttrib2fv(t,r);break;case 3:e.gl.vertexAttrib3fv(t,r);break;case 4:e.gl.vertexAttrib4fv(t,r);break;default:}}function Emt(e,t,r){e.gl.vertexAttribI4iv(t,r)}function Mmt(e,t,r){e.gl.vertexAttribI4uiv(t,r)}function Smt(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}var Cmt={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},Pmt=e=>({drawBuffersWEBGL(t){return e.drawBuffers(t)},COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),Imt=e=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES(){return e.createVertexArray()},deleteVertexArrayOES(t){return e.deleteVertexArray(t)},isVertexArrayOES(t){return e.isVertexArray(t)},bindVertexArrayOES(t){return e.bindVertexArray(t)}}),Rmt=e=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(...t){return e.drawArraysInstanced(...t)},drawElementsInstancedANGLE(...t){return e.drawElementsInstanced(...t)},vertexAttribDivisorANGLE(...t){return e.vertexAttribDivisor(...t)}});function O7(e=!0){let t=HTMLCanvasElement.prototype;if(!e&&t.originalGetContext){t.getContext=t.originalGetContext,t.originalGetContext=void 0;return}t.originalGetContext=t.getContext,t.getContext=function(r,n){if(r==="webgl"||r==="experimental-webgl"){let i=this.originalGetContext("webgl2",n);return i instanceof HTMLElement&&Lmt(i),i}return this.originalGetContext(r,n)}}function Lmt(e){e.getExtension("EXT_color_buffer_float");let t={...Cmt,WEBGL_disjoint_timer_query:e.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:Pmt(e),OES_vertex_array_object:Imt(e),ANGLE_instanced_arrays:Rmt(e)},r=e.getExtension;e.getExtension=function(i){let o=r.call(e,i);return o||(i in t?t[i]:null)};let n=e.getSupportedExtensions;e.getSupportedExtensions=function(){return(n.apply(e)||[])?.concat(Object.keys(t))}}var fM=1,FO=class extends Tv{type="webgl";constructor(){super(),Dl.defaultProps={...Dl.defaultProps,...eM},Na.adapter=this}isSupported(){return typeof WebGL2RenderingContext<"u"}enforceWebGL2(t){O7(t)}async attach(t){if(t instanceof Na)return t;if(t?.device instanceof Dl)return t.device;if(!Omt(t))throw new Error("Invalid WebGL2RenderingContext");return new Na({_handle:t,createCanvasContext:{canvas:t.canvas,autoResize:!1}})}async create(t={}){qe.groupCollapsed(fM,"WebGLDevice created")();let r=[];(t.debugWebGL||t.debug)&&r.push(n7()),t.debugSpectorJS&&r.push(J9(t));let n=await Promise.allSettled(r);for(let s of n)s.status==="rejected"&&qe.error(`Failed to initialize debug libraries ${s.reason}`)();let i=new Na(t),o=`Created ${i.type}${i.debug?" debug":""} context: ${i.info.vendor}, ${i.info.renderer} for canvas: ${i.canvasContext.id}`;return qe.probe(fM,o)(),qe.table(fM,i.info)(),qe.groupEnd(fM)(),i}};function Omt(e){return typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?!0:Boolean(e&&Number.isFinite(e._version))}var pM=new FO;var B7,D7,k7={fontFamily:'"Helvetica Neue", Helvetica, Arial, sans-serif',display:"flex",flex:"wrap",maxWidth:"500px",flexDirection:"column",zIndex:2};function dM(){return document.createElement("div")}function Bmt(e){if(!e.picked)return null;if(e.object===B7)return D7;let t={html:Nmt(e.object),style:k7};return D7=t,B7=e.object,t}var Dmt=new Set(["position","index"]);function Nmt(e){let t=dM();for(let r in e){if(Dmt.has(r))continue;let n=dM();n.className="header",n.textContent=r;let i=dM();i.className="value",i.textContent=Fmt(e[r]);let o=dM();kmt(o,n,i),o.appendChild(n),o.appendChild(i),t.appendChild(o)}return t.innerHTML}function kmt(e,t,r){Object.assign(t.style,{fontWeight:700,marginRight:"10px",flex:"1 1 0%"}),Object.assign(r.style,{flex:"none",maxWidth:"250px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}),Object.assign(e.style,{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"stretch"})}function Fmt(e){let t;if(Array.isArray(e)&&e.length>4)t=`Array<${e.length}>`;else if(typeof e=="string")t=e;else if(typeof e=="number")t=String(e);else try{t=JSON.stringify(e)}catch{t="<Non-Serializable Object>"}let r=50;return t.length>r&&(t=t.slice(0,r)),t}function N7(e,t){let r,n=e,i="properties",o=/{[^}]*}/g,s=l=>l.replace(/[{}]/g,""),c=[...new Set(e.match(o).map(s))];for(let l of c){if(l.includes(".")){r=t;let h=l.split(".");for(let p of h)if(r.hasOwnProperty(p))r=r[p];else{r=void 0;break}}else t.hasOwnProperty(l)?r=t[l]:t[i]&&t[i].hasOwnProperty(l)?r=t[i][l]:r=void 0;n=n.replaceAll(`{${l}}`,r)}return n}function zO(e){return e?e.html||e.text?t=>{if(!t.picked)return null;let r={style:e.style||k7};return e.html?r.html=N7(e.html,t.object):r.text=N7(e.text,t.object),r}:Bmt:null}function F7(e){let t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}function z7(e,t){let r=document.createElement("div");return r.style.width=Number.isFinite(e)?`${e}px`:e,r.style.height=`${t}px`,r.style.position="relative",r}var V7=tc(U7()),zmt="https://api.tiles.mapbox.com/mapbox-gl-js/v1.13.2/mapbox-gl.css",jO=V7.default;function j7(e=zmt){F7(e)}function H7(){let e=["mapboxgl-missing-css"];for(let t of e){let r=document.getElementsByClassName(t)[0];r&&r.style&&(r.style.display="none")}}var HO={};function W7(e){if(!HO[e]){let t=document.createElement("script");t.type="text/javascript",t.src=e,document.querySelector("head").appendChild(t),HO[e]=new Promise(n=>{t.onload=n})}return HO[e]}var q7="4.2.1";var Umt=globalThis.loaders?.parseImageNode,WO=typeof Image<"u",qO=typeof ImageBitmap<"u",Vmt=Boolean(Umt),GO=Dp?!0:Vmt;function G7(e){switch(e){case"auto":return qO||WO||GO;case"imagebitmap":return qO;case"image":return WO;case"data":return GO;default:throw new Error(`@loaders.gl/images: image ${e} not supported in this environment`)}}function X7(){if(qO)return"imagebitmap";if(WO)return"image";if(GO)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function Y7(e){let t=jmt(e);if(!t)throw new Error("Not an image");return t}function Lv(e){switch(Y7(e)){case"data":return e;case"image":case"imagebitmap":let t=document.createElement("canvas"),r=t.getContext("2d");if(!r)throw new Error("getImageData");return t.width=e.width,t.height=e.height,r.drawImage(e,0,0),r.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function jmt(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&e instanceof Image?"image":e&&typeof e=="object"&&e.data&&e.width&&e.height?"data":null}var Hmt=/^data:image\/svg\+xml/,Wmt=/\.svg((\?|#).*)?$/;function mM(e){return e&&(Hmt.test(e)||Wmt.test(e))}function K7(e,t){if(mM(t)){let n=new TextDecoder().decode(e);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(n=unescape(encodeURIComponent(n)))}catch(o){throw new Error(o.message)}return`data:image/svg+xml;base64,${btoa(n)}`}return XO(e,t)}function XO(e,t){if(mM(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function AM(e,t,r){let n=K7(e,r),i=self.URL||self.webkitURL,o=typeof n!="string"&&i.createObjectURL(n);try{return await qmt(o||n,t)}finally{o&&i.revokeObjectURL(o)}}async function qmt(e,t){let r=new Image;return r.src=e,t.image&&t.image.decode&&r.decode?(await r.decode(),r):await new Promise((n,i)=>{try{r.onload=()=>n(r),r.onerror=o=>{let s=o instanceof Error?o.message:"error";i(new Error(s))}}catch(o){i(o)}})}var Gmt={},Z7=!0;async function $7(e,t,r){let n;mM(r)?n=await AM(e,t,r):n=XO(e,r);let i=t&&t.imagebitmap;return await Xmt(n,i)}async function Xmt(e,t=null){if((Ymt(t)||!Z7)&&(t=null),t)try{return await createImageBitmap(e,t)}catch(r){console.warn(r),Z7=!1}return await createImageBitmap(e)}function Ymt(e){for(let t in e||Gmt)return!1;return!0}function Q7(e){return!Qmt(e,"ftyp",4)||!(e[8]&96)?null:Kmt(e)}function Kmt(e){switch(Zmt(e,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function Zmt(e,t,r){return String.fromCharCode(...e.slice(t,r))}function $mt(e){return[...e].map(t=>t.charCodeAt(0))}function Qmt(e,t,r=0){let n=$mt(t);for(let i=0;i<n.length;++i)if(n[i]!==e[i+r])return!1;return!0}var zf=!1,Ov=!0;function ZA(e){let t=Bv(e);return tAt(t)||nAt(t)||eAt(t)||rAt(t)||Jmt(t)}function Jmt(e){let t=new Uint8Array(e instanceof DataView?e.buffer:e),r=Q7(t);return r?{mimeType:r.mimeType,width:0,height:0}:null}function tAt(e){let t=Bv(e);return t.byteLength>=24&&t.getUint32(0,zf)===2303741511?{mimeType:"image/png",width:t.getUint32(16,zf),height:t.getUint32(20,zf)}:null}function eAt(e){let t=Bv(e);return t.byteLength>=10&&t.getUint32(0,zf)===1195984440?{mimeType:"image/gif",width:t.getUint16(6,Ov),height:t.getUint16(8,Ov)}:null}function rAt(e){let t=Bv(e);return t.byteLength>=14&&t.getUint16(0,zf)===16973&&t.getUint32(2,Ov)===t.byteLength?{mimeType:"image/bmp",width:t.getUint32(18,Ov),height:t.getUint32(22,Ov)}:null}function nAt(e){let t=Bv(e);if(!(t.byteLength>=3&&t.getUint16(0,zf)===65496&&t.getUint8(2)===255))return null;let{tableMarkers:n,sofMarkers:i}=iAt(),o=2;for(;o+9<t.byteLength;){let s=t.getUint16(o,zf);if(i.has(s))return{mimeType:"image/jpeg",height:t.getUint16(o+5,zf),width:t.getUint16(o+7,zf)};if(!n.has(s))return null;o+=2,o+=t.getUint16(o,zf)}return null}function iAt(){let e=new Set([65499,65476,65484,65501,65534]);for(let r=65504;r<65520;++r)e.add(r);return{tableMarkers:e,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Bv(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}async function J7(e,t){let{mimeType:r}=ZA(e)||{},n=globalThis.loaders?.parseImageNode;return Ti(n),await n(e,r)}async function tj(e,t,r){t=t||{};let i=(t.image||{}).type||"auto",{url:o}=r||{},s=oAt(i),c;switch(s){case"imagebitmap":c=await $7(e,t,o);break;case"image":c=await AM(e,t,o);break;case"data":c=await J7(e,t);break;default:Ti(!1)}return i==="data"&&(c=Lv(c)),c}function oAt(e){switch(e){case"auto":case"data":return X7();default:return G7(e),e}}var sAt=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],aAt=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],cAt={image:{type:"auto",decode:!0}},Uf={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:q7,mimeTypes:aAt,extensions:sAt,parse:tj,tests:[e=>Boolean(ZA(new DataView(e)))],options:cAt};var YO={};function KO(e){if(YO[e]===void 0){let t=Dp?uAt(e):lAt(e);YO[e]=t}return YO[e]}function lAt(e){let t=["image/png","image/jpeg","image/gif"],r=globalThis.loaders?.imageFormatsNode||t,n=globalThis.loaders?.parseImageNode;return Boolean(n)&&r.includes(e)}function uAt(e){switch(e){case"image/avif":case"image/webp":return hAt(e);default:return!0}}function hAt(e){try{return document.createElement("canvas").toDataURL(e).indexOf(`data:${e}`)===0}catch{return!1}}var fAt=new Bl({id:"deck"}),br=fAt;var ZO={};function ej(e){ZO=e}function qs(e,t,r,n){br.level>0&&ZO[e]&&ZO[e].call(null,t,r,n)}function pAt(e){let t=e[0],r=e[e.length-1];return t==="{"&&r==="}"||t==="["&&r==="]"}var rj={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:pAt,parseTextSync:JSON.parse};function dAt(){let e="9.1.0-beta.3",t=globalThis.deck&&globalThis.deck.VERSION;if(t&&t!==e)throw new Error(`deck.gl - multiple versions detected: ${t} vs ${e}`);return t||(br.log(1,`deck.gl ${e}`)(),globalThis.deck={...globalThis.deck,VERSION:e,version:e,log:br,_registerLoggers:ej},HA([rj,[Uf,{imagebitmap:{premultiplyAlpha:"none"}}]])),e}var gM=dAt();function _M(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}var $O={number:{type:"number",validate(e,t){return Number.isFinite(e)&&typeof t=="object"&&(t.max===void 0||e<=t.max)&&(t.min===void 0||e>=t.min)}},array:{type:"array",validate(e,t){return Array.isArray(e)||ArrayBuffer.isView(e)}}};function ij(e){let t={};for(let[r,n]of Object.entries(e))t[r]=mAt(n);return t}function mAt(e){let t=nj(e);if(t!=="object")return{value:e,...$O[t],type:t};if(typeof e=="object")return e?e.type!==void 0?{...e,...$O[e.type],type:e.type}:e.value===void 0?{type:"object",value:e}:(t=nj(e.value),{...e,...$O[t],type:t}):{type:"object",value:null};throw new Error("props")}function nj(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}var oj=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,sj=`#ifdef MODULE_MATERIAL
  fragColor = material_filterColor(fragColor);
#endif

#ifdef MODULE_LIGHTING
  fragColor = lighting_filterColor(fragColor);
#endif

#ifdef MODULE_FOG
  fragColor = fog_filterColor(fragColor);
#endif

#ifdef MODULE_PICKING
  fragColor = picking_filterHighlightColor(fragColor);
  fragColor = picking_filterPickingColor(fragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`;var AAt={vertex:oj,fragment:sj},aj=/void\s+main\s*\([^)]*\)\s*\{\n?/,cj=/}\n?[^{}]*$/,QO=[],Dv="__LUMA_INJECT_DECLARATIONS__";function lj(e){let t={vertex:{},fragment:{}};for(let r in e){let n=e[r],i=gAt(r);typeof n=="string"&&(n={order:0,injection:n}),t[i][r]=n}return t}function gAt(e){let t=e.slice(0,2);switch(t){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(t)}}function Nv(e,t,r,n=!1){let i=t==="vertex";for(let o in r){let s=r[o];s.sort((l,h)=>l.order-h.order),QO.length=s.length;for(let l=0,h=s.length;l<h;++l)QO[l]=s[l].injection;let c=`${QO.join(`
`)}
`;switch(o){case"vs:#decl":i&&(e=e.replace(Dv,c));break;case"vs:#main-start":i&&(e=e.replace(aj,l=>l+c));break;case"vs:#main-end":i&&(e=e.replace(cj,l=>c+l));break;case"fs:#decl":i||(e=e.replace(Dv,c));break;case"fs:#main-start":i||(e=e.replace(aj,l=>l+c));break;case"fs:#main-end":i||(e=e.replace(cj,l=>c+l));break;default:e=e.replace(o,l=>l+c)}}return e=e.replace(Dv,""),n&&(e=e.replace(/\}\s*$/,o=>o+AAt[t])),e}function $A(e){e.map(t=>yM(t))}function yM(e){if(e.instance)return;$A(e.dependencies||[]);let{propTypes:t={},deprecations:r=[],inject:n={}}=e,i={normalizedInjections:lj(n),parsedDeprecations:_At(r)};t&&(i.propValidators=ij(t)),e.instance=i;let o={};t&&(o=Object.entries(t).reduce((s,[c,l])=>{let h=l?.value;return h&&(s[c]=h),s},{})),e.defaultUniforms={...e.defaultUniforms,...o}}function JO(e,t,r){e.deprecations?.forEach(n=>{n.regex?.test(t)&&(n.deprecated?r.deprecated(n.old,n.new)():r.removed(n.old,n.new)())})}function _At(e){return e.forEach(t=>{switch(t.type){case"function":t.regex=new RegExp(`\\b${t.old}\\(`);break;default:t.regex=new RegExp(`${t.type} ${t.old};`)}}),e}function L_(e){$A(e);let t={},r={};uj({modules:e,level:0,moduleMap:t,moduleDepth:r});let n=Object.keys(r).sort((i,o)=>r[o]-r[i]).map(i=>t[i]);return $A(n),n}function uj(e){let{modules:t,level:r,moduleMap:n,moduleDepth:i}=e;if(r>=5)throw new Error("Possible loop in shader dependency graph");for(let o of t)n[o.name]=o,(i[o.name]===void 0||i[o.name]<r)&&(i[o.name]=r);for(let o of t)o.dependencies&&uj({modules:o.dependencies,level:r+1,moduleMap:n,moduleDepth:i})}function hj(e){switch(e?.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
// Apple optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Headless Chrome's software shader 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// If the GPU doesn't have full 32 bits precision, will causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function pj(e,t){if(Number(e.match(/^#version[ \t]+(\d+)/m)?.[1]||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(t){case"vertex":return e=fj(e,yAt),e;case"fragment":return e=fj(e,xAt),e;default:throw new Error(t)}}var dj=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],yAt=[...dj,[tB("attribute"),"in $1"],[tB("varying"),"out $1"]],xAt=[...dj,[tB("varying"),"in $1"]];function fj(e,t){for(let[r,n]of t)e=e.replace(r,n);return e}function tB(e){return new RegExp(`\\b${e}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function eB(e,t){let r="";for(let n in e){let i=e[n];if(r+=`void ${i.signature} {
`,i.header&&(r+=`  ${i.header}`),t[n]){let o=t[n];o.sort((s,c)=>s.order-c.order);for(let s of o)r+=`  ${s.injection}
`}i.footer&&(r+=`  ${i.footer}`),r+=`}
`}return r}function rB(e){let t={vertex:{},fragment:{}};for(let r of e){let n,i;typeof r!="string"?(n=r,i=n.hook):(n={},i=r),i=i.trim();let[o,s]=i.split(":"),c=i.replace(/\(.+/,""),l=Object.assign(n,{signature:s});switch(o){case"vs":t.vertex[c]=l;break;case"fs":t.fragment[c]=l;break;default:throw new Error(o)}}return t}function mj(e,t){return{name:vAt(e,t),language:"glsl",version:bAt(e)}}function vAt(e,t="unnamed"){let n=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(e);return n?n[1]:t}function bAt(e){let t=100,r=e.match(/[^\s]+/g);if(r&&r.length>=2&&r[0]==="#version"){let n=parseInt(r[1],10);Number.isFinite(n)&&(t=n)}if(t!==100&&t!==300)throw new Error(`Invalid GLSL version ${t}`);return t}var gj=`

${Dv}
`,wAt=`precision highp float;
`;function _j(e){let t=L_(e.modules||[]);return{source:TAt(e.platformInfo,{...e,source:e.source,stage:"vertex",modules:t}),getUniforms:xj(t)}}function yj(e){let{vs:t,fs:r}=e,n=L_(e.modules||[]);return{vs:Aj(e.platformInfo,{...e,source:t,stage:"vertex",modules:n}),fs:Aj(e.platformInfo,{...e,source:r,stage:"fragment",modules:n}),getUniforms:xj(n)}}function TAt(e,t){let{source:r,stage:n,modules:i,hookFunctions:o=[],inject:s={},log:c}=t;_M(typeof r=="string","shader source must be a string");let l=r,h="",p=rB(o),x={},w={},E={};for(let B in s){let D=typeof s[B]=="string"?{injection:s[B],order:0}:s[B],W=/^(v|f)s:(#)?([\w-]+)$/.exec(B);if(W){let X=W[2],q=W[3];X?q==="decl"?w[B]=[D]:E[B]=[D]:x[B]=[D]}else E[B]=[D]}let P=i;for(let B of P){c&&JO(B,l,c);let D=vj(B,"wgsl");h+=D;let W=B.injections?.[n]||{};for(let X in W){let q=/^(v|f)s:#([\w-]+)$/.exec(X);if(q){let et=q[2]==="decl"?w:E;et[X]=et[X]||[],et[X].push(W[X])}else x[X]=x[X]||[],x[X].push(W[X])}}return h+=gj,h=Nv(h,n,w),h+=eB(p[n],x),h+=l,h=Nv(h,n,E),h}function Aj(e,t){let{id:r,source:n,stage:i,language:o="glsl",modules:s,defines:c={},hookFunctions:l=[],inject:h={},prologue:p=!0,log:x}=t;_M(typeof n=="string","shader source must be a string");let w=o==="glsl"?mj(n).version:-1,E=e.shaderLanguageVersion,P=w===100?"#version 100":"#version 300 es",D=n.split(`
`).slice(1).join(`
`),W={};s.forEach(ut=>{Object.assign(W,ut.defines)}),Object.assign(W,c);let X="";switch(o){case"wgsl":break;case"glsl":X=p?`${P}

// ----- PROLOGUE -------------------------
${EAt({id:r,source:n,stage:i})}
${`#define SHADER_TYPE_${i.toUpperCase()}`}

${hj(e)}
${i==="fragment"?wAt:""}

// ----- APPLICATION DEFINES -------------------------

${MAt(W)}

`:`${P}
`;break}let q=rB(l),$={},et={},F={};for(let ut in h){let ot=typeof h[ut]=="string"?{injection:h[ut],order:0}:h[ut],J=/^(v|f)s:(#)?([\w-]+)$/.exec(ut);if(J){let G=J[2],mt=J[3];G?mt==="decl"?et[ut]=[ot]:F[ut]=[ot]:$[ut]=[ot]}else F[ut]=[ot]}for(let ut of s){x&&JO(ut,D,x);let ot=vj(ut,i);X+=ot;let J=ut.instance?.normalizedInjections[i]||{};for(let G in J){let mt=/^(v|f)s:#([\w-]+)$/.exec(G);if(mt){let ct=mt[2]==="decl"?et:F;ct[G]=ct[G]||[],ct[G].push(J[G])}else $[G]=$[G]||[],$[G].push(J[G])}}return X+="// ----- MAIN SHADER SOURCE -------------------------",X+=gj,X=Nv(X,i,et),X+=eB(q[i],$),X+=D,X=Nv(X,i,F),o==="glsl"&&w!==E&&(X=pj(X,i)),X.trim()}function xj(e){return function(r){let n={};for(let i of e){let o=i.getUniforms?.(r,n);Object.assign(n,o)}return n}}function EAt(e){let{id:t,source:r,stage:n}=e;return t&&r.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME ${t}_${n}`:""}function MAt(e={}){let t="";for(let r in e){let n=e[r];(n||Number.isFinite(n))&&(t+=`#define ${r.toUpperCase()} ${e[r]}
`)}return t}function vj(e,t){let r;switch(t){case"vertex":r=e.vs||"";break;case"fragment":r=e.fs||"";break;case"wgsl":r=e.source||"";break;default:_M(!1)}if(!e.name)throw new Error("Shader module must have a name");let n=e.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),i=`// ----- MODULE ${e.name} ---------------

`;return t!=="wgsl"&&(i+=`#define MODULE_${n}
`),i+=`${r}
`,i}var SAt=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,CAt=/^\s*\#\s*endif\s*$/;function bj(e,t){let r=e.split(`
`),n=[],i=!0,o=null;for(let s of r){let c=s.match(SAt),l=s.match(CAt);c?(o=c[1],i=Boolean(t?.defines?.[o])):l?i=!0:i&&n.push(s)}return n.join(`
`)}var O_=class{_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return O_.defaultShaderAssembler=O_.defaultShaderAssembler||new O_,O_.defaultShaderAssembler}addDefaultModule(t){this._defaultModules.find(r=>r.name===(typeof t=="string"?t:t.name))||this._defaultModules.push(t)}removeDefaultModule(t){let r=typeof t=="string"?t:t.name;this._defaultModules=this._defaultModules.filter(n=>n.name!==r)}addShaderHook(t,r){r&&(t=Object.assign(r,{hook:t})),this._hookFunctions.push(t)}assembleWGSLShader(t){let r=this._getModuleList(t.modules),n=this._hookFunctions,{source:i,getUniforms:o}=_j({...t,source:t.source,modules:r,hookFunctions:n});return{source:t.platformInfo.shaderLanguage==="wgsl"?bj(i):i,getUniforms:o,modules:r}}assembleGLSLShaderPair(t){let r=this._getModuleList(t.modules),n=this._hookFunctions;return{...yj({...t,vs:t.vs,fs:t.fs,modules:r,hookFunctions:n}),modules:r}}_getModuleList(t=[]){let r=new Array(this._defaultModules.length+t.length),n={},i=0;for(let o=0,s=this._defaultModules.length;o<s;++o){let c=this._defaultModules[o],l=c.name;r[i++]=c,n[l]=!0}for(let o=0,s=t.length;o<s;++o){let c=t[o],l=c.name;n[l]||(r[i++]=c,n[l]=!0)}return r.length=i,$A(r),r}},nm=O_;Vr(nm,"defaultShaderAssembler");var PAt=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,IAt=`#version 300 es
${PAt}`;function kv(e){let{input:t,inputChannels:r,output:n}=e||{};if(!t)return IAt;if(!r)throw new Error("inputChannels");let i=RAt(r),o=wj(t,r);return`#version 300 es
in ${i} ${t};
out vec4 ${n};
void main() {
  ${n} = ${o};
}`}function RAt(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${e}`)}}function wj(e,t){switch(t){case 1:return`vec4(${e}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${e}, 0.0, 1.0)`;case 3:return`vec4(${e}, 1.0)`;case 4:return e;default:throw new Error(`invalid channels: ${t}`)}}var nB=class{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}},Ph=class{constructor(){}get isAstNode(){return!0}get astNodeType(){return""}evaluate(t){throw new Error("Cannot evaluate node")}evaluateString(t){return this.evaluate(t).toString()}search(t){}searchBlock(t,r){if(t){r(k_.instance);for(let n of t)n instanceof Array?this.searchBlock(n,r):n.search(r);r(F_.instance)}}},k_=class extends Ph{};k_.instance=new k_;var F_=class extends Ph{};F_.instance=new F_;var Ko=class extends Ph{constructor(){super()}},zv=class extends Ko{constructor(t,r,n,i,o,s){super(),this.calls=new Set,this.name=t,this.args=r,this.returnType=n,this.body=i,this.startLine=o,this.endLine=s}get astNodeType(){return"function"}search(t){this.searchBlock(this.body,t)}},iB=class extends Ko{constructor(t){super(),this.expression=t}get astNodeType(){return"staticAssert"}search(t){this.expression.search(t)}},oB=class extends Ko{constructor(t,r){super(),this.condition=t,this.body=r}get astNodeType(){return"while"}search(t){this.condition.search(t),this.searchBlock(this.body,t)}},sB=class extends Ko{constructor(t){super(),this.body=t}get astNodeType(){return"continuing"}search(t){this.searchBlock(this.body,t)}},aB=class extends Ko{constructor(t,r,n,i){super(),this.init=t,this.condition=r,this.increment=n,this.body=i}get astNodeType(){return"for"}search(t){var r,n,i;(r=this.init)===null||r===void 0||r.search(t),(n=this.condition)===null||n===void 0||n.search(t),(i=this.increment)===null||i===void 0||i.search(t),this.searchBlock(this.body,t)}},zp=class extends Ko{constructor(t,r,n,i,o){super(),this.name=t,this.type=r,this.storage=n,this.access=i,this.value=o}get astNodeType(){return"var"}search(t){var r;t(this),(r=this.value)===null||r===void 0||r.search(t)}},xM=class extends Ko{constructor(t,r,n){super(),this.name=t,this.type=r,this.value=n}get astNodeType(){return"override"}search(t){var r;(r=this.value)===null||r===void 0||r.search(t)}},Uv=class extends Ko{constructor(t,r,n,i,o){super(),this.name=t,this.type=r,this.storage=n,this.access=i,this.value=o}get astNodeType(){return"let"}search(t){var r;t(this),(r=this.value)===null||r===void 0||r.search(t)}},vM=class extends Ko{constructor(t,r,n,i,o){super(),this.name=t,this.type=r,this.storage=n,this.access=i,this.value=o}get astNodeType(){return"const"}evaluate(t){return this.value.evaluate(t)}search(t){var r;t(this),(r=this.value)===null||r===void 0||r.search(t)}},z_;(function(e){e.increment="++",e.decrement="--"})(z_||(z_={}));(function(e){function t(r){let n=r;if(n=="parse")throw new Error("Invalid value for IncrementOperator");return e[n]}e.parse=t})(z_||(z_={}));var cB=class extends Ko{constructor(t,r){super(),this.operator=t,this.variable=r}get astNodeType(){return"increment"}search(t){this.variable.search(t)}},Vv;(function(e){e.assign="=",e.addAssign="+=",e.subtractAssin="-=",e.multiplyAssign="*=",e.divideAssign="/=",e.moduloAssign="%=",e.andAssign="&=",e.orAssign="|=",e.xorAssign="^=",e.shiftLeftAssign="<<=",e.shiftRightAssign=">>="})(Vv||(Vv={}));(function(e){function t(r){let n=r;if(n=="parse")throw new Error("Invalid value for AssignOperator");return n}e.parse=t})(Vv||(Vv={}));var lB=class extends Ko{constructor(t,r,n){super(),this.operator=t,this.variable=r,this.value=n}get astNodeType(){return"assign"}search(t){this.variable.search(t),this.value.search(t)}},bM=class extends Ko{constructor(t,r){super(),this.name=t,this.args=r}get astNodeType(){return"call"}search(t){for(let r of this.args)r.search(t);t(this)}},uB=class extends Ko{constructor(t,r){super(),this.body=t,this.continuing=r}get astNodeType(){return"loop"}},hB=class extends Ko{constructor(t,r){super(),this.condition=t,this.body=r}get astNodeType(){return"body"}},fB=class extends Ko{constructor(t,r,n,i){super(),this.condition=t,this.body=r,this.elseif=n,this.else=i}get astNodeType(){return"if"}search(t){this.condition.search(t),this.searchBlock(this.body,t),this.searchBlock(this.elseif,t),this.searchBlock(this.else,t)}},pB=class extends Ko{constructor(t){super(),this.value=t}get astNodeType(){return"return"}search(t){var r;(r=this.value)===null||r===void 0||r.search(t)}},dB=class extends Ko{constructor(t){super(),this.name=t}get astNodeType(){return"enable"}},mB=class extends Ko{constructor(t){super(),this.extensions=t}get astNodeType(){return"requires"}},AB=class extends Ko{constructor(t,r){super(),this.severity=t,this.rule=r}get astNodeType(){return"diagnostic"}},wM=class extends Ko{constructor(t,r){super(),this.name=t,this.type=r}get astNodeType(){return"alias"}},gB=class extends Ko{constructor(){super()}get astNodeType(){return"discard"}},_B=class extends Ko{constructor(){super()}get astNodeType(){return"break"}},yB=class extends Ko{constructor(){super()}get astNodeType(){return"continue"}},Up=class extends Ko{constructor(t){super(),this.name=t}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}},Fp=class extends Up{constructor(t,r,n,i){super(t),this.members=r,this.startLine=n,this.endLine=i}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(t){for(let r=0;r<this.members.length;r++)if(this.members[r].name==t)return r;return-1}},TM=class extends Up{constructor(t,r,n){super(t),this.format=r,this.access=n}get astNodeType(){return"template"}},xB=class extends Up{constructor(t,r,n,i){super(t),this.storage=r,this.type=n,this.access=i}get astNodeType(){return"pointer"}},EM=class extends Up{constructor(t,r,n,i){super(t),this.attributes=r,this.format=n,this.count=i}get astNodeType(){return"array"}get isArray(){return!0}},QA=class extends Up{constructor(t,r,n){super(t),this.format=r,this.access=n}get astNodeType(){return"sampler"}},cu=class extends Ph{constructor(){super()}},MM=class extends cu{constructor(t){super(),this.value=t}get astNodeType(){return"stringExpr"}toString(){return this.value}evaluateString(){return this.value}},om=class extends cu{constructor(t,r){super(),this.type=t,this.args=r}get astNodeType(){return"createExpr"}search(t){t(this);for(let r of this.args)r.search(t)}},SM=class extends cu{constructor(t,r){super(),this.name=t,this.args=r}get astNodeType(){return"callExpr"}evaluate(t){switch(this.name){case"abs":return Math.abs(this.args[0].evaluate(t));case"acos":return Math.acos(this.args[0].evaluate(t));case"acosh":return Math.acosh(this.args[0].evaluate(t));case"asin":return Math.asin(this.args[0].evaluate(t));case"asinh":return Math.asinh(this.args[0].evaluate(t));case"atan":return Math.atan(this.args[0].evaluate(t));case"atan2":return Math.atan2(this.args[0].evaluate(t),this.args[1].evaluate(t));case"atanh":return Math.atanh(this.args[0].evaluate(t));case"ceil":return Math.ceil(this.args[0].evaluate(t));case"clamp":return Math.min(Math.max(this.args[0].evaluate(t),this.args[1].evaluate(t)),this.args[2].evaluate(t));case"cos":return Math.cos(this.args[0].evaluate(t));case"degrees":return this.args[0].evaluate(t)*180/Math.PI;case"distance":return Math.sqrt(Math.pow(this.args[0].evaluate(t)-this.args[1].evaluate(t),2));case"dot":case"exp":return Math.exp(this.args[0].evaluate(t));case"exp2":return Math.pow(2,this.args[0].evaluate(t));case"floor":return Math.floor(this.args[0].evaluate(t));case"fma":return this.args[0].evaluate(t)*this.args[1].evaluate(t)+this.args[2].evaluate(t);case"fract":return this.args[0].evaluate(t)-Math.floor(this.args[0].evaluate(t));case"inverseSqrt":return 1/Math.sqrt(this.args[0].evaluate(t));case"log":return Math.log(this.args[0].evaluate(t));case"log2":return Math.log2(this.args[0].evaluate(t));case"max":return Math.max(this.args[0].evaluate(t),this.args[1].evaluate(t));case"min":return Math.min(this.args[0].evaluate(t),this.args[1].evaluate(t));case"mix":return this.args[0].evaluate(t)*(1-this.args[2].evaluate(t))+this.args[1].evaluate(t)*this.args[2].evaluate(t);case"modf":return this.args[0].evaluate(t)-Math.floor(this.args[0].evaluate(t));case"pow":return Math.pow(this.args[0].evaluate(t),this.args[1].evaluate(t));case"radians":return this.args[0].evaluate(t)*Math.PI/180;case"round":return Math.round(this.args[0].evaluate(t));case"sign":return Math.sign(this.args[0].evaluate(t));case"sin":return Math.sin(this.args[0].evaluate(t));case"sinh":return Math.sinh(this.args[0].evaluate(t));case"saturate":return Math.min(Math.max(this.args[0].evaluate(t),0),1);case"smoothstep":return this.args[0].evaluate(t)*this.args[0].evaluate(t)*(3-2*this.args[0].evaluate(t));case"sqrt":return Math.sqrt(this.args[0].evaluate(t));case"step":return this.args[0].evaluate(t)<this.args[1].evaluate(t)?0:1;case"tan":return Math.tan(this.args[0].evaluate(t));case"tanh":return Math.tanh(this.args[0].evaluate(t));case"trunc":return Math.trunc(this.args[0].evaluate(t));default:throw new Error("Non const function: "+this.name)}}search(t){for(let r of this.args)r.search(t);t(this)}},jv=class extends cu{constructor(t){super(),this.name=t}get astNodeType(){return"varExpr"}search(t){t(this),this.postfix&&this.postfix.search(t)}evaluate(t){let r=t.constants.get(this.name);if(!r)throw new Error("Cannot evaluate node");return r.evaluate(t)}},CM=class extends cu{constructor(t,r){super(),this.name=t,this.initializer=r}get astNodeType(){return"constExpr"}evaluate(t){var r,n;if(this.initializer instanceof om){let i=(r=this.postfix)===null||r===void 0?void 0:r.evaluateString(t),o=(n=this.initializer.type)===null||n===void 0?void 0:n.name,s=t.structs.get(o),c=s?.getMemberIndex(i);if(c!=-1)return this.initializer.args[c].evaluate(t);console.log(c)}return this.initializer.evaluate(t)}search(t){this.initializer.search(t)}},PM=class extends cu{constructor(t){super(),this.value=t}get astNodeType(){return"literalExpr"}evaluate(){return this.value}},vB=class extends cu{constructor(t,r){super(),this.type=t,this.value=r}get astNodeType(){return"bitcastExpr"}search(t){this.value.search(t)}},bB=class extends cu{constructor(t,r){super(),this.type=t,this.args=r}get astNodeType(){return"typecastExpr"}evaluate(t){return this.args[0].evaluate(t)}search(t){this.searchBlock(this.args,t)}},IM=class extends cu{constructor(t){super(),this.contents=t}get astNodeType(){return"groupExpr"}evaluate(t){return this.contents[0].evaluate(t)}search(t){this.searchBlock(this.contents,t)}},wB=class extends cu{constructor(t){super(),this.index=t}search(t){this.index.search(t)}},RM=class extends cu{constructor(){super()}},TB=class extends RM{constructor(t,r){super(),this.operator=t,this.right=r}get astNodeType(){return"unaryOp"}evaluate(t){switch(this.operator){case"+":return this.right.evaluate(t);case"-":return-this.right.evaluate(t);case"!":return this.right.evaluate(t)?0:1;case"~":return~this.right.evaluate(t);default:throw new Error("Unknown unary operator: "+this.operator)}}search(t){this.right.search(t)}},Hu=class extends RM{constructor(t,r,n){super(),this.operator=t,this.left=r,this.right=n}get astNodeType(){return"binaryOp"}evaluate(t){switch(this.operator){case"+":return this.left.evaluate(t)+this.right.evaluate(t);case"-":return this.left.evaluate(t)-this.right.evaluate(t);case"*":return this.left.evaluate(t)*this.right.evaluate(t);case"/":return this.left.evaluate(t)/this.right.evaluate(t);case"%":return this.left.evaluate(t)%this.right.evaluate(t);case"==":return this.left.evaluate(t)==this.right.evaluate(t)?1:0;case"!=":return this.left.evaluate(t)!=this.right.evaluate(t)?1:0;case"<":return this.left.evaluate(t)<this.right.evaluate(t)?1:0;case">":return this.left.evaluate(t)>this.right.evaluate(t)?1:0;case"<=":return this.left.evaluate(t)<=this.right.evaluate(t)?1:0;case">=":return this.left.evaluate(t)>=this.right.evaluate(t)?1:0;case"&&":return this.left.evaluate(t)&&this.right.evaluate(t)?1:0;case"||":return this.left.evaluate(t)||this.right.evaluate(t)?1:0;default:throw new Error(`Unknown operator ${this.operator}`)}}search(t){this.left.search(t),this.right.search(t)}},LM=class extends Ph{constructor(){super()}},EB=class extends LM{constructor(t,r){super(),this.selector=t,this.body=r}get astNodeType(){return"case"}search(t){this.searchBlock(this.body,t)}},MB=class extends LM{constructor(t){super(),this.body=t}get astNodeType(){return"default"}search(t){this.searchBlock(this.body,t)}},SB=class extends Ph{constructor(t,r,n){super(),this.name=t,this.type=r,this.attributes=n}get astNodeType(){return"argument"}},CB=class extends Ph{constructor(t,r){super(),this.condition=t,this.body=r}get astNodeType(){return"elseif"}search(t){this.condition.search(t),this.searchBlock(this.body,t)}},PB=class extends Ph{constructor(t,r,n){super(),this.name=t,this.type=r,this.attributes=n}get astNodeType(){return"member"}},IB=class extends Ph{constructor(t,r){super(),this.name=t,this.value=r}get astNodeType(){return"attribute"}},ye,fe;(function(e){e[e.token=0]="token",e[e.keyword=1]="keyword",e[e.reserved=2]="reserved"})(fe||(fe={}));var he=class{constructor(t,r,n){this.name=t,this.type=r,this.rule=n}toString(){return this.name}},Nt=class{};ye=Nt;Nt.none=new he("",fe.reserved,"");Nt.eof=new he("EOF",fe.token,"");Nt.reserved={asm:new he("asm",fe.reserved,"asm"),bf16:new he("bf16",fe.reserved,"bf16"),do:new he("do",fe.reserved,"do"),enum:new he("enum",fe.reserved,"enum"),f16:new he("f16",fe.reserved,"f16"),f64:new he("f64",fe.reserved,"f64"),handle:new he("handle",fe.reserved,"handle"),i8:new he("i8",fe.reserved,"i8"),i16:new he("i16",fe.reserved,"i16"),i64:new he("i64",fe.reserved,"i64"),mat:new he("mat",fe.reserved,"mat"),premerge:new he("premerge",fe.reserved,"premerge"),regardless:new he("regardless",fe.reserved,"regardless"),typedef:new he("typedef",fe.reserved,"typedef"),u8:new he("u8",fe.reserved,"u8"),u16:new he("u16",fe.reserved,"u16"),u64:new he("u64",fe.reserved,"u64"),unless:new he("unless",fe.reserved,"unless"),using:new he("using",fe.reserved,"using"),vec:new he("vec",fe.reserved,"vec"),void:new he("void",fe.reserved,"void")};Nt.keywords={array:new he("array",fe.keyword,"array"),atomic:new he("atomic",fe.keyword,"atomic"),bool:new he("bool",fe.keyword,"bool"),f32:new he("f32",fe.keyword,"f32"),i32:new he("i32",fe.keyword,"i32"),mat2x2:new he("mat2x2",fe.keyword,"mat2x2"),mat2x3:new he("mat2x3",fe.keyword,"mat2x3"),mat2x4:new he("mat2x4",fe.keyword,"mat2x4"),mat3x2:new he("mat3x2",fe.keyword,"mat3x2"),mat3x3:new he("mat3x3",fe.keyword,"mat3x3"),mat3x4:new he("mat3x4",fe.keyword,"mat3x4"),mat4x2:new he("mat4x2",fe.keyword,"mat4x2"),mat4x3:new he("mat4x3",fe.keyword,"mat4x3"),mat4x4:new he("mat4x4",fe.keyword,"mat4x4"),ptr:new he("ptr",fe.keyword,"ptr"),sampler:new he("sampler",fe.keyword,"sampler"),sampler_comparison:new he("sampler_comparison",fe.keyword,"sampler_comparison"),struct:new he("struct",fe.keyword,"struct"),texture_1d:new he("texture_1d",fe.keyword,"texture_1d"),texture_2d:new he("texture_2d",fe.keyword,"texture_2d"),texture_2d_array:new he("texture_2d_array",fe.keyword,"texture_2d_array"),texture_3d:new he("texture_3d",fe.keyword,"texture_3d"),texture_cube:new he("texture_cube",fe.keyword,"texture_cube"),texture_cube_array:new he("texture_cube_array",fe.keyword,"texture_cube_array"),texture_multisampled_2d:new he("texture_multisampled_2d",fe.keyword,"texture_multisampled_2d"),texture_storage_1d:new he("texture_storage_1d",fe.keyword,"texture_storage_1d"),texture_storage_2d:new he("texture_storage_2d",fe.keyword,"texture_storage_2d"),texture_storage_2d_array:new he("texture_storage_2d_array",fe.keyword,"texture_storage_2d_array"),texture_storage_3d:new he("texture_storage_3d",fe.keyword,"texture_storage_3d"),texture_depth_2d:new he("texture_depth_2d",fe.keyword,"texture_depth_2d"),texture_depth_2d_array:new he("texture_depth_2d_array",fe.keyword,"texture_depth_2d_array"),texture_depth_cube:new he("texture_depth_cube",fe.keyword,"texture_depth_cube"),texture_depth_cube_array:new he("texture_depth_cube_array",fe.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new he("texture_depth_multisampled_2d",fe.keyword,"texture_depth_multisampled_2d"),texture_external:new he("texture_external",fe.keyword,"texture_external"),u32:new he("u32",fe.keyword,"u32"),vec2:new he("vec2",fe.keyword,"vec2"),vec3:new he("vec3",fe.keyword,"vec3"),vec4:new he("vec4",fe.keyword,"vec4"),bitcast:new he("bitcast",fe.keyword,"bitcast"),block:new he("block",fe.keyword,"block"),break:new he("break",fe.keyword,"break"),case:new he("case",fe.keyword,"case"),continue:new he("continue",fe.keyword,"continue"),continuing:new he("continuing",fe.keyword,"continuing"),default:new he("default",fe.keyword,"default"),diagnostic:new he("diagnostic",fe.keyword,"diagnostic"),discard:new he("discard",fe.keyword,"discard"),else:new he("else",fe.keyword,"else"),enable:new he("enable",fe.keyword,"enable"),fallthrough:new he("fallthrough",fe.keyword,"fallthrough"),false:new he("false",fe.keyword,"false"),fn:new he("fn",fe.keyword,"fn"),for:new he("for",fe.keyword,"for"),function:new he("function",fe.keyword,"function"),if:new he("if",fe.keyword,"if"),let:new he("let",fe.keyword,"let"),const:new he("const",fe.keyword,"const"),loop:new he("loop",fe.keyword,"loop"),while:new he("while",fe.keyword,"while"),private:new he("private",fe.keyword,"private"),read:new he("read",fe.keyword,"read"),read_write:new he("read_write",fe.keyword,"read_write"),return:new he("return",fe.keyword,"return"),requires:new he("requires",fe.keyword,"requires"),storage:new he("storage",fe.keyword,"storage"),switch:new he("switch",fe.keyword,"switch"),true:new he("true",fe.keyword,"true"),alias:new he("alias",fe.keyword,"alias"),type:new he("type",fe.keyword,"type"),uniform:new he("uniform",fe.keyword,"uniform"),var:new he("var",fe.keyword,"var"),override:new he("override",fe.keyword,"override"),workgroup:new he("workgroup",fe.keyword,"workgroup"),write:new he("write",fe.keyword,"write"),r8unorm:new he("r8unorm",fe.keyword,"r8unorm"),r8snorm:new he("r8snorm",fe.keyword,"r8snorm"),r8uint:new he("r8uint",fe.keyword,"r8uint"),r8sint:new he("r8sint",fe.keyword,"r8sint"),r16uint:new he("r16uint",fe.keyword,"r16uint"),r16sint:new he("r16sint",fe.keyword,"r16sint"),r16float:new he("r16float",fe.keyword,"r16float"),rg8unorm:new he("rg8unorm",fe.keyword,"rg8unorm"),rg8snorm:new he("rg8snorm",fe.keyword,"rg8snorm"),rg8uint:new he("rg8uint",fe.keyword,"rg8uint"),rg8sint:new he("rg8sint",fe.keyword,"rg8sint"),r32uint:new he("r32uint",fe.keyword,"r32uint"),r32sint:new he("r32sint",fe.keyword,"r32sint"),r32float:new he("r32float",fe.keyword,"r32float"),rg16uint:new he("rg16uint",fe.keyword,"rg16uint"),rg16sint:new he("rg16sint",fe.keyword,"rg16sint"),rg16float:new he("rg16float",fe.keyword,"rg16float"),rgba8unorm:new he("rgba8unorm",fe.keyword,"rgba8unorm"),rgba8unorm_srgb:new he("rgba8unorm_srgb",fe.keyword,"rgba8unorm_srgb"),rgba8snorm:new he("rgba8snorm",fe.keyword,"rgba8snorm"),rgba8uint:new he("rgba8uint",fe.keyword,"rgba8uint"),rgba8sint:new he("rgba8sint",fe.keyword,"rgba8sint"),bgra8unorm:new he("bgra8unorm",fe.keyword,"bgra8unorm"),bgra8unorm_srgb:new he("bgra8unorm_srgb",fe.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new he("rgb10a2unorm",fe.keyword,"rgb10a2unorm"),rg11b10float:new he("rg11b10float",fe.keyword,"rg11b10float"),rg32uint:new he("rg32uint",fe.keyword,"rg32uint"),rg32sint:new he("rg32sint",fe.keyword,"rg32sint"),rg32float:new he("rg32float",fe.keyword,"rg32float"),rgba16uint:new he("rgba16uint",fe.keyword,"rgba16uint"),rgba16sint:new he("rgba16sint",fe.keyword,"rgba16sint"),rgba16float:new he("rgba16float",fe.keyword,"rgba16float"),rgba32uint:new he("rgba32uint",fe.keyword,"rgba32uint"),rgba32sint:new he("rgba32sint",fe.keyword,"rgba32sint"),rgba32float:new he("rgba32float",fe.keyword,"rgba32float"),static_assert:new he("static_assert",fe.keyword,"static_assert")};Nt.tokens={decimal_float_literal:new he("decimal_float_literal",fe.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?f?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+f?)|([0-9]+f)/),hex_float_literal:new he("hex_float_literal",fe.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+f?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+f?))/),int_literal:new he("int_literal",fe.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new he("uint_literal",fe.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),ident:new he("ident",fe.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new he("and",fe.token,"&"),and_and:new he("and_and",fe.token,"&&"),arrow:new he("arrow ",fe.token,"->"),attr:new he("attr",fe.token,"@"),forward_slash:new he("forward_slash",fe.token,"/"),bang:new he("bang",fe.token,"!"),bracket_left:new he("bracket_left",fe.token,"["),bracket_right:new he("bracket_right",fe.token,"]"),brace_left:new he("brace_left",fe.token,"{"),brace_right:new he("brace_right",fe.token,"}"),colon:new he("colon",fe.token,":"),comma:new he("comma",fe.token,","),equal:new he("equal",fe.token,"="),equal_equal:new he("equal_equal",fe.token,"=="),not_equal:new he("not_equal",fe.token,"!="),greater_than:new he("greater_than",fe.token,">"),greater_than_equal:new he("greater_than_equal",fe.token,">="),shift_right:new he("shift_right",fe.token,">>"),less_than:new he("less_than",fe.token,"<"),less_than_equal:new he("less_than_equal",fe.token,"<="),shift_left:new he("shift_left",fe.token,"<<"),modulo:new he("modulo",fe.token,"%"),minus:new he("minus",fe.token,"-"),minus_minus:new he("minus_minus",fe.token,"--"),period:new he("period",fe.token,"."),plus:new he("plus",fe.token,"+"),plus_plus:new he("plus_plus",fe.token,"++"),or:new he("or",fe.token,"|"),or_or:new he("or_or",fe.token,"||"),paren_left:new he("paren_left",fe.token,"("),paren_right:new he("paren_right",fe.token,")"),semicolon:new he("semicolon",fe.token,";"),star:new he("star",fe.token,"*"),tilde:new he("tilde",fe.token,"~"),underscore:new he("underscore",fe.token,"_"),xor:new he("xor",fe.token,"^"),plus_equal:new he("plus_equal",fe.token,"+="),minus_equal:new he("minus_equal",fe.token,"-="),times_equal:new he("times_equal",fe.token,"*="),division_equal:new he("division_equal",fe.token,"/="),modulo_equal:new he("modulo_equal",fe.token,"%="),and_equal:new he("and_equal",fe.token,"&="),or_equal:new he("or_equal",fe.token,"|="),xor_equal:new he("xor_equal",fe.token,"^="),shift_right_equal:new he("shift_right_equal",fe.token,">>="),shift_left_equal:new he("shift_left_equal",fe.token,"<<=")};Nt.simpleTokens={"@":ye.tokens.attr,"{":ye.tokens.brace_left,"}":ye.tokens.brace_right,":":ye.tokens.colon,",":ye.tokens.comma,"(":ye.tokens.paren_left,")":ye.tokens.paren_right,";":ye.tokens.semicolon};Nt.literalTokens={"&":ye.tokens.and,"&&":ye.tokens.and_and,"->":ye.tokens.arrow,"/":ye.tokens.forward_slash,"!":ye.tokens.bang,"[":ye.tokens.bracket_left,"]":ye.tokens.bracket_right,"=":ye.tokens.equal,"==":ye.tokens.equal_equal,"!=":ye.tokens.not_equal,">":ye.tokens.greater_than,">=":ye.tokens.greater_than_equal,">>":ye.tokens.shift_right,"<":ye.tokens.less_than,"<=":ye.tokens.less_than_equal,"<<":ye.tokens.shift_left,"%":ye.tokens.modulo,"-":ye.tokens.minus,"--":ye.tokens.minus_minus,".":ye.tokens.period,"+":ye.tokens.plus,"++":ye.tokens.plus_plus,"|":ye.tokens.or,"||":ye.tokens.or_or,"*":ye.tokens.star,"~":ye.tokens.tilde,_:ye.tokens.underscore,"^":ye.tokens.xor,"+=":ye.tokens.plus_equal,"-=":ye.tokens.minus_equal,"*=":ye.tokens.times_equal,"/=":ye.tokens.division_equal,"%=":ye.tokens.modulo_equal,"&=":ye.tokens.and_equal,"|=":ye.tokens.or_equal,"^=":ye.tokens.xor_equal,">>=":ye.tokens.shift_right_equal,"<<=":ye.tokens.shift_left_equal};Nt.regexTokens={decimal_float_literal:ye.tokens.decimal_float_literal,hex_float_literal:ye.tokens.hex_float_literal,int_literal:ye.tokens.int_literal,uint_literal:ye.tokens.uint_literal,ident:ye.tokens.ident};Nt.storage_class=[ye.keywords.function,ye.keywords.private,ye.keywords.workgroup,ye.keywords.uniform,ye.keywords.storage];Nt.access_mode=[ye.keywords.read,ye.keywords.write,ye.keywords.read_write];Nt.sampler_type=[ye.keywords.sampler,ye.keywords.sampler_comparison];Nt.sampled_texture_type=[ye.keywords.texture_1d,ye.keywords.texture_2d,ye.keywords.texture_2d_array,ye.keywords.texture_3d,ye.keywords.texture_cube,ye.keywords.texture_cube_array];Nt.multisampled_texture_type=[ye.keywords.texture_multisampled_2d];Nt.storage_texture_type=[ye.keywords.texture_storage_1d,ye.keywords.texture_storage_2d,ye.keywords.texture_storage_2d_array,ye.keywords.texture_storage_3d];Nt.depth_texture_type=[ye.keywords.texture_depth_2d,ye.keywords.texture_depth_2d_array,ye.keywords.texture_depth_cube,ye.keywords.texture_depth_cube_array,ye.keywords.texture_depth_multisampled_2d];Nt.texture_external_type=[ye.keywords.texture_external];Nt.any_texture_type=[...ye.sampled_texture_type,...ye.multisampled_texture_type,...ye.storage_texture_type,...ye.depth_texture_type,...ye.texture_external_type];Nt.texel_format=[ye.keywords.r8unorm,ye.keywords.r8snorm,ye.keywords.r8uint,ye.keywords.r8sint,ye.keywords.r16uint,ye.keywords.r16sint,ye.keywords.r16float,ye.keywords.rg8unorm,ye.keywords.rg8snorm,ye.keywords.rg8uint,ye.keywords.rg8sint,ye.keywords.r32uint,ye.keywords.r32sint,ye.keywords.r32float,ye.keywords.rg16uint,ye.keywords.rg16sint,ye.keywords.rg16float,ye.keywords.rgba8unorm,ye.keywords.rgba8unorm_srgb,ye.keywords.rgba8snorm,ye.keywords.rgba8uint,ye.keywords.rgba8sint,ye.keywords.bgra8unorm,ye.keywords.bgra8unorm_srgb,ye.keywords.rgb10a2unorm,ye.keywords.rg11b10float,ye.keywords.rg32uint,ye.keywords.rg32sint,ye.keywords.rg32float,ye.keywords.rgba16uint,ye.keywords.rgba16sint,ye.keywords.rgba16float,ye.keywords.rgba32uint,ye.keywords.rgba32sint,ye.keywords.rgba32float];Nt.const_literal=[ye.tokens.int_literal,ye.tokens.uint_literal,ye.tokens.decimal_float_literal,ye.tokens.hex_float_literal,ye.keywords.true,ye.keywords.false];Nt.literal_or_ident=[ye.tokens.ident,ye.tokens.int_literal,ye.tokens.uint_literal,ye.tokens.decimal_float_literal,ye.tokens.hex_float_literal];Nt.element_count_expression=[ye.tokens.int_literal,ye.tokens.uint_literal,ye.tokens.ident];Nt.template_types=[ye.keywords.vec2,ye.keywords.vec3,ye.keywords.vec4,ye.keywords.mat2x2,ye.keywords.mat2x3,ye.keywords.mat2x4,ye.keywords.mat3x2,ye.keywords.mat3x3,ye.keywords.mat3x4,ye.keywords.mat4x2,ye.keywords.mat4x3,ye.keywords.mat4x4,ye.keywords.atomic,ye.keywords.bitcast,...ye.any_texture_type];Nt.attribute_name=[ye.tokens.ident,ye.keywords.block,ye.keywords.diagnostic];Nt.assignment_operators=[ye.tokens.equal,ye.tokens.plus_equal,ye.tokens.minus_equal,ye.tokens.times_equal,ye.tokens.division_equal,ye.tokens.modulo_equal,ye.tokens.and_equal,ye.tokens.or_equal,ye.tokens.xor_equal,ye.tokens.shift_right_equal,ye.tokens.shift_left_equal];Nt.increment_operators=[ye.tokens.plus_plus,ye.tokens.minus_minus];var OM=class{constructor(t,r,n){this.type=t,this.lexeme=r,this.line=n}toString(){return this.lexeme}isTemplateType(){return Nt.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==Nt.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}},RB=class{constructor(t){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=t??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new OM(Nt.eof,"",this._line)),this._tokens}scanToken(){let t=this._advance();if(t==`
`)return this._line++,!0;if(this._isWhitespace(t))return!0;if(t=="/"){if(this._peekAhead()=="/"){for(;t!=`
`;){if(this._isAtEnd())return!0;t=this._advance()}return this._line++,!0}else if(this._peekAhead()=="*"){this._advance();let s=1;for(;s>0;){if(this._isAtEnd())return!0;if(t=this._advance(),t==`
`)this._line++;else if(t=="*"){if(this._peekAhead()=="/"&&(this._advance(),s--,s==0))return!0}else t=="/"&&this._peekAhead()=="*"&&(this._advance(),s++)}return!0}}let r=Nt.simpleTokens[t];if(r)return this._addToken(r),!0;let n=Nt.none,i=this._isAlpha(t),o=t==="_";if(this._isAlphaNumeric(t)){let s=this._peekAhead();for(;this._isAlphaNumeric(s);)t+=this._advance(),s=this._peekAhead()}if(i){let s=Nt.keywords[t];if(s)return this._addToken(s),!0}if(i||o)return this._addToken(Nt.tokens.ident),!0;for(;;){let s=this._findType(t),c=this._peekAhead();if(t==">"&&(c==">"||c=="=")){let l=!1,h=this._tokens.length-1;for(let p=0;p<5&&h>=0&&Nt.assignment_operators.indexOf(this._tokens[h].type)===-1;++p,--h)if(this._tokens[h].type===Nt.tokens.less_than){h>0&&this._tokens[h-1].isArrayOrTemplateType()&&(l=!0);break}if(l)return this._addToken(s),!0}if(s===Nt.none){let l=t,h=0,p=2;for(let x=0;x<p;++x)if(l+=this._peekAhead(x),s=this._findType(l),s!==Nt.none){h=x;break}if(s===Nt.none)return n===Nt.none?!1:(this._current--,this._addToken(n),!0);t=l,this._current+=h+1}if(n=s,this._isAtEnd())break;t+=this._advance()}return n===Nt.none?!1:(this._addToken(n),!0)}_findType(t){for(let n in Nt.regexTokens){let i=Nt.regexTokens[n];if(this._match(t,i.rule))return i}let r=Nt.literalTokens[t];return r||Nt.none}_match(t,r){let n=r.exec(t);return n&&n.index==0&&n[0]==t}_isAtEnd(){return this._current>=this._source.length}_isAlpha(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"}_isAlphaNumeric(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"||t=="_"||t>="0"&&t<="9"}_isWhitespace(t){return t==" "||t=="	"||t=="\r"}_advance(t=0){let r=this._source[this._current];return t=t||0,t++,this._current+=t,r}_peekAhead(t=0){return t=t||0,this._current+t>=this._source.length?"\0":this._source[this._current+t]}_addToken(t){let r=this._source.substring(this._start,this._current);this._tokens.push(new OM(t,r,this._line))}},LB=class{constructor(){this._tokens=[],this._current=0,this._currentLine=0,this._context=new nB,this._deferArrayCountEval=[]}parse(t){this._initialize(t),this._deferArrayCountEval.length=0;let r=[];for(;!this._isAtEnd();){let n=this._global_decl_or_directive();if(!n)break;r.push(n)}if(this._deferArrayCountEval.length>0){for(let n of this._deferArrayCountEval){let i=n.arrayType,o=n.countNode;if(o instanceof jv){let c=o.name,l=this._context.constants.get(c);if(l)try{let h=l.evaluate(this._context);i.count=h}catch{}}}this._deferArrayCountEval.length=0}return r}_initialize(t){if(t)if(typeof t=="string"){let r=new RB(t);this._tokens=r.scanTokens()}else this._tokens=t;else this._tokens=[];this._current=0}_error(t,r){return{token:t,message:r,toString:function(){return`${r}`}}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==Nt.eof}_match(t){if(t instanceof he)return this._check(t)?(this._advance(),!0):!1;for(let r=0,n=t.length;r<n;++r){let i=t[r];if(this._check(i))return this._advance(),!0}return!1}_consume(t,r){if(this._check(t))return this._advance();throw this._error(this._peek(),r)}_check(t){if(this._isAtEnd())return!1;let r=this._peek();if(t instanceof Array){let n=r.type;return t.indexOf(n)!=-1}return r.type==t}_advance(){var t,r;return this._currentLine=(r=(t=this._peek())===null||t===void 0?void 0:t.line)!==null&&r!==void 0?r:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(Nt.tokens.semicolon)&&!this._isAtEnd(););if(this._match(Nt.keywords.alias)){let r=this._type_alias();return this._consume(Nt.tokens.semicolon,"Expected ';'"),r}if(this._match(Nt.keywords.diagnostic)){let r=this._diagnostic();return this._consume(Nt.tokens.semicolon,"Expected ';'"),r}if(this._match(Nt.keywords.requires)){let r=this._requires_directive();return this._consume(Nt.tokens.semicolon,"Expected ';'"),r}if(this._match(Nt.keywords.enable)){let r=this._enable_directive();return this._consume(Nt.tokens.semicolon,"Expected ';'"),r}let t=this._attribute();if(this._check(Nt.keywords.var)){let r=this._global_variable_decl();return r!=null&&(r.attributes=t),this._consume(Nt.tokens.semicolon,"Expected ';'."),r}if(this._check(Nt.keywords.override)){let r=this._override_variable_decl();return r!=null&&(r.attributes=t),this._consume(Nt.tokens.semicolon,"Expected ';'."),r}if(this._check(Nt.keywords.let)){let r=this._global_let_decl();return r!=null&&(r.attributes=t),this._consume(Nt.tokens.semicolon,"Expected ';'."),r}if(this._check(Nt.keywords.const)){let r=this._global_const_decl();return r!=null&&(r.attributes=t),this._consume(Nt.tokens.semicolon,"Expected ';'."),r}if(this._check(Nt.keywords.struct)){let r=this._struct_decl();return r!=null&&(r.attributes=t),r}if(this._check(Nt.keywords.fn)){let r=this._function_decl();return r!=null&&(r.attributes=t),r}return null}_function_decl(){if(!this._match(Nt.keywords.fn))return null;let t=this._currentLine,r=this._consume(Nt.tokens.ident,"Expected function name.").toString();this._consume(Nt.tokens.paren_left,"Expected '(' for function arguments.");let n=[];if(!this._check(Nt.tokens.paren_right))do{if(this._check(Nt.tokens.paren_right))break;let c=this._attribute(),l=this._consume(Nt.tokens.ident,"Expected argument name.").toString();this._consume(Nt.tokens.colon,"Expected ':' for argument type.");let h=this._attribute(),p=this._type_decl();p!=null&&(p.attributes=h,n.push(new SB(l,p,c)))}while(this._match(Nt.tokens.comma));this._consume(Nt.tokens.paren_right,"Expected ')' after function arguments.");let i=null;if(this._match(Nt.tokens.arrow)){let c=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=c)}let o=this._compound_statement(),s=this._currentLine;return new zv(r,n,i,o,t,s)}_compound_statement(){let t=[];for(this._consume(Nt.tokens.brace_left,"Expected '{' for block.");!this._check(Nt.tokens.brace_right);){let r=this._statement();r!==null&&t.push(r)}return this._consume(Nt.tokens.brace_right,"Expected '}' for block."),t}_statement(){for(;this._match(Nt.tokens.semicolon)&&!this._isAtEnd(););if(this._check(Nt.tokens.attr)&&this._attribute(),this._check(Nt.keywords.if))return this._if_statement();if(this._check(Nt.keywords.switch))return this._switch_statement();if(this._check(Nt.keywords.loop))return this._loop_statement();if(this._check(Nt.keywords.for))return this._for_statement();if(this._check(Nt.keywords.while))return this._while_statement();if(this._check(Nt.keywords.continuing))return this._continuing_statement();if(this._check(Nt.keywords.static_assert))return this._static_assert_statement();if(this._check(Nt.tokens.brace_left))return this._compound_statement();let t=null;return this._check(Nt.keywords.return)?t=this._return_statement():this._check([Nt.keywords.var,Nt.keywords.let,Nt.keywords.const])?t=this._variable_statement():this._match(Nt.keywords.discard)?t=new gB:this._match(Nt.keywords.break)?t=new _B:this._match(Nt.keywords.continue)?t=new yB:t=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement(),t!=null&&this._consume(Nt.tokens.semicolon,"Expected ';' after statement."),t}_static_assert_statement(){if(!this._match(Nt.keywords.static_assert))return null;let t=this._optional_paren_expression();return new iB(t)}_while_statement(){if(!this._match(Nt.keywords.while))return null;let t=this._optional_paren_expression();this._check(Nt.tokens.attr)&&this._attribute();let r=this._compound_statement();return new oB(t,r)}_continuing_statement(){if(!this._match(Nt.keywords.continuing))return null;let t=this._compound_statement();return new sB(t)}_for_statement(){if(!this._match(Nt.keywords.for))return null;this._consume(Nt.tokens.paren_left,"Expected '('.");let t=this._check(Nt.tokens.semicolon)?null:this._for_init();this._consume(Nt.tokens.semicolon,"Expected ';'.");let r=this._check(Nt.tokens.semicolon)?null:this._short_circuit_or_expression();this._consume(Nt.tokens.semicolon,"Expected ';'.");let n=this._check(Nt.tokens.paren_right)?null:this._for_increment();this._consume(Nt.tokens.paren_right,"Expected ')'."),this._check(Nt.tokens.attr)&&this._attribute();let i=this._compound_statement();return new aB(t,r,n,i)}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(Nt.keywords.var)){let t=this._variable_decl();if(t===null)throw this._error(this._peek(),"Variable declaration expected.");let r=null;return this._match(Nt.tokens.equal)&&(r=this._short_circuit_or_expression()),new zp(t.name,t.type,t.storage,t.access,r)}if(this._match(Nt.keywords.let)){let t=this._consume(Nt.tokens.ident,"Expected name for let.").toString(),r=null;if(this._match(Nt.tokens.colon)){let i=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=i)}this._consume(Nt.tokens.equal,"Expected '=' for let.");let n=this._short_circuit_or_expression();return new Uv(t,r,null,null,n)}if(this._match(Nt.keywords.const)){let t=this._consume(Nt.tokens.ident,"Expected name for const.").toString(),r=null;if(this._match(Nt.tokens.colon)){let i=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=i)}this._consume(Nt.tokens.equal,"Expected '=' for const.");let n=this._short_circuit_or_expression();return new vM(t,r,null,null,n)}return null}_increment_decrement_statement(){let t=this._current,r=this._unary_expression();if(r==null)return null;if(!this._check(Nt.increment_operators))return this._current=t,null;let n=this._consume(Nt.increment_operators,"Expected increment operator");return new cB(n.type===Nt.tokens.plus_plus?z_.increment:z_.decrement,r)}_assignment_statement(){let t=null;if(this._check(Nt.tokens.brace_right))return null;let r=this._match(Nt.tokens.underscore);if(r||(t=this._unary_expression()),!r&&t==null)return null;let n=this._consume(Nt.assignment_operators,"Expected assignment operator."),i=this._short_circuit_or_expression();return new lB(Vv.parse(n.lexeme),t,i)}_func_call_statement(){if(!this._check(Nt.tokens.ident))return null;let t=this._current,r=this._consume(Nt.tokens.ident,"Expected function name."),n=this._argument_expression_list();return n===null?(this._current=t,null):new bM(r.lexeme,n)}_loop_statement(){if(!this._match(Nt.keywords.loop))return null;this._check(Nt.tokens.attr)&&this._attribute(),this._consume(Nt.tokens.brace_left,"Expected '{' for loop.");let t=[],r=this._statement();for(;r!==null;){if(Array.isArray(r))for(let i of r)t.push(i);else t.push(r);r=this._statement()}let n=null;return this._match(Nt.keywords.continuing)&&(n=this._compound_statement()),this._consume(Nt.tokens.brace_right,"Expected '}' for loop."),new uB(t,n)}_switch_statement(){if(!this._match(Nt.keywords.switch))return null;let t=this._optional_paren_expression();this._check(Nt.tokens.attr)&&this._attribute(),this._consume(Nt.tokens.brace_left,"Expected '{' for switch.");let r=this._switch_body();if(r==null||r.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(Nt.tokens.brace_right,"Expected '}' for switch."),new hB(t,r)}_switch_body(){let t=[];if(this._match(Nt.keywords.case)){let r=this._case_selectors();this._match(Nt.tokens.colon),this._check(Nt.tokens.attr)&&this._attribute(),this._consume(Nt.tokens.brace_left,"Exected '{' for switch case.");let n=this._case_body();this._consume(Nt.tokens.brace_right,"Exected '}' for switch case."),t.push(new EB(r,n))}if(this._match(Nt.keywords.default)){this._match(Nt.tokens.colon),this._check(Nt.tokens.attr)&&this._attribute(),this._consume(Nt.tokens.brace_left,"Exected '{' for switch default.");let r=this._case_body();this._consume(Nt.tokens.brace_right,"Exected '}' for switch default."),t.push(new MB(r))}if(this._check([Nt.keywords.default,Nt.keywords.case])){let r=this._switch_body();t.push(r[0])}return t}_case_selectors(){let t=[this._shift_expression()];for(;this._match(Nt.tokens.comma);)t.push(this._shift_expression());return t}_case_body(){if(this._match(Nt.keywords.fallthrough))return this._consume(Nt.tokens.semicolon,"Expected ';'"),[];let t=this._statement();if(t==null)return[];t instanceof Array||(t=[t]);let r=this._case_body();return r.length==0?t:[...t,r[0]]}_if_statement(){if(!this._match(Nt.keywords.if))return null;let t=this._optional_paren_expression();this._check(Nt.tokens.attr)&&this._attribute();let r=this._compound_statement(),n=[];this._match_elseif()&&(this._check(Nt.tokens.attr)&&this._attribute(),n=this._elseif_statement(n));let i=null;return this._match(Nt.keywords.else)&&(this._check(Nt.tokens.attr)&&this._attribute(),i=this._compound_statement()),new fB(t,r,n,i)}_match_elseif(){return this._tokens[this._current].type===Nt.keywords.else&&this._tokens[this._current+1].type===Nt.keywords.if?(this._advance(),this._advance(),!0):!1}_elseif_statement(t=[]){let r=this._optional_paren_expression(),n=this._compound_statement();return t.push(new CB(r,n)),this._match_elseif()&&(this._check(Nt.tokens.attr)&&this._attribute(),this._elseif_statement(t)),t}_return_statement(){if(!this._match(Nt.keywords.return))return null;let t=this._short_circuit_or_expression();return new pB(t)}_short_circuit_or_expression(){let t=this._short_circuit_and_expr();for(;this._match(Nt.tokens.or_or);)t=new Hu(this._previous().toString(),t,this._short_circuit_and_expr());return t}_short_circuit_and_expr(){let t=this._inclusive_or_expression();for(;this._match(Nt.tokens.and_and);)t=new Hu(this._previous().toString(),t,this._inclusive_or_expression());return t}_inclusive_or_expression(){let t=this._exclusive_or_expression();for(;this._match(Nt.tokens.or);)t=new Hu(this._previous().toString(),t,this._exclusive_or_expression());return t}_exclusive_or_expression(){let t=this._and_expression();for(;this._match(Nt.tokens.xor);)t=new Hu(this._previous().toString(),t,this._and_expression());return t}_and_expression(){let t=this._equality_expression();for(;this._match(Nt.tokens.and);)t=new Hu(this._previous().toString(),t,this._equality_expression());return t}_equality_expression(){let t=this._relational_expression();return this._match([Nt.tokens.equal_equal,Nt.tokens.not_equal])?new Hu(this._previous().toString(),t,this._relational_expression()):t}_relational_expression(){let t=this._shift_expression();for(;this._match([Nt.tokens.less_than,Nt.tokens.greater_than,Nt.tokens.less_than_equal,Nt.tokens.greater_than_equal]);)t=new Hu(this._previous().toString(),t,this._shift_expression());return t}_shift_expression(){let t=this._additive_expression();for(;this._match([Nt.tokens.shift_left,Nt.tokens.shift_right]);)t=new Hu(this._previous().toString(),t,this._additive_expression());return t}_additive_expression(){let t=this._multiplicative_expression();for(;this._match([Nt.tokens.plus,Nt.tokens.minus]);)t=new Hu(this._previous().toString(),t,this._multiplicative_expression());return t}_multiplicative_expression(){let t=this._unary_expression();for(;this._match([Nt.tokens.star,Nt.tokens.forward_slash,Nt.tokens.modulo]);)t=new Hu(this._previous().toString(),t,this._unary_expression());return t}_unary_expression(){return this._match([Nt.tokens.minus,Nt.tokens.bang,Nt.tokens.tilde,Nt.tokens.star,Nt.tokens.and])?new TB(this._previous().toString(),this._unary_expression()):this._singular_expression()}_singular_expression(){let t=this._primary_expression(),r=this._postfix_expression();return r&&(t.postfix=r),t}_postfix_expression(){if(this._match(Nt.tokens.bracket_left)){let t=this._short_circuit_or_expression();this._consume(Nt.tokens.bracket_right,"Expected ']'.");let r=new wB(t),n=this._postfix_expression();return n&&(r.postfix=n),r}if(this._match(Nt.tokens.period)){let t=this._consume(Nt.tokens.ident,"Expected member name."),r=this._postfix_expression(),n=new MM(t.lexeme);return r&&(n.postfix=r),n}return null}_getStruct(t){return this._context.aliases.has(t)?this._context.aliases.get(t).type:this._context.structs.has(t)?this._context.structs.get(t):null}_primary_expression(){if(this._match(Nt.tokens.ident)){let n=this._previous().toString();if(this._check(Nt.tokens.paren_left)){let i=this._argument_expression_list(),o=this._getStruct(n);return o!=null?new om(o,i):new SM(n,i)}if(this._context.constants.has(n)){let i=this._context.constants.get(n);return new CM(n,i.value)}return new jv(n)}if(this._match(Nt.const_literal))return new PM(parseFloat(this._previous().toString()));if(this._check(Nt.tokens.paren_left))return this._paren_expression();if(this._match(Nt.keywords.bitcast)){this._consume(Nt.tokens.less_than,"Expected '<'.");let n=this._type_decl();this._consume(Nt.tokens.greater_than,"Expected '>'.");let i=this._paren_expression();return new vB(n,i)}let t=this._type_decl(),r=this._argument_expression_list();return new bB(t,r)}_argument_expression_list(){if(!this._match(Nt.tokens.paren_left))return null;let t=[];do{if(this._check(Nt.tokens.paren_right))break;let r=this._short_circuit_or_expression();t.push(r)}while(this._match(Nt.tokens.comma));return this._consume(Nt.tokens.paren_right,"Expected ')' for agument list"),t}_optional_paren_expression(){this._match(Nt.tokens.paren_left);let t=this._short_circuit_or_expression();return this._match(Nt.tokens.paren_right),new IM([t])}_paren_expression(){this._consume(Nt.tokens.paren_left,"Expected '('.");let t=this._short_circuit_or_expression();return this._consume(Nt.tokens.paren_right,"Expected ')'."),new IM([t])}_struct_decl(){if(!this._match(Nt.keywords.struct))return null;let t=this._currentLine,r=this._consume(Nt.tokens.ident,"Expected name for struct.").toString();this._consume(Nt.tokens.brace_left,"Expected '{' for struct body.");let n=[];for(;!this._check(Nt.tokens.brace_right);){let s=this._attribute(),c=this._consume(Nt.tokens.ident,"Expected variable name.").toString();this._consume(Nt.tokens.colon,"Expected ':' for struct member type.");let l=this._attribute(),h=this._type_decl();h!=null&&(h.attributes=l),this._check(Nt.tokens.brace_right)?this._match(Nt.tokens.comma):this._consume(Nt.tokens.comma,"Expected ',' for struct member."),n.push(new PB(c,h,s))}this._consume(Nt.tokens.brace_right,"Expected '}' after struct body.");let i=this._currentLine,o=new Fp(r,n,t,i);return this._context.structs.set(r,o),o}_global_variable_decl(){let t=this._variable_decl();return t&&this._match(Nt.tokens.equal)&&(t.value=this._const_expression()),t}_override_variable_decl(){let t=this._override_decl();return t&&this._match(Nt.tokens.equal)&&(t.value=this._const_expression()),t}_global_const_decl(){if(!this._match(Nt.keywords.const))return null;let t=this._consume(Nt.tokens.ident,"Expected variable name"),r=null;if(this._match(Nt.tokens.colon)){let o=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=o)}let n=null;if(this._match(Nt.tokens.equal)){let o=this._short_circuit_or_expression();if(o instanceof om)n=o;else if(o instanceof CM&&o.initializer instanceof om)n=o.initializer;else try{let s=o.evaluate(this._context);n=new PM(s)}catch{n=o}}let i=new vM(t.toString(),r,"","",n);return this._context.constants.set(i.name,i),i}_global_let_decl(){if(!this._match(Nt.keywords.let))return null;let t=this._consume(Nt.tokens.ident,"Expected variable name"),r=null;if(this._match(Nt.tokens.colon)){let i=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=i)}let n=null;return this._match(Nt.tokens.equal)&&(n=this._const_expression()),new Uv(t.toString(),r,"","",n)}_const_expression(){if(this._match(Nt.const_literal))return new MM(this._previous().toString());let t=this._type_decl();this._consume(Nt.tokens.paren_left,"Expected '('.");let r=[];for(;!this._check(Nt.tokens.paren_right)&&(r.push(this._const_expression()),!!this._check(Nt.tokens.comma));)this._advance();return this._consume(Nt.tokens.paren_right,"Expected ')'."),new om(t,r)}_variable_decl(){if(!this._match(Nt.keywords.var))return null;let t="",r="";this._match(Nt.tokens.less_than)&&(t=this._consume(Nt.storage_class,"Expected storage_class.").toString(),this._match(Nt.tokens.comma)&&(r=this._consume(Nt.access_mode,"Expected access_mode.").toString()),this._consume(Nt.tokens.greater_than,"Expected '>'."));let n=this._consume(Nt.tokens.ident,"Expected variable name"),i=null;if(this._match(Nt.tokens.colon)){let o=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=o)}return new zp(n.toString(),i,t,r,null)}_override_decl(){if(!this._match(Nt.keywords.override))return null;let t=this._consume(Nt.tokens.ident,"Expected variable name"),r=null;if(this._match(Nt.tokens.colon)){let n=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=n)}return new xM(t.toString(),r,null)}_diagnostic(){this._consume(Nt.tokens.paren_left,"Expected '('");let t=this._consume(Nt.tokens.ident,"Expected severity control name.");this._consume(Nt.tokens.comma,"Expected ','");let r=this._consume(Nt.tokens.ident,"Expected diagnostic rule name.");return this._consume(Nt.tokens.paren_right,"Expected ')'"),new AB(t.toString(),r.toString())}_enable_directive(){let t=this._consume(Nt.tokens.ident,"identity expected.");return new dB(t.toString())}_requires_directive(){let t=[this._consume(Nt.tokens.ident,"identity expected.").toString()];for(;this._match(Nt.tokens.comma);){let r=this._consume(Nt.tokens.ident,"identity expected.");t.push(r.toString())}return new mB(t)}_type_alias(){let t=this._consume(Nt.tokens.ident,"identity expected.");this._consume(Nt.tokens.equal,"Expected '=' for type alias.");let r=this._type_decl();if(r===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);let n=new wM(t.toString(),r);return this._context.aliases.set(n.name,n),n}_type_decl(){if(this._check([Nt.tokens.ident,...Nt.texel_format,Nt.keywords.bool,Nt.keywords.f32,Nt.keywords.i32,Nt.keywords.u32])){let n=this._advance(),i=n.toString();return this._context.structs.has(i)?this._context.structs.get(i):this._context.aliases.has(i)?this._context.aliases.get(i).type:new Up(n.toString())}let t=this._texture_sampler_types();if(t)return t;if(this._check(Nt.template_types)){let n=this._advance().toString(),i=null,o=null;return this._match(Nt.tokens.less_than)&&(i=this._type_decl(),o=null,this._match(Nt.tokens.comma)&&(o=this._consume(Nt.access_mode,"Expected access_mode for pointer").toString()),this._consume(Nt.tokens.greater_than,"Expected '>' for type.")),new TM(n,i,o)}if(this._match(Nt.keywords.ptr)){let n=this._previous().toString();this._consume(Nt.tokens.less_than,"Expected '<' for pointer.");let i=this._consume(Nt.storage_class,"Expected storage_class for pointer");this._consume(Nt.tokens.comma,"Expected ',' for pointer.");let o=this._type_decl(),s=null;return this._match(Nt.tokens.comma)&&(s=this._consume(Nt.access_mode,"Expected access_mode for pointer").toString()),this._consume(Nt.tokens.greater_than,"Expected '>' for pointer."),new xB(n,i.toString(),o,s)}let r=this._attribute();if(this._match(Nt.keywords.array)){let n=null,i=-1,o=this._previous(),s=null;if(this._match(Nt.tokens.less_than)){n=this._type_decl(),this._context.aliases.has(n.name)&&(n=this._context.aliases.get(n.name).type);let l="";if(this._match(Nt.tokens.comma)){s=this._shift_expression();try{l=s.evaluate(this._context).toString(),s=null}catch{l="1"}}this._consume(Nt.tokens.greater_than,"Expected '>' for array."),i=l?parseInt(l):0}let c=new EM(o.toString(),r,n,i);return s&&this._deferArrayCountEval.push({arrayType:c,countNode:s}),c}return null}_texture_sampler_types(){if(this._match(Nt.sampler_type))return new QA(this._previous().toString(),null,null);if(this._match(Nt.depth_texture_type))return new QA(this._previous().toString(),null,null);if(this._match(Nt.sampled_texture_type)||this._match(Nt.multisampled_texture_type)){let t=this._previous();this._consume(Nt.tokens.less_than,"Expected '<' for sampler type.");let r=this._type_decl();return this._consume(Nt.tokens.greater_than,"Expected '>' for sampler type."),new QA(t.toString(),r,null)}if(this._match(Nt.storage_texture_type)){let t=this._previous();this._consume(Nt.tokens.less_than,"Expected '<' for sampler type.");let r=this._consume(Nt.texel_format,"Invalid texel format.").toString();this._consume(Nt.tokens.comma,"Expected ',' after texel format.");let n=this._consume(Nt.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(Nt.tokens.greater_than,"Expected '>' for sampler type."),new QA(t.toString(),r,n)}return null}_attribute(){let t=[];for(;this._match(Nt.tokens.attr);){let r=this._consume(Nt.attribute_name,"Expected attribute name"),n=new IB(r.toString(),null);if(this._match(Nt.tokens.paren_left)){if(n.value=this._consume(Nt.literal_or_ident,"Expected attribute value").toString(),this._check(Nt.tokens.comma)){this._advance();do{let i=this._consume(Nt.literal_or_ident,"Expected attribute value").toString();n.value instanceof Array||(n.value=[n.value]),n.value.push(i)}while(this._match(Nt.tokens.comma))}this._consume(Nt.tokens.paren_right,"Expected ')'")}t.push(n)}return t.length==0?null:t}},sm=class{constructor(t,r){this.name=t,this.attributes=r,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}},BM=class{constructor(t,r,n){this.name=t,this.type=r,this.attributes=n,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray?this.type.format:this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}},B_=class extends sm{constructor(t,r){super(t,r),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}},Fv=class extends sm{constructor(t,r){super(t,r),this.count=0,this.stride=0}get isArray(){return!0}},DM=class extends sm{constructor(t,r,n,i){super(t,n),this.format=r,this.access=i}get isTemplate(){return!0}},im;(function(e){e[e.Uniform=0]="Uniform",e[e.Storage=1]="Storage",e[e.Texture=2]="Texture",e[e.Sampler=3]="Sampler",e[e.StorageTexture=4]="StorageTexture"})(im||(im={}));var D_=class{constructor(t,r,n,i,o,s,c){this.name=t,this.type=r,this.group=n,this.binding=i,this.attributes=o,this.resourceType=s,this.access=c}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray?this.type.format:this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}},OB=class{constructor(t,r){this.name=t,this.type=r}},N_=class{constructor(t,r){this.align=t,this.size=r}},BB=class{constructor(t,r,n,i){this.name=t,this.type=r,this.locationType=n,this.location=i,this.interpolation=null}},NM=class{constructor(t,r,n,i){this.name=t,this.type=r,this.locationType=n,this.location=i}},DB=class{constructor(t,r=null){this.stage=null,this.inputs=[],this.outputs=[],this.resources=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=t,this.stage=r}},NB=class{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}},kB=class{constructor(t,r,n,i){this.name=t,this.type=r,this.attributes=n,this.id=i}},FB=class{constructor(t){this.resources=null,this.inUse=!1,this.info=null,this.node=t}},Wu=class{constructor(t){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new NB,this.functions=[],this._types=new Map,this._functions=new Map,t&&this.update(t)}_isStorageTexture(t){return t.name=="texture_storage_1d"||t.name=="texture_storage_2d"||t.name=="texture_storage_2d_array"||t.name=="texture_storage_3d"}update(t){let n=new LB().parse(t);for(let i of n)i instanceof zv&&this._functions.set(i.name,new FB(i));for(let i of n)if(i instanceof Fp){let o=this._getTypeInfo(i,null);o instanceof B_&&this.structs.push(o)}for(let i of n){if(i instanceof wM){this.aliases.push(this._getAliasInfo(i));continue}if(i instanceof xM){let o=i,s=this._getAttributeNum(o.attributes,"id",0),c=o.type!=null?this._getTypeInfo(o.type,o.attributes):null;this.overrides.push(new kB(o.name,c,o.attributes,s));continue}if(this._isUniformVar(i)){let o=i,s=this._getAttributeNum(o.attributes,"group",0),c=this._getAttributeNum(o.attributes,"binding",0),l=this._getTypeInfo(o.type,o.attributes),h=new D_(o.name,l,s,c,o.attributes,im.Uniform,o.access);this.uniforms.push(h);continue}if(this._isStorageVar(i)){let o=i,s=this._getAttributeNum(o.attributes,"group",0),c=this._getAttributeNum(o.attributes,"binding",0),l=this._getTypeInfo(o.type,o.attributes),h=this._isStorageTexture(l),p=new D_(o.name,l,s,c,o.attributes,h?im.StorageTexture:im.Storage,o.access);this.storage.push(p);continue}if(this._isTextureVar(i)){let o=i,s=this._getAttributeNum(o.attributes,"group",0),c=this._getAttributeNum(o.attributes,"binding",0),l=this._getTypeInfo(o.type,o.attributes),h=this._isStorageTexture(l),p=new D_(o.name,l,s,c,o.attributes,h?im.StorageTexture:im.Texture,o.access);h?this.storage.push(p):this.textures.push(p);continue}if(this._isSamplerVar(i)){let o=i,s=this._getAttributeNum(o.attributes,"group",0),c=this._getAttributeNum(o.attributes,"binding",0),l=this._getTypeInfo(o.type,o.attributes),h=new D_(o.name,l,s,c,o.attributes,im.Sampler,o.access);this.samplers.push(h);continue}if(i instanceof zv){let o=this._getAttribute(i,"vertex"),s=this._getAttribute(i,"fragment"),c=this._getAttribute(i,"compute"),l=o||s||c,h=new DB(i.name,l?.name);h.startLine=i.startLine,h.endLine=i.endLine,this.functions.push(h),this._functions.get(i.name).info=h,l&&(this._functions.get(i.name).inUse=!0,h.inUse=!0,h.resources=this._findResources(i,!!l),h.inputs=this._getInputs(i.args),h.outputs=this._getOutputs(i.returnType),this.entry[l.name].push(h));continue}}for(let i of this._functions.values())i.info&&(i.info.inUse=i.inUse,this._addCalls(i.node,i.info.calls));for(let i of this.uniforms)this._markStructsInUse(i.type);for(let i of this.storage)this._markStructsInUse(i.type)}_markStructsInUse(t){if(t.isStruct){t.inUse=!0;for(let r of t.members)this._markStructsInUse(r.type)}else if(t.isArray)this._markStructsInUse(t.format);else if(t.isTemplate)this._markStructsInUse(t.format);else{let r=this._getAlias(t.name);r&&this._markStructsInUse(r)}}_addCalls(t,r){var n;for(let i of t.calls){let o=(n=this._functions.get(i.name))===null||n===void 0?void 0:n.info;o&&r.add(o)}}findResource(t,r){for(let n of this.uniforms)if(n.group==t&&n.binding==r)return n;for(let n of this.storage)if(n.group==t&&n.binding==r)return n;for(let n of this.textures)if(n.group==t&&n.binding==r)return n;for(let n of this.samplers)if(n.group==t&&n.binding==r)return n;return null}_findResource(t){for(let r of this.uniforms)if(r.name==t)return r;for(let r of this.storage)if(r.name==t)return r;for(let r of this.textures)if(r.name==t)return r;for(let r of this.samplers)if(r.name==t)return r;return null}_markStructsFromAST(t){let r=this._getTypeInfo(t,null);this._markStructsInUse(r)}_findResources(t,r){let n=[],i=this,o=[];return t.search(s=>{if(s instanceof k_)o.push({});else if(s instanceof F_)o.pop();else if(s instanceof zp){let c=s;r&&c.type!==null&&this._markStructsFromAST(c.type),o.length>0&&(o[o.length-1][c.name]=c)}else if(s instanceof om){let c=s;r&&c.type!==null&&this._markStructsFromAST(c.type)}else if(s instanceof Uv){let c=s;r&&c.type!==null&&this._markStructsFromAST(c.type),o.length>0&&(o[o.length-1][c.name]=c)}else if(s instanceof jv){let c=s;if(o.length>0&&o[o.length-1][c.name])return;let l=i._findResource(c.name);l&&n.push(l)}else if(s instanceof SM){let c=s,l=i._functions.get(c.name);l&&(r&&(l.inUse=!0),t.calls.add(l.node),l.resources===null&&(l.resources=i._findResources(l.node,r)),n.push(...l.resources))}else if(s instanceof bM){let c=s,l=i._functions.get(c.name);l&&(r&&(l.inUse=!0),t.calls.add(l.node),l.resources===null&&(l.resources=i._findResources(l.node,r)),n.push(...l.resources))}}),[...new Map(n.map(s=>[s.name,s])).values()]}getBindGroups(){let t=[];function r(n,i){n>=t.length&&(t.length=n+1),t[n]===void 0&&(t[n]=[]),i>=t[n].length&&(t[n].length=i+1)}for(let n of this.uniforms){r(n.group,n.binding);let i=t[n.group];i[n.binding]=n}for(let n of this.storage){r(n.group,n.binding);let i=t[n.group];i[n.binding]=n}for(let n of this.textures){r(n.group,n.binding);let i=t[n.group];i[n.binding]=n}for(let n of this.samplers){r(n.group,n.binding);let i=t[n.group];i[n.binding]=n}return t}_getOutputs(t,r=void 0){if(r===void 0&&(r=[]),t instanceof Fp)this._getStructOutputs(t,r);else{let n=this._getOutputInfo(t);n!==null&&r.push(n)}return r}_getStructOutputs(t,r){for(let n of t.members)if(n.type instanceof Fp)this._getStructOutputs(n.type,r);else{let i=this._getAttribute(n,"location")||this._getAttribute(n,"builtin");if(i!==null){let o=this._getTypeInfo(n.type,n.type.attributes),s=this._parseInt(i.value),c=new NM(n.name,o,i.name,s);r.push(c)}}}_getOutputInfo(t){let r=this._getAttribute(t,"location")||this._getAttribute(t,"builtin");if(r!==null){let n=this._getTypeInfo(t,t.attributes),i=this._parseInt(r.value);return new NM("",n,r.name,i)}return null}_getInputs(t,r=void 0){r===void 0&&(r=[]);for(let n of t)if(n.type instanceof Fp)this._getStructInputs(n.type,r);else{let i=this._getInputInfo(n);i!==null&&r.push(i)}return r}_getStructInputs(t,r){for(let n of t.members)if(n.type instanceof Fp)this._getStructInputs(n.type,r);else{let i=this._getInputInfo(n);i!==null&&r.push(i)}}_getInputInfo(t){let r=this._getAttribute(t,"location")||this._getAttribute(t,"builtin");if(r!==null){let n=this._getAttribute(t,"interpolation"),i=this._getTypeInfo(t.type,t.attributes),o=this._parseInt(r.value),s=new BB(t.name,i,r.name,o);return n!==null&&(s.interpolation=this._parseString(n.value)),s}return null}_parseString(t){return t instanceof Array&&(t=t[0]),t}_parseInt(t){t instanceof Array&&(t=t[0]);let r=parseInt(t);return isNaN(r)?t:r}_getAlias(t){for(let r of this.aliases)if(r.name==t)return r.type;return null}_getAliasInfo(t){return new OB(t.name,this._getTypeInfo(t.type,null))}_getTypeInfo(t,r){if(this._types.has(t))return this._types.get(t);if(t instanceof EM){let i=t,o=this._getTypeInfo(i.format,i.attributes),s=new Fv(i.name,r);return s.format=o,s.count=i.count,this._types.set(t,s),this._updateTypeInfo(s),s}if(t instanceof Fp){let i=t,o=new B_(i.name,r);o.startLine=i.startLine,o.endLine=i.endLine;for(let s of i.members){let c=this._getTypeInfo(s.type,s.attributes);o.members.push(new BM(s.name,c,s.attributes))}return this._types.set(t,o),this._updateTypeInfo(o),o}if(t instanceof QA){let i=t,o=i.format instanceof Up,s=i.format?o?this._getTypeInfo(i.format,null):new sm(i.format,null):null,c=new DM(i.name,s,r,i.access);return this._types.set(t,c),this._updateTypeInfo(c),c}if(t instanceof TM){let i=t,o=i.format?this._getTypeInfo(i.format,null):null,s=new DM(i.name,o,r,i.access);return this._types.set(t,s),this._updateTypeInfo(s),s}let n=new sm(t.name,r);return this._types.set(t,n),this._updateTypeInfo(n),n}_updateTypeInfo(t){var r,n;let i=this._getTypeSize(t);if(t.size=(r=i?.size)!==null&&r!==void 0?r:0,t instanceof Fv){let o=this._getTypeSize(t.format);t.stride=(n=o?.size)!==null&&n!==void 0?n:0,this._updateTypeInfo(t.format)}t instanceof B_&&this._updateStructInfo(t)}_updateStructInfo(t){var r;let n=0,i=0,o=0,s=0;for(let c=0,l=t.members.length;c<l;++c){let h=t.members[c],p=this._getTypeSize(h);if(!p)continue;(r=this._getAlias(h.type.name))!==null&&r!==void 0||h.type;let x=p.align,w=p.size;n=this._roundUp(x,n+i),i=w,o=n,s=Math.max(s,x),h.offset=n,h.size=w,this._updateTypeInfo(h.type)}t.size=this._roundUp(s,o+i),t.align=s}_getTypeSize(t){var r;if(t==null)return null;let n=this._getAttributeNum(t.attributes,"size",0),i=this._getAttributeNum(t.attributes,"align",0);if(t instanceof BM&&(t=t.type),t instanceof sm){let o=this._getAlias(t.name);o!==null&&(t=o)}{let o=Wu._typeInfo[t.name];if(o!==void 0){let s=t.format==="f16"?2:1;return new N_(Math.max(i,o.align/s),Math.max(n,o.size/s))}}{let o=Wu._typeInfo[t.name.substring(0,t.name.length-1)];if(o){let s=t.name[t.name.length-1]==="h"?2:1;return new N_(Math.max(i,o.align/s),Math.max(n,o.size/s))}}if(t instanceof Fv){let o=t,s=8,c=8,l=this._getTypeSize(o.format);l!==null&&(c=l.size,s=l.align);let h=o.count,p=this._getAttributeNum((r=t?.attributes)!==null&&r!==void 0?r:null,"stride",this._roundUp(s,c));return c=h*p,n&&(c=n),new N_(Math.max(i,s),Math.max(n,c))}if(t instanceof B_){let o=0,s=0,c=0,l=0,h=0;for(let p of t.members){let x=this._getTypeSize(p.type);x!==null&&(o=Math.max(x.align,o),c=this._roundUp(x.align,c+l),l=x.size,h=c)}return s=this._roundUp(o,h+l),new N_(Math.max(i,o),Math.max(n,s))}return null}_isUniformVar(t){return t instanceof zp&&t.storage=="uniform"}_isStorageVar(t){return t instanceof zp&&t.storage=="storage"}_isTextureVar(t){return t instanceof zp&&t.type!==null&&Wu._textureTypes.indexOf(t.type.name)!=-1}_isSamplerVar(t){return t instanceof zp&&t.type!==null&&Wu._samplerTypes.indexOf(t.type.name)!=-1}_getAttribute(t,r){let n=t;if(!n||!n.attributes)return null;let i=n.attributes;for(let o of i)if(o.name==r)return o;return null}_getAttributeNum(t,r,n){if(t===null)return n;for(let i of t)if(i.name==r){let o=i!==null&&i.value!==null?i.value:n;return o instanceof Array&&(o=o[0]),typeof o=="number"?o:typeof o=="string"?parseInt(o):n}return n}_roundUp(t,r){return Math.ceil(r/t)*t}};Wu._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}};Wu._textureTypes=Nt.any_texture_type.map(e=>e.name);Wu._samplerTypes=Nt.sampler_type.map(e=>e.name);function zB(e){let t={attributes:[],bindings:[]},r;try{r=LAt(e)}catch(o){return qe.error(o.message)(),t}for(let o of r.uniforms){let s=[];for(let c of o.type?.members||[])s.push({name:c.name,type:Tj(c.type)});t.bindings.push({type:"uniform",name:o.name,group:o.group,location:o.binding,members:s})}for(let o of r.textures)t.bindings.push({type:"texture",name:o.name,group:o.group,location:o.binding});for(let o of r.samplers)t.bindings.push({type:"sampler",name:o.name,group:o.group,location:o.binding});let n=r.entry.vertex[0],i=n?.inputs.length||0;for(let o=0;o<i;o++){let s=n.inputs[o];if(s.locationType==="location"){let c=Tj(s.type);t.attributes.push({name:s.name,location:Number(s.location),type:c})}}return t}function Tj(e){return e.format?`${e.name}<${e.format.name}>`:e.name}function LAt(e){try{return new Wu(e)}catch(t){if(t instanceof Error)throw t;let r="WGSL parse error";throw typeof t=="object"&&t?.message&&(r+=`: ${t.message} `),typeof t=="object"&&t?.token&&(r+=t.token.line||""),new Error(r,{cause:t})}}var OAt=1/Math.PI*180,BAt=1/180*Math.PI,DAt={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...DAt}};var Zo=globalThis.mathgl.config;function Hv(e,{precision:t=Zo.precision}={}){return e=NAt(e),`${parseFloat(e.toPrecision(t))}`}function lu(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function U_(e,t){return UB(e,r=>r*BAt,t)}function am(e,t){return UB(e,r=>r*OAt,t)}function ro(e,t,r){return UB(e,n=>Math.max(t,Math.min(r,n)))}function ka(e,t,r){return lu(e)?e.map((n,i)=>ka(n,t[i],r)):r*t+(1-r)*e}function Fa(e,t,r){let n=Zo.EPSILON;r&&(Zo.EPSILON=r);try{if(e===t)return!0;if(lu(e)&&lu(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!Fa(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<=Zo.EPSILON*Math.max(1,Math.abs(e),Math.abs(t)):!1}finally{Zo.EPSILON=n}}function NAt(e){return Math.round(e/Zo.EPSILON)*Zo.EPSILON}function kAt(e){return e.clone?e.clone():new Array(e.length)}function UB(e,t,r){if(lu(e)){let n=e;r=r||kAt(n);for(let i=0;i<r.length&&i<n.length;++i){let o=typeof e=="number"?e:e[i];r[i]=t(o,i,r)}return r}return t(e)}var cm=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(t,r=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+r];return this.check()}toArray(t=[],r=0){for(let n=0;n<this.ELEMENTS;++n)t[r+n]=this[n];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:lu(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Zo)}formatString(t){let r="";for(let n=0;n<this.ELEMENTS;++n)r+=(n>0?", ":"")+Hv(this[n],t);return`${t.printTypes?this.constructor.name:""}[${r}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(!Fa(this[r],t[r]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==t[r])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,r,n){if(n===void 0)return this.lerp(this,t,r);for(let i=0;i<this.ELEMENTS;++i){let o=t[i],s=typeof r=="number"?r:r[i];this[i]=o+n*(s-o)}return this.check()}min(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(t[r],this[r]);return this.check()}max(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(t[r],this[r]);return this.check()}clamp(t,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),r[n]);return this.check()}add(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]+=r[n];return this.check()}subtract(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]-=r[n];return this.check()}scale(t){if(typeof t=="number")for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;else for(let r=0;r<this.ELEMENTS&&r<t.length;++r)this[r]*=t[r];return this.check()}multiplyByScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}check(){if(Zo.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)t=t&&Number.isFinite(this[r]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=t;return this.check()}addScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),r);return this.check()}get elements(){return this}};function FAt(e,t){if(e.length!==t)return!1;for(let r=0;r<e.length;++r)if(!Number.isFinite(e[r]))return!1;return!0}function Li(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function lm(e,t,r=""){if(Zo.debug&&!FAt(e,t))throw new Error(`math.gl: ${r} some fields set to invalid numbers'`);return e}function Vf(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}var um=class extends cm{get x(){return this[0]}set x(t){this[0]=Li(t)}get y(){return this[1]}set y(t){this[1]=Li(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let r=0;r<this.ELEMENTS;++r)t+=this[r]*this[r];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let r=0;for(let n=0;n<this.ELEMENTS;++n){let i=this[n]-t[n];r+=i*i}return Li(r)}dot(t){let r=0;for(let n=0;n<this.ELEMENTS;++n)r+=this[n]*t[n];return Li(r)}normalize(){let t=this.magnitude();if(t!==0)for(let r=0;r<this.ELEMENTS;++r)this[r]/=t;return this.check()}multiply(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]*=r[n];return this.check()}divide(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]/=r[n];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return Vf(t>=0&&t<this.ELEMENTS,"index is out of range"),Li(this[t])}setComponent(t,r){return Vf(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=r,this.check()}addVectors(t,r){return this.copy(t).add(r)}subVectors(t,r){return this.copy(t).subtract(r)}multiplyVectors(t,r){return this.copy(t).multiply(r)}addScaledVector(t,r){return this.add(new this.constructor(t).multiplyScalar(r))}};var ba={};Lo(ba,{add:()=>HAt,angle:()=>o0t,ceil:()=>WAt,clone:()=>zAt,copy:()=>VAt,create:()=>Ej,cross:()=>e0t,dist:()=>d0t,distance:()=>Pj,div:()=>p0t,divide:()=>Cj,dot:()=>t0t,equals:()=>l0t,exactEquals:()=>c0t,floor:()=>qAt,forEach:()=>g0t,fromValues:()=>UAt,inverse:()=>QAt,len:()=>u0t,length:()=>Rj,lerp:()=>r0t,max:()=>XAt,min:()=>GAt,mul:()=>f0t,multiply:()=>Sj,negate:()=>$At,normalize:()=>JAt,random:()=>n0t,rotate:()=>i0t,round:()=>YAt,scale:()=>KAt,scaleAndAdd:()=>ZAt,set:()=>jAt,sqrDist:()=>m0t,sqrLen:()=>A0t,squaredDistance:()=>Ij,squaredLength:()=>Lj,str:()=>a0t,sub:()=>h0t,subtract:()=>Mj,transformMat2:()=>VB,transformMat2d:()=>jB,transformMat3:()=>Wv,transformMat4:()=>qv,zero:()=>s0t});var Bo=typeof Float32Array<"u"?Float32Array:Array,jf=Math.random;function qu(e){return e>=0?Math.round(e):e%.5===0?Math.floor(e):Math.round(e)}var nKt=Math.PI/180;function Ej(){let e=new Bo(2);return Bo!=Float32Array&&(e[0]=0,e[1]=0),e}function zAt(e){let t=new Bo(2);return t[0]=e[0],t[1]=e[1],t}function UAt(e,t){let r=new Bo(2);return r[0]=e,r[1]=t,r}function VAt(e,t){return e[0]=t[0],e[1]=t[1],e}function jAt(e,t,r){return e[0]=t,e[1]=r,e}function HAt(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function Mj(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function Sj(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function Cj(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function WAt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function qAt(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function GAt(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function XAt(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function YAt(e,t){return e[0]=qu(t[0]),e[1]=qu(t[1]),e}function KAt(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function ZAt(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e}function Pj(e,t){let r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}function Ij(e,t){let r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function Rj(e){let t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function Lj(e){let t=e[0],r=e[1];return t*t+r*r}function $At(e,t){return e[0]=-t[0],e[1]=-t[1],e}function QAt(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function JAt(e,t){let r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function t0t(e,t){return e[0]*t[0]+e[1]*t[1]}function e0t(e,t,r){let n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e}function r0t(e,t,r,n){let i=t[0],o=t[1];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e}function n0t(e,t){t=t===void 0?1:t;let r=jf()*2*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}function VB(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e}function jB(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}function Wv(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e}function qv(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e}function i0t(e,t,r,n){let i=t[0]-r[0],o=t[1]-r[1],s=Math.sin(n),c=Math.cos(n);return e[0]=i*c-o*s+r[0],e[1]=i*s+o*c+r[1],e}function o0t(e,t){let r=e[0],n=e[1],i=t[0],o=t[1],s=Math.sqrt((r*r+n*n)*(i*i+o*o)),c=s&&(r*i+n*o)/s;return Math.acos(Math.min(Math.max(c,-1),1))}function s0t(e){return e[0]=0,e[1]=0,e}function a0t(e){return`vec2(${e[0]}, ${e[1]})`}function c0t(e,t){return e[0]===t[0]&&e[1]===t[1]}function l0t(e,t){let r=e[0],n=e[1],i=t[0],o=t[1];return Math.abs(r-i)<=1e-6*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-o)<=1e-6*Math.max(1,Math.abs(n),Math.abs(o))}var u0t=Rj,h0t=Mj,f0t=Sj,p0t=Cj,d0t=Pj,m0t=Ij,A0t=Lj,g0t=function(){let e=Ej();return function(t,r,n,i,o,s){let c,l;for(r||(r=2),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],o(e,e,s),t[c]=e[0],t[c+1]=e[1];return t}}();function kM(e,t,r){let n=t[0],i=t[1],o=r[3]*n+r[7]*i||1;return e[0]=(r[0]*n+r[4]*i)/o,e[1]=(r[1]*n+r[5]*i)/o,e}function FM(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[3]*n+r[7]*i+r[11]*o||1;return e[0]=(r[0]*n+r[4]*i+r[8]*o)/s,e[1]=(r[1]*n+r[5]*i+r[9]*o)/s,e[2]=(r[2]*n+r[6]*i+r[10]*o)/s,e}function Oj(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e[2]=t[2],e}function Bj(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e[2]=t[2],e[3]=t[3],e}function zM(e,t,r){let n=t[0],i=t[1],o=t[2];return e[0]=r[0]*n+r[3]*i+r[6]*o,e[1]=r[1]*n+r[4]*i+r[7]*o,e[2]=r[2]*n+r[5]*i+r[8]*o,e[3]=t[3],e}var JA=class extends um{constructor(t=0,r=0){super(2),lu(t)&&arguments.length===1?this.copy(t):(Zo.debug&&(Li(t),Li(r)),this[0]=t,this[1]=r)}set(t,r){return this[0]=t,this[1]=r,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return Zo.debug&&(Li(t.x),Li(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return qv(this,this,t),this.check()}transformAsVector(t){return kM(this,this,t),this.check()}transformByMatrix3(t){return Wv(this,this,t),this.check()}transformByMatrix2x3(t){return jB(this,this,t),this.check()}transformByMatrix2(t){return VB(this,this,t),this.check()}};var Fc={};Lo(Fc,{add:()=>v0t,angle:()=>XB,bezier:()=>B0t,ceil:()=>b0t,clone:()=>_0t,copy:()=>y0t,create:()=>UM,cross:()=>t0,dist:()=>H0t,distance:()=>Fj,div:()=>j0t,divide:()=>kj,dot:()=>Gv,equals:()=>z0t,exactEquals:()=>F0t,floor:()=>w0t,forEach:()=>G0t,fromValues:()=>jM,hermite:()=>O0t,inverse:()=>I0t,len:()=>YB,length:()=>VM,lerp:()=>R0t,max:()=>E0t,min:()=>T0t,mul:()=>V0t,multiply:()=>Nj,negate:()=>P0t,normalize:()=>HB,random:()=>D0t,rotateX:()=>WB,rotateY:()=>qB,rotateZ:()=>GB,round:()=>M0t,scale:()=>S0t,scaleAndAdd:()=>C0t,set:()=>x0t,slerp:()=>L0t,sqrDist:()=>W0t,sqrLen:()=>q0t,squaredDistance:()=>zj,squaredLength:()=>Uj,str:()=>k0t,sub:()=>U0t,subtract:()=>Dj,transformMat3:()=>Xv,transformMat4:()=>e0,transformQuat:()=>Yv,zero:()=>N0t});function UM(){let e=new Bo(3);return Bo!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function _0t(e){let t=new Bo(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function VM(e){let t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function jM(e,t,r){let n=new Bo(3);return n[0]=e,n[1]=t,n[2]=r,n}function y0t(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function x0t(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function v0t(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function Dj(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function Nj(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function kj(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function b0t(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function w0t(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function T0t(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function E0t(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function M0t(e,t){return e[0]=qu(t[0]),e[1]=qu(t[1]),e[2]=qu(t[2]),e}function S0t(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function C0t(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function Fj(e,t){let r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)}function zj(e,t){let r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function Uj(e){let t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function P0t(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function I0t(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function HB(e,t){let r=t[0],n=t[1],i=t[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function Gv(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function t0(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[0],c=r[1],l=r[2];return e[0]=i*l-o*c,e[1]=o*s-n*l,e[2]=n*c-i*s,e}function R0t(e,t,r,n){let i=t[0],o=t[1],s=t[2];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=s+n*(r[2]-s),e}function L0t(e,t,r,n){let i=Math.acos(Math.min(Math.max(Gv(t,r),-1),1)),o=Math.sin(i),s=Math.sin((1-n)*i)/o,c=Math.sin(n*i)/o;return e[0]=s*t[0]+c*r[0],e[1]=s*t[1]+c*r[1],e[2]=s*t[2]+c*r[2],e}function O0t(e,t,r,n,i,o){let s=o*o,c=s*(2*o-3)+1,l=s*(o-2)+o,h=s*(o-1),p=s*(3-2*o);return e[0]=t[0]*c+r[0]*l+n[0]*h+i[0]*p,e[1]=t[1]*c+r[1]*l+n[1]*h+i[1]*p,e[2]=t[2]*c+r[2]*l+n[2]*h+i[2]*p,e}function B0t(e,t,r,n,i,o){let s=1-o,c=s*s,l=o*o,h=c*s,p=3*o*c,x=3*l*s,w=l*o;return e[0]=t[0]*h+r[0]*p+n[0]*x+i[0]*w,e[1]=t[1]*h+r[1]*p+n[1]*x+i[1]*w,e[2]=t[2]*h+r[2]*p+n[2]*x+i[2]*w,e}function D0t(e,t){t=t===void 0?1:t;let r=jf()*2*Math.PI,n=jf()*2-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e}function e0(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[3]*n+r[7]*i+r[11]*o+r[15];return s=s||1,e[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/s,e[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/s,e[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/s,e}function Xv(e,t,r){let n=t[0],i=t[1],o=t[2];return e[0]=n*r[0]+i*r[3]+o*r[6],e[1]=n*r[1]+i*r[4]+o*r[7],e[2]=n*r[2]+i*r[5]+o*r[8],e}function Yv(e,t,r){let n=r[0],i=r[1],o=r[2],s=r[3],c=t[0],l=t[1],h=t[2],p=i*h-o*l,x=o*c-n*h,w=n*l-i*c,E=i*w-o*x,P=o*p-n*w,B=n*x-i*p,D=s*2;return p*=D,x*=D,w*=D,E*=2,P*=2,B*=2,e[0]=c+p+E,e[1]=l+x+P,e[2]=h+w+B,e}function WB(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function qB(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function GB(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function XB(e,t){let r=e[0],n=e[1],i=e[2],o=t[0],s=t[1],c=t[2],l=Math.sqrt((r*r+n*n+i*i)*(o*o+s*s+c*c)),h=l&&Gv(e,t)/l;return Math.acos(Math.min(Math.max(h,-1),1))}function N0t(e){return e[0]=0,e[1]=0,e[2]=0,e}function k0t(e){return`vec3(${e[0]}, ${e[1]}, ${e[2]})`}function F0t(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function z0t(e,t){let r=e[0],n=e[1],i=e[2],o=t[0],s=t[1],c=t[2];return Math.abs(r-o)<=1e-6*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=1e-6*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-c)<=1e-6*Math.max(1,Math.abs(i),Math.abs(c))}var U0t=Dj,V0t=Nj,j0t=kj,H0t=Fj,W0t=zj,YB=VM,q0t=Uj,G0t=function(){let e=UM();return function(t,r,n,i,o,s){let c,l;for(r||(r=3),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],o(e,e,s),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2];return t}}();var KB=[0,0,0],HM,ur=class extends um{static get ZERO(){return HM||(HM=new ur(0,0,0),Object.freeze(HM)),HM}constructor(t=0,r=0,n=0){super(-0,-0,-0),arguments.length===1&&lu(t)?this.copy(t):(Zo.debug&&(Li(t),Li(r),Li(n)),this[0]=t,this[1]=r,this[2]=n)}set(t,r,n){return this[0]=t,this[1]=r,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return Zo.debug&&(Li(t.x),Li(t.y),Li(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=Li(t)}angle(t){return XB(this,t)}cross(t){return t0(this,this,t),this.check()}rotateX({radians:t,origin:r=KB}){return WB(this,this,r,t),this.check()}rotateY({radians:t,origin:r=KB}){return qB(this,this,r,t),this.check()}rotateZ({radians:t,origin:r=KB}){return GB(this,this,r,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return e0(this,this,t),this.check()}transformAsVector(t){return FM(this,this,t),this.check()}transformByMatrix3(t){return Xv(this,this,t),this.check()}transformByMatrix2(t){return Oj(this,this,t),this.check()}transformByQuaternion(t){return Yv(this,this,t),this.check()}};var WM,j_=class extends um{static get ZERO(){return WM||(WM=new j_(0,0,0,0),Object.freeze(WM)),WM}constructor(t=0,r=0,n=0,i=0){super(-0,-0,-0,-0),lu(t)&&arguments.length===1?this.copy(t):(Zo.debug&&(Li(t),Li(r),Li(n),Li(i)),this[0]=t,this[1]=r,this[2]=n,this[3]=i)}set(t,r,n,i){return this[0]=t,this[1]=r,this[2]=n,this[3]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return Zo.debug&&(Li(t.x),Li(t.y),Li(t.z),Li(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=Li(t)}get w(){return this[3]}set w(t){this[3]=Li(t)}transform(t){return e0(this,this,t),this.check()}transformByMatrix3(t){return zM(this,this,t),this.check()}transformByMatrix2(t){return Bj(this,this,t),this.check()}transformByQuaternion(t){return Yv(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}};var H_=class extends cm{toString(){let t="[";if(Zo.printRowMajor){t+="row-major:";for(let r=0;r<this.RANK;++r)for(let n=0;n<this.RANK;++n)t+=` ${this[n*this.RANK+r]}`}else{t+="column-major:";for(let r=0;r<this.ELEMENTS;++r)t+=` ${this[r]}`}return t+="]",t}getElementIndex(t,r){return r*this.RANK+t}getElement(t,r){return this[r*this.RANK+t]}setElement(t,r,n){return this[r*this.RANK+t]=Li(n),this}getColumn(t,r=new Array(this.RANK).fill(-0)){let n=t*this.RANK;for(let i=0;i<this.RANK;++i)r[i]=this[n+i];return r}setColumn(t,r){let n=t*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=r[i];return this}};function Vj(){let e=new Bo(9);return Bo!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function jj(e,t){if(e===t){let r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Hj(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],c=t[5],l=t[6],h=t[7],p=t[8],x=p*s-c*h,w=-p*o+c*l,E=h*o-s*l,P=r*x+n*w+i*E;return P?(P=1/P,e[0]=x*P,e[1]=(-p*n+i*h)*P,e[2]=(c*n-i*s)*P,e[3]=w*P,e[4]=(p*r-i*l)*P,e[5]=(-c*r+i*o)*P,e[6]=E*P,e[7]=(-h*r+n*l)*P,e[8]=(s*r-n*o)*P,e):null}function Wj(e){let t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],c=e[6],l=e[7],h=e[8];return t*(h*o-s*l)+r*(-h*i+s*c)+n*(l*i-o*c)}function ZB(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=r[0],E=r[1],P=r[2],B=r[3],D=r[4],W=r[5],X=r[6],q=r[7],$=r[8];return e[0]=w*n+E*s+P*h,e[1]=w*i+E*c+P*p,e[2]=w*o+E*l+P*x,e[3]=B*n+D*s+W*h,e[4]=B*i+D*c+W*p,e[5]=B*o+D*l+W*x,e[6]=X*n+q*s+$*h,e[7]=X*i+q*c+$*p,e[8]=X*o+q*l+$*x,e}function qj(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=r[0],E=r[1];return e[0]=n,e[1]=i,e[2]=o,e[3]=s,e[4]=c,e[5]=l,e[6]=w*n+E*s+h,e[7]=w*i+E*c+p,e[8]=w*o+E*l+x,e}function Gj(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=Math.sin(r),E=Math.cos(r);return e[0]=E*n+w*s,e[1]=E*i+w*c,e[2]=E*o+w*l,e[3]=E*s-w*n,e[4]=E*c-w*i,e[5]=E*l-w*o,e[6]=h,e[7]=p,e[8]=x,e}function $B(e,t,r){let n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Xj(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r+r,c=n+n,l=i+i,h=r*s,p=n*s,x=n*c,w=i*s,E=i*c,P=i*l,B=o*s,D=o*c,W=o*l;return e[0]=1-x-P,e[3]=p-W,e[6]=w+D,e[1]=p+W,e[4]=1-h-P,e[7]=E-B,e[2]=w-D,e[5]=E+B,e[8]=1-h-x,e}var QB;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL1ROW0=3]="COL1ROW0",e[e.COL1ROW1=4]="COL1ROW1",e[e.COL1ROW2=5]="COL1ROW2",e[e.COL2ROW0=6]="COL2ROW0",e[e.COL2ROW1=7]="COL2ROW1",e[e.COL2ROW2=8]="COL2ROW2"})(QB||(QB={}));var Y0t=Object.freeze([1,0,0,0,1,0,0,0,1]),Is=class extends H_{static get IDENTITY(){return Z0t()}static get ZERO(){return K0t()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return QB}constructor(t,...r){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):r.length>0?this.copy([t,...r]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(Y0t)}fromObject(t){return this.check()}fromQuaternion(t){return Xj(this,t),this.check()}set(t,r,n,i,o,s,c,l,h){return this[0]=t,this[1]=r,this[2]=n,this[3]=i,this[4]=o,this[5]=s,this[6]=c,this[7]=l,this[8]=h,this.check()}setRowMajor(t,r,n,i,o,s,c,l,h){return this[0]=t,this[1]=i,this[2]=c,this[3]=r,this[4]=o,this[5]=l,this[6]=n,this[7]=s,this[8]=h,this.check()}determinant(){return Wj(this)}transpose(){return jj(this,this),this.check()}invert(){return Hj(this,this),this.check()}multiplyLeft(t){return ZB(this,t,this),this.check()}multiplyRight(t){return ZB(this,this,t),this.check()}rotate(t){return Gj(this,this,t),this.check()}scale(t){return Array.isArray(t)?$B(this,this,t):$B(this,this,[t,t]),this.check()}translate(t){return qj(this,this,t),this.check()}transform(t,r){let n;switch(t.length){case 2:n=Wv(r||[-0,-0],t,this);break;case 3:n=Xv(r||[-0,-0,-0],t,this);break;case 4:n=zM(r||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return lm(n,t.length),n}transformVector(t,r){return this.transform(t,r)}transformVector2(t,r){return this.transform(t,r)}transformVector3(t,r){return this.transform(t,r)}},qM,GM=null;function K0t(){return qM||(qM=new Is([0,0,0,0,0,0,0,0,0]),Object.freeze(qM)),qM}function Z0t(){return GM||(GM=new Is,Object.freeze(GM)),GM}var Gs={};Lo(Gs,{add:()=>vgt,adjoint:()=>rgt,clone:()=>Q0t,copy:()=>J0t,create:()=>$0t,decompose:()=>fgt,determinant:()=>e4,equals:()=>Egt,exactEquals:()=>Tgt,frob:()=>xgt,fromQuat:()=>c4,fromQuat2:()=>lgt,fromRotation:()=>ogt,fromRotationTranslation:()=>Kj,fromRotationTranslationScale:()=>pgt,fromRotationTranslationScaleOrigin:()=>dgt,fromScaling:()=>igt,fromTranslation:()=>ngt,fromValues:()=>tgt,fromXRotation:()=>sgt,fromYRotation:()=>agt,fromZRotation:()=>cgt,frustum:()=>l4,getRotation:()=>hgt,getScaling:()=>Zj,getTranslation:()=>ugt,identity:()=>Yj,invert:()=>t4,lookAt:()=>f4,mul:()=>Mgt,multiply:()=>Kv,multiplyScalar:()=>bgt,multiplyScalarAndAdd:()=>wgt,ortho:()=>h4,orthoNO:()=>Qj,orthoZO:()=>ggt,perspective:()=>u4,perspectiveFromFieldOfView:()=>Agt,perspectiveNO:()=>$j,perspectiveZO:()=>mgt,rotate:()=>i4,rotateX:()=>o4,rotateY:()=>s4,rotateZ:()=>a4,scale:()=>n4,set:()=>egt,str:()=>ygt,sub:()=>Sgt,subtract:()=>Jj,targetTo:()=>_gt,translate:()=>r4,transpose:()=>JB});function $0t(){let e=new Bo(16);return Bo!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Q0t(e){let t=new Bo(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function J0t(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function tgt(e,t,r,n,i,o,s,c,l,h,p,x,w,E,P,B){let D=new Bo(16);return D[0]=e,D[1]=t,D[2]=r,D[3]=n,D[4]=i,D[5]=o,D[6]=s,D[7]=c,D[8]=l,D[9]=h,D[10]=p,D[11]=x,D[12]=w,D[13]=E,D[14]=P,D[15]=B,D}function egt(e,t,r,n,i,o,s,c,l,h,p,x,w,E,P,B,D){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=s,e[6]=c,e[7]=l,e[8]=h,e[9]=p,e[10]=x,e[11]=w,e[12]=E,e[13]=P,e[14]=B,e[15]=D,e}function Yj(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function JB(e,t){if(e===t){let r=t[1],n=t[2],i=t[3],o=t[6],s=t[7],c=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=i,e[13]=s,e[14]=c}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function t4(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],c=t[5],l=t[6],h=t[7],p=t[8],x=t[9],w=t[10],E=t[11],P=t[12],B=t[13],D=t[14],W=t[15],X=r*c-n*s,q=r*l-i*s,$=r*h-o*s,et=n*l-i*c,F=n*h-o*c,ut=i*h-o*l,ot=p*B-x*P,J=p*D-w*P,G=p*W-E*P,mt=x*D-w*B,Mt=x*W-E*B,ct=w*W-E*D,gt=X*ct-q*Mt+$*mt+et*G-F*J+ut*ot;return gt?(gt=1/gt,e[0]=(c*ct-l*Mt+h*mt)*gt,e[1]=(i*Mt-n*ct-o*mt)*gt,e[2]=(B*ut-D*F+W*et)*gt,e[3]=(w*F-x*ut-E*et)*gt,e[4]=(l*G-s*ct-h*J)*gt,e[5]=(r*ct-i*G+o*J)*gt,e[6]=(D*$-P*ut-W*q)*gt,e[7]=(p*ut-w*$+E*q)*gt,e[8]=(s*Mt-c*G+h*ot)*gt,e[9]=(n*G-r*Mt-o*ot)*gt,e[10]=(P*F-B*$+W*X)*gt,e[11]=(x*$-p*F-E*X)*gt,e[12]=(c*J-s*mt-l*ot)*gt,e[13]=(r*mt-n*J+i*ot)*gt,e[14]=(B*q-P*et-D*X)*gt,e[15]=(p*et-x*q+w*X)*gt,e):null}function rgt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],c=t[5],l=t[6],h=t[7],p=t[8],x=t[9],w=t[10],E=t[11],P=t[12],B=t[13],D=t[14],W=t[15],X=r*c-n*s,q=r*l-i*s,$=r*h-o*s,et=n*l-i*c,F=n*h-o*c,ut=i*h-o*l,ot=p*B-x*P,J=p*D-w*P,G=p*W-E*P,mt=x*D-w*B,Mt=x*W-E*B,ct=w*W-E*D;return e[0]=c*ct-l*Mt+h*mt,e[1]=i*Mt-n*ct-o*mt,e[2]=B*ut-D*F+W*et,e[3]=w*F-x*ut-E*et,e[4]=l*G-s*ct-h*J,e[5]=r*ct-i*G+o*J,e[6]=D*$-P*ut-W*q,e[7]=p*ut-w*$+E*q,e[8]=s*Mt-c*G+h*ot,e[9]=n*G-r*Mt-o*ot,e[10]=P*F-B*$+W*X,e[11]=x*$-p*F-E*X,e[12]=c*J-s*mt-l*ot,e[13]=r*mt-n*J+i*ot,e[14]=B*q-P*et-D*X,e[15]=p*et-x*q+w*X,e}function e4(e){let t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],c=e[6],l=e[7],h=e[8],p=e[9],x=e[10],w=e[11],E=e[12],P=e[13],B=e[14],D=e[15],W=t*s-r*o,X=t*c-n*o,q=r*c-n*s,$=h*P-p*E,et=h*B-x*E,F=p*B-x*P,ut=t*F-r*et+n*$,ot=o*F-s*et+c*$,J=h*q-p*X+x*W,G=E*q-P*X+B*W;return l*ut-i*ot+D*J-w*G}function Kv(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=t[9],E=t[10],P=t[11],B=t[12],D=t[13],W=t[14],X=t[15],q=r[0],$=r[1],et=r[2],F=r[3];return e[0]=q*n+$*c+et*x+F*B,e[1]=q*i+$*l+et*w+F*D,e[2]=q*o+$*h+et*E+F*W,e[3]=q*s+$*p+et*P+F*X,q=r[4],$=r[5],et=r[6],F=r[7],e[4]=q*n+$*c+et*x+F*B,e[5]=q*i+$*l+et*w+F*D,e[6]=q*o+$*h+et*E+F*W,e[7]=q*s+$*p+et*P+F*X,q=r[8],$=r[9],et=r[10],F=r[11],e[8]=q*n+$*c+et*x+F*B,e[9]=q*i+$*l+et*w+F*D,e[10]=q*o+$*h+et*E+F*W,e[11]=q*s+$*p+et*P+F*X,q=r[12],$=r[13],et=r[14],F=r[15],e[12]=q*n+$*c+et*x+F*B,e[13]=q*i+$*l+et*w+F*D,e[14]=q*o+$*h+et*E+F*W,e[15]=q*s+$*p+et*P+F*X,e}function r4(e,t,r){let n=r[0],i=r[1],o=r[2],s,c,l,h,p,x,w,E,P,B,D,W;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*o+t[12],e[13]=t[1]*n+t[5]*i+t[9]*o+t[13],e[14]=t[2]*n+t[6]*i+t[10]*o+t[14],e[15]=t[3]*n+t[7]*i+t[11]*o+t[15]):(s=t[0],c=t[1],l=t[2],h=t[3],p=t[4],x=t[5],w=t[6],E=t[7],P=t[8],B=t[9],D=t[10],W=t[11],e[0]=s,e[1]=c,e[2]=l,e[3]=h,e[4]=p,e[5]=x,e[6]=w,e[7]=E,e[8]=P,e[9]=B,e[10]=D,e[11]=W,e[12]=s*n+p*i+P*o+t[12],e[13]=c*n+x*i+B*o+t[13],e[14]=l*n+w*i+D*o+t[14],e[15]=h*n+E*i+W*o+t[15]),e}function n4(e,t,r){let n=r[0],i=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function i4(e,t,r,n){let i=n[0],o=n[1],s=n[2],c=Math.sqrt(i*i+o*o+s*s),l,h,p,x,w,E,P,B,D,W,X,q,$,et,F,ut,ot,J,G,mt,Mt,ct,gt,ee;return c<1e-6?null:(c=1/c,i*=c,o*=c,s*=c,h=Math.sin(r),l=Math.cos(r),p=1-l,x=t[0],w=t[1],E=t[2],P=t[3],B=t[4],D=t[5],W=t[6],X=t[7],q=t[8],$=t[9],et=t[10],F=t[11],ut=i*i*p+l,ot=o*i*p+s*h,J=s*i*p-o*h,G=i*o*p-s*h,mt=o*o*p+l,Mt=s*o*p+i*h,ct=i*s*p+o*h,gt=o*s*p-i*h,ee=s*s*p+l,e[0]=x*ut+B*ot+q*J,e[1]=w*ut+D*ot+$*J,e[2]=E*ut+W*ot+et*J,e[3]=P*ut+X*ot+F*J,e[4]=x*G+B*mt+q*Mt,e[5]=w*G+D*mt+$*Mt,e[6]=E*G+W*mt+et*Mt,e[7]=P*G+X*mt+F*Mt,e[8]=x*ct+B*gt+q*ee,e[9]=w*ct+D*gt+$*ee,e[10]=E*ct+W*gt+et*ee,e[11]=P*ct+X*gt+F*ee,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function o4(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[4],s=t[5],c=t[6],l=t[7],h=t[8],p=t[9],x=t[10],w=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+h*n,e[5]=s*i+p*n,e[6]=c*i+x*n,e[7]=l*i+w*n,e[8]=h*i-o*n,e[9]=p*i-s*n,e[10]=x*i-c*n,e[11]=w*i-l*n,e}function s4(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[0],s=t[1],c=t[2],l=t[3],h=t[8],p=t[9],x=t[10],w=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-h*n,e[1]=s*i-p*n,e[2]=c*i-x*n,e[3]=l*i-w*n,e[8]=o*n+h*i,e[9]=s*n+p*i,e[10]=c*n+x*i,e[11]=l*n+w*i,e}function a4(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[0],s=t[1],c=t[2],l=t[3],h=t[4],p=t[5],x=t[6],w=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+h*n,e[1]=s*i+p*n,e[2]=c*i+x*n,e[3]=l*i+w*n,e[4]=h*i-o*n,e[5]=p*i-s*n,e[6]=x*i-c*n,e[7]=w*i-l*n,e}function ngt(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function igt(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ogt(e,t,r){let n=r[0],i=r[1],o=r[2],s=Math.sqrt(n*n+i*i+o*o),c,l,h;return s<1e-6?null:(s=1/s,n*=s,i*=s,o*=s,l=Math.sin(t),c=Math.cos(t),h=1-c,e[0]=n*n*h+c,e[1]=i*n*h+o*l,e[2]=o*n*h-i*l,e[3]=0,e[4]=n*i*h-o*l,e[5]=i*i*h+c,e[6]=o*i*h+n*l,e[7]=0,e[8]=n*o*h+i*l,e[9]=i*o*h-n*l,e[10]=o*o*h+c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function sgt(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function agt(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function cgt(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Kj(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=n+n,l=i+i,h=o+o,p=n*c,x=n*l,w=n*h,E=i*l,P=i*h,B=o*h,D=s*c,W=s*l,X=s*h;return e[0]=1-(E+B),e[1]=x+X,e[2]=w-W,e[3]=0,e[4]=x-X,e[5]=1-(p+B),e[6]=P+D,e[7]=0,e[8]=w+W,e[9]=P-D,e[10]=1-(p+E),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function lgt(e,t){let r=new Bo(3),n=-t[0],i=-t[1],o=-t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=n*n+i*i+o*o+s*s;return x>0?(r[0]=(c*s+p*n+l*o-h*i)*2/x,r[1]=(l*s+p*i+h*n-c*o)*2/x,r[2]=(h*s+p*o+c*i-l*n)*2/x):(r[0]=(c*s+p*n+l*o-h*i)*2,r[1]=(l*s+p*i+h*n-c*o)*2,r[2]=(h*s+p*o+c*i-l*n)*2),Kj(e,t,r),e}function ugt(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Zj(e,t){let r=t[0],n=t[1],i=t[2],o=t[4],s=t[5],c=t[6],l=t[8],h=t[9],p=t[10];return e[0]=Math.sqrt(r*r+n*n+i*i),e[1]=Math.sqrt(o*o+s*s+c*c),e[2]=Math.sqrt(l*l+h*h+p*p),e}function hgt(e,t){let r=new Bo(3);Zj(r,t);let n=1/r[0],i=1/r[1],o=1/r[2],s=t[0]*n,c=t[1]*i,l=t[2]*o,h=t[4]*n,p=t[5]*i,x=t[6]*o,w=t[8]*n,E=t[9]*i,P=t[10]*o,B=s+p+P,D=0;return B>0?(D=Math.sqrt(B+1)*2,e[3]=.25*D,e[0]=(x-E)/D,e[1]=(w-l)/D,e[2]=(c-h)/D):s>p&&s>P?(D=Math.sqrt(1+s-p-P)*2,e[3]=(x-E)/D,e[0]=.25*D,e[1]=(c+h)/D,e[2]=(w+l)/D):p>P?(D=Math.sqrt(1+p-s-P)*2,e[3]=(w-l)/D,e[0]=(c+h)/D,e[1]=.25*D,e[2]=(x+E)/D):(D=Math.sqrt(1+P-s-p)*2,e[3]=(c-h)/D,e[0]=(w+l)/D,e[1]=(x+E)/D,e[2]=.25*D),e}function fgt(e,t,r,n){t[0]=n[12],t[1]=n[13],t[2]=n[14];let i=n[0],o=n[1],s=n[2],c=n[4],l=n[5],h=n[6],p=n[8],x=n[9],w=n[10];r[0]=Math.sqrt(i*i+o*o+s*s),r[1]=Math.sqrt(c*c+l*l+h*h),r[2]=Math.sqrt(p*p+x*x+w*w);let E=1/r[0],P=1/r[1],B=1/r[2],D=i*E,W=o*P,X=s*B,q=c*E,$=l*P,et=h*B,F=p*E,ut=x*P,ot=w*B,J=D+$+ot,G=0;return J>0?(G=Math.sqrt(J+1)*2,e[3]=.25*G,e[0]=(et-ut)/G,e[1]=(F-X)/G,e[2]=(W-q)/G):D>$&&D>ot?(G=Math.sqrt(1+D-$-ot)*2,e[3]=(et-ut)/G,e[0]=.25*G,e[1]=(W+q)/G,e[2]=(F+X)/G):$>ot?(G=Math.sqrt(1+$-D-ot)*2,e[3]=(F-X)/G,e[0]=(W+q)/G,e[1]=.25*G,e[2]=(et+ut)/G):(G=Math.sqrt(1+ot-D-$)*2,e[3]=(W-q)/G,e[0]=(F+X)/G,e[1]=(et+ut)/G,e[2]=.25*G),e}function pgt(e,t,r,n){let i=t[0],o=t[1],s=t[2],c=t[3],l=i+i,h=o+o,p=s+s,x=i*l,w=i*h,E=i*p,P=o*h,B=o*p,D=s*p,W=c*l,X=c*h,q=c*p,$=n[0],et=n[1],F=n[2];return e[0]=(1-(P+D))*$,e[1]=(w+q)*$,e[2]=(E-X)*$,e[3]=0,e[4]=(w-q)*et,e[5]=(1-(x+D))*et,e[6]=(B+W)*et,e[7]=0,e[8]=(E+X)*F,e[9]=(B-W)*F,e[10]=(1-(x+P))*F,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function dgt(e,t,r,n,i){let o=t[0],s=t[1],c=t[2],l=t[3],h=o+o,p=s+s,x=c+c,w=o*h,E=o*p,P=o*x,B=s*p,D=s*x,W=c*x,X=l*h,q=l*p,$=l*x,et=n[0],F=n[1],ut=n[2],ot=i[0],J=i[1],G=i[2],mt=(1-(B+W))*et,Mt=(E+$)*et,ct=(P-q)*et,gt=(E-$)*F,ee=(1-(w+W))*F,Ne=(D+X)*F,Ue=(P+q)*ut,sr=(D-X)*ut,gr=(1-(w+B))*ut;return e[0]=mt,e[1]=Mt,e[2]=ct,e[3]=0,e[4]=gt,e[5]=ee,e[6]=Ne,e[7]=0,e[8]=Ue,e[9]=sr,e[10]=gr,e[11]=0,e[12]=r[0]+ot-(mt*ot+gt*J+Ue*G),e[13]=r[1]+J-(Mt*ot+ee*J+sr*G),e[14]=r[2]+G-(ct*ot+Ne*J+gr*G),e[15]=1,e}function c4(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r+r,c=n+n,l=i+i,h=r*s,p=n*s,x=n*c,w=i*s,E=i*c,P=i*l,B=o*s,D=o*c,W=o*l;return e[0]=1-x-P,e[1]=p+W,e[2]=w-D,e[3]=0,e[4]=p-W,e[5]=1-h-P,e[6]=E+B,e[7]=0,e[8]=w+D,e[9]=E-B,e[10]=1-h-x,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function l4(e,t,r,n,i,o,s){let c=1/(r-t),l=1/(i-n),h=1/(o-s);return e[0]=o*2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o*2*l,e[6]=0,e[7]=0,e[8]=(r+t)*c,e[9]=(i+n)*l,e[10]=(s+o)*h,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*o*2*h,e[15]=0,e}function $j(e,t,r,n,i){let o=1/Math.tan(t/2);if(e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0){let s=1/(n-i);e[10]=(i+n)*s,e[14]=2*i*n*s}else e[10]=-1,e[14]=-2*n;return e}var u4=$j;function mgt(e,t,r,n,i){let o=1/Math.tan(t/2);if(e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0){let s=1/(n-i);e[10]=i*s,e[14]=i*n*s}else e[10]=-1,e[14]=-n;return e}function Agt(e,t,r,n){let i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),s=Math.tan(t.leftDegrees*Math.PI/180),c=Math.tan(t.rightDegrees*Math.PI/180),l=2/(s+c),h=2/(i+o);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=h,e[6]=0,e[7]=0,e[8]=-((s-c)*l*.5),e[9]=(i-o)*h*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function Qj(e,t,r,n,i,o,s){let c=1/(t-r),l=1/(n-i),h=1/(o-s);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*h,e[11]=0,e[12]=(t+r)*c,e[13]=(i+n)*l,e[14]=(s+o)*h,e[15]=1,e}var h4=Qj;function ggt(e,t,r,n,i,o,s){let c=1/(t-r),l=1/(n-i),h=1/(o-s);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=h,e[11]=0,e[12]=(t+r)*c,e[13]=(i+n)*l,e[14]=o*h,e[15]=1,e}function f4(e,t,r,n){let i,o,s,c,l,h,p,x,w,E,P=t[0],B=t[1],D=t[2],W=n[0],X=n[1],q=n[2],$=r[0],et=r[1],F=r[2];return Math.abs(P-$)<1e-6&&Math.abs(B-et)<1e-6&&Math.abs(D-F)<1e-6?Yj(e):(x=P-$,w=B-et,E=D-F,i=1/Math.sqrt(x*x+w*w+E*E),x*=i,w*=i,E*=i,o=X*E-q*w,s=q*x-W*E,c=W*w-X*x,i=Math.sqrt(o*o+s*s+c*c),i?(i=1/i,o*=i,s*=i,c*=i):(o=0,s=0,c=0),l=w*c-E*s,h=E*o-x*c,p=x*s-w*o,i=Math.sqrt(l*l+h*h+p*p),i?(i=1/i,l*=i,h*=i,p*=i):(l=0,h=0,p=0),e[0]=o,e[1]=l,e[2]=x,e[3]=0,e[4]=s,e[5]=h,e[6]=w,e[7]=0,e[8]=c,e[9]=p,e[10]=E,e[11]=0,e[12]=-(o*P+s*B+c*D),e[13]=-(l*P+h*B+p*D),e[14]=-(x*P+w*B+E*D),e[15]=1,e)}function _gt(e,t,r,n){let i=t[0],o=t[1],s=t[2],c=n[0],l=n[1],h=n[2],p=i-r[0],x=o-r[1],w=s-r[2],E=p*p+x*x+w*w;E>0&&(E=1/Math.sqrt(E),p*=E,x*=E,w*=E);let P=l*w-h*x,B=h*p-c*w,D=c*x-l*p;return E=P*P+B*B+D*D,E>0&&(E=1/Math.sqrt(E),P*=E,B*=E,D*=E),e[0]=P,e[1]=B,e[2]=D,e[3]=0,e[4]=x*D-w*B,e[5]=w*P-p*D,e[6]=p*B-x*P,e[7]=0,e[8]=p,e[9]=x,e[10]=w,e[11]=0,e[12]=i,e[13]=o,e[14]=s,e[15]=1,e}function ygt(e){return`mat4(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]}, ${e[4]}, ${e[5]}, ${e[6]}, ${e[7]}, ${e[8]}, ${e[9]}, ${e[10]}, ${e[11]}, ${e[12]}, ${e[13]}, ${e[14]}, ${e[15]})`}function xgt(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]+e[3]*e[3]+e[4]*e[4]+e[5]*e[5]+e[6]*e[6]+e[7]*e[7]+e[8]*e[8]+e[9]*e[9]+e[10]*e[10]+e[11]*e[11]+e[12]*e[12]+e[13]*e[13]+e[14]*e[14]+e[15]*e[15])}function vgt(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function Jj(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function bgt(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function wgt(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function Tgt(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Egt(e,t){let r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],c=e[5],l=e[6],h=e[7],p=e[8],x=e[9],w=e[10],E=e[11],P=e[12],B=e[13],D=e[14],W=e[15],X=t[0],q=t[1],$=t[2],et=t[3],F=t[4],ut=t[5],ot=t[6],J=t[7],G=t[8],mt=t[9],Mt=t[10],ct=t[11],gt=t[12],ee=t[13],Ne=t[14],Ue=t[15];return Math.abs(r-X)<=1e-6*Math.max(1,Math.abs(r),Math.abs(X))&&Math.abs(n-q)<=1e-6*Math.max(1,Math.abs(n),Math.abs(q))&&Math.abs(i-$)<=1e-6*Math.max(1,Math.abs(i),Math.abs($))&&Math.abs(o-et)<=1e-6*Math.max(1,Math.abs(o),Math.abs(et))&&Math.abs(s-F)<=1e-6*Math.max(1,Math.abs(s),Math.abs(F))&&Math.abs(c-ut)<=1e-6*Math.max(1,Math.abs(c),Math.abs(ut))&&Math.abs(l-ot)<=1e-6*Math.max(1,Math.abs(l),Math.abs(ot))&&Math.abs(h-J)<=1e-6*Math.max(1,Math.abs(h),Math.abs(J))&&Math.abs(p-G)<=1e-6*Math.max(1,Math.abs(p),Math.abs(G))&&Math.abs(x-mt)<=1e-6*Math.max(1,Math.abs(x),Math.abs(mt))&&Math.abs(w-Mt)<=1e-6*Math.max(1,Math.abs(w),Math.abs(Mt))&&Math.abs(E-ct)<=1e-6*Math.max(1,Math.abs(E),Math.abs(ct))&&Math.abs(P-gt)<=1e-6*Math.max(1,Math.abs(P),Math.abs(gt))&&Math.abs(B-ee)<=1e-6*Math.max(1,Math.abs(B),Math.abs(ee))&&Math.abs(D-Ne)<=1e-6*Math.max(1,Math.abs(D),Math.abs(Ne))&&Math.abs(W-Ue)<=1e-6*Math.max(1,Math.abs(W),Math.abs(Ue))}var Mgt=Kv,Sgt=Jj;var hl={};Lo(hl,{add:()=>p4,ceil:()=>Cgt,clone:()=>eH,copy:()=>nH,create:()=>tH,cross:()=>Ngt,dist:()=>Wgt,distance:()=>cH,div:()=>Hgt,divide:()=>aH,dot:()=>A4,equals:()=>Ugt,exactEquals:()=>uH,floor:()=>Pgt,forEach:()=>Ygt,fromValues:()=>rH,inverse:()=>Dgt,len:()=>Ggt,length:()=>XM,lerp:()=>g4,max:()=>Rgt,min:()=>Igt,mul:()=>jgt,multiply:()=>sH,negate:()=>Bgt,normalize:()=>m4,random:()=>kgt,round:()=>Lgt,scale:()=>d4,scaleAndAdd:()=>Ogt,set:()=>iH,sqrDist:()=>qgt,sqrLen:()=>Xgt,squaredDistance:()=>lH,squaredLength:()=>YM,str:()=>zgt,sub:()=>Vgt,subtract:()=>oH,transformMat4:()=>_4,transformQuat:()=>y4,zero:()=>Fgt});function tH(){let e=new Bo(4);return Bo!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function eH(e){let t=new Bo(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function rH(e,t,r,n){let i=new Bo(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function nH(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function iH(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function p4(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function oH(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function sH(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function aH(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function Cgt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Pgt(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function Igt(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function Rgt(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function Lgt(e,t){return e[0]=qu(t[0]),e[1]=qu(t[1]),e[2]=qu(t[2]),e[3]=qu(t[3]),e}function d4(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function Ogt(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}function cH(e,t){let r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+o*o)}function lH(e,t){let r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return r*r+n*n+i*i+o*o}function XM(e){let t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function YM(e){let t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function Bgt(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function Dgt(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function m4(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r*r+n*n+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),e[0]=r*s,e[1]=n*s,e[2]=i*s,e[3]=o*s,e}function A4(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Ngt(e,t,r,n){let i=r[0]*n[1]-r[1]*n[0],o=r[0]*n[2]-r[2]*n[0],s=r[0]*n[3]-r[3]*n[0],c=r[1]*n[2]-r[2]*n[1],l=r[1]*n[3]-r[3]*n[1],h=r[2]*n[3]-r[3]*n[2],p=t[0],x=t[1],w=t[2],E=t[3];return e[0]=x*h-w*l+E*c,e[1]=-(p*h)+w*s-E*o,e[2]=p*l-x*s+E*i,e[3]=-(p*c)+x*o-w*i,e}function g4(e,t,r,n){let i=t[0],o=t[1],s=t[2],c=t[3];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=s+n*(r[2]-s),e[3]=c+n*(r[3]-c),e}function kgt(e,t){t=t===void 0?1:t;let r,n,i,o,s,c;do r=jf()*2-1,n=jf()*2-1,s=r*r+n*n;while(s>=1);do i=jf()*2-1,o=jf()*2-1,c=i*i+o*o;while(c>=1);let l=Math.sqrt((1-s)/c);return e[0]=t*r,e[1]=t*n,e[2]=t*i*l,e[3]=t*o*l,e}function _4(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*s,e[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*s,e[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*s,e[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*s,e}function y4(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[0],c=r[1],l=r[2],h=r[3],p=h*n+c*o-l*i,x=h*i+l*n-s*o,w=h*o+s*i-c*n,E=-s*n-c*i-l*o;return e[0]=p*h+E*-s+x*-l-w*-c,e[1]=x*h+E*-c+w*-s-p*-l,e[2]=w*h+E*-l+p*-c-x*-s,e[3]=t[3],e}function Fgt(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function zgt(e){return`vec4(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}function uH(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function Ugt(e,t){let r=e[0],n=e[1],i=e[2],o=e[3],s=t[0],c=t[1],l=t[2],h=t[3];return Math.abs(r-s)<=1e-6*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-c)<=1e-6*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-l)<=1e-6*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-h)<=1e-6*Math.max(1,Math.abs(o),Math.abs(h))}var Vgt=oH,jgt=sH,Hgt=aH,Wgt=cH,qgt=lH,Ggt=XM,Xgt=YM,Ygt=function(){let e=tH();return function(t,r,n,i,o,s){let c,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],e[3]=t[c+3],o(e,e,s),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2],t[c+3]=e[3];return t}}();var b4;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"})(b4||(b4={}));var Kgt=45*Math.PI/180,Zgt=1,x4=.1,v4=500,$gt=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Fn=class extends H_{static get IDENTITY(){return Jgt()}static get ZERO(){return Qgt()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return b4}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,r,n,i,o,s,c,l,h,p,x,w,E,P,B,D){return this[0]=t,this[1]=r,this[2]=n,this[3]=i,this[4]=o,this[5]=s,this[6]=c,this[7]=l,this[8]=h,this[9]=p,this[10]=x,this[11]=w,this[12]=E,this[13]=P,this[14]=B,this[15]=D,this.check()}setRowMajor(t,r,n,i,o,s,c,l,h,p,x,w,E,P,B,D){return this[0]=t,this[1]=o,this[2]=h,this[3]=E,this[4]=r,this[5]=s,this[6]=p,this[7]=P,this[8]=n,this[9]=c,this[10]=x,this[11]=B,this[12]=i,this[13]=l,this[14]=w,this[15]=D,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy($gt)}fromObject(t){return this.check()}fromQuaternion(t){return c4(this,t),this.check()}frustum(t){let{left:r,right:n,bottom:i,top:o,near:s=x4,far:c=v4}=t;return c===1/0?t_t(this,r,n,i,o,s):l4(this,r,n,i,o,s,c),this.check()}lookAt(t){let{eye:r,center:n=[0,0,0],up:i=[0,1,0]}=t;return f4(this,r,n,i),this.check()}ortho(t){let{left:r,right:n,bottom:i,top:o,near:s=x4,far:c=v4}=t;return h4(this,r,n,i,o,s,c),this.check()}orthographic(t){let{fovy:r=Kgt,aspect:n=Zgt,focalDistance:i=1,near:o=x4,far:s=v4}=t;hH(r);let c=r/2,l=i*Math.tan(c),h=l*n;return this.ortho({left:-h,right:h,bottom:-l,top:l,near:o,far:s})}perspective(t){let{fovy:r=45*Math.PI/180,aspect:n=1,near:i=.1,far:o=500}=t;return hH(r),u4(this,r,n,i,o),this.check()}determinant(){return e4(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];let n=this.getScale(r),i=1/n[0],o=1/n[1],s=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*o,t[2]=this[2]*s,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*o,t[6]=this[6]*s,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*o,t[10]=this[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];let n=this.getScale(r),i=1/n[0],o=1/n[1],s=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*o,t[2]=this[2]*s,t[3]=this[4]*i,t[4]=this[5]*o,t[5]=this[6]*s,t[6]=this[8]*i,t[7]=this[9]*o,t[8]=this[10]*s,t}transpose(){return JB(this,this),this.check()}invert(){return t4(this,this),this.check()}multiplyLeft(t){return Kv(this,t,this),this.check()}multiplyRight(t){return Kv(this,this,t),this.check()}rotateX(t){return o4(this,this,t),this.check()}rotateY(t){return s4(this,this,t),this.check()}rotateZ(t){return a4(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,r){return i4(this,this,t,r),this.check()}scale(t){return n4(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return r4(this,this,t),this.check()}transform(t,r){return t.length===4?(r=_4(r||[-0,-0,-0,-0],t,this),lm(r,4),r):this.transformAsPoint(t,r)}transformAsPoint(t,r){let{length:n}=t,i;switch(n){case 2:i=qv(r||[-0,-0],t,this);break;case 3:i=e0(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return lm(i,t.length),i}transformAsVector(t,r){let n;switch(t.length){case 2:n=kM(r||[-0,-0],t,this);break;case 3:n=FM(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return lm(n,t.length),n}transformPoint(t,r){return this.transformAsPoint(t,r)}transformVector(t,r){return this.transformAsPoint(t,r)}transformDirection(t,r){return this.transformAsVector(t,r)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,r,n){return this.identity().translate([t,r,n])}},KM,ZM;function Qgt(){return KM||(KM=new Fn([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(KM)),KM}function Jgt(){return ZM||(ZM=new Fn,Object.freeze(ZM)),ZM}function hH(e){if(e>Math.PI*2)throw Error("expected radians")}function t_t(e,t,r,n,i,o){let s=2*o/(r-t),c=2*o/(i-n),l=(r+t)/(r-t),h=(i+n)/(i-n),p=-1,x=-1,w=-2*o;return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=l,e[9]=h,e[10]=p,e[11]=x,e[12]=0,e[13]=0,e[14]=w,e[15]=0,e}function fH(){let e=new Bo(4);return Bo!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function pH(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function w4(e,t,r){r=r*.5;let n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function T4(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=r[0],l=r[1],h=r[2],p=r[3];return e[0]=n*p+s*c+i*h-o*l,e[1]=i*p+s*l+o*c-n*h,e[2]=o*p+s*h+n*l-i*c,e[3]=s*p-n*c-i*l-o*h,e}function dH(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],s=t[3],c=Math.sin(r),l=Math.cos(r);return e[0]=n*l+s*c,e[1]=i*l+o*c,e[2]=o*l-i*c,e[3]=s*l-n*c,e}function mH(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],s=t[3],c=Math.sin(r),l=Math.cos(r);return e[0]=n*l-o*c,e[1]=i*l+s*c,e[2]=o*l+n*c,e[3]=s*l-i*c,e}function AH(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],s=t[3],c=Math.sin(r),l=Math.cos(r);return e[0]=n*l+i*c,e[1]=i*l-n*c,e[2]=o*l+s*c,e[3]=s*l-o*c,e}function gH(e,t){let r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e}function Zv(e,t,r,n){let i=t[0],o=t[1],s=t[2],c=t[3],l=r[0],h=r[1],p=r[2],x=r[3],w,E,P,B,D;return w=i*l+o*h+s*p+c*x,w<0&&(w=-w,l=-l,h=-h,p=-p,x=-x),1-w>1e-6?(E=Math.acos(w),D=Math.sin(E),P=Math.sin((1-n)*E)/D,B=Math.sin(n*E)/D):(P=1-n,B=n),e[0]=P*i+B*l,e[1]=P*o+B*h,e[2]=P*s+B*p,e[3]=P*c+B*x,e}function _H(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r*r+n*n+i*i+o*o,c=s?1/s:0;return e[0]=-r*c,e[1]=-n*c,e[2]=-i*c,e[3]=o*c,e}function yH(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function E4(e,t){let r=t[0]+t[4]+t[8],n;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{let i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);let o=(i+1)%3,s=(i+2)%3;n=Math.sqrt(t[i*3+i]-t[o*3+o]-t[s*3+s]+1),e[i]=.5*n,n=.5/n,e[3]=(t[o*3+s]-t[s*3+o])*n,e[o]=(t[o*3+i]+t[i*3+o])*n,e[s]=(t[s*3+i]+t[i*3+s])*n}return e}var xH=p4;var vH=d4,bH=A4,wH=g4,TH=XM;var EH=YM;var MH=m4;var SH=function(){let e=UM(),t=jM(1,0,0),r=jM(0,1,0);return function(n,i,o){let s=Gv(i,o);return s<-.999999?(t0(e,t,i),YB(e)<1e-6&&t0(e,r,i),HB(e,e),w4(n,e,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(t0(e,i,o),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+s,MH(n,n))}}(),jKt=function(){let e=fH(),t=fH();return function(r,n,i,o,s,c){return Zv(e,n,s,c),Zv(t,i,o,c),Zv(r,e,t,2*c*(1-c)),r}}(),HKt=function(){let e=Vj();return function(t,r,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],MH(t,E4(t,e))}}();var e_t=[0,0,0,1],hm=class extends cm{constructor(t=0,r=0,n=0,i=1){super(-0,-0,-0,-0),Array.isArray(t)&&arguments.length===1?this.copy(t):this.set(t,r,n,i)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,r,n,i){return this[0]=t,this[1]=r,this[2]=n,this[3]=i,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return E4(this,t),this.check()}fromAxisRotation(t,r){return w4(this,t,r),this.check()}identity(){return pH(this),this.check()}setAxisAngle(t,r){return this.fromAxisRotation(t,r)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=Li(t)}get y(){return this[1]}set y(t){this[1]=Li(t)}get z(){return this[2]}set z(t){this[2]=Li(t)}get w(){return this[3]}set w(t){this[3]=Li(t)}len(){return TH(this)}lengthSquared(){return EH(this)}dot(t){return bH(this,t)}rotationTo(t,r){return SH(this,t,r),this.check()}add(t){return xH(this,this,t),this.check()}calculateW(){return gH(this,this),this.check()}conjugate(){return yH(this,this),this.check()}invert(){return _H(this,this),this.check()}lerp(t,r,n){return n===void 0?this.lerp(this,t,r):(wH(this,t,r,n),this.check())}multiplyRight(t){return T4(this,this,t),this.check()}multiplyLeft(t){return T4(this,t,this),this.check()}normalize(){let t=this.len(),r=t>0?1/t:0;return this[0]=this[0]*r,this[1]=this[1]*r,this[2]=this[2]*r,this[3]=this[3]*r,t===0&&(this[3]=1),this.check()}rotateX(t){return dH(this,this,t),this.check()}rotateY(t){return mH(this,this,t),this.check()}rotateZ(t){return AH(this,this,t),this.check()}scale(t){return vH(this,this,t),this.check()}slerp(t,r,n){let i,o,s;switch(arguments.length){case 1:({start:i=e_t,target:o,ratio:s}=t);break;case 2:i=this,o=t,s=r;break;default:i=t,o=r,s=n}return Zv(this,i,o,s),this.check()}transformVector4(t,r=new j_){return y4(r,t,this),lm(r,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,r){return this.setAxisAngle(t,r)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}};var CH=1e-6,r_t=6371e3,Ih=class{constructor({phi:t=0,theta:r=0,radius:n=1,bearing:i,pitch:o,altitude:s,radiusScale:c=r_t}={}){this.phi=t,this.theta=r,this.radius=n||s||1,this.radiusScale=c||1,i!==void 0&&(this.bearing=i),o!==void 0&&(this.pitch=o),this.check()}toString(){return this.formatString(Zo)}formatString({printTypes:t=!1}){let r=Hv;return`${t?"Spherical":""}[rho:${r(this.radius)},theta:${r(this.theta)},phi:${r(this.phi)}]`}equals(t){return Fa(this.radius,t.radius)&&Fa(this.theta,t.theta)&&Fa(this.phi,t.phi)}exactEquals(t){return this.radius===t.radius&&this.theta===t.theta&&this.phi===t.phi}get bearing(){return 180-am(this.phi)}set bearing(t){this.phi=Math.PI-U_(t)}get pitch(){return am(this.theta)}set pitch(t){this.theta=U_(t)}get longitude(){return am(this.phi)}get latitude(){return am(this.theta)}get lng(){return am(this.phi)}get lat(){return am(this.theta)}get z(){return(this.radius-1)*this.radiusScale}set(t,r,n){return this.radius=t,this.phi=r,this.theta=n,this.check()}clone(){return new Ih().copy(this)}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this.check()}fromLngLatZ([t,r,n]){return this.radius=1+n/this.radiusScale,this.phi=U_(r),this.theta=U_(t),this.check()}fromVector3(t){return this.radius=VM(t),this.radius>0&&(this.theta=Math.atan2(t[0],t[1]),this.phi=Math.acos(ro(t[2]/this.radius,-1,1))),this.check()}toVector3(){return new ur(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}makeSafe(){return this.phi=Math.max(CH,Math.min(Math.PI-CH,this.phi)),this}check(){if(!Number.isFinite(this.phi)||!Number.isFinite(this.theta)||!(this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}};var W_={};Lo(W_,{EPSILON1:()=>n_t,EPSILON10:()=>f_t,EPSILON11:()=>p_t,EPSILON12:()=>d_t,EPSILON13:()=>m_t,EPSILON14:()=>A_t,EPSILON15:()=>g_t,EPSILON16:()=>__t,EPSILON17:()=>y_t,EPSILON18:()=>x_t,EPSILON19:()=>v_t,EPSILON2:()=>i_t,EPSILON20:()=>b_t,EPSILON3:()=>o_t,EPSILON4:()=>s_t,EPSILON5:()=>a_t,EPSILON6:()=>c_t,EPSILON7:()=>l_t,EPSILON8:()=>u_t,EPSILON9:()=>h_t,PI_OVER_FOUR:()=>T_t,PI_OVER_SIX:()=>E_t,PI_OVER_TWO:()=>w_t,TWO_PI:()=>M_t});var n_t=.1,i_t=.01,o_t=.001,s_t=1e-4,a_t=1e-5,c_t=1e-6,l_t=1e-7,u_t=1e-8,h_t=1e-9,f_t=1e-10,p_t=1e-11,d_t=1e-12,m_t=1e-13,A_t=1e-14,g_t=1e-15,__t=1e-16,y_t=1e-17,x_t=1e-18,v_t=1e-19,b_t=1e-20,w_t=Math.PI/2,T_t=Math.PI/4,E_t=Math.PI/6,M_t=Math.PI*2;function M4(e,t=[],r=0){let n=Math.fround(e),i=e-n;return t[r]=n,t[r+1]=i,t}function PH(e){return e-Math.fround(e)}function IH(e){let t=new Float32Array(32);for(let r=0;r<4;++r)for(let n=0;n<4;++n){let i=r*4+n;M4(e[n*4+r],t,i*2)}return t}var S_t=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND

// All these functions are for substituting tan() function from Intel GPU only
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }

    // 2pi range reduction
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,S4={name:"fp32",vs:S_t};var RH=`
uniform fp64arithmeticUniforms {
  uniform float ONE;
} fp64;

/*
About LUMA_FP64_CODE_ELIMINATION_WORKAROUND

The purpose of this workaround is to prevent shader compilers from
optimizing away necessary arithmetic operations by swapping their sequences
or transform the equation to some 'equivalent' form.

The method is to multiply an artifical variable, ONE, which will be known to
the compiler to be 1 only at runtime. The whole expression is then represented
as a polynomial with respective to ONE. In the coefficients of all terms, only one a
and one b should appear

err = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE
*/

// Divide float number to high and low floats to extend fraction bits
vec2 split(float a) {
  const float SPLIT = 4097.0;
  float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float a_hi = t * fp64.ONE - (t - a);
  float a_lo = a * fp64.ONE - a_hi;
#else
  float a_hi = t - (t - a);
  float a_lo = a - a_hi;
#endif
  return vec2(a_hi, a_lo);
}

// Divide float number again when high float uses too many fraction bits
vec2 split2(vec2 a) {
  vec2 b = split(a.x);
  b.y += a.y;
  return b;
}

// Special sum operation when a > b
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float sum = (a + b) * fp64.ONE;
  float err = b - (sum - a) * fp64.ONE;
#else
  float sum = a + b;
  float err = b - (sum - a);
#endif
  return vec2(sum, err);
}

// General sum operation
vec2 twoSum(float a, float b) {
  float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);
#else
  float v = s - a;
  float err = (a - (s - v)) + (b - v);
#endif
  return vec2(s, err);
}

vec2 twoSub(float a, float b) {
  float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);
#else
  float v = s - a;
  float err = (a - (s - v)) - (b + v);
#endif
  return vec2(s, err);
}

vec2 twoSqr(float a) {
  float prod = a * a;
  vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *
    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;
#else
  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
  return vec2(prod, err);
}

vec2 twoProd(float a, float b) {
  float prod = a * b;
  vec2 a_fp64 = split(a);
  vec2 b_fp64 = split(b);
  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
  return vec2(prod, err);
}

vec2 sum_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSum(a.x, b.x);
  t = twoSum(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 sub_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSub(a.x, b.x);
  t = twoSub(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 mul_fp64(vec2 a, vec2 b) {
  vec2 prod = twoProd(a.x, b.x);
  // y component is for the error
  prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  return prod;
}

vec2 div_fp64(vec2 a, vec2 b) {
  float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
  vec2 yn = a * xn;
#endif
  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
  vec2 prod = twoProd(xn, diff);
  return sum_fp64(yn, prod);
}

vec2 sqrt_fp64(vec2 a) {
  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);

  float x = 1.0 / sqrt(a.x);
  float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;
#else
  vec2 yn_sqr = twoSqr(yn);
#endif
  float diff = sub_fp64(a, yn_sqr).x;
  vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  return sum_fp64(split(yn), prod);
#else
  return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`;var C_t={ONE:1},C4={name:"fp64arithmetic",vs:RH,defaultUniforms:C_t,uniformTypes:{ONE:"f32"},fp64ify:M4,fp64LowPart:PH,fp64ifyMatrix4:IH};var P_t=[0,1,1,1],I_t=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

out vec4 picking_vRGBcolor_Avalid;

// Normalize unsigned byte color to 0-1 range
vec3 picking_normalizeColor(vec3 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

// Normalize unsigned byte color to 0-1 range
vec4 picking_normalizeColor(vec4 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

bool picking_isColorZero(vec3 color) {
  return dot(color, vec3(1.0)) < 0.00001;
}

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.00001;
}

// Check if this vertex is highlighted 
bool isVertexHighlighted(vec3 vertexColor) {
  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
  return
    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}

// Set the current picking color
void picking_setPickingColor(vec3 pickingColor) {
  pickingColor = picking_normalizeColor(pickingColor);

  if (bool(picking.isActive)) {
    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!bool(picking.isAttribute)) {
      // Stores the picking color so that the fragment shader can render it during picking
      picking_vRGBcolor_Avalid.rgb = pickingColor;
    }
  } else {
    // Do the comparison with selected item color in vertex shader as it should mean fewer compares
    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.r = value;
  }
}

void picking_setPickingAttribute(vec2 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}

void picking_setPickingAttribute(vec3 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,R_t=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

in vec4 picking_vRGBcolor_Avalid;

/*
 * Returns highlight color if this item is selected.
 */
vec4 picking_filterHighlightColor(vec4 color) {
  // If we are still picking, we don't highlight
  if (picking.isActive > 0.5) {
    return color;
  }

  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    // Blend in highlight color based on its alpha value
    float highLightAlpha = picking.highlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 picking_filterPickingColor(vec4 color) {
  if (bool(picking.isActive)) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 picking_filterColor(vec4 color) {
  vec4 highlightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highlightColor);
}
`,$M={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:P_t},vs:I_t,fs:R_t,getUniforms:L_t};function L_t(e={},t){let r={};if(e.highlightedObjectColor!==void 0)if(e.highlightedObjectColor===null)r.isHighlightActive=!1;else{r.isHighlightActive=!0;let n=e.highlightedObjectColor.slice(0,3);r.highlightedObjectColor=n}if(e.highlightColor){let n=Array.from(e.highlightColor,i=>i/255);Number.isFinite(n[3])||(n[3]=1),r.highlightColor=n}return e.isActive!==void 0&&(r.isActive=Boolean(e.isActive),r.isAttribute=Boolean(e.isAttribute)),e.useFloatColors!==void 0&&(r.useFloatColors=Boolean(e.useFloatColors)),r}var P4=`precision highp int;

// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  vec3 color;
};

struct PointLight {
  vec3 color;
  vec3 position;
  vec3 attenuation; // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform lightingUniforms {
  int enabled;
  int lightType;

  int directionalLightCount;
  int pointLightCount;

  vec3 ambientColor;

  vec3 lightColor0;
  vec3 lightPosition0;
  vec3 lightDirection0;
  vec3 lightAttenuation0;

  vec3 lightColor1;
  vec3 lightPosition1;
  vec3 lightDirection1;
  vec3 lightAttenuation1;

  vec3 lightColor2;
  vec3 lightPosition2;
  vec3 lightDirection2;
  vec3 lightAttenuation2;
} lighting;

PointLight lighting_getPointLight(int index) {
  switch (index) {
    case 0:
      return PointLight(lighting.lightColor0, lighting.lightPosition0, lighting.lightAttenuation0);
    case 1:
      return PointLight(lighting.lightColor1, lighting.lightPosition1, lighting.lightAttenuation1);
    case 2:
    default:  
      return PointLight(lighting.lightColor2, lighting.lightPosition2, lighting.lightAttenuation2);
  }
}

DirectionalLight lighting_getDirectionalLight(int index) {
  switch (index) {
    case 0:
      return DirectionalLight(lighting.lightColor0, lighting.lightDirection0);
    case 1:
      return DirectionalLight(lighting.lightColor1, lighting.lightDirection1);
    case 2:
    default:   
      return DirectionalLight(lighting.lightColor2, lighting.lightDirection2);
  }
} 

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

// #endif
`;var LH=`// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  color: vec3<f32>,
};

struct PointLight {
  color: vec3<f32>,
  position: vec3<f32>,
  attenuation: vec3<f32>, // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  color: vec3<f32>,
  direction: vec3<f32>,
};

struct lightingUniforms {
  enabled: i32,
  poightCount: i32,
  directionalLightCount: i32,

  ambientColor: vec3<f32>,

  // TODO - support multiple lights by uncommenting arrays below
  lightType: i32,
  lightColor: vec3<f32>,
  lightDirection: vec3<f32>,
  lightPosition: vec3<f32>,
  lightAttenuation: vec3<f32>,

  // AmbientLight ambientLight;
  // PointLight pointLight[MAX_LIGHTS];
  // DirectionalLight directionalLight[MAX_LIGHTS];
};

// Binding 0:1 is reserved for lighting (Note: could go into separate bind group as it is stable across draw calls)
@binding(1) @group(0) var<uniform> lighting : lightingUniforms;

fn lighting_getPointLight(index: i32) -> PointLight {
  return PointLight(lighting.lightColor, lighting.lightPosition, lighting.lightAttenuation);
}

fn lighting_getDirectionalLight(index: i32) -> DirectionalLight {
  return DirectionalLight(lighting.lightColor, lighting.lightDirection);
} 

fn getPointLightAttenuation(pointLight: PointLight, distance: f32) -> f32 {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}
`;var OH=3,O_t=255,$v;(function(e){e[e.POINT=0]="POINT",e[e.DIRECTIONAL=1]="DIRECTIONAL"})($v||($v={}));var Vp={props:{},uniforms:{},name:"lighting",defines:{MAX_LIGHTS:OH},uniformTypes:{enabled:"i32",lightType:"i32",directionalLightCount:"i32",pointLightCount:"i32",ambientLightColor:"vec3<f32>",lightColor0:"vec3<f32>",lightPosition0:"vec3<f32>",lightDirection0:"vec3<f32>",lightAttenuation0:"vec3<f32>",lightColor1:"vec3<f32>",lightPosition1:"vec3<f32>",lightDirection1:"vec3<f32>",lightAttenuation1:"vec3<f32>",lightColor2:"vec3<f32>",lightPosition2:"vec3<f32>",lightDirection2:"vec3<f32>",lightAttenuation2:"vec3<f32>"},defaultUniforms:{enabled:1,lightType:$v.POINT,directionalLightCount:0,pointLightCount:0,ambientLightColor:[.1,.1,.1],lightColor0:[1,1,1],lightPosition0:[1,1,2],lightDirection0:[1,1,1],lightAttenuation0:[1,0,0],lightColor1:[1,1,1],lightPosition1:[1,1,2],lightDirection1:[1,1,1],lightAttenuation1:[1,0,0],lightColor2:[1,1,1],lightPosition2:[1,1,2],lightDirection2:[1,1,1],lightAttenuation2:[1,0,0]},source:LH,vs:P4,fs:P4,getUniforms:B_t};function B_t(e,t={}){if(e=e&&{...e},!e)return{...Vp.defaultUniforms};e.lights&&(e={...e,...N_t(e.lights),lights:void 0});let{ambientLight:r,pointLights:n,directionalLights:i}=e||{};if(!(r||n&&n.length>0||i&&i.length>0))return{...Vp.defaultUniforms,enabled:0};let s={...Vp.defaultUniforms,...t,...D_t({ambientLight:r,pointLights:n,directionalLights:i})};return e.enabled!==void 0&&(s.enabled=e.enabled?1:0),s}function D_t({ambientLight:e,pointLights:t=[],directionalLights:r=[]}){let n={};n.ambientLightColor=I4(e);let i=0;for(let o of t){n.lightType=$v.POINT;let s=i;n[`lightColor${s}`]=I4(o),n[`lightPosition${s}`]=o.position,n[`lightAttenuation${s}`]=o.attenuation||[1,0,0],i++}for(let o of r){n.lightType=$v.DIRECTIONAL;let s=i;n[`lightColor${s}`]=I4(o),n[`lightDirection${s}`]=o.direction,i++}return i>OH&&qe.warn("MAX_LIGHTS exceeded")(),n.directionalLightCount=r.length,n.pointLightCount=t.length,n}function N_t(e){let t={pointLights:[],directionalLights:[]};for(let r of e||[])switch(r.type){case"ambient":t.ambientLight=r;break;case"directional":t.directionalLights?.push(r);break;case"point":t.pointLights?.push(r);break;default:}return t}function I4(e={}){let{color:t=[0,0,0],intensity:r=1}=e;return t.map(n=>n*r/O_t)}var QM=`uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;
`,JM=`uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
  vec3 halfway_direction = normalize(light_direction + view_direction);
  float lambertian = dot(light_direction, normal_worldspace);
  float specular = 0.0;
  if (lambertian > 0.0) {
    float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, material.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * material.diffuse * surfaceColor + specular * material.specularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  vec3 view_direction = normalize(cameraPosition - position_worldspace);
  lightColor = material.ambient * surfaceColor * lighting.ambientColor;

  for (int i = 0; i < lighting.pointLightCount; i++) {
    PointLight pointLight = lighting_getPointLight(i);
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    float light_attenuation = getPointLightAttenuation(pointLight, distance(light_position_worldspace, position_worldspace));
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color / light_attenuation);
  }

  int totalLights = min(MAX_LIGHTS, lighting.pointLightCount + lighting.directionalLightCount);
  for (int i = lighting.pointLightCount; i < totalLights; i++) {
    DirectionalLight directionalLight = lighting_getDirectionalLight(i);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
}
`;var fm={props:{},name:"gouraudMaterial",vs:JM.replace("phongMaterial","gouraudMaterial"),fs:QM.replace("phongMaterial","gouraudMaterial"),defines:{LIGHTING_VERTEX:1},dependencies:[Vp],uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(e){let t={...e};return t.specularColor&&(t.specularColor=t.specularColor.map(r=>r/255)),{...fm.defaultUniforms,...t}}};var BH=`struct phongMaterialUniforms {
  ambient: f32,
  diffuse: f32,
  shininess: f32,
  specularColor: vec3<f32>,
};

@binding(2) @group(0) var<uniform> material : phongMaterialUniforms;

fn lighting_getLightColor(surfaceColor: vec3<f32>, light_direction: vec3<f32>, view_direction: vec3<f32>, normal_worldspace: vec3<f32>, color: vec3<f32>) -> vec3<f32> {
  let halfway_direction: vec3<f32> = normalize(light_direction + view_direction);
  var lambertian: f32 = dot(light_direction, normal_worldspace);
  var specular: f32 = 0.0;
  if (lambertian > 0.0) {
    let specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, material.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * material.diffuse * surfaceColor + specular * material.specularColor) * color;
}

fn lighting_getLightColor2(surfaceColor: vec3<f32>, cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32> {
  var lightColor: vec3<f32> = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  let view_direction: vec3<f32> = normalize(cameraPosition - position_worldspace);
  lightColor = material.ambient * surfaceColor * lighting.ambientColor;

  if (lighting.lightType == 0) {
    let pointLight: PointLight  = lighting_getPointLight(0);
    let light_position_worldspace: vec3<f32> = pointLight.position;
    let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  } else if (lighting.lightType == 1) {
    var directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
  /*
  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.pointLightCount) {
      break;
    }
    PointLight pointLight = lighting.pointLight[i];
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  }

  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.directionalLightCount) {
      break;
    }
    DirectionalLight directionalLight = lighting.directionalLight[i];
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  */
}

fn lighting_getSpecularLightColor(cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32>{
  var lightColor = vec3<f32>(0, 0, 0);
  let surfaceColor = vec3<f32>(0, 0, 0);

  if (lighting.enabled == 0) {
    let view_direction = normalize(cameraPosition - position_worldspace);

    switch (lighting.lightType) {
      case 0, default: {
        let pointLight: PointLight = lighting_getPointLight(0);
        let light_position_worldspace: vec3<f32> = pointLight.position;
        let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
        lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
      }
      case 1: {
        let directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
        lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
      }
    }
  }
  return lightColor;
}
`;var q_={name:"phongMaterial",dependencies:[Vp],source:BH,vs:QM,fs:JM,defines:{LIGHTING_FRAGMENT:1},uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(e){let t={...e};return t.specularColor&&(t.specularColor=t.specularColor.map(r=>r/255)),{...q_.defaultUniforms,...t}}};var DH=`out vec3 pbr_vPosition;
out vec2 pbr_vUV;

#ifdef HAS_NORMALS
# ifdef HAS_TANGENTS
out mat3 pbr_vTBN;
# else
out vec3 pbr_vNormal;
# endif
#endif

void pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)
{
  vec4 pos = pbrProjection.modelMatrix * position;
  pbr_vPosition = vec3(pos.xyz) / pos.w;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
  vec3 normalW = normalize(vec3(pbrProjection.normalMatrix * vec4(normal.xyz, 0.0)));
  vec3 tangentW = normalize(vec3(pbrProjection.modelMatrix * vec4(tangent.xyz, 0.0)));
  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;
  pbr_vTBN = mat3(tangentW, bitangentW, normalW);
#else // HAS_TANGENTS != 1
  pbr_vNormal = normalize(vec3(pbrProjection.modelMatrix * vec4(normal.xyz, 0.0)));
#endif
#endif

#ifdef HAS_UV
  pbr_vUV = uv;
#else
  pbr_vUV = vec2(0.,0.);
#endif
}
`;var NH=`precision highp float;

uniform pbrMaterialUniforms {
  // Material is unlit
  bool unlit;

  // Base color map
  bool baseColorMapEnabled;
  vec4 baseColorFactor;

  bool normalMapEnabled;  
  float normalScale; // #ifdef HAS_NORMALMAP

  bool emissiveMapEnabled;
  vec3 emissiveFactor; // #ifdef HAS_EMISSIVEMAP

  vec2 metallicRoughnessValues;
  bool metallicRoughnessMapEnabled;

  bool occlusionMapEnabled;
  float occlusionStrength; // #ifdef HAS_OCCLUSIONMAP
  
  bool alphaCutoffEnabled;
  float alphaCutoff; // #ifdef ALPHA_CUTOFF
  
  // IBL
  bool IBLenabled;
  vec2 scaleIBLAmbient; // #ifdef USE_IBL
  
  // debugging flags used for shader output of intermediate PBR variables
  // #ifdef PBR_DEBUG
  vec4 scaleDiffBaseMR;
  vec4 scaleFGDSpec;
  // #endif
} pbrMaterial;

// Samplers
#ifdef HAS_BASECOLORMAP
uniform sampler2D pbr_baseColorSampler;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D pbr_normalSampler;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D pbr_emissiveSampler;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D pbr_metallicRoughnessSampler;
#endif
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D pbr_occlusionSampler;
#endif
#ifdef USE_IBL
uniform samplerCube pbr_diffuseEnvSampler;
uniform samplerCube pbr_specularEnvSampler;
uniform sampler2D pbr_brdfLUT;
#endif

// Inputs from vertex shader

in vec3 pbr_vPosition;
in vec2 pbr_vUV;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
in mat3 pbr_vTBN;
#else
in vec3 pbr_vNormal;
#endif
#endif

// Encapsulate the various inputs used by the various functions in the shading equation
// We store values in this struct to simplify the integration of alternative implementations
// of the shading terms, outlined in the Readme.MD Appendix.
struct PBRInfo {
  float NdotL;                  // cos angle between normal and light direction
  float NdotV;                  // cos angle between normal and view direction
  float NdotH;                  // cos angle between normal and half vector
  float LdotH;                  // cos angle between light direction and half vector
  float VdotH;                  // cos angle between view direction and half vector
  float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)
  float metalness;              // metallic value at the surface
  vec3 reflectance0;            // full reflectance color (normal incidence angle)
  vec3 reflectance90;           // reflectance color at grazing angle
  float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])
  vec3 diffuseColor;            // color contribution from diffuse lighting
  vec3 specularColor;           // color contribution from specular lighting
  vec3 n;                       // normal at surface point
  vec3 v;                       // vector from surface point to camera
};

const float M_PI = 3.141592653589793;
const float c_MinRoughness = 0.04;

vec4 SRGBtoLINEAR(vec4 srgbIn)
{
#ifdef MANUAL_SRGB
#ifdef SRGB_FAST_APPROXIMATION
  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));
#else // SRGB_FAST_APPROXIMATION
  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);
  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );
#endif //SRGB_FAST_APPROXIMATION
  return vec4(linOut,srgbIn.w);;
#else //MANUAL_SRGB
  return srgbIn;
#endif //MANUAL_SRGB
}

// Find the normal for this fragment, pulling either from a predefined normal map
// or from the interpolated mesh normal and tangent attributes.
vec3 getNormal()
{
  // Retrieve the tangent space matrix
#ifndef HAS_TANGENTS
  vec3 pos_dx = dFdx(pbr_vPosition);
  vec3 pos_dy = dFdy(pbr_vPosition);
  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));
  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));
  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);

#ifdef HAS_NORMALS
  vec3 ng = normalize(pbr_vNormal);
#else
  vec3 ng = cross(pos_dx, pos_dy);
#endif

  t = normalize(t - ng * dot(ng, t));
  vec3 b = normalize(cross(ng, t));
  mat3 tbn = mat3(t, b, ng);
#else // HAS_TANGENTS
  mat3 tbn = pbr_vTBN;
#endif

#ifdef HAS_NORMALMAP
  vec3 n = texture(pbr_normalSampler, pbr_vUV).rgb;
  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(pbrMaterial.normalScale, pbrMaterial.normalScale, 1.0)));
#else
  // The tbn matrix is linearly interpolated, so we need to re-normalize
  vec3 n = normalize(tbn[2].xyz);
#endif

  return n;
}

// Calculation of the lighting contribution from an optional Image Based Light source.
// Precomputed Environment Maps are required uniform inputs and are computed as outlined in [1].
// See our README.md on Environment Maps [3] for additional discussion.
#ifdef USE_IBL
vec3 getIBLContribution(PBRInfo pbrInfo, vec3 n, vec3 reflection)
{
  float mipCount = 9.0; // resolution of 512x512
  float lod = (pbrInfo.perceptualRoughness * mipCount);
  // retrieve a scale and bias to F0. See [1], Figure 3
  vec3 brdf = SRGBtoLINEAR(texture(pbr_brdfLUT,
    vec2(pbrInfo.NdotV, 1.0 - pbrInfo.perceptualRoughness))).rgb;
  vec3 diffuseLight = SRGBtoLINEAR(texture(pbr_diffuseEnvSampler, n)).rgb;

#ifdef USE_TEX_LOD
  vec3 specularLight = SRGBtoLINEAR(texture(pbr_specularEnvSampler, reflection, lod)).rgb;
#else
  vec3 specularLight = SRGBtoLINEAR(texture(pbr_specularEnvSampler, reflection)).rgb;
#endif

  vec3 diffuse = diffuseLight * pbrInfo.diffuseColor;
  vec3 specular = specularLight * (pbrInfo.specularColor * brdf.x + brdf.y);

  // For presentation, this allows us to disable IBL terms
  diffuse *= pbrMaterial.scaleIBLAmbient.x;
  specular *= pbrMaterial.scaleIBLAmbient.y;

  return diffuse + specular;
}
#endif

// Basic Lambertian diffuse
// Implementation from Lambert's Photometria https://archive.org/details/lambertsphotome00lambgoog
// See also [1], Equation 1
vec3 diffuse(PBRInfo pbrInfo)
{
  return pbrInfo.diffuseColor / M_PI;
}

// The following equation models the Fresnel reflectance term of the spec equation (aka F())
// Implementation of fresnel from [4], Equation 15
vec3 specularReflection(PBRInfo pbrInfo)
{
  return pbrInfo.reflectance0 +
    (pbrInfo.reflectance90 - pbrInfo.reflectance0) *
    pow(clamp(1.0 - pbrInfo.VdotH, 0.0, 1.0), 5.0);
}

// This calculates the specular geometric attenuation (aka G()),
// where rougher material will reflect less light back to the viewer.
// This implementation is based on [1] Equation 4, and we adopt their modifications to
// alphaRoughness as input as originally proposed in [2].
float geometricOcclusion(PBRInfo pbrInfo)
{
  float NdotL = pbrInfo.NdotL;
  float NdotV = pbrInfo.NdotV;
  float r = pbrInfo.alphaRoughness;

  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));
  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));
  return attenuationL * attenuationV;
}

// The following equation(s) model the distribution of microfacet normals across
// the area being drawn (aka D())
// Implementation from "Average Irregularity Representation of a Roughened Surface
// for Ray Reflection" by T. S. Trowbridge, and K. P. Reitz
// Follows the distribution function recommended in the SIGGRAPH 2013 course notes
// from EPIC Games [1], Equation 3.
float microfacetDistribution(PBRInfo pbrInfo)
{
  float roughnessSq = pbrInfo.alphaRoughness * pbrInfo.alphaRoughness;
  float f = (pbrInfo.NdotH * roughnessSq - pbrInfo.NdotH) * pbrInfo.NdotH + 1.0;
  return roughnessSq / (M_PI * f * f);
}

void PBRInfo_setAmbientLight(inout PBRInfo pbrInfo) {
  pbrInfo.NdotL = 1.0;
  pbrInfo.NdotH = 0.0;
  pbrInfo.LdotH = 0.0;
  pbrInfo.VdotH = 1.0;
}

void PBRInfo_setDirectionalLight(inout PBRInfo pbrInfo, vec3 lightDirection) {
  vec3 n = pbrInfo.n;
  vec3 v = pbrInfo.v;
  vec3 l = normalize(lightDirection);             // Vector from surface point to light
  vec3 h = normalize(l+v);                        // Half vector between both l and v

  pbrInfo.NdotL = clamp(dot(n, l), 0.001, 1.0);
  pbrInfo.NdotH = clamp(dot(n, h), 0.0, 1.0);
  pbrInfo.LdotH = clamp(dot(l, h), 0.0, 1.0);
  pbrInfo.VdotH = clamp(dot(v, h), 0.0, 1.0);
}

void PBRInfo_setPointLight(inout PBRInfo pbrInfo, PointLight pointLight) {
  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);
  PBRInfo_setDirectionalLight(pbrInfo, light_direction);
}

vec3 calculateFinalColor(PBRInfo pbrInfo, vec3 lightColor) {
  // Calculate the shading terms for the microfacet specular shading model
  vec3 F = specularReflection(pbrInfo);
  float G = geometricOcclusion(pbrInfo);
  float D = microfacetDistribution(pbrInfo);

  // Calculation of analytical lighting contribution
  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInfo);
  vec3 specContrib = F * G * D / (4.0 * pbrInfo.NdotL * pbrInfo.NdotV);
  // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)
  return pbrInfo.NdotL * lightColor * (diffuseContrib + specContrib);
}

vec4 pbr_filterColor(vec4 colorUnused)
{
  // The albedo may be defined from a base texture or a flat color
#ifdef HAS_BASECOLORMAP
  vec4 baseColor = SRGBtoLINEAR(texture(pbr_baseColorSampler, pbr_vUV)) * pbrMaterial.baseColorFactor;
#else
  vec4 baseColor = pbrMaterial.baseColorFactor;
#endif

#ifdef ALPHA_CUTOFF
  if (baseColor.a < pbrMaterial.alphaCutoff) {
    discard;
  }
#endif

  vec3 color = vec3(0, 0, 0);

  if(pbrMaterial.unlit){
    color.rgb = baseColor.rgb;
  }
  else{
    // Metallic and Roughness material properties are packed together
    // In glTF, these factors can be specified by fixed scalar values
    // or from a metallic-roughness map
    float perceptualRoughness = pbrMaterial.metallicRoughnessValues.y;
    float metallic = pbrMaterial.metallicRoughnessValues.x;
#ifdef HAS_METALROUGHNESSMAP
    // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.
    // This layout intentionally reserves the 'r' channel for (optional) occlusion map data
    vec4 mrSample = texture(pbr_metallicRoughnessSampler, pbr_vUV);
    perceptualRoughness = mrSample.g * perceptualRoughness;
    metallic = mrSample.b * metallic;
#endif
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);
    metallic = clamp(metallic, 0.0, 1.0);
    // Roughness is authored as perceptual roughness; as is convention,
    // convert to material roughness by squaring the perceptual roughness [2].
    float alphaRoughness = perceptualRoughness * perceptualRoughness;

    vec3 f0 = vec3(0.04);
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);
    diffuseColor *= 1.0 - metallic;
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);

    // Compute reflectance.
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);

    // For typical incident reflectance range (between 4% to 100%) set the grazing
    // reflectance to 100% for typical fresnel effect.
    // For very low reflectance range on highly diffuse objects (below 4%),
    // incrementally reduce grazing reflecance to 0%.
    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);
    vec3 specularEnvironmentR0 = specularColor.rgb;
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;

    vec3 n = getNormal();                          // normal at surface point
    vec3 v = normalize(pbrProjection.camera - pbr_vPosition);  // Vector from surface point to camera

    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);
    vec3 reflection = -normalize(reflect(v, n));

    PBRInfo pbrInfo = PBRInfo(
      0.0, // NdotL
      NdotV,
      0.0, // NdotH
      0.0, // LdotH
      0.0, // VdotH
      perceptualRoughness,
      metallic,
      specularEnvironmentR0,
      specularEnvironmentR90,
      alphaRoughness,
      diffuseColor,
      specularColor,
      n,
      v
    );


#ifdef USE_LIGHTS
    // Apply ambient light
    PBRInfo_setAmbientLight(pbrInfo);
    color += calculateFinalColor(pbrInfo, lighting.ambientColor);

    // Apply directional light
    for(int i = 0; i < lighting.directionalLightCount; i++) {
      if (i < lighting.directionalLightCount) {
        PBRInfo_setDirectionalLight(pbrInfo, lighting_getDirectionalLight(i).direction);
        color += calculateFinalColor(pbrInfo, lighting_getDirectionalLight(i).color);
      }
    }

    // Apply point light
    for(int i = 0; i < lighting.pointLightCount; i++) {
      if (i < lighting.pointLightCount) {
        PBRInfo_setPointLight(pbrInfo, lighting_getPointLight(i));
        float attenuation = getPointLightAttenuation(lighting_getPointLight(i), distance(lighting_getPointLight(i).position, pbr_vPosition));
        color += calculateFinalColor(pbrInfo, lighting_getPointLight(i).color / attenuation);
      }
    }
#endif

    // Calculate lighting contribution from image based lighting source (IBL)
#ifdef USE_IBL
    if (pbrMaterial.IBLenabled) {
      color += getIBLContribution(pbrInfo, n, reflection);
    }
#endif

 // Apply optional PBR terms for additional (optional) shading
#ifdef HAS_OCCLUSIONMAP
    if (pbrMaterial.occlusionMapEnabled) {
      float ao = texture(pbr_occlusionSampler, pbr_vUV).r;
      color = mix(color, color * ao, pbrMaterial.occlusionStrength);
    }
#endif

#ifdef HAS_EMISSIVEMAP
    if (pbrMaterial.emissiveMapEnabled) {
      vec3 emissive = SRGBtoLINEAR(texture(pbr_emissiveSampler, pbr_vUV)).rgb * pbrMaterial.emissiveFactor;
      color += emissive;
    }
#endif

    // This section uses mix to override final color for reference app visualization
    // of various parameters in the lighting equation.
#ifdef PBR_DEBUG
    // TODO: Figure out how to debug multiple lights

    // color = mix(color, F, pbr_scaleFGDSpec.x);
    // color = mix(color, vec3(G), pbr_scaleFGDSpec.y);
    // color = mix(color, vec3(D), pbr_scaleFGDSpec.z);
    // color = mix(color, specContrib, pbr_scaleFGDSpec.w);

    // color = mix(color, diffuseContrib, pbr_scaleDiffBaseMR.x);
    color = mix(color, baseColor.rgb, pbrMaterial.scaleDiffBaseMR.y);
    color = mix(color, vec3(metallic), pbrMaterial.scaleDiffBaseMR.z);
    color = mix(color, vec3(perceptualRoughness), pbrMaterial.scaleDiffBaseMR.w);
#endif

  }

  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);
}
`;var kH=`uniform pbrProjectionUniforms {
  mat4 modelViewProjectionMatrix;
  mat4 modelMatrix;
  mat4 normalMatrix;
  vec3 camera;
} pbrProjection;
`,FH={name:"pbrProjection",vs:kH,fs:kH,getUniforms:e=>e,uniformTypes:{modelViewProjectionMatrix:"mat4x4<f32>",modelMatrix:"mat4x4<f32>",normalMatrix:"mat4x4<f32>",camera:"vec3<i32>"}};var r0={props:{},uniforms:{},name:"pbrMaterial",dependencies:[Vp,FH],vs:DH,fs:NH,defines:{LIGHTING_FRAGMENT:1},getUniforms:e=>e,uniformTypes:{unlit:"i32",baseColorMapEnabled:"i32",baseColorFactor:"vec4<f32>",normalMapEnabled:"i32",normalScale:"f32",emissiveMapEnabled:"i32",emissiveFactor:"vec3<f32>",metallicRoughnessValues:"vec2<f32>",metallicRoughnessMapEnabled:"i32",occlusionMapEnabled:"i32",occlusionStrength:"f32",alphaCutoffEnabled:"i32",alphaCutoff:"f32",IBLenabled:"i32",scaleIBLAmbient:"vec2<f32>",scaleDiffBaseMR:"vec4<f32>",scaleFGDSpec:"vec4<f32>"}};var R4=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;

 // Constant-Linear-Exponential
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`;var k_t={lightSources:{}};function L4(e={}){let{color:t=[0,0,0],intensity:r=1}=e;return t.map(n=>n*r/255)}function F_t({ambientLight:e,pointLights:t=[],directionalLights:r=[]}){let n={};return e?n["lighting_uAmbientLight.color"]=L4(e):n["lighting_uAmbientLight.color"]=[0,0,0],t.forEach((i,o)=>{n[`lighting_uPointLight[${o}].color`]=L4(i),n[`lighting_uPointLight[${o}].position`]=i.position,n[`lighting_uPointLight[${o}].attenuation`]=i.attenuation||[1,0,0]}),n.lighting_uPointLightCount=t.length,r.forEach((i,o)=>{n[`lighting_uDirectionalLight[${o}].color`]=L4(i),n[`lighting_uDirectionalLight[${o}].direction`]=i.direction}),n.lighting_uDirectionalLightCount=r.length,n}function zH(e=k_t){if("lightSources"in e){let{ambientLight:t,pointLights:r,directionalLights:n}=e.lightSources||{};return t||r&&r.length>0||n&&n.length>0?Object.assign({},F_t({ambientLight:t,pointLights:r,directionalLights:n}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){let t={pointLights:[],directionalLights:[]};for(let r of e.lights||[])switch(r.type){case"ambient":t.ambientLight=r;break;case"directional":t.directionalLights?.push(r);break;case"point":t.pointLights?.push(r);break;default:}return zH({lightSources:t})}return{}}var O4={name:"lights",vs:R4,fs:R4,getUniforms:zH,defines:{MAX_LIGHTS:3}};var B4=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`;var z_t={};function U_t(e){let{ambient:t=.35,diffuse:r=.6,shininess:n=32,specularColor:i=[30,30,30]}=e;return{lighting_uAmbient:t,lighting_uDiffuse:r,lighting_uShininess:n,lighting_uSpecularColor:i.map(o=>o/255)}}function UH(e=z_t){if(!("material"in e))return{};let{material:t}=e;return t?U_t(t):{lighting_uEnabled:!1}}var tS={name:"gouraud-lighting",dependencies:[O4],vs:B4,defines:{LIGHTING_VERTEX:1},getUniforms:UH},eS={name:"phong-lighting",dependencies:[O4],fs:B4,defines:{LIGHTING_FRAGMENT:1},getUniforms:UH};var VH=`uniform layerUniforms {
  uniform float opacity;
} layer;
`,D4={name:"layer",vs:VH,fs:VH,getUniforms:e=>({opacity:Math.pow(e.opacity,.45454545454545453)}),uniformTypes:{opacity:"f32"}};var jH="#define SMOOTH_EDGE_RADIUS 0.5",V_t=`
${jH}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,j_t=`
${jH}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,rS={name:"geometry",vs:V_t,fs:j_t};var Ao;(function(e){e[e.Start=1]="Start",e[e.Move=2]="Move",e[e.End=4]="End",e[e.Cancel=8]="Cancel"})(Ao||(Ao={}));var ls;(function(e){e[e.None=0]="None",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Up=4]="Up",e[e.Down=8]="Down",e[e.Horizontal=3]="Horizontal",e[e.Vertical=12]="Vertical",e[e.All=15]="All"})(ls||(ls={}));var Mn;(function(e){e[e.Possible=1]="Possible",e[e.Began=2]="Began",e[e.Changed=4]="Changed",e[e.Ended=8]="Ended",e[e.Recognized=8]="Recognized",e[e.Cancelled=16]="Cancelled",e[e.Failed=32]="Failed"})(Mn||(Mn={}));var HH="compute",N4="auto",Qv="manipulation",n0="none",Jv="pan-x",t2="pan-y";function k4(e){if(e.includes(n0))return n0;let t=e.includes(Jv),r=e.includes(t2);return t&&r?n0:t||r?t?Jv:t2:e.includes(Qv)?Qv:N4}var e2=class{constructor(t,r){this.actions="",this.manager=t,this.set(r)}set(t){t===HH&&(t=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=t,this.actions=t)}update(){this.set(this.manager.options.touchAction)}compute(){let t=[];for(let r of this.manager.recognizers)r.options.enable&&(t=t.concat(r.getTouchAction()));return k4(t.join(" "))}};function G_(e){return e.trim().split(/\s+/g)}function nS(e,t,r){if(e)for(let n of G_(t))e.addEventListener(n,r,!1)}function iS(e,t,r){if(e)for(let n of G_(t))e.removeEventListener(n,r,!1)}function F4(e){return(e.ownerDocument||e).defaultView}function z4(e,t){let r=e;for(;r;){if(r===t)return!0;r=r.parentNode}return!1}function oS(e){let t=e.length;if(t===1)return{x:Math.round(e[0].clientX),y:Math.round(e[0].clientY)};let r=0,n=0,i=0;for(;i<t;)r+=e[i].clientX,n+=e[i].clientY,i++;return{x:Math.round(r/t),y:Math.round(n/t)}}function U4(e){let t=[],r=0;for(;r<e.pointers.length;)t[r]={clientX:Math.round(e.pointers[r].clientX),clientY:Math.round(e.pointers[r].clientY)},r++;return{timeStamp:Date.now(),pointers:t,center:oS(t),deltaX:e.deltaX,deltaY:e.deltaY}}function sS(e,t){let r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)}function V4(e,t){let r=t.clientX-e.clientX,n=t.clientY-e.clientY;return Math.sqrt(r*r+n*n)}function WH(e,t){let r=t.x-e.x,n=t.y-e.y;return Math.atan2(n,r)*180/Math.PI}function j4(e,t){let r=t.clientX-e.clientX,n=t.clientY-e.clientY;return Math.atan2(n,r)*180/Math.PI}function aS(e,t){return e===t?ls.None:Math.abs(e)>=Math.abs(t)?e<0?ls.Left:ls.Right:t<0?ls.Up:ls.Down}function qH(e,t){let r=t.center,n=e.offsetDelta,i=e.prevDelta,o=e.prevInput;return(t.eventType===Ao.Start||o?.eventType===Ao.End)&&(i=e.prevDelta={x:o?.deltaX||0,y:o?.deltaY||0},n=e.offsetDelta={x:r.x,y:r.y}),{deltaX:i.x+(r.x-n.x),deltaY:i.y+(r.y-n.y)}}function cS(e,t,r){return{x:t/e||0,y:r/e||0}}function GH(e,t){return V4(t[0],t[1])/V4(e[0],e[1])}function XH(e,t){return j4(t[1],t[0])-j4(e[1],e[0])}function YH(e,t){let r=e.lastInterval||t,n=t.timeStamp-r.timeStamp,i,o,s,c;if(t.eventType!==Ao.Cancel&&(n>25||r.velocity===void 0)){let l=t.deltaX-r.deltaX,h=t.deltaY-r.deltaY,p=cS(n,l,h);o=p.x,s=p.y,i=Math.abs(p.x)>Math.abs(p.y)?p.x:p.y,c=aS(l,h),e.lastInterval=t}else i=r.velocity,o=r.velocityX,s=r.velocityY,c=r.direction;t.velocity=i,t.velocityX=o,t.velocityY=s,t.direction=c}function KH(e,t){let{session:r}=e,{pointers:n}=t,{length:i}=n;r.firstInput||(r.firstInput=U4(t)),i>1&&!r.firstMultiple?r.firstMultiple=U4(t):i===1&&(r.firstMultiple=!1);let{firstInput:o,firstMultiple:s}=r,c=s?s.center:o.center,l=t.center=oS(n);t.timeStamp=Date.now(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=WH(c,l),t.distance=sS(c,l);let{deltaX:h,deltaY:p}=qH(r,t);t.deltaX=h,t.deltaY=p,t.offsetDirection=aS(t.deltaX,t.deltaY);let x=cS(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=x.x,t.overallVelocityY=x.y,t.overallVelocity=Math.abs(x.x)>Math.abs(x.y)?x.x:x.y,t.scale=s?GH(s.pointers,n):1,t.rotation=s?XH(s.pointers,n):0,t.maxPointers=r.prevInput?t.pointers.length>r.prevInput.maxPointers?t.pointers.length:r.prevInput.maxPointers:t.pointers.length;let w=e.element;return z4(t.srcEvent.target,w)&&(w=t.srcEvent.target),t.target=w,YH(r,t),t}function ZH(e,t,r){let n=r.pointers.length,i=r.changedPointers.length,o=t&Ao.Start&&n-i===0,s=t&(Ao.End|Ao.Cancel)&&n-i===0;r.isFirst=Boolean(o),r.isFinal=Boolean(s),o&&(e.session={}),r.eventType=t;let c=KH(e,r);e.emit("hammer.input",c),e.recognize(c),e.session.prevInput=c}var r2=class{constructor(t){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=r=>{this.manager.options.enable&&this.handler(r)},this.manager=t,this.element=t.element,this.target=t.options.inputTarget||t.element}callback(t,r){ZH(this.manager,t,r)}init(){nS(this.element,this.evEl,this.domHandler),nS(this.target,this.evTarget,this.domHandler),nS(F4(this.element),this.evWin,this.domHandler)}destroy(){iS(this.element,this.evEl,this.domHandler),iS(this.target,this.evTarget,this.domHandler),iS(F4(this.element),this.evWin,this.domHandler)}};var W_t={pointerdown:Ao.Start,pointermove:Ao.Move,pointerup:Ao.End,pointercancel:Ao.Cancel,pointerout:Ao.Cancel},q_t="pointerdown",G_t="pointermove pointerup pointercancel",n2=class extends r2{constructor(t){super(t),this.evEl=q_t,this.evWin=G_t,this.store=this.manager.session.pointerEvents=[],this.init()}handler(t){let{store:r}=this,n=!1,i=W_t[t.type],o=t.pointerType,s=o==="touch",c=r.findIndex(l=>l.pointerId===t.pointerId);i&Ao.Start&&(t.buttons||s)?c<0&&(r.push(t),c=r.length-1):i&(Ao.End|Ao.Cancel)&&(n=!0),!(c<0)&&(r[c]=t,this.callback(i,{pointers:r,changedPointers:[t],eventType:i,pointerType:o,srcEvent:t}),n&&r.splice(c,1))}};var X_t=["","webkit","Moz","MS","ms","o"];function $H(e,t){let r=t[0].toUpperCase()+t.slice(1);for(let n of X_t){let i=n?n+r:t;if(i in e)return i}}var Y_t=1,QH=2,JH={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}},i2=class{constructor(t,r){this.options={...JH,...r,cssProps:{...JH.cssProps,...r.cssProps},inputTarget:r.inputTarget||t},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new n2(this),this.touchAction=new e2(this,this.options.touchAction),this.toggleCssProps(!0)}set(t){return Object.assign(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this}stop(t){this.session.stopped=t?QH:Y_t}recognize(t){let{session:r}=this;if(r.stopped)return;this.session.prevented&&t.srcEvent.preventDefault();let n,{recognizers:i}=this,{curRecognizer:o}=r;(!o||o&&o.state&Mn.Recognized)&&(o=r.curRecognizer=null);let s=0;for(;s<i.length;)n=i[s],r.stopped!==QH&&(!o||n===o||n.canRecognizeWith(o))?n.recognize(t):n.reset(),!o&&n.state&(Mn.Began|Mn.Changed|Mn.Ended)&&(o=r.curRecognizer=n),s++}get(t){let{recognizers:r}=this;for(let n=0;n<r.length;n++)if(r[n].options.event===t)return r[n];return null}add(t){if(Array.isArray(t)){for(let n of t)this.add(n);return this}let r=this.get(t.options.event);return r&&this.remove(r),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t}remove(t){if(Array.isArray(t)){for(let n of t)this.remove(n);return this}let r=typeof t=="string"?this.get(t):t;if(r){let{recognizers:n}=this,i=n.indexOf(r);i!==-1&&(n.splice(i,1),this.touchAction.update())}return this}on(t,r){if(!t||!r)return;let{handlers:n}=this;for(let i of G_(t))n[i]=n[i]||[],n[i].push(r)}off(t,r){if(!t)return;let{handlers:n}=this;for(let i of G_(t))r?n[i]&&n[i].splice(n[i].indexOf(r),1):delete n[i]}emit(t,r){let n=this.handlers[t]&&this.handlers[t].slice();if(!n||!n.length)return;let i=r;i.type=t,i.preventDefault=function(){r.srcEvent.preventDefault()};let o=0;for(;o<n.length;)n[o](i),o++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(t){let{element:r}=this;if(r){for(let[n,i]of Object.entries(this.options.cssProps)){let o=$H(r.style,n);t?(this.oldCssProps[o]=r.style[o],r.style[o]=i):r.style[o]=this.oldCssProps[o]||""}t||(this.oldCssProps={})}}};var K_t=1;function tW(){return K_t++}function H4(e){return e&Mn.Cancelled?"cancel":e&Mn.Ended?"end":e&Mn.Changed?"move":e&Mn.Began?"start":""}var jp=class{constructor(t){this.options=t,this.id=tW(),this.state=Mn.Possible,this.simultaneous={},this.requireFail=[]}set(t){return Object.assign(this.options,t),this.manager.touchAction.update(),this}recognizeWith(t){if(Array.isArray(t)){for(let i of t)this.recognizeWith(i);return this}let r;if(typeof t=="string"){if(r=this.manager.get(t),!r)throw new Error(`Cannot find recognizer ${t}`)}else r=t;let{simultaneous:n}=this;return n[r.id]||(n[r.id]=r,r.recognizeWith(this)),this}dropRecognizeWith(t){if(Array.isArray(t)){for(let n of t)this.dropRecognizeWith(n);return this}let r;return typeof t=="string"?r=this.manager.get(t):r=t,r&&delete this.simultaneous[r.id],this}requireFailure(t){if(Array.isArray(t)){for(let i of t)this.requireFailure(i);return this}let r;if(typeof t=="string"){if(r=this.manager.get(t),!r)throw new Error(`Cannot find recognizer ${t}`)}else r=t;let{requireFail:n}=this;return n.indexOf(r)===-1&&(n.push(r),r.requireFailure(this)),this}dropRequireFailure(t){if(Array.isArray(t)){for(let n of t)this.dropRequireFailure(n);return this}let r;if(typeof t=="string"?r=this.manager.get(t):r=t,r){let n=this.requireFail.indexOf(r);n>-1&&this.requireFail.splice(n,1)}return this}hasRequireFailures(){return Boolean(this.requireFail.find(t=>t.options.enable))}canRecognizeWith(t){return Boolean(this.simultaneous[t.id])}emit(t){if(!t)return;let{state:r}=this;r<Mn.Ended&&this.manager.emit(this.options.event+H4(r),t),this.manager.emit(this.options.event,t),t.additionalEvent&&this.manager.emit(t.additionalEvent,t),r>=Mn.Ended&&this.manager.emit(this.options.event+H4(r),t)}tryEmit(t){this.canEmit()?this.emit(t):this.state=Mn.Failed}canEmit(){let t=0;for(;t<this.requireFail.length;){if(!(this.requireFail[t].state&(Mn.Failed|Mn.Possible)))return!1;t++}return!0}recognize(t){let r={...t};if(!this.options.enable){this.reset(),this.state=Mn.Failed;return}this.state&(Mn.Recognized|Mn.Cancelled|Mn.Failed)&&(this.state=Mn.Possible),this.state=this.process(r),this.state&(Mn.Began|Mn.Changed|Mn.Ended|Mn.Cancelled)&&this.tryEmit(r)}getEventNames(){return[this.options.event]}reset(){}};var Hp=class extends jp{attrTest(t){let r=this.options.pointers;return r===0||t.pointers.length===r}process(t){let{state:r}=this,{eventType:n}=t,i=r&(Mn.Began|Mn.Changed),o=this.attrTest(t);return i&&(n&Ao.Cancel||!o)?r|Mn.Cancelled:i||o?n&Ao.End?r|Mn.Ended:r&Mn.Began?r|Mn.Changed:Mn.Began:Mn.Failed}};var i0=class extends jp{constructor(t={}){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...t}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[Qv]}process(t){let{options:r}=this,n=t.pointers.length===r.pointers,i=t.distance<r.threshold,o=t.deltaTime<r.time;if(this.reset(),t.eventType&Ao.Start&&this.count===0)return this.failTimeout();if(i&&o&&n){if(t.eventType!==Ao.End)return this.failTimeout();let s=this.pTime?t.timeStamp-this.pTime<r.interval:!0,c=!this.pCenter||sS(this.pCenter,t.center)<r.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,!c||!s?this.count=1:this.count+=1,this._input=t,this.count%r.taps===0)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=Mn.Recognized,this.tryEmit(this._input)},r.interval),Mn.Began):Mn.Recognized}return Mn.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=Mn.Failed},this.options.interval),Mn.Failed}reset(){clearTimeout(this._timer)}emit(t){this.state===Mn.Recognized&&(t.tapCount=this.count,this.manager.emit(this.options.event,t))}};var Z_t=["","start","move","end","cancel","up","down","left","right"],pm=class extends Hp{constructor(t={}){super({enable:!0,pointers:1,event:"pan",threshold:10,direction:ls.All,...t}),this.pX=null,this.pY=null}getTouchAction(){let{options:{direction:t}}=this,r=[];return t&ls.Horizontal&&r.push(t2),t&ls.Vertical&&r.push(Jv),r}getEventNames(){return Z_t.map(t=>this.options.event+t)}directionTest(t){let{options:r}=this,n=!0,{distance:i}=t,{direction:o}=t,s=t.deltaX,c=t.deltaY;return o&r.direction||(r.direction&ls.Horizontal?(o=s===0?ls.None:s<0?ls.Left:ls.Right,n=s!==this.pX,i=Math.abs(t.deltaX)):(o=c===0?ls.None:c<0?ls.Up:ls.Down,n=c!==this.pY,i=Math.abs(t.deltaY))),t.direction=o,n&&i>r.threshold&&Boolean(o&r.direction)}attrTest(t){return super.attrTest(t)&&(Boolean(this.state&Mn.Began)||!(this.state&Mn.Began)&&this.directionTest(t))}emit(t){this.pX=t.deltaX,this.pY=t.deltaY;let r=ls[t.direction].toLowerCase();r&&(t.additionalEvent=this.options.event+r),super.emit(t)}};var $_t=["","start","move","end","cancel","in","out"],X_=class extends Hp{constructor(t={}){super({enable:!0,event:"pinch",threshold:0,pointers:2,...t})}getTouchAction(){return[n0]}getEventNames(){return $_t.map(t=>this.options.event+t)}attrTest(t){return super.attrTest(t)&&(Math.abs(t.scale-1)>this.options.threshold||Boolean(this.state&Mn.Began))}emit(t){if(t.scale!==1){let r=t.scale<1?"in":"out";t.additionalEvent=this.options.event+r}super.emit(t)}};var Hf=class{constructor(t,r,n){this.element=t,this.callback=r,this.options=n}};var eW=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",RJt=typeof window<"u"?window:global;var eyt=eW.indexOf("firefox")!==-1,rW=4.000244140625,ryt=40,nyt=.25,lS=class extends Hf{constructor(t,r,n){super(t,r,{enable:!0,...n}),this.handleEvent=i=>{if(!this.options.enable)return;let o=i.deltaY;globalThis.WheelEvent&&(eyt&&i.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(o/=globalThis.devicePixelRatio),i.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(o*=ryt)),o!==0&&o%rW===0&&(o=Math.floor(o/rW)),i.shiftKey&&o&&(o=o*nyt),this.callback({type:"wheel",center:{x:i.clientX,y:i.clientY},delta:-o,srcEvent:i,pointerType:"mouse",target:i.target})},t.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(t,r){t==="wheel"&&(this.options.enable=r)}};var nW=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],uS=class extends Hf{constructor(t,r,n){super(t,r,{enable:!0,...n}),this.handleEvent=o=>{this.handleOverEvent(o),this.handleOutEvent(o),this.handleEnterEvent(o),this.handleLeaveEvent(o),this.handleMoveEvent(o)},this.pressed=!1;let{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,nW.forEach(o=>t.addEventListener(o,this.handleEvent))}destroy(){nW.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,r){switch(t){case"pointermove":this.enableMoveEvent=r;break;case"pointerover":this.enableOverEvent=r;break;case"pointerout":this.enableOutEvent=r;break;case"pointerenter":this.enableEnterEvent=r;break;case"pointerleave":this.enableLeaveEvent=r;break;default:}}handleOverEvent(t){this.enableOverEvent&&t.type==="mouseover"&&this._emit("pointerover",t)}handleOutEvent(t){this.enableOutEvent&&t.type==="mouseout"&&this._emit("pointerout",t)}handleEnterEvent(t){this.enableEnterEvent&&t.type==="mouseenter"&&this._emit("pointerenter",t)}handleLeaveEvent(t){this.enableLeaveEvent&&t.type==="mouseleave"&&this._emit("pointerleave",t)}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":t.buttons===0&&(this.pressed=!1),this.pressed||this._emit("pointermove",t);break;case"mouseup":this.pressed=!1;break;default:}}_emit(t,r){this.callback({type:t,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})}};var iW=["keydown","keyup"],hS=class extends Hf{constructor(t,r,n){super(t,r,{enable:!0,tabIndex:0,...n}),this.handleEvent=i=>{let o=i.target||i.srcElement;o.tagName==="INPUT"&&o.type==="text"||o.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:"keydown",srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:"keyup",srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,t.tabIndex=this.options.tabIndex,t.style.outline="none",iW.forEach(i=>t.addEventListener(i,this.handleEvent))}destroy(){iW.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,r){t==="keydown"&&(this.enableDownEvent=r),t==="keyup"&&(this.enableUpEvent=r)}};var fS=class extends Hf{constructor(t,r,n){super(t,r,n),this.handleEvent=i=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,r){t==="contextmenu"&&(this.options.enable=r)}};var iyt={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},oyt=0,syt=1,ayt=2,cyt=1,lyt=2,uyt=4;function oW(e){let t=iyt[e.srcEvent.type];if(!t)return null;let{buttons:r,button:n}=e.srcEvent,i=!1,o=!1,s=!1;return t===2?(i=Boolean(r&cyt),o=Boolean(r&uyt),s=Boolean(r&lyt)):(i=n===oyt,o=n===syt,s=n===ayt),{leftButton:i,middleButton:o,rightButton:s}}function sW(e,t){let r=e.center;if(!r)return null;let n=t.getBoundingClientRect(),i=n.width/t.offsetWidth||1,o=n.height/t.offsetHeight||1,s={x:(r.x-n.left-t.clientLeft)/i,y:(r.y-n.top-t.clientTop)/o};return{center:r,offsetCenter:s}}var hyt={srcElement:"root",priority:0},pS=class{constructor(t,r){this.handleEvent=n=>{if(this.isEmpty())return;let i=this._normalizeEvent(n),o=n.srcEvent.target;for(;o&&o!==i.rootElement;){if(this._emit(i,o),i.handled)return;o=o.parentNode}this._emit(i,"root")},this.eventManager=t,this.recognizerName=r,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(t,r,n,i=!1,o=!1){let{handlers:s,handlersByElement:c}=this,l={...hyt,...n},h=c.get(l.srcElement);h||(h=[],c.set(l.srcElement,h));let p={type:t,handler:r,srcElement:l.srcElement,priority:l.priority};i&&(p.once=!0),o&&(p.passive=!0),s.push(p),this._active=this._active||!p.passive;let x=h.length-1;for(;x>=0&&!(h[x].priority>=p.priority);)x--;h.splice(x+1,0,p)}remove(t,r){let{handlers:n,handlersByElement:i}=this;for(let o=n.length-1;o>=0;o--){let s=n[o];if(s.type===t&&s.handler===r){n.splice(o,1);let c=i.get(s.srcElement);c.splice(c.indexOf(s),1),c.length===0&&i.delete(s.srcElement)}}this._active=n.some(o=>!o.passive)}_emit(t,r){let n=this.handlersByElement.get(r);if(n){let i=!1,o=()=>{t.handled=!0},s=()=>{t.handled=!0,i=!0},c=[];for(let l=0;l<n.length;l++){let{type:h,handler:p,once:x}=n[l];if(p({...t,type:h,stopPropagation:o,stopImmediatePropagation:s}),x&&c.push(n[l]),i)break}for(let l=0;l<c.length;l++){let{type:h,handler:p}=c[l];this.remove(h,p)}}}_normalizeEvent(t){let r=this.eventManager.getElement();return{...t,...oW(t),...sW(t,r),preventDefault:()=>{t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:r}}};function fyt(e){if("recognizer"in e)return e;let t,r=Array.isArray(e)?[...e]:[e];if(typeof r[0]=="function"){let n=r.shift(),i=r.shift()||{};t=new n(i)}else t=r.shift();return{recognizer:t,recognizeWith:typeof r[0]=="string"?[r[0]]:r[0],requireFailure:typeof r[1]=="string"?[r[1]]:r[1]}}var o2=class{constructor(t=null,r={}){if(this._onBasicInput=n=>{this.manager.emit(n.srcEvent.type,n)},this._onOtherEvent=n=>{this.manager.emit(n.type,n)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...r},this.events=new Map,this.element=t,!!t){this.manager=new i2(t,this.options);for(let n of this.options.recognizers){let{recognizer:i,recognizeWith:o,requireFailure:s}=fyt(n);this.manager.add(i),o&&i.recognizeWith(o),s&&i.requireFailure(s)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new lS(t,this._onOtherEvent,{enable:!1}),this.moveInput=new uS(t,this._onOtherEvent,{enable:!1}),this.keyInput=new hS(t,this._onOtherEvent,{enable:!1,tabIndex:r.tabIndex}),this.contextmenuInput=new fS(t,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(t,r,n){this._addEventHandler(t,r,n,!1)}once(t,r,n){this._addEventHandler(t,r,n,!0)}watch(t,r,n){this._addEventHandler(t,r,n,!1,!0)}off(t,r){this._removeEventHandler(t,r)}_toggleRecognizer(t,r){let{manager:n}=this;if(!n)return;let i=n.get(t);i&&(i.set({enable:r}),n.touchAction.update()),this.wheelInput?.enableEventType(t,r),this.moveInput?.enableEventType(t,r),this.keyInput?.enableEventType(t,r),this.contextmenuInput?.enableEventType(t,r)}_addEventHandler(t,r,n,i,o){if(typeof t!="string"){n=r;for(let[h,p]of Object.entries(t))this._addEventHandler(h,p,n,i,o);return}let{manager:s,events:c}=this;if(!s)return;let l=c.get(t);if(!l){let h=this._getRecognizerName(t)||t;l=new pS(this,h),c.set(t,l),s&&s.on(t,l.handleEvent)}l.add(t,r,n,i,o),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(t,r){if(typeof t!="string"){for(let[o,s]of Object.entries(t))this._removeEventHandler(o,s);return}let{events:n}=this,i=n.get(t);if(i&&(i.remove(t,r),i.isEmpty())){let{recognizerName:o}=i,s=!1;for(let c of n.values())if(c.recognizerName===o&&!c.isEmpty()){s=!0;break}s||this._toggleRecognizer(o,!1)}}_getRecognizerName(t){return this.manager.recognizers.find(r=>r.getEventNames().includes(t))?.options.event}};var Yr={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Yr,"IDENTITY",{get:()=>(br.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});var zc={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},us={common:0,meters:1,pixels:2},s2={click:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},W4={multipan:[pm,{threshold:10,direction:ls.Vertical,pointers:2}],pinch:[X_,{},null,["multipan"]],pan:[pm,{threshold:1},["pinch"],["multipan"]],dblclick:[i0,{event:"dblclick",taps:2}],click:[i0,{event:"click"},null,["dblclick"]]},aW={DRAW:"draw",MASK:"mask",TERRAIN:"terrain"};var pyt=Object.keys(Yr).map(e=>`const int COORDINATE_SYSTEM_${e} = ${Yr[e]};`).join(""),dyt=Object.keys(zc).map(e=>`const int PROJECTION_MODE_${e} = ${zc[e]};`).join(""),myt=Object.keys(us).map(e=>`const int UNIT_${e.toUpperCase()} = ${us[e]};`).join(""),cW=`${pyt}
${dyt}
${myt}
uniform projectUniforms {
bool wrapLongitude;
int coordinateSystem;
vec3 commonUnitsPerMeter;
int projectionMode;
float scale;
vec3 commonUnitsPerWorldUnit;
vec3 commonUnitsPerWorldUnit2;
vec4 center;
mat4 modelMatrix;
mat4 viewProjectionMatrix;
vec2 viewportSize;
float devicePixelRatio;
float focalDistance;
vec3 cameraPosition;
vec3 coordinateOrigin;
vec3 commonOrigin;
bool pseudoMeters;
} project;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project.pseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project.commonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project.commonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project.commonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project.wrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project.modelMatrix * position;
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project.coordinateOrigin;
}
}
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project.commonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project.coordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
return offset * project.focalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project.scale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project.scale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project.scale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project.scale;
}
`;function Ayt(e,t){if(e===t)return!0;if(Array.isArray(e)){let r=e.length;if(!t||t.length!==r)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}return!1}function Gu(e){let t={},r;return n=>{for(let i in n)if(!Ayt(n[i],t[i])){r=e(n),t=n;break}return r}}var lW=[0,0,0,0],gyt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],uW=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_yt=[0,0,0],hW=[0,0,0],yyt=Gu(vyt);function q4(e,t,r=hW){r.length<3&&(r=[r[0],r[1],0]);let n=r,i,o=!0;switch(t===Yr.LNGLAT_OFFSETS||t===Yr.METER_OFFSETS?i=r:i=e.isGeospatial?[Math.fround(e.longitude),Math.fround(e.latitude),0]:null,e.projectionMode){case zc.WEB_MERCATOR:(t===Yr.LNGLAT||t===Yr.CARTESIAN)&&(i=[0,0,0],o=!1);break;case zc.WEB_MERCATOR_AUTO_OFFSET:t===Yr.LNGLAT?n=i:t===Yr.CARTESIAN&&(n=[Math.fround(e.center[0]),Math.fround(e.center[1]),0],i=e.unprojectPosition(n),n[0]-=r[0],n[1]-=r[1],n[2]-=r[2]);break;case zc.IDENTITY:n=e.position.map(Math.fround),n[2]=n[2]||0;break;case zc.GLOBE:o=!1,i=null;break;default:o=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:n,offsetMode:o}}function xyt(e,t,r){let{viewMatrixUncentered:n,projectionMatrix:i}=e,{viewMatrix:o,viewProjectionMatrix:s}=e,c=lW,l=lW,h=e.cameraPosition,{geospatialOrigin:p,shaderCoordinateOrigin:x,offsetMode:w}=q4(e,t,r);return w&&(l=e.projectPosition(p||x),h=[h[0]-l[0],h[1]-l[1],h[2]-l[2]],l[3]=1,c=hl.transformMat4([],l,s),o=n||o,s=Gs.multiply([],i,o),s=Gs.multiply([],s,gyt)),{viewMatrix:o,viewProjectionMatrix:s,projectionCenter:c,originCommon:l,cameraPosCommon:h,shaderCoordinateOrigin:x,geospatialOrigin:p}}function dS({viewport:e,devicePixelRatio:t=1,modelMatrix:r=null,coordinateSystem:n=Yr.DEFAULT,coordinateOrigin:i=hW,autoWrapLongitude:o=!1}){n===Yr.DEFAULT&&(n=e.isGeospatial?Yr.LNGLAT:Yr.CARTESIAN);let s=yyt({viewport:e,devicePixelRatio:t,coordinateSystem:n,coordinateOrigin:i});return s.wrapLongitude=o,s.modelMatrix=r||uW,s}function vyt({viewport:e,devicePixelRatio:t,coordinateSystem:r,coordinateOrigin:n}){let{projectionCenter:i,viewProjectionMatrix:o,originCommon:s,cameraPosCommon:c,shaderCoordinateOrigin:l,geospatialOrigin:h}=xyt(e,r,n),p=e.getDistanceScales(),x=[e.width*t,e.height*t],w=hl.transformMat4([],[0,0,-e.focalDistance,1],e.projectionMatrix)[3]||1,E={coordinateSystem:r,projectionMode:e.projectionMode,coordinateOrigin:l,commonOrigin:s.slice(0,3),center:i,pseudoMeters:Boolean(e._pseudoMeters),viewportSize:x,devicePixelRatio:t,focalDistance:w,commonUnitsPerMeter:p.unitsPerMeter,commonUnitsPerWorldUnit:p.unitsPerMeter,commonUnitsPerWorldUnit2:_yt,scale:e.scale,wrapLongitude:!1,viewProjectionMatrix:o,modelMatrix:uW,cameraPosition:c};if(h){let P=e.getDistanceScales(h);switch(r){case Yr.METER_OFFSETS:E.commonUnitsPerWorldUnit=P.unitsPerMeter,E.commonUnitsPerWorldUnit2=P.unitsPerMeter2;break;case Yr.LNGLAT:case Yr.LNGLAT_OFFSETS:e._pseudoMeters||(E.commonUnitsPerMeter=P.unitsPerMeter),E.commonUnitsPerWorldUnit=P.unitsPerDegree,E.commonUnitsPerWorldUnit2=P.unitsPerDegree2;break;case Yr.CARTESIAN:E.commonUnitsPerWorldUnit=[1,1,P.unitsPerMeter[2]],E.commonUnitsPerWorldUnit2=[0,0,P.unitsPerMeter2[2]];break;default:break}}return E}var byt={};function wyt(e=byt){return"viewport"in e?dS(e):{}}var dm={name:"project",dependencies:[S4,rS],vs:cW,getUniforms:wyt,uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}};var Tyt=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Ei={name:"project32",dependencies:[dm],vs:Tyt};function G4(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function mm(e,t){let r=hl.transformMat4([],t,e);return hl.scale(r,r,1/r[3]),r}function X4(e,t){let r=e%t;return r<0?t+r:r}function fW(e,t,r){return r*t+(1-r)*e}function a2(e,t,r){return e<t?t:e>r?r:e}function Eyt(e){return Math.log(e)*Math.LOG2E}var Y_=Math.log2||Eyt;function Rh(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}var Lh=Math.PI,pW=Lh/4,Xu=Lh/180,Y4=180/Lh,K_=512,mS=4003e4,Yu=85.051129,dW=1.5;function c2(e){return Math.pow(2,e)}function AS(e){return Y_(e)}function za(e){let[t,r]=e;Rh(Number.isFinite(t)),Rh(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");let n=t*Xu,i=r*Xu,o=K_*(n+Lh)/(2*Lh),s=K_*(Lh+Math.log(Math.tan(pW+i*.5)))/(2*Lh);return[o,s]}function Tc(e){let[t,r]=e,n=t/K_*(2*Lh)-Lh,i=2*(Math.atan(Math.exp(r/K_*(2*Lh)-Lh))-pW);return[n*Y4,i*Y4]}function l2(e){let{latitude:t}=e;Rh(Number.isFinite(t));let r=Math.cos(t*Xu);return AS(mS*r)-9}function u2(e){let t=Math.cos(e*Xu);return K_/mS/t}function Z_(e){let{latitude:t,longitude:r,highPrecision:n=!1}=e;Rh(Number.isFinite(t)&&Number.isFinite(r));let i=K_,o=Math.cos(t*Xu),s=i/360,c=s/o,l=i/mS/o,h={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[s,c,l],degreesPerUnit:[1/s,1/c,1/l]};if(n){let p=Xu*Math.tan(t*Xu)/o,x=s*p/2,w=i/mS*p,E=w/c*l;h.unitsPerDegree2=[0,x,w],h.unitsPerMeter2=[E,0,E]}return h}function h2(e,t){let[r,n,i]=e,[o,s,c]=t,{unitsPerMeter:l,unitsPerMeter2:h}=Z_({longitude:r,latitude:n,highPrecision:!0}),p=za(e);p[0]+=o*(l[0]+h[0]*s),p[1]+=s*(l[1]+h[1]*s);let x=Tc(p),w=(i||0)+(c||0);return Number.isFinite(i)||Number.isFinite(c)?[x[0],x[1],w]:x}function gS(e){let{height:t,pitch:r,bearing:n,altitude:i,scale:o,center:s}=e,c=G4();Gs.translate(c,c,[0,0,-i]),Gs.rotateX(c,c,-r*Xu),Gs.rotateZ(c,c,n*Xu);let l=o/t;return Gs.scale(c,c,[l,l,l]),s&&Gs.translate(c,c,Fc.negate([],s)),c}function K4(e){let{width:t,height:r,altitude:n,pitch:i=0,offset:o,center:s,scale:c,nearZMultiplier:l=1,farZMultiplier:h=1}=e,{fovy:p=Wp(dW)}=e;n!==void 0&&(p=Wp(n));let x=p*Xu,w=i*Xu,E=qp(p),P=E;s&&(P+=s[2]*c/Math.cos(w)/r);let B=x*(.5+(o?o[1]:0)/r),D=Math.sin(B)*P/Math.sin(a2(Math.PI/2-w-B,.01,Math.PI-.01)),W=Math.sin(w)*D+P,X=P*10,q=Math.min(W*h,X);return{fov:x,aspect:t/r,focalDistance:E,near:l,far:q}}function Wp(e){return 2*Math.atan(.5/e)*Y4}function qp(e){return .5/Math.tan(.5*e*Xu)}function $_(e,t){let[r,n,i=0]=e;return Rh(Number.isFinite(r)&&Number.isFinite(n)&&Number.isFinite(i)),mm(t,[r,n,i,1])}function Ku(e,t,r=0){let[n,i,o]=e;if(Rh(Number.isFinite(n)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(o))return mm(t,[n,i,o,1]);let s=mm(t,[n,i,0,1]),c=mm(t,[n,i,1,1]),l=s[2],h=c[2],p=l===h?0:((r||0)-l)/(h-l);return ba.lerp([],s,c,p)}function _S(e){let{width:t,height:r,bounds:n,minExtent:i=0,maxZoom:o=24,offset:s=[0,0]}=e,[[c,l],[h,p]]=n,x=Myt(e.padding),w=za([c,a2(p,-Yu,Yu)]),E=za([h,a2(l,-Yu,Yu)]),P=[Math.max(Math.abs(E[0]-w[0]),i),Math.max(Math.abs(E[1]-w[1]),i)],B=[t-x.left-x.right-Math.abs(s[0])*2,r-x.top-x.bottom-Math.abs(s[1])*2];Rh(B[0]>0&&B[1]>0);let D=B[0]/P[0],W=B[1]/P[1],X=(x.right-x.left)/2/D,q=(x.top-x.bottom)/2/W,$=[(E[0]+w[0])/2+X,(E[1]+w[1])/2+q],et=Tc($),F=Math.min(o,Y_(Math.abs(Math.min(D,W))));return Rh(Number.isFinite(F)),{longitude:et[0],latitude:et[1],zoom:F}}function Myt(e=0){return typeof e=="number"?{top:e,bottom:e,left:e,right:e}:(Rh(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e)}var mW=Math.PI/180;function yS(e,t=0){let{width:r,height:n,unproject:i}=e,o={targetZ:t},s=i([0,n],o),c=i([r,n],o),l,h,p=e.fovy?.5*e.fovy*mW:Math.atan(.5/e.altitude),x=(90-e.pitch)*mW;return p>x-.01?(l=AW(e,0,t),h=AW(e,r,t)):(l=i([0,0],o),h=i([r,0],o)),[s,c,h,l]}function AW(e,t,r){let{pixelUnprojectionMatrix:n}=e,i=mm(n,[t,0,1,1]),o=mm(n,[t,e.height,1,1]),c=(r*e.distanceScales.unitsPerMeter[2]-i[2])/(o[2]-i[2]),l=ba.lerp([],i,o,c),h=Tc(l);return h.push(r),h}var gW=512;function Z4(e){let{width:t,height:r,pitch:n=0}=e,{longitude:i,latitude:o,zoom:s,bearing:c=0}=e;(i<-180||i>180)&&(i=X4(i+180,360)-180),(c<-180||c>180)&&(c=X4(c+180,360)-180);let l=Y_(r/gW);if(s<=l)s=l,o=0;else{let h=r/2/Math.pow(2,s),p=Tc([0,h])[1];if(o<p)o=p;else{let x=Tc([0,gW-h])[1];o>x&&(o=x)}}return{width:t,height:r,longitude:i,latitude:o,zoom:s,pitch:n,bearing:c}}var _W=.01,Cyt=["longitude","latitude","zoom"],yW={curve:1.414,speed:1.2};function $4(e,t,r,n){let{startZoom:i,startCenterXY:o,uDelta:s,w0:c,u1:l,S:h,rho:p,rho2:x,r0:w}=xW(e,t,n);if(l<_W){let $={};for(let et of Cyt){let F=e[et],ut=t[et];$[et]=fW(F,ut,r)}return $}let E=r*h,P=Math.cosh(w)/Math.cosh(w+p*E),B=c*((Math.cosh(w)*Math.tanh(w+p*E)-Math.sinh(w))/x)/l,D=1/P,W=i+AS(D),X=ba.scale([],s,B);ba.add(X,X,o);let q=Tc(X);return{longitude:q[0],latitude:q[1],zoom:W}}function Q4(e,t,r){let n={...yW,...r},{screenSpeed:i,speed:o,maxDuration:s}=n,{S:c,rho:l}=xW(e,t,n),h=1e3*c,p;return Number.isFinite(i)?p=h/(i/l):p=h/o,Number.isFinite(s)&&p>s?0:p}function xW(e,t,r){r=Object.assign({},yW,r);let n=r.curve,i=e.zoom,o=[e.longitude,e.latitude],s=c2(i),c=t.zoom,l=[t.longitude,t.latitude],h=c2(c-i),p=za(o),x=za(l),w=ba.sub([],x,p),E=Math.max(e.width,e.height),P=E/h,B=ba.length(w)*s,D=Math.max(B,_W),W=n*n,X=(P*P-E*E+W*W*D*D)/(2*E*W*D),q=(P*P-E*E-W*W*D*D)/(2*P*W*D),$=Math.log(Math.sqrt(X*X+1)-X),et=Math.log(Math.sqrt(q*q+1)-q),F=(et-$)/n;return{startZoom:i,startCenterXY:p,uDelta:w,w0:E,u1:B,S:F,rho:n,rho2:W,r0:$,r1:et}}var vW=`
uniform shadowUniforms {
  bool drawShadowMap;
  bool useShadowMap;
  vec4 color;
  highp int lightId;
  float lightCount;
  mat4 viewProjectionMatrix0;
  mat4 viewProjectionMatrix1;
  vec4 projectCenter0;
  vec4 projectCenter1;
} shadow;
`,Iyt=`
const int max_lights = 2;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  mat4 viewProjectionMatrices[max_lights];
  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;
  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;
  vec4 projectCenters[max_lights];
  projectCenters[0] = shadow.projectCenter0;
  projectCenters[1] = shadow.projectCenter1;

  if (shadow.drawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);
  }
  if (shadow.useShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow.lightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,Ryt=`
${vW}
${Iyt}
`,Lyt=`
const int max_lights = 2;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow.drawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow.useShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow.lightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow.color.a / shadow.lightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,Oyt=`
${vW}
${Lyt}
`,Byt=Gu(zyt),Dyt=Gu(Uyt),Nyt=[0,0,0,1],kyt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function Fyt(e,t){let[r,n,i]=e,o=Ku([r,n,i],t);return Number.isFinite(i)?o:[o[0],o[1],0]}function zyt({viewport:e,center:t}){return new Fn(e.viewProjectionMatrix).invert().transform(t)}function Uyt({viewport:e,shadowMatrices:t}){let r=[],n=e.pixelUnprojectionMatrix,i=e.isGeospatial?void 0:1,o=[[0,0,i],[e.width,0,i],[0,e.height,i],[e.width,e.height,i],[0,0,-1],[e.width,0,-1],[0,e.height,-1],[e.width,e.height,-1]].map(s=>Fyt(s,n));for(let s of t){let c=s.clone().translate(new ur(e.center).negate()),l=o.map(p=>c.transform(p)),h=new Fn().ortho({left:Math.min(...l.map(p=>p[0])),right:Math.max(...l.map(p=>p[0])),bottom:Math.min(...l.map(p=>p[1])),top:Math.max(...l.map(p=>p[1])),near:Math.min(...l.map(p=>-p[2])),far:Math.max(...l.map(p=>-p[2]))});r.push(h.multiplyRight(s))}return r}function Vyt(e){let{shadowEnabled:t=!0,project:r}=e;if(!t||!r||!e.shadowMatrices||!e.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:e.dummyShadowMap,shadow_uShadowMap1:e.dummyShadowMap};let n=dm.getUniforms(r),i=Byt({viewport:r.viewport,center:n.center}),o=[],s=Dyt({shadowMatrices:e.shadowMatrices,viewport:r.viewport}).slice();for(let l=0;l<e.shadowMatrices.length;l++){let h=s[l],p=h.clone().translate(new ur(r.viewport.center).negate());n.coordinateSystem===Yr.LNGLAT&&n.projectionMode===zc.WEB_MERCATOR?(s[l]=p,o[l]=i):(s[l]=h.clone().multiplyRight(kyt),o[l]=p.transform(i))}let c={drawShadowMap:Boolean(e.drawToShadowMap),useShadowMap:e.shadowMaps?e.shadowMaps.length>0:!1,color:e.shadowColor||Nyt,lightId:e.shadowLightId||0,lightCount:e.shadowMatrices.length,shadow_uShadowMap0:e.dummyShadowMap,shadow_uShadowMap1:e.dummyShadowMap};for(let l=0;l<s.length;l++)c[`viewProjectionMatrix${l}`]=s[l],c[`projectCenter${l}`]=o[l];for(let l=0;l<2;l++)c[`shadow_uShadowMap${l}`]=e.shadowMaps&&e.shadowMaps[l]||e.dummyShadowMap;return c}var Q_={name:"shadow",dependencies:[dm],vs:Ryt,fs:Oyt,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:Vyt,uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}};var Mo={...$M,defaultUniforms:{...$M.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}};var jyt=[rS],Hyt=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function xS(){let e=nm.getDefaultShaderAssembler();for(let t of jyt)e.addDefaultModule(t);for(let t of Hyt)e.addShaderHook(t);return e}var Wyt=[255,255,255],qyt=1,Gyt=0,J_=class{constructor(t={}){this.type="ambient";let{color:r=Wyt}=t,{intensity:n=qyt}=t;this.id=t.id||`ambient-${Gyt++}`,this.color=r,this.intensity=n}};var Xyt=[255,255,255],Yyt=1,Kyt=[0,0,-1],Zyt=0,Gp=class{constructor(t={}){this.type="directional";let{color:r=Xyt}=t,{intensity:n=Yyt}=t,{direction:i=Kyt}=t,{_shadow:o=!1}=t;this.id=t.id||`directional-${Zyt++}`,this.color=r,this.intensity=n,this.type="directional",this.direction=new ur(i).normalize().toArray(),this.shadow=o}getProjectedLight(t){return this}};var o0=class{constructor(t,r={id:"pass"}){let{id:n}=r;this.id=n,this.device=t,this.props={...r}}setProps(t){Object.assign(this.props,t)}render(t){}cleanup(){}};var Oh=class extends o0{constructor(){super(...arguments),this._lastRenderIndex=-1}render(t){let[r,n]=this.device.canvasContext.getDrawingBufferSize(),i=t.clearCanvas??!0,o=t.clearColor??(i?[0,0,0,0]:!1),s=i?1:!1,c=i?0:!1,l=t.colorMask??15,h={viewport:[0,0,r,n]};t.colorMask&&(h.colorMask=l),t.scissorRect&&(h.scissorRect=t.scissorRect);let p=this.device.beginRenderPass({framebuffer:t.target,parameters:h,clearColor:o,clearDepth:s,clearStencil:c});try{return this._drawLayers(p,t)}finally{p.end()}}_drawLayers(t,r){let{target:n,shaderModuleProps:i,viewports:o,views:s,onViewportActive:c,clearStack:l=!0}=r;r.pass=r.pass||"unknown",l&&(this._lastRenderIndex=-1);let h=[];for(let p of o){let x=s&&s[p.id];c?.(p);let w=this._getDrawLayerParams(p,r),E=p.subViewports||[p];for(let P of E){let B=this._drawLayersInViewport(t,{target:n,shaderModuleProps:i,viewport:P,view:x,pass:r.pass,layers:r.layers},w);h.push(B)}}return h}_getDrawLayerParams(t,{layers:r,pass:n,isPicking:i=!1,layerFilter:o,cullRect:s,effects:c,shaderModuleProps:l},h=!1){let p=[],x=wW(this._lastRenderIndex+1),w={layer:r[0],viewport:t,isPicking:i,renderPass:n,cullRect:s},E={};for(let P=0;P<r.length;P++){let B=r[P],D=this._shouldDrawLayer(B,w,o,E),W={shouldDrawLayer:D};D&&!h&&(W.shouldDrawLayer=!0,W.layerRenderIndex=x(B,D),W.shaderModuleProps=this._getShaderModuleProps(B,c,n,l),W.layerParameters={...B.context.deck?.props.parameters,...this.getLayerParameters(B,P,t)}),p[P]=W}return p}_drawLayersInViewport(t,{layers:r,shaderModuleProps:n,pass:i,target:o,viewport:s,view:c},l){let h=$yt(this.device,{shaderModuleProps:n,target:o,viewport:s});if(c&&c.props.clear){let x=c.props.clear===!0?{color:!0,depth:!0}:c.props.clear;this.device.beginRenderPass({framebuffer:o,parameters:{viewport:h,scissorRect:h},clearColor:x.color?[0,0,0,0]:!1,clearDepth:x.depth?1:!1}).end()}let p={totalCount:r.length,visibleCount:0,compositeCount:0,pickableCount:0};t.setParameters({viewport:h});for(let x=0;x<r.length;x++){let w=r[x],E=l[x],{shouldDrawLayer:P}=E;if(P&&w.props.pickable&&p.pickableCount++,w.isComposite&&p.compositeCount++,w.isDrawable&&E.shouldDrawLayer){let{layerRenderIndex:B,shaderModuleProps:D,layerParameters:W}=E;p.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,B),D.project&&(D.project.viewport=s),w.context.renderPass=t;try{w._drawLayer({renderPass:t,shaderModuleProps:D,uniforms:{layerIndex:B},parameters:W})}catch(X){w.raiseError(X,`drawing ${w} to ${i}`)}}}return p}shouldDrawLayer(t){return!0}getShaderModuleProps(t,r,n){return null}getLayerParameters(t,r,n){return t.props.parameters}_shouldDrawLayer(t,r,n,i){if(!(t.props.visible&&this.shouldDrawLayer(t)))return!1;r.layer=t;let s=t.parent;for(;s;){if(!s.props.visible||!s.filterSubLayer(r))return!1;r.layer=s,s=s.parent}if(n){let c=r.layer.id;if(c in i||(i[c]=n(r)),!i[c])return!1}return t.activateViewport(r.viewport),!0}_getShaderModuleProps(t,r,n,i){let o=this.device.canvasContext.cssToDeviceRatio(),s=t.internalState?.propsInTransition||t.props,c={layer:s,picking:{isActive:!1},project:{viewport:t.context.viewport,devicePixelRatio:o,modelMatrix:s.modelMatrix,coordinateSystem:s.coordinateSystem,coordinateOrigin:s.coordinateOrigin,autoWrapLongitude:t.wrapLongitude}};if(r)for(let l of r)bW(c,l.getShaderModuleProps?.(t,c));return bW(c,this.getShaderModuleProps(t,r,c),i)}};function wW(e=0,t={}){let r={},n=(i,o)=>{let s=i.props._offset,c=i.id,l=i.parent&&i.parent.id,h;if(l&&!(l in t)&&n(i.parent,!1),l in r){let p=r[l]=r[l]||wW(t[l],t);h=p(i,o),r[c]=p}else Number.isFinite(s)?(h=s+(t[l]||0),r[c]=null):h=e;return o&&h>=e&&(e=h+1),t[c]=h,h};return n}function $yt(e,{shaderModuleProps:t,target:r,viewport:n}){let i=t?.project?.devicePixelRatio??e.canvasContext.cssToDeviceRatio(),[,o]=e.canvasContext.getDrawingBufferSize(),s=r?r.height:o,c=n;return[c.x*i,s-(c.y+c.height)*i,c.width*i,c.height*i]}function bW(e,...t){for(let r of t)if(r)for(let n in r)e[n]?Object.assign(e[n],r[n]):e[n]=r[n];return e}var f2=class extends Oh{constructor(t,r){super(t,r);let n=t.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},mipmaps:!0}),i=t.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1});this.fbo=t.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[n],depthStencilAttachment:i})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(t){let r=this.fbo,n=this.device.canvasContext.cssToDeviceRatio(),i=t.viewports[0],o=i.width*n,s=i.height*n,c=[1,1,1,1];(o!==r.width||s!==r.height)&&r.resize({width:o,height:s}),super.render({...t,clearColor:c,target:r,pass:"shadow"})}getLayerParameters(t,r,n){return{...t.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}shouldDrawLayer(t){return t.props.shadowEnabled!==!1}getShaderModuleProps(t,r,n){return{shadow:{project:n.project,drawToShadowMap:!0}}}};var Qyt={color:[255,255,255],intensity:1},TW=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Jyt=[0,0,0,200/255],Am=class{constructor(t={}){this.id="lighting-effect",this.shadowColor=Jyt,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(t)}setup(t){this.context=t;let{device:r,deck:n}=t;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(r),n._addDefaultShaderModule(Q_),this.dummyShadowMap=r.createTexture({width:1,height:1}))}setProps(t){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(let r in t){let n=t[r];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n);break;default:}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(r=>r.shadow),this.context&&this.setup(this.context),this.props=t}preRender({layers:t,layerFilter:r,viewports:n,onViewportActive:i,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let s=0;s<this.shadowPasses.length;s++)this.shadowPasses[s].render({layers:t,layerFilter:r,viewports:n,onViewportActive:i,views:o,shaderModuleProps:{shadow:{shadowLightId:s,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}getShaderModuleProps(t,r){let n=this.shadow?{project:r.project,shadowMaps:this.shadowPasses.map(s=>s.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},i={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(s=>s.getProjectedLight({layer:t})),pointLights:this.pointLights.map(s=>s.getProjectedLight({layer:t}))},o=t.props.material;return{shadow:n,lighting:i,phongMaterial:o,gouraudMaterial:o}}cleanup(t){for(let r of this.shadowPasses)r.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,t.deck._removeDefaultShaderModule(Q_))}_calculateMatrices(){let t=[];for(let r of this.directionalLights){let n=new Fn().lookAt({eye:new ur(r.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let r=0;r<this.directionalLights.length;r++){let n=new f2(t);this.shadowPasses[r]=n}}_applyDefaultLights(){let{ambientLight:t,pointLights:r,directionalLights:n}=this;!t&&r.length===0&&n.length===0&&(this.ambientLight=new J_(Qyt),this.directionalLights.push(new Gp(TW[0]),new Gp(TW[1])))}};var J4=class{constructor(t={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(t)}setOptions(t){Object.assign(this.opts,t)}allocate(t,r,{size:n=1,type:i,padding:o=0,copy:s=!1,initialize:c=!1,maxCount:l}){let h=i||t&&t.constructor||Float32Array,p=r*n+o;if(ArrayBuffer.isView(t)){if(p<=t.length)return t;if(p*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new h(t.buffer,0,p)}let x=1/0;l&&(x=l*n+o);let w=this._allocate(h,p,c,x);return t&&s?w.set(t):c||w.fill(0,0,4),this._release(t),w}release(t){this._release(t)}_allocate(t,r,n,i){let o=Math.max(Math.ceil(r*this.opts.overAlloc),1);o>i&&(o=i);let s=this._pool,c=t.BYTES_PER_ELEMENT*o,l=s.findIndex(h=>h.byteLength>=c);if(l>=0){let h=new t(s.splice(l,1)[0],0,o);return n&&h.fill(0),h}return new t(o)}_release(t){if(!ArrayBuffer.isView(t))return;let r=this._pool,{buffer:n}=t,{byteLength:i}=n,o=r.findIndex(s=>s.byteLength>=i);o<0?r.push(n):(o>0||r.length<this.opts.poolSize)&&r.splice(o,0,n),r.length>this.opts.poolSize&&r.shift()}},Bh=new J4;function ey(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function s0(e,t){let r=e%t;return r<0?t+r:r}function MW(e){return[e[12],e[13],e[14]]}function SW(e){return{left:ty(e[3]+e[0],e[7]+e[4],e[11]+e[8],e[15]+e[12]),right:ty(e[3]-e[0],e[7]-e[4],e[11]-e[8],e[15]-e[12]),bottom:ty(e[3]+e[1],e[7]+e[5],e[11]+e[9],e[15]+e[13]),top:ty(e[3]-e[1],e[7]-e[5],e[11]-e[9],e[15]-e[13]),near:ty(e[3]+e[2],e[7]+e[6],e[11]+e[10],e[15]+e[14]),far:ty(e[3]-e[2],e[7]-e[6],e[11]-e[10],e[15]-e[14])}}var EW=new ur;function ty(e,t,r,n){EW.set(e,t,r);let i=EW.len();return{distance:n/i,normal:new ur(-e/i,-t/i,-r/i)}}function tD(e){return e-Math.fround(e)}var p2;function vS(e,t){let{size:r=1,startIndex:n=0}=t,i=t.endIndex!==void 0?t.endIndex:e.length,o=(i-n)/r;p2=Bh.allocate(p2,o,{type:Float32Array,size:r*2});let s=n,c=0;for(;s<i;){for(let l=0;l<r;l++){let h=e[s++];p2[c+l]=h,p2[c+l+r]=tD(h)}c+=r*2}return p2.subarray(0,o*r*2)}function CW(e){let t=null,r=!1;for(let n of e)n&&(t?(r||(t=[[t[0][0],t[0][1]],[t[1][0],t[1][1]]],r=!0),t[0][0]=Math.min(t[0][0],n[0][0]),t[0][1]=Math.min(t[0][1],n[0][1]),t[1][0]=Math.max(t[1][0],n[1][0]),t[1][1]=Math.max(t[1][1],n[1][1])):t=n);return t}var t1t=Math.PI/180,e1t=ey(),PW=[0,0,0],r1t={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function n1t({width:e,height:t,orthographic:r,fovyRadians:n,focalDistance:i,padding:o,near:s,far:c}){let l=e/t,h=r?new Fn().orthographic({fovy:n,aspect:l,focalDistance:i,near:s,far:c}):new Fn().perspective({fovy:n,aspect:l,near:s,far:c});if(o){let{left:p=0,right:x=0,top:w=0,bottom:E=0}=o,P=ro((p+e-x)/2,0,e)-e/2,B=ro((w+t-E)/2,0,t)-t/2;h[8]-=P*2/e,h[9]+=B*2/t}return h}var ry=class{constructor(t={}){this._frustumPlanes={},this.id=t.id||this.constructor.displayName||"viewport",this.x=t.x||0,this.y=t.y||0,this.width=t.width||1,this.height=t.height||1,this.zoom=t.zoom||0,this.padding=t.padding,this.distanceScales=t.distanceScales||r1t,this.focalDistance=t.focalDistance||1,this.position=t.position||PW,this.modelMatrix=t.modelMatrix||null;let{longitude:r,latitude:n}=t;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(r),this._initProps(t),this._initMatrices(t),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?zc.WEB_MERCATOR:zc.WEB_MERCATOR_AUTO_OFFSET:zc.IDENTITY}equals(t){return t instanceof ry?this===t?!0:t.width===this.width&&t.height===this.height&&t.scale===this.scale&&Fa(t.projectionMatrix,this.projectionMatrix)&&Fa(t.viewMatrix,this.viewMatrix):!1}project(t,{topLeft:r=!0}={}){let n=this.projectPosition(t),i=$_(n,this.pixelProjectionMatrix),[o,s]=i,c=r?s:this.height-s;return t.length===2?[o,c]:[o,c,i[2]]}unproject(t,{topLeft:r=!0,targetZ:n}={}){let[i,o,s]=t,c=r?o:this.height-o,l=n&&n*this.distanceScales.unitsPerMeter[2],h=Ku([i,c,s],this.pixelUnprojectionMatrix,l),[p,x,w]=this.unprojectPosition(h);return Number.isFinite(s)?[p,x,w]:Number.isFinite(n)?[p,x,n]:[p,x]}projectPosition(t){let[r,n]=this.projectFlat(t),i=(t[2]||0)*this.distanceScales.unitsPerMeter[2];return[r,n,i]}unprojectPosition(t){let[r,n]=this.unprojectFlat(t),i=(t[2]||0)*this.distanceScales.metersPerUnit[2];return[r,n,i]}projectFlat(t){if(this.isGeospatial){let r=za(t);return r[1]=ro(r[1],-318,830),r}return t}unprojectFlat(t){return this.isGeospatial?Tc(t):t}getBounds(t={}){let r={targetZ:t.z||0},n=this.unproject([0,0],r),i=this.unproject([this.width,0],r),o=this.unproject([0,this.height],r),s=this.unproject([this.width,this.height],r);return[Math.min(n[0],i[0],o[0],s[0]),Math.min(n[1],i[1],o[1],s[1]),Math.max(n[0],i[0],o[0],s[0]),Math.max(n[1],i[1],o[1],s[1])]}getDistanceScales(t){return t&&this.isGeospatial?Z_({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:r,width:n=1,height:i=1}){return t<this.x+this.width&&this.x<t+n&&r<this.y+this.height&&this.y<r+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,SW(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(t,r){return null}_initProps(t){let r=t.longitude,n=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=l2({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||Z_({latitude:n,longitude:r}));let i=Math.pow(2,this.zoom);this.scale=i;let{position:o,modelMatrix:s}=t,c=PW;if(o&&(c=s?new Fn(s).transformAsVector(o,[]):o),this.isGeospatial){let l=this.projectPosition([r,n,0]);this.center=new ur(c).scale(this.distanceScales.unitsPerMeter).add(l)}else this.center=this.projectPosition(c)}_initMatrices(t){let{viewMatrix:r=e1t,projectionMatrix:n=null,orthographic:i=!1,fovyRadians:o,fovy:s=75,near:c=.1,far:l=1e3,padding:h=null,focalDistance:p=1}=t;this.viewMatrixUncentered=r,this.viewMatrix=new Fn().multiplyRight(r).translate(new ur(this.center).negate()),this.projectionMatrix=n||n1t({width:this.width,height:this.height,orthographic:i,fovyRadians:o||s*t1t,focalDistance:p,padding:h,near:c,far:l});let x=ey();Gs.multiply(x,x,this.projectionMatrix),Gs.multiply(x,x,this.viewMatrix),this.viewProjectionMatrix=x,this.viewMatrixInverse=Gs.invert([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=MW(this.viewMatrixInverse);let w=ey(),E=ey();Gs.scale(w,w,[this.width/2,-this.height/2,1]),Gs.translate(w,w,[1,-1,0]),Gs.multiply(E,w,this.viewProjectionMatrix),this.pixelProjectionMatrix=E,this.pixelUnprojectionMatrix=Gs.invert(ey(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||br.warn("Pixel project matrix not invertible")()}};ry.displayName="Viewport";var wa=ry;var a0=class extends wa{constructor(t={}){let{latitude:r=0,longitude:n=0,zoom:i=0,pitch:o=0,bearing:s=0,nearZMultiplier:c=.1,farZMultiplier:l=1.01,nearZ:h,farZ:p,orthographic:x=!1,projectionMatrix:w,repeat:E=!1,worldOffset:P=0,position:B,padding:D,legacyMeterSizes:W=!1}=t,{width:X,height:q,altitude:$=1.5}=t,et=Math.pow(2,i);X=X||1,q=q||1;let F,ut=null;if(w)$=w[5]/2,F=Wp($);else{t.fovy?(F=t.fovy,$=qp(F)):F=Wp($);let J;if(D){let{top:G=0,bottom:mt=0}=D;J=[0,ro((G+q-mt)/2,0,q)-q/2]}ut=K4({width:X,height:q,scale:et,center:B&&[0,0,B[2]*u2(r)],offset:J,pitch:o,fovy:F,nearZMultiplier:c,farZMultiplier:l}),Number.isFinite(h)&&(ut.near=h),Number.isFinite(p)&&(ut.far=p)}let ot=gS({height:q,pitch:o,bearing:s,scale:et,altitude:$});P&&(ot=new Fn().translate([512*P,0,0]).multiplyLeft(ot)),super({...t,width:X,height:q,viewMatrix:ot,longitude:n,latitude:r,zoom:i,...ut,fovy:F,focalDistance:$}),this.latitude=r,this.longitude=n,this.zoom=i,this.pitch=o,this.bearing=s,this.altitude=$,this.fovy=F,this.orthographic=x,this._subViewports=E?[]:null,this._pseudoMeters=W,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){let t=this.getBounds(),r=Math.floor((t[0]+180)/360),n=Math.ceil((t[2]-180)/360);for(let i=r;i<=n;i++){let o=i?new a0({...this,worldOffset:i}):this;this._subViewports.push(o)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);let[r,n]=this.projectFlat(t),i=(t[2]||0)*u2(t[1]);return[r,n,i]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);let[r,n]=this.unprojectFlat(t),i=(t[2]||0)/u2(n);return[r,n,i]}addMetersToLngLat(t,r){return h2(t,r)}panByPosition(t,r){let n=Ku(r,this.pixelUnprojectionMatrix),i=this.projectFlat(t),o=ba.add([],i,ba.negate([],n)),s=ba.add([],this.center,o),[c,l]=this.unprojectFlat(s);return{longitude:c,latitude:l}}getBounds(t={}){let r=yS(this,t.z||0);return[Math.min(r[0][0],r[1][0],r[2][0],r[3][0]),Math.min(r[0][1],r[1][1],r[2][1],r[3][1]),Math.max(r[0][0],r[1][0],r[2][0],r[3][0]),Math.max(r[0][1],r[1][1],r[2][1],r[3][1])]}fitBounds(t,r={}){let{width:n,height:i}=this,{longitude:o,latitude:s,zoom:c}=_S({width:n,height:i,bounds:t,...r});return new a0({width:n,height:i,longitude:o,latitude:s,zoom:c})}};a0.displayName="WebMercatorViewport";var Uc=a0;var IW=[0,0,0];function eD(e,t,r=!1){let n=t.projectPosition(e);if(r&&t instanceof Uc){let[i,o,s=0]=e,c=t.getDistanceScales([i,o]);n[2]=s*c.unitsPerMeter[2]}return n}function i1t(e){let{viewport:t,modelMatrix:r,coordinateOrigin:n}=e,{coordinateSystem:i,fromCoordinateSystem:o,fromCoordinateOrigin:s}=e;return i===Yr.DEFAULT&&(i=t.isGeospatial?Yr.LNGLAT:Yr.CARTESIAN),o===void 0&&(o=i),s===void 0&&(s=n),{viewport:t,coordinateSystem:i,coordinateOrigin:n,modelMatrix:r,fromCoordinateSystem:o,fromCoordinateOrigin:s}}function rD(e,{viewport:t,modelMatrix:r,coordinateSystem:n,coordinateOrigin:i,offsetMode:o}){let[s,c,l=0]=e;switch(r&&([s,c,l]=hl.transformMat4([],[s,c,l,1],r)),n){case Yr.LNGLAT:return eD([s,c,l],t,o);case Yr.LNGLAT_OFFSETS:return eD([s+i[0],c+i[1],l+(i[2]||0)],t,o);case Yr.METER_OFFSETS:return eD(h2(i,[s,c,l]),t,o);case Yr.CARTESIAN:default:return t.isGeospatial?[s+i[0],c+i[1],l+i[2]]:t.projectPosition([s,c,l])}}function bS(e,t){let{viewport:r,coordinateSystem:n,coordinateOrigin:i,modelMatrix:o,fromCoordinateSystem:s,fromCoordinateOrigin:c}=i1t(t),{autoOffset:l=!0}=t,{geospatialOrigin:h=IW,shaderCoordinateOrigin:p=IW,offsetMode:x=!1}=l?q4(r,n,i):{},w=rD(e,{viewport:r,modelMatrix:o,coordinateSystem:s,coordinateOrigin:c,offsetMode:x});if(x){let E=r.projectPosition(h||p);Fc.sub(w,w,E)}return w}var o1t=[255,255,255],s1t=1,a1t=[1,0,0],c1t=[0,0,1],l1t=0,ny=class{constructor(t={}){this.type="point";let{color:r=o1t}=t,{intensity:n=s1t}=t,{position:i=c1t}=t;this.id=t.id||`point-${l1t++}`,this.color=r,this.intensity=n,this.type="point",this.position=i,this.attenuation=u1t(t),this.projectedLight={...this}}getProjectedLight({layer:t}){let{projectedLight:r}=this,n=t.context.viewport,{coordinateSystem:i,coordinateOrigin:o}=t.props,s=bS(this.position,{viewport:n,coordinateSystem:i,coordinateOrigin:o,fromCoordinateSystem:n.isGeospatial?Yr.LNGLAT:Yr.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return r.color=this.color,r.intensity=this.intensity,r.position=s,r}};function u1t(e){return e.attenuation?e.attenuation:a1t}var d2=class extends ny{getProjectedLight({layer:t}){let{projectedLight:r}=this,n=t.context.viewport,{coordinateSystem:i,coordinateOrigin:o,modelMatrix:s}=t.props,{cameraPosition:c}=dS({viewport:n,modelMatrix:s,coordinateSystem:i,coordinateOrigin:o});return r.color=this.color,r.intensity=this.intensity,r.position=c,r}};var c0=Math.PI/180,h1t=1e3*60*60*24,f1t=2440588,p1t=2451545,wS=c0*23.4397,d1t=357.5291,m1t=.98560028,A1t=280.147,g1t=360.9856235;function RW(e,t,r){let n=c0*-r,i=c0*t,o=y1t(e),s=S1t(o),c=T1t(o,n)-s.rightAscension;return{azimuth:b1t(c,i,s.declination),altitude:w1t(c,i,s.declination)}}function TS(e,t,r){let{azimuth:n,altitude:i}=RW(e,t,r);return[Math.sin(n)*Math.cos(i),Math.cos(n)*Math.cos(i),-Math.sin(i)]}function _1t(e){return(typeof e=="number"?e:e.getTime())/h1t-.5+f1t}function y1t(e){return _1t(e)-p1t}function x1t(e,t){let r=e;return Math.atan2(Math.sin(r)*Math.cos(wS)-Math.tan(t)*Math.sin(wS),Math.cos(r))}function v1t(e,t){let r=e;return Math.asin(Math.sin(t)*Math.cos(wS)+Math.cos(t)*Math.sin(wS)*Math.sin(r))}function b1t(e,t,r){let n=e,i=t,o=r;return Math.atan2(Math.sin(n),Math.cos(n)*Math.sin(i)-Math.tan(o)*Math.cos(i))}function w1t(e,t,r){let n=e,i=t,o=r;return Math.asin(Math.sin(i)*Math.sin(o)+Math.cos(i)*Math.cos(o)*Math.cos(n))}function T1t(e,t){return c0*(A1t+g1t*e)-t}function E1t(e){return c0*(d1t+m1t*e)}function M1t(e){let t=e,r=c0*(1.9148*Math.sin(t)+.02*Math.sin(2*t)+3e-4*Math.sin(3*t)),n=c0*102.9372;return t+r+n+Math.PI}function S1t(e){let t=E1t(e),r=M1t(t);return{declination:v1t(r,0),rightAscension:x1t(r,0)}}var m2=class extends Gp{constructor(t){super(t),this.timestamp=t.timestamp}getProjectedLight({layer:t}){let{viewport:r}=t.context;if(r.resolution&&r.resolution>0){let[i,o,s]=TS(this.timestamp,0,0);this.direction=[i,-s,o]}else{let{latitude:i,longitude:o}=r;this.direction=TS(this.timestamp,i,o)}return this}};var C1t=1,P1t=1,l0=class{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel(t){let{delay:r=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:o=1}=t,s=C1t++,c={time:0,delay:r,duration:n,rate:i,repeat:o};return this._setChannelTime(c,this.time),this.channels.set(s,c),s}removeChannel(t){this.channels.delete(t);for(let[r,n]of this.animations)n.channel===t&&this.detachAnimation(r)}isFinished(t){let r=this.channels.get(t);return r===void 0?!1:this.time>=r.delay+r.duration*r.repeat}getTime(t){if(t===void 0)return this.time;let r=this.channels.get(t);return r===void 0?-1:r.time}setTime(t){this.time=Math.max(0,t);let r=this.channels.values();for(let i of r)this._setChannelTime(i,this.time);let n=this.animations.values();for(let i of n){let{animation:o,channel:s}=i;o.setTime(this.getTime(s))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,r){let n=P1t++;return this.animations.set(n,{animation:t,channel:r}),t.setTime(this.getTime(r)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,r){let n=r-t.delay,i=t.duration*t.repeat;n>=i?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}};function LW(e){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60)}function OW(e){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e)}var I1t=0,R1t={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:Rf.stats.get(`animation-loop-${I1t++}`),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1},A2=class{device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;_error=null;constructor(t){if(this.props={...R1t,...t},t=this.props,!t.device)throw new Error("No device provided");let{useDevicePixels:r=!0}=this.props;this.stats=t.stats||new Nc({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:t.autoResizeViewport,autoResizeDrawingBuffer:t.autoResizeDrawingBuffer,useDevicePixels:r}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setError(t){if(this.props.onError(t),this._error=Error(),this.device?.canvasContext?.canvas instanceof HTMLCanvasElement){let n=document.createElement("h1");n.innerHTML=t.message,n.style.position="absolute",n.style.top="20%",n.style.left="10px",n.style.color="black",n.style.backgroundColor="red",document.body.appendChild(n)}}setNeedsRedraw(t){return this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.props.autoResizeViewport=t.autoResizeViewport||!1),"autoResizeDrawingBuffer"in t&&(this.props.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer||!1),"useDevicePixels"in t&&(this.props.useDevicePixels=t.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let t;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(t!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(t){let r=t instanceof Error?t:new Error("Unknown error");throw this.props.onError(r),r}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||this._error?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(t=>{this._resolveNextFrame=t})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(t){this.display&&(this.display.destroy(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_requestAnimationFrame(){this._running&&(this._animationFrameId=LW(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(OW(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(t){if(this.display){this.display._renderFrame(t);return}this.props.onRender(this._getAnimationProps()),this.device?.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){let t=this.device?.canvasContext?.canvas;if(!this.device||!t)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:t,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;let{width:t,height:r,aspect:n}=this._getSizeAndAspect();(t!==this.animationProps.width||r!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=r,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.canvasContext?.canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){let t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";let r=document.createElement("div");r.style.position="absolute",r.style.left="10px",r.style.bottom="10px",r.style.width="300px",r.style.background="white",this.canvas instanceof HTMLCanvasElement&&t.appendChild(this.canvas),t.appendChild(r);let n=this.props.onAddHTML(r);n&&(r.innerHTML=n)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};let[t,r]=this.device?.canvasContext?.getPixelSize()||[1,1],n=1,i=this.device?.canvasContext?.canvas;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:t>0&&r>0&&(n=t/r),{width:t,height:r,aspect:n}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.props.autoResizeDrawingBuffer&&this.device?.canvasContext?.resize({useDevicePixels:this.props.useDevicePixels})}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(t){t instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[t.offsetX,t.offsetY])}_onMouseleave(t){this._getAnimationProps()._mousePosition=null}};var nD={};function Vc(e="id"){nD[e]=nD[e]||1;let t=nD[e]++;return`${e}-${t}`}var ES=class{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(t){if(this.id=t.id||Vc("geometry"),this.topology=t.topology,this.indices=t.indices||null,this.attributes=t.attributes,this.vertexCount=t.vertexCount,this.bufferLayout=t.bufferLayout||[],this.indices&&!(this.indices.usage&Vn.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){this.indices?.destroy();for(let t of Object.values(this.attributes))t.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(t){return t.byteLength/12}};function BW(e,t){if(t instanceof ES)return t;let r=L1t(e,t),{attributes:n,bufferLayout:i}=O1t(e,t);return new ES({topology:t.topology||"triangle-list",bufferLayout:i,vertexCount:t.vertexCount,indices:r,attributes:n})}function L1t(e,t){if(!t.indices)return;let r=t.indices.value;return e.createBuffer({usage:Vn.INDEX,data:r})}function O1t(e,t){let r=[],n={};for(let[o,s]of Object.entries(t.attributes)){let c=o;switch(o){case"POSITION":c="positions";break;case"NORMAL":c="normals";break;case"TEXCOORD_0":c="texCoords";break;case"COLOR_0":c="colors";break}if(s){n[c]=e.createBuffer({data:s.value,id:`${o}-buffer`});let{value:l,size:h,normalized:p}=s;r.push({name:c,format:EO(l,h,p)})}}let i=t._calculateVertexCount(t.attributes,t.indices);return{attributes:n,bufferLayout:r,vertexCount:i}}var iD=class{static getDefaultPipelineFactory(t){return t._lumaData.defaultPipelineFactory=t._lumaData.defaultPipelineFactory||new iD(t),t._lumaData.defaultPipelineFactory}device;destroyPolicy;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};constructor(t){this.device=t,this.destroyPolicy=t.props._factoryDestroyPolicy}createRenderPipeline(t){let r={...Eh.defaultProps,...t},n=this._hashRenderPipeline(r);if(!this._renderPipelineCache[n]){let i=this.device.createRenderPipeline({...r,id:r.id?`${r.id}-cached`:void 0});i.hash=n,this._renderPipelineCache[n]={pipeline:i,useCount:0}}return this._renderPipelineCache[n].useCount++,this._renderPipelineCache[n].pipeline}createComputePipeline(t){let r={...qA.defaultProps,...t},n=this._hashComputePipeline(r);if(!this._computePipelineCache[n]){let i=this.device.createComputePipeline({...r,id:r.id?`${r.id}-cached`:void 0});i.hash=n,this._computePipelineCache[n]={pipeline:i,useCount:0}}return this._computePipelineCache[n].useCount++,this._computePipelineCache[n].pipeline}release(t){let r=t.hash,n=t instanceof qA?this._computePipelineCache:this._renderPipelineCache;n[r].useCount--,n[r].useCount===0&&this.destroyPolicy==="unused"&&(n[r].pipeline.destroy(),delete n[r])}_hashComputePipeline(t){return`${this._getHash(t.shader.source)}`}_hashRenderPipeline(t){let r=t.vs?this._getHash(t.vs.source):0,n=t.fs?this._getHash(t.fs.source):0,i="-",o=this._getHash(JSON.stringify(t.bufferLayout));switch(this.device.type){case"webgl":return`${r}/${n}V${i}BL${o}`;default:let s=this._getHash(JSON.stringify(t.parameters));return`${r}/${n}V${i}T${t.topology}P${s}BL${o}`}}_getHash(t){return this._hashes[t]===void 0&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}},g2=iD;Vr(g2,"defaultProps",{...Eh.defaultProps});var oD=class{static getDefaultShaderFactory(t){return t._lumaData.defaultShaderFactory||=new oD(t),t._lumaData.defaultShaderFactory}device;destroyPolicy;_cache={};constructor(t){this.device=t,this.destroyPolicy=t.props._factoryDestroyPolicy}createShader(t){let r=this._hashShader(t),n=this._cache[r];if(!n){let i=this.device.createShader({...t,id:t.id?`${t.id}-cached`:void 0});this._cache[r]=n={shader:i,useCount:0}}return n.useCount++,n.shader}release(t){let r=this._hashShader(t),n=this._cache[r];n&&(n.useCount--,n.useCount===0&&this.destroyPolicy==="unused"&&(delete this._cache[r],n.shader.destroy()))}_hashShader(t){return`${t.stage}:${t.source}`}},_2=oD;Vr(_2,"defaultProps",{...em.defaultProps});function DW(e,t){let r={},n="Values";if(e.attributes.length===0&&!e.varyings?.length)return{"No attributes or varyings":{[n]:"N/A"}};for(let i of e.attributes)if(i){let o=`${i.location} ${i.name}: ${i.type}`;r[`in ${o}`]={[n]:i.stepMode||"vertex"}}for(let i of e.varyings||[]){let o=`${i.location} ${i.name}`;r[`out ${o}`]={[n]:JSON.stringify(i)}}return r}var rc=null,sD=null;function NW(e,{id:t,minimap:r,opaque:n,top:i="0",left:o="0",rgbaScale:s=1}){rc||(rc=document.createElement("canvas"),rc.id=t,rc.title=t,rc.style.zIndex="100",rc.style.position="absolute",rc.style.top=i,rc.style.left=o,rc.style.border="blue 5px solid",rc.style.transform="scaleY(-1)",document.body.appendChild(rc),sD=rc.getContext("2d")),(rc.width!==e.width||rc.height!==e.height)&&(rc.width=e.width/2,rc.height=e.height/2,rc.style.width="400px",rc.style.height="400px");let c=e.device.readPixelsToArrayWebGL(e),l=sD?.createImageData(e.width,e.height);if(l){for(let p=0;p<c.length;p+=4)l.data[0+p+0]=c[p+0]*s,l.data[0+p+1]=c[p+1]*s,l.data[0+p+2]=c[p+2]*s,l.data[0+p+3]=n?255:c[p+3]*s;sD?.putImageData(l,0,0)}}function MS(e,t,r){if(e===t)return!0;if(!r||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!MS(e[n],t[n],r-1))return!1;return!0}if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){let n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(let o of n)if(!t.hasOwnProperty(o)||!MS(e[o],t[o],r-1))return!1;return!0}return!1}function B1t(e){return Rv(e)||typeof e=="number"||typeof e=="boolean"}function SS(e){let t={bindings:{},uniforms:{}};return Object.keys(e).forEach(r=>{let n=e[r];B1t(n)?t.uniforms[r]=n:t.bindings[r]=n}),t}var CS=class{options={disableWarnings:!1};modules;moduleUniforms;moduleBindings;constructor(t,r){Object.assign(this.options,r);let n=L_(Object.values(t).filter(i=>i.dependencies));for(let i of n)t[i.name]=i;qe.log(1,"Creating ShaderInputs with modules",Object.keys(t))(),this.modules=t,this.moduleUniforms={},this.moduleBindings={};for(let[i,o]of Object.entries(t))this._addModule(o),o.name&&i!==o.name&&!this.options.disableWarnings&&qe.warn(`Module name: ${i} vs ${o.name}`)()}destroy(){}setProps(t){for(let r of Object.keys(t)){let n=r,i=t[n]||{},o=this.modules[n];if(!o){this.options.disableWarnings||qe.warn(`Module ${r} not found`)();continue}let s=this.moduleUniforms[n],c=this.moduleBindings[n],l=o.getUniforms?.(i,s)||i,{uniforms:h,bindings:p}=SS(l);this.moduleUniforms[n]={...s,...h},this.moduleBindings[n]={...c,...p}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){let t={};for(let r of Object.values(this.moduleBindings))Object.assign(t,r);return t}getDebugTable(){let t={};for(let[r,n]of Object.entries(this.moduleUniforms))for(let[i,o]of Object.entries(n))t[`${r}.${i}`]={type:this.modules[r].uniformTypes?.[i],value:String(o)};return t}_addModule(t){let r=t.name;this.moduleUniforms[r]=t.defaultUniforms||{},this.moduleBindings[r]={}}};var D1t="";async function kW(e,t){let r=new Image;return r.crossOrigin=t?.crossOrigin||"anonymous",r.src=e.startsWith("http")?e:D1t+e,await r.decode(),t?await createImageBitmap(r,t):await createImageBitmap(r)}var iy=class{device;id;texture;sampler;view;ready;isReady=!1;destroyed=!1;resolveReady=()=>{};rejectReady=()=>{};get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}constructor(t,r){this.device=t,this.id=r.id||Vc("async-texture"),typeof r?.data=="string"&&r.dimension==="2d"&&(r={...r,data:kW(r.data)}),this.ready=new Promise((n,i)=>{this.resolveReady=()=>{this.isReady=!0,n()},this.rejectReady=i}),this.initAsync(r)}async initAsync(t){let r,n,i=t.data,o=await FW(i).then(r,n);if(this.destroyed)return;let s={...t,data:o};this.texture=this.device.createTexture(s),this.sampler=this.texture.sampler,this.view=this.texture.view,this.isReady=!0}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}resize(t){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(t.width===this.texture.width&&t.height===this.texture.height)return!1;if(this.texture){let r=this.texture;this.texture=r.clone(t),r.destroy()}return!0}};async function FW(e){if(e=await e,Array.isArray(e))return await Promise.all(e.map(FW));if(e&&typeof e=="object"&&e.constructor===Object){let t=e,r=await Promise.all(Object.values(t)),n=Object.keys(t),i={};for(let o=0;o<n.length;o++)i[n[o]]=r[o];return i}return e}var u0=2,N1t=1e4,cD=class{device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};uniforms={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;_getModuleUniforms;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}constructor(t,r){this.props={...cD.defaultProps,...r},r=this.props,this.id=r.id||Vc("model"),this.device=t,Object.assign(this.userData,r.userData);let n=Object.fromEntries(this.props.modules?.map(l=>[l.name,l])||[]),i=r.shaderInputs||new CS(n,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(i);let o=F1t(t),s=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){this.props.shaderLayout||=zB(this.props.source);let{source:l,getUniforms:h}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:o,...this.props,modules:s});this.source=l,this._getModuleUniforms=h}else{let{vs:l,fs:h,getUniforms:p}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:o,...this.props,modules:s});this.vs=l,this.fs=h,this._getModuleUniforms=p}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,r.geometry&&this.setGeometry(r.geometry),this.pipelineFactory=r.pipelineFactory||g2.getDefaultPipelineFactory(this.device),this.shaderFactory=r.shaderFactory||_2.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=t.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in r&&(this.isInstanced=r.isInstanced),r.instanceCount&&this.setInstanceCount(r.instanceCount),r.vertexCount&&this.setVertexCount(r.vertexCount),r.indexBuffer&&this.setIndexBuffer(r.indexBuffer),r.attributes&&this.setAttributes(r.attributes),r.constantAttributes&&this.setConstantAttributes(r.constantAttributes),r.bindings&&this.setBindings(r.bindings),r.uniforms&&this.setUniformsWebGL(r.uniforms),r.moduleSettings&&this.updateModuleSettingsWebGL(r.moduleSettings),r.transformFeedback&&(this.transformFeedback=r.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");let t=this._needsRedraw;return this._needsRedraw=!1,t}setNeedsRedraw(t){this._needsRedraw||=t}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(t){let r=this._areBindingsLoading();if(r)return qe.info(u0,`>>> DRAWING ABORTED ${this.id}: ${r} not loaded`)(),!1;try{t.pushDebugGroup(`${this}.predraw(${t})`),this.predraw()}finally{t.popDebugGroup()}let n;try{t.pushDebugGroup(`${this}.draw(${t})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();let i=this._getBindings();this.pipeline.setBindings(i,{disableWarnings:this.props.disableWarnings}),aD(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);let{indexBuffer:o}=this.vertexArray,s=o?o.byteLength/(o.indexType==="uint32"?4:2):void 0;n=this.pipeline.draw({renderPass:t,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:s,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{t.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(t),n?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",n}setGeometry(t){this._gpuGeometry?.destroy();let r=t&&BW(this.device,t);if(r){this.setTopology(r.topology||"triangle-list");let n=new GA(this.bufferLayout);this.bufferLayout=n.mergeBufferLayouts(r.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(r)}this._gpuGeometry=r}setTopology(t){t!==this.topology&&(this.topology=t,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(t){let r=new GA(this.bufferLayout);this.bufferLayout=this._gpuGeometry?r.mergeBufferLayouts(t,this._gpuGeometry.bufferLayout):t,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(t){MS(t,this.parameters,2)||(this.parameters=t,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(t){this.instanceCount=t,this.isInstanced===void 0&&t>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(t){this.vertexCount=t,this.setNeedsRedraw("vertexCount")}setShaderInputs(t){this.shaderInputs=t,this._uniformStore=new Ev(this.shaderInputs.modules);for(let[r,n]of Object.entries(this.shaderInputs.modules))if(k1t(n)){let i=this._uniformStore.getManagedUniformBuffer(this.device,r);this.bindings[`${r}Uniforms`]=i}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(t){Object.assign(this.bindings,t),this.setNeedsRedraw("bindings")}setTransformFeedback(t){this.transformFeedback=t,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(t){this.vertexArray.setIndexBuffer(t),this.setNeedsRedraw("indexBuffer")}setAttributes(t,r){let n=r?.disableWarnings??this.props.disableWarnings;t.indices&&qe.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)();let i=new GA(this.bufferLayout);for(let[o,s]of Object.entries(t)){let c=i.getBufferLayout(o);if(!c){n||qe.warn(`Model(${this.id}): Missing layout for buffer "${o}".`)();continue}let l=i.getAttributeNamesForBuffer(c),h=!1;for(let p of l){let x=this._attributeInfos[p];x&&(this.vertexArray.setBuffer(x.location,s),h=!0)}!h&&!n&&qe.warn(`Model(${this.id}): Ignoring buffer "${s.id}" for unknown attribute "${o}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(t,r){for(let[n,i]of Object.entries(t)){let o=this._attributeInfos[n];o?this.vertexArray.setConstantWebGL(o.location,i):(r?.disableWarnings??this.props.disableWarnings)||qe.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${n}"`)()}this.setNeedsRedraw("constants")}setUniforms(t){this.setUniformsWebGL(t)}setUniformsWebGL(t){aD(t)||(this.pipeline.setUniformsWebGL(t),Object.assign(this.uniforms,t)),this.setNeedsRedraw("uniforms")}updateModuleSettingsWebGL(t){let{bindings:r,uniforms:n}=SS(this._getModuleUniforms(t));Object.assign(this.bindings,r),Object.assign(this.uniforms,n),this.setNeedsRedraw("moduleSettings")}_areBindingsLoading(){for(let t of Object.values(this.bindings))if(t instanceof iy&&!t.isReady)return t.id;return!1}_getBindings(){let t={};for(let[r,n]of Object.entries(this.bindings))n instanceof iy?n.isReady&&(t[r]=n.texture):t[r]=n;return t}_getBindingsUpdateTimestamp(){let t=0;for(let r of Object.values(this.bindings))r instanceof tm?t=Math.max(t,r.texture.updateTimestamp):r instanceof Vn||r instanceof fi?t=Math.max(t,r.updateTimestamp):r instanceof iy?t=r.texture?Math.max(t,r.texture.updateTimestamp):1/0:r instanceof rm||(t=Math.max(t,r.buffer.updateTimestamp));return t}_setGeometryAttributes(t){let r={...t.attributes};for(let[n]of Object.entries(r))!this.pipeline.shaderLayout.attributes.find(i=>i.name===n)&&n!=="positions"&&delete r[n];this.vertexCount=t.vertexCount,this.setIndexBuffer(t.indices||null),this.setAttributes(t.attributes,{disableWarnings:!0}),this.setAttributes(r,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(t){this._pipelineNeedsUpdate||=t,this.setNeedsRedraw(t)}_updatePipeline(){if(this._pipelineNeedsUpdate){let t=null,r=null;this.pipeline&&(qe.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),t=this.pipeline.vs,r=this.pipeline.fs),this._pipelineNeedsUpdate=!1;let n=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders}),i=null;this.source?i=n:this.fs&&(i=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:n,fs:i}),this._attributeInfos=jE(this.pipeline.shaderLayout,this.bufferLayout),t&&this.shaderFactory.release(t),r&&this.shaderFactory.release(r)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){let t=qe.level>3?0:N1t;qe.level<2||Date.now()-this._lastLogTime<t||(this._lastLogTime=Date.now(),this._logOpen=!0,qe.group(u0,`>>> DRAWING MODEL ${this.id}`,{collapsed:qe.level<=2})())}_logDrawCallEnd(){if(this._logOpen){let t=DW(this.pipeline.shaderLayout,this.id);qe.table(u0,t)();let r=this.shaderInputs.getDebugTable();for(let[i,o]of Object.entries(this.uniforms))r[i]={value:o};qe.table(u0,r)();let n=this._getAttributeDebugTable();qe.table(u0,this._attributeInfos)(),qe.table(u0,n)(),qe.groupEnd(u0)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(t){let r=this.device.props.debugFramebuffers;if(this._drawCount++,!r)return;let n=t.props.framebuffer;n&&NW(n,{id:n.id,minimap:!0})}_getAttributeDebugTable(){let t={};for(let[r,n]of Object.entries(this._attributeInfos)){let i=this.vertexArray.attributes[n.location];t[n.location]={name:r,type:n.shaderType,values:i?this._getBufferOrConstantValues(i,n.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){let{indexBuffer:r}=this.vertexArray,n=r.indexType==="uint32"?new Uint32Array(r.debugData):new Uint16Array(r.debugData);t.indices={name:"indices",type:r.indexType,values:n.toString()}}return t}_getBufferOrConstantValues(t,r){let n=Mv(r);return(t instanceof Vn?new n(t.debugData):t).toString()}},jn=cD;Vr(jn,"defaultProps",{...Eh.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:nm.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0});function k1t(e){return Boolean(e.uniformTypes&&!aD(e.uniformTypes))}function F1t(e){return{type:e.type,shaderLanguage:e.info.shadingLanguage,shaderLanguageVersion:e.info.shadingLanguageVersion,gpu:e.info.gpu,features:e.features}}function aD(e){for(let t in e)return!1;return!0}var PS=class{device;model;transformFeedback;static isSupported(t){return t?.info?.type==="webgl"}constructor(t,r=PS.defaultProps){if(!PS.isSupported(t))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=t,this.model=new jn(this.device,{id:r.id||"buffer-transform-model",fs:r.fs||kv(),topology:r.topology||"point-list",varyings:r.outputs||r.varyings,...r}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:r.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(t){t?.inputBuffers&&this.model.setAttributes(t.inputBuffers),t?.outputBuffers&&this.transformFeedback.setBuffers(t.outputBuffers);let r=this.device.beginRenderPass(t);this.model.draw(r),r.end()}getBuffer(t){return this.transformFeedback.getBuffer(t)}readAsync(t){let r=this.getBuffer(t);if(!r)throw new Error("BufferTransform#getBuffer");if(r instanceof Vn)return r.readAsync();let{buffer:n,byteOffset:i=0,byteLength:o=n.byteLength}=r;return n.readAsync(i,o)}},uu=PS;Vr(uu,"defaultProps",{...jn.defaultProps,outputs:void 0,feedbackBuffers:void 0});var z1t="transform_output",gm=class{device;model;sampler;currentIndex=0;samplerTextureMap=null;bindings=[];resources={};constructor(t,r){this.device=t,this.sampler=t.createSampler({addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",minFilter:"nearest",magFilter:"nearest",mipmapFilter:"nearest"}),this.model=new jn(this.device,{id:r.id||"texture-transform-model",fs:r.fs||kv({input:r.targetTextureVarying,inputChannels:r.targetTextureChannels,output:z1t}),vertexCount:r.vertexCount,...r}),this._initialize(r),Object.seal(this)}destroy(){this.model.destroy();for(let t of this.bindings)t.framebuffer?.destroy()}delete(){this.destroy()}run(t){let{framebuffer:r}=this.bindings[this.currentIndex],n=this.device.beginRenderPass({framebuffer:r,...t});this.model.draw(n),n.end()}getTargetTexture(){let{targetTexture:t}=this.bindings[this.currentIndex];return t}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}_initialize(t){this._updateBindings(t)}_updateBindings(t){this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t)}_updateBinding(t,{sourceBuffers:r,sourceTextures:n,targetTexture:i}){if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,n),Object.assign(t.sourceBuffers,r),i){t.targetTexture=i;let{width:o,height:s}=i;t.framebuffer&&t.framebuffer.destroy(),t.framebuffer=this.device.createFramebuffer({id:"transform-framebuffer",width:o,height:s,colorAttachments:[i]}),t.framebuffer.resize({width:o,height:s})}return t}_setSourceTextureParameters(){let t=this.currentIndex,{sourceTextures:r}=this.bindings[t];for(let n in r)r[n].sampler=this.sampler}};var Mi=class{id;topology;vertexCount;indices;attributes;userData={};constructor(t){let{attributes:r={},indices:n=null,vertexCount:i=null}=t;this.id=t.id||Vc("geometry"),this.topology=t.topology,n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n),this.attributes={};for(let[o,s]of Object.entries(r)){let c=ArrayBuffer.isView(s)?{value:s}:s;if(!ArrayBuffer.isView(c.value))throw new Error(`${this._print(o)}: must be typed array or object with value as typed array`);if((o==="POSITION"||o==="positions")&&!c.size&&(c.size=3),o==="indices"){if(this.indices)throw new Error("Multiple indices detected");this.indices=c}else this.attributes[o]=c}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=i||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return`Geometry ${this.id} attribute ${t}`}_setAttributes(t,r){return this}_calculateVertexCount(t,r){if(r)return r.value.length;let n=1/0;for(let i of Object.values(t)){let{value:o,size:s,constant:c}=i;!c&&o&&s!==void 0&&s>=1&&(n=Math.min(n,o.length/s))}return n}};var U1t=`struct VertexInputs {
  @location(0) clipSpacePosition: vec2<f32>,
  @location(1) texCoord: vec2<f32>,
  @location(2) coordinate: vec2<f32>  
}

struct FragmentInputs {
  @builtin(position) Position : vec4<f32>,
  @location(0) position : vec2<f32>,
  @location(1) coordinate : vec2<f32>,
  @location(2) uv : vec2<f32>
};

@vertex
fn vertexMain(inputs: VertexInputs) -> FragmentInputs {
  var outputs: FragmentInputs;
  outputs.Position = vec4(inputs.clipSpacePosition, 0., 1.);
  outputs.position = inputs.clipSpacePosition;
  outputs.coordinate = inputs.coordinate;
  outputs.uv = inputs.texCoord;
  return outputs;
}
`,V1t=`#version 300 es
in vec2 clipSpacePositions;
in vec2 texCoords;
in vec2 coordinates;

out vec2 position;
out vec2 coordinate;
out vec2 uv;

void main(void) {
  gl_Position = vec4(clipSpacePositions, 0., 1.);
  position = clipSpacePositions;
  coordinate = coordinates;
  uv = texCoords;
}
`,zW=[-1,-1,1,-1,-1,1,1,1],y2=class extends jn{constructor(t,r){let n=zW.map(i=>i===-1?0:i);r.source&&(r={...r,source:`${U1t}
${r.source}`}),super(t,{id:r.id||Vc("clip-space"),...r,vs:V1t,vertexCount:4,geometry:new Mi({topology:"triangle-strip",vertexCount:4,attributes:{clipSpacePositions:{size:2,value:new Float32Array(zW)},texCoords:{size:2,value:new Float32Array(n)},coordinates:{size:2,value:new Float32Array(n)}}})})}};var Zu=class{id;matrix=new Fn;display=!0;position=new ur;rotation=new ur;scale=new ur(1,1,1);userData={};props={};constructor(t={}){let{id:r}=t;this.id=r||Vc(this.constructor.name),this._setScenegraphNodeProps(t)}getBounds(){return null}destroy(){}delete(){this.destroy()}setProps(t){return this._setScenegraphNodeProps(t),this}toString(){return`{type: ScenegraphNode, id: ${this.id})}`}setPosition(t){return this.position=t,this}setRotation(t){return this.rotation=t,this}setScale(t){return this.scale=t,this}setMatrix(t,r=!0){r?this.matrix.copy(t):this.matrix=t}setMatrixComponents(t){let{position:r,rotation:n,scale:i,update:o=!0}=t;return r&&this.setPosition(r),n&&this.setRotation(n),i&&this.setScale(i),o&&this.updateMatrix(),this}updateMatrix(){let t=this.position,r=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(t),this.matrix.rotateXYZ(r),this.matrix.scale(n),this}update(t={}){let{position:r,rotation:n,scale:i}=t;return r&&this.setPosition(r),n&&this.setRotation(n),i&&this.setScale(i),this.updateMatrix(),this}getCoordinateUniforms(t,r){r=r||this.matrix;let n=new Fn(t).multiplyRight(r),i=n.invert(),o=i.transpose();return{viewMatrix:t,modelMatrix:r,objectMatrix:r,worldMatrix:n,worldInverseMatrix:i,worldInverseTransposeMatrix:o}}_setScenegraphNodeProps(t){"position"in t&&this.setPosition(t.position),"rotation"in t&&this.setRotation(t.rotation),"scale"in t&&this.setScale(t.scale),"matrix"in t&&this.setMatrix(t.matrix),Object.assign(this.props,t)}};var hu=class extends Zu{children;constructor(t={}){t=Array.isArray(t)?{children:t}:t;let{children:r=[]}=t;qe.assert(r.every(n=>n instanceof Zu),"every child must an instance of ScenegraphNode"),super(t),this.children=r}getBounds(){let t=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return this.traverse((r,{worldMatrix:n})=>{let i=r.getBounds();if(!i)return;let[o,s]=i,c=new ur(o).add(s).divide([2,2,2]);n.transformAsPoint(c,c);let l=new ur(s).subtract(o).divide([2,2,2]);n.transformAsVector(l,l);for(let h=0;h<8;h++){let p=new ur(h&1?-1:1,h&2?-1:1,h&4?-1:1).multiply(l).add(c);for(let x=0;x<3;x++)t[0][x]=Math.min(t[0][x],p[x]),t[1][x]=Math.max(t[1][x],p[x])}}),Number.isFinite(t[0][0])?t:null}destroy(){this.children.forEach(t=>t.destroy()),this.removeAll(),super.destroy()}add(...t){for(let r of t)Array.isArray(r)?this.add(...r):this.children.push(r);return this}remove(t){let r=this.children,n=r.indexOf(t);return n>-1&&r.splice(n,1),this}removeAll(){return this.children=[],this}traverse(t,{worldMatrix:r=new Fn}={}){let n=new Fn(r).multiplyRight(this.matrix);for(let i of this.children)i instanceof hu?i.traverse(t,{worldMatrix:n}):t(i,{worldMatrix:n})}};var Wf=class extends Zu{model;bounds=null;managedResources;constructor(t){super(t),this.model=t.model,this.managedResources=t.managedResources||[],this.bounds=t.bounds||null,this.setProps(t)}destroy(){this.model&&(this.model.destroy(),this.model=null),this.managedResources.forEach(t=>t.destroy()),this.managedResources=[]}getBounds(){return this.bounds}draw(t){return this.model.draw(t)}};var Xp=class extends Mi{constructor(t={}){let{id:r=Vc("cube-geometry"),indices:n=!0}=t;super(n?{...t,id:r,topology:"triangle-list",indices:{size:1,value:j1t},attributes:{...K1t,...t.attributes}}:{...t,id:r,topology:"triangle-list",indices:void 0,attributes:{...Z1t,...t.attributes}})}},j1t=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),H1t=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),W1t=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),q1t=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),G1t=new Float32Array([1,-1,1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,-1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,1,1,1,1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,1,-1,1,1,1,-1,1,1,-1,-1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1]),X1t=new Float32Array([1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,1,0,0]),Y1t=new Float32Array([1,0,1,1,0,0,1,1,0,0,0,1,1,0,0,1,1,0,1,1,0,0,0,1,1,1,1,1,1,0,1,1,1,0,0,1,1,1,0,1,1,1,1,1,1,0,0,1,0,1,1,1,1,1,1,1,1,1,0,1,0,1,0,1,0,1,1,1,1,1,0,1,0,0,1,1,0,1,1,1,0,1,0,1,0,0,0,1,0,0,1,1,0,1,0,1,1,1,1,1,0,1,1,1,0,0,1,1,0,0,1,1,1,0,1,1,1,1,1,1,1,0,0,1,0,0,0,1,0,1,0,1,1,1,0,1,1,0,0,1,0,1,0,1]),K1t={POSITION:{size:3,value:H1t},NORMAL:{size:3,value:W1t},TEXCOORD_0:{size:2,value:q1t}},Z1t={POSITION:{size:3,value:G1t},TEXCOORD_0:{size:2,value:X1t},COLOR_0:{size:3,value:Y1t}};var x2=class extends Mi{constructor(t={}){let{id:r=Vc("sphere-geometry")}=t,{indices:n,attributes:i}=$1t(t);super({...t,id:r,topology:"triangle-list",indices:n,attributes:{...i,...t.attributes}})}};function $1t(e){let{nlat:t=10,nlong:r=10}=e,o=Math.PI-0,s=0,l=2*Math.PI-s,h=(t+1)*(r+1),p=(W,X,q,$,et)=>e.radius||1,x=new Float32Array(h*3),w=new Float32Array(h*3),E=new Float32Array(h*2),P=h>65535?Uint32Array:Uint16Array,B=new P(t*r*6);for(let W=0;W<=t;W++)for(let X=0;X<=r;X++){let q=X/r,$=W/t,et=X+W*(r+1),F=et*2,ut=et*3,ot=l*q,J=o*$,G=Math.sin(ot),mt=Math.cos(ot),Mt=Math.sin(J),ct=Math.cos(J),gt=mt*Mt,ee=ct,Ne=G*Mt,Ue=p(gt,ee,Ne,q,$);x[ut+0]=Ue*gt,x[ut+1]=Ue*ee,x[ut+2]=Ue*Ne,w[ut+0]=gt,w[ut+1]=ee,w[ut+2]=Ne,E[F+0]=q,E[F+1]=1-$}let D=r+1;for(let W=0;W<r;W++)for(let X=0;X<t;X++){let q=(W*t+X)*6;B[q+0]=X*D+W,B[q+1]=X*D+W+1,B[q+2]=(X+1)*D+W,B[q+3]=(X+1)*D+W,B[q+4]=X*D+W+1,B[q+5]=(X+1)*D+W+1}return{indices:{size:1,value:B},attributes:{POSITION:{size:3,value:x},NORMAL:{size:3,value:w},TEXCOORD_0:{size:2,value:E}}}}var Q1t=`uniform screenUniforms {
  vec2 texSize;
} screen;
`,UW={name:"screen",fs:Q1t,uniformTypes:{texSize:"vec2<f32>"}};var v2=class extends o0{constructor(t,r){super(t,r);let{module:n,fs:i,id:o}=r,s={depthWriteEnabled:!1,depthCompare:"always"};this.model=new y2(t,{id:o,fs:i,modules:[n,UW],parameters:s})}render(t){this._renderPass(this.device,t)}delete(){this.model.destroy(),this.model=null}_renderPass(t,r){let{clearCanvas:n,inputBuffer:i,outputBuffer:o}=r,s=[i.width,i.height],c={texSrc:i.colorAttachments[0],texSize:s};this.model.shaderInputs.setProps({screen:c,...r.moduleProps});let l=this.device.beginRenderPass({framebuffer:o,parameters:{viewport:[0,0,...s]},clearColor:n?[0,0,0,0]:!1,clearDepth:1});this.model.draw(l),l.end()}};var b2=class{constructor(t,r){this.id=`${t.name}-pass`,this.props=r,yM(t),this.module=t}setup({device:t}){this.passes=J1t(t,this.module,this.id)}setProps(t){this.props=t}preRender(){}postRender(t){let r=this.passes,{target:n}=t,i=t.inputBuffer,o=t.swapBuffer;for(let s=0;s<r.length;s++){let c=s===r.length-1,l=n!==void 0&&c;l&&(o=n);let h=!l||Boolean(t.clearCanvas),p={},x=this.module.passes[s].uniforms;p[this.module.name]={...this.props,...x},r[s].render({clearCanvas:h,inputBuffer:i,outputBuffer:o,moduleProps:p});let w=o;o=i,i=w}return i}cleanup(){if(this.passes){for(let t of this.passes)t.delete();this.passes=void 0}}};function J1t(e,t,r){return t.passes.map((n,i)=>{let o=rxt(t,n),s=`${r}-${i}`;return new v2(e,{id:s,module:t,fs:o})})}var VW=`#version 300 es
uniform sampler2D texSrc;

in vec2 position;
in vec2 coordinate;
in vec2 uv;

out vec4 fragColor;
`,txt=e=>`${VW}
void main() {
  fragColor = texture(texSrc, coordinate);
  fragColor = ${e}(fragColor, screen.texSize, coordinate);
}
`,ext=e=>`${VW}
void main() {
  fragColor = ${e}(texSrc, screen.texSize, coordinate);
}
`;function rxt(e,t){if(t.filter){let r=typeof t.filter=="string"?t.filter:`${e.name}_filterColor_ext`;return txt(r)}if(t.sampler){let r=typeof t.sampler=="string"?t.sampler:`${e.name}_sampleColor`;return ext(r)}return""}var nxt={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"},Yp=class extends Oh{constructor(){super(...arguments),this._colorEncoderState=null}render(t){return"pickingFBO"in t?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer({layers:t,layerFilter:r,views:n,viewports:i,onViewportActive:o,pickingFBO:s,deviceRect:{x:c,y:l,width:h,height:p},cullRect:x,effects:w,pass:E="picking",pickZ:P,shaderModuleProps:B}){this.pickZ=P;let D=this._resetColorEncoder(P),W=[c,l,h,p],X=super.render({target:s,layers:t,layerFilter:r,views:n,viewports:i,onViewportActive:o,cullRect:x,effects:w?.filter($=>$.useInPicking),pass:E,isPicking:!0,shaderModuleProps:B,clearColor:[0,0,0,0],colorMask:15,scissorRect:W});return this._colorEncoderState=null,{decodePickingColor:D&&oxt.bind(null,D),stats:X}}shouldDrawLayer(t){let{pickable:r,operation:n}=t.props;return r&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getShaderModuleProps(t,r,n){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(t,r,n){let i={...t.props.parameters},{pickable:o,operation:s}=t.props;return!this._colorEncoderState||s.includes("terrain")?i.blend=!1:o&&s.includes("draw")&&(Object.assign(i,nxt),i.blend=!0,i.blendColor=ixt(this._colorEncoderState,t,n)),i}_resetColorEncoder(t){return this._colorEncoderState=t?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}};function ixt(e,t,r){let{byLayer:n,byAlpha:i}=e,o,s=n.get(t);return s?(s.viewports.push(r),o=s.a):(o=n.size+1,o<=255?(s={a:o,layer:t,viewports:[r]},n.set(t,s),i[o]=s):(br.warn("Too many pickable layers, only picking the first 255")(),o=0)),[0,0,0,o/255]}function oxt(e,t){let r=e.byAlpha[t[3]];return r&&{pickedLayer:r.layer,pickedViewports:r.viewports,pickedObjectIndex:r.layer.decodePickingColor(t)}}var _m={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},oy=Symbol.for("component"),$u=Symbol.for("propTypes"),IS=Symbol.for("deprecatedProps"),Kp=Symbol.for("asyncPropDefaults"),qf=Symbol.for("asyncPropOriginal"),Dh=Symbol.for("asyncPropResolved");function Gf(e,t=()=>!0){return Array.isArray(e)?jW(e,t,[]):t(e)?[e]:[]}function jW(e,t,r){let n=-1;for(;++n<e.length;){let i=e[n];Array.isArray(i)?jW(i,t,r):t(i)&&r.push(i)}return r}function RS({target:e,source:t,start:r=0,count:n=1}){let i=t.length,o=n*i,s=0;for(let c=r;s<i;s++)e[c++]=t[s];for(;s<o;)s<o-s?(e.copyWithin(r+s,r,r+s),s*=2):(e.copyWithin(r+s,r,r+o-s),s=o);return e}var w2=class{constructor(t,r,n){this._loadCount=0,this._subscribers=new Set,this.id=t,this.context=n,this.setData(r)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(t,r){if(t===this._data&&!r)return;this._data=t;let n=++this._loadCount,i=t;typeof t=="string"&&(i=xa(t)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(o=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=o)}).catch(o=>{this._loadCount===n&&(this.isLoaded=!0,this._error=o||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=t);for(let o of this._subscribers)o.onChange(this.getData())}};var T2=class{constructor(t){this.protocol=t.protocol||"resource://",this._context={device:t.device,gl:t.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return t.startsWith(this.protocol)?!0:t in this._resources}add({resourceId:t,data:r,forceUpdate:n=!1,persistent:i=!0}){let o=this._resources[t];o?o.setData(r,n):(o=new w2(t,r,this._context),this._resources[t]=o),o.persistent=i}remove(t){let r=this._resources[t];r&&(r.delete(),delete this._resources[t])}unsubscribe({consumerId:t}){let r=this._consumers[t];if(r){for(let n in r){let i=r[n],o=this._resources[i.resourceId];o&&o.unsubscribe(i)}delete this._consumers[t],this.prune()}}subscribe({resourceId:t,onChange:r,consumerId:n,requestId:i="default"}){let{_resources:o,protocol:s}=this;t.startsWith(s)&&(t=t.replace(s,""),o[t]||this.add({resourceId:t,data:null,persistent:!1}));let c=o[t];if(this._track(n,i,c,r),c)return c.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(let t in this._resources)this._resources[t].delete()}_track(t,r,n,i){let o=this._consumers,s=o[t]=o[t]||{},c=s[r],l=c&&c.resourceId&&this._resources[c.resourceId];l&&(l.unsubscribe(c),this.prune()),n&&(c?(c.onChange=i,c.resourceId=n.id):c={onChange:i,resourceId:n.id},s[r]=c,n.subscribe(c))}_prune(){this._pruneRequest=null;for(let t of Object.keys(this._resources)){let r=this._resources[t];!r.persistent&&!r.inUse()&&(r.delete(),delete this._resources[t])}}};var sxt="layerManager.setLayers",axt="layerManager.activateViewport",h0=class{constructor(t,r){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=c=>{qs(axt,this,c),c&&(this.context.viewport=c)};let{deck:n,stats:i,viewport:o,timeline:s}=r||{};this.layers=[],this.resourceManager=new T2({device:t,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:t,gl:t?.gl,deck:n,shaderAssembler:xS(),defaultShaderModules:[D4],renderPass:void 0,stats:i||new Nc({id:"deck.gl"}),viewport:o||new wa({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new l0,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(let t of this.layers)this._finalizeLayer(t)}needsRedraw(t={clearRedrawFlags:!1}){let r=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(let n of this.layers){let i=n.getNeedsRedraw(t);r=r||i}return r}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers({layerIds:t}={}){return t?this.layers.filter(r=>t.find(n=>r.id.indexOf(n)===0)):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,r){qs(sxt,this,r,t),this._lastRenderedLayers=t;let n=Gf(t,Boolean);for(let i of n)i.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){let t=this.needsUpdate();t&&(this.setNeedsRedraw(`updating layers: ${t}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,t)),this._nextLayers=null}addDefaultShaderModule(t){let{defaultShaderModules:r}=this.context;r.find(n=>n.name===t.name)||(r.push(t),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(t){let{defaultShaderModules:r}=this.context,n=r.findIndex(i=>i.name===t.name);n>=0&&(r.splice(n,1),this._defaultShaderModulesChanged=!0)}_handleError(t,r,n){n.raiseError(r,`${t} of ${n}`)}_updateLayers(t,r){let n={};for(let s of t)n[s.id]?br.warn(`Multiple old layers with same id ${s.id}`)():n[s.id]=s;if(this._defaultShaderModulesChanged){for(let s of t)s.setNeedsUpdate(),s.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}let i=[];this._updateSublayersRecursively(r,n,i),this._finalizeOldLayers(n);let o=!1;for(let s of i)if(s.hasUniformTransition()){o=`Uniform transition in ${s}`;break}this._needsUpdate=o,this.layers=i}_updateSublayersRecursively(t,r,n){for(let i of t){i.context=this.context;let o=r[i.id];o===null&&br.warn(`Multiple new layers with same id ${i.id}`)(),r[i.id]=null;let s=null;try{this._debug&&o!==i&&i.validateProps(),o?(this._transferLayerState(o,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),s=i.isComposite?i.getSubLayers():null}catch(c){this._handleError("matching",c,i)}s&&this._updateSublayersRecursively(s,r,n)}}_finalizeOldLayers(t){for(let r in t){let n=t[r];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=_m.INITIALIZED}catch(r){this._handleError("initialization",r,t)}}_transferLayerState(t,r){r._transferState(t),r.lifecycle=_m.MATCHED,r!==t&&(t.lifecycle=_m.AWAITING_GC)}_updateLayer(t){try{t._update()}catch(r){this._handleError("update",r,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||`finalized ${t}`,t.lifecycle=_m.AWAITING_FINALIZATION;try{t._finalize(),t.lifecycle=_m.FINALIZED}catch(r){this._handleError("finalization",r,t)}}};function Oi(e,t,r){if(e===t)return!0;if(!r||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Oi(e[n],t[n],r-1))return!1;return!0}if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){let n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(let o of n)if(!t.hasOwnProperty(o)||!Oi(e[o],t[o],r-1))return!1;return!0}return!1}var E2=class{constructor(t){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(let t in this.controllers){let r=this.controllers[t];r&&r.finalize()}this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){let r=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),r}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(let t in this.controllers){let r=this.controllers[t];r&&r.updateTransition()}}getViewports(t){return t?this._viewports.filter(r=>r.containsPixel(t)):this._viewports}getViews(){let t={};return this.views.forEach(r=>{t[r.id]=r}),t}getView(t){return this.views.find(r=>r.id===t)}getViewState(t){let r=typeof t=="string"?this.getView(t):t,n=r&&this.viewState[r.getViewStateId()]||this.viewState;return r?r.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,r){let n=this.getViewports(),i={x:t[0],y:t[1]};for(let o=n.length-1;o>=0;--o){let s=n[o];if(s.containsPixel(i)){let c=t.slice();return c[0]-=s.x,c[1]-=s.y,s.unproject(c,r)}}return null}setProps(t){t.views&&this._setViews(t.views),t.viewState&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,r){(t!==this.width||r!==this.height)&&(this.width=t,this.height=r,this.setNeedsUpdate("Size changed"))}_setViews(t){t=Gf(t,Boolean),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){t?(!Oi(t,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):br.warn("missing `viewState` or `initialViewState`")()}_createController(t,r){let n=r.type;return new n({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:o=>this.getView(t.id)?.makeViewport({viewState:o,width:this.width,height:this.height})})}_updateController(t,r,n,i){let o=t.controller;if(o&&n){let s={...r,...o,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height};return(!i||i.constructor!==o.type)&&(i=this._createController(t,s)),i&&i.setProps(s),i}return null}_rebuildViewports(){let{views:t}=this,r=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=t.length;i--;){let o=t[i],s=this.getViewState(o),c=o.makeViewport({viewState:s,width:this.width,height:this.height}),l=r[o.id],h=Boolean(o.controller);h&&!l&&(n=!0),(n||!h)&&l&&(l.finalize(),l=null),this.controllers[o.id]=this._updateController(o,s,c,l),c&&this._viewports.unshift(c)}for(let i in r){let o=r[i];o&&!this.controllers[i]&&o.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)})}_diffViews(t,r){return t.length!==r.length?!0:t.some((n,i)=>!t[i].equals(r[i]))}};var cxt=/([0-9]+\.?[0-9]*)(%|px)/;function Zp(e){switch(typeof e){case"number":return{position:e,relative:!1};case"string":let t=cxt.exec(e);if(t&&t.length>=3){let r=t[2]==="%",n=parseFloat(t[1]);return{position:r?n/100:n,relative:r}}default:throw new Error(`Could not parse position string ${e}`)}}function $p(e,t){return e.relative?Math.round(e.position*t):e.position}var fl=class{constructor(t){let{id:r,x:n=0,y:i=0,width:o="100%",height:s="100%",padding:c=null}=t;this.id=r||this.constructor.displayName||"view",this.props={...t,id:this.id},this._x=Zp(n),this._y=Zp(i),this._width=Zp(o),this._height=Zp(s),this._padding=c&&{left:Zp(c.left||0),right:Zp(c.right||0),top:Zp(c.top||0),bottom:Zp(c.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t?!0:this.constructor===t.constructor&&Oi(this.props,t.props,2)}makeViewport({width:t,height:r,viewState:n}){n=this.filterViewState(n);let i=this.getDimensions({width:t,height:r});if(!i.height||!i.width)return null;let o=this.getViewportType(n);return new o({...n,...this.props,...i})}getViewStateId(){let{viewState:t}=this.props;return typeof t=="string"?t:t?.id||this.id}filterViewState(t){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;let r={...t};for(let n in this.props.viewState)n!=="id"&&(r[n]=this.props.viewState[n]);return r}return t}getDimensions({width:t,height:r}){let n={x:$p(this._x,t),y:$p(this._y,r),width:$p(this._width,t),height:$p(this._height,r)};return this._padding&&(n.padding={left:$p(this._padding.left,t),top:$p(this._padding.top,r),right:$p(this._padding.right,t),bottom:$p(this._padding.bottom,r)}),n}get controller(){let t=this.props.controller;return t?t===!0?{type:this.ControllerType}:typeof t=="function"?{type:t}:{type:this.ControllerType,...t}:null}};var Nh=class{constructor(t){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=t}get inProgress(){return this._inProgress}start(t){this.cancel(),this.settings=t,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(this._handle===null){let{_timeline:t,settings:r}=this;this._handle=t.addChannel({delay:t.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};var HW=()=>{},M2={BREAK:1,SNAP_TO_END:2,IGNORE:3},lxt=e=>e,uxt=M2.BREAK,S2=class{constructor(t){this._onTransitionUpdate=r=>{let{time:n,settings:{interpolator:i,startProps:o,endProps:s,duration:c,easing:l}}=r,h=l(n/c),p=i.interpolateProps(o,s,h);this.propsInTransition=this.getControllerState({...this.props,...p}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=t.getControllerState,this.propsInTransition=null,this.transition=new Nh(t.timeline),this.onViewStateChange=t.onViewStateChange||HW,this.onStateChange=t.onStateChange||HW}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let r=!1,n=this.props;if(this.props=t,!n||this._shouldIgnoreViewportChange(n,t))return!1;if(this._isTransitionEnabled(t)){let i=n;if(this.transition.inProgress){let{interruption:o,endProps:s}=this.transition.settings;i={...n,...o===M2.SNAP_TO_END?s:this.propsInTransition||n}}this._triggerTransition(i,t),r=!0}else this.transition.cancel();return r}updateTransition(){this.transition.update()}_isTransitionEnabled(t){let{transitionDuration:r,transitionInterpolator:n}=t;return(r>0||r==="auto")&&Boolean(n)}_isUpdateDueToCurrentTransition(t){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition):!1}_shouldIgnoreViewportChange(t,r){return this.transition.inProgress?this.transition.settings.interruption===M2.IGNORE||this._isUpdateDueToCurrentTransition(r):this._isTransitionEnabled(r)?r.transitionInterpolator.arePropsEqual(t,r):!0}_triggerTransition(t,r){let n=this.getControllerState(t),i=this.getControllerState(r).shortestPathFrom(n),o=r.transitionInterpolator,s=o.getDuration?o.getDuration(t,r):r.transitionDuration;if(s===0)return;let c=o.initializeProps(t,i);this.propsInTransition={};let l={duration:s,easing:r.transitionEasing||lxt,interpolator:o,interruption:r.transitionInterruption||uxt,startProps:c.start,endProps:c.end,onStart:r.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(r.onTransitionInterrupt),onEnd:this._onTransitionEnd(r.onTransitionEnd)};this.transition.start(l),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return r=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),t?.(r)}}};function $o(e,t){if(!e)throw new Error(t||"deck.gl: assertion failed.")}var Qp=class{constructor(t){let{compare:r,extract:n,required:i}=t;this._propsToCompare=r,this._propsToExtract=n||r,this._requiredProps=i}arePropsEqual(t,r){for(let n of this._propsToCompare)if(!(n in t)||!(n in r)||!Fa(t[n],r[n]))return!1;return!0}initializeProps(t,r){let n={},i={};for(let o of this._propsToExtract)(o in t||o in r)&&(n[o]=t[o],i[o]=r[o]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(t,r){return r.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach(r=>{let n=t[r];$o(Number.isFinite(n)||Array.isArray(n),`${r} is required for transition`)})}};var hxt=["longitude","latitude","zoom","bearing","pitch"],fxt=["longitude","latitude","zoom"],Ec=class extends Qp{constructor(t={}){let r=Array.isArray(t)?t:t.transitionProps,n=Array.isArray(t)?{}:t;n.transitionProps=Array.isArray(r)?{compare:r,required:r}:r||{compare:hxt,required:fxt},super(n.transitionProps),this.opts=n}initializeProps(t,r){let n=super.initializeProps(t,r),{makeViewport:i,around:o}=this.opts;if(i&&o){let s=i(t),c=i(r),l=s.unproject(o);n.start.around=o,Object.assign(n.end,{around:c.project(l),aroundPosition:l,width:r.width,height:r.height})}return n}interpolateProps(t,r,n){let i={};for(let o of this._propsToExtract)i[o]=ka(t[o]||0,r[o]||0,n);if(r.aroundPosition&&this.opts.makeViewport){let o=this.opts.makeViewport({...r,...i});Object.assign(i,o.panByPosition(r.aroundPosition,ka(t.around,r.around,n)))}return i}};var ym={transitionDuration:0},pxt=300,LS=e=>1-(1-e)*(1-e),sy={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],MULTI_PAN:["multipanstart","multipanmove","multipanend"],DOUBLE_CLICK:["dblclick"],KEYBOARD:["keydown"]},f0={},pl=class{constructor(t){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new S2({...t,getControllerState:r=>new this.ControllerState(r),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=t.eventManager,this.onViewStateChange=t.onViewStateChange||(()=>{}),this.onStateChange=t.onStateChange||(()=>{}),this.makeViewport=t.makeViewport}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.props&&this.setProps(this.props)}finalize(){for(let t in this._events)this._events[t]&&this.eventManager?.off(t,this.handleEvent);this.transitionManager.finalize()}handleEvent(t){this._controllerState=void 0;let r=this._eventStartBlocked;switch(t.type){case"panstart":return r?!1:this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return r?!1:this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"multipanstart":return r?!1:this._onMultiPanStart(t);case"multipanmove":return this._onMultiPan(t);case"multipanend":return this._onMultiPanEnd(t);case"dblclick":return this._onDoubleClick(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(t){let{x:r,y:n}=this.props,{offsetCenter:i}=t;return[i.x-r,i.y-n]}isPointInBounds(t,r){let{width:n,height:i}=this.props;if(r&&r.handled)return!1;let o=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=i;return o&&r&&r.stopPropagation(),o}isFunctionKeyPressed(t){let{srcEvent:r}=t;return Boolean(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(t){let r=setTimeout(()=>{this._eventStartBlocked===r&&(this._eventStartBlocked=null)},t);this._eventStartBlocked=r}setProps(t){t.dragMode&&(this.dragMode=t.dragMode),this.props=t,"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);let{inertia:r}=t;this.inertia=Number.isFinite(r)?r:r===!0?pxt:0;let{scrollZoom:n=!0,dragPan:i=!0,dragRotate:o=!0,doubleClickZoom:s=!0,touchZoom:c=!0,touchRotate:l=!1,keyboard:h=!0}=t,p=Boolean(this.onViewStateChange);this.toggleEvents(sy.WHEEL,p&&n),this.toggleEvents(sy.PAN,p),this.toggleEvents(sy.PINCH,p&&(c||l)),this.toggleEvents(sy.MULTI_PAN,p&&l),this.toggleEvents(sy.DOUBLE_CLICK,p&&s),this.toggleEvents(sy.KEYBOARD,p&&h),this.scrollZoom=n,this.dragPan=i,this.dragRotate=o,this.doubleClickZoom=s,this.touchZoom=c,this.touchRotate=l,this.keyboard=h}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,r){this.eventManager&&t.forEach(n=>{this._events[n]!==r&&(this._events[n]=r,r?this.eventManager.on(n,this.handleEvent):this.eventManager.off(n,this.handleEvent))})}updateViewport(t,r=null,n={}){let i={...t.getViewportProps(),...r},o=this.controllerState!==t;if(this.state=t.getState(),this._setInteractionState(n),o){let s=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:s,viewId:this.props.id})}}_onTransition(t){this.onViewStateChange({...t,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange(this._interactionState)}_onPanStart(t){let r=this.getCenter(t);if(!this.isPointInBounds(r,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(n=!n);let i=this.controllerState[n?"panStart":"rotateStart"]({pos:r});return this._panMove=n,this.updateViewport(i,ym,{isDragging:!0}),!0}_onPan(t){return this.isDragging()?this._panMove?this._onPanMove(t):this._onPanRotate(t):!1}_onPanEnd(t){return this.isDragging()?this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t):!1}_onPanMove(t){if(!this.dragPan)return!1;let r=this.getCenter(t),n=this.controllerState.pan({pos:r});return this.updateViewport(n,ym,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){let{inertia:r}=this;if(this.dragPan&&r&&t.velocity){let n=this.getCenter(t),i=[n[0]+t.velocityX*r/2,n[1]+t.velocityY*r/2],o=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:LS},{isDragging:!1,isPanning:!0})}else{let n=this.controllerState.panEnd();this.updateViewport(n,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;let r=this.getCenter(t),n=this.controllerState.rotate({pos:r});return this.updateViewport(n,ym,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){let{inertia:r}=this;if(this.dragRotate&&r&&t.velocity){let n=this.getCenter(t),i=[n[0]+t.velocityX*r/2,n[1]+t.velocityY*r/2],o=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:LS},{isDragging:!1,isRotating:!0})}else{let n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;let r=this.getCenter(t);if(!this.isPointInBounds(r,t))return!1;t.srcEvent.preventDefault();let{speed:n=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:o}=t,s=2/(1+Math.exp(-Math.abs(o*n)));o<0&&s!==0&&(s=1/s);let c=this.controllerState.zoom({pos:r,scale:s});return this.updateViewport(c,{...this._getTransitionProps({around:r}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onMultiPanStart(t){let r=this.getCenter(t);if(!this.isPointInBounds(r,t))return!1;let n=this.controllerState.rotateStart({pos:r});return this.updateViewport(n,ym,{isDragging:!0}),!0}_onMultiPan(t){if(!this.touchRotate||!this.isDragging())return!1;let r=this.getCenter(t);r[0]-=t.deltaX;let n=this.controllerState.rotate({pos:r});return this.updateViewport(n,ym,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(t){if(!this.isDragging())return!1;let{inertia:r}=this;if(this.touchRotate&&r&&t.velocityY){let n=this.getCenter(t),i=[n[0],n[1]+=t.velocityY*r/2],o=this.controllerState.rotate({pos:i});this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:LS},{isDragging:!1,isRotating:!0}),this.blockEvents(r)}else{let n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){let r=this.getCenter(t);if(!this.isPointInBounds(r,t))return!1;let n=this.controllerState.zoomStart({pos:r}).rotateStart({pos:r});return f0._startPinchRotation=t.rotation,f0._lastPinchEvent=t,this.updateViewport(n,ym,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let r=this.controllerState;if(this.touchZoom){let{scale:n}=t,i=this.getCenter(t);r=r.zoom({pos:i,scale:n})}if(this.touchRotate){let{rotation:n}=t;r=r.rotate({deltaAngleX:f0._startPinchRotation-n})}return this.updateViewport(r,ym,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),f0._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;let{inertia:r}=this,{_lastPinchEvent:n}=f0;if(this.touchZoom&&r&&n&&t.scale!==n.scale){let i=this.getCenter(t),o=this.controllerState.rotateEnd(),s=Math.log2(t.scale),c=(s-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),l=Math.pow(2,s+c*r/2);o=o.zoom({pos:i,scale:l}).zoomEnd(),this.updateViewport(o,{...this._getTransitionProps({around:i}),transitionDuration:r,transitionEasing:LS},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(r)}else{let i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return f0._startPinchRotation=null,f0._lastPinchEvent=null,!0}_onDoubleClick(t){if(!this.doubleClickZoom)return!1;let r=this.getCenter(t);if(!this.isPointInBounds(r,t))return!1;let n=this.isFunctionKeyPressed(t),i=this.controllerState.zoom({pos:r,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:r}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;let r=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:o,rotateSpeedY:s}=this.keyboard===!0?{}:this.keyboard,{controllerState:c}=this,l,h={};switch(t.srcEvent.code){case"Minus":l=r?c.zoomOut(n).zoomOut(n):c.zoomOut(n),h.isZooming=!0;break;case"Equal":l=r?c.zoomIn(n).zoomIn(n):c.zoomIn(n),h.isZooming=!0;break;case"ArrowLeft":r?(l=c.rotateLeft(o),h.isRotating=!0):(l=c.moveLeft(i),h.isPanning=!0);break;case"ArrowRight":r?(l=c.rotateRight(o),h.isRotating=!0):(l=c.moveRight(i),h.isPanning=!0);break;case"ArrowUp":r?(l=c.rotateUp(s),h.isRotating=!0):(l=c.moveUp(i),h.isPanning=!0);break;case"ArrowDown":r?(l=c.rotateDown(s),h.isRotating=!0):(l=c.moveDown(i),h.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),h),!0}_getTransitionProps(t){let{transition:r}=this;return!r||!r.transitionInterpolator?ym:t?{...r,transitionInterpolator:new Ec({...t,...r.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:r}};var Jp=class{constructor(t,r){this._viewportProps=this.applyConstraints(t),this._state=r}getViewportProps(){return this._viewportProps}getState(){return this._state}};var WW=5,dxt=1.2,C2=class extends Jp{constructor(t){let{width:r,height:n,latitude:i,longitude:o,zoom:s,bearing:c=0,pitch:l=0,altitude:h=1.5,position:p=[0,0,0],maxZoom:x=20,minZoom:w=0,maxPitch:E=60,minPitch:P=0,startPanLngLat:B,startZoomLngLat:D,startRotatePos:W,startBearing:X,startPitch:q,startZoom:$,normalize:et=!0}=t;$o(Number.isFinite(o)),$o(Number.isFinite(i)),$o(Number.isFinite(s)),super({width:r,height:n,latitude:i,longitude:o,zoom:s,bearing:c,pitch:l,altitude:h,maxZoom:x,minZoom:w,maxPitch:E,minPitch:P,normalize:et,position:p},{startPanLngLat:B,startZoomLngLat:D,startRotatePos:W,startBearing:X,startPitch:q,startZoom:$}),this.makeViewport=t.makeViewport}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:r}){let n=this.getState().startPanLngLat||this._unproject(r);if(!n)return this;let o=this.makeViewport(this.getViewportProps()).panByPosition(n,t);return this._getUpdatedState(o)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:t,deltaAngleX:r=0,deltaAngleY:n=0}){let{startRotatePos:i,startBearing:o,startPitch:s}=this.getState();if(!i||o===void 0||s===void 0)return this;let c;return t?c=this._getNewRotation(t,i,s,o):c={bearing:o+r,pitch:s+n},this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom({pos:t,startPos:r,scale:n}){let{startZoom:i,startZoomLngLat:o}=this.getState();if(o||(i=this.getViewportProps().zoom,o=this._unproject(r)||this._unproject(t)),!o)return this;let{maxZoom:s,minZoom:c}=this.getViewportProps(),l=i+Math.log2(n);l=ro(l,c,s);let h=this.makeViewport({...this.getViewportProps(),zoom:l});return this._getUpdatedState({zoom:l,...h.panByPosition(o,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}shortestPathFrom(t){let r=t.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:o}=n;return Math.abs(i-r.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(o-r.longitude)>180&&(n.longitude=o<0?o+360:o-360),n}applyConstraints(t){let{maxZoom:r,minZoom:n,zoom:i}=t;t.zoom=ro(i,n,r);let{maxPitch:o,minPitch:s,pitch:c}=t;t.pitch=ro(c,s,o);let{normalize:l=!0}=t;return l&&Object.assign(t,Z4(t)),t}_zoomFromCenter(t){let{width:r,height:n}=this.getViewportProps();return this.zoom({pos:[r/2,n/2],scale:t})}_panFromCenter(t){let{width:r,height:n}=this.getViewportProps();return this.pan({startPos:[r/2,n/2],pos:[r/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}_unproject(t){let r=this.makeViewport(this.getViewportProps());return t&&r.unproject(t)}_getNewRotation(t,r,n,i){let o=t[0]-r[0],s=t[1]-r[1],c=t[1],l=r[1],{width:h,height:p}=this.getViewportProps(),x=o/h,w=0;s>0?Math.abs(p-l)>WW&&(w=s/(l-p)*dxt):s<0&&l>WW&&(w=1-c/l),w=ro(w,-1,1);let{minPitch:E,maxPitch:P}=this.getViewportProps(),B=i+180*x,D=n;return w>0?D=n+w*(P-n):w<0&&(D=n-w*(E-n)),{pitch:D,bearing:B}}},p0=class extends pl{constructor(){super(...arguments),this.ControllerState=C2,this.transition={transitionDuration:300,transitionInterpolator:new Ec({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(t){t.position=t.position||[0,0,0];let r=this.props;super.setProps(t),(!r||r.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...t,...this.state}))}};var OS=class extends fl{constructor(t={}){super(t)}getViewportType(){return Uc}get ControllerType(){return p0}};OS.displayName="MapView";var ay=OS;var mxt=new Am;function Axt(e,t){let r=e.order??1/0,n=t.order??1/0;return r-n}var P2=class{constructor(t){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=t,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(t){let r=this._defaultEffects;if(!r.find(n=>n.id===t.id)){let n=r.findIndex(i=>Axt(i,t)>0);n<0?r.push(t):r.splice(n,0,t),t.setup(this._context),this._setEffects(this.effects)}}setProps(t){"effects"in t&&(Oi(t.effects,this.effects,1)||this._setEffects(t.effects))}needsRedraw(t={clearRedrawFlags:!1}){let r=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),r}getEffects(){return this._resolvedEffects}_setEffects(t){let r={};for(let i of this.effects)r[i.id]=i;let n=[];for(let i of t){let o=r[i.id],s=i;o&&o!==i?o.setProps?(o.setProps(i.props),s=o):o.cleanup(this._context):o||i.setup(this._context),n.push(s),delete r[i.id]}for(let i in r)r[i].cleanup(this._context);this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),t.some(i=>i instanceof Am)||this._resolvedEffects.push(mxt),this._needsRedraw="effects changed"}finalize(){for(let t of this._resolvedEffects)t.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}};var I2=class extends Oh{shouldDrawLayer(t){let{operation:r}=t.props;return r.includes("draw")||r.includes("terrain")}};var gxt="deckRenderer.renderLayers",d0=class{constructor(t){this.device=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new I2(t),this.pickLayersPass=new Yp(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){if(!t.viewports.length)return;let r=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...t};n.effects&&this._preRender(n.effects,n);let i=this.lastPostProcessEffect?this.renderBuffers[0]:n.target;this.lastPostProcessEffect&&(n.clearColor=[0,0,0,0],n.clearCanvas=!0);let o=r.render({...n,target:i});n.effects&&this._postRender(n.effects,n),this.renderCount++,qs(gxt,this,o,t)}needsRedraw(t={clearRedrawFlags:!1}){let r=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),r}finalize(){let{renderBuffers:t}=this;for(let r of t)r.delete();t.length=0}_preRender(t,r){this.lastPostProcessEffect=null,r.preRenderStats=r.preRenderStats||{};for(let n of t)r.preRenderStats[n.id]=n.preRender(r),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){let{renderBuffers:t}=this,r=this.device.canvasContext.getDrawingBufferSize();t.length===0&&[0,1].map(n=>{let i=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});t.push(this.device.createFramebuffer({id:`deck-renderbuffer-${n}`,colorAttachments:[i]}))});for(let n of t)n.resize(r)}_postRender(t,r){let{renderBuffers:n}=this,i={...r,inputBuffer:n[0],swapBuffer:n[1]};for(let o of t)if(o.postRender){i.target=o.id===this.lastPostProcessEffect?r.target:void 0;let s=o.postRender(i);i.inputBuffer=s,i.swapBuffer=s===n[0]?n[1]:n[0]}}};var _xt={pickedColor:null,pickedObjectIndex:-1};function qW({pickedColors:e,decodePickingColor:t,deviceX:r,deviceY:n,deviceRadius:i,deviceRect:o}){let{x:s,y:c,width:l,height:h}=o,p=i*i,x=-1,w=0;for(let E=0;E<h;E++){let P=E+c-n,B=P*P;if(B>p)w+=4*l;else for(let D=0;D<l;D++){if(e[w+3]-1>=0){let X=D+s-r,q=X*X+B;q<=p&&(p=q,x=w)}w+=4}}if(x>=0){let E=e.slice(x,x+4),P=t(E);if(P){let B=Math.floor(x/4/l),D=x/4-B*l;return{...P,pickedColor:E,pickedX:s+D,pickedY:c+B}}br.error("Picked non-existent layer. Is picking buffer corrupt?")()}return _xt}function GW({pickedColors:e,decodePickingColor:t}){let r=new Map;if(e){for(let n=0;n<e.length;n+=4)if(e[n+3]-1>=0){let o=e.slice(n,n+4),s=o.join(",");if(!r.has(s)){let c=t(o);c?r.set(s,{...c,color:o}):br.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(r.values())}function lD({pickInfo:e,viewports:t,pixelRatio:r,x:n,y:i,z:o}){let s=t[0];t.length>1&&(s=yxt(e?.pickedViewports||t,{x:n,y:i}));let c;if(s){let l=[n-s.x,i-s.y];o!==void 0&&(l[2]=o),c=s.unproject(l)}return{color:null,layer:null,viewport:s,index:-1,picked:!1,x:n,y:i,pixel:[n,i],coordinate:c,devicePixel:e&&"pickedX"in e?[e.pickedX,e.pickedY]:void 0,pixelRatio:r}}function XW(e){let{pickInfo:t,lastPickedInfo:r,mode:n,layers:i}=e,{pickedColor:o,pickedLayer:s,pickedObjectIndex:c}=t,l=s?[s]:[];if(n==="hover"){let x=r.index,w=r.layerId,E=s?s.props.id:null;if(E!==w||c!==x){if(E!==w){let P=i.find(B=>B.props.id===w);P&&l.unshift(P)}r.layerId=E,r.index=c,r.info=null}}let h=lD(e),p=new Map;return p.set(null,h),l.forEach(x=>{let w={...h};x===s&&(w.color=o,w.index=c,w.picked=!0),w=uD({layer:x,info:w,mode:n});let E=w.layer;x===s&&n==="hover"&&(r.info=w),p.set(E.id,w),n==="hover"&&E.updateAutoHighlight(w)}),p}function uD({layer:e,info:t,mode:r}){for(;e&&t;){let n=t.layer||null;t.sourceLayer=n,t.layer=e,t=e.getPickingInfo({info:t,mode:r,sourceLayer:n}),e=e.parent}return t}function yxt(e,t){for(let r=e.length-1;r>=0;r--){let n=e[r];if(n.containsPixel(t))return n}return e[0]}var R2=class{constructor(t){this._pickable=!0,this.device=t,this.pickLayersPass=new Yp(t),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject({x:t,y:r,layers:n,viewports:i},o=this.lastPickedInfo.info){let s=o&&o.layer&&o.layer.id,c=o&&o.viewport&&o.viewport.id,l=s?n.find(w=>w.id===s):null,h=c&&i.find(w=>w.id===c)||i[0],p=h&&h.unproject([t-h.x,r-h.y]);return{...o,...{x:t,y:r,viewport:h,coordinate:p,layer:l}}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){let r=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=r}let{canvas:t}=this.device.getDefaultCanvasContext();this.pickingFBO?.resize({width:t.width,height:t.height}),this.depthFBO?.resize({width:t.width,height:t.height})}_getPickable(t){if(this._pickable===!1)return null;let r=t.filter(n=>this.pickLayersPass.shouldDrawLayer(n)&&!n.isComposite);return r.length?r:null}_pickClosestObject({layers:t,views:r,viewports:n,x:i,y:o,radius:s=0,depth:c=1,mode:l="query",unproject3D:h,onViewportActive:p,effects:x}){let w=this.device.canvasContext.cssToDeviceRatio(),E=this._getPickable(t);if(!E||n.length===0)return{result:[],emptyInfo:lD({viewports:n,x:i,y:o,pixelRatio:w})};this._resizeBuffer();let P=this.device.canvasContext.cssToDevicePixels([i,o],!0),B=[P.x+Math.floor(P.width/2),P.y+Math.floor(P.height/2)],D=Math.round(s*w),{width:W,height:X}=this.pickingFBO,q=this._getPickingRect({deviceX:B[0],deviceY:B[1],deviceRadius:D,deviceWidth:W,deviceHeight:X}),$={x:i-s,y:o-s,width:s*2+1,height:s*2+1},et,F=[],ut=new Set;for(let ot=0;ot<c;ot++){let J;if(q){let mt=this._drawAndSample({layers:E,views:r,viewports:n,onViewportActive:p,deviceRect:q,cullRect:$,effects:x,pass:`picking:${l}`});J=qW({...mt,deviceX:B[0],deviceY:B[1],deviceRadius:D,deviceRect:q})}else J={pickedColor:null,pickedObjectIndex:-1};let G;if(J.pickedLayer&&h&&this.depthFBO){let{pickedColors:mt}=this._drawAndSample({layers:[J.pickedLayer],views:r,viewports:n,onViewportActive:p,deviceRect:{x:J.pickedX,y:J.pickedY,width:1,height:1},cullRect:$,effects:x,pass:`picking:${l}:z`},!0);mt[3]&&(G=mt[0])}J.pickedLayer&&ot+1<c&&(ut.add(J.pickedLayer),J.pickedLayer.disablePickingIndex(J.pickedObjectIndex)),et=XW({pickInfo:J,lastPickedInfo:this.lastPickedInfo,mode:l,layers:E,viewports:n,x:i,y:o,z:G,pixelRatio:w});for(let mt of et.values())mt.layer&&F.push(mt);if(!J.pickedColor)break}for(let ot of ut)ot.restorePickingColors();return{result:F,emptyInfo:et.get(null)}}_pickVisibleObjects({layers:t,views:r,viewports:n,x:i,y:o,width:s=1,height:c=1,mode:l="query",maxObjects:h=null,onViewportActive:p,effects:x}){let w=this._getPickable(t);if(!w||n.length===0)return[];this._resizeBuffer();let E=this.device.canvasContext.cssToDeviceRatio(),P=this.device.canvasContext.cssToDevicePixels([i,o],!0),B=P.x,D=P.y+P.height,W=this.device.canvasContext.cssToDevicePixels([i+s,o+c],!0),X=W.x+W.width,q=W.y,$={x:B,y:q,width:X-B,height:D-q},et=this._drawAndSample({layers:w,views:r,viewports:n,onViewportActive:p,deviceRect:$,cullRect:{x:i,y:o,width:s,height:c},effects:x,pass:`picking:${l}`}),F=GW(et),ut=new Map,ot=[],J=Number.isFinite(h);for(let G=0;G<F.length&&!(J&&ot.length>=h);G++){let mt=F[G],Mt={color:mt.pickedColor,layer:null,index:mt.pickedObjectIndex,picked:!0,x:i,y:o,pixelRatio:E};Mt=uD({layer:mt.pickedLayer,info:Mt,mode:l});let ct=Mt.layer.id;ut.has(ct)||ut.set(ct,new Set);let gt=ut.get(ct),ee=Mt.object??Mt.index;gt.has(ee)||(gt.add(ee),ot.push(Mt))}return ot}_drawAndSample({layers:t,views:r,viewports:n,onViewportActive:i,deviceRect:o,cullRect:s,effects:c,pass:l},h=!1){let p=h?this.depthFBO:this.pickingFBO,x={layers:t,layerFilter:this.layerFilter,views:r,viewports:n,onViewportActive:i,pickingFBO:p,deviceRect:o,cullRect:s,effects:c,pass:l,pickZ:h,preRenderStats:{}};for(let X of c)X.useInPicking&&(x.preRenderStats[X.id]=X.preRender(x));let{decodePickingColor:w}=this.pickLayersPass.render(x),{x:E,y:P,width:B,height:D}=o,W=new(h?Float32Array:Uint8Array)(B*D*4);return this.device.readPixelsToArrayWebGL(p,{sourceX:E,sourceY:P,sourceWidth:B,sourceHeight:D,target:W}),{pickedColors:W,decodePickingColor:w}}_getPickingRect({deviceX:t,deviceY:r,deviceRadius:n,deviceWidth:i,deviceHeight:o}){let s=Math.max(0,t-n),c=Math.max(0,r-n),l=Math.min(i,t+n+1)-s,h=Math.min(o,r+n+1)-c;return l<=0||h<=0?null:{x:s,y:c,width:l,height:h}}};var xxt={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},vxt="top-left",YW="__root",BS=class{constructor({deck:t,parentElement:r}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=t,this.parentElement=r}getWidgets(){return this.resolvedWidgets}setProps(t){t.widgets&&!Oi(t.widgets,this.widgets,1)&&this._setWidgets(t.widgets)}finalize(){for(let t of this.getWidgets())this._remove(t);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(let t in this.containers)this.containers[t].remove()}addDefault(t){this.defaultWidgets.find(r=>r.id===t.id)||(this._add(t),this.defaultWidgets.push(t),this._setWidgets(this.widgets))}_setWidgets(t){let r={};for(let n of this.resolvedWidgets)r[n.id]=n;this.resolvedWidgets.length=0;for(let n of this.defaultWidgets)r[n.id]=null,this.resolvedWidgets.push(n);for(let n of t){let i=r[n.id];i?i.viewId!==n.viewId||i.placement!==n.placement?(this._remove(i),this._add(n)):n!==i&&(i.setProps(n.props),n=i):this._add(n),r[n.id]=null,this.resolvedWidgets.push(n)}for(let n in r){let i=r[n];i&&this._remove(i)}this.widgets=t}_add(t){let{viewId:r=null,placement:n=vxt}=t,i=t.onAdd({deck:this.deck,viewId:r});i&&this._getContainer(r,n).append(i),t._element=i}_remove(t){t.onRemove?.(),t._element&&t._element.remove(),t._element=void 0}_getContainer(t,r){let n=t||YW,i=this.containers[n];i||(i=document.createElement("div"),i.style.pointerEvents="none",i.style.position="absolute",i.style.overflow="hidden",this.parentElement?.append(i),this.containers[n]=i);let o=i.querySelector(`.${r}`);return o||(o=document.createElement("div"),o.className=r,o.style.position="absolute",o.style.zIndex="2",Object.assign(o.style,xxt[r]),i.append(o)),o}_updateContainers(){let t=this.deck.width,r=this.deck.height;for(let n in this.containers){let i=this.lastViewports[n]||null,o=n===YW||i,s=this.containers[n];o?(s.style.display="block",s.style.left=`${i?i.x:0}px`,s.style.top=`${i?i.y:0}px`,s.style.width=`${i?i.width:t}px`,s.style.height=`${i?i.height:r}px`):s.style.display="none"}}onRedraw({viewports:t,layers:r}){let n=t.reduce((i,o)=>(i[o.id]=o,i),{});for(let i of this.getWidgets()){let{viewId:o}=i;if(o){let s=n[o];s&&(i.onViewportChange&&i.onViewportChange(s),i.onRedraw?.({viewports:[s],layers:r}))}else{if(i.onViewportChange)for(let s of t)i.onViewportChange(s);i.onRedraw?.({viewports:t,layers:r})}}this.lastViewports=n,this._updateContainers()}onHover(t,r){for(let n of this.getWidgets()){let{viewId:i}=n;(!i||i===t.viewport?.id)&&n.onHover?.(t,r)}}onEvent(t,r){let n=s2[r.type];if(n)for(let i of this.getWidgets()){let{viewId:o}=i;(!o||o===t.viewport?.id)&&i[n]?.(t,r)}}};var bxt={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"},L2=class{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd({deck:t}){let r=document.createElement("div");return r.className="deck-tooltip",Object.assign(r.style,bxt),this.deck=t,this.element=r,r}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(t){this.isVisible&&t.id===this.lastViewport?.id&&t!==this.lastViewport&&this.setTooltip(null)}onHover(t){let{deck:r}=this,n=r&&r.props.getTooltip;if(!n)return;let i=n(t);this.lastViewport=t.viewport,this.setTooltip(i,t.x,t.y)}setTooltip(t,r,n){let i=this.element;if(i){if(typeof t=="string")i.innerText=t;else if(t)t.text&&(i.innerText=t.text),t.html&&(i.innerHTML=t.html),t.className&&(i.className=t.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform=`translate(${r}px, ${n}px)`,t&&typeof t=="object"&&"style"in t&&Object.assign(i.style,t.style)}}};function xm(){}var wxt=({isDragging:e})=>e?"grabbing":"grab",KW={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{type:"webgl"},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:xm,onWebGLInitialized:xm,onResize:xm,onViewStateChange:xm,onInteractionStateChange:xm,onBeforeRender:xm,onAfterRender:xm,onLoad:xm,onError:e=>br.error(e.message,e.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:wxt,getTooltip:null,debug:!1,drawPickingColors:!1},O2=class{constructor(t){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new Nc({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=n=>{let{_pickRequest:i}=this;if(n.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(n.leftButton||n.rightButton)return;{let o=n.offsetCenter;if(!o)return;i.x=o.x,i.y=o.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=n},this._onEvent=n=>{let i=s2[n.type],o=n.offsetCenter;if(!i||!o||!this.layerManager)return;let s=this.layerManager.getLayers(),c=this.deckPicker.getLastPickedObject({x:o.x,y:o.y,layers:s,viewports:this.getViewports(o)},this._lastPointerDownInfo),{layer:l}=c,h=l&&(l[i]||l.props[i]),p=this.props[i],x=!1;h&&(x=h.call(l,c,n)),x||(p?.(c,n),this.widgetManager.onEvent(c,n))},this._onPointerDown=n=>{let i=n.offsetCenter,o=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=o.result[0]||o.emptyInfo},this.props={...KW,...t},t=this.props,t.viewState&&t.initialViewState&&br.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,t.device&&(this.device=t.device);let r=this.device;!r&&t.gl&&(t.gl instanceof WebGLRenderingContext&&br.error("WebGL1 context not supported.")(),r=pM.attach(t.gl)),r||(r=Rf.createDevice({type:"best-available",adapters:[pM],...t.deviceProps,createCanvasContext:{canvas:this._createCanvas(t),useDevicePixels:this.props.useDevicePixels,autoResize:!1}})),this.animationLoop=this._createAnimationLoop(r,t),this.setProps(t),t._typedArrayManagerProps&&Bh.setOptions(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&br.removed("onLayerHover","onHover")(),"onLayerClick"in t&&br.removed("onLayerClick","onClick")(),t.initialViewState&&!Oi(this.props.initialViewState,t.initialViewState,3)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);let r=Object.create(this.props);Object.assign(r,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop?.setProps(r),this.layerManager&&(this.viewManager.setProps(r),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(r),this.effectManager.setProps(r),this.deckRenderer.setProps(r),this.deckPicker.setProps(r),this.widgetManager.setProps(r)),this.stats.get("setProps Time").timeEnd()}needsRedraw(t={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let r=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);let n=this.viewManager.needsRedraw(t),i=this.layerManager.needsRedraw(t),o=this.effectManager.needsRedraw(t),s=this.deckRenderer.needsRedraw(t);return r=r||n||i||o||s,r}redraw(t){if(!this.layerManager)return;let r=this.needsRedraw({clearRedrawFlags:!0});r=t||r,r&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(r):this._drawLayers(r))}get isInitialized(){return this.viewManager!==null}getViews(){return $o(this.viewManager),this.viewManager.views}getViewports(t){return $o(this.viewManager),this.viewManager.getViewports(t)}getCanvas(){return this.canvas}pickObject(t){let r=this._pick("pickObject","pickObject Time",t).result;return r.length?r[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t,r=!1){for(let n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:r})}_removeResources(t){for(let r of t)this.layerManager.resourceManager.remove(r)}_addDefaultEffect(t){this.effectManager.addDefaultEffect(t)}_addDefaultShaderModule(t){this.layerManager.addDefaultShaderModule(t)}_removeDefaultShaderModule(t){this.layerManager?.removeDefaultShaderModule(t)}_pick(t,r,n){$o(this.deckPicker);let{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(r).timeStart();let o=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(r).timeEnd(),o}_createCanvas(t){let r=t.canvas;return typeof r=="string"&&(r=document.getElementById(r),$o(r)),r||(r=document.createElement("canvas"),r.id=t.id||"deckgl-overlay",(t.parent||document.body).appendChild(r)),Object.assign(r.style,t.style),r}_setCanvasSize(t){if(!this.canvas)return;let{width:r,height:n}=t;if(r||r===0){let i=Number.isFinite(r)?`${r}px`:r;this.canvas.style.width=i}if(n||n===0){let i=Number.isFinite(n)?`${n}px`:n;this.canvas.style.position=t.style?.position||"absolute",this.canvas.style.height=i}}_updateCanvasSize(){let{canvas:t}=this;if(!t)return;let r=t.clientWidth??t.width,n=t.clientHeight??t.height;(r!==this.width||n!==this.height)&&(this.width=r,this.height=n,this.viewManager?.setProps({width:r,height:n}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:n}))}_createAnimationLoop(t,r){let{gl:n,onError:i,useDevicePixels:o}=r;return new A2({device:t,useDevicePixels:o,autoResizeDrawingBuffer:!n,autoResizeViewport:!1,onInitialize:s=>this._setDevice(s.device),onRender:this._onRenderFrame.bind(this),onError:i})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let{views:t}=this.props,r=Array.isArray(t)?t:t?[t]:[new ay({id:"default-view"})];return r.length&&this.props.controller&&(r[0].props.controller=this.props.controller),r}_onContextLost(){let{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_pickAndCallback(){let{_pickRequest:t}=this;if(t.event){let{result:r,emptyInfo:n}=this._pick("pickObject","pickObject Time",t);this.cursorState.isHovering=r.length>0;let i=n,o=!1;for(let s of r)i=s,o=s.layer?.onHover(s,t.event)||o;o||(this.props.onHover?.(i,t.event),this.widgetManager.onHover(i,t.event)),t.event=null}}_updateCursor(){let t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(t){if(this.device=t,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas),this.device instanceof Na&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device instanceof Na&&this.props.onWebGLInitialized(this.device.gl);let r=new l0;r.play(),this.animationLoop.attachTimeline(r),this.eventManager=new o2(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(W4).map(i=>{let[o,s,c,l]=W4[i],h=this.props.eventRecognizerOptions?.[i],p={...s,...h,event:i};return{recognizer:new o(p),recognizeWith:c,requestFailure:l}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(let i in s2)this.eventManager.on(i,this._onEvent);this.viewManager=new E2({timeline:r,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});let n=this.viewManager.getViewports()[0];this.layerManager=new h0(this.device,{deck:this,stats:this.stats,viewport:n,timeline:r}),this.effectManager=new P2({deck:this,device:this.device}),this.deckRenderer=new d0(this.device),this.deckPicker=new R2(this.device),this.widgetManager=new BS({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new L2),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,r){let{device:n,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:n,gl:i});let o={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...r};this.deckRenderer?.renderLayers(o),o.pass==="screen"&&this.widgetManager.onRedraw({viewports:o.viewports,layers:o.layers}),this.props.onAfterRender({device:n,gl:i})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),br.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){let r=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:r},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.cursorState.isDragging=t.isDragging||!1,this.props.onInteractionStateChange(t)}_getFrameStats(){let{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();let r=this.animationLoop.stats;t.get("GPU Time").addTime(r.get("GPU Time").lastTiming),t.get("CPU Time").addTime(r.get("CPU Time").lastTiming)}_getMetrics(){let{metrics:t,stats:r}=this;t.fps=r.get("frameRate").getHz(),t.setPropsTime=r.get("setProps Time").time,t.updateAttributesTime=r.get("Update Attributes").time,t.framesRedrawn=r.get("Redraw Count").count,t.pickTime=r.get("pickObject Time").time+r.get("pickMultipleObjects Time").time+r.get("pickObjects Time").time,t.pickCount=r.get("Pick Count").count,t.gpuTime=r.get("GPU Time").time,t.cpuTime=r.get("CPU Time").time,t.gpuTimePerFrame=r.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=r.get("CPU Time").getAverageTime();let n=Rf.stats.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}};O2.defaultProps=KW;O2.VERSION=gM;var cy=O2;function ZW(e){switch(e){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return Mv(e)}}var $W=GE;function B2(e,t){return{attribute:e,format:t.size>1?`${t.type}x${t.size}`:t.type,byteOffset:t.offset||0}}function vm(e){return e.stride||e.size*e.bytesPerElement}function QW(e,t){return e.type===t.type&&e.size===t.size&&vm(e)===vm(t)&&(e.offset||0)===(t.offset||0)}function hD(e,t){t.offset&&br.removed("shaderAttribute.offset","vertexOffset, elementOffset")();let r=vm(e),n=t.vertexOffset!==void 0?t.vertexOffset:e.vertexOffset||0,i=t.elementOffset||0,o=n*r+i*e.bytesPerElement+(e.offset||0);return{...t,offset:o,stride:r}}function Txt(e,t){let r=hD(e,t);return{high:r,low:{...r,offset:r.offset+e.size*4}}}var D2=class{constructor(t,r,n){this._buffer=null,this.device=t,this.id=r.id||"",this.size=r.size||1;let i=r.logicalType||r.type,o=i==="float64",{defaultValue:s}=r;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0);let c;o?c="float32":!i&&r.isIndexed?c="uint32":c=i||"float32";let l=ZW(i||c);this.doublePrecision=o,o&&r.fp64===!1&&(l=Float32Array),this.value=null,this.settings={...r,defaultType:l,defaultValue:s,logicalType:i,type:c,normalized:c.includes("norm"),size:this.size,bytesPerElement:l.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){let t=this.getAccessor();return t.vertexOffset?t.vertexOffset*vm(t):0}get numInstances(){return this.state.numInstances}set numInstances(t){this.state.numInstances=t}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Bh.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(t=this.id,r=null){let n={};if(this.state.constant){let i=this.value;if(r){let o=hD(this.getAccessor(),r),s=o.offset/i.BYTES_PER_ELEMENT,c=o.size||this.size;n[t]=i.subarray(s,s+c)}else n[t]=i}else n[t]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?n[`${t}64Low`]=n[t]:n[`${t}64Low`]=new Float32Array(this.size)),n}_getBufferLayout(t=this.id,r=null){let n=this.getAccessor(),i=[],o={name:this.id,byteStride:vm(n),attributes:i};if(this.doublePrecision){let s=Txt(n,r||{});i.push(B2(t,{...n,...s.high}),B2(`${t}64Low`,{...n,...s.low}))}else if(r){let s=hD(n,r);i.push(B2(t,{...n,...s}))}else i.push(B2(t,n));return o}setAccessor(t){this.state.bufferAccessor=t}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let t=null;if(this.state.constant&&this.value){let r=Array.from(this.value);t=[r,r]}else{let{value:r,numInstances:n,size:i}=this,o=n*i;if(r&&o&&r.length>=o){let s=new Array(i).fill(1/0),c=new Array(i).fill(-1/0);for(let l=0;l<o;)for(let h=0;h<i;h++){let p=r[l++];p<s[h]&&(s[h]=p),p>c[h]&&(c[h]=p)}t=[s,c]}}return this.state.bounds=t,t}setData(t){let{state:r}=this,n;ArrayBuffer.isView(t)?n={value:t}:t instanceof Vn?n={buffer:t}:n=t;let i={...this.settings,...n};if(ArrayBuffer.isView(n.value)){if(!n.type)if(this.doublePrecision&&n.value instanceof Float64Array)i.type="float32";else{let s=$W(n.value);i.type=i.normalized?s.replace("int","norm"):s}i.bytesPerElement=n.value.BYTES_PER_ELEMENT,i.stride=vm(i)}if(r.bounds=null,n.constant){let o=n.value;if(o=this._normalizeValue(o,[],0),this.settings.normalized&&(o=this.normalizeConstant(o)),!(!r.constant||!this._areValuesEqual(o,this.value)))return!1;r.externalBuffer=null,r.constant=!0,this.value=ArrayBuffer.isView(o)?o:new Float32Array(o)}else if(n.buffer){let o=n.buffer;r.externalBuffer=o,r.constant=!1,this.value=n.value||null}else if(n.value){this._checkExternalBuffer(n);let o=n.value;r.externalBuffer=null,r.constant=!1,this.value=o;let{buffer:s}=this,c=vm(i),l=(i.vertexOffset||0)*c;if(this.doublePrecision&&o instanceof Float64Array&&(o=vS(o,i)),this.settings.isIndexed){let p=this.settings.defaultType;o.constructor!==p&&(o=new p(o))}let h=o.byteLength+l+c*2;(!s||s.byteLength<h)&&(s=this._createBuffer(h)),s.write(o,l)}return this.setAccessor(i),!0}updateSubBuffer(t={}){this.state.bounds=null;let r=this.value,{startOffset:n=0,endOffset:i}=t;this.buffer.write(this.doublePrecision&&r instanceof Float64Array?vS(r,{size:this.size,startIndex:n,endIndex:i}):r.subarray(n,i),n*r.BYTES_PER_ELEMENT+this.byteOffset)}allocate(t,r=!1){let{state:n}=this,i=n.allocatedValue,o=Bh.allocate(i,t+1,{size:this.size,type:this.settings.defaultType,copy:r});this.value=o;let{byteOffset:s}=this,{buffer:c}=this;return(!c||c.byteLength<o.byteLength+s)&&(c=this._createBuffer(o.byteLength+s),r&&i&&c.write(i instanceof Float64Array?vS(i,this):i,s)),n.allocatedValue=o,n.constant=!1,n.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(t){let{value:r}=t;if(!ArrayBuffer.isView(r))throw new Error(`Attribute ${this.id} value is not TypedArray`);let n=this.settings.defaultType,i=!1;if(this.doublePrecision&&(i=r.BYTES_PER_ELEMENT<4),i)throw new Error(`Attribute ${this.id} does not support ${r.constructor.name}`);!(r instanceof n)&&this.settings.normalized&&!("normalized"in t)&&br.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(t){switch(this.settings.type){case"snorm8":return new Float32Array(t).map(r=>(r+128)/255*2-1);case"snorm16":return new Float32Array(t).map(r=>(r+32768)/65535*2-1);case"unorm8":return new Float32Array(t).map(r=>r/255);case"unorm16":return new Float32Array(t).map(r=>r/65535);default:return t}}_normalizeValue(t,r,n){let{defaultValue:i,size:o}=this.settings;if(Number.isFinite(t))return r[n]=t,r;if(!t){let s=o;for(;--s>=0;)r[n+s]=i[s];return r}switch(o){case 4:r[n+3]=Number.isFinite(t[3])?t[3]:i[3];case 3:r[n+2]=Number.isFinite(t[2])?t[2]:i[2];case 2:r[n+1]=Number.isFinite(t[1])?t[1]:i[1];case 1:r[n+0]=Number.isFinite(t[0])?t[0]:i[0];break;default:let s=o;for(;--s>=0;)r[n+s]=Number.isFinite(t[s])?t[s]:i[s]}return r}_areValuesEqual(t,r){if(!t||!r)return!1;let{size:n}=this;for(let i=0;i<n;i++)if(t[i]!==r[i])return!1;return!0}_createBuffer(t){this._buffer&&this._buffer.destroy();let{isIndexed:r,type:n}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:r?Vn.INDEX:Vn.VERTEX,indexType:r?n:void 0,byteLength:t}),this._buffer}};var JW=[],tq=[];function Xs(e,t=0,r=1/0){let n=JW,i={index:-1,data:e,target:[]};return e?typeof e[Symbol.iterator]=="function"?n=e:e.length>0&&(tq.length=e.length,n=tq):n=JW,(t>0||Number.isFinite(r))&&(n=(Array.isArray(n)?n:Array.from(n)).slice(t,r),i.index=t-1),{iterable:n,objectInfo:i}}function DS(e){return e&&e[Symbol.asyncIterator]}function NS(e,t){let{size:r,stride:n,offset:i,startIndices:o,nested:s}=t,c=e.BYTES_PER_ELEMENT,l=n?n/c:r,h=i?i/c:0,p=Math.floor((e.length-h)/l);return(x,{index:w,target:E})=>{if(!o){let W=w*l+h;for(let X=0;X<r;X++)E[X]=e[W+X];return E}let P=o[w],B=o[w+1]||p,D;if(s){D=new Array(B-P);for(let W=P;W<B;W++){let X=W*l+h;E=new Array(r);for(let q=0;q<r;q++)E[q]=e[X+q];D[W-P]=E}}else if(l===r)D=e.subarray(P*r+h,B*r+h);else{D=new e.constructor((B-P)*r);let W=0;for(let X=P;X<B;X++){let q=X*l+h;for(let $=0;$<r;$++)D[W++]=e[q+$]}}return D}}var eq=[],N2=[[0,1/0]];function rq(e,t){if(e===N2||(t[0]<0&&(t[0]=0),t[0]>=t[1]))return e;let r=[],n=e.length,i=0;for(let o=0;o<n;o++){let s=e[o];s[1]<t[0]?(r.push(s),i=o+1):s[0]>t[1]?r.push(s):t=[Math.min(s[0],t[0]),Math.max(s[1],t[1])]}return r.splice(i,0,t),r}var Mxt={interpolation:{duration:0,easing:e=>e},spring:{stiffness:.05,damping:.5}};function kS(e,t){if(!e)return null;Number.isFinite(e)&&(e={type:"interpolation",duration:e});let r=e.type||"interpolation";return{...Mxt[r],...t,...e,type:r}}var td=class extends D2{constructor(t,r){super(t,r,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:N2}),this.constant=!1,this.settings.update=r.update||(r.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){let r=this.state.needsRedraw;return this.state.needsRedraw=r&&!t,r}layoutChanged(){return this.state.layoutChanged}setAccessor(t){var r;(r=this.state).layoutChanged||(r.layoutChanged=!QW(t,this.getAccessor())),super.setAccessor(t)}getUpdateTriggers(){let{accessor:t}=this.settings;return[this.id].concat(typeof t!="function"&&t||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;let{accessor:r}=this.settings,n=this.settings.transition,i=Array.isArray(r)?t[r.find(o=>t[o])]:t[r];return kS(i,n)}setNeedsUpdate(t=this.id,r){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),r){let{startRow:n=0,endRow:i=1/0}=r;this.state.updateRanges=rq(this.state.updateRanges,[n,i])}else this.state.updateRanges=N2}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=eq}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}allocate(t){let{state:r,settings:n}=this;return n.noAlloc?!1:n.update?(super.allocate(t,r.updateRanges!==N2),!0):!1}updateBuffer({numInstances:t,data:r,props:n,context:i}){if(!this.needsUpdate())return!1;let{state:{updateRanges:o},settings:{update:s,noAlloc:c}}=this,l=!0;if(s){for(let[h,p]of o)s.call(i,this,{data:r,startRow:h,endRow:p,props:n,numInstances:t});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(let[h,p]of o){let x=Number.isFinite(h)?this.getVertexOffset(h):0,w=Number.isFinite(p)?this.getVertexOffset(p):c||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:x,endOffset:w})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(t){return t===void 0||typeof t=="function"?!1:(this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(t){let{state:r}=this;return t?(this.clearNeedsUpdate(),r.lastExternalBuffer===t||(r.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(r.lastExternalBuffer=null,!1)}setBinaryValue(t,r=null){let{state:n,settings:i}=this;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;if(n.binaryValue=t,this.setNeedsRedraw(),i.transform||r!==this.startIndices){ArrayBuffer.isView(t)&&(t={value:t});let s=t;$o(ArrayBuffer.isView(s.value),`invalid ${i.accessor}`);let c=Boolean(s.size)&&s.size!==this.size;return n.binaryAccessor=NS(s.value,{size:s.size||this.size,stride:s.stride,offset:s.offset,startIndices:r,nested:c}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){let{startIndices:r}=this;return(r?t<r.length?r[t]:this.numInstances:t)*this.size}getValue(){let t=this.settings.shaderAttributes,r=super.getValue();if(!t)return r;for(let n in t)Object.assign(r,super.getValue(n,t[n]));return r}getBufferLayout(t){this.state.layoutChanged=!1;let r=this.settings.shaderAttributes,n=super._getBufferLayout(),{stepMode:i}=this.settings;if(i==="dynamic"?n.stepMode=t?t.isInstanced?"instance":"vertex":"instance":n.stepMode=i??"vertex",!r)return n;for(let o in r){let s=super._getBufferLayout(o,r[o]);n.attributes.push(...s.attributes)}return n}_autoUpdater(t,{data:r,startRow:n,endRow:i,props:o,numInstances:s}){if(t.constant)return;let{settings:c,state:l,value:h,size:p,startIndices:x}=t,{accessor:w,transform:E}=c,P=l.binaryAccessor||(typeof w=="function"?w:o[w]);$o(typeof P=="function",`accessor "${w}" is not a function`);let B=t.getVertexOffset(n),{iterable:D,objectInfo:W}=Xs(r,n,i);for(let X of D){W.index++;let q=P(X,W);if(E&&(q=E.call(this,q)),x){let $=(W.index<x.length-1?x[W.index+1]:s)-x[W.index];if(q&&Array.isArray(q[0])){let et=B;for(let F of q)t._normalizeValue(F,h,et),et+=p}else q&&q.length>p?h.set(q,B):(t._normalizeValue(q,W.target,0),RS({target:h,source:W.target,start:B,count:$}));B+=$*p}else t._normalizeValue(q,h,B),B+=p}}_validateAttributeUpdaters(){let{settings:t}=this;if(!(t.noAlloc||typeof t.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){let{value:t}=this,r=Math.min(4,this.size);if(t&&t.length>=r){let n=!0;switch(r){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error(`Illegal attribute generated for ${this.id}`)}}};function fD(e){let{source:t,target:r,start:n=0,size:i,getData:o}=e,s=e.end||r.length,c=t.length,l=s-n;if(c>l){r.set(t.subarray(0,l),n);return}if(r.set(t,n),!o)return;let h=c;for(;h<l;){let p=o(h,t);for(let x=0;x<i;x++)r[n+h]=p[x]||0,h++}}function nq({source:e,target:t,size:r,getData:n,sourceStartIndices:i,targetStartIndices:o}){if(!i||!o)return fD({source:e,target:t,size:r,getData:n}),t;let s=0,c=0,l=n&&((p,x)=>n(p+c,x)),h=Math.min(i.length,o.length);for(let p=1;p<h;p++){let x=i[p]*r,w=o[p]*r;fD({source:e.subarray(s,x),target:t,start:c,end:w,size:r,getData:l}),s=x,c=w}return c<t.length&&fD({source:[],target:t,start:c,size:r,getData:l}),t}function iq(e){let{device:t,settings:r,value:n}=e,i=new td(t,r);return i.setData({value:n instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:r.normalized}),i}function FS(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${e}"`)}}function zS(e){switch(e){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function US(e){e.push(e.shift())}function oq(e,t){let{doublePrecision:r,settings:n,value:i,size:o}=e,s=r&&i instanceof Float64Array?2:1,c=0,{shaderAttributes:l}=e.settings;if(l)for(let h of Object.values(l))c=Math.max(c,h.vertexOffset??0);return(n.noAlloc?i.length:(t+c)*o)*s}function VS({device:e,source:t,target:r}){return(!r||r.byteLength<t.byteLength)&&(r?.destroy(),r=e.createBuffer({byteLength:t.byteLength,usage:t.usage})),r}function jS({device:e,buffer:t,attribute:r,fromLength:n,toLength:i,fromStartIndices:o,getData:s=c=>c}){let c=r.doublePrecision&&r.value instanceof Float64Array?2:1,l=r.size*c,h=r.byteOffset,p=r.settings.bytesPerElement<4?h/r.settings.bytesPerElement*4:h,x=r.startIndices,w=o&&x,E=r.isConstant;if(!w&&t&&n>=i)return t;let P=r.value instanceof Float64Array?Float32Array:r.value.constructor,B=E?r.value:new P(r.getBuffer().readSyncWebGL(h,i*P.BYTES_PER_ELEMENT).buffer);if(r.settings.normalized&&!E){let q=s;s=($,et)=>r.normalizeConstant(q($,et))}let D=E?(q,$)=>s(B,$):(q,$)=>s(B.subarray(q+h,q+h+l),$),W=t?new Float32Array(t.readSyncWebGL(p,n*4).buffer):new Float32Array(0),X=new Float32Array(i);return nq({source:W,target:X,sourceStartIndices:o,targetStartIndices:x,size:l,getData:D}),(!t||t.byteLength<X.byteLength+p)&&(t?.destroy(),t=e.createBuffer({byteLength:X.byteLength+p,usage:35050})),t.write(X,p),t}var ly=class{constructor({device:t,attribute:r,timeline:n}){this.buffers=[],this.currentLength=0,this.device=t,this.transition=new Nh(n),this.attribute=r,this.attributeInTransition=iq(r),this.currentStartIndices=r.startIndices}get inProgress(){return this.transition.inProgress}start(t,r,n=1/0){this.settings=t,this.currentStartIndices=this.attribute.startIndices,this.currentLength=oq(this.attribute,r),this.transition.start({...t,duration:n})}update(){let t=this.transition.update();return t&&this.onUpdate(),t}setBuffer(t){this.attributeInTransition.setData({buffer:t,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(let t of this.buffers)t.destroy();this.buffers.length=0}};var k2=class extends ly{constructor({device:t,attribute:r,timeline:n}){super({device:t,attribute:r,timeline:n}),this.type="interpolation",this.transform=Ixt(t,r)}start(t,r){let n=this.currentLength,i=this.currentStartIndices;if(super.start(t,r,t.duration),t.duration<=0){this.transition.cancel();return}let{buffers:o,attribute:s}=this;US(o),o[0]=jS({device:this.device,buffer:o[0],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:i,getData:t.enter}),o[1]=VS({device:this.device,source:o[0],target:o[1]}),this.setBuffer(o[1]);let{transform:c}=this,l=c.model,h=Math.floor(this.currentLength/s.size);aq(s)&&(h/=2),l.setVertexCount(h),s.isConstant?(l.setAttributes({aFrom:o[0]}),l.setConstantAttributes({aTo:s.value})):l.setAttributes({aFrom:o[0],aTo:s.getBuffer()}),c.transformFeedback.setBuffers({vCurrent:o[1]})}onUpdate(){let{duration:t,easing:r}=this.settings,{time:n}=this.transition,i=n/t;r&&(i=r(i));let{model:o}=this.transform,s={time:i};o.shaderInputs.setProps({interpolation:s}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}},Sxt=`uniform interpolationUniforms {
  float time;
} interpolation;
`,sq={name:"interpolation",vs:Sxt,uniformTypes:{time:"f32"}},Cxt=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, interpolation.time);
  gl_Position = vec4(0.0);
}
`,Pxt=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function aq(e){return e.doublePrecision&&e.value instanceof Float64Array}function Ixt(e,t){let r=t.size,n=FS(r),i=zS(r),o=t.getBufferLayout();return aq(t)?new uu(e,{vs:Pxt,bufferLayout:[{name:"aFrom",byteStride:8*r,attributes:[{attribute:"aFrom",format:i,byteOffset:0},{attribute:"aFrom64Low",format:i,byteOffset:4*r}]},{name:"aTo",byteStride:8*r,attributes:[{attribute:"aTo",format:i,byteOffset:0},{attribute:"aTo64Low",format:i,byteOffset:4*r}]}],modules:[C4,sq],defines:{ATTRIBUTE_TYPE:n,ATTRIBUTE_SIZE:r},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new uu(e,{vs:Cxt,bufferLayout:[{name:"aFrom",format:i},{name:"aTo",format:o.attributes[0].format}],modules:[sq],defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"],disableWarnings:!0})}var F2=class extends ly{constructor({device:t,attribute:r,timeline:n}){super({device:t,attribute:r,timeline:n}),this.type="spring",this.texture=Nxt(t),this.framebuffer=kxt(t,this.texture),this.transform=Dxt(t,r)}start(t,r){let n=this.currentLength,i=this.currentStartIndices;super.start(t,r);let{buffers:o,attribute:s}=this;for(let l=0;l<2;l++)o[l]=jS({device:this.device,buffer:o[l],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:i,getData:t.enter});o[2]=VS({device:this.device,source:o[0],target:o[2]}),this.setBuffer(o[1]);let{model:c}=this.transform;c.setVertexCount(Math.floor(this.currentLength/s.size)),s.isConstant?c.setConstantAttributes({aTo:s.value}):c.setAttributes({aTo:s.getBuffer()})}onUpdate(){let{buffers:t,transform:r,framebuffer:n,transition:i}=this,o=this.settings;r.model.setAttributes({aPrev:t[0],aCur:t[1]}),r.transformFeedback.setBuffers({vNext:t[2]});let s={stiffness:o.stiffness,damping:o.damping};r.model.shaderInputs.setProps({spring:s}),r.run({framebuffer:n,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),US(t),this.setBuffer(t[1]),this.device.readPixelsToArrayWebGL(n)[0]>0||i.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}},Rxt=`uniform springUniforms {
  float damping;
  float stiffness;
} spring;
`,Lxt={name:"spring",vs:Rxt,uniformTypes:{damping:"f32",stiffness:"f32"}},Oxt=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE force = delta * spring.stiffness;
  ATTRIBUTE_TYPE resistance = velocity * spring.damping;
  return force - resistance + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,Bxt=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function Dxt(e,t){let r=FS(t.size),n=zS(t.size);return new uu(e,{vs:Oxt,fs:Bxt,bufferLayout:[{name:"aPrev",format:n},{name:"aCur",format:n},{name:"aTo",format:t.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[Lxt],defines:{ATTRIBUTE_TYPE:r},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function Nxt(e){return e.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}function kxt(e,t){return e.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[t]})}var Fxt={interpolation:k2,spring:F2},z2=class{constructor(t,{id:r,timeline:n}){if(!t)throw new Error("AttributeTransitionManager is constructed without device");this.id=r,this.device=t,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(let t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:r,numInstances:n}){this.numInstances=n||1;for(let i in t){let o=t[i],s=o.getTransitionSetting(r);s&&this._updateAttribute(i,o,s)}for(let i in this.transitions){let o=t[i];(!o||!o.getTransitionSetting(r))&&this._removeTransition(i)}}hasAttribute(t){let r=this.transitions[t];return r&&r.inProgress}getAttributes(){let t={};for(let r in this.transitions){let n=this.transitions[r];n.inProgress&&(t[r]=n.attributeInTransition)}return t}run(){if(this.numInstances===0)return!1;for(let r in this.transitions)this.transitions[r].update()&&(this.needsRedraw=!0);let t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].delete(),delete this.transitions[t]}_updateAttribute(t,r,n){let i=this.transitions[t],o=!i||i.type!==n.type;if(o){i&&this._removeTransition(t);let s=Fxt[n.type];s?this.transitions[t]=new s({attribute:r,timeline:this.timeline,device:this.device}):(br.error(`unsupported transition type '${n.type}'`)(),o=!1)}(o||r.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}};var cq="attributeManager.invalidate",zxt="attributeManager.updateStart",Uxt="attributeManager.updateEnd",Vxt="attribute.updateStart",jxt="attribute.allocate",Hxt="attribute.updateEnd",fu=class{constructor(t,{id:r="attribute-manager",stats:n,timeline:i}={}){this.mergeBoundsMemoized=Gu(CW),this.id=r,this.device=t,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new z2(t,{id:`${r}-transitions`,timeline:i}),Object.seal(this)}finalize(){for(let t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){let r=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,r&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(t){this._add(t)}addInstanced(t){this._add(t,{stepMode:"instance"})}remove(t){for(let r of t)this.attributes[r]!==void 0&&(this.attributes[r].delete(),delete this.attributes[r])}invalidate(t,r){let n=this._invalidateTrigger(t,r);qs(cq,this,t,n)}invalidateAll(t){for(let r in this.attributes)this.attributes[r].setNeedsUpdate(r,t);qs(cq,this,"all")}update({data:t,numInstances:r,startIndices:n=null,transitions:i,props:o={},buffers:s={},context:c={}}){let l=!1;qs(zxt,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(let h in this.attributes){let p=this.attributes[h],x=p.settings.accessor;p.startIndices=n,p.numInstances=r,o[h]&&br.removed(`props.${h}`,`data.attributes.${h}`)(),p.setExternalBuffer(s[h])||p.setBinaryValue(typeof x=="string"?s[x]:void 0,t.startIndices)||typeof x=="string"&&!s[x]&&p.setConstantValue(o[x])||p.needsUpdate()&&(l=!0,this._updateAttribute({attribute:p,numInstances:r,data:t,props:o,context:c})),this.needsRedraw=this.needsRedraw||p.needsRedraw()}l&&qs(Uxt,this,r),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:r,transitions:i})}updateTransition(){let{attributeTransitionManager:t}=this,r=t.run();return this.needsRedraw=this.needsRedraw||r,r}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(t){let r=t.map(n=>this.attributes[n]?.getBounds());return this.mergeBoundsMemoized(r)}getChangedAttributes(t={clearChangedFlags:!1}){let{attributes:r,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(let o in r){let s=r[o];s.needsRedraw(t)&&!n.hasAttribute(o)&&(i[o]=s)}return i}getBufferLayouts(t){return Object.values(this.getAttributes()).map(r=>r.getBufferLayout(t))}_add(t,r){for(let n in t){let i=t[n],o={...i,id:n,size:i.isIndexed&&1||i.size||1,...r};this.attributes[n]=new td(this.device,o)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){let t={};for(let r in this.attributes)this.attributes[r].getUpdateTriggers().forEach(i=>{t[i]||(t[i]=[]),t[i].push(r)});this.updateTriggers=t}_invalidateTrigger(t,r){let{attributes:n,updateTriggers:i}=this,o=i[t];return o&&o.forEach(s=>{let c=n[s];c&&c.setNeedsUpdate(c.id,r)}),o}_updateAttribute(t){let{attribute:r,numInstances:n}=t;if(qs(Vxt,r),r.constant){r.setConstantValue(r.value);return}r.allocate(n)&&qs(jxt,r,n),r.updateBuffer(t)&&(this.needsRedraw=!0,qs(Hxt,r,n))}};var U2=class extends Nh{get value(){return this._value}_onUpdate(){let{time:t,settings:{fromValue:r,toValue:n,duration:i,easing:o}}=this,s=o(t/i);this._value=ka(r,n,s)}};var lq=1e-5;function uq(e,t,r,n,i){let o=t-e,c=(r-t)*i,l=-o*n;return c+l+o+t}function Wxt(e,t,r,n,i){if(Array.isArray(r)){let o=[];for(let s=0;s<r.length;s++)o[s]=uq(e[s],t[s],r[s],n,i);return o}return uq(e,t,r,n,i)}function hq(e,t){if(Array.isArray(e)){let r=0;for(let n=0;n<e.length;n++){let i=e[n]-t[n];r+=i*i}return Math.sqrt(r)}return Math.abs(e-t)}var V2=class extends Nh{get value(){return this._currValue}_onUpdate(){let{fromValue:t,toValue:r,damping:n,stiffness:i}=this.settings,{_prevValue:o=t,_currValue:s=t}=this,c=Wxt(o,s,r,n,i),l=hq(c,r),h=hq(c,s);l<lq&&h<lq&&(c=r,this.end()),this._prevValue=s,this._currValue=c}};var qxt={interpolation:U2,spring:V2},j2=class{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,r,n,i){let{transitions:o}=this;if(o.has(t)){let l=o.get(t),{value:h=l.settings.fromValue}=l;r=h,this.remove(t)}if(i=kS(i),!i)return;let s=qxt[i.type];if(!s){br.error(`unsupported transition type '${i.type}'`)();return}let c=new s(this.timeline);c.start({...i,fromValue:r,toValue:n}),o.set(t,c)}remove(t){let{transitions:r}=this;r.has(t)&&(r.get(t).cancel(),r.delete(t))}update(){let t={};for(let[r,n]of this.transitions)n.update(),t[r]=n.value,n.inProgress||this.remove(r);return t}clear(){for(let t of this.transitions.keys())this.remove(t)}};function pq(e){let t=e[$u];for(let r in t){let n=t[r],{validate:i}=n;if(i&&!i(e[r],n))throw new Error(`Invalid prop ${r}: ${e[r]}`)}}function dq(e,t){let r=uy({newProps:e,oldProps:t,propTypes:e[$u],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),n=Xxt(e,t),i=!1;return n||(i=Yxt(e,t)),{dataChanged:n,propsChanged:r,updateTriggersChanged:i,extensionsChanged:Kxt(e,t),transitionsChanged:Gxt(e,t)}}function Gxt(e,t){if(!e.transitions)return!1;let r={},n=e[$u],i=!1;for(let o in e.transitions){let s=n[o],c=s&&s.type;(c==="number"||c==="color"||c==="array")&&pD(e[o],t[o],s)&&(r[o]=!0,i=!0)}return i?r:!1}function uy({newProps:e,oldProps:t,ignoreProps:r={},propTypes:n={},triggerName:i="props"}){if(t===e)return!1;if(typeof e!="object"||e===null)return`${i} changed shallowly`;if(typeof t!="object"||t===null)return`${i} changed shallowly`;for(let o of Object.keys(e))if(!(o in r)){if(!(o in t))return`${i}.${o} added`;let s=pD(e[o],t[o],n[o]);if(s)return`${i}.${o} ${s}`}for(let o of Object.keys(t))if(!(o in r)){if(!(o in e))return`${i}.${o} dropped`;if(!Object.hasOwnProperty.call(e,o)){let s=pD(e[o],t[o],n[o]);if(s)return`${i}.${o} ${s}`}}return!1}function pD(e,t,r){let n=r&&r.equal;return n&&!n(e,t,r)||!n&&(n=e&&t&&e.equals,n&&!n.call(e,t))?"changed deeply":!n&&t!==e?"changed shallowly":null}function Xxt(e,t){if(t===null)return"oldProps is null, initial diff";let r=!1,{dataComparator:n,_dataDiff:i}=e;return n?n(e.data,t.data)||(r="Data comparator detected a change"):e.data!==t.data&&(r="A new data container was supplied"),r&&i&&(r=i(e.data,t.data)||r),r}function Yxt(e,t){if(t===null)return{all:!0};if("all"in e.updateTriggers&&fq(e,t,"all"))return{all:!0};let r={},n=!1;for(let i in e.updateTriggers)i!=="all"&&fq(e,t,i)&&(r[i]=!0,n=!0);return n?r:!1}function Kxt(e,t){if(t===null)return!0;let r=t.extensions,{extensions:n}=e;if(n===r)return!1;if(!r||!n||n.length!==r.length)return!0;for(let i=0;i<n.length;i++)if(!n[i].equals(r[i]))return!0;return!1}function fq(e,t,r){let n=e.updateTriggers[r];n=n??{};let i=t.updateTriggers[r];return i=i??{},uy({oldProps:i,newProps:n,triggerName:r})}var Zxt="count(): argument not an object",$xt="count(): argument not a container";function HS(e){if(!Jxt(e))throw new Error(Zxt);if(typeof e.count=="function")return e.count();if(Number.isFinite(e.size))return e.size;if(Number.isFinite(e.length))return e.length;if(Qxt(e))return Object.keys(e).length;throw new Error($xt)}function Qxt(e){return e!==null&&typeof e=="object"&&e.constructor===Object}function Jxt(e){return e!==null&&typeof e=="object"}function H2(e,t){if(!t)return e;let r={...e,...t};if("defines"in t&&(r.defines={...e.defines,...t.defines}),"modules"in t&&(r.modules=(e.modules||[]).concat(t.modules),t.modules.some(n=>n.name==="project64"))){let n=r.modules.findIndex(i=>i.name==="project32");n>=0&&r.modules.splice(n,1)}if("inject"in t)if(!e.inject)r.inject=t.inject;else{let n={...e.inject};for(let i in t.inject)n[i]=(n[i]||"")+t.inject[i];r.inject=n}return r}var tvt={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},dD={};function mq(e,t,r,n){if(r instanceof fi)return r;r.constructor&&r.constructor.name!=="Object"&&(r={data:r});let i=null;r.compressed&&(i={minFilter:"linear",mipmapFilter:r.data.length>1?"nearest":"linear"});let o=t.createTexture({...r,sampler:{...tvt,...i,...n},mipmaps:!0});return dD[o.id]=e,o}function Aq(e,t){!t||!(t instanceof fi)||dD[t.id]===e&&(t.delete(),delete dD[t.id])}var evt={boolean:{validate(e,t){return!0},equal(e,t,r){return Boolean(e)===Boolean(t)}},number:{validate(e,t){return Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)}},color:{validate(e,t){return t.optional&&!e||mD(e)&&(e.length===3||e.length===4)},equal(e,t,r){return Oi(e,t,1)}},accessor:{validate(e,t){let r=WS(e);return r==="function"||r===WS(t.value)},equal(e,t,r){return typeof t=="function"?!0:Oi(e,t,1)}},array:{validate(e,t){return t.optional&&!e||mD(e)},equal(e,t,r){let{compare:n}=r,i=Number.isInteger(n)?n:n?1:0;return n?Oi(e,t,i):e===t}},object:{equal(e,t,r){if(r.ignore)return!0;let{compare:n}=r,i=Number.isInteger(n)?n:n?1:0;return n?Oi(e,t,i):e===t}},function:{validate(e,t){return t.optional&&!e||typeof e=="function"},equal(e,t,r){return!r.compare&&r.ignore!==!1||e===t}},data:{transform:(e,t,r)=>{if(!e)return e;let{dataTransform:n}=r.props;return n?n(e):typeof e.shape=="string"&&e.shape.endsWith("-table")&&Array.isArray(e.data)?e.data:e}},image:{transform:(e,t,r)=>{let n=r.context;return!n||!n.device?null:mq(r.id,n.device,e,{...t.parameters,...r.props.textureParameters})},release:(e,t,r)=>{Aq(r.id,e)}}};function gq(e){let t={},r={},n={};for(let[i,o]of Object.entries(e)){let s=o?.deprecatedFor;if(s)n[i]=Array.isArray(s)?s:[s];else{let c=rvt(i,o);t[i]=c,r[i]=c.value}}return{propTypes:t,defaultProps:r,deprecatedProps:n}}function rvt(e,t){switch(WS(t)){case"object":return W2(e,t);case"array":return W2(e,{type:"array",value:t,compare:!1});case"boolean":return W2(e,{type:"boolean",value:t});case"number":return W2(e,{type:"number",value:t});case"function":return W2(e,{type:"function",value:t,compare:!0});default:return{name:e,type:"unknown",value:t}}}function W2(e,t){return"type"in t?{name:e,...evt[t.type],...t}:"value"in t?{name:e,type:WS(t.value),...t}:{name:e,type:"object",value:t}}function mD(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function WS(e){return mD(e)?"array":e===null?"null":typeof e}function _q(e,t){let r;for(let o=t.length-1;o>=0;o--){let s=t[o];"extensions"in s&&(r=s.extensions)}let n=AD(e.constructor,r),i=Object.create(n);i[oy]=e,i[qf]={},i[Dh]={};for(let o=0;o<t.length;++o){let s=t[o];for(let c in s)i[c]=s[c]}return Object.freeze(i),i}var nvt="_mergedDefaultProps";function AD(e,t){if(!(e instanceof hy.constructor))return{};let r=nvt;if(t)for(let i of t){let o=i.constructor;o&&(r+=`:${o.extensionName||o.name}`)}let n=yq(e,r);return n||(e[r]=ivt(e,t||[]))}function ivt(e,t){if(!e.prototype)return null;let n=Object.getPrototypeOf(e),i=AD(n),o=yq(e,"defaultProps")||{},s=gq(o),c=Object.assign(Object.create(null),i,s.defaultProps),l=Object.assign(Object.create(null),i?.[$u],s.propTypes),h=Object.assign(Object.create(null),i?.[IS],s.deprecatedProps);for(let p of t){let x=AD(p.constructor);x&&(Object.assign(c,x),Object.assign(l,x[$u]),Object.assign(h,x[IS]))}return ovt(c,e),avt(c,l),svt(c,h),c[$u]=l,c[IS]=h,t.length===0&&!gD(e,"_propTypes")&&(e._propTypes=l),c}function ovt(e,t){let r=lvt(t);Object.defineProperties(e,{id:{writable:!0,value:r}})}function svt(e,t){for(let r in t)Object.defineProperty(e,r,{enumerable:!1,set(n){let i=`${this.id}: ${r}`;for(let o of t[r])gD(this,o)||(this[o]=n);br.deprecated(i,t[r].join("/"))()}})}function avt(e,t){let r={},n={};for(let i in t){let o=t[i],{name:s,value:c}=o;o.async&&(r[s]=c,n[s]=cvt(s))}e[Kp]=r,e[qf]={},Object.defineProperties(e,n)}function cvt(e){return{enumerable:!0,set(t){typeof t=="string"||t instanceof Promise||DS(t)?this[qf][e]=t:this[Dh][e]=t},get(){if(this[Dh]){if(e in this[Dh])return this[Dh][e]||this[Kp][e];if(e in this[qf]){let t=this[oy]&&this[oy].internalState;if(t&&t.hasAsyncProp(e))return t.getAsyncProp(e)||this[Kp][e]}}return this[Kp][e]}}}function gD(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function yq(e,t){return gD(e,t)&&e[t]}function lvt(e){let t=e.componentName;return t||br.warn(`${e.name}.componentName not specified`)(),t||e.name}var uvt=0,q2=class{constructor(...t){this.props=_q(this,t),this.id=this.props.id,this.count=uvt++}clone(t){let{props:r}=this,n={};for(let i in r[Kp])i in r[Dh]?n[i]=r[Dh][i]:i in r[qf]&&(n[i]=r[qf][i]);return new this.constructor({...r,...n,...t})}};q2.componentName="Component";q2.defaultProps={};var hy=q2;var hvt=Object.freeze({}),m0=class{constructor(t){this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(let t in this.asyncProps){let r=this.asyncProps[t];r&&r.type&&r.type.release&&r.type.release(r.resolvedValue,r.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||hvt}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){let r=this.asyncProps[t];return r&&r.resolvedValue}isAsyncPropLoading(t){if(t){let r=this.asyncProps[t];return Boolean(r&&r.pendingLoadCount>0&&r.pendingLoadCount!==r.resolvedLoadCount)}for(let r in this.asyncProps)if(this.isAsyncPropLoading(r))return!0;return!1}reloadAsyncProp(t,r){this._watchPromise(t,Promise.resolve(r))}setAsyncProps(t){this.component=t[oy]||this.component;let r=t[Dh]||{},n=t[qf]||t,i=t[Kp]||{};for(let o in r){let s=r[o];this._createAsyncPropData(o,i[o]),this._updateAsyncProp(o,s),r[o]=this.getAsyncProp(o)}for(let o in n){let s=n[o];this._createAsyncPropData(o,i[o]),this._updateAsyncProp(o,s)}}_fetch(t,r){return null}_onResolve(t,r){}_onError(t,r){}_updateAsyncProp(t,r){if(this._didAsyncInputValueChange(t,r)){if(typeof r=="string"&&(r=this._fetch(t,r)),r instanceof Promise){this._watchPromise(t,r);return}if(DS(r)){this._resolveAsyncIterable(t,r);return}this._setPropValue(t,r)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(let t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}_didAsyncInputValueChange(t,r){let n=this.asyncProps[t];return r===n.resolvedValue||r===n.lastValue?!1:(n.lastValue=r,!0)}_setPropValue(t,r){this._freezeAsyncOldProps();let n=this.asyncProps[t];n&&(r=this._postProcessValue(n,r),n.resolvedValue=r,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(t,r,n){let i=this.asyncProps[t];i&&n>=i.resolvedLoadCount&&r!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=r,i.resolvedLoadCount=n,this.onAsyncPropUpdated(t,r))}_watchPromise(t,r){let n=this.asyncProps[t];if(n){n.pendingLoadCount++;let i=n.pendingLoadCount;r.then(o=>{this.component&&(o=this._postProcessValue(n,o),this._setAsyncPropValue(t,o,i),this._onResolve(t,o))}).catch(o=>{this._onError(t,o)})}}async _resolveAsyncIterable(t,r){if(t!=="data"){this._setPropValue(t,r);return}let n=this.asyncProps[t];if(!n)return;n.pendingLoadCount++;let i=n.pendingLoadCount,o=[],s=0;for await(let c of r){if(!this.component)return;let{dataTransform:l}=this.component.props;l?o=l(c,o):o=o.concat(c),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:s,endRow:o.length}]}),s=o.length,this._setAsyncPropValue(t,o,i)}this._onResolve(t,o)}_postProcessValue(t,r){let n=t.type;return n&&this.component&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(r,n,this.component):r}_createAsyncPropData(t,r){if(!this.asyncProps[t]){let i=this.component&&this.component.props[$u];this.asyncProps[t]={type:i&&i[t],lastValue:null,resolvedValue:r,pendingLoadCount:0,resolvedLoadCount:0}}}};var G2=class extends m0{constructor({attributeManager:t,layer:r}){super(r),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(t,r){let n=this.layer,i=n?.props.fetch;return i?i(r,{propName:t,layer:n}):super._fetch(t,r)}_onResolve(t,r){let n=this.layer;if(n){let i=n.props.onDataLoad;t==="data"&&i&&i(r,{propName:t,layer:n})}}_onError(t,r){let n=this.layer;n&&n.raiseError(r,`loading ${t} of ${this.layer}`)}};var fvt="layer.changeFlag",pvt="layer.initialize",dvt="layer.update",mvt="layer.finalize",Avt="layer.matched",xq=2**24-1,gvt=Object.freeze([]),_vt=Gu(({oldViewport:e,viewport:t})=>e.equals(t)),kh=new Uint8ClampedArray(0),yvt={data:{type:"data",value:gvt,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:e=>e&&e.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(e,{propName:t,layer:r,loaders:n,loadOptions:i,signal:o})=>{let{resourceManager:s}=r.context;i=i||r.getLoadOptions(),n=n||r.props.loaders,o&&(i={...i,fetch:{...i?.fetch,signal:o}});let c=s.contains(e);return!c&&!i&&(s.add({resourceId:e,data:xa(e,n),persistent:!1}),c=!0),c?s.subscribe({resourceId:e,onChange:l=>r.internalState?.reloadAsyncProp(t,l),consumerId:r.id,requestId:t}):xa(e,n,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Yr.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:e})=>[0,-e*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}},X2=class extends hy{constructor(){super(...arguments),this.internalState=null,this.lifecycle=_m.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let t=this;for(;t.parent;)t=t.parent;return t}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(t){$o(this.internalState);let r=this.internalState.viewport||this.context.viewport,n=rD(t,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,o,s]=$_(n,r.pixelProjectionMatrix);return t.length===2?[i,o]:[i,o,s]}unproject(t){return $o(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(t)}projectPosition(t,r){$o(this.internalState);let n=this.internalState.viewport||this.context.viewport;return bS(t,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...r})}get isComposite(){return!1}get isDrawable(){return!0}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){let t=this.state;return t&&(t.models||t.model&&[t.model])||[]}setShaderModuleProps(...t){for(let r of this.getModels())r.shaderInputs.setProps(...t)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){let{coordinateSystem:t}=this.props;return t===Yr.DEFAULT||t===Yr.LNGLAT||t===Yr.CARTESIAN}onHover(t,r){return this.props.onHover&&this.props.onHover(t,r)||!1}onClick(t,r){return this.props.onClick&&this.props.onClick(t,r)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(t,r=[]){return r[0]=t+1&255,r[1]=t+1>>8&255,r[2]=t+1>>8>>8&255,r}decodePickingColor(t){$o(t instanceof Uint8Array);let[r,n,i]=t;return r+n*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:HS(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders(t){t=H2(t,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(let r of this.props.extensions)t=H2(t,r.getShaders.call(this,r));return t}shouldUpdateState(t){return t.changeFlags.propsOrDataChanged}updateState(t){let r=this.getAttributeManager(),{dataChanged:n}=t.changeFlags;if(n&&r)if(Array.isArray(n))for(let i of n)r.invalidateAll(i);else r.invalidateAll();if(r){let{props:i}=t,o=this.internalState.hasPickingBuffer,s=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(c=>c.getNeedsPickingBuffer.call(this,c));if(o!==s){this.internalState.hasPickingBuffer=s;let{pickingColors:c,instancePickingColors:l}=r.attributes,h=c||l;h&&(s&&h.constant&&(h.constant=!1,r.invalidate(h.id)),!h.value&&!s&&(h.constant=!0,h.value=[0,0,0]))}}}finalizeState(t){for(let n of this.getModels())n.destroy();let r=this.getAttributeManager();r&&r.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(t){for(let r of this.getModels())r.draw(t.renderPass)}getPickingInfo({info:t,mode:r,sourceLayer:n}){let{index:i}=t;return i>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[i]),t}raiseError(t,r){r&&(t=new Error(`${r}: ${t.message}`,{cause:t})),this.props.onError?.(t)||this.context?.onError?.(t,this)}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(t){if(!this.internalState)return;let r=this.internalState.viewport;this.internalState.viewport=t,(!r||!_vt({oldViewport:r,viewport:t}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all"){let r=this.getAttributeManager();r&&(t==="all"?r.invalidateAll():r.invalidate(t))}updateAttributes(t){let r=!1;for(let n in t)t[n].layoutChanged()&&(r=!0);for(let n of this.getModels())this._setModelAttributes(n,t,r)}_updateAttributes(){let t=this.getAttributeManager();if(!t)return;let r=this.props,n=this.getNumInstances(),i=this.getStartIndices();t.update({data:r.data,numInstances:n,startIndices:i,props:r,transitions:r.transitions,buffers:r.data.attributes,context:this});let o=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(o)}_updateAttributeTransition(){let t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){let{uniformTransitions:t}=this.internalState;if(t.active){let r=t.update(),n=Object.create(this.props);for(let i in r)Object.defineProperty(n,i,{value:r[i]});return n}return this.props}calculateInstancePickingColors(t,{numInstances:r}){if(t.constant)return;let n=Math.floor(kh.length/4);if(this.internalState.usesPickingColorCache=!0,n<r){r>xq&&br.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),kh=Bh.allocate(kh,r,{size:4,copy:!0,maxCount:Math.max(r,xq)});let i=Math.floor(kh.length/4),o=[0,0,0];for(let s=n;s<i;s++)this.encodePickingColor(s,o),kh[s*4+0]=o[0],kh[s*4+1]=o[1],kh[s*4+2]=o[2],kh[s*4+3]=0}t.value=kh.subarray(0,r*4)}_setModelAttributes(t,r,n=!1){if(!Object.keys(r).length)return;if(n){let c=this.getAttributeManager();t.setBufferLayout(c.getBufferLayouts(t)),r=c.getAttributes()}let i=t.userData?.excludeAttributes||{},o={},s={};for(let c in r){if(i[c])continue;let l=r[c].getValue();for(let h in l){let p=l[h];p instanceof Vn?r[c].settings.isIndexed?t.setIndexBuffer(p):o[h]=p:p&&(s[h]=p)}}t.setAttributes(o),t.setConstantAttributes(s)}disablePickingIndex(t){let r=this.props.data;if(!("attributes"in r)){this._disablePickingIndex(t);return}let{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,o=n||i,s=o&&r.attributes&&r.attributes[o.id];if(s&&s.value){let c=s.value,l=this.encodePickingColor(t);for(let h=0;h<r.length;h++){let p=o.getVertexOffset(h);c[p]===l[0]&&c[p+1]===l[1]&&c[p+2]===l[2]&&this._disablePickingIndex(h)}}else this._disablePickingIndex(t)}_disablePickingIndex(t){let{pickingColors:r,instancePickingColors:n}=this.getAttributeManager().attributes,i=r||n;if(!i)return;let o=i.getVertexOffset(t),s=i.getVertexOffset(t+1);i.buffer.write(new Uint8Array(s-o),o)}restorePickingColors(){let{pickingColors:t,instancePickingColors:r}=this.getAttributeManager().attributes,n=t||r;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==kh.buffer&&(n.value=kh.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){$o(!this.internalState),$o(Number.isFinite(this.props.coordinateSystem)),qs(pvt,this);let t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new G2({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(br.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t)}),this.internalState.uniformTransitions=new j2(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(let r of this.props.extensions)r.initializeState.call(this,this.context,r);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(t){qs(Avt,this,this===t);let{state:r,internalState:n}=t;this!==t&&(this.internalState=n,this.state=r,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){let t=this.needsUpdate();if(qs(dvt,this,t),!t)return;let r=this.props,n=this.context,i=this.internalState,o=n.viewport,s=this._updateUniformTransition();i.propsInTransition=s,n.viewport=i.viewport||o,this.props=s;try{let c=this._getUpdateParams(),l=this.getModels();if(n.device)this.updateState(c);else try{this.updateState(c)}catch{}for(let p of this.props.extensions)p.updateState.call(this,c,p);this.setNeedsRedraw(),this._updateAttributes();let h=this.getModels()[0]!==l[0];this._postUpdate(c,h)}finally{n.viewport=o,this.props=r,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){qs(mvt,this),this.finalizeState(this.context);for(let t of this.props.extensions)t.finalizeState.call(this,this.context,t)}_drawLayer({renderPass:t,shaderModuleProps:r=null,uniforms:n={},parameters:i={}}){this._updateAttributeTransition();let o=this.props,s=this.context;this.props=this.internalState.propsInTransition||o;try{r&&this.setShaderModuleProps(r);let{getPolygonOffset:c}=this.props,l=c&&c(n)||[0,0];s.device instanceof Na&&s.device.setParametersWebGL({polygonOffset:l});for(let h of this.getModels())h.setParameters(i);if(s.device instanceof Na)s.device.withParametersWebGL(i,()=>{let h={renderPass:t,shaderModuleProps:r,uniforms:n,parameters:i,context:s};for(let p of this.props.extensions)p.draw.call(this,h,p);this.draw(h)});else{let h={renderPass:t,shaderModuleProps:r,uniforms:n,parameters:i,context:s};for(let p of this.props.extensions)p.draw.call(this,h,p);this.draw(h)}}finally{this.props=o}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(t){if(!this.internalState)return;let{changeFlags:r}=this.internalState;for(let i in t)if(t[i]){let o=!1;switch(i){case"dataChanged":let s=t[i],c=r[i];s&&Array.isArray(c)&&(r.dataChanged=Array.isArray(s)?c.concat(s):s,o=!0);default:r[i]||(r[i]=t[i],o=!0)}o&&qs(fvt,this,i,t)}let n=Boolean(r.dataChanged||r.updateTriggersChanged||r.propsChanged||r.extensionsChanged);r.propsOrDataChanged=n,r.somethingChanged=n||r.viewportChanged||r.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(t,r){let n=dq(t,r);if(n.updateTriggersChanged)for(let i in n.updateTriggersChanged)n.updateTriggersChanged[i]&&this.invalidateAttribute(i);if(n.transitionsChanged)for(let i in n.transitionsChanged)this.internalState.uniformTransitions.add(i,r[i],t[i],t.transitions?.[i]);return this.setChangeFlags(n)}validateProps(){pq(this.props)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){let r={highlightedObjectColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&typeof n=="function"&&(r.highlightColor=n(t)),this.setShaderModuleProps({picking:r}),this.setNeedsRedraw()}_getAttributeManager(){let t=this.context;return new fu(t.device,{id:this.props.id,stats:t.stats,timeline:t.timeline})}_postUpdate(t,r){let{props:n,oldProps:i}=t,o=this.state.model;o?.isInstanced&&o.setInstanceCount(this.getNumInstances());let{autoHighlight:s,highlightedObjectIndex:c,highlightColor:l}=n;if(r||i.autoHighlight!==s||i.highlightedObjectIndex!==c||i.highlightColor!==l){let h={};Array.isArray(l)&&(h.highlightColor=l),(r||i.autoHighlight!==s||c!==i.highlightedObjectIndex)&&(h.highlightedObjectColor=Number.isFinite(c)&&c>=0?this.encodePickingColor(c):null),this.setShaderModuleProps({picking:h})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let r=!1;r=r||this.internalState.needsRedraw&&this.id;let n=this.getAttributeManager(),i=n?n.getNeedsRedraw(t):!1;if(r=r||i,r)for(let o of this.props.extensions)o.onNeedsRedraw.call(this,o);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags,r}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}};X2.defaultProps=yvt;X2.layerName="Layer";var qi=X2;var xvt="compositeLayer.renderLayers",qS=class extends qi{get isComposite(){return!0}get isDrawable(){return!1}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(t){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){let{object:r}=t;return r&&r.__source&&r.__source.parent&&r.__source.parent.id===this.id&&(t.object=r.__source.object,t.index=r.__source.index),t}filterSubLayer(t){return!0}shouldRenderSubLayer(t,r){return r&&r.length}getSubLayerClass(t,r){let{_subLayerProps:n}=this.props;return n&&n[t]&&n[t].type||r}getSubLayerRow(t,r,n){return t.__source={parent:this,object:r,index:n},t}getSubLayerAccessor(t){if(typeof t=="function"){let r={index:-1,data:this.props.data,target:[]};return(n,i)=>n&&n.__source?(r.index=n.__source.index,t(n.__source.object,r)):t(n,i)}return t}getSubLayerProps(t={}){let{opacity:r,pickable:n,visible:i,parameters:o,getPolygonOffset:s,highlightedObjectIndex:c,autoHighlight:l,highlightColor:h,coordinateSystem:p,coordinateOrigin:x,wrapLongitude:w,positionFormat:E,modelMatrix:P,extensions:B,fetch:D,operation:W,_subLayerProps:X}=this.props,q={id:"",updateTriggers:{},opacity:r,pickable:n,visible:i,parameters:o,getPolygonOffset:s,highlightedObjectIndex:c,autoHighlight:l,highlightColor:h,coordinateSystem:p,coordinateOrigin:x,wrapLongitude:w,positionFormat:E,modelMatrix:P,extensions:B,fetch:D,operation:W},$=X&&t.id&&X[t.id],et=$&&$.updateTriggers,F=t.id||"sublayer";if($){let ut=this.props[$u],ot=t.type?t.type._propTypes:{};for(let J in $){let G=ot[J]||ut[J];G&&G.type==="accessor"&&($[J]=this.getSubLayerAccessor($[J]))}}Object.assign(q,t,$),q.id=`${this.props.id}-${F}`,q.updateTriggers={all:this.props.updateTriggers?.all,...t.updateTriggers,...et};for(let ut of B){let ot=ut.getSubLayerProps.call(this,ut);ot&&Object.assign(q,ot,{updateTriggers:Object.assign(q.updateTriggers,ot.updateTriggers)})}return q}_updateAutoHighlight(t){for(let r of this.getSubLayers())r.updateAutoHighlight(t)}_getAttributeManager(){return null}_postUpdate(t,r){let n=this.internalState.subLayers,i=!n||this.needsUpdate();if(i){let o=this.renderLayers();n=Gf(o,Boolean),this.internalState.subLayers=n}qs(xvt,this,i,n);for(let o of n)o.parent=this}};qS.layerName="CompositeLayer";var vs=qS;var GS=Math.PI/180,vq=180/Math.PI,XS=6370972,fy=256;function vvt(){let e=fy/XS,t=Math.PI/180*fy;return{unitsPerMeter:[e,e,e],unitsPerMeter2:[0,0,0],metersPerUnit:[1/e,1/e,1/e],unitsPerDegree:[t,t,e],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/t,1/t,1/e]}}var Fh=class extends wa{constructor(t={}){let{longitude:r=0,zoom:n=0,nearZMultiplier:i=.5,farZMultiplier:o=1,resolution:s=10}=t,{latitude:c=0,height:l,altitude:h=1.5,fovy:p}=t;c=Math.max(Math.min(c,Yu),-Yu),l=l||1,p?h=qp(p):p=Wp(h);let x=1/Math.PI/Math.cos(c*Math.PI/180),w=Math.pow(2,n)*x,E=t.nearZ??i,P=t.farZ??(h+fy*2*w/l)*o,B=new Fn().lookAt({eye:[0,-h,0],up:[0,0,1]});B.rotateX(c*GS),B.rotateZ(-r*GS),B.scale(w/l),super({...t,height:l,viewMatrix:B,longitude:r,latitude:c,zoom:n,distanceScales:vvt(),fovy:p,focalDistance:h,near:E,far:P}),this.scale=w,this.latitude=c,this.longitude=r,this.resolution=s}get projectionMode(){return zc.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(t={}){let r={targetZ:t.z||0},n=this.unproject([0,this.height/2],r),i=this.unproject([this.width/2,0],r),o=this.unproject([this.width,this.height/2],r),s=this.unproject([this.width/2,this.height],r);return o[0]<this.longitude&&(o[0]+=360),n[0]>this.longitude&&(n[0]-=360),[Math.min(n[0],o[0],i[0],s[0]),Math.min(n[1],o[1],i[1],s[1]),Math.max(n[0],o[0],i[0],s[0]),Math.max(n[1],o[1],i[1],s[1])]}unproject(t,{topLeft:r=!0,targetZ:n}={}){let[i,o,s]=t,c=r?o:this.height-o,{pixelUnprojectionMatrix:l}=this,h;if(Number.isFinite(s))h=_D(l,[i,c,s,1]);else{let E=_D(l,[i,c,-1,1]),P=_D(l,[i,c,1,1]),B=((n||0)/XS+1)*fy,D=Fc.sqrLen(Fc.sub([],E,P)),W=Fc.sqrLen(E),X=Fc.sqrLen(P),$=4*((4*W*X-(D-W-X)**2)/16)/D,et=Math.sqrt(W-$),F=Math.sqrt(Math.max(0,B*B-$)),ut=(et-F)/Math.sqrt(D);h=Fc.lerp([],E,P,ut)}let[p,x,w]=this.unprojectPosition(h);return Number.isFinite(s)?[p,x,w]:Number.isFinite(n)?[p,x,n]:[p,x]}projectPosition(t){let[r,n,i=0]=t,o=r*GS,s=n*GS,c=Math.cos(s),l=(i/XS+1)*fy;return[Math.sin(o)*c*l,-Math.cos(o)*c*l,Math.sin(s)*l]}unprojectPosition(t){let[r,n,i]=t,o=Fc.len(t),s=Math.asin(i/o),l=Math.atan2(r,-n)*vq,h=s*vq,p=(o/fy-1)*XS;return[l,h,p]}projectFlat(t){return t}unprojectFlat(t){return t}panByPosition(t,r){let n=this.unproject(r);return{longitude:t[0]-n[0]+this.longitude,latitude:t[1]-n[1]+this.latitude}}};function _D(e,t){let r=hl.transformMat4([],t,e);return hl.scale(r,r,1/r[3]),r}var yD=Math.PI/180;function bvt({height:e,focalDistance:t,orbitAxis:r,rotationX:n,rotationOrbit:i,zoom:o}){let s=r==="Z"?[0,0,1]:[0,1,0],c=r==="Z"?[0,-t,0]:[0,0,t],l=new Fn().lookAt({eye:c,up:s});l.rotateX(n*yD),r==="Z"?l.rotateZ(i*yD):l.rotateY(i*yD);let h=Math.pow(2,o)/e;return l.scale(h),l}var A0=class extends wa{constructor(t){let{height:r,projectionMatrix:n,fovy:i=50,orbitAxis:o="Z",target:s=[0,0,0],rotationX:c=0,rotationOrbit:l=0,zoom:h=0}=t,p=n?n[5]/2:qp(i);super({...t,longitude:void 0,viewMatrix:bvt({height:r||1,focalDistance:p,orbitAxis:o,rotationX:c,rotationOrbit:l,zoom:h}),fovy:i,focalDistance:p,position:s,zoom:h}),this.projectedCenter=this.project(this.center)}unproject(t,{topLeft:r=!0}={}){let[n,i,o=this.projectedCenter[2]]=t,s=r?i:this.height-i,[c,l,h]=Ku([n,s,o],this.pixelUnprojectionMatrix);return[c,l,h]}panByPosition(t,r){let n=this.project(t),i=[this.width/2+n[0]-r[0],this.height/2+n[1]-r[1],this.projectedCenter[2]];return{target:this.unproject(i)}}};var wvt=new Fn().lookAt({eye:[0,0,1]});function Tvt({width:e,height:t,near:r,far:n,padding:i}){let o=-e/2,s=e/2,c=-t/2,l=t/2;if(i){let{left:h=0,right:p=0,top:x=0,bottom:w=0}=i,E=ro((h+e-p)/2,0,e)-e/2,P=ro((x+t-w)/2,0,t)-t/2;o-=E,s-=E,c+=P,l+=P}return new Fn().ortho({left:o,right:s,bottom:c,top:l,near:r,far:n})}var g0=class extends wa{constructor(t){let{width:r,height:n,near:i=.1,far:o=1e3,zoom:s=0,target:c=[0,0,0],padding:l=null,flipY:h=!0}=t,p=Array.isArray(s)?s[0]:s,x=Array.isArray(s)?s[1]:s,w=Math.min(p,x),E=Math.pow(2,w),P;if(p!==x){let B=Math.pow(2,p),D=Math.pow(2,x);P={unitsPerMeter:[B/E,D/E,1],metersPerUnit:[E/B,E/D,1]}}super({...t,longitude:void 0,position:c,viewMatrix:wvt.clone().scale([E,E*(h?-1:1),E]),projectionMatrix:Tvt({width:r||1,height:n||1,padding:l,near:i,far:o}),zoom:w,distanceScales:P})}projectFlat([t,r]){let{unitsPerMeter:n}=this.distanceScales;return[t*n[0],r*n[1]]}unprojectFlat([t,r]){let{metersPerUnit:n}=this.distanceScales;return[t*n[0],r*n[1]]}panByPosition(t,r){let n=Ku(r,this.pixelUnprojectionMatrix),i=this.projectFlat(t),o=ba.add([],i,ba.negate([],n)),s=ba.add([],this.center,o);return{target:this.unprojectFlat(s)}}};var _0=class extends wa{constructor(t){let{longitude:r,latitude:n,modelMatrix:i,bearing:o=0,pitch:s=0,up:c=[0,0,1]}=t,h=new Ih({bearing:o,pitch:s===-90?1e-4:90+s}).toVector3().normalize(),p=i?new Fn(i).transformAsVector(h):h,x=Number.isFinite(n)?l2({latitude:n}):0,w=Math.pow(2,x),E=new Fn().lookAt({eye:[0,0,0],center:p,up:c}).scale(w);super({...t,zoom:x,viewMatrix:E}),this.latitude=n,this.longitude=r}};var y0=20,bq=500,Y2=class extends Jp{constructor(t){let{width:r,height:n,position:i=[0,0,0],bearing:o=0,pitch:s=0,longitude:c=null,latitude:l=null,maxPitch:h=90,minPitch:p=-90,startRotatePos:x,startBearing:w,startPitch:E,startZoomPosition:P,startPanPos:B,startPanPosition:D}=t;super({width:r,height:n,position:i,bearing:o,pitch:s,longitude:c,latitude:l,maxPitch:h,minPitch:p},{startRotatePos:x,startBearing:w,startPitch:E,startZoomPosition:P,startPanPos:B,startPanPosition:D}),this.makeViewport=t.makeViewport}panStart({pos:t}){let{position:r}=this.getViewportProps();return this._getUpdatedState({startPanPos:t,startPanPosition:r})}pan({pos:t}){if(!t)return this;let{startPanPos:r=[0,0],startPanPosition:n=[0,0]}=this.getState(),{width:i,height:o,bearing:s,pitch:c}=this.getViewportProps(),l=bq*(t[0]-r[0])/i,h=bq*(t[1]-r[1])/o,p=new Ih({bearing:s,pitch:c}),x=new Ih({bearing:s,pitch:-90}),w=p.toVector3().normalize(),E=x.toVector3().cross(w).normalize();return this._getUpdatedState({position:new ur(n).add(E.scale(l)).add(w.scale(h))})}panEnd(){return this._getUpdatedState({startPanPos:null,startPanPosition:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:t,deltaAngleX:r=0,deltaAngleY:n=0}){let{startRotatePos:i,startBearing:o,startPitch:s}=this.getState(),{width:c,height:l}=this.getViewportProps();if(!i||o===void 0||s===void 0)return this;let h;if(t){let p=(t[0]-i[0])/c,x=(t[1]-i[1])/l;h={bearing:o-p*180,pitch:s-x*90}}else h={bearing:o-r,pitch:s-n};return this._getUpdatedState(h)}rotateEnd(){return this._getUpdatedState({startRotatePos:null,startBearing:null,startPitch:null})}zoomStart(){return this._getUpdatedState({startZoomPosition:this.getViewportProps().position})}zoom({pos:t,scale:r}){let n=this.getViewportProps(),i=this.getState().startZoomPosition||n.position,o=this.makeViewport(n),{projectionMatrix:s,width:c}=o,h=2*Math.atan(1/s[0])*(t[0]/c-.5),p=this.getDirection(!0);return this._move(p.rotateZ({radians:-h}),Math.log2(r)*y0,i)}zoomEnd(){return this._getUpdatedState({startZoomPosition:null})}moveLeft(t=y0){let r=this.getDirection(!0);return this._move(r.rotateZ({radians:Math.PI/2}),t)}moveRight(t=y0){let r=this.getDirection(!0);return this._move(r.rotateZ({radians:-Math.PI/2}),t)}moveUp(t=y0){let r=this.getDirection(!0);return this._move(r,t)}moveDown(t=y0){let r=this.getDirection(!0);return this._move(r.negate(),t)}rotateLeft(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}zoomIn(t=y0){return this._move(new ur(0,0,1),t)}zoomOut(t=y0){return this._move(new ur(0,0,-1),t)}shortestPathFrom(t){let r=t.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:o}=n;return Math.abs(i-r.bearing)>180&&(n.bearing=i<0?i+360:i-360),o!==null&&r.longitude!==null&&Math.abs(o-r.longitude)>180&&(n.longitude=o<0?o+360:o-360),n}_move(t,r,n=this.getViewportProps().position){let i=t.scale(r);return this._getUpdatedState({position:new ur(n).add(i)})}getDirection(t=!1){return new Ih({bearing:this.getViewportProps().bearing,pitch:t?90:90+this.getViewportProps().pitch}).toVector3().normalize()}_getUpdatedState(t){return new Y2({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}applyConstraints(t){let{pitch:r,maxPitch:n,minPitch:i,longitude:o,bearing:s}=t;return t.pitch=ro(r,i,n),o!==null&&(o<-180||o>180)&&(t.longitude=s0(o+180,360)-180),(s<-180||s>180)&&(t.bearing=s0(s+180,360)-180),t}},x0=class extends pl{constructor(){super(...arguments),this.ControllerState=Y2,this.transition={transitionDuration:300,transitionInterpolator:new Ec(["position","pitch","bearing"])}}};var YS=class extends fl{constructor(t={}){super(t)}getViewportType(){return _0}get ControllerType(){return x0}};YS.displayName="FirstPersonView";var wq=YS;var K2=class extends Jp{constructor(t){let{width:r,height:n,rotationX:i=0,rotationOrbit:o=0,target:s=[0,0,0],zoom:c=0,minRotationX:l=-90,maxRotationX:h=90,minZoom:p=-1/0,maxZoom:x=1/0,startPanPosition:w,startRotatePos:E,startRotationX:P,startRotationOrbit:B,startZoomPosition:D,startZoom:W}=t;super({width:r,height:n,rotationX:i,rotationOrbit:o,target:s,zoom:c,minRotationX:l,maxRotationX:h,minZoom:p,maxZoom:x},{startPanPosition:w,startRotatePos:E,startRotationX:P,startRotationOrbit:B,startZoomPosition:D,startZoom:W}),this.makeViewport=t.makeViewport}panStart({pos:t}){return this._getUpdatedState({startPanPosition:this._unproject(t)})}pan({pos:t,startPosition:r}){let n=this.getState().startPanPosition||r;if(!n)return this;let o=this.makeViewport(this.getViewportProps()).panByPosition(n,t);return this._getUpdatedState(o)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:t,deltaAngleX:r=0,deltaAngleY:n=0}){let{startRotatePos:i,startRotationX:o,startRotationOrbit:s}=this.getState(),{width:c,height:l}=this.getViewportProps();if(!i||o===void 0||s===void 0)return this;let h;if(t){let p=(t[0]-i[0])/c,x=(t[1]-i[1])/l;(o<-90||o>90)&&(p*=-1),h={rotationX:o+x*180,rotationOrbit:s+p*180}}else h={rotationX:o+n,rotationOrbit:s+r};return this._getUpdatedState(h)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(t){let r=t.getViewportProps(),n={...this.getViewportProps()},{rotationOrbit:i}=n;return Math.abs(i-r.rotationOrbit)>180&&(n.rotationOrbit=i<0?i+360:i-360),n}zoomStart({pos:t}){return this._getUpdatedState({startZoomPosition:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom({pos:t,startPos:r,scale:n}){let{startZoom:i,startZoomPosition:o}=this.getState();if(o||(i=this.getViewportProps().zoom,o=this._unproject(r)||this._unproject(t)),!o)return this;let s=this._calculateNewZoom({scale:n,startZoom:i}),c=this.makeViewport({...this.getViewportProps(),zoom:s});return this._getUpdatedState({zoom:s,...c.panByPosition(o,t)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:t})})}zoomOut(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/t})})}moveLeft(t=50){return this._panFromCenter([-t,0])}moveRight(t=50){return this._panFromCenter([t,0])}moveUp(t=50){return this._panFromCenter([0,-t])}moveDown(t=50){return this._panFromCenter([0,t])}rotateLeft(t=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-t})}rotateRight(t=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+t})}rotateUp(t=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-t})}rotateDown(t=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+t})}_unproject(t){let r=this.makeViewport(this.getViewportProps());return t&&r.unproject(t)}_calculateNewZoom({scale:t,startZoom:r}){let{maxZoom:n,minZoom:i}=this.getViewportProps();r===void 0&&(r=this.getViewportProps().zoom);let o=r+Math.log2(t);return ro(o,i,n)}_panFromCenter(t){let{width:r,height:n,target:i}=this.getViewportProps();return this.pan({startPosition:i,pos:[r/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}applyConstraints(t){let{maxZoom:r,minZoom:n,zoom:i,maxRotationX:o,minRotationX:s,rotationOrbit:c}=t;return t.zoom=Array.isArray(i)?[ro(i[0],n,r),ro(i[1],n,r)]:ro(i,n,r),t.rotationX=ro(t.rotationX,s,o),(c<-180||c>180)&&(t.rotationOrbit=s0(c+180,360)-180),t}},v0=class extends pl{constructor(){super(...arguments),this.ControllerState=K2,this.transition={transitionDuration:300,transitionInterpolator:new Ec({transitionProps:{compare:["target","zoom","rotationX","rotationOrbit"],required:["target","zoom"]}})}}};var KS=class extends fl{constructor(t={}){super(t),this.props.orbitAxis=t.orbitAxis||"Z"}getViewportType(){return A0}get ControllerType(){return v0}};KS.displayName="OrbitView";var Tq=KS;var xD=class extends K2{constructor(t){super(t),this.zoomAxis=t.zoomAxis||"all"}_calculateNewZoom({scale:t,startZoom:r}){let{maxZoom:n,minZoom:i}=this.getViewportProps();r===void 0&&(r=this.getViewportProps().zoom);let o=Math.log2(t);if(Array.isArray(r)){let[s,c]=r;switch(this.zoomAxis){case"X":s=ro(s+o,i,n);break;case"Y":c=ro(c+o,i,n);break;default:let l=Math.min(s+o,c+o);l<i&&(o+=i-l),l=Math.max(s+o,c+o),l>n&&(o+=n-l),s+=o,c+=o}return[s,c]}return ro(r+o,i,n)}},b0=class extends pl{constructor(){super(...arguments),this.ControllerState=xD,this.transition={transitionDuration:300,transitionInterpolator:new Ec(["target","zoom"])},this.dragMode="pan"}_onPanRotate(){return!1}};var ZS=class extends fl{constructor(t={}){super(t)}getViewportType(){return g0}get ControllerType(){return b0}};ZS.displayName="OrthographicView";var Eq=ZS;var vD=class extends C2{applyConstraints(t){let{maxZoom:r,minZoom:n,zoom:i}=t;t.zoom=ro(i,n,r);let{longitude:o,latitude:s}=t;return(o<-180||o>180)&&(t.longitude=s0(o+180,360)-180),t.latitude=ro(s,-Yu,Yu),t}},w0=class extends pl{constructor(){super(...arguments),this.ControllerState=vD,this.transition={transitionDuration:300,transitionInterpolator:new Ec(["longitude","latitude","zoom"])},this.dragMode="pan"}setProps(t){super.setProps(t),this.dragRotate=!1,this.touchRotate=!1}};var $S=class extends fl{constructor(t={}){super(t)}getViewportType(t){return t.zoom>12?Uc:Fh}get ControllerType(){return w0}};$S.displayName="GlobeView";var Mq=$S;var Z2=class{static get componentName(){return Object.prototype.hasOwnProperty.call(this,"extensionName")?this.extensionName:""}constructor(t){t&&(this.opts=t)}equals(t){return this===t?!0:this.constructor===t.constructor&&Oi(this.opts,t.opts,1)}getShaders(t){return null}getSubLayerProps(t){let{defaultProps:r}=t.constructor,n={updateTriggers:{}};for(let i in r)if(i in this.props){let o=r[i],s=this.props[i];n[i]=s,o&&o.type==="accessor"&&(n.updateTriggers[i]=this.props.updateTriggers[i],typeof s=="function"&&(n[i]=this.getSubLayerAccessor(s)))}return n}initializeState(t,r){}updateState(t,r){}onNeedsRedraw(t){}getNeedsPickingBuffer(t){return!1}draw(t,r){}finalizeState(t,r){}};Z2.defaultProps={};Z2.extensionName="LayerExtension";var QS=Z2;var bD={bearing:0,pitch:0,position:[0,0,0]},Evt={speed:1.2,curve:1.414},ed=class extends Qp{constructor(t={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),this.opts={...Evt,...t}}interpolateProps(t,r,n){let i=$4(t,r,n,this.opts);for(let o in bD)i[o]=ka(t[o]||bD[o],r[o]||bD[o],n);return i}getDuration(t,r){let{transitionDuration:n}=r;return n==="auto"&&(n=Q4(t,r,this.opts)),n}};var rd=class{constructor(t){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;let{attributes:r={}}=t;this.typedArrayManager=Bh,this.attributes={},this._attributeDefs=r,this.opts=t,this.updateGeometry(t)}updateGeometry(t){Object.assign(this.opts,t);let{data:r,buffers:n={},getGeometry:i,geometryBuffer:o,positionFormat:s,dataChanged:c,normalize:l=!0}=this.opts;if(this.data=r,this.getGeometry=i,this.positionSize=o&&o.size||(s==="XY"?2:3),this.buffers=n,this.normalize=l,o&&($o(r.startIndices),this.getGeometry=this.getGeometryFromBuffer(o),l||(n.vertexPositions=o)),this.geometryBuffer=n.vertexPositions,Array.isArray(c))for(let h of c)this._rebuildGeometry(h);else this._rebuildGeometry()}updatePartialGeometry({startRow:t,endRow:r}){this._rebuildGeometry({startRow:t,endRow:r})}getGeometryFromBuffer(t){let r=t.value||t;return ArrayBuffer.isView(r)?NS(r,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices}):null}_allocate(t,r){let{attributes:n,buffers:i,_attributeDefs:o,typedArrayManager:s}=this;for(let c in o)if(c in i)s.release(n[c]),n[c]=null;else{let l=o[c];l.copy=r,n[c]=s.allocate(n[c],t,l)}}_forEachGeometry(t,r,n){let{data:i,getGeometry:o}=this,{iterable:s,objectInfo:c}=Xs(i,r,n);for(let l of s){c.index++;let h=o?o(l,c):null;t(h,c.index)}}_rebuildGeometry(t){if(!this.data)return;let{indexStarts:r,vertexStarts:n,instanceCount:i}=this,{data:o,geometryBuffer:s}=this,{startRow:c=0,endRow:l=1/0}=t||{},h={};if(t||(r=[0],n=[0]),this.normalize||!s)this._forEachGeometry((x,w)=>{let E=x&&this.normalizeGeometry(x);h[w]=E,n[w+1]=n[w]+(E?this.getGeometrySize(E):0)},c,l),i=n[n.length-1];else if(n=o.startIndices,i=n[o.length]||0,ArrayBuffer.isView(s))i=i||s.length/this.positionSize;else if(s instanceof Vn){let x=this.positionSize*4;i=i||s.byteLength/x}else if(s.buffer){let x=s.stride||this.positionSize*4;i=i||s.buffer.byteLength/x}else if(s.value){let x=s.value,w=s.stride/x.BYTES_PER_ELEMENT||this.positionSize;i=i||x.length/w}this._allocate(i,Boolean(t)),this.indexStarts=r,this.vertexStarts=n,this.instanceCount=i;let p={};this._forEachGeometry((x,w)=>{let E=h[w]||x;p.vertexStart=n[w],p.indexStart=r[w];let P=w<n.length-1?n[w+1]:i;p.geometrySize=P-n[w],p.geometryIndex=w,this.updateGeometryAttributes(E,p)},c,l),this.vertexCount=r[r.length-1]}};function zh(e,t){t&&Object.entries(t).map(([r,n])=>{r.startsWith("--")?e.style.setProperty(r,n):e.style[r]=n})}function bm(e,t){t&&Object.keys(t).map(r=>{r.startsWith("--")?e.style.removeProperty(r):e.style[r]=""})}var wD=85.05113;function ED(e,t,r,n){if(r){if(r.userData._googleMap===e)return r;JS(r)}let i={click:null,rightclick:null,dblclick:null,mousemove:null,mouseout:null},o=new cy({...n,useDevicePixels:n.interleaved?!0:n.useDevicePixels,style:n.interleaved?null:{pointerEvents:"none"},parent:Mvt(t,n.style),views:new ay({repeat:!0}),initialViewState:{longitude:0,latitude:0,zoom:1},controller:!1});for(let s in i)i[s]=e.addListener(s,c=>Cvt(o,s,c));return o.userData._googleMap=e,o.userData._eventListeners=i,o}function Mvt(e,t){let r=document.createElement("div");return r.style.position="absolute",Object.assign(r.style,t),"getPanes"in e?e.getPanes()?.overlayLayer.appendChild(r):e.getMap()?.getDiv().appendChild(r),r}function JS(e){let{_eventListeners:t}=e.userData;for(let r in t)t[r]&&t[r].remove();e.finalize()}function Sq(e,t){let{width:r,height:n}=Cq(e),i=t.getProjection(),o=e.getBounds();if(!o)return{width:r,height:n,left:0,top:0};let s=o.getNorthEast(),c=o.getSouthWest(),l=i.fromLatLngToDivPixel(s),h=i.fromLatLngToDivPixel(c),p=TD(i,r/2,n/2),x=new google.maps.LatLng(0,p[0]),w=i.fromLatLngToContainerPixel(x),E=i.fromLatLngToDivPixel(x);if(!l||!h||!E||!w)return{width:r,height:n,left:0,top:0};let P=Math.round(E.x-w.x),B=E.y-w.y,D=TD(i,r/2,0),W=TD(i,r/2,n),X=p[1],q=p[0];if(Math.abs(X)>wD){X=X>0?wD:-wD;let J=new google.maps.LatLng(X,q),G=i.fromLatLngToContainerPixel(J);B+=G.y-n/2}B=Math.round(B);let et=180*new JA(D).sub(W).verticalAngle()/Math.PI;et<0&&(et+=360);let F=e.getHeading()||0,ut=e.getZoom()-1,ot;if(et===0)ot=n?(h.y-l.y)/n:1;else if(et===F){let J=new JA([l.x,l.y]).sub([h.x,h.y]).len(),G=new JA([r,-n]).len();ot=G?J/G:1}return ut+=Math.log2(ot||1),{width:r,height:n,left:P,top:B,zoom:ut,bearing:et,pitch:e.getTilt(),latitude:X,longitude:q}}function MD(e,t){let{width:r,height:n}=Cq(e),{center:i,heading:o,tilt:s,zoom:c}=t.getCameraParams(),l=25,h=n?r/n:1,p=.75,x=3e14,w=new Fn().perspective({fovy:l*Math.PI/180,aspect:h,near:p,far:x}),E=.5*w[5];return{width:r,height:n,viewState:{altitude:E,bearing:o,latitude:i.lat(),longitude:i.lng(),pitch:s,projectionMatrix:w,repeat:!0,zoom:c-1}}}function Cq(e){let t=e.getDiv().firstChild;return{width:t.offsetWidth,height:t.offsetHeight}}function TD(e,t,r){let n=new google.maps.Point(t,r),i=e.fromContainerPixelToLatLng(n);return[i.lng(),i.lat()]}function Svt(e,t){if(e.pixel)return e.pixel;let r=t.getViewports()[0].project([e.latLng.lng(),e.latLng.lat()]);return{x:r[0],y:r[1]}}function Cvt(e,t,r){if(!e.isInitialized)return;let n={type:t,offsetCenter:Svt(r,e),srcEvent:r};switch(t){case"click":case"rightclick":n.type="click",n.tapCount=1,e._onPointerDown(n),e._onEvent(n);break;case"dblclick":n.type="click",n.tapCount=2,e._onEvent(n);break;case"mousemove":n.type="pointermove",e._onPointerMove(n);break;case"mouseout":n.type="pointerleave",e._onPointerMove(n);break;default:return}}var Pvt=()=>!1,Ivt={depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],blendEquation:32774};function Pq(){}var Rvt={interleaved:!0},T0=class{constructor(t){this.props={},this._map=null,this._deck=null,this._overlay=null,this.setProps({...Rvt,...t})}setMap(t){if(t===this._map)return;let{VECTOR:r,UNINITIALIZED:n}=google.maps.RenderingType;this._map&&(!t&&this._map.getRenderingType()===r&&this.props.interleaved&&this._overlay.requestRedraw(),this._overlay?.setMap(null),this._map=null),t&&(this._map=t,t.getRenderingType()!==n?this._createOverlay(t):t.addListener("renderingtype_changed",()=>{this._createOverlay(t)}))}setProps(t){if(Object.assign(this.props,t),this._deck){let r=this._deck.getCanvas();if(t.style&&r?.parentElement){let n=r.parentElement.style;Object.assign(n,t.style),t.style=null}this._deck.setProps(t)}}pickObject(t){return this._deck&&this._deck.pickObject(t)}pickMultipleObjects(t){return this._deck&&this._deck.pickMultipleObjects(t)}pickObjects(t){return this._deck&&this._deck.pickObjects(t)}finalize(){this.setMap(null),this._deck&&(JS(this._deck),this._deck=null)}_createOverlay(t){let{interleaved:r}=this.props,{VECTOR:n,UNINITIALIZED:i}=google.maps.RenderingType,o=t.getRenderingType();if(o===i)return;let c=o===n&&google.maps.WebGLOverlayView?google.maps.WebGLOverlayView:google.maps.OverlayView,l=new c;l instanceof google.maps.WebGLOverlayView?(r?(l.onAdd=Pq,l.onContextRestored=this._onContextRestored.bind(this),l.onDraw=this._onDrawVectorInterleaved.bind(this)):(l.onAdd=this._onAdd.bind(this),l.onContextRestored=Pq,l.onDraw=this._onDrawVectorOverlay.bind(this)),l.onContextLost=this._onContextLost.bind(this)):(l.onAdd=this._onAdd.bind(this),l.draw=this._onDrawRaster.bind(this)),l.onRemove=this._onRemove.bind(this),this._overlay=l,this._overlay.setMap(t)}_onAdd(){this._deck=ED(this._map,this._overlay,this._deck,this.props)}_onContextRestored({gl:t}){if(!this._map||!this._overlay)return;let r=()=>{this._overlay&&this._overlay.requestRedraw()},n=ED(this._map,this._overlay,this._deck,{gl:t,_customRender:r,...this.props});this._deck=n;let i=n.animationLoop;i._renderFrame=()=>{let o=t.getParameter(34964);n.device.withParametersWebGL({},()=>{i.props.onRender(i.animationProps)}),t.bindBuffer(34962,o)}}_onContextLost(){this._deck&&(JS(this._deck),this._deck=null)}_onRemove(){this._deck?.setProps({layerFilter:Pvt})}_onDrawRaster(){if(!this._deck||!this._map)return;let t=this._deck,{width:r,height:n,left:i,top:o,...s}=Sq(this._map,this._overlay),l=t.getCanvas()?.parentElement||t.props.parent;if(l){let p=l.style;p.left=`${i}px`,p.top=`${o}px`}let h=1e4;t.setProps({width:r,height:n,viewState:{altitude:h,...s}}),t.redraw()}_onDrawVectorInterleaved({gl:t,transformer:r}){if(!this._deck||!this._map)return;let n=this._deck;if(n.setProps({...MD(this._map,r),width:null,height:null}),n.isInitialized){let i=n.device;if(i instanceof Na){let o=i.getParametersWebGL(36006);n.setProps({_framebuffer:o})}i.getDefaultCanvasContext().resize(),n.needsRedraw({clearRedrawFlags:!0}),i instanceof Na&&(i.setParametersWebGL({viewport:[0,0,t.canvas.width,t.canvas.height],scissor:[0,0,t.canvas.width,t.canvas.height],stencilFunc:[519,0,255,519,0,255]}),i.withParametersWebGL(Ivt,()=>{n._drawLayers("google-vector",{clearCanvas:!1})}))}}_onDrawVectorOverlay({transformer:t}){if(!this._deck||!this._map)return;let r=this._deck;r.setProps({...MD(this._map,t)}),r.redraw()}};function Iq({container:e,onClick:t,onComplete:r,getTooltip:n,googleMapsKey:i,layers:o,mapStyle:s="satellite",initialViewState:c={latitude:0,longitude:0,zoom:1}}){if(!i)return br.warn("No Google Maps API key set")(),null;let l=new T0({layers:o}),h={center:{lat:c.latitude,lng:c.longitude},mapTypeId:s,zoom:c.zoom},p=new window.google.maps.Map(e,h);return l.setMap(p),l}var Rq={position:"absolute",top:"0px",left:"0px",width:344,padding:"12px 24px",margin:24,overflowX:"hidden",overflowY:"overlay",outline:"none",maxHeight:"94%",boxSizing:"border-box",backgroundColor:"rgb(255, 255, 255)",fontFamily:'"Fira Sans", sans-serif',zIndex:1};var SD=class{constructor({container:t,props:r}){let{description:n}=r,i=document.createElement("div");i.className="deck-json-description-box",Object.assign(i.style,Rq),this.el=i;let o=document.createElement("div");o.innerHTML=n,i.appendChild(o),t.append(i)}remove(){this.el.remove(),this.description=null}static get stringName(){return"description"}},Lq=SD;function CD(e,t){let r=document.createElement("div");r.className="deckgl-ui-elements-overlay",r.style.zIndex=1,e.insertAdjacentElement("beforebegin",r);let n=[];for(let i of Object.keys(t))switch(i){case"description":let o=new Lq({container:r,props:t});n.push(o);break;default:break}return n}var Vw={};Lo(Vw,{AmbientLight:()=>J_,ArcLayer:()=>e3,Attribute:()=>td,AttributeManager:()=>fu,BitmapLayer:()=>r3,COORDINATE_SYSTEM:()=>Yr,CPUAggregator:()=>dl,ColumnLayer:()=>Xf,CompassWidget:()=>xI,CompositeLayer:()=>vs,ContourLayer:()=>PY,Controller:()=>pl,DarkGlassTheme:()=>hDt,DarkTheme:()=>lDt,Deck:()=>cy,DeckRenderer:()=>d0,DirectionalLight:()=>Gp,FirstPersonController:()=>x0,FirstPersonView:()=>wq,FirstPersonViewport:()=>_0,FlyToInterpolator:()=>ed,FullscreenWidget:()=>yI,GeoJsonLayer:()=>C0,GeohashLayer:()=>Git,GoogleMapsOverlay:()=>T0,GreatCircleLayer:()=>VK,GridCellLayer:()=>bG,GridLayer:()=>BY,H3ClusterLayer:()=>WZ,H3HexagonLayer:()=>rC,HeatmapLayer:()=>QY,HexagonLayer:()=>ZX,IconLayer:()=>py,JSONConfiguration:()=>yd,JSONConverter:()=>sg,Layer:()=>qi,LayerExtension:()=>QS,LayerManager:()=>h0,LightGlassTheme:()=>uDt,LightTheme:()=>cDt,LightingEffect:()=>Am,LineLayer:()=>tG,LinearInterpolator:()=>Ec,MVTLayer:()=>jit,MapController:()=>p0,MapView:()=>ay,OPERATION:()=>aW,OrbitController:()=>v0,OrbitView:()=>Tq,OrbitViewport:()=>A0,OrthographicController:()=>b0,OrthographicView:()=>Eq,OrthographicViewport:()=>g0,PathLayer:()=>Yf,PointCloudLayer:()=>n3,PointLight:()=>ny,PolygonLayer:()=>Mm,PostProcessEffect:()=>b2,QuadkeyLayer:()=>eZ,S2Layer:()=>JK,ScatterplotLayer:()=>i3,ScenegraphLayer:()=>IC,ScreenGridLayer:()=>zX,SimpleMeshLayer:()=>F0,SolidPolygonLayer:()=>Em,TRANSITION_EVENTS:()=>M2,TerrainLayer:()=>lit,Tesselator:()=>rd,TextLayer:()=>b3,Tile3DLayer:()=>rit,TileLayer:()=>D0,TransitionInterpolator:()=>Qp,Transport:()=>op,TripsLayer:()=>vZ,UNIT:()=>us,VERSION:()=>gM,View:()=>fl,Viewport:()=>wa,WebGLAggregator:()=>na,WebMercatorViewport:()=>Uc,ZoomWidget:()=>vI,_AggregationLayer:()=>Kf,_CameraLight:()=>d2,_Component:()=>hy,_ComponentState:()=>m0,_GeoCellLayer:()=>Zf,_GlobeController:()=>w0,_GlobeView:()=>Mq,_GlobeViewport:()=>Fh,_LayersPass:()=>Oh,_MultiIconLayer:()=>y3,_PickLayersPass:()=>Yp,_SunLight:()=>m2,_TextBackgroundLayer:()=>v3,_Tile2DHeader:()=>L0,_Tileset2D:()=>B0,_WMSLayer:()=>By,_applyStyles:()=>zh,_compareProps:()=>uy,_convertFunctions:()=>I1,_count:()=>HS,_deepEqual:()=>Oi,_fillArray:()=>RS,_flatten:()=>Gf,_getURLFromTemplate:()=>Qf,_memoize:()=>Gu,_mergeShaders:()=>H2,_parseExpressionString:()=>og,_removeStyles:()=>bm,_shallowEqualObjects:()=>not,assert:()=>$o,createIterable:()=>Xs,fp64LowPart:()=>tD,getShaderAssembler:()=>xS,gouraudLighting:()=>tS,log:()=>br,phongLighting:()=>eS,picking:()=>Mo,project:()=>dm,project32:()=>Ei,shadow:()=>Q_});var Oq=`uniform arcUniforms {
  bool greatCircle;
  bool useShortestPath;
  float numSegments;
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  highp int widthUnits;
} arc;
`,Bq={name:"arc",vs:Oq,fs:Oq,uniformTypes:{greatCircle:"f32",useShortestPath:"f32",numSegments:"f32",widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",widthUnits:"i32"}};var Dq=`#version 300 es
#define SHADER_NAME arc-layer-vertex-shader
in vec4 instanceSourceColors;
in vec4 instanceTargetColors;
in vec3 instanceSourcePositions;
in vec3 instanceSourcePositions64Low;
in vec3 instanceTargetPositions;
in vec3 instanceTargetPositions64Low;
in vec3 instancePickingColors;
in float instanceWidths;
in float instanceHeights;
in float instanceTilts;
out vec4 vColor;
out vec2 uv;
out float isValid;
float paraboloid(float distance, float sourceZ, float targetZ, float ratio) {
float deltaZ = targetZ - sourceZ;
float dh = distance * instanceHeights;
if (dh == 0.0) {
return sourceZ + deltaZ * ratio;
}
float unitZ = deltaZ / dh;
float p2 = unitZ * unitZ + 1.0;
float dir = step(deltaZ, 0.0);
float z0 = mix(sourceZ, targetZ, dir);
float r = mix(ratio, 1.0 - ratio, dir);
return sqrt(r * (p2 - r)) * dh + z0;
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {
vec2 dir_screenspace = normalize(line_clipspace * project.viewportSize);
dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
return dir_screenspace * offset_direction * width / 2.0;
}
float getSegmentRatio(float index) {
return smoothstep(0.0, 1.0, index / (arc.numSegments - 1.0));
}
vec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {
float distance = length(source.xy - target.xy);
float z = paraboloid(distance, source.z, target.z, segmentRatio);
float tiltAngle = radians(instanceTilts);
vec2 tiltDirection = normalize(target.xy - source.xy);
vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);
return vec3(
mix(source.xy, target.xy, segmentRatio) + tilt,
z * cos(tiltAngle)
);
}
float getAngularDist (vec2 source, vec2 target) {
vec2 sourceRadians = radians(source);
vec2 targetRadians = radians(target);
vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);
vec2 shd_sq = sin_half_delta * sin_half_delta;
float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;
return 2.0 * asin(sqrt(a));
}
vec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {
vec2 lngLat;
if(abs(angularDist - PI) < 0.001) {
lngLat = (1.0 - t) * source.xy + t * target.xy;
} else {
float a = sin((1.0 - t) * angularDist);
float b = sin(t * angularDist);
vec3 p = source3D.yxz * a + target3D.yxz * b;
lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));
}
float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);
return vec3(lngLat, z);
}
void main(void) {
geometry.worldPosition = instanceSourcePositions;
geometry.worldPositionAlt = instanceTargetPositions;
float segmentIndex = float(gl_VertexID / 2);
float segmentSide = mod(float(gl_VertexID), 2.) == 0. ? -1. : 1.;
float segmentRatio = getSegmentRatio(segmentIndex);
float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));
float nextSegmentRatio = getSegmentRatio(min(arc.numSegments - 1.0, segmentIndex + 1.0));
float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
isValid = 1.0;
uv = vec2(segmentRatio, segmentSide);
geometry.uv = uv;
geometry.pickingColor = instancePickingColors;
vec4 curr;
vec4 next;
vec3 source;
vec3 target;
if ((arc.greatCircle || project.projectionMode == PROJECTION_MODE_GLOBE) && project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));
target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));
float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);
vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);
vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);
vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);
if (abs(currPos.x - prevPos.x) > 180.0) {
indexDir = -1.0;
isValid = 0.0;
} else if (abs(currPos.x - nextPos.x) > 180.0) {
indexDir = 1.0;
isValid = 0.0;
}
nextPos = indexDir < 0.0 ? prevPos : nextPos;
nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;
if (isValid == 0.0) {
nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;
float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);
currPos = mix(currPos, nextPos, t);
segmentRatio = mix(segmentRatio, nextSegmentRatio, t);
}
vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);
vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);
curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);
next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));
} else {
vec3 source_world = instanceSourcePositions;
vec3 target_world = instanceTargetPositions;
if (arc.useShortestPath) {
source_world.x = mod(source_world.x + 180., 360.0) - 180.;
target_world.x = mod(target_world.x + 180., 360.0) - 180.;
float deltaLng = target_world.x - source_world.x;
if (deltaLng > 180.) target_world.x -= 360.;
if (deltaLng < -180.) source_world.x -= 360.;
}
source = project_position(source_world, instanceSourcePositions64Low);
target = project_position(target_world, instanceTargetPositions64Low);
float antiMeridianX = 0.0;
if (arc.useShortestPath) {
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
antiMeridianX = -(project.coordinateOrigin.x + 180.) / 360. * TILE_SIZE;
}
float thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);
if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {
isValid = 0.0;
indexDir = sign(segmentRatio - thresholdRatio);
segmentRatio = thresholdRatio;
}
}
nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;
vec3 currPos = interpolateFlat(source, target, segmentRatio);
vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);
if (arc.useShortestPath) {
if (nextPos.x < antiMeridianX) {
currPos.x += TILE_SIZE;
nextPos.x += TILE_SIZE;
}
}
curr = project_common_position_to_clipspace(vec4(currPos, 1.0));
next = project_common_position_to_clipspace(vec4(nextPos, 1.0));
geometry.position = vec4(currPos, 1.0);
}
float widthPixels = clamp(
project_size_to_pixel(instanceWidths * arc.widthScale, arc.widthUnits),
arc.widthMinPixels, arc.widthMaxPixels
);
vec3 offset = vec3(
getExtrusionOffset((next.xy - curr.xy) * indexDir, segmentSide, widthPixels),
0.0);
DECKGL_FILTER_SIZE(offset, geometry);
DECKGL_FILTER_GL_POSITION(curr, geometry);
gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);
vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);
vColor = vec4(color.rgb, color.a * layer.opacity);
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var Nq=`#version 300 es
#define SHADER_NAME arc-layer-fragment-shader
precision highp float;
in vec4 vColor;
in vec2 uv;
in float isValid;
out vec4 fragColor;
void main(void) {
if (isValid == 0.0) {
discard;
}
fragColor = vColor;
geometry.uv = uv;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var t3=[0,0,0,255],Lvt={getSourcePosition:{type:"accessor",value:e=>e.sourcePosition},getTargetPosition:{type:"accessor",value:e=>e.targetPosition},getSourceColor:{type:"accessor",value:t3},getTargetColor:{type:"accessor",value:t3},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,numSegments:{type:"number",value:50,min:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}},$2=class extends qi{getBounds(){return this.getAttributeManager()?.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:Dq,fs:Nq,modules:[Ei,Mo,Bq]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getSourceColor",defaultValue:t3},instanceTargetColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getTargetColor",defaultValue:t3},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}updateState(t){super.updateState(t),t.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:t}){let{widthUnits:r,widthScale:n,widthMinPixels:i,widthMaxPixels:o,greatCircle:s,wrapLongitude:c,numSegments:l}=this.props,h={numSegments:l,widthUnits:us[r],widthScale:n,widthMinPixels:i,widthMaxPixels:o,greatCircle:s,useShortestPath:c},p=this.state.model;p.shaderInputs.setProps({arc:h}),p.setVertexCount(l*2),p.draw(this.context.renderPass)}_getModel(){return new jn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),topology:"triangle-strip",isInstanced:!0})}};$2.layerName="ArcLayer";$2.defaultProps=Lvt;var e3=$2;var Ovt=new Uint32Array([0,2,1,0,3,2]),Bvt=new Float32Array([0,1,0,0,1,0,1,1]);function PD(e,t){if(!t)return Dvt(e);let r=Math.max(Math.abs(e[0][0]-e[3][0]),Math.abs(e[1][0]-e[2][0])),n=Math.max(Math.abs(e[1][1]-e[0][1]),Math.abs(e[2][1]-e[3][1])),i=Math.ceil(r/t)+1,o=Math.ceil(n/t)+1,s=(i-1)*(o-1)*6,c=new Uint32Array(s),l=new Float32Array(i*o*2),h=new Float64Array(i*o*3),p=0,x=0;for(let w=0;w<i;w++){let E=w/(i-1);for(let P=0;P<o;P++){let B=P/(o-1),D=Nvt(e,E,B);h[p*3+0]=D[0],h[p*3+1]=D[1],h[p*3+2]=D[2]||0,l[p*2+0]=E,l[p*2+1]=1-B,w>0&&P>0&&(c[x++]=p-o,c[x++]=p-o-1,c[x++]=p-1,c[x++]=p-o,c[x++]=p-1,c[x++]=p),p++}}return{vertexCount:s,positions:h,indices:c,texCoords:l}}function Dvt(e){let t=new Float64Array(12);for(let r=0;r<e.length;r++)t[r*3+0]=e[r][0],t[r*3+1]=e[r][1],t[r*3+2]=e[r][2]||0;return{vertexCount:6,positions:t,indices:Ovt,texCoords:Bvt}}function Nvt(e,t,r){return ka(ka(e[0],e[1],r),ka(e[3],e[2],r),t)}var kq=`uniform bitmapUniforms {
  vec4 bounds;
  float coordinateConversion;
  float desaturate;
  vec3 tintColor;
  vec4 transparentColor;
} bitmap;
`,Fq={name:"bitmap",vs:kq,fs:kq,uniformTypes:{bounds:"vec4<f32>",coordinateConversion:"f32",desaturate:"f32",tintColor:"vec3<f32>",transparentColor:"vec4<f32>"}};var zq=`#version 300 es
#define SHADER_NAME bitmap-layer-vertex-shader

in vec2 texCoords;
in vec3 positions;
in vec3 positions64Low;

out vec2 vTexCoord;
out vec2 vTexPos;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (bitmap.coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project.commonOrigin.xy;
  } else if (bitmap.coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`;var kvt=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,Uq=`#version 300 es
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

in vec2 vTexCoord;
in vec2 vTexPos;

out vec4 fragColor;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), bitmap.desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * bitmap.tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  if (bitmap.transparentColor.a == 0.0) {
    return vec4(color, alpha);
  }
  float blendedAlpha = alpha + bitmap.transparentColor.a * (1.0 - alpha);
  float highLightRatio = alpha / blendedAlpha;
  vec3 blendedRGB = mix(bitmap.transparentColor.rgb, color, highLightRatio);
  return vec4(blendedRGB, blendedAlpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bitmap.bounds[0]) / (bitmap.bounds[2] - bitmap.bounds[0]),
    (pos.y - bitmap.bounds[3]) / (bitmap.bounds[1] - bitmap.bounds[3])
  );
}

${kvt}

void main(void) {
  vec2 uv = vTexCoord;
  if (bitmap.coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (bitmap.coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture(bitmapTexture, uv);

  fragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * layer.opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(fragColor, geometry);

  if (bool(picking.isActive) && !bool(picking.isAttribute)) {
    // Since instance information is not used, we can use picking color for pixel index
    fragColor.rgb = packUVsIntoRGB(uv);
  }
}
`;var Fvt={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:Yr.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0,value:null}},Q2=class extends qi{getShaders(){return super.getShaders({vs:zq,fs:Uq,modules:[Ei,Mo,Fq]})}initializeState(){let t=this.getAttributeManager();t.remove(["instancePickingColors"]);let r=!0;t.add({indices:{size:1,isIndexed:!0,update:n=>n.value=this.state.mesh.indices,noAlloc:r},positions:{size:3,type:"float64",fp64:this.use64bitPositions(),update:n=>n.value=this.state.mesh.positions,noAlloc:r},texCoords:{size:2,update:n=>n.value=this.state.mesh.texCoords,noAlloc:r}})}updateState({props:t,oldProps:r,changeFlags:n}){let i=this.getAttributeManager();if(n.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),i.invalidateAll()),t.bounds!==r.bounds){let o=this.state.mesh,s=this._createMesh();this.state.model.setVertexCount(s.vertexCount);for(let c in s)o&&o[c]!==s[c]&&i.invalidate(c);this.setState({mesh:s,...this._getCoordinateUniforms()})}else t._imageCoordinateSystem!==r._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(t){let{image:r}=this.props,n=t.info;if(!n.color||!r)return n.bitmap=null,n;let{width:i,height:o}=r;n.index=0;let s=zvt(n.color);return n.bitmap={size:{width:i,height:o},uv:s,pixel:[Math.floor(s[0]*i),Math.floor(s[1]*o)]},n}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(t){super._updateAutoHighlight({...t,color:this.encodePickingColor(0)})}_createMesh(){let{bounds:t}=this.props,r=t;return Vq(t)&&(r=[[t[0],t[1]],[t[0],t[3]],[t[2],t[3]],[t[2],t[1]]]),PD(r,this.context.viewport.resolution)}_getModel(){return new jn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),topology:"triangle-list",isInstanced:!1})}draw(t){let{shaderModuleProps:r}=t,{model:n,coordinateConversion:i,bounds:o,disablePicking:s}=this.state,{image:c,desaturate:l,transparentColor:h,tintColor:p}=this.props;if(!(r.picking.isActive&&s)&&c&&n){let x={bitmapTexture:c,bounds:o,coordinateConversion:i,desaturate:l,tintColor:p.slice(0,3).map(w=>w/255),transparentColor:h.map(w=>w/255)};n.shaderInputs.setProps({bitmap:x}),n.draw(this.context.renderPass)}}_getCoordinateUniforms(){let{LNGLAT:t,CARTESIAN:r,DEFAULT:n}=Yr,{_imageCoordinateSystem:i}=this.props;if(i!==n){let{bounds:o}=this.props;if(!Vq(o))throw new Error("_imageCoordinateSystem only supports rectangular bounds");let s=this.context.viewport.resolution?t:r;if(i=i===t?t:r,i===t&&s===r)return{coordinateConversion:-1,bounds:o};if(i===r&&s===t){let c=za([o[0],o[1]]),l=za([o[2],o[3]]);return{coordinateConversion:1,bounds:[c[0],c[1],l[0],l[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}};Q2.layerName="BitmapLayer";Q2.defaultProps=Fvt;var r3=Q2;function zvt(e){let[t,r,n]=e,i=(n&240)/256,o=(n&15)/16;return[(t+o)/256,(r+i)/256]}function Vq(e){return Number.isFinite(e[0])}var jq=`uniform iconUniforms {
  float sizeScale;
  vec2 iconsTextureDim;
  float sizeMinPixels;
  float sizeMaxPixels;
  bool billboard;
  highp int sizeUnits;
  float alphaCutoff;
} icon;
`,Hq={name:"icon",vs:jq,fs:jq,uniformTypes:{sizeScale:"f32",iconsTextureDim:"vec2<f32>",sizeMinPixels:"f32",sizeMaxPixels:"f32",billboard:"f32",sizeUnits:"i32",alphaCutoff:"f32"}};var Wq=`#version 300 es
#define SHADER_NAME icon-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceSizes;
in float instanceAngles;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec4 instanceIconFrames;
in float instanceColorModes;
in vec2 instanceOffsets;
in vec2 instancePixelOffset;
out float vColorMode;
out vec4 vColor;
out vec2 vTextureCoords;
out vec2 uv;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = angle * PI / 180.0;
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vec2 iconSize = instanceIconFrames.zw;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * icon.sizeScale, icon.sizeUnits),
icon.sizeMinPixels, icon.sizeMaxPixels
);
float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
pixelOffset += instancePixelOffset;
pixelOffset.y *= -1.0;
if (icon.billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vTextureCoords = mix(
instanceIconFrames.xy,
instanceIconFrames.xy + iconSize,
(positions.xy + 1.0) / 2.0
) / icon.iconsTextureDim;
vColor = instanceColors;
DECKGL_FILTER_COLOR(vColor, geometry);
vColorMode = instanceColorModes;
}
`;var qq=`#version 300 es
#define SHADER_NAME icon-layer-fragment-shader
precision highp float;
uniform sampler2D iconsTexture;
in float vColorMode;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec4 texColor = texture(iconsTexture, vTextureCoords);
vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
float a = texColor.a * layer.opacity * vColor.a;
if (a < icon.alphaCutoff) {
discard;
}
fragColor = vec4(color, a);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var Uvt=1024,Vvt=4,Gq=()=>{},Xq={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},jvt={x:0,y:0,width:0,height:0};function Hvt(e){return Math.pow(2,Math.ceil(Math.log2(e)))}function Wvt(e,t,r,n){let i=Math.min(r/t.width,n/t.height),o=Math.floor(t.width*i),s=Math.floor(t.height*i);return i===1?{image:t,width:o,height:s}:(e.canvas.height=s,e.canvas.width=o,e.clearRect(0,0,o,s),e.drawImage(t,0,0,t.width,t.height,0,0,o,s),{image:e.canvas,width:o,height:s})}function J2(e){return e&&(e.id||e.url)}function qvt(e,t,r,n){let{width:i,height:o,device:s}=e,c=s.createTexture({format:"rgba8unorm",width:t,height:r,sampler:n,mipmaps:!0}),l=s.createCommandEncoder();return l.copyTextureToTexture({sourceTexture:e,destinationTexture:c,width:i,height:o}),l.finish(),e.destroy(),c}function Yq(e,t,r){for(let n=0;n<t.length;n++){let{icon:i,xOffset:o}=t[n],s=J2(i);e[s]={...i,x:o,y:r}}}function Gvt({icons:e,buffer:t,mapping:r={},xOffset:n=0,yOffset:i=0,rowHeight:o=0,canvasWidth:s}){let c=[];for(let l=0;l<e.length;l++){let h=e[l],p=J2(h);if(!r[p]){let{height:x,width:w}=h;n+w+t>s&&(Yq(r,c,i),n=0,i=o+i+t,o=0,c=[]),c.push({icon:h,xOffset:n}),n=n+w+t,o=Math.max(o,x)}}return c.length>0&&Yq(r,c,i),{mapping:r,rowHeight:o,xOffset:n,yOffset:i,canvasWidth:s,canvasHeight:Hvt(o+i+t)}}function Xvt(e,t,r){if(!e||!t)return null;r=r||{};let n={},{iterable:i,objectInfo:o}=Xs(e);for(let s of i){o.index++;let c=t(s,o),l=J2(c);if(!c)throw new Error("Icon is missing.");if(!c.url)throw new Error("Icon url is missing.");!n[l]&&(!r[l]||c.url!==r[l].url)&&(n[l]={...c,source:s,sourceIndex:o.index})}return n}var tb=class{constructor(t,{onUpdate:r=Gq,onError:n=Gq}){this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._samplerParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=Vvt,this._canvasWidth=Uvt,this._canvasHeight=0,this._canvas=null,this.device=t,this.onUpdate=r,this.onError=n}finalize(){this._texture?.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(t){let r=this._autoPacking?J2(t):t;return this._mapping[r]||jvt}setProps({loadOptions:t,autoPacking:r,iconAtlas:n,iconMapping:i,textureParameters:o}){t&&(this._loadOptions=t),r!==void 0&&(this._autoPacking=r),i&&(this._mapping=i),n&&(this._texture?.delete(),this._texture=null,this._externalTexture=n),o&&(this._samplerParameters=o)}get isLoaded(){return this._pendingCount===0}packIcons(t,r){if(!this._autoPacking||typeof document>"u")return;let n=Object.values(Xvt(t,r,this._mapping)||{});if(n.length>0){let{mapping:i,xOffset:o,yOffset:s,rowHeight:c,canvasHeight:l}=Gvt({icons:n,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=c,this._mapping=i,this._xOffset=o,this._yOffset=s,this._canvasHeight=l,this._texture||(this._texture=this.device.createTexture({format:"rgba8unorm",width:this._canvasWidth,height:this._canvasHeight,sampler:this._samplerParameters||Xq,mipmaps:!0})),this._texture.height!==this._canvasHeight&&(this._texture=qvt(this._texture,this._canvasWidth,this._canvasHeight,this._samplerParameters||Xq)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(n)}}_loadIcons(t){let r=this._canvas.getContext("2d",{willReadFrequently:!0});for(let n of t)this._pendingCount++,xa(n.url,this._loadOptions).then(i=>{let o=J2(n),s=this._mapping[o],{x:c,y:l,width:h,height:p}=s,{image:x,width:w,height:E}=Wvt(r,i,h,p);this._texture?.copyExternalImage({image:x,x:c+(h-w)/2,y:l+(p-E)/2,width:w,height:E}),s.width=w,s.height=E,this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}};var Kq=[0,0,0,255],Yvt={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:e=>e.position},getIcon:{type:"accessor",value:e=>e.icon},getColor:{type:"accessor",value:Kq},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0,value:null}},eb=class extends qi{getShaders(){return super.getShaders({vs:Wq,fs:qq,modules:[Ei,Mo,Hq]})}initializeState(){this.state={iconManager:new tb(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:"uint8",accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:Kq},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(t){super.updateState(t);let{props:r,oldProps:n,changeFlags:i}=t,o=this.getAttributeManager(),{iconAtlas:s,iconMapping:c,data:l,getIcon:h,textureParameters:p}=r,{iconManager:x}=this.state;if(typeof s=="string")return;let w=s||this.internalState.isAsyncPropLoading("iconAtlas");x.setProps({loadOptions:r.loadOptions,autoPacking:!w,iconAtlas:s,iconMapping:w?c:null,textureParameters:p}),w?n.iconMapping!==r.iconMapping&&o.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&x.packIcons(l,h),i.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),o.invalidateAll())}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(t){super.finalizeState(t),this.state.iconManager.finalize()}draw({uniforms:t}){let{sizeScale:r,sizeMinPixels:n,sizeMaxPixels:i,sizeUnits:o,billboard:s,alphaCutoff:c}=this.props,{iconManager:l}=this.state,h=l.getTexture();if(h){let p=this.state.model,x={iconsTexture:h,iconsTextureDim:[h.width,h.height],sizeUnits:us[o],sizeScale:r,sizeMinPixels:n,sizeMaxPixels:i,billboard:s,alphaCutoff:c};p.shaderInputs.setProps({icon:x}),p.draw(this.context.renderPass)}}_getModel(){let t=[-1,-1,1,-1,-1,1,1,1];return new jn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Mi({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array(t)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(t){let r=this.getCurrentLayer()?.props.onIconError;r?r(t):br.error(t.error.message)()}getInstanceOffset(t){let{width:r,height:n,anchorX:i=r/2,anchorY:o=n/2}=this.state.iconManager.getIconMapping(t);return[r/2-i,n/2-o]}getInstanceColorMode(t){return this.state.iconManager.getIconMapping(t).mask?1:0}getInstanceIconFrame(t){let{x:r,y:n,width:i,height:o}=this.state.iconManager.getIconMapping(t);return[r,n,i,o]}};eb.defaultProps=Yvt;eb.layerName="IconLayer";var py=eb;var Zq=`uniform lineUniforms {
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  float useShortestPath;
  highp int widthUnits;
} line;
`,$q={name:"line",vs:Zq,fs:Zq,uniformTypes:{widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",useShortestPath:"f32",widthUnits:"i32"}};var Qq=`#version 300 es
#define SHADER_NAME line-layer-vertex-shader
in vec3 positions;
in vec3 instanceSourcePositions;
in vec3 instanceTargetPositions;
in vec3 instanceSourcePositions64Low;
in vec3 instanceTargetPositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in float instanceWidths;
out vec4 vColor;
out vec2 uv;
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {
vec2 dir_screenspace = normalize(line_clipspace * project.viewportSize);
dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
return dir_screenspace * offset_direction * width / 2.0;
}
vec3 splitLine(vec3 a, vec3 b, float x) {
float t = (x - a.x) / (b.x - a.x);
return vec3(x, mix(a.yz, b.yz, t));
}
void main(void) {
geometry.worldPosition = instanceSourcePositions;
geometry.worldPositionAlt = instanceTargetPositions;
vec3 source_world = instanceSourcePositions;
vec3 target_world = instanceTargetPositions;
vec3 source_world_64low = instanceSourcePositions64Low;
vec3 target_world_64low = instanceTargetPositions64Low;
if (line.useShortestPath > 0.5 || line.useShortestPath < -0.5) {
source_world.x = mod(source_world.x + 180., 360.0) - 180.;
target_world.x = mod(target_world.x + 180., 360.0) - 180.;
float deltaLng = target_world.x - source_world.x;
if (deltaLng * line.useShortestPath > 180.) {
source_world.x += 360. * line.useShortestPath;
source_world = splitLine(source_world, target_world, 180. * line.useShortestPath);
source_world_64low = vec3(0.0);
} else if (deltaLng * line.useShortestPath < -180.) {
target_world.x += 360. * line.useShortestPath;
target_world = splitLine(source_world, target_world, 180. * line.useShortestPath);
target_world_64low = vec3(0.0);
} else if (line.useShortestPath < 0.) {
gl_Position = vec4(0.);
return;
}
}
vec4 source_commonspace;
vec4 target_commonspace;
vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);
vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);
float segmentIndex = positions.x;
vec4 p = mix(source, target, segmentIndex);
geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);
uv = positions.xy;
geometry.uv = uv;
geometry.pickingColor = instancePickingColors;
float widthPixels = clamp(
project_size_to_pixel(instanceWidths * line.widthScale, line.widthUnits),
line.widthMinPixels, line.widthMaxPixels
);
vec3 offset = vec3(
getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),
0.0);
DECKGL_FILTER_SIZE(offset, geometry);
DECKGL_FILTER_GL_POSITION(p, geometry);
gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);
vColor = vec4(instanceColors.rgb, instanceColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var Jq=`#version 300 es
#define SHADER_NAME line-layer-fragment-shader
precision highp float;
in vec4 vColor;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var Kvt=[0,0,0,255],Zvt={getSourcePosition:{type:"accessor",value:e=>e.sourcePosition},getTargetPosition:{type:"accessor",value:e=>e.targetPosition},getColor:{type:"accessor",value:Kvt},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}},rb=class extends qi{getBounds(){return this.getAttributeManager()?.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:Qq,fs:Jq,modules:[Ei,Mo,$q]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}updateState(t){super.updateState(t),t.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:t}){let{widthUnits:r,widthScale:n,widthMinPixels:i,widthMaxPixels:o,wrapLongitude:s}=this.props,c=this.state.model,l={widthUnits:us[r],widthScale:n,widthMinPixels:i,widthMaxPixels:o,useShortestPath:s?1:0};c.shaderInputs.setProps({line:l}),c.draw(this.context.renderPass),s&&(c.shaderInputs.setProps({line:{...l,useShortestPath:-1}}),c.draw(this.context.renderPass))}_getModel(){let t=[0,-1,0,0,1,0,1,-1,0,1,1,0];return new jn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Mi({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array(t)}}}),isInstanced:!0})}};rb.layerName="LineLayer";rb.defaultProps=Zvt;var tG=rb;var eG=`uniform pointCloudUniforms {
  float radiusPixels;
  highp int sizeUnits;
} pointCloud;
`,rG={name:"pointCloud",vs:eG,fs:eG,uniformTypes:{radiusPixels:"f32",sizeUnits:"i32"}};var nG=`#version 300 es
#define SHADER_NAME point-cloud-layer-vertex-shader
in vec3 positions;
in vec3 instanceNormals;
in vec4 instanceColors;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec3 instancePickingColors;
out vec4 vColor;
out vec2 unitPosition;
void main(void) {
geometry.worldPosition = instancePositions;
geometry.normal = project_normal(instanceNormals);
unitPosition = positions.xy;
geometry.uv = unitPosition;
geometry.pickingColor = instancePickingColors;
vec3 offset = vec3(positions.xy * project_size_to_pixel(pointCloud.radiusPixels, pointCloud.sizeUnits), 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, instanceColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var iG=`#version 300 es
#define SHADER_NAME point-cloud-layer-fragment-shader
precision highp float;
in vec4 vColor;
in vec2 unitPosition;
out vec4 fragColor;
void main(void) {
geometry.uv = unitPosition.xy;
float distToCenter = length(unitPosition);
if (distToCenter > 1.0) {
discard;
}
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var oG=[0,0,0,255],sG=[0,0,1],$vt={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:e=>e.position},getNormal:{type:"accessor",value:sG},getColor:{type:"accessor",value:oG},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};function Qvt(e){let{header:t,attributes:r}=e;if(!(!t||!r)&&(e.length=t.vertexCount,r.POSITION&&(r.instancePositions=r.POSITION),r.NORMAL&&(r.instanceNormals=r.NORMAL),r.COLOR_0)){let{size:n,value:i}=r.COLOR_0;r.instanceColors={size:n,type:"unorm8",value:i}}}var nb=class extends qi{getShaders(){return super.getShaders({vs:nG,fs:iG,modules:[Ei,fm,Mo,rG]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:sG},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:oG}})}updateState(t){let{changeFlags:r,props:n}=t;super.updateState(t),r.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll()),r.dataChanged&&Qvt(n.data)}draw({uniforms:t}){let{pointSize:r,sizeUnits:n}=this.props,i=this.state.model,o={sizeUnits:us[n],radiusPixels:r};i.shaderInputs.setProps({pointCloud:o}),i.draw(this.context.renderPass)}_getModel(){let t=[];for(let r=0;r<3;r++){let n=r/3*Math.PI*2;t.push(Math.cos(n)*2,Math.sin(n)*2,0)}return new jn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Mi({topology:"triangle-list",attributes:{positions:new Float32Array(t)}}),isInstanced:!0})}};nb.layerName="PointCloudLayer";nb.defaultProps=$vt;var n3=nb;var aG=`uniform scatterplotUniforms {
  float radiusScale;
  float radiusMinPixels;
  float radiusMaxPixels;
  float lineWidthScale;
  float lineWidthMinPixels;
  float lineWidthMaxPixels;
  float stroked;
  bool filled;
  bool antialiasing;
  bool billboard;
  highp int radiusUnits;
  highp int lineWidthUnits;
} scatterplot;
`,cG={name:"scatterplot",vs:aG,fs:aG,uniformTypes:{radiusScale:"f32",radiusMinPixels:"f32",radiusMaxPixels:"f32",lineWidthScale:"f32",lineWidthMinPixels:"f32",lineWidthMaxPixels:"f32",stroked:"f32",filled:"f32",antialiasing:"f32",billboard:"f32",radiusUnits:"i32",lineWidthUnits:"i32"}};var lG=`#version 300 es
#define SHADER_NAME scatterplot-layer-vertex-shader
in vec3 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceRadius;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
out vec4 vFillColor;
out vec4 vLineColor;
out vec2 unitPosition;
out float innerUnitRadius;
out float outerRadiusPixels;
void main(void) {
geometry.worldPosition = instancePositions;
outerRadiusPixels = clamp(
project_size_to_pixel(scatterplot.radiusScale * instanceRadius, scatterplot.radiusUnits),
scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels
);
float lineWidthPixels = clamp(
project_size_to_pixel(scatterplot.lineWidthScale * instanceLineWidths, scatterplot.lineWidthUnits),
scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels
);
outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;
float edgePadding = scatterplot.antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
unitPosition = edgePadding * positions.xy;
geometry.uv = unitPosition;
geometry.pickingColor = instancePickingColors;
innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / outerRadiusPixels;
if (scatterplot.billboard) {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = edgePadding * positions * outerRadiusPixels;
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`;var uG=`#version 300 es
#define SHADER_NAME scatterplot-layer-fragment-shader
precision highp float;
in vec4 vFillColor;
in vec4 vLineColor;
in vec2 unitPosition;
in float innerUnitRadius;
in float outerRadiusPixels;
out vec4 fragColor;
void main(void) {
geometry.uv = unitPosition;
float distToCenter = length(unitPosition) * outerRadiusPixels;
float inCircle = scatterplot.antialiasing ?
smoothedge(distToCenter, outerRadiusPixels) :
step(distToCenter, outerRadiusPixels);
if (inCircle == 0.0) {
discard;
}
if (scatterplot.stroked > 0.5) {
float isLine = scatterplot.antialiasing ?
smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
step(innerUnitRadius * outerRadiusPixels, distToCenter);
if (scatterplot.filled) {
fragColor = mix(vFillColor, vLineColor, isLine);
} else {
if (isLine == 0.0) {
discard;
}
fragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
}
} else if (scatterplot.filled == false) {
discard;
} else {
fragColor = vFillColor;
}
fragColor.a *= inCircle;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var hG=[0,0,0,255],Jvt={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:e=>e.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:hG},getLineColor:{type:"accessor",value:hG},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}},ib=class extends qi{getShaders(){return super.getShaders({vs:lG,fs:uG,modules:[Ei,Mo,cG]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){super.updateState(t),t.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:t}){let{radiusUnits:r,radiusScale:n,radiusMinPixels:i,radiusMaxPixels:o,stroked:s,filled:c,billboard:l,antialiasing:h,lineWidthUnits:p,lineWidthScale:x,lineWidthMinPixels:w,lineWidthMaxPixels:E}=this.props,P={stroked:s,filled:c,billboard:l,antialiasing:h,radiusUnits:us[r],radiusScale:n,radiusMinPixels:i,radiusMaxPixels:o,lineWidthUnits:us[p],lineWidthScale:x,lineWidthMinPixels:w,lineWidthMaxPixels:E},B=this.state.model;B.shaderInputs.setProps({scatterplot:P}),B.draw(this.context.renderPass)}_getModel(){let t=[-1,-1,0,1,-1,0,-1,1,0,1,1,0];return new jn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Mi({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array(t)}}}),isInstanced:!0})}};ib.defaultProps=Jvt;ib.layerName="ScatterplotLayer";var i3=ib;var dy={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function E0(e,t,r={}){return fG(e,r)!==t?(t2t(e,r),!0):!1}function fG(e,t={}){return Math.sign(o3(e,t))}var ID={x:0,y:1,z:2};function o3(e,t={}){let{start:r=0,end:n=e.length,plane:i="xy"}=t,o=t.size||2,s=0,c=ID[i[0]],l=ID[i[1]];for(let h=r,p=n-o;h<n;h+=o)s+=(e[h+c]-e[p+c])*(e[h+l]+e[p+l]),p=h;return s/2}function t2t(e,t){let{start:r=0,end:n=e.length,size:i=2}=t,o=(n-r)/i,s=Math.floor(o/2);for(let c=0;c<s;++c){let l=r+c*i,h=r+(o-1-c)*i;for(let p=0;p<i;++p){let x=e[l+p];e[l+p]=e[h+p],e[h+p]=x}}}function Nl(e,t){let r=t.length,n=e.length;if(n>0){let i=!0;for(let o=0;o<r;o++)if(e[n-r+o]!==t[o]){i=!1;break}if(i)return!1}for(let i=0;i<r;i++)e[n+i]=t[i];return!0}function ob(e,t){let r=t.length;for(let n=0;n<r;n++)e[n]=t[n]}function wm(e,t,r,n,i=[]){let o=n+t*r;for(let s=0;s<r;s++)i[s]=e[o+s];return i}function s3(e,t,r,n,i=[]){let o,s;if(r&8)o=(n[3]-e[1])/(t[1]-e[1]),s=3;else if(r&4)o=(n[1]-e[1])/(t[1]-e[1]),s=1;else if(r&2)o=(n[2]-e[0])/(t[0]-e[0]),s=2;else if(r&1)o=(n[0]-e[0])/(t[0]-e[0]),s=0;else return null;for(let c=0;c<e.length;c++)i[c]=(s&1)===c?n[s]:o*(t[c]-e[c])+e[c];return i}function sb(e,t){let r=0;return e[0]<t[0]?r|=1:e[0]>t[2]&&(r|=2),e[1]<t[1]?r|=4:e[1]>t[3]&&(r|=8),r}function ab(e,t){let{size:r=2,broken:n=!1,gridResolution:i=10,gridOffset:o=[0,0],startIndex:s=0,endIndex:c=e.length}=t||{},l=(c-s)/r,h=[],p=[h],x=wm(e,0,r,s),w,E,P=mG(x,i,o,[]),B=[];Nl(h,x);for(let D=1;D<l;D++){for(w=wm(e,D,r,s,w),E=sb(w,P);E;){s3(x,w,E,P,B);let W=sb(B,P);W&&(s3(x,B,W,P,B),E=W),Nl(h,B),ob(x,B),n2t(P,i,E),n&&h.length>r&&(h=[],p.push(h),Nl(h,x)),E=sb(w,P)}Nl(h,w),ob(x,w)}return n?p:p[0]}var pG=0,r2t=1;function cb(e,t=null,r){if(!e.length)return[];let{size:n=2,gridResolution:i=10,gridOffset:o=[0,0],edgeTypes:s=!1}=r||{},c=[],l=[{pos:e,types:s?new Array(e.length/n).fill(r2t):null,holes:t||[]}],h=[[],[]],p=[];for(;l.length;){let{pos:x,types:w,holes:E}=l.shift();i2t(x,n,E[0]||x.length,h),p=mG(h[0],i,o,p);let P=sb(h[1],p);if(P){let B=dG(x,w,n,0,E[0]||x.length,p,P),D={pos:B[0].pos,types:B[0].types,holes:[]},W={pos:B[1].pos,types:B[1].types,holes:[]};l.push(D,W);for(let X=0;X<E.length;X++)B=dG(x,w,n,E[X],E[X+1]||x.length,p,P),B[0]&&(D.holes.push(D.pos.length),D.pos=a3(D.pos,B[0].pos),s&&(D.types=a3(D.types,B[0].types))),B[1]&&(W.holes.push(W.pos.length),W.pos=a3(W.pos,B[1].pos),s&&(W.types=a3(W.types,B[1].types)))}else{let B={positions:x};s&&(B.edgeTypes=w),E.length&&(B.holeIndices=E),c.push(B)}}return c}function dG(e,t,r,n,i,o,s){let c=(i-n)/r,l=[],h=[],p=[],x=[],w=[],E,P,B,D=wm(e,c-1,r,n),W=Math.sign(s&8?D[1]-o[3]:D[0]-o[2]),X=t&&t[c-1],q=0,$=0;for(let et=0;et<c;et++)E=wm(e,et,r,n,E),P=Math.sign(s&8?E[1]-o[3]:E[0]-o[2]),B=t&&t[n/r+et],P&&W&&W!==P&&(s3(D,E,s,o,w),Nl(l,w)&&p.push(X),Nl(h,w)&&x.push(X)),P<=0?(Nl(l,E)&&p.push(B),q-=P):p.length&&(p[p.length-1]=pG),P>=0?(Nl(h,E)&&x.push(B),$+=P):x.length&&(x[x.length-1]=pG),ob(D,E),W=P,X=B;return[q?{pos:l,types:t&&p}:null,$?{pos:h,types:t&&x}:null]}function mG(e,t,r,n){let i=Math.floor((e[0]-r[0])/t)*t+r[0],o=Math.floor((e[1]-r[1])/t)*t+r[1];return n[0]=i,n[1]=o,n[2]=i+t,n[3]=o+t,n}function n2t(e,t,r){r&8?(e[1]+=t,e[3]+=t):r&4?(e[1]-=t,e[3]-=t):r&2?(e[0]+=t,e[2]+=t):r&1&&(e[0]-=t,e[2]-=t)}function i2t(e,t,r,n){let i=1/0,o=-1/0,s=1/0,c=-1/0;for(let l=0;l<r;l+=t){let h=e[l],p=e[l+1];i=h<i?h:i,o=h>o?h:o,s=p<s?p:s,c=p>c?p:c}return n[0][0]=i,n[0][1]=s,n[1][0]=o,n[1][1]=c,n}function a3(e,t){for(let r=0;r<t.length;r++)e.push(t[r]);return e}var o2t=85.051129;function RD(e,t){let{size:r=2,startIndex:n=0,endIndex:i=e.length,normalize:o=!0}=t||{},s=e.slice(n,i);AG(s,r,0,i-n);let c=ab(s,{size:r,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(let l of c)gG(l,r);return c}function LD(e,t=null,r){let{size:n=2,normalize:i=!0,edgeTypes:o=!1}=r||{};t=t||[];let s=[],c=[],l=0,h=0;for(let x=0;x<=t.length;x++){let w=t[x]||e.length,E=h,P=s2t(e,n,l,w);for(let B=P;B<w;B++)s[h++]=e[B];for(let B=l;B<P;B++)s[h++]=e[B];AG(s,n,E,h),a2t(s,n,E,h,r?.maxLatitude),l=w,c[x]=h}c.pop();let p=cb(s,c,{size:n,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(i)for(let x of p)gG(x.positions,n);return p}function s2t(e,t,r,n){let i=-1,o=-1;for(let s=r+1;s<n;s+=t){let c=Math.abs(e[s]);c>i&&(i=c,o=s-1)}return o}function a2t(e,t,r,n,i=o2t){let o=e[r],s=e[n-t];if(Math.abs(o-s)>180){let c=wm(e,0,t,r);c[0]+=Math.round((s-o)/360)*360,Nl(e,c),c[1]=Math.sign(c[1])*i,Nl(e,c),c[0]=o,Nl(e,c)}}function AG(e,t,r,n){let i=e[0],o;for(let s=r;s<n;s+=t){o=e[s];let c=o-i;(c>180||c<-180)&&(o-=Math.round(c/360)*360),e[s]=i=o}}function gG(e,t){let r,n=e.length/t;for(let o=0;o<n&&(r=e[o*t],(r+180)%360===0);o++);let i=-Math.round(r/360)*360;if(i!==0)for(let o=0;o<n;o++)e[o*t]+=i}var lb=class extends Mi{constructor(t){let{indices:r,attributes:n}=l2t(t);super({...t,indices:r,attributes:n})}};function l2t(e){let{radius:t,height:r=1,nradial:n=10}=e,{vertices:i}=e;i&&(br.assert(i.length>=n),i=i.flatMap(E=>[E[0],E[1]]),E0(i,dy.COUNTER_CLOCKWISE));let o=r>0,s=n+1,c=o?s*3+1:n,l=Math.PI*2/n,h=new Uint16Array(o?n*3*2:0),p=new Float32Array(c*3),x=new Float32Array(c*3),w=0;if(o){for(let E=0;E<s;E++){let P=E*l,B=E%n,D=Math.sin(P),W=Math.cos(P);for(let X=0;X<2;X++)p[w+0]=i?i[B*2]:W*t,p[w+1]=i?i[B*2+1]:D*t,p[w+2]=(1/2-X)*r,x[w+0]=i?i[B*2]:W,x[w+1]=i?i[B*2+1]:D,w+=3}p[w+0]=p[w-3],p[w+1]=p[w-2],p[w+2]=p[w-1],w+=3}for(let E=o?0:1;E<s;E++){let P=Math.floor(E/2)*Math.sign(.5-E%2),B=P*l,D=(P+n)%n,W=Math.sin(B),X=Math.cos(B);p[w+0]=i?i[D*2]:X*t,p[w+1]=i?i[D*2+1]:W*t,p[w+2]=r/2,x[w+2]=1,w+=3}if(o){let E=0;for(let P=0;P<n;P++)h[E++]=P*2+0,h[E++]=P*2+2,h[E++]=P*2+0,h[E++]=P*2+1,h[E++]=P*2+1,h[E++]=P*2+3}return{indices:h,attributes:{POSITION:{size:3,value:p},NORMAL:{size:3,value:x}}}}var _G=`uniform columnUniforms {
  float radius;
  float angle;
  vec2 offset;
  bool extruded;
  bool stroked;
  bool isStroke;
  float coverage;
  float elevationScale;
  float edgeDistance;
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  highp int radiusUnits;
  highp int widthUnits;
} column;
`,yG={name:"column",vs:_G,fs:_G,uniformTypes:{radius:"f32",angle:"f32",offset:"vec2<f32>",extruded:"f32",stroked:"f32",isStroke:"f32",coverage:"f32",elevationScale:"f32",edgeDistance:"f32",widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",radiusUnits:"i32",widthUnits:"i32"}};var xG=`#version 300 es
#define SHADER_NAME column-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;
in vec3 instancePickingColors;
out vec4 vColor;
#ifdef FLAT_SHADING
out vec3 cameraPosition;
out vec4 position_commonspace;
#endif
void main(void) {
geometry.worldPosition = instancePositions;
vec4 color = column.isStroke ? instanceLineColors : instanceFillColors;
mat2 rotationMatrix = mat2(cos(column.angle), sin(column.angle), -sin(column.angle), cos(column.angle));
float elevation = 0.0;
float strokeOffsetRatio = 1.0;
if (column.extruded) {
elevation = instanceElevations * (positions.z + 1.0) / 2.0 * column.elevationScale;
} else if (column.stroked) {
float widthPixels = clamp(
project_size_to_pixel(instanceStrokeWidths * column.widthScale, column.widthUnits),
column.widthMinPixels, column.widthMaxPixels) / 2.0;
float halfOffset = project_pixel_size(widthPixels) / project_size(column.edgeDistance * column.coverage * column.radius);
if (column.isStroke) {
strokeOffsetRatio -= sign(positions.z) * halfOffset;
} else {
strokeOffsetRatio -= halfOffset;
}
}
float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
float dotRadius = column.radius * column.coverage * shouldRender;
geometry.pickingColor = instancePickingColors;
vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
vec3 centroidPosition64Low = instancePositions64Low;
vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + column.offset) * dotRadius;
if (column.radiusUnits == UNIT_METERS) {
offset = project_size(offset);
}
vec3 pos = vec3(offset, 0.);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (column.extruded && !column.isStroke) {
#ifdef FLAT_SHADING
cameraPosition = project.cameraPosition;
position_commonspace = geometry.position;
vColor = vec4(color.rgb, color.a * layer.opacity);
#else
vec3 lightColor = lighting_getLightColor(color.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, color.a * layer.opacity);
#endif
} else {
vColor = vec4(color.rgb, color.a * layer.opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var vG=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader
precision highp float;
out vec4 fragColor;
in vec4 vColor;
#ifdef FLAT_SHADING
in vec3 cameraPosition;
in vec4 position_commonspace;
#endif
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
#ifdef FLAT_SHADING
if (column.extruded && !column.isStroke && !bool(picking.isActive)) {
vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
fragColor.rgb = lighting_getLightColor(vColor.rgb, cameraPosition, position_commonspace.xyz, normal);
}
#endif
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var c3=[0,0,0,255],u2t={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,flatShading:!1,getPosition:{type:"accessor",value:e=>e.position},getFillColor:{type:"accessor",value:c3},getLineColor:{type:"accessor",value:c3},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}},ub=class extends qi{getShaders(){let t={},{flatShading:r}=this.props;return r&&(t.FLAT_SHADING=1),super.getShaders({vs:xG,fs:vG,defines:t,modules:[Ei,r?q_:fm,Mo,yG]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getFillColor",defaultValue:c3},instanceLineColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getLineColor",defaultValue:c3},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(t){super.updateState(t);let{props:r,oldProps:n,changeFlags:i}=t,o=i.extensionsChanged||r.flatShading!==n.flatShading;o&&(this.state.models?.forEach(c=>c.destroy()),this.setState(this._getModels()),this.getAttributeManager().invalidateAll());let s=this.getNumInstances();this.state.fillModel.setInstanceCount(s),this.state.wireframeModel.setInstanceCount(s),(o||r.diskResolution!==n.diskResolution||r.vertices!==n.vertices||(r.extruded||r.stroked)!==(n.extruded||n.stroked))&&this._updateGeometry(r)}getGeometry(t,r,n){let i=new lb({radius:1,height:n?2:0,vertices:r,nradial:t}),o=0;if(r)for(let s=0;s<t;s++){let c=r[s],l=Math.sqrt(c[0]*c[0]+c[1]*c[1]);o+=l/t}else o=1;return this.setState({edgeDistance:Math.cos(Math.PI/t)*o}),i}_getModels(){let t=this.getShaders(),r=this.getAttributeManager().getBufferLayouts(),n=new jn(this.context.device,{...t,id:`${this.props.id}-fill`,bufferLayout:r,isInstanced:!0}),i=new jn(this.context.device,{...t,id:`${this.props.id}-wireframe`,bufferLayout:r,isInstanced:!0});return{fillModel:n,wireframeModel:i,models:[i,n]}}_updateGeometry({diskResolution:t,vertices:r,extruded:n,stroked:i}){let o=this.getGeometry(t,r,n||i);this.setState({fillVertexCount:o.attributes.POSITION.value.length/3});let s=this.state.fillModel,c=this.state.wireframeModel;s.setGeometry(o),s.setTopology("triangle-strip"),s.setIndexBuffer(null),c.setGeometry(o),c.setTopology("line-list")}draw({uniforms:t}){let{lineWidthUnits:r,lineWidthScale:n,lineWidthMinPixels:i,lineWidthMaxPixels:o,radiusUnits:s,elevationScale:c,extruded:l,filled:h,stroked:p,wireframe:x,offset:w,coverage:E,radius:P,angle:B}=this.props,D=this.state.fillModel,W=this.state.wireframeModel,{fillVertexCount:X,edgeDistance:q}=this.state,$={radius:P,angle:B/180*Math.PI,offset:w,extruded:l,stroked:p,coverage:E,elevationScale:c,edgeDistance:q,radiusUnits:us[s],widthUnits:us[r],widthScale:n,widthMinPixels:i,widthMaxPixels:o};l&&x&&(W.shaderInputs.setProps({column:{...$,isStroke:!0}}),W.draw(this.context.renderPass)),h&&(D.setVertexCount(X),D.shaderInputs.setProps({column:{...$,isStroke:!1}}),D.draw(this.context.renderPass)),!l&&p&&(D.setVertexCount(X*2/3),D.shaderInputs.setProps({column:{...$,isStroke:!0}}),D.draw(this.context.renderPass))}};ub.layerName="ColumnLayer";ub.defaultProps=u2t;var Xf=ub;var h2t={cellSize:{type:"number",min:0,value:1e3},offset:{type:"array",value:[1,1]}},hb=class extends Xf{_updateGeometry(){let t=new Xp;this.state.fillModel.setGeometry(t)}draw({uniforms:t}){let{elevationScale:r,extruded:n,offset:i,coverage:o,cellSize:s,angle:c,radiusUnits:l}=this.props,h=this.state.fillModel,p={radius:s/2,radiusUnits:us[l],angle:c,offset:i,extruded:n,stroked:!1,coverage:o,elevationScale:r,edgeDistance:1,isStroke:!1,widthUnits:0,widthScale:0,widthMinPixels:0,widthMaxPixels:0};h.shaderInputs.setProps({column:p}),h.draw(this.context.renderPass)}};hb.layerName="GridCellLayer";hb.defaultProps=h2t;var bG=hb;function wG(e,t,r,n){let i;if(Array.isArray(e[0])){let o=e.length*t;i=new Array(o);for(let s=0;s<e.length;s++)for(let c=0;c<t;c++)i[s*t+c]=e[s][c]||0}else i=e;return r?ab(i,{size:t,gridResolution:r}):n?RD(i,{size:t}):i}var f2t=1,p2t=2,OD=4,fb=class extends rd{constructor(t){super({...t,attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(t){return this.attributes[t]}getGeometryFromBuffer(t){return this.normalize?super.getGeometryFromBuffer(t):null}normalizeGeometry(t){return this.normalize?wG(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}getGeometrySize(t){if(TG(t)){let n=0;for(let i of t)n+=this.getGeometrySize(i);return n}let r=this.getPathLength(t);return r<2?0:this.isClosed(t)?r<3?0:r+2:r}updateGeometryAttributes(t,r){if(r.geometrySize!==0)if(t&&TG(t))for(let n of t){let i=this.getGeometrySize(n);r.geometrySize=i,this.updateGeometryAttributes(n,r),r.vertexStart+=i}else this._updateSegmentTypes(t,r),this._updatePositions(t,r)}_updateSegmentTypes(t,r){let n=this.attributes.segmentTypes,i=t?this.isClosed(t):!1,{vertexStart:o,geometrySize:s}=r;n.fill(0,o,o+s),i?(n[o]=OD,n[o+s-2]=OD):(n[o]+=f2t,n[o+s-2]+=p2t),n[o+s-1]=OD}_updatePositions(t,r){let{positions:n}=this.attributes;if(!n||!t)return;let{vertexStart:i,geometrySize:o}=r,s=new Array(3);for(let c=i,l=0;l<o;c++,l++)this.getPointOnPath(t,l,s),n[c*3]=s[0],n[c*3+1]=s[1],n[c*3+2]=s[2]}getPathLength(t){return t.length/this.positionSize}getPointOnPath(t,r,n=[]){let{positionSize:i}=this;r*i>=t.length&&(r+=1-t.length/i);let o=r*i;return n[0]=t[o],n[1]=t[o+1],n[2]=i===3&&t[o+2]||0,n}isClosed(t){if(!this.normalize)return Boolean(this.opts.loop);let{positionSize:r}=this,n=t.length-r;return t[0]===t[n]&&t[1]===t[n+1]&&(r===2||t[2]===t[n+2])}};function TG(e){return Array.isArray(e[0])}var EG=`uniform pathUniforms {
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  float jointType;
  float capType;
  float miterLimit;
  bool billboard;
  highp int widthUnits;
} path;
`,MG={name:"path",vs:EG,fs:EG,uniformTypes:{widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",jointType:"f32",capType:"f32",miterLimit:"f32",billboard:"f32",widthUnits:"i32"}};var SG=`#version 300 es
#define SHADER_NAME path-layer-vertex-shader
in vec2 positions;
in float instanceTypes;
in vec3 instanceStartPositions;
in vec3 instanceEndPositions;
in vec3 instanceLeftPositions;
in vec3 instanceRightPositions;
in vec3 instanceLeftPositions64Low;
in vec3 instanceStartPositions64Low;
in vec3 instanceEndPositions64Low;
in vec3 instanceRightPositions64Low;
in float instanceStrokeWidths;
in vec4 instanceColors;
in vec3 instancePickingColors;
uniform float opacity;
out vec4 vColor;
out vec2 vCornerOffset;
out float vMiterLength;
out vec2 vPathPosition;
out float vPathLength;
out float vJointType;
const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);
float flipIfTrue(bool flag) {
return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
vec2 width
) {
bool isEnd = positions.x > 0.0;
float sideOfPath = positions.y;
float isJoint = float(sideOfPath == 0.0);
vec3 deltaA3 = (currPoint - prevPoint);
vec3 deltaB3 = (nextPoint - currPoint);
mat3 rotationMatrix;
bool needsRotation = !path.billboard && project_needs_rotation(currPoint, rotationMatrix);
if (needsRotation) {
deltaA3 = deltaA3 * rotationMatrix;
deltaB3 = deltaB3 * rotationMatrix;
}
vec2 deltaA = deltaA3.xy / width;
vec2 deltaB = deltaB3.xy / width;
float lenA = length(deltaA);
float lenB = length(deltaB);
vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);
vec2 perpA = vec2(-dirA.y, dirA.x);
vec2 perpB = vec2(-dirB.y, dirB.x);
vec2 tangent = dirA + dirB;
tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
vec2 miterVec = vec2(-tangent.y, tangent.x);
vec2 dir = isEnd ? dirA : dirB;
vec2 perp = isEnd ? perpA : perpB;
float L = isEnd ? lenA : lenB;
float sinHalfA = abs(dot(miterVec, perp));
float cosHalfA = abs(dot(dirA, miterVec));
float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
float cornerPosition = sideOfPath * turnDirection;
float miterSize = 1.0 / max(sinHalfA, EPSILON);
miterSize = mix(
min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
miterSize,
step(0.0, cornerPosition)
);
vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
* (sideOfPath + isJoint * turnDirection);
bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
bool isCap = isStartCap || isEndCap;
if (isCap) {
offsetVec = mix(perp * sideOfPath, dir * path.capType * 4.0 * flipIfTrue(isStartCap), isJoint);
vJointType = path.capType;
} else {
vJointType = path.jointType;
}
vPathLength = L;
vCornerOffset = offsetVec;
vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
vMiterLength = isCap ? isJoint : vMiterLength;
vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
vPathPosition = vec2(
dot(offsetFromStartOfPath, perp),
dot(offsetFromStartOfPath, dir)
);
geometry.uv = vPathPosition;
float isValid = step(instanceTypes, 3.5);
vec3 offset = vec3(offsetVec * width * isValid, 0.0);
if (needsRotation) {
offset = rotationMatrix * offset;
}
return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
if (position.w < EPSILON) {
float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
position = refPosition + (position - refPosition) * r;
}
}
void main() {
geometry.pickingColor = instancePickingColors;
vColor = vec4(instanceColors.rgb, instanceColors.a * layer.opacity);
float isEnd = positions.x;
vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);
vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);
vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);
geometry.worldPosition = currPosition;
vec2 widthPixels = vec2(clamp(
project_size_to_pixel(instanceStrokeWidths * path.widthScale, path.widthUnits),
path.widthMinPixels, path.widthMaxPixels) / 2.0);
vec3 width;
if (path.billboard) {
vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);
clipLine(prevPositionScreen, currPositionScreen);
clipLine(nextPositionScreen, currPositionScreen);
clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));
width = vec3(widthPixels, 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(
prevPositionScreen.xyz / prevPositionScreen.w,
currPositionScreen.xyz / currPositionScreen.w,
nextPositionScreen.xyz / nextPositionScreen.w,
project_pixel_size_to_clipspace(width.xy)
);
DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
} else {
prevPosition = project_position(prevPosition, prevPosition64Low);
currPosition = project_position(currPosition, currPosition64Low);
nextPosition = project_position(nextPosition, nextPosition64Low);
width = vec3(project_pixel_size(widthPixels), 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
geometry.position = vec4(currPosition + offset, 1.0);
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var CG=`#version 300 es
#define SHADER_NAME path-layer-fragment-shader
precision highp float;
in vec4 vColor;
in vec2 vCornerOffset;
in float vMiterLength;
in vec2 vPathPosition;
in float vPathLength;
in float vJointType;
out vec4 fragColor;
void main(void) {
geometry.uv = vPathPosition;
if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
discard;
}
if (vJointType < 0.5 && vMiterLength > path.miterLimit + 1.0) {
discard;
}
}
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var PG=[0,0,0,255],d2t={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:e=>e.path},getColor:{type:"accessor",value:PG},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},BD={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e},pb=class extends qi{getShaders(){return super.getShaders({vs:SG,fs:CG,modules:[Ei,Mo,MG]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:BD,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:BD,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:BD,defaultValue:PG},instancePickingColors:{size:4,type:"uint8",accessor:(n,{index:i,target:o})=>this.encodePickingColor(n&&n.__source?n.__source.index:i,o)}}),this.setState({pathTesselator:new fb({fp64:this.use64bitPositions()})})}updateState(t){super.updateState(t);let{props:r,changeFlags:n}=t,i=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){let{pathTesselator:s}=this.state,c=r.data.attributes||{};s.updateGeometry({data:r.data,geometryBuffer:c.getPath,buffers:c,normalize:!r._pathType,loop:r._pathType==="loop",getGeometry:r.getPath,positionFormat:r.positionFormat,wrapLongitude:r.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),n.dataChanged||i.invalidateAll()}n.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),i.invalidateAll())}getPickingInfo(t){let r=super.getPickingInfo(t),{index:n}=r,i=this.props.data;return i[0]&&i[0].__source&&(r.object=i.find(o=>o.__source.index===n)),r}disablePickingIndex(t){let r=this.props.data;if(r[0]&&r[0].__source)for(let n=0;n<r.length;n++)r[n].__source.index===t&&this._disablePickingIndex(n);else super.disablePickingIndex(t)}draw({uniforms:t}){let{jointRounded:r,capRounded:n,billboard:i,miterLimit:o,widthUnits:s,widthScale:c,widthMinPixels:l,widthMaxPixels:h}=this.props,p=this.state.model,x={jointType:Number(r),capType:Number(n),billboard:i,widthUnits:us[s],widthScale:c,miterLimit:o,widthMinPixels:l,widthMaxPixels:h};p.shaderInputs.setProps({path:x}),p.draw(this.context.renderPass)}_getModel(){let t=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new jn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Mi({topology:"triangle-list",attributes:{indices:new Uint16Array(t),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(t){let{pathTesselator:r}=this.state;t.startIndices=r.vertexStarts,t.value=r.get("positions")}calculateSegmentTypes(t){let{pathTesselator:r}=this.state;t.startIndices=r.vertexStarts,t.value=r.get("segmentTypes")}};pb.defaultProps=d2t;pb.layerName="PathLayer";var Yf=pb;var zG=tc(BG(),1);var p3=dy.CLOCKWISE,DG=dy.COUNTER_CLOCKWISE,Tm={isClosed:!0};function I2t(e){if(e=e&&e.positions||e,!Array.isArray(e)&&!ArrayBuffer.isView(e))throw new Error("invalid polygon")}function Ay(e){return"positions"in e?e.positions:e}function gb(e){return"holeIndices"in e?e.holeIndices:null}function R2t(e){return Array.isArray(e[0])}function L2t(e){return e.length>=1&&e[0].length>=2&&Number.isFinite(e[0][0])}function O2t(e){let t=e[0],r=e[e.length-1];return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]}function B2t(e,t,r,n){for(let i=0;i<t;i++)if(e[r+i]!==e[n-t+i])return!1;return!0}function NG(e,t,r,n,i){let o=t,s=r.length;for(let c=0;c<s;c++)for(let l=0;l<n;l++)e[o++]=r[c][l]||0;if(!O2t(r))for(let c=0;c<n;c++)e[o++]=r[0][c]||0;return Tm.start=t,Tm.end=o,Tm.size=n,E0(e,i,Tm),o}function kG(e,t,r,n,i=0,o,s){o=o||r.length;let c=o-i;if(c<=0)return t;let l=t;for(let h=0;h<c;h++)e[l++]=r[i+h];if(!B2t(r,n,i,o))for(let h=0;h<n;h++)e[l++]=r[i+h];return Tm.start=t,Tm.end=l,Tm.size=n,E0(e,s,Tm),l}function d3(e,t){I2t(e);let r=[],n=[];if("positions"in e){let{positions:i,holeIndices:o}=e;if(o){let s=0;for(let c=0;c<=o.length;c++)s=kG(r,s,i,t,o[c-1],o[c],c===0?p3:DG),n.push(s);return n.pop(),{positions:r,holeIndices:n}}e=i}if(!R2t(e))return kG(r,0,e,t,0,r.length,p3),r;if(!L2t(e)){let i=0;for(let[o,s]of e.entries())i=NG(r,i,s,t,o===0?p3:DG),n.push(i);return n.pop(),{positions:r,holeIndices:n}}return NG(r,0,e,t,p3),r}function zD(e,t,r){let n=e.length/3,i=0;for(let o=0;o<n;o++){let s=(o+1)%n;i+=e[o*3+t]*e[s*3+r],i-=e[s*3+t]*e[o*3+r]}return Math.abs(i/2)}function FG(e,t,r,n){let i=e.length/3;for(let o=0;o<i;o++){let s=o*3,c=e[s+0],l=e[s+1],h=e[s+2];e[s+t]=c,e[s+r]=l,e[s+n]=h}}function UG(e,t,r,n){let i=gb(e);i&&(i=i.map(c=>c/t));let o=Ay(e),s=n&&t===3;if(r){let c=o.length;o=o.slice();let l=[];for(let h=0;h<c;h+=t){l[0]=o[h],l[1]=o[h+1],s&&(l[2]=o[h+2]);let p=r(l);o[h]=p[0],o[h+1]=p[1],s&&(o[h+2]=p[2])}}if(s){let c=zD(o,0,1),l=zD(o,0,2),h=zD(o,1,2);if(!c&&!l&&!h)return[];c>l&&c>h||(l>h?(r||(o=o.slice()),FG(o,0,2,1)):(r||(o=o.slice()),FG(o,2,0,1)))}return(0,zG.default)(o,i,t)}var _b=class extends rd{constructor(t){let{fp64:r,IndexType:n=Uint32Array}=t;super({...t,attributes:{positions:{size:3,type:r?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:n,size:1}}})}get(t){let{attributes:r}=this;return t==="indices"?r.indices&&r.indices.subarray(0,this.vertexCount):r[t]}updateGeometry(t){super.updateGeometry(t);let r=this.buffers.indices;if(r)this.vertexCount=(r.value||r).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(t){if(this.normalize){let r=d3(t,this.positionSize);return this.opts.resolution?cb(Ay(r),gb(r),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?LD(Ay(r),gb(r),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):r}return t}getGeometrySize(t){if(jG(t)){let r=0;for(let n of t)r+=this.getGeometrySize(n);return r}return Ay(t).length/this.positionSize}getGeometryFromBuffer(t){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(t):null}updateGeometryAttributes(t,r){if(t&&jG(t))for(let n of t){let i=this.getGeometrySize(n);r.geometrySize=i,this.updateGeometryAttributes(n,r),r.vertexStart+=i,r.indexStart=this.indexStarts[r.geometryIndex+1]}else{let n=t;this._updateIndices(n,r),this._updatePositions(n,r),this._updateVertexValid(n,r)}}_updateIndices(t,{geometryIndex:r,vertexStart:n,indexStart:i}){let{attributes:o,indexStarts:s,typedArrayManager:c}=this,l=o.indices;if(!l||!t)return;let h=i,p=UG(t,this.positionSize,this.opts.preproject,this.opts.full3d);l=c.allocate(l,i+p.length,{copy:!0});for(let x=0;x<p.length;x++)l[h++]=p[x]+n;s[r+1]=i+p.length,o.indices=l}_updatePositions(t,{vertexStart:r,geometrySize:n}){let{attributes:{positions:i},positionSize:o}=this;if(!i||!t)return;let s=Ay(t);for(let c=r,l=0;l<n;c++,l++){let h=s[l*o],p=s[l*o+1],x=o>2?s[l*o+2]:0;i[c*3]=h,i[c*3+1]=p,i[c*3+2]=x}}_updateVertexValid(t,{vertexStart:r,geometrySize:n}){let{positionSize:i}=this,o=this.attributes.vertexValid,s=t&&gb(t);if(t&&t.edgeTypes?o.set(t.edgeTypes,r):o.fill(1,r,r+n),s)for(let c=0;c<s.length;c++)o[r+s[c]/i-1]=0;o[r+n-1]=0}};function jG(e){return Array.isArray(e)&&e.length>0&&!Number.isFinite(e[0])}var HG=`uniform solidPolygonUniforms {
  bool extruded;
  bool isWireframe;
  float elevationScale;
} solidPolygon;
`,WG={name:"solidPolygon",vs:HG,fs:HG,uniformTypes:{extruded:"f32",isWireframe:"f32",elevationScale:"f32"}};var m3=`in vec4 fillColors;
in vec4 lineColors;
in vec3 pickingColors;
out vec4 vColor;
struct PolygonProps {
vec3 positions;
vec3 positions64Low;
vec3 normal;
float elevations;
};
vec3 project_offset_normal(vec3 vector) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
return normalize(vector * project.commonUnitsPerWorldUnit);
}
return project_normal(vector);
}
void calculatePosition(PolygonProps props) {
vec3 pos = props.positions;
vec3 pos64Low = props.positions64Low;
vec3 normal = props.normal;
vec4 colors = solidPolygon.isWireframe ? lineColors : fillColors;
geometry.worldPosition = props.positions;
geometry.pickingColor = pickingColors;
if (solidPolygon.extruded) {
pos.z += props.elevations * solidPolygon.elevationScale;
}
gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (solidPolygon.extruded) {
#ifdef IS_SIDE_VERTEX
normal = project_offset_normal(normal);
#else
normal = project_normal(normal);
#endif
geometry.normal = normal;
vec3 lightColor = lighting_getLightColor(colors.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, colors.a * layer.opacity);
} else {
vColor = vec4(colors.rgb, colors.a * layer.opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var qG=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader
in vec3 vertexPositions;
in vec3 vertexPositions64Low;
in float elevations;
${m3}
void main(void) {
PolygonProps props;
props.positions = vertexPositions;
props.positions64Low = vertexPositions64Low;
props.elevations = elevations;
props.normal = vec3(0.0, 0.0, 1.0);
calculatePosition(props);
}
`;var GG=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX
in vec2 positions;
in vec3 vertexPositions;
in vec3 nextVertexPositions;
in vec3 vertexPositions64Low;
in vec3 nextVertexPositions64Low;
in float elevations;
in float instanceVertexValid;
${m3}
void main(void) {
if(instanceVertexValid < 0.5){
gl_Position = vec4(0.);
return;
}
PolygonProps props;
vec3 pos;
vec3 pos64Low;
vec3 nextPos;
vec3 nextPos64Low;
#if RING_WINDING_ORDER_CW == 1
pos = vertexPositions;
pos64Low = vertexPositions64Low;
nextPos = nextVertexPositions;
nextPos64Low = nextVertexPositions64Low;
#else
pos = nextVertexPositions;
pos64Low = nextVertexPositions64Low;
nextPos = vertexPositions;
nextPos64Low = vertexPositions64Low;
#endif
props.positions = mix(pos, nextPos, positions.x);
props.positions64Low = mix(pos64Low, nextPos64Low, positions.x);
props.normal = vec3(
pos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),
nextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),
0.0);
props.elevations = elevations * positions.y;
calculatePosition(props);
}
`;var XG=`#version 300 es
#define SHADER_NAME solid-polygon-layer-fragment-shader
precision highp float;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var g3=[0,0,0,255],D2t={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:e=>e.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:g3},getLineColor:{type:"accessor",value:g3},material:!0},A3={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e},yb=class extends qi{getShaders(t){return super.getShaders({vs:t==="top"?qG:GG,fs:XG,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Ei,fm,Mo,WG]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){let{viewport:t}=this.context,{coordinateSystem:r}=this.props,{_full3d:n}=this.props;t.isGeospatial&&r===Yr.DEFAULT&&(r=Yr.LNGLAT);let i;r===Yr.LNGLAT&&(n?i=t.projectPosition.bind(t):i=t.projectFlat.bind(t)),this.setState({numInstances:0,polygonTesselator:new _b({preproject:i,fp64:this.use64bitPositions(),IndexType:Uint32Array})});let o=this.getAttributeManager(),s=!0;o.remove(["instancePickingColors"]),o.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},vertexPositions:{size:3,type:"float64",stepMode:"dynamic",fp64:this.use64bitPositions(),transition:A3,accessor:"getPolygon",update:this.calculatePositions,noAlloc:s,shaderAttributes:{nextVertexPositions:{vertexOffset:1}}},instanceVertexValid:{size:1,type:"uint16",stepMode:"instance",update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,stepMode:"dynamic",transition:A3,accessor:"getElevation"},fillColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:A3,accessor:"getFillColor",defaultValue:g3},lineColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:A3,accessor:"getLineColor",defaultValue:g3},pickingColors:{size:4,type:"uint8",stepMode:"dynamic",accessor:(c,{index:l,target:h})=>this.encodePickingColor(c&&c.__source?c.__source.index:l,h)}})}getPickingInfo(t){let r=super.getPickingInfo(t),{index:n}=r,i=this.props.data;return i[0]&&i[0].__source&&(r.object=i.find(o=>o.__source.index===n)),r}disablePickingIndex(t){let r=this.props.data;if(r[0]&&r[0].__source)for(let n=0;n<r.length;n++)r[n].__source.index===t&&this._disablePickingIndex(n);else super.disablePickingIndex(t)}draw({uniforms:t}){let{extruded:r,filled:n,wireframe:i,elevationScale:o}=this.props,{topModel:s,sideModel:c,wireframeModel:l,polygonTesselator:h}=this.state,p={extruded:Boolean(r),elevationScale:o,isWireframe:!1};l&&i&&(l.setInstanceCount(h.instanceCount-1),l.shaderInputs.setProps({solidPolygon:{...p,isWireframe:!0}}),l.draw(this.context.renderPass)),c&&n&&(c.setInstanceCount(h.instanceCount-1),c.shaderInputs.setProps({solidPolygon:p}),c.draw(this.context.renderPass)),s&&n&&(s.setVertexCount(h.vertexCount),s.shaderInputs.setProps({solidPolygon:p}),s.draw(this.context.renderPass))}updateState(t){super.updateState(t),this.updateGeometry(t);let{props:r,oldProps:n,changeFlags:i}=t,o=this.getAttributeManager();(i.extensionsChanged||r.filled!==n.filled||r.extruded!==n.extruded)&&(this.state.models?.forEach(c=>c.destroy()),this.setState(this._getModels()),o.invalidateAll())}updateGeometry({props:t,oldProps:r,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){let{polygonTesselator:o}=this.state,s=t.data.attributes||{};o.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:s.getPolygon,buffers:s,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged,full3d:t._full3d}),this.setState({numInstances:o.instanceCount,startIndices:o.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(){let{id:t,filled:r,extruded:n}=this.props,i,o,s;if(r){let c=this.getShaders("top");c.defines.NON_INSTANCED_MODEL=1;let l=this.getAttributeManager().getBufferLayouts({isInstanced:!1});i=new jn(this.context.device,{...c,id:`${t}-top`,topology:"triangle-list",bufferLayout:l,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}})}if(n){let c=this.getAttributeManager().getBufferLayouts({isInstanced:!0});o=new jn(this.context.device,{...this.getShaders("side"),id:`${t}-side`,bufferLayout:c,geometry:new Mi({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}),s=new jn(this.context.device,{...this.getShaders("side"),id:`${t}-wireframe`,bufferLayout:c,geometry:new Mi({topology:"line-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})}return{models:[o,s,i].filter(Boolean),topModel:i,sideModel:o,wireframeModel:s}}calculateIndices(t){let{polygonTesselator:r}=this.state;t.startIndices=r.indexStarts,t.value=r.get("indices")}calculatePositions(t){let{polygonTesselator:r}=this.state;t.startIndices=r.vertexStarts,t.value=r.get("positions")}calculateVertexValid(t){t.value=this.state.polygonTesselator.get("vertexValid")}};yb.defaultProps=D2t;yb.layerName="SolidPolygonLayer";var Em=yb;function _3({data:e,getIndex:t,dataRange:r,replace:n}){let{startRow:i=0,endRow:o=1/0}=r,s=e.length,c=s,l=s;for(let w=0;w<s;w++){let E=t(e[w]);if(c>w&&E>=i&&(c=w),E>=o){l=w;break}}let h=c,x=l-c!==n.length?e.slice(l):void 0;for(let w=0;w<n.length;w++)e[h++]=n[w];if(x){for(let w=0;w<x.length;w++)e[h++]=x[w];e.length=h}return{startRow:c,endRow:c+n.length}}var YG=[0,0,0,255],N2t=[0,0,0,255],k2t={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:e=>e.polygon},getFillColor:{type:"accessor",value:N2t},getLineColor:{type:"accessor",value:YG},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0},xb=class extends vs{initializeState(){this.state={paths:[],pathsDiff:null},this.props.getLineDashArray&&br.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:t}){let r=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getPolygon);if(r&&Array.isArray(t.dataChanged)){let n=this.state.paths.slice(),i=t.dataChanged.map(o=>_3({data:n,getIndex:s=>s.__source.index,dataRange:o,replace:this._getPaths(o)}));this.setState({paths:n,pathsDiff:i})}else r&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(t={}){let{data:r,getPolygon:n,positionFormat:i,_normalize:o}=this.props,s=[],c=i==="XY"?2:3,{startRow:l,endRow:h}=t,{iterable:p,objectInfo:x}=Xs(r,l,h);for(let w of p){x.index++;let E=n(w,x);o&&(E=d3(E,c));let{holeIndices:P}=E,B=E.positions||E;if(P)for(let D=0;D<=P.length;D++){let W=B.slice(P[D-1]||0,P[D]||B.length);s.push(this.getSubLayerRow({path:W},w,x.index))}else s.push(this.getSubLayerRow({path:B},w,x.index))}return s}renderLayers(){let{data:t,_dataDiff:r,stroked:n,filled:i,extruded:o,wireframe:s,_normalize:c,_windingOrder:l,elevationScale:h,transitions:p,positionFormat:x}=this.props,{lineWidthUnits:w,lineWidthScale:E,lineWidthMinPixels:P,lineWidthMaxPixels:B,lineJointRounded:D,lineMiterLimit:W,lineDashJustified:X}=this.props,{getFillColor:q,getLineColor:$,getLineWidth:et,getLineDashArray:F,getElevation:ut,getPolygon:ot,updateTriggers:J,material:G}=this.props,{paths:mt,pathsDiff:Mt}=this.state,ct=this.getSubLayerClass("fill",Em),gt=this.getSubLayerClass("stroke",Yf),ee=this.shouldRenderSubLayer("fill",mt)&&new ct({_dataDiff:r,extruded:o,elevationScale:h,filled:i,wireframe:s,_normalize:c,_windingOrder:l,getElevation:ut,getFillColor:q,getLineColor:o&&s?$:YG,material:G,transitions:p},this.getSubLayerProps({id:"fill",updateTriggers:J&&{getPolygon:J.getPolygon,getElevation:J.getElevation,getFillColor:J.getFillColor,lineColors:o&&s,getLineColor:J.getLineColor}}),{data:t,positionFormat:x,getPolygon:ot}),Ne=!o&&n&&this.shouldRenderSubLayer("stroke",mt)&&new gt({_dataDiff:Mt&&(()=>Mt),widthUnits:w,widthScale:E,widthMinPixels:P,widthMaxPixels:B,jointRounded:D,miterLimit:W,dashJustified:X,_pathType:"loop",transitions:p&&{getWidth:p.getLineWidth,getColor:p.getLineColor,getPath:p.getPolygon},getColor:this.getSubLayerAccessor($),getWidth:this.getSubLayerAccessor(et),getDashArray:this.getSubLayerAccessor(F)},this.getSubLayerProps({id:"stroke",updateTriggers:J&&{getWidth:J.getLineWidth,getColor:J.getLineColor,getDashArray:J.getLineDashArray}}),{data:mt,positionFormat:x,getPath:Ue=>Ue.path});return[!o&&ee,Ne,o&&ee]}};xb.layerName="PolygonLayer";xb.defaultProps=k2t;var Mm=xb;function KG(e,t){if(!e)return null;let r="startIndices"in e?e.startIndices[t]:t,n=e.featureIds.value[r];return r!==-1?F2t(e,n,r):null}function F2t(e,t,r){let n={properties:{...e.properties[t]}};for(let i in e.numericProps)n.properties[i]=e.numericProps[i].value[r];return n}function ZG(e,t){let r={points:null,lines:null,polygons:null};for(let n in r){let i=e[n].globalFeatureIds.value;r[n]=new Uint8ClampedArray(i.length*4);let o=[];for(let s=0;s<i.length;s++)t(i[s],o),r[n][s*4+0]=o[0],r[n][s*4+1]=o[1],r[n][s*4+2]=o[2],r[n][s*4+3]=255}return r}var $G=`uniform sdfUniforms {
  float gamma;
  bool enabled;
  float buffer;
  float outlineBuffer;
  vec4 outlineColor;
} sdf;
`,QG={name:"sdf",vs:$G,fs:$G,uniformTypes:{gamma:"f32",enabled:"f32",buffer:"f32",outlineBuffer:"f32",outlineColor:"vec4<f32>"}};var JG=`#version 300 es
#define SHADER_NAME multi-icon-layer-fragment-shader
precision highp float;
uniform sampler2D iconsTexture;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
if (!bool(picking.isActive)) {
float alpha = texture(iconsTexture, vTextureCoords).a;
vec4 color = vColor;
if (sdf.enabled) {
float distance = alpha;
alpha = smoothstep(sdf.buffer - sdf.gamma, sdf.buffer + sdf.gamma, distance);
if (sdf.outlineBuffer > 0.0) {
float inFill = alpha;
float inBorder = smoothstep(sdf.outlineBuffer - sdf.gamma, sdf.outlineBuffer + sdf.gamma, distance);
color = mix(sdf.outlineColor, vColor, inFill);
alpha = inBorder;
}
}
float a = alpha * color.a;
if (a < icon.alphaCutoff) {
discard;
}
fragColor = vec4(color.rgb, a * layer.opacity);
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var UD=192/256,tX=[],z2t={getIconOffsets:{type:"accessor",value:e=>e.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}},vb=class extends py{getShaders(){let t=super.getShaders();return{...t,modules:[...t.modules,QG],fs:JG}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:"uint8",size:3,accessor:(r,{index:n,target:i})=>this.encodePickingColor(n,i)}})}updateState(t){super.updateState(t);let{props:r,oldProps:n}=t,{outlineColor:i}=r;i!==n.outlineColor&&(i=i.map(o=>o/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!r.sdf&&r.outlineWidth&&br.warn(`${this.id}: fontSettings.sdf is required to render outline`)()}draw(t){let{sdf:r,smoothing:n,outlineWidth:i}=this.props,{outlineColor:o}=this.state,s=i?Math.max(n,UD*(1-i)):-1,c=this.state.model,l={buffer:UD,outlineBuffer:s,gamma:n,enabled:Boolean(r),outlineColor:o};if(c.shaderInputs.setProps({sdf:l}),super.draw(t),r&&i){let{iconManager:h}=this.state;h.getTexture()&&(c.shaderInputs.setProps({sdf:{...l,outlineBuffer:UD}}),c.draw(this.context.renderPass))}}getInstanceOffset(t){return t?Array.from(t).flatMap(r=>super.getInstanceOffset(r)):tX}getInstanceColorMode(t){return 1}getInstanceIconFrame(t){return t?Array.from(t).flatMap(r=>super.getInstanceIconFrame(r)):tX}};vb.defaultProps=z2t;vb.layerName="MultiIconLayer";var y3=vb;var bb=class{constructor({fontSize:t=24,buffer:r=3,radius:n=8,cutoff:i=.25,fontFamily:o="sans-serif",fontWeight:s="normal",fontStyle:c="normal"}={}){this.buffer=r,this.cutoff=i,this.radius=n;let l=this.size=t+r*4,h=this._createCanvas(l),p=this.ctx=h.getContext("2d",{willReadFrequently:!0});p.font=`${c} ${s} ${t}px ${o}`,p.textBaseline="alphabetic",p.textAlign="left",p.fillStyle="black",this.gridOuter=new Float64Array(l*l),this.gridInner=new Float64Array(l*l),this.f=new Float64Array(l),this.z=new Float64Array(l+1),this.v=new Uint16Array(l)}_createCanvas(t){let r=document.createElement("canvas");return r.width=r.height=t,r}draw(t){let{width:r,actualBoundingBoxAscent:n,actualBoundingBoxDescent:i,actualBoundingBoxLeft:o,actualBoundingBoxRight:s}=this.ctx.measureText(t),c=Math.ceil(n),l=0,h=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(s-o))),p=Math.min(this.size-this.buffer,c+Math.ceil(i)),x=h+2*this.buffer,w=p+2*this.buffer,E=Math.max(x*w,0),P=new Uint8ClampedArray(E),B={data:P,width:x,height:w,glyphWidth:h,glyphHeight:p,glyphTop:c,glyphLeft:l,glyphAdvance:r};if(h===0||p===0)return B;let{ctx:D,buffer:W,gridInner:X,gridOuter:q}=this;D.clearRect(W,W,h,p),D.fillText(t,W,W+c);let $=D.getImageData(W,W,h,p);q.fill(1e20,0,E),X.fill(0,0,E);for(let et=0;et<p;et++)for(let F=0;F<h;F++){let ut=$.data[4*(et*h+F)+3]/255;if(ut===0)continue;let ot=(et+W)*x+F+W;if(ut===1)q[ot]=0,X[ot]=1e20;else{let J=.5-ut;q[ot]=J>0?J*J:0,X[ot]=J<0?J*J:0}}eX(q,0,0,x,w,x,this.f,this.v,this.z),eX(X,W,W,h,p,x,this.f,this.v,this.z);for(let et=0;et<E;et++){let F=Math.sqrt(q[et])-Math.sqrt(X[et]);P[et]=Math.round(255-255*(F/this.radius+this.cutoff))}return B}};function eX(e,t,r,n,i,o,s,c,l){for(let h=t;h<t+n;h++)rX(e,r*o+h,o,i,s,c,l);for(let h=r;h<r+i;h++)rX(e,h*o+t,1,n,s,c,l)}function rX(e,t,r,n,i,o,s){o[0]=0,s[0]=-1e20,s[1]=1e20,i[0]=e[t];for(let c=1,l=0,h=0;c<n;c++){i[c]=e[t+c*r];let p=c*c;do{let x=o[l];h=(i[c]-i[x]+p-x*x)/(c-x)/2}while(h<=s[l]&&--l>-1);l++,o[l]=c,s[l]=h,s[l+1]=1e20}for(let c=0,l=0;c<n;c++){for(;s[l+1]<c;)l++;let h=o[l],p=c-h;e[t+c*r]=i[h]+p*p}}var U2t=32,V2t=[];function j2t(e){return Math.pow(2,Math.ceil(Math.log2(e)))}function nX({characterSet:e,getFontWidth:t,fontHeight:r,buffer:n,maxCanvasWidth:i,mapping:o={},xOffset:s=0,yOffset:c=0}){let l=0,h=s,p=r+n*2;for(let x of e)if(!o[x]){let w=t(x);h+w+n*2>i&&(h=0,l++),o[x]={x:h+n,y:c+l*p+n,width:w,height:p,layoutWidth:w,layoutHeight:r},h+=w+n*2}return{mapping:o,xOffset:h,yOffset:c+l*p,canvasHeight:j2t(c+(l+1)*p)}}function iX(e,t,r,n){let i=0;for(let o=t;o<r;o++){let s=e[o];i+=n[s]?.layoutWidth||0}return i}function oX(e,t,r,n,i,o){let s=t,c=0;for(let l=t;l<r;l++){let h=iX(e,l,l+1,i);c+h>n&&(s<l&&o.push(l),s=l,c=0),c+=h}return c}function H2t(e,t,r,n,i,o){let s=t,c=t,l=t,h=0;for(let p=t;p<r;p++)if((e[p]===" "||e[p+1]===" "||p+1===r)&&(l=p+1),l>c){let x=iX(e,c,l,i);h+x>n&&(s<c&&(o.push(c),s=c,h=0),x>n&&(x=oX(e,c,l,n,i,o),s=o[o.length-1])),c=l,h+=x}return h}function W2t(e,t,r,n,i=0,o){o===void 0&&(o=e.length);let s=[];return t==="break-all"?oX(e,i,o,r,n,s):H2t(e,i,o,r,n,s),s}function q2t(e,t,r,n,i,o){let s=0,c=0;for(let l=t;l<r;l++){let h=e[l],p=n[h];p?(c||(c=p.layoutHeight),i[l]=s+p.layoutWidth/2,s+=p.layoutWidth):(br.warn(`Missing character: ${h} (${h.codePointAt(0)})`)(),i[l]=s,s+=U2t)}o[0]=s,o[1]=c}function sX(e,t,r,n,i){let o=Array.from(e),s=o.length,c=new Array(s),l=new Array(s),h=new Array(s),p=(r==="break-word"||r==="break-all")&&isFinite(n)&&n>0,x=[0,0],w=[0,0],E=0,P=0,B=0;for(let D=0;D<=s;D++){let W=o[D];if((W===`
`||D===s)&&(B=D),B>P){let X=p?W2t(o,r,n,i,P,B):V2t;for(let q=0;q<=X.length;q++){let $=q===0?P:X[q-1],et=q<X.length?X[q]:B;q2t(o,$,et,i,c,w);for(let F=$;F<et;F++){let ut=o[F],ot=i[ut]?.layoutOffsetY||0;l[F]=E+w[1]/2+ot,h[F]=w[0]}E=E+w[1]*t,x[0]=Math.max(x[0],w[0])}P=B}W===`
`&&(c[P]=0,l[P]=0,h[P]=0,P++)}return x[1]=E,{x:c,y:l,rowWidth:h,size:x}}function aX({value:e,length:t,stride:r,offset:n,startIndices:i,characterSet:o}){let s=e.BYTES_PER_ELEMENT,c=r?r/s:1,l=n?n/s:0,h=i[t]||Math.ceil((e.length-l)/c),p=o&&new Set,x=new Array(t),w=e;if(c>1||l>0){let E=e.constructor;w=new E(h);for(let P=0;P<h;P++)w[P]=e[P*c+l]}for(let E=0;E<t;E++){let P=i[E],B=i[E+1]||h,D=w.subarray(P,B);x[E]=String.fromCodePoint.apply(null,D),p&&D.forEach(p.add,p)}if(p)for(let E of p)o.add(String.fromCodePoint(E));return{texts:x,characterCount:h}}var gy=class{constructor(t=5){this._cache={},this._order=[],this.limit=t}get(t){let r=this._cache[t];return r&&(this._deleteOrder(t),this._appendOrder(t)),r}set(t,r){this._cache[t]?(this.delete(t),this._cache[t]=r,this._appendOrder(t)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[t]=r,this._appendOrder(t))}delete(t){this._cache[t]&&(delete this._cache[t],this._deleteOrder(t))}_deleteOrder(t){let r=this._order.indexOf(t);r>=0&&this._order.splice(r,1)}_appendOrder(t){this._order.push(t)}};function G2t(){let e=[];for(let t=32;t<128;t++)e.push(String.fromCharCode(t));return e}var S0={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:G2t(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},cX=1024,lX=.9,uX=1.2,fX=3,x3=new gy(fX);function X2t(e,t){let r;typeof t=="string"?r=new Set(Array.from(t)):r=new Set(t);let n=x3.get(e);if(!n)return r;for(let i in n.mapping)r.has(i)&&r.delete(i);return r}function Y2t(e,t){for(let r=0;r<e.length;r++)t.data[4*r+3]=e[r]}function hX(e,t,r,n){e.font=`${n} ${r}px ${t}`,e.fillStyle="#000",e.textBaseline="alphabetic",e.textAlign="left"}function pX(e){br.assert(Number.isFinite(e)&&e>=fX,"Invalid cache limit"),x3=new gy(e)}var wb=class{constructor(){this.props={...S0}}get atlas(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){let{fontSize:t,buffer:r}=this.props;return(t*uX+r*2)/t}setProps(t={}){Object.assign(this.props,t),this._key=this._getKey();let r=X2t(this._key,this.props.characterSet),n=x3.get(this._key);if(n&&r.size===0){this._atlas!==n&&(this._atlas=n);return}let i=this._generateFontAtlas(r,n);this._atlas=i,x3.set(this._key,i)}_generateFontAtlas(t,r){let{fontFamily:n,fontWeight:i,fontSize:o,buffer:s,sdf:c,radius:l,cutoff:h}=this.props,p=r&&r.data;p||(p=document.createElement("canvas"),p.width=cX);let x=p.getContext("2d",{willReadFrequently:!0});hX(x,n,o,i);let{mapping:w,canvasHeight:E,xOffset:P,yOffset:B}=nX({getFontWidth:D=>x.measureText(D).width,fontHeight:o*uX,buffer:s,characterSet:t,maxCanvasWidth:cX,...r&&{mapping:r.mapping,xOffset:r.xOffset,yOffset:r.yOffset}});if(p.height!==E){let D=x.getImageData(0,0,p.width,p.height);p.height=E,x.putImageData(D,0,0)}if(hX(x,n,o,i),c){let D=new bb({fontSize:o,buffer:s,radius:l,cutoff:h,fontFamily:n,fontWeight:`${i}`});for(let W of t){let{data:X,width:q,height:$,glyphTop:et}=D.draw(W);w[W].width=q,w[W].layoutOffsetY=o*lX-et;let F=x.createImageData(q,$);Y2t(X,F),x.putImageData(F,w[W].x,w[W].y)}}else for(let D of t)x.fillText(D,w[D].x,w[D].y+s+o*lX);return{xOffset:P,yOffset:B,mapping:w,data:p,width:p.width,height:p.height}}_getKey(){let{fontFamily:t,fontWeight:r,fontSize:n,buffer:i,sdf:o,radius:s,cutoff:c}=this.props;return o?`${t} ${r} ${n} ${i} ${s} ${c}`:`${t} ${r} ${n} ${i}`}};var dX=`uniform textBackgroundUniforms {
  bool billboard;
  float sizeScale;
  float sizeMinPixels;
  float sizeMaxPixels;
  vec4 padding;
  highp int sizeUnits;
  bool stroked;
} textBackground;
`,mX={name:"textBackground",vs:dX,fs:dX,uniformTypes:{billboard:"f32",sizeScale:"f32",sizeMinPixels:"f32",sizeMaxPixels:"f32",padding:"vec4<f32>",sizeUnits:"i32",stroked:"f32"}};var AX=`#version 300 es
#define SHADER_NAME text-background-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceRects;
in float instanceSizes;
in float instanceAngles;
in vec2 instancePixelOffsets;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
out vec4 vFillColor;
out vec4 vLineColor;
out float vLineWidth;
out vec2 uv;
out vec2 dimensions;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = radians(angle);
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vLineWidth = instanceLineWidths;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * textBackground.sizeScale, textBackground.sizeUnits),
textBackground.sizeMinPixels, textBackground.sizeMaxPixels
);
dimensions = instanceRects.zw * sizePixels + textBackground.padding.xy + textBackground.padding.zw;
vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-textBackground.padding.xy, textBackground.padding.zw, positions);
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
pixelOffset += instancePixelOffsets;
pixelOffset.y *= -1.0;
if (textBackground.billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`;var gX=`#version 300 es
#define SHADER_NAME text-background-layer-fragment-shader
precision highp float;
in vec4 vFillColor;
in vec4 vLineColor;
in float vLineWidth;
in vec2 uv;
in vec2 dimensions;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec2 pixelPosition = uv * dimensions;
if (textBackground.stroked) {
float distToEdge = min(
min(pixelPosition.x, dimensions.x - pixelPosition.x),
min(pixelPosition.y, dimensions.y - pixelPosition.y)
);
float isBorder = smoothedge(distToEdge, vLineWidth);
fragColor = mix(vFillColor, vLineColor, isBorder);
} else {
fragColor = vFillColor;
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var K2t={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:e=>e.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}},Tb=class extends qi{getShaders(){return super.getShaders({vs:AX,fs:gX,modules:[Ei,Mo,mX]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){super.updateState(t);let{changeFlags:r}=t;r.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:t}){let{billboard:r,sizeScale:n,sizeUnits:i,sizeMinPixels:o,sizeMaxPixels:s,getLineWidth:c}=this.props,{padding:l}=this.props;l.length<4&&(l=[l[0],l[1],l[0],l[1]]);let h=this.state.model,p={billboard:r,stroked:Boolean(c),padding:l,sizeUnits:us[i],sizeScale:n,sizeMinPixels:o,sizeMaxPixels:s};h.shaderInputs.setProps({textBackground:p}),h.draw(this.context.renderPass)}_getModel(){let t=[0,0,1,0,0,1,1,1];return new jn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Mi({topology:"triangle-strip",vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(t)}}}),isInstanced:!0})}};Tb.defaultProps=K2t;Tb.layerName="TextBackgroundLayer";var v3=Tb;var _X={start:1,middle:0,end:-1},yX={top:1,center:0,bottom:-1},VD=[0,0,0,255],Z2t=1,$2t={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:VD},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:S0.characterSet},fontFamily:S0.fontFamily,fontWeight:S0.fontWeight,lineHeight:Z2t,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:VD},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:e=>e.text},getPosition:{type:"accessor",value:e=>e.position},getColor:{type:"accessor",value:VD},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}},Eb=class extends vs{constructor(){super(...arguments),this.getBoundingRect=(t,r)=>{let{size:[n,i]}=this.transformParagraph(t,r),{fontSize:o}=this.state.fontAtlasManager.props;n/=o,i/=o;let{getTextAnchor:s,getAlignmentBaseline:c}=this.props,l=_X[typeof s=="function"?s(t,r):s],h=yX[typeof c=="function"?c(t,r):c];return[(l-1)*n/2,(h-1)*i/2,n,i]},this.getIconOffsets=(t,r)=>{let{getTextAnchor:n,getAlignmentBaseline:i}=this.props,{x:o,y:s,rowWidth:c,size:[l,h]}=this.transformParagraph(t,r),p=_X[typeof n=="function"?n(t,r):n],x=yX[typeof i=="function"?i(t,r):i],w=o.length,E=new Array(w*2),P=0;for(let B=0;B<w;B++){let D=(1-p)*(l-c[B])/2;E[P++]=(p-1)*l/2+D+o[B],E[P++]=(x-1)*h/2+s[B]}return E}}initializeState(){this.state={styleVersion:0,fontAtlasManager:new wb},this.props.maxWidth>0&&br.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(t){let{props:r,oldProps:n,changeFlags:i}=t;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||r.lineHeight!==n.lineHeight||r.wordBreak!==n.wordBreak||r.maxWidth!==n.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:t}){return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(){let{fontSettings:t,fontFamily:r,fontWeight:n}=this.props,{fontAtlasManager:i,characterSet:o}=this.state,s={...t,characterSet:o,fontFamily:r,fontWeight:n};if(!i.mapping)return i.setProps(s),!0;for(let c in s)if(s[c]!==i.props[c])return i.setProps(s),!0;return!1}_updateText(){let{data:t,characterSet:r}=this.props,n=t.attributes?.getText,{getText:i}=this.props,o=t.startIndices,s,c=r==="auto"&&new Set;if(n&&o){let{texts:l,characterCount:h}=aX({...ArrayBuffer.isView(n)?{value:n}:n,length:t.length,startIndices:o,characterSet:c});s=h,i=(p,{index:x})=>l[x]}else{let{iterable:l,objectInfo:h}=Xs(t);o=[0],s=0;for(let p of l){h.index++;let x=Array.from(i(p,h)||"");c&&x.forEach(c.add,c),s+=x.length,o.push(s)}}this.setState({getText:i,startIndices:o,numInstances:s,characterSet:c||r})}transformParagraph(t,r){let{fontAtlasManager:n}=this.state,i=n.mapping,o=this.state.getText,{wordBreak:s,lineHeight:c,maxWidth:l}=this.props,h=o(t,r)||"";return sX(h,c,s,l*n.props.fontSize,i)}renderLayers(){let{startIndices:t,numInstances:r,getText:n,fontAtlasManager:{scale:i,atlas:o,mapping:s},styleVersion:c}=this.state,{data:l,_dataDiff:h,getPosition:p,getColor:x,getSize:w,getAngle:E,getPixelOffset:P,getBackgroundColor:B,getBorderColor:D,getBorderWidth:W,backgroundPadding:X,background:q,billboard:$,fontSettings:et,outlineWidth:F,outlineColor:ut,sizeScale:ot,sizeUnits:J,sizeMinPixels:G,sizeMaxPixels:mt,transitions:Mt,updateTriggers:ct}=this.props,gt=this.getSubLayerClass("characters",y3),ee=this.getSubLayerClass("background",v3);return[q&&new ee({getFillColor:B,getLineColor:D,getLineWidth:W,padding:X,getPosition:p,getSize:w,getAngle:E,getPixelOffset:P,billboard:$,sizeScale:ot,sizeUnits:J,sizeMinPixels:G,sizeMaxPixels:mt,transitions:Mt&&{getPosition:Mt.getPosition,getAngle:Mt.getAngle,getSize:Mt.getSize,getFillColor:Mt.getBackgroundColor,getLineColor:Mt.getBorderColor,getLineWidth:Mt.getBorderWidth,getPixelOffset:Mt.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:ct.getPosition,getAngle:ct.getAngle,getSize:ct.getSize,getFillColor:ct.getBackgroundColor,getLineColor:ct.getBorderColor,getLineWidth:ct.getBorderWidth,getPixelOffset:ct.getPixelOffset,getBoundingRect:{getText:ct.getText,getTextAnchor:ct.getTextAnchor,getAlignmentBaseline:ct.getAlignmentBaseline,styleVersion:c}}}),{data:l.attributes&&l.attributes.background?{length:l.length,attributes:l.attributes.background}:l,_dataDiff:h,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new gt({sdf:et.sdf,smoothing:Number.isFinite(et.smoothing)?et.smoothing:S0.smoothing,outlineWidth:F/(et.radius||S0.radius),outlineColor:ut,iconAtlas:o,iconMapping:s,getPosition:p,getColor:x,getSize:w,getAngle:E,getPixelOffset:P,billboard:$,sizeScale:ot*i,sizeUnits:J,sizeMinPixels:G*i,sizeMaxPixels:mt*i,transitions:Mt&&{getPosition:Mt.getPosition,getAngle:Mt.getAngle,getColor:Mt.getColor,getSize:Mt.getSize,getPixelOffset:Mt.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:ct.getText,getPosition:ct.getPosition,getAngle:ct.getAngle,getColor:ct.getColor,getSize:ct.getSize,getPixelOffset:ct.getPixelOffset,getIconOffsets:{getTextAnchor:ct.getTextAnchor,getAlignmentBaseline:ct.getAlignmentBaseline,styleVersion:c}}}),{data:l,_dataDiff:h,startIndices:t,numInstances:r,getIconOffsets:this.getIconOffsets,getIcon:n})]}static set fontAtlasCacheLimit(t){pX(t)}};Eb.defaultProps=$2t;Eb.layerName="TextLayer";var b3=Eb;var Mb={circle:{type:i3,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:py,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:b3,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Sb={type:Yf,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},w3={type:Em,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function _y({type:e,props:t}){let r={};for(let n in t)r[n]=e.defaultProps[t[n]];return r}function T3(e,t){let{transitions:r,updateTriggers:n}=e.props,i={updateTriggers:{},transitions:r&&{getPosition:r.geometry}};for(let o in t){let s=t[o],c=e.props[o];o.startsWith("get")&&(c=e.getSubLayerAccessor(c),i.updateTriggers[s]=n[o],r&&(i.transitions[s]=r[o])),i[s]=c}return i}function vX(e){if(Array.isArray(e))return e;switch(br.assert(e.type,"GeoJSON does not have type"),e.type){case"Feature":return[e];case"FeatureCollection":return br.assert(Array.isArray(e.features),"GeoJSON does not have features array"),e.features;default:return[{geometry:e}]}}function jD(e,t,r={}){let n={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:o=e.length}=r;for(let s=i;s<o;s++){let c=e[s],{geometry:l}=c;if(l)if(l.type==="GeometryCollection"){br.assert(Array.isArray(l.geometries),"GeoJSON does not have geometries array");let{geometries:h}=l;for(let p=0;p<h.length;p++){let x=h[p];xX(x,n,t,c,s)}}else xX(l,n,t,c,s)}return n}function xX(e,t,r,n,i){let{type:o,coordinates:s}=e,{pointFeatures:c,lineFeatures:l,polygonFeatures:h,polygonOutlineFeatures:p}=t;if(!J2t(o,s)){br.warn(`${o} coordinates are malformed`)();return}switch(o){case"Point":c.push(r({geometry:e},n,i));break;case"MultiPoint":s.forEach(x=>{c.push(r({geometry:{type:"Point",coordinates:x}},n,i))});break;case"LineString":l.push(r({geometry:e},n,i));break;case"MultiLineString":s.forEach(x=>{l.push(r({geometry:{type:"LineString",coordinates:x}},n,i))});break;case"Polygon":h.push(r({geometry:e},n,i)),s.forEach(x=>{p.push(r({geometry:{type:"LineString",coordinates:x}},n,i))});break;case"MultiPolygon":s.forEach(x=>{h.push(r({geometry:{type:"Polygon",coordinates:x}},n,i)),x.forEach(w=>{p.push(r({geometry:{type:"LineString",coordinates:w}},n,i))})});break;default:}}var Q2t={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function J2t(e,t){let r=Q2t[e];for(br.assert(r,`Unknown GeoJSON type ${e}`);t&&--r>0;)t=t[0];return t&&Number.isFinite(t[0])}function bX(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function E3(e){return e.geometry.coordinates}function wX(e,t){let r=bX(),{pointFeatures:n,lineFeatures:i,polygonFeatures:o,polygonOutlineFeatures:s}=e;return r.points.data=n,r.points._dataDiff=t.pointFeatures&&(()=>t.pointFeatures),r.points.getPosition=E3,r.lines.data=i,r.lines._dataDiff=t.lineFeatures&&(()=>t.lineFeatures),r.lines.getPath=E3,r.polygons.data=o,r.polygons._dataDiff=t.polygonFeatures&&(()=>t.polygonFeatures),r.polygons.getPolygon=E3,r.polygonsOutline.data=s,r.polygonsOutline._dataDiff=t.polygonOutlineFeatures&&(()=>t.polygonOutlineFeatures),r.polygonsOutline.getPath=E3,r}function TX(e,t){let r=bX(),{points:n,lines:i,polygons:o}=e,s=ZG(e,t);return r.points.data={length:n.positions.value.length/n.positions.size,attributes:{...n.attributes,getPosition:n.positions,instancePickingColors:{size:4,value:s.points}},properties:n.properties,numericProps:n.numericProps,featureIds:n.featureIds},r.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:4,value:s.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},r.lines._pathType="open",r.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{...o.attributes,getPolygon:o.positions,pickingColors:{size:4,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},r.polygons._normalize=!1,o.triangles&&(r.polygons.data.attributes.indices=o.triangles.value),r.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{...o.attributes,getPath:o.positions,instancePickingColors:{size:4,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},r.polygonsOutline._pathType="open",r}var tbt=["points","linestrings","polygons"],ebt={..._y(Mb.circle),..._y(Mb.icon),..._y(Mb.text),..._y(Sb),..._y(w3),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:e=>e.properties.icon},getText:{type:"accessor",value:e=>e.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}},Cb=class extends vs{initializeState(){this.state={layerProps:{},features:{},featuresDiff:{}}}updateState({props:t,changeFlags:r}){if(!r.dataChanged)return;let{data:n}=this.props,i=n&&"points"in n&&"polygons"in n&&"lines"in n;this.setState({binary:i}),i?this._updateStateBinary({props:t,changeFlags:r}):this._updateStateJSON({props:t,changeFlags:r})}_updateStateBinary({props:t,changeFlags:r}){let n=TX(t.data,this.encodePickingColor);this.setState({layerProps:n})}_updateStateJSON({props:t,changeFlags:r}){let n=vX(t.data),i=this.getSubLayerRow.bind(this),o={},s={};if(Array.isArray(r.dataChanged)){let l=this.state.features;for(let h in l)o[h]=l[h].slice(),s[h]=[];for(let h of r.dataChanged){let p=jD(n,i,h);for(let x in l)s[x].push(_3({data:o[x],getIndex:w=>w.__source.index,dataRange:h,replace:p[x]}))}}else o=jD(n,i);let c=wX(o,s);this.setState({features:o,featuresDiff:s,layerProps:c})}getPickingInfo(t){let r=super.getPickingInfo(t),{index:n,sourceLayer:i}=r;return r.featureType=tbt.find(o=>i.id.startsWith(`${this.id}-${o}-`)),n>=0&&i.id.startsWith(`${this.id}-points-text`)&&this.state.binary&&(r.index=this.props.data.points.globalFeatureIds.value[n]),r}_updateAutoHighlight(t){let r=`${this.id}-points-`,n=t.featureType==="points";for(let i of this.getSubLayers())i.id.startsWith(r)===n&&i.updateAutoHighlight(t)}_renderPolygonLayer(){let{extruded:t,wireframe:r}=this.props,{layerProps:n}=this.state,i="polygons-fill",o=this.shouldRenderSubLayer(i,n.polygons?.data)&&this.getSubLayerClass(i,w3.type);if(o){let s=T3(this,w3.props),c=t&&r;return c||delete s.getLineColor,s.updateTriggers.lineColors=c,new o(s,this.getSubLayerProps({id:i,updateTriggers:s.updateTriggers}),n.polygons)}return null}_renderLineLayers(){let{extruded:t,stroked:r}=this.props,{layerProps:n}=this.state,i="polygons-stroke",o="linestrings",s=!t&&r&&this.shouldRenderSubLayer(i,n.polygonsOutline?.data)&&this.getSubLayerClass(i,Sb.type),c=this.shouldRenderSubLayer(o,n.lines?.data)&&this.getSubLayerClass(o,Sb.type);if(s||c){let l=T3(this,Sb.props);return[s&&new s(l,this.getSubLayerProps({id:i,updateTriggers:l.updateTriggers}),n.polygonsOutline),c&&new c(l,this.getSubLayerProps({id:o,updateTriggers:l.updateTriggers}),n.lines)]}return null}_renderPointLayers(){let{pointType:t}=this.props,{layerProps:r,binary:n}=this.state,{highlightedObjectIndex:i}=this.props;!n&&Number.isFinite(i)&&(i=r.points.data.findIndex(c=>c.__source.index===i));let o=new Set(t.split("+")),s=[];for(let c of o){let l=`points-${c}`,h=Mb[c],p=h&&this.shouldRenderSubLayer(l,r.points?.data)&&this.getSubLayerClass(l,h.type);if(p){let x=T3(this,h.props),w=r.points;if(c==="text"&&n){let{instancePickingColors:E,...P}=w.data.attributes;w={...w,data:{...w.data,attributes:P}}}s.push(new p(x,this.getSubLayerProps({id:l,updateTriggers:x.updateTriggers,highlightedObjectIndex:i}),w))}}return s}renderLayers(){let{extruded:t}=this.props,r=this._renderPolygonLayer(),n=this._renderLineLayers(),i=this._renderPointLayers();return[!t&&r,n,i,t&&r]}getSubLayerAccessor(t){let{binary:r}=this.state;return!r||typeof t!="function"?super.getSubLayerAccessor(t):(n,i)=>{let{data:o,index:s}=i,c=KG(o,s);return t(c,i)}}};Cb.layerName="GeoJsonLayer";Cb.defaultProps=ebt;var C0=Cb;function EX({pointCount:e,getBinId:t}){let r=new Map;for(let n=0;n<e;n++){let i=t(n);if(i===null)continue;let o=r.get(String(i));o?o.points.push(n):(o={id:i,index:r.size,points:[n]},r.set(String(i),o))}return Array.from(r.values())}function MX({bins:e,dimensions:t,target:r}){let n=e.length*t;(!r||r.length<n)&&(r=new Float32Array(n));for(let i=0;i<e.length;i++){let{id:o}=e[i];Array.isArray(o)?r.set(o,i*t):r[i]=o}return r}var rbt=e=>e.length,SX=(e,t)=>{let r=0;for(let n of e)r+=t(n);return r},nbt=(e,t)=>e.length===0?NaN:SX(e,t)/e.length,ibt=(e,t)=>{let r=1/0;for(let n of e){let i=t(n);i<r&&(r=i)}return r},obt=(e,t)=>{let r=-1/0;for(let n of e){let i=t(n);i>r&&(r=i)}return r},CX={COUNT:rbt,SUM:SX,MEAN:nbt,MIN:ibt,MAX:obt};function PX({bins:e,getValue:t,operation:r,target:n}){(!n||n.length<e.length)&&(n=new Float32Array(e.length));let i=1/0,o=-1/0;for(let s=0;s<e.length;s++){let{points:c}=e[s];n[s]=r(c,t),n[s]<i&&(i=n[s]),n[s]>o&&(o=n[s])}return{value:n,domain:[i,o]}}function HD(e,t,r){let n={};for(let o of e.sources||[]){let s=t[o];if(s)n[o]=sbt(s);else throw new Error(`Cannot find attribute ${o}`)}let i={};return o=>{for(let s in n)i[s]=n[s](o);return e.getValue(i,o,r)}}function sbt(e){let t=e.value,{offset:r=0,stride:n,size:i}=e.getAccessor(),o=t.BYTES_PER_ELEMENT,s=r/o,c=n?n/o:i;if(i===1)return e.isConstant?()=>t[0]:h=>{let p=s+c*h;return t[p]};let l;return e.isConstant?(l=Array.from(t),()=>l):(l=new Array(i),h=>{let p=s+c*h;for(let x=0;x<i;x++)l[x]=t[p+x];return l})}var dl=class{constructor(t){this.bins=[],this.binIds=null,this.results=[],this.dimensions=t.dimensions,this.channelCount=t.getValue.length,this.props={...t,binOptions:{},pointCount:0,operations:[],customOperations:[],attributes:{}},this.needsUpdate=!0,this.setProps(t)}destroy(){}get binCount(){return this.bins.length}setProps(t){let r=this.props;if(t.binOptions&&(Oi(t.binOptions,r.binOptions,2)||this.setNeedsUpdate()),t.operations)for(let n=0;n<this.channelCount;n++)t.operations[n]!==r.operations[n]&&this.setNeedsUpdate(n);if(t.customOperations)for(let n=0;n<this.channelCount;n++)Boolean(t.customOperations[n])!==Boolean(r.customOperations[n])&&this.setNeedsUpdate(n);t.pointCount!==void 0&&t.pointCount!==r.pointCount&&this.setNeedsUpdate(),t.attributes&&(t.attributes={...r.attributes,...t.attributes}),Object.assign(this.props,t)}setNeedsUpdate(t){t===void 0?this.needsUpdate=!0:this.needsUpdate!==!0&&(this.needsUpdate=this.needsUpdate||[],this.needsUpdate[t]=!0)}update(){if(this.needsUpdate===!0){this.bins=EX({pointCount:this.props.pointCount,getBinId:HD(this.props.getBin,this.props.attributes,this.props.binOptions)});let t=MX({bins:this.bins,dimensions:this.dimensions,target:this.binIds?.value});this.binIds={value:t,type:"float32",size:this.dimensions}}for(let t=0;t<this.channelCount;t++)if(this.needsUpdate===!0||this.needsUpdate[t]){let r=this.props.customOperations[t]||CX[this.props.operations[t]],{value:n,domain:i}=PX({bins:this.bins,getValue:HD(this.props.getValue[t],this.props.attributes,void 0),operation:r,target:this.results[t]?.value});this.results[t]={value:n,domain:i,type:"float32",size:1},this.props.onUpdate?.({channel:t})}this.needsUpdate=!1}preDraw(){}getBins(){return this.binIds}getResult(t){return this.results[t]}getResultDomain(t){return this.results[t]?.domain??[1/0,-1/0]}getBin(t){let r=this.bins[t];if(!r)return null;let n=new Array(this.channelCount);for(let i=0;i<n.length;i++){let o=this.results[i];n[i]=o?.value[t]}return{id:r.id,value:n,count:r.points.length,pointIndices:r.points}}};function M3(e,t,r){return e.createFramebuffer({width:t,height:r,colorAttachments:[e.createTexture({width:t,height:r,format:"rgba32float",mipmaps:!1,sampler:{minFilter:"nearest",magFilter:"nearest"}})]})}var abt=`uniform binSorterUniforms {
  ivec4 binIdRange;
  ivec2 targetSize;
} binSorter;
`,IX={name:"binSorter",vs:abt,uniformTypes:{binIdRange:"vec4<i32>",targetSize:"vec2<i32>"}};var LX=[1,2,4,8],RX=3e38,cbt={SUM:0,MEAN:0,MIN:0,MAX:0,COUNT:0},Pb=1024,S3=class{constructor(t,r){this.binsFBO=null,this.device=t,this.model=ubt(t,r)}get texture(){return this.binsFBO?this.binsFBO.colorAttachments[0].texture:null}destroy(){this.model.destroy(),this.binsFBO?.colorAttachments[0].texture.destroy(),this.binsFBO?.destroy()}getBinValues(t){if(!this.binsFBO)return null;let r=t%Pb,n=Math.floor(t/Pb),i=this.device.readPixelsToArrayWebGL(this.binsFBO,{sourceX:r,sourceY:n,sourceWidth:1,sourceHeight:1}).buffer;return new Float32Array(i)}setDimensions(t,r){let n=Pb,i=Math.ceil(t/n);this.binsFBO?this.binsFBO.height<i&&this.binsFBO.resize({width:n,height:i}):this.binsFBO=M3(this.device,n,i);let o={binIdRange:[r[0][0],r[0][1],r[1]?.[0]||0,r[1]?.[1]||0],targetSize:[this.binsFBO.width,this.binsFBO.height]};this.model.shaderInputs.setProps({binSorter:o})}setModelProps(t){let r=this.model;t.attributes&&r.setAttributes(t.attributes),t.constantAttributes&&r.setConstantAttributes(t.constantAttributes),t.vertexCount!==void 0&&r.setVertexCount(t.vertexCount),t.shaderModuleProps&&r.shaderInputs.setProps(t.shaderModuleProps)}update(t){if(!this.binsFBO)return;let r=lbt(t);this._updateBins("SUM",r.SUM+r.MEAN),this._updateBins("MIN",r.MIN),this._updateBins("MAX",r.MAX)}_updateBins(t,r){if(r===0)return;r|=LX[3];let n=this.model,i=this.binsFBO,o=t==="MAX"?-RX:t==="MIN"?RX:0,s=this.device.beginRenderPass({id:`gpu-aggregation-${t}`,framebuffer:i,parameters:{viewport:[0,0,i.width,i.height],colorMask:r},clearColor:[o,o,o,0],clearDepth:!1,clearStencil:!1});n.setParameters({blend:!0,blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",blendColorOperation:t==="MAX"?"max":t==="MIN"?"min":"add",blendAlphaOperation:"add"}),n.draw(s),s.end()}};function lbt(e){let t={...cbt};for(let r=0;r<e.length;r++){let n=e[r];n&&(t[n]+=LX[r])}return t}function ubt(e,t){let r=t.vs;t.dimensions===2&&(r+=`
void getBin(out int binId) {
  ivec2 binId2;
  getBin(binId2);
  if (binId2.x < binSorter.binIdRange.x || binId2.x >= binSorter.binIdRange.y) {
    binId = -1;
  } else {
    binId = (binId2.y - binSorter.binIdRange.z) * (binSorter.binIdRange.y - binSorter.binIdRange.x) + binId2.x;
  }
}
`);let n=`#version 300 es
#define SHADER_NAME gpu-aggregation-sort-bins-vertex

${r}

out vec3 v_Value;

void main() {
  int binIndex;
  getBin(binIndex);
  binIndex = binIndex - binSorter.binIdRange.x;
  if (binIndex < 0) {
    gl_Position = vec4(0.);
    return;
  }
  int row = binIndex / binSorter.targetSize.x;
  int col = binIndex - row * binSorter.targetSize.x;
  vec2 position = (vec2(col, row) + 0.5) / vec2(binSorter.targetSize) * 2.0 - 1.0;
  gl_Position = vec4(position, 0.0, 1.0);
  gl_PointSize = 1.0;

#if NUM_CHANNELS == 3
  getValue(v_Value);
#elif NUM_CHANNELS == 2
  getValue(v_Value.xy);
#else
  getValue(v_Value.x);
#endif
}
`,i=`#version 300 es
#define SHADER_NAME gpu-aggregation-sort-bins-fragment

precision highp float;

in vec3 v_Value;
out vec4 fragColor;

void main() {
  fragColor.xyz = v_Value;

  #ifdef MODULE_GEOMETRY
  geometry.uv = vec2(0.);
  DECKGL_FILTER_COLOR(fragColor, geometry);
  #endif

  fragColor.w = 1.0;
}
`;return new jn(e,{bufferLayout:t.bufferLayout,modules:[...t.modules||[],IX],defines:{...t.defines,NON_INSTANCED_MODEL:1,NUM_CHANNELS:t.channelCount},isInstanced:!1,vs:n,fs:i,topology:"point-list",disableWarnings:!0})}var hbt=`uniform aggregatorTransformUniforms {
  ivec4 binIdRange;
  bvec3 isCount;
  bvec3 isMean;
  float naN;
} aggregatorTransform;
`,OX={name:"aggregatorTransform",vs:hbt,uniformTypes:{binIdRange:"vec4<i32>",isCount:"vec3<f32>",isMean:"vec3<f32>"}};var WD=3e38,C3=class{constructor(t,r){this.binBuffer=null,this.valueBuffer=null,this._domains=null,this.device=t,this.channelCount=r.channelCount,this.transform=fbt(t,r),this.domainFBO=M3(t,2,1)}destroy(){this.transform.destroy(),this.binBuffer?.destroy(),this.valueBuffer?.destroy(),this.domainFBO.colorAttachments[0].texture.destroy(),this.domainFBO.destroy()}get domains(){if(!this._domains){let t=this.device.readPixelsToArrayWebGL(this.domainFBO).buffer,r=new Float32Array(t);this._domains=[[-r[4],r[0]],[-r[5],r[1]],[-r[6],r[2]]].slice(0,this.channelCount)}return this._domains}setDimensions(t,r){let{model:n,transformFeedback:i}=this.transform;n.setVertexCount(t);let o={binIdRange:[r[0][0],r[0][1],r[1]?.[0]||0,r[1]?.[1]||0]};n.shaderInputs.setProps({aggregatorTransform:o});let s=t*r.length*4;(!this.binBuffer||this.binBuffer.byteLength<s)&&(this.binBuffer?.destroy(),this.binBuffer=this.device.createBuffer({byteLength:s}),i.setBuffer("binIds",this.binBuffer));let c=t*this.channelCount*4;(!this.valueBuffer||this.valueBuffer.byteLength<c)&&(this.valueBuffer?.destroy(),this.valueBuffer=this.device.createBuffer({byteLength:c}),i.setBuffer("values",this.valueBuffer))}update(t,r){if(!t)return;let n=this.transform,i=this.domainFBO,o=[0,1,2].map(l=>r[l]==="COUNT"?1:0),s=[0,1,2].map(l=>r[l]==="MEAN"?1:0),c={isCount:o,isMean:s,bins:t};n.model.shaderInputs.setProps({aggregatorTransform:c}),n.run({id:"gpu-aggregation-domain",framebuffer:i,parameters:{viewport:[0,0,2,1]},clearColor:[-WD,-WD,-WD,0],clearDepth:!1,clearStencil:!1}),this._domains=null}};function fbt(e,t){let r=`#version 300 es
#define SHADER_NAME gpu-aggregation-domain-vertex

uniform sampler2D bins;

#if NUM_DIMS == 1
out float binIds;
#else
out vec2 binIds;
#endif

#if NUM_CHANNELS == 1
flat out float values;
#elif NUM_CHANNELS == 2
flat out vec2 values;
#else
flat out vec3 values;
#endif

const float NAN = intBitsToFloat(-1);

void main() {
  int row = gl_VertexID / SAMPLER_WIDTH;
  int col = gl_VertexID - row * SAMPLER_WIDTH;
  vec4 weights = texelFetch(bins, ivec2(col, row), 0);
  vec3 value3 = mix(
    mix(weights.rgb, vec3(weights.a), aggregatorTransform.isCount),
    weights.rgb / max(weights.a, 1.0),
    aggregatorTransform.isMean
  );
  if (weights.a == 0.0) {
    value3 = vec3(NAN);
  }

#if NUM_DIMS == 1
  binIds = float(gl_VertexID + aggregatorTransform.binIdRange.x);
#else
  int y = gl_VertexID / (aggregatorTransform.binIdRange.y - aggregatorTransform.binIdRange.x);
  int x = gl_VertexID - y * (aggregatorTransform.binIdRange.y - aggregatorTransform.binIdRange.x);
  binIds.y = float(y + aggregatorTransform.binIdRange.z);
  binIds.x = float(x + aggregatorTransform.binIdRange.x);
#endif

#if NUM_CHANNELS == 3
  values = value3;
#elif NUM_CHANNELS == 2
  values = value3.xy;
#else
  values = value3.x;
#endif

  gl_Position = vec4(0., 0., 0., 1.);
  // This model renders into a 2x1 texture to obtain min and max simultaneously.
  // See comments in fragment shader
  gl_PointSize = 2.0;
}
`,n=`#version 300 es
#define SHADER_NAME gpu-aggregation-domain-fragment

precision highp float;

#if NUM_CHANNELS == 1
flat in float values;
#elif NUM_CHANNELS == 2
flat in vec2 values;
#else
flat in vec3 values;
#endif

out vec4 fragColor;

void main() {
  vec3 value3;
#if NUM_CHANNELS == 3
  value3 = values;
#elif NUM_CHANNELS == 2
  value3.xy = values;
#else
  value3.x = values;
#endif
  if (isnan(value3.x)) discard;
  // This shader renders into a 2x1 texture with blending=max
  // The left pixel yields the max value of each channel
  // The right pixel yields the min value of each channel
  if (gl_FragCoord.x < 1.0) {
    fragColor = vec4(value3, 1.0);
  } else {
    fragColor = vec4(-value3, 1.0);
  }
}
`;return new uu(e,{vs:r,fs:n,topology:"point-list",modules:[OX],parameters:{blend:!0,blendColorSrcFactor:"one",blendColorDstFactor:"one",blendColorOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",blendAlphaOperation:"max"},defines:{NUM_DIMS:t.dimensions,NUM_CHANNELS:t.channelCount,SAMPLER_WIDTH:Pb},varyings:["binIds","values"],disableWarnings:!0})}var na=class{static isSupported(t){return t.features.has("float32-renderable-webgl")&&t.features.has("texture-blend-float-webgl")}constructor(t,r){this.binCount=0,this.binIds=null,this.results=[],this.device=t,this.dimensions=r.dimensions,this.channelCount=r.channelCount,this.props={...r,pointCount:0,binIdRange:[[0,0]],operations:[],attributes:{},binOptions:{}},this.needsUpdate=new Array(this.channelCount).fill(!0),this.binSorter=new S3(t,r),this.aggregationTransform=new C3(t,r),this.setProps(r)}getBins(){let t=this.aggregationTransform.binBuffer;return t?(this.binIds?.buffer!==t&&(this.binIds={buffer:t,type:"float32",size:this.dimensions}),this.binIds):null}getResult(t){let r=this.aggregationTransform.valueBuffer;return!r||t>=this.channelCount?null:(this.results[t]?.buffer!==r&&(this.results[t]={buffer:r,type:"float32",size:1,stride:this.channelCount*4,offset:t*4}),this.results[t])}getResultDomain(t){return this.aggregationTransform.domains[t]}getBin(t){if(t<0||t>=this.binCount)return null;let{binIdRange:r}=this.props,n;if(this.dimensions===1)n=[t+r[0][0]];else{let[[c,l],[h]]=r,p=l-c;n=[t%p+c,Math.floor(t/p)+h]}let i=this.binSorter.getBinValues(t);if(!i)return null;let o=i[3],s=[];for(let c=0;c<this.channelCount;c++){let l=this.props.operations[c];l==="COUNT"?s[c]=o:o===0?s[c]=NaN:s[c]=l==="MEAN"?i[c]/o:i[c]}return{id:n,value:s,count:o}}destroy(){this.binSorter.destroy(),this.aggregationTransform.destroy()}setProps(t){let r=this.props;if("binIdRange"in t&&!Oi(t.binIdRange,r.binIdRange,2)){let n=t.binIdRange;if(br.assert(n.length===this.dimensions),this.dimensions===1){let[[i,o]]=n;this.binCount=o-i}else{let[[i,o],[s,c]]=n;this.binCount=(o-i)*(c-s)}this.binSorter.setDimensions(this.binCount,n),this.aggregationTransform.setDimensions(this.binCount,n),this.setNeedsUpdate()}if(t.operations)for(let n=0;n<this.channelCount;n++)t.operations[n]!==r.operations[n]&&this.setNeedsUpdate(n);if(t.pointCount!==void 0&&t.pointCount!==r.pointCount&&(this.binSorter.setModelProps({vertexCount:t.pointCount}),this.setNeedsUpdate()),t.binOptions&&(Oi(t.binOptions,r.binOptions,2)||this.setNeedsUpdate(),this.binSorter.model.shaderInputs.setProps({binOptions:t.binOptions})),t.attributes){let n={},i={};for(let o of Object.values(t.attributes))for(let[s,c]of Object.entries(o.getValue()))ArrayBuffer.isView(c)?i[s]=c:c&&(n[s]=c);this.binSorter.setModelProps({attributes:n,constantAttributes:i})}t.shaderModuleProps&&this.binSorter.setModelProps({shaderModuleProps:t.shaderModuleProps}),Object.assign(this.props,t)}setNeedsUpdate(t){t===void 0?this.needsUpdate.fill(!0):this.needsUpdate[t]=!0}update(){}preDraw(){if(!this.needsUpdate.some(Boolean))return;let{operations:t}=this.props,r=this.needsUpdate.map((n,i)=>n?t[i]:null);this.binSorter.update(r),this.aggregationTransform.update(this.binSorter.texture,t);for(let n=0;n<this.channelCount;n++)this.needsUpdate[n]&&(this.needsUpdate[n]=!1,this.props.onUpdate?.({channel:n}))}};var P3=class extends vs{get isDrawable(){return!0}initializeState(){this.getAttributeManager().remove(["instancePickingColors"])}updateState(t){super.updateState(t);let r=this.getAggregatorType();if(t.changeFlags.extensionsChanged||this.state.aggregatorType!==r){this.state.aggregator?.destroy();let n=this.createAggregator(r);return n.setProps({attributes:this.getAttributeManager()?.attributes}),this.setState({aggregator:n,aggregatorType:r}),!0}return!1}finalizeState(t){super.finalizeState(t),this.state.aggregator.destroy()}updateAttributes(t){let{aggregator:r}=this.state;r.setProps({attributes:t});for(let n in t)this.onAttributeChange(n);r.update()}draw({shaderModuleProps:t}){let{aggregator:r}=this.state;r.setProps({shaderModuleProps:t}),r.preDraw()}_getAttributeManager(){return new fu(this.context.device,{id:this.props.id,stats:this.context.stats})}};P3.layerName="AggregationLayer";var Kf=P3;var Sm=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function qD(e,t=!1,r=Float32Array){let n;if(Number.isFinite(e[0]))n=new r(e);else{n=new r(e.length*4);let i=0;for(let o=0;o<e.length;o++){let s=e[o];n[i++]=s[0],n[i++]=s[1],n[i++]=s[2],n[i++]=Number.isFinite(s[3])?s[3]:255}}if(t)for(let i=0;i<n.length;i++)n[i]/=255;return n}var I3={linear:"linear",quantile:"nearest",quantize:"nearest",ordinal:"nearest"};function yy(e,t){e.setSampler({minFilter:I3[t],magFilter:I3[t]})}function xy(e,t,r="linear"){let n=qD(t,!1,Uint8Array);return e.createTexture({format:"rgba8unorm",mipmaps:!1,sampler:{minFilter:I3[r],magFilter:I3[r],addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},data:n,width:n.length/4,height:1})}var BX=`#version 300 es
#define SHADER_NAME screen-grid-layer-vertex-shader
#define RANGE_COUNT 6
in vec2 positions;
in vec2 instancePositions;
in float instanceWeights;
in vec3 instancePickingColors;
uniform sampler2D colorRange;
out vec4 vColor;
vec4 interp(float value, vec2 domain, sampler2D range) {
float r = (value - domain.x) / (domain.y - domain.x);
return texture(range, vec2(r, 0.5));
}
void main(void) {
if (isnan(instanceWeights)) {
gl_Position = vec4(0.);
return;
}
vec2 pos = instancePositions * screenGrid.gridSizeClipspace + positions * screenGrid.cellSizeClipspace;
pos.x = pos.x - 1.0;
pos.y = 1.0 - pos.y;
gl_Position = vec4(pos, 0., 1.);
vColor = interp(instanceWeights, screenGrid.colorDomain, colorRange);
vColor.a *= layer.opacity;
picking_setPickingColor(instancePickingColors);
}
`;var DX=`#version 300 es
#define SHADER_NAME screen-grid-layer-fragment-shader
precision highp float;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var pbt=`uniform screenGridUniforms {
  vec2 cellSizeClipspace;
  vec2 gridSizeClipspace;
  vec2 colorDomain;
} screenGrid;
`,NX={name:"screenGrid",vs:pbt,uniformTypes:{cellSizeClipspace:"vec2<f32>",gridSizeClipspace:"vec2<f32>",colorDomain:"vec2<f32>"}};var R3=class extends qi{getShaders(){return super.getShaders({vs:BX,fs:DX,modules:[Mo,NX]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:2,type:"float32",accessor:"getBin"},instanceWeights:{size:1,type:"float32",accessor:"getWeight"}}),this.state.model=this._getModel()}updateState(t){super.updateState(t);let{props:r,oldProps:n,changeFlags:i}=t,o=this.state.model;if(n.colorRange!==r.colorRange){this.state.colorTexture?.destroy(),this.state.colorTexture=xy(this.context.device,r.colorRange,r.colorScaleType);let s={colorRange:this.state.colorTexture};o.shaderInputs.setProps({screenGrid:s})}else n.colorScaleType!==r.colorScaleType&&yy(this.state.colorTexture,r.colorScaleType);if(n.cellMarginPixels!==r.cellMarginPixels||n.cellSizePixels!==r.cellSizePixels||i.viewportChanged){let{width:s,height:c}=this.context.viewport,{cellSizePixels:l,cellMarginPixels:h}=this.props,p=Math.max(l-h,0),x={gridSizeClipspace:[l/s*2,l/c*2],cellSizeClipspace:[p/s*2,p/c*2]};o.shaderInputs.setProps({screenGrid:x})}}finalizeState(t){super.finalizeState(t),this.state.colorTexture?.destroy()}draw({uniforms:t}){let r=this.props.colorDomain(),n=this.state.model,i={colorDomain:r};n.shaderInputs.setProps({screenGrid:i}),n.draw(this.context.renderPass)}_getModel(){return new jn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Mi({topology:"triangle-strip",attributes:{positions:{value:new Float32Array([0,0,1,0,0,1,1,1]),size:2}}}),isInstanced:!0})}};R3.layerName="ScreenGridCellLayer";var kX=R3;var dbt=`uniform binOptionsUniforms {
  float cellSizePixels;
} binOptions;
`,FX={name:"binOptions",vs:dbt,uniformTypes:{cellSizePixels:"f32"}};var mbt={cellSizePixels:{type:"number",value:100,min:1},cellMarginPixels:{type:"number",value:2,min:0},colorRange:Sm,colorScaleType:"linear",getPosition:{type:"accessor",value:e=>e.position},getWeight:{type:"accessor",value:1},gpuAggregation:!0,aggregation:"SUM"},Ib=class extends Kf{getAggregatorType(){return this.props.gpuAggregation&&na.isSupported(this.context.device)?"gpu":"cpu"}createAggregator(t){return t==="cpu"||!na.isSupported(this.context.device)?new dl({dimensions:2,getBin:{sources:["positions"],getValue:({positions:r},n,i)=>{let o=this.context.viewport,s=o.project(r),c=i.cellSizePixels;return s[0]<0||s[0]>=o.width||s[1]<0||s[1]>=o.height?null:[Math.floor(s[0]/c),Math.floor(s[1]/c)]}},getValue:[{sources:["counts"],getValue:({counts:r})=>r}]}):new na(this.context.device,{dimensions:2,channelCount:1,bufferLayout:this.getAttributeManager().getBufferLayouts({isInstanced:!1}),...super.getShaders({modules:[Ei,FX],vs:`
  in vec3 positions;
  in vec3 positions64Low;
  in float counts;
  
  void getBin(out ivec2 binId) {
    vec4 pos = project_position_to_clipspace(positions, positions64Low, vec3(0.0));
    vec2 screenCoords = vec2(pos.x / pos.w + 1.0, 1.0 - pos.y / pos.w) / 2.0 * project.viewportSize / project.devicePixelRatio;
    vec2 gridCoords = floor(screenCoords / binOptions.cellSizePixels);
    binId = ivec2(gridCoords);
  }
  void getValue(out float weight) {
    weight = counts;
  }
  `})})}initializeState(){super.initializeState(),this.getAttributeManager().add({positions:{size:3,accessor:"getPosition",type:"float64",fp64:this.use64bitPositions()},counts:{size:1,accessor:"getWeight"}})}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState(t){let r=super.updateState(t),{props:n,oldProps:i,changeFlags:o}=t,{cellSizePixels:s,aggregation:c}=n;if(r||o.dataChanged||o.updateTriggersChanged||o.viewportChanged||c!==i.aggregation||s!==i.cellSizePixels){let{width:l,height:h}=this.context.viewport,{aggregator:p}=this.state;p instanceof na&&p.setProps({binIdRange:[[0,Math.ceil(l/s)],[0,Math.ceil(h/s)]]}),p.setProps({pointCount:this.getNumInstances(),operations:[c],binOptions:{cellSizePixels:s}})}return o.viewportChanged&&this.state.aggregator.setNeedsUpdate(),r}onAttributeChange(t){let{aggregator:r}=this.state;switch(t){case"positions":r.setNeedsUpdate();break;case"counts":r.setNeedsUpdate(0);break;default:}}renderLayers(){let{aggregator:t}=this.state,r=this.getSubLayerClass("cells",kX),n=t.getBins(),i=t.getResult(0);return new r(this.props,this.getSubLayerProps({id:"cell-layer"}),{data:{length:t.binCount,attributes:{getBin:n,getWeight:i}},dataComparator:(o,s)=>o.length===s.length,updateTriggers:{getBin:[n],getWeight:[i]},parameters:{depthWriteEnabled:!1,...this.props.parameters},colorDomain:()=>this.props.colorDomain||t.getResultDomain(0),extensions:[]})}getPickingInfo(t){let r=t.info,{index:n}=r;if(n>=0){let i=this.state.aggregator.getBin(n),o;i&&(o={col:i.id[0],row:i.id[1],value:i.value[0],count:i.count},i.pointIndices&&(o.pointIndices=i.pointIndices,o.points=Array.isArray(this.props.data)?i.pointIndices.map(s=>this.props.data[s]):[])),r.object=o}return r}};Ib.layerName="ScreenGridLayer";Ib.defaultProps=mbt;var zX=Ib;var Cm=class{constructor(t,r){this.props={scaleType:"linear",lowerPercentile:0,upperPercentile:100},this.domain=null,this.cutoff=null,this.input=t,this.inputLength=r,this.attribute=t}getScalePercentile(){if(!this._percentile){let t=UX(this.input,this.inputLength);this._percentile=gbt(t)}return this._percentile}getScaleOrdinal(){if(!this._ordinal){let t=UX(this.input,this.inputLength);this._ordinal=Abt(t)}return this._ordinal}getCutoff({scaleType:t,lowerPercentile:r,upperPercentile:n}){if(t==="quantile")return[r,n-1];if(r>0||n<100){let{domain:i}=this.getScalePercentile(),o=i[Math.floor(r)-1]??-1/0,s=i[Math.floor(n)-1]??1/0;if(t==="ordinal"){let{domain:c}=this.getScaleOrdinal();o=c.findIndex(l=>l>=o),s=c.findIndex(l=>l>s)-1,s===-2&&(s=c.length-1)}return[o,s]}return null}update(t){let r=this.props;if(t.scaleType!==r.scaleType)switch(t.scaleType){case"quantile":{let{attribute:n}=this.getScalePercentile();this.attribute=n,this.domain=[0,99];break}case"ordinal":{let{attribute:n,domain:i}=this.getScaleOrdinal();this.attribute=n,this.domain=[0,i.length-1];break}default:this.attribute=this.input,this.domain=null}return(t.scaleType!==r.scaleType||t.lowerPercentile!==r.lowerPercentile||t.upperPercentile!==r.upperPercentile)&&(this.cutoff=this.getCutoff(t)),this.props=t,this}};function Abt(e){let t=new Set;for(let i of e)Number.isFinite(i)&&t.add(i);let r=Array.from(t).sort(),n=new Map;for(let i=0;i<r.length;i++)n.set(r[i],i);return{attribute:{value:e.map(i=>Number.isFinite(i)?n.get(i):NaN),type:"float32",size:1},domain:r}}function gbt(e,t=100){let r=Array.from(e).filter(Number.isFinite).sort(_bt),n=0,i=Math.max(1,t),o=new Array(i-1);for(;++n<i;)o[n-1]=ybt(r,n/i);return{attribute:{value:e.map(s=>Number.isFinite(s)?xbt(o,s):NaN),type:"float32",size:1},domain:o}}function UX(e,t){let r=(e.stride??4)/4,n=(e.offset??0)/4,i=e.value;if(!i){let s=e.buffer?.readSyncWebGL(0,r*4*t);s&&(i=new Float32Array(s.buffer),e.value=i)}if(r===1)return i.subarray(0,t);let o=new Float32Array(t);for(let s=0;s<t;s++)o[s]=i[s*r+n];return o}function _bt(e,t){return e-t}function ybt(e,t){let r=e.length;if(t<=0||r<2)return e[0];if(t>=1)return e[r-1];let n=(r-1)*t,i=Math.floor(n),o=e[i],s=e[i+1];return o+(s-o)*(n-i)}function xbt(e,t){let r=0,n=e.length;for(;r<n;){let i=r+n>>>1;e[i]>t?n=i:r=i+1}return r}function vy({dataBounds:e,getBinId:t,padding:r=0}){let n=[e[0],e[1],[e[0][0],e[1][1]],[e[1][0],e[0][1]]].map(l=>t(l)),i=Math.min(...n.map(l=>l[0]))-r,o=Math.min(...n.map(l=>l[1]))-r,s=Math.max(...n.map(l=>l[0]))+r+1,c=Math.max(...n.map(l=>l[1]))+r+1;return[[i,s],[o,c]]}var VX=Math.PI/3,L3=2*Math.sin(VX),O3=1.5,jX=Array.from({length:6},(e,t)=>{let r=t*VX;return[Math.sin(r),-Math.cos(r)]});function B3([e,t],r){let n=Math.round(t=t/r/O3),i=Math.round(e=e/r/L3-(n&1)/2),o=t-n;if(Math.abs(o)*3>1){let s=e-i,c=i+(e<i?-1:1)/2,l=n+(t<n?-1:1),h=e-c,p=t-l;s*s+o*o>h*h+p*p&&(i=c+(n&1?1:-1)/2,n=l)}return[i,n]}var HX=`
const vec2 DIST = vec2(${L3}, ${O3});

ivec2 pointToHexbin(vec2 p, float radius) {
  p /= radius * DIST;
  float pj = round(p.y);
  float pjm2 = mod(pj, 2.0);
  p.x -= pjm2 * 0.5;
  float pi = round(p.x);
  vec2 d1 = p - vec2(pi, pj);

  if (abs(d1.y) * 3. > 1.) {
    vec2 v2 = step(0.0, d1) - 0.5;
    v2.y *= 2.0;
    vec2 d2 = d1 - v2;
    if (dot(d1, d1) > dot(d2, d2)) {
      pi += v2.x + pjm2 - 0.5;
      pj += v2.y;
    }
  }
  return ivec2(pi, pj);
}
`;function GD([e,t],r){return[(e+(t&1)/2)*r*L3,t*r*O3]}var WX=`
const vec2 DIST = vec2(${L3}, ${O3});

vec2 hexbinCentroid(vec2 binId, float radius) {
  binId.x += fract(binId.y * 0.5);
  return binId * DIST * radius;
}
`;var qX=`#version 300 es
#define SHADER_NAME hexagon-cell-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec2 instancePositions;
in float instanceElevationValues;
in float instanceColorValues;
in vec3 instancePickingColors;
uniform sampler2D colorRange;
out vec4 vColor;
${WX}
float interp(float value, vec2 domain, vec2 range) {
float r = min(max((value - domain.x) / (domain.y - domain.x), 0.), 1.);
return mix(range.x, range.y, r);
}
vec4 interp(float value, vec2 domain, sampler2D range) {
float r = (value - domain.x) / (domain.y - domain.x);
return texture(range, vec2(r, 0.5));
}
void main(void) {
geometry.pickingColor = instancePickingColors;
if (isnan(instanceColorValues) ||
instanceColorValues < hexagon.colorDomain.z ||
instanceColorValues > hexagon.colorDomain.w ||
instanceElevationValues < hexagon.elevationDomain.z ||
instanceElevationValues > hexagon.elevationDomain.w
) {
gl_Position = vec4(0.);
return;
}
vec2 commonPosition = hexbinCentroid(instancePositions, column.radius) + (hexagon.originCommon - project.commonOrigin.xy);
commonPosition += positions.xy * column.radius * column.coverage;
geometry.position = vec4(commonPosition, 0.0, 1.0);
geometry.normal = project_normal(normals);
float elevation = 0.0;
if (column.extruded) {
elevation = interp(instanceElevationValues, hexagon.elevationDomain.xy, hexagon.elevationRange);
elevation = project_size(elevation);
geometry.position.z = (positions.z + 1.0) / 2.0 * elevation;
}
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vColor = interp(instanceColorValues, hexagon.colorDomain.xy, colorRange);
vColor.a *= layer.opacity;
if (column.extruded) {
vColor.rgb = lighting_getLightColor(vColor.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var vbt=`uniform hexagonUniforms {
  vec4 colorDomain;
  vec4 elevationDomain;
  vec2 elevationRange;
  vec2 originCommon;
} hexagon;
`,GX={name:"hexagon",vs:vbt,uniformTypes:{colorDomain:"vec4<f32>",elevationDomain:"vec4<f32>",elevationRange:"vec2<f32>",originCommon:"vec2<f32>"}};var D3=class extends Xf{getShaders(){let t=super.getShaders();return t.modules.push(GX),{...t,vs:qX}}initializeState(){super.initializeState();let t=this.getAttributeManager();t.remove(["instanceElevations","instanceFillColors","instanceLineColors","instanceStrokeWidths"]),t.addInstanced({instancePositions:{size:2,type:"float32",accessor:"getBin"},instanceColorValues:{size:1,type:"float32",accessor:"getColorValue"},instanceElevationValues:{size:1,type:"float32",accessor:"getElevationValue"}})}updateState(t){super.updateState(t);let{props:r,oldProps:n}=t,i=this.state.fillModel;if(n.colorRange!==r.colorRange){this.state.colorTexture?.destroy(),this.state.colorTexture=xy(this.context.device,r.colorRange,r.colorScaleType);let o={colorRange:this.state.colorTexture};i.shaderInputs.setProps({hexagon:o})}else n.colorScaleType!==r.colorScaleType&&yy(this.state.colorTexture,r.colorScaleType)}finalizeState(t){super.finalizeState(t),this.state.colorTexture?.destroy()}draw({uniforms:t}){let{radius:r,hexOriginCommon:n,elevationRange:i,elevationScale:o,extruded:s,coverage:c,colorDomain:l,elevationDomain:h}=this.props,p=this.props.colorCutoff||[-1/0,1/0],x=this.props.elevationCutoff||[-1/0,1/0],w=this.state.fillModel;w.vertexArray.indexBuffer&&w.setIndexBuffer(null),w.setVertexCount(this.state.fillVertexCount);let E={colorDomain:[Math.max(l[0],p[0]),Math.min(l[1],p[1]),Math.max(l[0]-1,p[0]),Math.min(l[1]+1,p[1])],elevationDomain:[Math.max(h[0],x[0]),Math.min(h[1],x[1]),Math.max(h[0]-1,x[0]),Math.min(h[1]+1,x[1])],elevationRange:[i[0]*o,i[1]*o],originCommon:n};w.shaderInputs.setProps({column:{extruded:s,coverage:c,radius:r},hexagon:E}),w.draw(this.context.renderPass)}};D3.layerName="HexagonCellLayer";var XX=D3;var bbt=`uniform binOptionsUniforms {
  vec2 hexOriginCommon;
  float radiusCommon;
} binOptions;
`,YX={name:"binOptions",vs:bbt,uniformTypes:{hexOriginCommon:"vec2<f32>",radiusCommon:"f32"}};function KX(){}var wbt={gpuAggregation:!0,colorDomain:null,colorRange:Sm,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",min:0,max:100,value:0},upperPercentile:{type:"number",min:0,max:100,value:100},colorScaleType:"quantize",onSetColorDomain:KX,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationScale:{type:"number",min:0,value:1},elevationLowerPercentile:{type:"number",min:0,max:100,value:0},elevationUpperPercentile:{type:"number",min:0,max:100,value:100},elevationScaleType:"linear",onSetElevationDomain:KX,radius:{type:"number",min:1,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:{type:"accessor",value:e=>e.position},hexagonAggregator:{type:"function",optional:!0,value:null},extruded:!1,material:!0},Rb=class extends Kf{getAggregatorType(){let{gpuAggregation:t,hexagonAggregator:r,getColorValue:n,getElevationValue:i}=this.props;return t&&(r||n||i)?(br.warn("Features not supported by GPU aggregation, falling back to CPU")(),"cpu"):t&&na.isSupported(this.context.device)?"gpu":"cpu"}createAggregator(t){if(t==="cpu"){let{hexagonAggregator:r,radius:n}=this.props;return new dl({dimensions:2,getBin:{sources:["positions"],getValue:({positions:i},o,s)=>{if(r)return r(i,n);let l=this.state.aggregatorViewport.projectPosition(i),{radiusCommon:h,hexOriginCommon:p}=s;return B3([l[0]-p[0],l[1]-p[1]],h)}},getValue:[{sources:["colorWeights"],getValue:({colorWeights:i})=>i},{sources:["elevationWeights"],getValue:({elevationWeights:i})=>i}]})}return new na(this.context.device,{dimensions:2,channelCount:2,bufferLayout:this.getAttributeManager().getBufferLayouts({isInstanced:!1}),...super.getShaders({modules:[Ei,YX],vs:`
  in vec3 positions;
  in vec3 positions64Low;
  in float colorWeights;
  in float elevationWeights;
  
  ${HX}

  void getBin(out ivec2 binId) {
    vec3 positionCommon = project_position(positions, positions64Low);
    binId = pointToHexbin(positionCommon.xy, binOptions.radiusCommon);
  }
  void getValue(out vec2 value) {
    value = vec2(colorWeights, elevationWeights);
  }
  `})})}initializeState(){super.initializeState(),this.getAttributeManager().add({positions:{size:3,accessor:"getPosition",type:"float64",fp64:this.use64bitPositions()},colorWeights:{size:1,accessor:"getColorWeight"},elevationWeights:{size:1,accessor:"getElevationWeight"}})}updateState(t){let r=super.updateState(t),{props:n,oldProps:i,changeFlags:o}=t,{aggregator:s}=this.state;if((o.dataChanged||!this.state.dataAsArray)&&(n.getColorValue||n.getElevationValue)&&(this.state.dataAsArray=Array.from(Xs(n.data).iterable)),r||o.dataChanged||n.radius!==i.radius||n.getColorValue!==i.getColorValue||n.getElevationValue!==i.getElevationValue||n.colorAggregation!==i.colorAggregation||n.elevationAggregation!==i.elevationAggregation){this._updateBinOptions();let{radiusCommon:c,hexOriginCommon:l,binIdRange:h,dataAsArray:p}=this.state;if(s.setProps({binIdRange:h,pointCount:this.getNumInstances(),operations:[n.colorAggregation,n.elevationAggregation],binOptions:{radiusCommon:c,hexOriginCommon:l},onUpdate:this._onAggregationUpdate.bind(this)}),p){let{getColorValue:x,getElevationValue:w}=this.props;s.setProps({customOperations:[x&&(E=>x(E.map(P=>p[P]),{indices:E,data:n.data})),w&&(E=>w(E.map(P=>p[P]),{indices:E,data:n.data}))]})}}return o.updateTriggersChanged&&o.updateTriggersChanged.getColorValue&&s.setNeedsUpdate(0),o.updateTriggersChanged&&o.updateTriggersChanged.getElevationValue&&s.setNeedsUpdate(1),r}_updateBinOptions(){let t=this.getBounds(),r=1,n=[0,0],i=[[0,1],[0,1]],o=this.context.viewport;if(t&&Number.isFinite(t[0][0])){let s=[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2],{radius:c}=this.props,{unitsPerMeter:l}=o.getDistanceScales(s);r=l[0]*c;let h=B3(o.projectFlat(s),r);s=o.unprojectFlat(GD(h,r));let p=o.constructor;o=o.isGeospatial?new p({longitude:s[0],latitude:s[1],zoom:12}):new wa({position:[s[0],s[1],0],zoom:12}),n=[Math.fround(o.center[0]),Math.fround(o.center[1])],i=vy({dataBounds:t,getBinId:x=>{let w=o.projectFlat(x);return w[0]-=n[0],w[1]-=n[1],B3(w,r)},padding:1})}this.setState({radiusCommon:r,hexOriginCommon:n,binIdRange:i,aggregatorViewport:o})}draw(t){t.shaderModuleProps.project&&(t.shaderModuleProps.project.viewport=this.state.aggregatorViewport),super.draw(t)}_onAggregationUpdate({channel:t}){let r=this.getCurrentLayer().props,{aggregator:n}=this.state;if(t===0){let i=n.getResult(0);this.setState({colors:new Cm(i,n.binCount)}),r.onSetColorDomain(n.getResultDomain(0))}else if(t===1){let i=n.getResult(1);this.setState({elevations:new Cm(i,n.binCount)}),r.onSetElevationDomain(n.getResultDomain(1))}}onAttributeChange(t){let{aggregator:r}=this.state;switch(t){case"positions":r.setNeedsUpdate(),this._updateBinOptions();let{radiusCommon:n,hexOriginCommon:i,binIdRange:o}=this.state;r.setProps({binIdRange:o,binOptions:{radiusCommon:n,hexOriginCommon:i}});break;case"colorWeights":r.setNeedsUpdate(0);break;case"elevationWeights":r.setNeedsUpdate(1);break;default:}}renderLayers(){let{aggregator:t,radiusCommon:r,hexOriginCommon:n}=this.state,{elevationScale:i,colorRange:o,elevationRange:s,extruded:c,coverage:l,material:h,transitions:p,colorScaleType:x,lowerPercentile:w,upperPercentile:E,colorDomain:P,elevationScaleType:B,elevationLowerPercentile:D,elevationUpperPercentile:W,elevationDomain:X}=this.props,q=this.getSubLayerClass("cells",XX),$=t.getBins(),et=this.state.colors?.update({scaleType:x,lowerPercentile:w,upperPercentile:E}),F=this.state.elevations?.update({scaleType:B,lowerPercentile:D,upperPercentile:W});return!et||!F?null:new q(this.getSubLayerProps({id:"cells"}),{data:{length:t.binCount,attributes:{getBin:$,getColorValue:et.attribute,getElevationValue:F.attribute}},dataComparator:(ut,ot)=>ut.length===ot.length,updateTriggers:{getBin:[$],getColorValue:[et.attribute],getElevationValue:[F.attribute]},diskResolution:6,vertices:jX,radius:r,hexOriginCommon:n,elevationScale:i,colorRange:o,colorScaleType:x,elevationRange:s,extruded:c,coverage:l,material:h,colorDomain:et.domain||P||t.getResultDomain(0),elevationDomain:F.domain||X||t.getResultDomain(1),colorCutoff:et.cutoff,elevationCutoff:F.cutoff,transitions:p&&{getFillColor:p.getColorValue||p.getColorWeight,getElevation:p.getElevationValue||p.getElevationWeight},extensions:[]})}getPickingInfo(t){let r=t.info,{index:n}=r;if(n>=0){let i=this.state.aggregator.getBin(n),o;if(i){let s=GD(i.id,this.state.radiusCommon),c=this.context.viewport.unprojectFlat(s);o={col:i.id[0],row:i.id[1],position:c,colorValue:i.value[0],elevationValue:i.value[1],count:i.count},i.pointIndices&&(o.pointIndices=i.pointIndices,o.points=Array.isArray(this.props.data)?i.pointIndices.map(l=>this.props.data[l]):[])}r.object=o}return r}};Rb.layerName="HexagonLayer";Rb.defaultProps=wbt;var ZX=Rb;var Gr=.16666666666666666,Ce={N:[0,.5],E:[.5,0],S:[0,-.5],W:[-.5,0],NE:[.5,.5],NW:[-.5,.5],SE:[.5,-.5],SW:[-.5,-.5]},by=[Ce.W,Ce.SW,Ce.S],wy=[Ce.S,Ce.SE,Ce.E],Ty=[Ce.E,Ce.NE,Ce.N],Ey=[Ce.NW,Ce.W,Ce.N],My=[[-.5,Gr],[-.5,-Gr],[-Gr,-.5],[Gr,-.5]],Sy=[[-Gr,-.5],[Gr,-.5],[.5,-Gr],[.5,Gr]],Cy=[[.5,-Gr],[.5,Gr],[Gr,.5],[-Gr,.5]],Py=[[-.5,Gr],[-.5,-Gr],[Gr,.5],[-Gr,.5]],$X=[Ce.W,Ce.SW,Ce.SE,Ce.E],QX=[Ce.S,Ce.SE,Ce.NE,Ce.N],JX=[Ce.NW,Ce.W,Ce.E,Ce.NE],tY=[Ce.NW,Ce.SW,Ce.S,Ce.N],eY=[[-.5,Gr],[-.5,-Gr],[.5,-Gr],[.5,Gr]],rY=[[-Gr,-.5],[Gr,-.5],[Gr,.5],[-Gr,.5]],Tbt=[Ce.NW,Ce.SW,Ce.SE,Ce.NE],nY=[Ce.NW,Ce.SW,Ce.SE,Ce.E,Ce.N],iY=[Ce.W,Ce.SW,Ce.SE,Ce.NE,Ce.N],oY=[Ce.NW,Ce.W,Ce.S,Ce.SE,Ce.NE],sY=[Ce.NW,Ce.SW,Ce.S,Ce.E,Ce.NE],aY=[Ce.NW,Ce.W,[.5,-Gr],[.5,Gr],Ce.N],cY=[[-Gr,-.5],[Gr,-.5],Ce.E,Ce.NE,Ce.N],lY=[[-.5,Gr],[-.5,-Gr],Ce.S,Ce.SE,Ce.E],uY=[Ce.W,Ce.SW,Ce.S,[Gr,.5],[-Gr,.5]],hY=[Ce.NW,Ce.W,[-Gr,-.5],[Gr,-.5],Ce.N],fY=[[-.5,Gr],[-.5,-Gr],Ce.E,Ce.NE,Ce.N],pY=[Ce.S,Ce.SE,Ce.E,[Gr,.5],[-Gr,.5]],dY=[Ce.W,Ce.SW,Ce.S,[.5,-Gr],[.5,Gr]],mY=[Ce.W,Ce.SW,Ce.SE,Ce.E,[Gr,.5],[-Gr,.5]],AY=[[-.5,Gr],[-.5,-Gr],Ce.S,Ce.SE,Ce.NE,Ce.N],gY=[Ce.NW,Ce.W,[-Gr,-.5],[Gr,-.5],Ce.E,Ce.NE],_Y=[Ce.NW,Ce.SW,Ce.S,[.5,-Gr],[.5,Gr],Ce.N],Iy=[Ce.W,Ce.SW,Ce.S,Ce.E,Ce.NE,Ce.N],Ry=[Ce.NW,Ce.W,Ce.S,Ce.SE,Ce.E,Ce.N],N3=[[-.5,Gr],[-.5,-Gr],[-Gr,-.5],[Gr,-.5],Ce.E,Ce.NE,Ce.N],k3=[Ce.W,Ce.SW,Ce.S,[.5,-Gr],[.5,Gr],[Gr,.5],[-Gr,.5]],F3=[Ce.NW,Ce.W,[-Gr,-.5],[Gr,-.5],[.5,-Gr],[.5,Gr],Ce.N],z3=[[-.5,Gr],[-.5,-Gr],Ce.S,Ce.SE,Ce.E,[Gr,.5],[-Gr,.5]],yY=[[-.5,Gr],[-.5,-Gr],[-Gr,-.5],[Gr,-.5],[.5,-Gr],[.5,Gr],[Gr,.5],[-Gr,.5]],xY={0:[],1:[[Ce.W,Ce.S]],2:[[Ce.S,Ce.E]],3:[[Ce.W,Ce.E]],4:[[Ce.N,Ce.E]],5:{0:[[Ce.W,Ce.S],[Ce.N,Ce.E]],1:[[Ce.W,Ce.N],[Ce.S,Ce.E]]},6:[[Ce.N,Ce.S]],7:[[Ce.W,Ce.N]],8:[[Ce.W,Ce.N]],9:[[Ce.N,Ce.S]],10:{0:[[Ce.W,Ce.N],[Ce.S,Ce.E]],1:[[Ce.W,Ce.S],[Ce.N,Ce.E]]},11:[[Ce.N,Ce.E]],12:[[Ce.W,Ce.E]],13:[[Ce.S,Ce.E]],14:[[Ce.W,Ce.S]],15:[]};function Dr(e){return parseInt(e,4)}var vY={[Dr("0000")]:[],[Dr("2222")]:[],[Dr("2221")]:[by],[Dr("2212")]:[wy],[Dr("2122")]:[Ty],[Dr("1222")]:[Ey],[Dr("0001")]:[by],[Dr("0010")]:[wy],[Dr("0100")]:[Ty],[Dr("1000")]:[Ey],[Dr("2220")]:[My],[Dr("2202")]:[Sy],[Dr("2022")]:[Cy],[Dr("0222")]:[Py],[Dr("0002")]:[My],[Dr("0020")]:[Sy],[Dr("0200")]:[Cy],[Dr("2000")]:[Py],[Dr("0011")]:[$X],[Dr("0110")]:[QX],[Dr("1100")]:[JX],[Dr("1001")]:[tY],[Dr("2211")]:[$X],[Dr("2112")]:[QX],[Dr("1122")]:[JX],[Dr("1221")]:[tY],[Dr("2200")]:[eY],[Dr("2002")]:[rY],[Dr("0022")]:[eY],[Dr("0220")]:[rY],[Dr("1111")]:[Tbt],[Dr("1211")]:[nY],[Dr("2111")]:[iY],[Dr("1112")]:[oY],[Dr("1121")]:[sY],[Dr("1011")]:[nY],[Dr("0111")]:[iY],[Dr("1110")]:[oY],[Dr("1101")]:[sY],[Dr("1200")]:[aY],[Dr("0120")]:[cY],[Dr("0012")]:[lY],[Dr("2001")]:[uY],[Dr("1022")]:[aY],[Dr("2102")]:[cY],[Dr("2210")]:[lY],[Dr("0221")]:[uY],[Dr("1002")]:[hY],[Dr("2100")]:[fY],[Dr("0210")]:[pY],[Dr("0021")]:[dY],[Dr("1220")]:[hY],[Dr("0122")]:[fY],[Dr("2012")]:[pY],[Dr("2201")]:[dY],[Dr("0211")]:[mY],[Dr("2110")]:[AY],[Dr("1102")]:[gY],[Dr("1021")]:[_Y],[Dr("2011")]:[mY],[Dr("0112")]:[AY],[Dr("1120")]:[gY],[Dr("1201")]:[_Y],[Dr("2101")]:[Iy],[Dr("0121")]:[Iy],[Dr("1012")]:[Ry],[Dr("1210")]:[Ry],[Dr("0101")]:{0:[by,Ty],1:[Iy],2:[Iy]},[Dr("1010")]:{0:[Ey,wy],1:[Ry],2:[Ry]},[Dr("2121")]:{0:[Iy],1:[Iy],2:[by,Ty]},[Dr("1212")]:{0:[Ry],1:[Ry],2:[Ey,wy]},[Dr("2120")]:{0:[N3],1:[N3],2:[My,Ty]},[Dr("2021")]:{0:[k3],1:[k3],2:[by,Cy]},[Dr("1202")]:{0:[F3],1:[F3],2:[Ey,Sy]},[Dr("0212")]:{0:[z3],1:[z3],2:[wy,Py]},[Dr("0102")]:{0:[My,Ty],1:[N3],2:[N3]},[Dr("0201")]:{0:[by,Cy],1:[k3],2:[k3]},[Dr("1020")]:{0:[Ey,Sy],1:[F3],2:[F3]},[Dr("2010")]:{0:[wy,Py],1:[z3],2:[z3]},[Dr("2020")]:{0:[Py,Sy],1:[yY],2:[My,Cy]},[Dr("0202")]:{0:[Cy,My],1:[yY],2:[Py,Sy]}};function Lb(e,t){return Number.isNaN(e)?0:Array.isArray(t)?e<t[0]?0:e<t[1]?1:2:e>=t?1:0}function bY(e){let{x:t,y:r,xRange:n,yRange:i,getValue:o,threshold:s}=e,c=t<n[0],l=t>=n[1]-1,h=r<i[0],p=r>=i[1]-1,x=c||l||h||p,w=0,E,P,B,D;if(c||p)B=0;else{let q=o(t,r+1);B=Lb(q,s),w+=q}if(l||p)D=0;else{let q=o(t+1,r+1);D=Lb(q,s),w+=q}if(l||h)P=0;else{let q=o(t+1,r);P=Lb(q,s),w+=q}if(c||h)E=0;else{let q=o(t,r);E=Lb(q,s),w+=q}let W=-1;Number.isFinite(s)&&(W=B<<3|D<<2|P<<1|E),Array.isArray(s)&&(W=B<<6|D<<4|P<<2|E);let X=0;return x||(X=Lb(w/4,s)),{code:W,meanCode:X}}function wY(e){let{x:t,y:r,z:n,code:i,meanCode:o}=e,s=vY[i];Array.isArray(s)||(s=s[o]);let c=t+1,l=r+1,h=[];return s.forEach(p=>{let x=[];p.forEach(w=>{let E=c+w[0],P=l+w[1];x.push([E,P,n])}),h.push(x)}),h}function TY(e){let{x:t,y:r,z:n,code:i,meanCode:o}=e,s=xY[i];Array.isArray(s)||(s=s[o]);let c=t+1,l=r+1,h=[];return s.forEach(p=>{p.forEach(x=>{let w=c+x[0],E=l+x[1];h.push([w,E,n])})}),h}function EY({contours:e,getValue:t,xRange:r,yRange:n}){let i=[],o=[],s=0,c=0;for(let l=0;l<e.length;l++){let h=e[l],p=h.zIndex??l,{threshold:x}=h;for(let w=r[0]-1;w<r[1];w++)for(let E=n[0]-1;E<n[1];E++){let{code:P,meanCode:B}=bY({getValue:t,threshold:x,x:w,y:E,xRange:r,yRange:n}),D={x:w,y:E,z:p,code:P,meanCode:B};if(Array.isArray(x)){let W=wY(D);for(let X of W)o[c++]={vertices:X,contour:h}}else{let W=TY(D);W.length>0&&(i[s++]={vertices:W,contour:h})}}}return{lines:i,polygons:o}}function MY(e){let{aggregator:t,binIdRange:r,channel:n}=e;if(t instanceof na){let i=t.getResult(n)?.buffer;if(i){let o=new Float32Array(i.readSyncWebGL().buffer);return Ebt(o,r)}}if(t instanceof dl){let i=t.getResult(n)?.value,o=t.getBins()?.value;if(o&&i)return Mbt(i,o,t.binCount)}return null}function Ebt(e,t){let[[r,n],[i,o]]=t,s=n-r,c=o-i;return(l,h)=>(l-=r,h-=i,l<0||l>=s||h<0||h>=c?NaN:e[h*s+l])}function Mbt(e,t,r){let n={};for(let i=0;i<r;i++){let o=t[i*2],s=t[i*2+1];n[o]=n[o]||{},n[o][s]=e[i]}return(i,o)=>n[i]?.[o]??NaN}var Sbt=`uniform binOptionsUniforms {
  vec2 cellOriginCommon;
  vec2 cellSizeCommon;
} binOptions;
`,SY={name:"binOptions",vs:Sbt,uniformTypes:{cellOriginCommon:"vec2<f32>",cellSizeCommon:"vec2<f32>"}};var CY=[255,255,255,255],Cbt=1,Pbt={cellSize:{type:"number",min:1,value:1e3},gridOrigin:{type:"array",compare:!0,value:[0,0]},getPosition:{type:"accessor",value:e=>e.position},getWeight:{type:"accessor",value:1},gpuAggregation:!0,aggregation:"SUM",contours:{type:"object",value:[{threshold:1}],optional:!0,compare:3},zOffset:.005},Ob=class extends Kf{getAggregatorType(){return this.props.gpuAggregation&&na.isSupported(this.context.device)?"gpu":"cpu"}createAggregator(t){return t==="cpu"?new dl({dimensions:2,getBin:{sources:["positions"],getValue:({positions:r},n,i)=>{let s=this.state.aggregatorViewport.projectPosition(r),{cellSizeCommon:c,cellOriginCommon:l}=i;return[Math.floor((s[0]-l[0])/c[0]),Math.floor((s[1]-l[1])/c[1])]}},getValue:[{sources:["counts"],getValue:({counts:r})=>r}],onUpdate:this._onAggregationUpdate.bind(this)}):new na(this.context.device,{dimensions:2,channelCount:1,bufferLayout:this.getAttributeManager().getBufferLayouts({isInstanced:!1}),...super.getShaders({modules:[Ei,SY],vs:`
  in vec3 positions;
  in vec3 positions64Low;
  in float counts;

  void getBin(out ivec2 binId) {
    vec3 positionCommon = project_position(positions, positions64Low);
    vec2 gridCoords = floor(positionCommon.xy / binOptions.cellSizeCommon);
    binId = ivec2(gridCoords);
  }
  void getValue(out float value) {
    value = counts;
  }
  `}),onUpdate:this._onAggregationUpdate.bind(this)})}initializeState(){super.initializeState(),this.getAttributeManager().add({positions:{size:3,accessor:"getPosition",type:"float64",fp64:this.use64bitPositions()},counts:{size:1,accessor:"getWeight"}})}updateState(t){let r=super.updateState(t),{props:n,oldProps:i,changeFlags:o}=t,{aggregator:s}=this.state;if(r||o.dataChanged||n.cellSize!==i.cellSize||!Oi(n.gridOrigin,i.gridOrigin,1)||n.aggregation!==i.aggregation){this._updateBinOptions();let{cellSizeCommon:c,cellOriginCommon:l,binIdRange:h}=this.state;s.setProps({binIdRange:h,pointCount:this.getNumInstances(),operations:[n.aggregation],binOptions:{cellSizeCommon:c,cellOriginCommon:l}})}return Oi(i.contours,n.contours,2)||this.setState({contourData:null}),r}_updateBinOptions(){let t=this.getBounds(),r=[1,1],n=[0,0],i=[[0,1],[0,1]],o=this.context.viewport;if(t&&Number.isFinite(t[0][0])){let s=[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2],{cellSize:c,gridOrigin:l}=this.props,{unitsPerMeter:h}=o.getDistanceScales(s);r[0]=h[0]*c,r[1]=h[1]*c;let p=o.projectFlat(s);n=[Math.floor((p[0]-l[0])/r[0])*r[0]+l[0],Math.floor((p[1]-l[1])/r[1])*r[1]+l[1]],s=o.unprojectFlat(n);let x=o.constructor;o=o.isGeospatial?new x({longitude:s[0],latitude:s[1],zoom:12}):new wa({position:[s[0],s[1],0],zoom:12}),n=[Math.fround(o.center[0]),Math.fround(o.center[1])],i=vy({dataBounds:t,getBinId:w=>{let E=o.projectFlat(w);return[Math.floor((E[0]-n[0])/r[0]),Math.floor((E[1]-n[1])/r[1])]}})}this.setState({cellSizeCommon:r,cellOriginCommon:n,binIdRange:i,aggregatorViewport:o})}draw(t){t.shaderModuleProps.project&&(t.shaderModuleProps.project.viewport=this.state.aggregatorViewport),super.draw(t)}_onAggregationUpdate(){let{aggregator:t,binIdRange:r}=this.state;this.setState({aggregatedValueReader:MY({aggregator:t,binIdRange:r,channel:0}),contourData:null})}_getContours(){let{aggregatedValueReader:t}=this.state;if(!t)return null;if(!this.state.contourData){let{binIdRange:r}=this.state,{contours:n}=this.props,i=EY({contours:n,getValue:t,xRange:r[0],yRange:r[1]});this.state.contourData=i}return this.state.contourData}onAttributeChange(t){let{aggregator:r}=this.state;switch(t){case"positions":r.setNeedsUpdate(),this._updateBinOptions();let{cellSizeCommon:n,cellOriginCommon:i,binIdRange:o}=this.state;r.setProps({binIdRange:o,binOptions:{cellSizeCommon:n,cellOriginCommon:i}});break;case"counts":r.setNeedsUpdate(0);break;default:}}renderLayers(){let t=this._getContours();if(!t)return null;let{lines:r,polygons:n}=t,{zOffset:i}=this.props,{cellOriginCommon:o,cellSizeCommon:s}=this.state,c=this.getSubLayerClass("lines",Yf),l=this.getSubLayerClass("bands",Em),h=new Fn().translate([o[0],o[1],0]).scale([s[0],s[1],i]),p=r&&r.length>0&&new c(this.getSubLayerProps({id:"lines"}),{data:r,coordinateSystem:Yr.CARTESIAN,modelMatrix:h,getPath:w=>w.vertices,getColor:w=>w.contour.color??CY,getWidth:w=>w.contour.strokeWidth??Cbt,widthUnits:"pixels"}),x=n&&n.length>0&&new l(this.getSubLayerProps({id:"bands"}),{data:n,coordinateSystem:Yr.CARTESIAN,modelMatrix:h,getPolygon:w=>w.vertices,getFillColor:w=>w.contour.color??CY});return[p,x]}getPickingInfo(t){let r=t.info,{object:n}=r;return n&&(r.object={contour:n.contour}),r}};Ob.layerName="ContourLayer";Ob.defaultProps=Pbt;var PY=Ob;var IY=`#version 300 es
#define SHADER_NAME grid-cell-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec2 instancePositions;
in float instanceElevationValues;
in float instanceColorValues;
in vec3 instancePickingColors;
uniform sampler2D colorRange;
out vec4 vColor;
float interp(float value, vec2 domain, vec2 range) {
float r = min(max((value - domain.x) / (domain.y - domain.x), 0.), 1.);
return mix(range.x, range.y, r);
}
vec4 interp(float value, vec2 domain, sampler2D range) {
float r = (value - domain.x) / (domain.y - domain.x);
return texture(range, vec2(r, 0.5));
}
void main(void) {
geometry.pickingColor = instancePickingColors;
if (isnan(instanceColorValues) ||
instanceColorValues < grid.colorDomain.z ||
instanceColorValues > grid.colorDomain.w ||
instanceElevationValues < grid.elevationDomain.z ||
instanceElevationValues > grid.elevationDomain.w
) {
gl_Position = vec4(0.);
return;
}
vec2 commonPosition = (instancePositions + (positions.xy + 1.0) / 2.0 * column.coverage) * grid.sizeCommon + grid.originCommon - project.commonOrigin.xy;
geometry.position = vec4(commonPosition, 0.0, 1.0);
geometry.normal = project_normal(normals);
float elevation = 0.0;
if (column.extruded) {
elevation = interp(instanceElevationValues, grid.elevationDomain.xy, grid.elevationRange);
elevation = project_size(elevation);
geometry.position.z = (positions.z + 1.0) / 2.0 * elevation;
}
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vColor = interp(instanceColorValues, grid.colorDomain.xy, colorRange);
vColor.a *= layer.opacity;
if (column.extruded) {
vColor.rgb = lighting_getLightColor(vColor.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var Ibt=`uniform gridUniforms {
  vec4 colorDomain;
  vec4 elevationDomain;
  vec2 elevationRange;
  vec2 originCommon;
  vec2 sizeCommon;
} grid;
`,RY={name:"grid",vs:Ibt,uniformTypes:{colorDomain:"vec4<f32>",elevationDomain:"vec4<f32>",elevationRange:"vec2<f32>",originCommon:"vec2<f32>",sizeCommon:"vec2<f32>"}};var Bb=class extends Xf{getShaders(){let t=super.getShaders();return t.modules.push(RY),{...t,vs:IY}}initializeState(){super.initializeState();let t=this.getAttributeManager();t.remove(["instanceElevations","instanceFillColors","instanceLineColors","instanceStrokeWidths"]),t.addInstanced({instancePositions:{size:2,type:"float32",accessor:"getBin"},instanceColorValues:{size:1,type:"float32",accessor:"getColorValue"},instanceElevationValues:{size:1,type:"float32",accessor:"getElevationValue"}})}updateState(t){super.updateState(t);let{props:r,oldProps:n}=t,i=this.state.fillModel;if(n.colorRange!==r.colorRange){this.state.colorTexture?.destroy(),this.state.colorTexture=xy(this.context.device,r.colorRange,r.colorScaleType);let o={colorRange:this.state.colorTexture};i.shaderInputs.setProps({grid:o})}else n.colorScaleType!==r.colorScaleType&&yy(this.state.colorTexture,r.colorScaleType)}finalizeState(t){super.finalizeState(t),this.state.colorTexture?.destroy()}_updateGeometry(){let t=new Xp;this.state.fillModel.setGeometry(t)}draw({uniforms:t}){let{cellOriginCommon:r,cellSizeCommon:n,elevationRange:i,elevationScale:o,extruded:s,coverage:c,colorDomain:l,elevationDomain:h}=this.props,p=this.props.colorCutoff||[-1/0,1/0],x=this.props.elevationCutoff||[-1/0,1/0],w=this.state.fillModel,E={colorDomain:[Math.max(l[0],p[0]),Math.min(l[1],p[1]),Math.max(l[0]-1,p[0]),Math.min(l[1]+1,p[1])],elevationDomain:[Math.max(h[0],x[0]),Math.min(h[1],x[1]),Math.max(h[0]-1,x[0]),Math.min(h[1]+1,x[1])],elevationRange:[i[0]*o,i[1]*o],originCommon:r,sizeCommon:n};w.shaderInputs.setProps({column:{extruded:s,coverage:c},grid:E}),w.draw(this.context.renderPass)}};Bb.layerName="GridCellLayer";var Rbt=`uniform binOptionsUniforms {
  vec2 cellOriginCommon;
  vec2 cellSizeCommon;
} binOptions;
`,LY={name:"binOptions",vs:Rbt,uniformTypes:{cellOriginCommon:"vec2<f32>",cellSizeCommon:"vec2<f32>"}};function OY(){}var Lbt={gpuAggregation:!0,colorDomain:null,colorRange:Sm,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",min:0,max:100,value:0},upperPercentile:{type:"number",min:0,max:100,value:100},colorScaleType:"quantize",onSetColorDomain:OY,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationScale:{type:"number",min:0,value:1},elevationLowerPercentile:{type:"number",min:0,max:100,value:0},elevationUpperPercentile:{type:"number",min:0,max:100,value:100},elevationScaleType:"linear",onSetElevationDomain:OY,cellSize:{type:"number",min:0,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:{type:"accessor",value:e=>e.position},gridAggregator:{type:"function",optional:!0,value:null},extruded:!1,material:!0},Db=class extends Kf{getAggregatorType(){let{gpuAggregation:t,gridAggregator:r,getColorValue:n,getElevationValue:i}=this.props;return t&&(r||n||i)?(br.warn("Features not supported by GPU aggregation, falling back to CPU")(),"cpu"):t&&na.isSupported(this.context.device)?"gpu":"cpu"}createAggregator(t){if(t==="cpu"){let{gridAggregator:r,cellSize:n}=this.props;return new dl({dimensions:2,getBin:{sources:["positions"],getValue:({positions:i},o,s)=>{if(r)return r(i,n);let l=this.state.aggregatorViewport.projectPosition(i),{cellSizeCommon:h,cellOriginCommon:p}=s;return[Math.floor((l[0]-p[0])/h[0]),Math.floor((l[1]-p[1])/h[1])]}},getValue:[{sources:["colorWeights"],getValue:({colorWeights:i})=>i},{sources:["elevationWeights"],getValue:({elevationWeights:i})=>i}]})}return new na(this.context.device,{dimensions:2,channelCount:2,bufferLayout:this.getAttributeManager().getBufferLayouts({isInstanced:!1}),...super.getShaders({modules:[Ei,LY],vs:`
  in vec3 positions;
  in vec3 positions64Low;
  in float colorWeights;
  in float elevationWeights;

  void getBin(out ivec2 binId) {
    vec3 positionCommon = project_position(positions, positions64Low);
    vec2 gridCoords = floor(positionCommon.xy / binOptions.cellSizeCommon);
    binId = ivec2(gridCoords);
  }
  void getValue(out vec2 value) {
    value = vec2(colorWeights, elevationWeights);
  }
  `})})}initializeState(){super.initializeState(),this.getAttributeManager().add({positions:{size:3,accessor:"getPosition",type:"float64",fp64:this.use64bitPositions()},colorWeights:{size:1,accessor:"getColorWeight"},elevationWeights:{size:1,accessor:"getElevationWeight"}})}updateState(t){let r=super.updateState(t),{props:n,oldProps:i,changeFlags:o}=t,{aggregator:s}=this.state;if((o.dataChanged||!this.state.dataAsArray)&&(n.getColorValue||n.getElevationValue)&&(this.state.dataAsArray=Array.from(Xs(n.data).iterable)),r||o.dataChanged||n.cellSize!==i.cellSize||n.getColorValue!==i.getColorValue||n.getElevationValue!==i.getElevationValue||n.colorAggregation!==i.colorAggregation||n.elevationAggregation!==i.elevationAggregation){this._updateBinOptions();let{cellSizeCommon:c,cellOriginCommon:l,binIdRange:h,dataAsArray:p}=this.state;if(s.setProps({binIdRange:h,pointCount:this.getNumInstances(),operations:[n.colorAggregation,n.elevationAggregation],binOptions:{cellSizeCommon:c,cellOriginCommon:l},onUpdate:this._onAggregationUpdate.bind(this)}),p){let{getColorValue:x,getElevationValue:w}=this.props;s.setProps({customOperations:[x&&(E=>x(E.map(P=>p[P]),{indices:E,data:n.data})),w&&(E=>w(E.map(P=>p[P]),{indices:E,data:n.data}))]})}}return o.updateTriggersChanged&&o.updateTriggersChanged.getColorValue&&s.setNeedsUpdate(0),o.updateTriggersChanged&&o.updateTriggersChanged.getElevationValue&&s.setNeedsUpdate(1),r}_updateBinOptions(){let t=this.getBounds(),r=[1,1],n=[0,0],i=[[0,1],[0,1]],o=this.context.viewport;if(t&&Number.isFinite(t[0][0])){let s=[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2],{cellSize:c}=this.props,{unitsPerMeter:l}=o.getDistanceScales(s);r[0]=l[0]*c,r[1]=l[1]*c;let h=o.projectFlat(s);n=[Math.floor(h[0]/r[0])*r[0],Math.floor(h[1]/r[1])*r[1]],s=o.unprojectFlat(n);let p=o.constructor;o=o.isGeospatial?new p({longitude:s[0],latitude:s[1],zoom:12}):new wa({position:[s[0],s[1],0],zoom:12}),n=[Math.fround(o.center[0]),Math.fround(o.center[1])],i=vy({dataBounds:t,getBinId:x=>{let w=o.projectFlat(x);return[Math.floor((w[0]-n[0])/r[0]),Math.floor((w[1]-n[1])/r[1])]}})}this.setState({cellSizeCommon:r,cellOriginCommon:n,binIdRange:i,aggregatorViewport:o})}draw(t){t.shaderModuleProps.project&&(t.shaderModuleProps.project.viewport=this.state.aggregatorViewport),super.draw(t)}_onAggregationUpdate({channel:t}){let r=this.getCurrentLayer().props,{aggregator:n}=this.state;if(t===0){let i=n.getResult(0);this.setState({colors:new Cm(i,n.binCount)}),r.onSetColorDomain(n.getResultDomain(0))}else if(t===1){let i=n.getResult(1);this.setState({elevations:new Cm(i,n.binCount)}),r.onSetElevationDomain(n.getResultDomain(1))}}onAttributeChange(t){let{aggregator:r}=this.state;switch(t){case"positions":r.setNeedsUpdate(),this._updateBinOptions();let{cellSizeCommon:n,cellOriginCommon:i,binIdRange:o}=this.state;r.setProps({binIdRange:o,binOptions:{cellSizeCommon:n,cellOriginCommon:i}});break;case"colorWeights":r.setNeedsUpdate(0);break;case"elevationWeights":r.setNeedsUpdate(1);break;default:}}renderLayers(){let{aggregator:t,cellOriginCommon:r,cellSizeCommon:n}=this.state,{elevationScale:i,colorRange:o,elevationRange:s,extruded:c,coverage:l,material:h,transitions:p,colorScaleType:x,lowerPercentile:w,upperPercentile:E,colorDomain:P,elevationScaleType:B,elevationLowerPercentile:D,elevationUpperPercentile:W,elevationDomain:X}=this.props,q=this.getSubLayerClass("cells",Bb),$=t.getBins(),et=this.state.colors?.update({scaleType:x,lowerPercentile:w,upperPercentile:E}),F=this.state.elevations?.update({scaleType:B,lowerPercentile:D,upperPercentile:W});return!et||!F?null:new q(this.getSubLayerProps({id:"cells"}),{data:{length:t.binCount,attributes:{getBin:$,getColorValue:et.attribute,getElevationValue:F.attribute}},dataComparator:(ut,ot)=>ut.length===ot.length,updateTriggers:{getBin:[$],getColorValue:[et.attribute],getElevationValue:[F.attribute]},cellOriginCommon:r,cellSizeCommon:n,elevationScale:i,colorRange:o,colorScaleType:x,elevationRange:s,extruded:c,coverage:l,material:h,colorDomain:et.domain||P||t.getResultDomain(0),elevationDomain:F.domain||X||t.getResultDomain(1),colorCutoff:et.cutoff,elevationCutoff:F.cutoff,transitions:p&&{getFillColor:p.getColorValue||p.getColorWeight,getElevation:p.getElevationValue||p.getElevationWeight},extensions:[]})}getPickingInfo(t){let r=t.info,{index:n}=r;if(n>=0){let i=this.state.aggregator.getBin(n),o;i&&(o={col:i.id[0],row:i.id[1],colorValue:i.value[0],elevationValue:i.value[1],count:i.count},i.pointIndices&&(o.pointIndices=i.pointIndices,o.points=Array.isArray(this.props.data)?i.pointIndices.map(s=>this.props.data[s]):[])),r.object=o}return r}};Db.layerName="GridLayer";Db.defaultProps=Lbt;var BY=Db;function NY(e){let t=e.map(c=>c[0]),r=e.map(c=>c[1]),n=Math.min.apply(null,t),i=Math.max.apply(null,t),o=Math.min.apply(null,r),s=Math.max.apply(null,r);return[n,o,i,s]}function kY(e,t){return t[0]>=e[0]&&t[2]<=e[2]&&t[1]>=e[1]&&t[3]<=e[3]}var DY=new Float32Array(12);function XD(e,t=2){let r=0;for(let n of e)for(let i=0;i<t;i++)DY[r++]=n[i]||0;return DY}function FY(e,t,r){let[n,i,o,s]=e,c=o-n,l=s-i,h=c,p=l;c/l<t/r?h=t/r*l:p=r/t*c,h<t&&(h=t,p=r);let x=(o+n)/2,w=(s+i)/2;return[x-h/2,w-p/2,x+h/2,w+p/2]}function zY(e,t){let[r,n,i,o]=t;return[(e[0]-r)/(i-r),(e[1]-n)/(o-n)]}var UY=`#version 300 es
#define SHADER_NAME heatp-map-layer-vertex-shader
uniform sampler2D maxTexture;
in vec3 positions;
in vec2 texCoords;
out vec2 vTexCoords;
out float vIntensityMin;
out float vIntensityMax;
void main(void) {
gl_Position = project_position_to_clipspace(positions, vec3(0.0), vec3(0.0));
vTexCoords = texCoords;
vec4 maxTexture = texture(maxTexture, vec2(0.5));
float maxValue = triangle.aggregationMode < 0.5 ? maxTexture.r : maxTexture.g;
float minValue = maxValue * triangle.threshold;
if (triangle.colorDomain[1] > 0.) {
maxValue = triangle.colorDomain[1];
minValue = triangle.colorDomain[0];
}
vIntensityMax = triangle.intensity / maxValue;
vIntensityMin = triangle.intensity / minValue;
}
`;var VY=`#version 300 es
#define SHADER_NAME triangle-layer-fragment-shader
precision highp float;
uniform sampler2D weightsTexture;
uniform sampler2D colorTexture;
in vec2 vTexCoords;
in float vIntensityMin;
in float vIntensityMax;
out vec4 fragColor;
vec4 getLinearColor(float value) {
float factor = clamp(value * vIntensityMax, 0., 1.);
vec4 color = texture(colorTexture, vec2(factor, 0.5));
color.a *= min(value * vIntensityMin, 1.0);
return color;
}
void main(void) {
vec4 weights = texture(weightsTexture, vTexCoords);
float weight = weights.r;
if (triangle.aggregationMode > 0.5) {
weight /= max(1.0, weights.a);
}
if (weight <= 0.) {
discard;
}
vec4 linearColor = getLinearColor(weight);
linearColor.a *= layer.opacity;
fragColor = linearColor;
}
`;var jY=`uniform triangleUniforms {
  float aggregationMode;
  vec2 colorDomain;
  float intensity;
  float threshold;
} triangle;
`,HY={name:"triangle",vs:jY,fs:jY,uniformTypes:{aggregationMode:"f32",colorDomain:"vec2<f32>",intensity:"f32",threshold:"f32"}};var U3=class extends qi{getShaders(){return super.getShaders({vs:UY,fs:VY,modules:[Ei,HY]})}initializeState({device:t}){this.setState({model:this._getModel(t)})}_getModel(t){let{vertexCount:r,data:n}=this.props;return new jn(t,{...this.getShaders(),id:this.props.id,attributes:n.attributes,bufferLayout:[{name:"positions",format:"float32x3"},{name:"texCoords",format:"float32x2"}],topology:"triangle-strip",vertexCount:r})}draw(){let{model:t}=this.state,{aggregationMode:r,colorDomain:n,intensity:i,threshold:o,colorTexture:s,maxTexture:c,weightsTexture:l}=this.props,h={aggregationMode:r,colorDomain:n,intensity:i,threshold:o,colorTexture:s,maxTexture:c,weightsTexture:l};t.shaderInputs.setProps({triangle:h}),t.draw(this.context.renderPass)}};U3.layerName="TriangleLayer";var WY=U3;function qY(e,t){let r={};for(let n in e)t.includes(n)||(r[n]=e[n]);return r}var V3=class extends vs{initializeAggregationLayer(t){super.initializeState(this.context),this.setState({ignoreProps:qY(this.constructor._propTypes,t.data.props),dimensions:t})}updateState(t){super.updateState(t);let{changeFlags:r}=t;if(r.extensionsChanged){let n=this.getShaders({});n&&n.defines&&(n.defines.NON_INSTANCED_MODEL=1),this.updateShaders(n)}this._updateAttributes()}updateAttributes(t){this.setState({changedAttributes:t})}getAttributes(){return this.getAttributeManager().getAttributes()}getModuleSettings(){let{viewport:t,mousePosition:r,device:n}=this.context;return Object.assign(Object.create(this.props),{viewport:t,mousePosition:r,picking:{isActive:0},devicePixelRatio:n.canvasContext.cssToDeviceRatio()})}updateShaders(t){}isAggregationDirty(t,r={}){let{props:n,oldProps:i,changeFlags:o}=t,{compareAll:s=!1,dimension:c}=r,{ignoreProps:l}=this.state,{props:h,accessors:p=[]}=c,{updateTriggersChanged:x}=o;if(o.dataChanged)return!0;if(x){if(x.all)return!0;for(let w of p)if(x[w])return!0}if(s)return o.extensionsChanged?!0:uy({oldProps:i,newProps:n,ignoreProps:l,propTypes:this.constructor._propTypes});for(let w of h)if(n[w]!==i[w])return!0;return!1}isAttributeChanged(t){let{changedAttributes:r}=this.state;return t?r&&r[t]!==void 0:!Obt(r)}_getAttributeManager(){return new fu(this.context.device,{id:this.props.id,stats:this.context.stats})}};V3.layerName="AggregationLayer";var GY=V3;function Obt(e){let t=!0;for(let r in e){t=!1;break}return t}var YD=`#version 300 es
in vec3 positions;
in vec3 positions64Low;
in float weights;
out vec4 weightsTexture;
void main()
{
weightsTexture = vec4(weights * weight.weightsScale, 0., 0., 1.);
float radiusTexels = project_pixel_size(weight.radiusPixels) * weight.textureWidth / (weight.commonBounds.z - weight.commonBounds.x);
gl_PointSize = radiusTexels * 2.;
vec3 commonPosition = project_position(positions, positions64Low);
gl_Position.xy = (commonPosition.xy - weight.commonBounds.xy) / (weight.commonBounds.zw - weight.commonBounds.xy) ;
gl_Position.xy = (gl_Position.xy * 2.) - (1.);
gl_Position.w = 1.0;
}
`;var KD=`#version 300 es
in vec4 weightsTexture;
out vec4 fragColor;
float gaussianKDE(float u){
return pow(2.71828, -u*u/0.05555)/(1.77245385*0.166666);
}
void main()
{
float dist = length(gl_PointCoord - vec2(0.5, 0.5));
if (dist > 0.5) {
discard;
}
fragColor = weightsTexture * gaussianKDE(2. * dist);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var XY=`#version 300 es
uniform sampler2D inTexture;
out vec4 outTexture;
void main()
{
int yIndex = gl_VertexID / int(maxWeight.textureSize);
int xIndex = gl_VertexID - (yIndex * int(maxWeight.textureSize));
vec2 uv = (0.5 + vec2(float(xIndex), float(yIndex))) / maxWeight.textureSize;
outTexture = texture(inTexture, uv);
gl_Position = vec4(0.0, 0.0, 0.0, 1.0);
gl_PointSize = 1.0;
}
`;var YY=`#version 300 es
in vec4 outTexture;
out vec4 fragColor;
void main() {
fragColor = outTexture;
fragColor.g = outTexture.r / max(1.0, outTexture.a);
}
`;var Bbt=`uniform weightUniforms {
  vec4 commonBounds;
  float radiusPixels;
  float textureWidth;
  float weightsScale;
} weight;
`,KY={name:"weight",vs:Bbt,uniformTypes:{commonBounds:"vec4<f32>",radiusPixels:"f32",textureWidth:"f32",weightsScale:"f32"}},ZY={name:"maxWeight",vs:`uniform maxWeightUniforms {
  float textureSize;
} maxWeight;
`,uniformTypes:{textureSize:"f32"}};var Dbt=2,ZD={format:"rgba8unorm",mipmaps:!1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}},$Y=[0,0],Nbt={SUM:0,MEAN:1},kbt={getPosition:{type:"accessor",value:e=>e.position},getWeight:{type:"accessor",value:1},intensity:{type:"number",min:0,value:1},radiusPixels:{type:"number",min:1,max:100,value:50},colorRange:Sm,threshold:{type:"number",min:0,max:1,value:.05},colorDomain:{type:"array",value:null,optional:!0},aggregation:"SUM",weightsTextureSize:{type:"number",min:128,max:2048,value:2048},debounceTimeout:{type:"number",min:0,max:1e3,value:500}},Fbt=["float32-renderable-webgl","texture-blend-float-webgl"],zbt={data:{props:["radiusPixels"]}},Nb=class extends GY{getShaders(t){let r=[Ei];return t.modules&&(r=[...r,...t.modules]),super.getShaders({...t,modules:r})}initializeState(){super.initializeAggregationLayer(zbt),this.setState({colorDomain:$Y}),this._setupTextureParams(),this._setupAttributes(),this._setupResources()}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState(t){super.updateState(t),this._updateHeatmapState(t)}_updateHeatmapState(t){let{props:r,oldProps:n}=t,i=this._getChangeFlags(t);(i.dataChanged||i.viewportChanged)&&(i.boundsChanged=this._updateBounds(i.dataChanged),this._updateTextureRenderingBounds()),i.dataChanged||i.boundsChanged?(clearTimeout(this.state.updateTimer),this.setState({isWeightMapDirty:!0})):i.viewportZoomChanged&&this._debouncedUpdateWeightmap(),r.colorRange!==n.colorRange&&this._updateColorTexture(t),this.state.isWeightMapDirty&&this._updateWeightmap(),this.setState({zoom:t.context.viewport.zoom})}renderLayers(){let{weightsTexture:t,triPositionBuffer:r,triTexCoordBuffer:n,maxWeightsTexture:i,colorTexture:o,colorDomain:s}=this.state,{updateTriggers:c,intensity:l,threshold:h,aggregation:p}=this.props,x=this.getSubLayerClass("triangle",WY);return new x(this.getSubLayerProps({id:"triangle-layer",updateTriggers:c}),{coordinateSystem:Yr.DEFAULT,data:{attributes:{positions:r,texCoords:n}},vertexCount:4,maxTexture:i,colorTexture:o,aggregationMode:Nbt[p]||0,weightsTexture:t,intensity:l,threshold:h,colorDomain:s})}finalizeState(t){super.finalizeState(t);let{weightsTransform:r,weightsTexture:n,maxWeightTransform:i,maxWeightsTexture:o,triPositionBuffer:s,triTexCoordBuffer:c,colorTexture:l,updateTimer:h}=this.state;r?.destroy(),n?.destroy(),i?.destroy(),o?.destroy(),s?.destroy(),c?.destroy(),l?.destroy(),h&&clearTimeout(h)}_getAttributeManager(){return new fu(this.context.device,{id:this.props.id,stats:this.context.stats})}_getChangeFlags(t){let r={},{dimensions:n}=this.state;r.dataChanged=this.isAttributeChanged()&&"attribute changed"||this.isAggregationDirty(t,{compareAll:!0,dimension:n.data})&&"aggregation is dirty",r.viewportChanged=t.changeFlags.viewportChanged;let{zoom:i}=this.state;return(!t.context.viewport||t.context.viewport.zoom!==i)&&(r.viewportZoomChanged=!0),r}_createTextures(){let{textureSize:t,format:r}=this.state;this.setState({weightsTexture:this.context.device.createTexture({...ZD,width:t,height:t,format:r}),maxWeightsTexture:this.context.device.createTexture({...ZD,width:1,height:1,format:r})})}_setupAttributes(){this.getAttributeManager().add({positions:{size:3,type:"float64",accessor:"getPosition"},weights:{size:1,accessor:"getWeight"}}),this.setState({positionAttributeName:"positions"})}_setupTextureParams(){let{device:t}=this.context,{weightsTextureSize:r}=this.props,n=Math.min(r,t.limits.maxTextureDimension2D),i=Fbt.every(c=>t.features.has(c)),o=i?"rgba32float":"rgba8unorm",s=i?1:1/255;this.setState({textureSize:n,format:o,weightsScale:s}),i||br.warn(`HeatmapLayer: ${this.id} rendering to float texture not supported, falling back to low precision format`)()}_createWeightsTransform(t){let{weightsTransform:r}=this.state,{weightsTexture:n}=this.state,i=this.getAttributeManager();r?.destroy(),r=new gm(this.context.device,{id:`${this.id}-weights-transform`,bufferLayout:i.getBufferLayouts(),vertexCount:1,targetTexture:n,parameters:{depthWriteEnabled:!1,blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"},topology:"point-list",...t,modules:[...t.modules,KY]}),this.setState({weightsTransform:r})}_setupResources(){this._createTextures();let{device:t}=this.context,{textureSize:r,weightsTexture:n,maxWeightsTexture:i}=this.state,o=this.getShaders({vs:YD,fs:KD});this._createWeightsTransform(o);let s=this.getShaders({vs:XY,fs:YY,modules:[ZY]}),c=new gm(t,{id:`${this.id}-max-weights-transform`,targetTexture:i,...s,vertexCount:r*r,topology:"point-list",parameters:{depthWriteEnabled:!1,blendColorOperation:"max",blendAlphaOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}}),l={inTexture:n,textureSize:r};c.model.shaderInputs.setProps({maxWeight:l}),this.setState({weightsTexture:n,maxWeightsTexture:i,maxWeightTransform:c,zoom:null,triPositionBuffer:t.createBuffer({byteLength:48}),triTexCoordBuffer:t.createBuffer({byteLength:48})})}updateShaders(t){this._createWeightsTransform({vs:YD,fs:KD,...t})}_updateMaxWeightValue(){let{maxWeightTransform:t}=this.state;t.run({parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]})}_updateBounds(t=!1){let{viewport:r}=this.context,n=[r.unproject([0,0]),r.unproject([r.width,0]),r.unproject([0,r.height]),r.unproject([r.width,r.height])].map(c=>c.map(Math.fround)),i=NY(n),o={visibleWorldBounds:i,viewportCorners:n},s=!1;if(t||!this.state.worldBounds||!kY(this.state.worldBounds,i)){let c=this._worldToCommonBounds(i),l=this._commonToWorldBounds(c);this.props.coordinateSystem===Yr.LNGLAT&&(l[1]=Math.max(l[1],-85.051129),l[3]=Math.min(l[3],85.051129),l[0]=Math.max(l[0],-360),l[2]=Math.min(l[2],360));let h=this._worldToCommonBounds(l);o.worldBounds=l,o.normalizedCommonBounds=h,s=!0}return this.setState(o),s}_updateTextureRenderingBounds(){let{triPositionBuffer:t,triTexCoordBuffer:r,normalizedCommonBounds:n,viewportCorners:i}=this.state,{viewport:o}=this.context;t.write(XD(i,3));let s=i.map(c=>zY(o.projectPosition(c),n));r.write(XD(s,2))}_updateColorTexture(t){let{colorRange:r}=t.props,{colorTexture:n}=this.state,i=qD(r,!1,Uint8Array);n&&n?.width===r.length?n.setTexture2DData({data:i}):(n?.destroy(),n=this.context.device.createTexture({...ZD,data:i,width:r.length,height:1})),this.setState({colorTexture:n})}_updateWeightmap(){let{radiusPixels:t,colorDomain:r,aggregation:n}=this.props,{worldBounds:i,textureSize:o,weightsScale:s,weightsTexture:c}=this.state,l=this.state.weightsTransform;this.state.isWeightMapDirty=!1;let h=this._worldToCommonBounds(i,{useLayerCoordinateSystem:!0});if(r&&n==="SUM"){let{viewport:q}=this.context,$=q.distanceScales.metersPerUnit[2]*(h[2]-h[0])/o;this.state.colorDomain=r.map(et=>et*$*s)}else this.state.colorDomain=r||$Y;let x=this.getAttributeManager().getAttributes(),w=this.getModuleSettings();this._setModelAttributes(l.model,x),l.model.setVertexCount(this.getNumInstances());let E={radiusPixels:t,commonBounds:h,textureWidth:o,weightsScale:s,weightsTexture:c},{viewport:P,devicePixelRatio:B,coordinateSystem:D,coordinateOrigin:W}=w,{modelMatrix:X}=this.props;l.model.shaderInputs.setProps({project:{viewport:P,devicePixelRatio:B,modelMatrix:X,coordinateSystem:D,coordinateOrigin:W},weight:E}),l.run({parameters:{viewport:[0,0,o,o]},clearColor:[0,0,0,0]}),this._updateMaxWeightValue()}_debouncedUpdateWeightmap(t=!1){let{updateTimer:r}=this.state,{debounceTimeout:n}=this.props;t?(r=null,this._updateBounds(!0),this._updateTextureRenderingBounds(),this.setState({isWeightMapDirty:!0})):(this.setState({isWeightMapDirty:!1}),clearTimeout(r),r=setTimeout(this._debouncedUpdateWeightmap.bind(this,!0),n)),this.setState({updateTimer:r})}_worldToCommonBounds(t,r={}){let{useLayerCoordinateSystem:n=!1}=r,[i,o,s,c]=t,{viewport:l}=this.context,{textureSize:h}=this.state,{coordinateSystem:p}=this.props,x=n&&(p===Yr.LNGLAT_OFFSETS||p===Yr.METER_OFFSETS),w=x?l.projectPosition(this.props.coordinateOrigin):[0,0],E=h*Dbt/l.scale,P,B;return n&&!x?(P=this.projectPosition([i,o,0]),B=this.projectPosition([s,c,0])):(P=l.projectPosition([i,o,0]),B=l.projectPosition([s,c,0])),FY([P[0]-w[0],P[1]-w[1],B[0]-w[0],B[1]-w[1]],E,E)}_commonToWorldBounds(t){let[r,n,i,o]=t,{viewport:s}=this.context,c=s.unprojectPosition([r,n]),l=s.unprojectPosition([i,o]);return c.slice(0,2).concat(l.slice(0,2))}};Nb.layerName="HeatmapLayer";Nb.defaultProps=kbt;var QY=Nb;function Ubt(e){return typeof e=="string"?e.charAt(0).toLowerCase()+e.slice(1):e}function j3(e){if(Array.isArray(e))return e.map(t=>j3(t));if(e&&typeof e=="object"){let t={};for(let[r,n]of Object.entries(e))t[Ubt(r)]=j3(n);return t}return e}var RK=tc(IK(),1);function oN(e,t){if(t?._parser&&t._parser!=="fast-xml-parser")throw new Error(t?._parser);let r={allowBooleanAttributes:!0,ignoreDeclaration:!0,removeNSPrefix:t?.removeNSPrefix,textNodeName:t?.textNodeName,isArray:(i,o,s,c)=>Boolean(t?.arrayPaths?.some(h=>o===h)),...t?._fastXML},n=Kwt(e,r);return t?.uncapitalizeKeys?j3(n):n}function Kwt(e,t){return new RK.XMLParser({ignoreAttributes:!1,attributeNamePrefix:"",...t}).parse(e)}var Zwt="4.2.1",Uh={dataType:null,batchType:null,name:"XML",id:"xml",module:"xml",version:Zwt,worker:!1,extensions:["xml"],mimeTypes:["application/xml","text/xml"],testText:$wt,options:{xml:{_parser:"fast-xml-parser",uncapitalizeKeys:!1,removeNSPrefix:!1,textNodeName:"value",arrayPaths:[]}},parse:async(e,t)=>oN(new TextDecoder().decode(e),{...Uh.options.xml,...t?.xml}),parseTextSync:(e,t)=>oN(e,{...Uh.options.xml,...t?.xml})};function $wt(e){return e.startsWith("<?xml")}function LK(e,t){let r=Uh.parseTextSync?.(e,t),n=r?.ServiceExceptionReport?.ServiceException||r?.["ogc:ServiceExceptionReport"]?.["ogc:ServiceException"];return typeof n=="string"?n:n.value||n.code||"Unknown error"}var Qwt="4.2.1",zb={dataType:null,batchType:null,id:"wms-error",name:"WMS Error",module:"wms",version:Qwt,worker:!1,extensions:["xml"],mimeTypes:["application/vnd.ogc.se_xml","application/xml","text/xml"],testText:Jwt,options:{wms:{throwOnError:!1}},parse:async(e,t)=>sN(new TextDecoder().decode(e),t),parseSync:(e,t)=>sN(new TextDecoder().decode(e),t),parseTextSync:(e,t)=>sN(e,t)};function Jwt(e){return e.startsWith("<?xml")}function sN(e,t){let r={...zb.options.wms,...t?.wms},n=LK(e,r),i=r.minimalErrors?n:`WMS Service error: ${n}`;if(r.throwOnError)throw new Error(i);return i}function I0(e){return Array.isArray(e)?e:e?[e]:[]}function Ub(e){let t=I0(e);return t.length>0&&t.every(r=>typeof r=="string")?t:[]}function Vb(e,t=void 0){switch(typeof e){case"number":return e;case"string":return parseFloat(e);default:return}}function W3(e,t=void 0){switch(typeof e){case"number":return e;case"string":return parseInt(e,10);default:return}}function R0(e){switch(e){case"true":return!0;case"false":return!1;case"1":return!0;case"0":return!1;default:return!1}}function aN(e,t){let r=Uh.parseTextSync?.(e,t),n=r.WMT_MS_Capabilities||r.WMS_Capabilities||r,i=tTt(n);if(t?.inheritedLayerProps)for(let o of i.layers)BK(o,null);return t?.includeRawJSON&&(i.json=n),t?.includeXMLText&&(i.xml=e),i}function tTt(e){let t={version:String(e.version||""),name:String(e.Service?.Name||"unnamed"),title:e.Service?.Title?String(e.Service?.Title):void 0,abstract:e.Service?.Abstract?String(e.Service?.Abstract):void 0,keywords:Ub(e.Service?.KeywordList?.Keyword),fees:e.Service?.Fees?JSON.stringify(e.Service?.Fees):void 0,accessConstraints:e.Service?.AccessConstraints?JSON.stringify(e.Service?.AccessConstraints):void 0,layerLimit:W3(e.Service?.LayerLimit),maxWidth:W3(e.Service?.maxWidth),maxHeight:W3(e.Service?.maxHeight),layers:[],requests:eTt(e.Capability?.Request),exceptions:rTt(e.Exception)},r=I0(e.Capability?.Layer);for(let n of r)t.layers.push(OK(n));for(let[n,i]of Object.entries(t))i===void 0&&delete t[n];return t}function eTt(e){let t={};for(let[r,n]of Object.entries(e||{})){let i=Ub(n?.Format);t[r]={mimeTypes:i}}return t}function rTt(e){if(I0(e?.Format).length>0)return{mimeTypes:Ub(e)}}function OK(e){let t={title:String(e?.Title||""),name:e?.Name&&String(e?.Name),abstract:e?.Name&&String(e?.Abstract),keywords:Ub(e.KeywordList?.Keyword)},r=e?.CRS||e?.SRS;r&&Array.isArray(r)&&r.every(h=>typeof h=="string")&&(t.crs=r);let n=e?.EX_GeographicBoundingBox&&nTt(e?.EX_GeographicBoundingBox);n&&(t.geographicBoundingBox=n),n=e?.LatLonBoundingBox&&iTt(e?.LatLonBoundingBox),n&&(t.geographicBoundingBox=n);let i=e?.BoundingBox&&oTt(e?.BoundingBox);i&&i.length>0&&(t.boundingBoxes=i);let s=I0(e?.Dimension).map(h=>aTt(h));s.length&&(t.dimensions=s),e?.opaque&&(t.opaque=R0(e?.opaque)),e?.cascaded&&(t.cascaded=R0(e?.cascaded)),e?.queryable&&(t.queryable=R0(e?.queryable));let c=I0(e?.Layer),l=[];for(let h of c)l.push(OK(h));l.length>0&&(t.layers=l);for(let[h,p]of Object.entries(t))p===void 0&&delete t[h];return t}function nTt(e){let{westBoundLongitude:t,northBoundLatitude:r,eastBoundLongitude:n,southBoundLatitude:i}=e;return[[t,i],[n,r]]}function iTt(e){let{minx:t,miny:r,maxx:n,maxy:i}=e;return[[t,r],[n,i]]}function oTt(e){return I0(e).map(r=>sTt(r))}function sTt(e){let{CRS:t,SRS:r,minx:n,miny:i,maxx:o,maxy:s,resx:c,resy:l}=e,h={crs:t||r,boundingBox:[[Vb(n),Vb(i)],[Vb(o),Vb(s)]]};return c&&(h.xResolution=c),l&&(h.yResolution=l),h}function aTt(e){let{name:t,units:r,value:n}=e,i={name:t,units:r,extent:n};return e.unitSymbol&&(i.unitSymbol=e.unitSymbol),e.default&&(i.defaultValue=e.default),e.multipleValues&&(i.multipleValues=R0(e.multipleValues)),e.nearestValue&&(i.nearestValue=R0(e.nearestValue)),e.current&&(i.current=R0(e.current)),i}function BK(e,t){t?.geographicBoundingBox&&!e.geographicBoundingBox&&(e.geographicBoundingBox=[...t.geographicBoundingBox]),t?.crs&&!e.crs&&(e.crs=[...t.crs]),t?.boundingBoxes&&!e.boundingBoxes&&(e.boundingBoxes=[...t.boundingBoxes]),t?.dimensions&&!e.dimensions&&(e.dimensions=[...t.dimensions]);for(let r of e.layers||[])BK(r,e)}var cTt="4.2.1",Ly={dataType:null,batchType:null,id:"wms-capabilities",name:"WMS Capabilities",module:"wms",version:cTt,worker:!1,extensions:["xml"],mimeTypes:["application/vnd.ogc.wms_xml","application/xml","text/xml"],testText:lTt,options:{wms:{}},parse:async(e,t)=>aN(new TextDecoder().decode(e),t?.wms),parseTextSync:(e,t)=>aN(e,t?.wms)};function lTt(e){return e.startsWith("<?xml")}function cN(e,t){let n=(Uh.parseTextSync?.(e,t)).FeatureInfoResponse?.FIELDS||[];return{features:(Array.isArray(n)?n:[n]).map(o=>uTt(o))}}function uTt(e){return{attributes:e||{},type:"",bounds:{bottom:0,top:0,left:0,right:0}}}var DK={...Ly,dataType:null,id:"wms-feature-info",name:"WMS FeatureInfo",parse:async(e,t)=>cN(new TextDecoder().decode(e),t),parseTextSync:(e,t)=>cN(e,t)};function lN(e,t){return Uh.parseTextSync?.(e,t)}var NK={...Ly,dataType:null,id:"wms-layer-description",name:"WMS DescribeLayer",parse:async(e,t)=>lN(new TextDecoder().decode(e),t),parseTextSync:(e,t)=>lN(e,t)};function kK(e,t){let{type:r="auto"}=e,n=r==="auto"?fTt(e.url,t):hTt(r,t);if(!n)throw new Error("Not a valid image source type");return n.create(e)}function hTt(e,t){for(let r of t)if(r.type===e)return r;return null}function fTt(e,t){for(let r of t)if(r.testURL&&r.testURL(e))return r;return null}var FK={type:"wms",testURL:e=>e.toLowerCase().includes("wms"),create:e=>new uN(e)},uN=class extends Uu{url;data;substituteCRS84;flipCRS;wmsParameters;vendorParameters;capabilities=null;constructor(t){super(t),this.url=t.url,this.data=t.url,this.substituteCRS84=t.substituteCRS84??!1,this.flipCRS=["EPSG:4326"],this.wmsParameters={layers:void 0,query_layers:void 0,styles:void 0,version:"1.3.0",crs:"EPSG:4326",format:"image/png",info_format:"text/plain",transparent:void 0,time:void 0,elevation:void 0,...t.wmsParameters},this.vendorParameters=t.vendorParameters||{}}async getMetadata(){let t=await this.getCapabilities();return this.normalizeMetadata(t)}async getImage(t){let{boundingBox:r,bbox:n,...i}=t,o={bbox:r?[...r[0],...r[1]]:n,...i};return await this.getMap(o)}normalizeMetadata(t){return t}async getCapabilities(t,r){let n=this.getCapabilitiesURL(t,r),i=await this.fetch(n),o=await i.arrayBuffer();this._checkResponse(i,o);let s=await Ly.parse(o,this.loadOptions);return this.capabilities=s,s}async getMap(t,r){let n=this.getMapURL(t,r),i=await this.fetch(n),o=await i.arrayBuffer();this._checkResponse(i,o);try{return await Uf.parse(o,this.loadOptions)}catch{throw this._parseError(o)}}async getFeatureInfo(t,r){let n=this.getFeatureInfoURL(t,r),i=await this.fetch(n),o=await i.arrayBuffer();return this._checkResponse(i,o),await DK.parse(o,this.loadOptions)}async getFeatureInfoText(t,r){let n=this.getFeatureInfoURL(t,r),i=await this.fetch(n),o=await i.arrayBuffer();return this._checkResponse(i,o),new TextDecoder().decode(o)}async describeLayer(t,r){let n=this.describeLayerURL(t,r),i=await this.fetch(n),o=await i.arrayBuffer();return this._checkResponse(i,o),await NK.parse(o,this.loadOptions)}async getLegendGraphic(t,r){let n=this.getLegendGraphicURL(t,r),i=await this.fetch(n),o=await i.arrayBuffer();this._checkResponse(i,o);try{return await Uf.parse(o,this.loadOptions)}catch{throw this._parseError(o)}}getCapabilitiesURL(t,r){let n={version:this.wmsParameters.version,...t};return this._getWMSUrl("GetCapabilities",n,r)}getMapURL(t,r){t=this._getWMS130Parameters(t);let n={version:this.wmsParameters.version,format:this.wmsParameters.format,transparent:this.wmsParameters.transparent,time:this.wmsParameters.time,elevation:this.wmsParameters.elevation,layers:this.wmsParameters.layers,styles:this.wmsParameters.styles,crs:this.wmsParameters.crs,...t};return this._getWMSUrl("GetMap",n,r)}getFeatureInfoURL(t,r){t=this._getWMS130Parameters(t);let{boundingBox:n,bbox:i}=t;t.bbox=n?[...n[0],...n[1]]:i;let o={version:this.wmsParameters.version,info_format:this.wmsParameters.info_format,layers:this.wmsParameters.layers,query_layers:this.wmsParameters.query_layers,styles:this.wmsParameters.styles,crs:this.wmsParameters.crs,...t};return this._getWMSUrl("GetFeatureInfo",o,r)}describeLayerURL(t,r){let n={version:this.wmsParameters.version,...t};return this._getWMSUrl("DescribeLayer",n,r)}getLegendGraphicURL(t,r){let n={version:this.wmsParameters.version,...t};return this._getWMSUrl("GetLegendGraphic",n,r)}_parseWMSUrl(t){let[r,n]=t.split("?"),i=n.split("&"),o={};for(let s of i){let[c,l]=s.split("=");o[c]=l}return{url:r,parameters:o}}_getWMSUrl(t,r,n){let i=this.url,o=!0,s={service:"WMS",version:r.version,request:t,...r,...this.vendorParameters,...n},c=["transparent","time","elevation"];for(let[l,h]of Object.entries(s))(!c.includes(l)||h)&&(i+=o?"?":"&",o=!1,i+=this._getURLParameter(l,h,r));return encodeURI(i)}_getWMS130Parameters(t){let r={...t};return r.srs&&(r.crs=r.crs||r.srs,delete r.srs),r}_getURLParameter(t,r,n){switch(t){case"crs":n.version!=="1.3.0"?t="srs":this.substituteCRS84&&r==="EPSG:4326"&&(r="CRS:84");break;case"srs":n.version==="1.3.0"&&(t="crs");break;case"bbox":let i=this._flipBoundingBox(r,n);i&&(r=i);break;case"x":n.version==="1.3.0"&&(t="i");break;case"y":n.version==="1.3.0"&&(t="j");break;default:}return t=t.toUpperCase(),Array.isArray(r)?`${t}=${r.join(",")}`:`${t}=${r?String(r):""}`}_flipBoundingBox(t,r){if(!Array.isArray(t)||t.length!==4)return null;let n=r.version==="1.3.0"&&this.flipCRS.includes(r.crs||"")&&!(this.substituteCRS84&&r.crs==="EPSG:4326"),i=t;return n?[i[1],i[0],i[3],i[2]]:i}async _fetchArrayBuffer(t){let r=await this.fetch(t),n=await r.arrayBuffer();return this._checkResponse(r,n),n}_checkResponse(t,r){let n=t.headers["content-type"];if(!t.ok||zb.mimeTypes.includes(n)){let i=av(this.loadOptions,{wms:{throwOnError:!0}}),o=zb.parseSync?.(r,i);throw new Error(o)}}_parseError(t){let r=zb.parseSync?.(t,this.loadOptions);return new Error(r)}};var Oy=class extends Uu{constructor(t){super(t)}async getMetadata(){throw new Error("ImageSource.getMetadata not implemented")}async getImage(t){let r=this.getGranularParameters(t),n=this.getURLFromTemplate(r),o=await(await this.fetch(n)).arrayBuffer();return await Uf.parse(o)}getGranularParameters(t){let[[r,n],[i,o]]=t.boundingBox;return{...t,east:r,north:n,south:o,west:i}}getURLFromTemplate(t){let r=this.props.url;for(let[n,i]of Object.entries(t))r=r.replace(`\${${n}}`,String(i)),r=r.replace(`{${n}}`,String(i));return r}};Vr(Oy,"type","template"),Vr(Oy,"testURL",t=>t.toLowerCase().includes("{"));var hN=class extends Oy{data;constructor(t){super(t),this.data=t.url}async getMetadata(){return await this.metadata()}async getImage(t){throw new Error("not implemented")}async metadata(){throw new Error("not implemented")}exportImage(t){throw new Error("not implemented")}metadataURL(t){return`${this.props.url}?f=pjson`}exportImageURL(t){let r=`bbox=${t.bbox[0]},${t.bbox[1]},${t.bbox[2]},${t.bbox[3]}`,n=`size=${t.width},${t.height}`,i={...t,bbox:r,size:n};return delete i.width,delete i.height,this.getUrl("exportImage",i)}getUrl(t,r,n){let i=`${this.props.url}/${t}`,o=!0;for(let[s,c]of Object.entries(r))i+=o?"?":"&",o=!1,Array.isArray(c)?i+=`${s.toUpperCase()}=${c.join(",")}`:i+=`${s.toUpperCase()}=${c?String(c):""}`;return i}async checkResponse(t){if(!t.ok)throw new Error("error")}},zK={type:"arcgis-image-server",testURL:e=>e.toLowerCase().includes("ImageServer"),create:e=>new hN(e)};var pTt=[FK,zK];function fN(e){return kK(e,pTt)}var UK=6378137*Math.PI;function pN(e){let t=za(e);return t[0]=(t[0]/256-1)*UK,t[1]=(t[1]/256-1)*UK,t}var dTt={id:"imagery-layer",data:"",serviceType:"auto",srs:"auto",layers:{type:"array",compare:!0,value:[]},onMetadataLoad:{type:"function",value:()=>{}},onMetadataLoadError:{type:"function",value:console.error},onImageLoadStart:{type:"function",value:()=>{}},onImageLoad:{type:"function",value:()=>{}},onImageLoadError:{type:"function",compare:!1,value:(e,t)=>console.error(t,e)}},By=class extends vs{get isLoaded(){return this.state?.loadCounter===0&&super.isLoaded}shouldUpdateState(){return!0}initializeState(){this.state._nextRequestId=0,this.state.lastRequestId=-1,this.state.loadCounter=0}updateState({changeFlags:t,props:r,oldProps:n}){let{viewport:i}=this.context;t.dataChanged||r.serviceType!==n.serviceType?(this.state.imageSource=this._createImageSource(r),this._loadMetadata(),this.debounce(()=>this.loadImage(i,"image source changed"),0)):Oi(r.layers,n.layers,1)?t.viewportChanged&&this.debounce(()=>this.loadImage(i,"viewport changed")):this.debounce(()=>this.loadImage(i,"layers changed"),0)}finalizeState(){}renderLayers(){let{bounds:t,image:r,lastRequestParameters:n}=this.state;return r&&new r3({...this.getSubLayerProps({id:"bitmap"}),_imageCoordinateSystem:n.srs==="EPSG:4326"?Yr.LNGLAT:Yr.CARTESIAN,bounds:t,image:r})}async getFeatureInfoText(t,r){let{lastRequestParameters:n}=this.state;return n?await this.state.imageSource.getFeatureInfoText?.({...n,query_layers:n.layers,x:t,y:r,info_format:"application/vnd.ogc.gml"}):""}_createImageSource(t){if(t.data instanceof Uu)return t.data;if(typeof t.data=="string")return fN({url:t.data,loadOptions:t.loadOptions,type:t.serviceType});throw new Error("invalid image source in props.data")}async _loadMetadata(){let{imageSource:t}=this.state;try{this.state.loadCounter++;let r=await t.getMetadata();this.state.imageSource===t&&this.getCurrentLayer()?.props.onMetadataLoad(r)}catch(r){this.getCurrentLayer()?.props.onMetadataLoadError(r)}finally{this.state.loadCounter--}}async loadImage(t,r){let{layers:n,serviceType:i}=this.props;if(i==="wms"&&n.length===0)return;let o=t.getBounds(),{width:s,height:c}=t,l=this.getRequestId(),{srs:h}=this.props;h==="auto"&&(h=t.resolution?"EPSG:4326":"EPSG:3857");let p={width:s,height:c,boundingBox:[[o[0],o[1]],[o[2],o[3]]],layers:n,crs:h};if(h==="EPSG:3857"){let x=pN([o[0],o[1]]),w=pN([o[2],o[3]]);p.boundingBox=[x,w]}try{this.state.loadCounter++,this.props.onImageLoadStart(l);let x=await this.state.imageSource.getImage(p);this.state.lastRequestId<l&&(this.getCurrentLayer()?.props.onImageLoad(l),this.setState({image:x,bounds:o,lastRequestParameters:p,lastRequestId:l}))}catch(x){this.raiseError(x,"Load image"),this.getCurrentLayer()?.props.onImageLoadError(l,x)}finally{this.state.loadCounter--}}getRequestId(){return this.state._nextRequestId++}debounce(t,r=500){clearTimeout(this.state._timeoutId),this.state._timeoutId=setTimeout(()=>t(),r)}};By.layerName="WMSLayer";By.defaultProps=dTt;var mTt={getHeight:{type:"accessor",value:0},greatCircle:!0},jb=class extends e3{};jb.layerName="GreatCircleLayer";jb.defaultProps=mTt;var VK=jb;var ATt={...Mm.defaultProps},Hb=class extends vs{indexToBounds(){return null}renderLayers(){let{elevationScale:t,extruded:r,wireframe:n,filled:i,stroked:o,lineWidthUnits:s,lineWidthScale:c,lineWidthMinPixels:l,lineWidthMaxPixels:h,lineJointRounded:p,lineMiterLimit:x,lineDashJustified:w,getElevation:E,getFillColor:P,getLineColor:B,getLineWidth:D}=this.props,{updateTriggers:W,material:X,transitions:q}=this.props,$=this.getSubLayerClass("cell",Mm),{updateTriggers:et,...F}=this.indexToBounds()||{};return new $({filled:i,wireframe:n,extruded:r,elevationScale:t,stroked:o,lineWidthUnits:s,lineWidthScale:c,lineWidthMinPixels:l,lineWidthMaxPixels:h,lineJointRounded:p,lineMiterLimit:x,lineDashJustified:w,material:X,transitions:q,getElevation:E,getFillColor:P,getLineColor:B,getLineWidth:D},this.getSubLayerProps({id:"cell",updateTriggers:W&&{...et,getElevation:W.getElevation,getFillColor:W.getFillColor,getLineColor:W.getLineColor,getLineWidth:W.getLineWidth}}),F)}};Hb.layerName="GeoCellLayer";Hb.defaultProps=ATt;var Zf=Hb;var q3=tc(dN(),1),gTt=3,_Tt=30,yTt=2*_Tt+1,HK=180/Math.PI;function qK(e,t,r){let n=1<<t;return[(e[0]+r[0])/n,(e[1]+r[1])/n]}function WK(e){return e>=.5?1/3*(4*e*e-1):1/3*(1-4*(1-e)*(1-e))}function GK(e){return[WK(e[0]),WK(e[1])]}function XK(e,[t,r]){switch(e){case 0:return[1,t,r];case 1:return[-t,1,r];case 2:return[-t,-r,1];case 3:return[-1,-r,-t];case 4:return[r,-1,-t];case 5:return[r,t,-1];default:throw new Error("Invalid face")}}function YK([e,t,r]){let n=Math.atan2(r,Math.sqrt(e*e+t*t));return[Math.atan2(t,e)*HK,n*HK]}function KK(e){let t=q3.default.fromString(e,!0,10).toString(2);for(;t.length<gTt+yTt;)t="0"+t;let r=t.lastIndexOf("1"),n=t.substring(0,3),i=t.substring(3,r),o=i.length/2,s=q3.default.fromString(n,!0,2).toString(10),c=q3.default.fromString(i,!0,2).toString(4);for(;c.length<o;)c="0"+c;return`${s}/${c}`}function xTt(e,t,r,n){if(n===0){r===1&&(t[0]=e-1-t[0],t[1]=e-1-t[1]);let i=t[0];t[0]=t[1],t[1]=i}}function ZK(e){let t=e.split("/"),r=parseInt(t[0],10),n=t[1],i=n.length,o=[0,0],s;for(let c=i-1;c>=0;c--){s=i-c;let l=n[c],h=0,p=0;l==="1"?p=1:l==="2"?(h=1,p=1):l==="3"&&(h=1);let x=Math.pow(2,s-1);xTt(x,o,h,p),o[0]+=x*h,o[1]+=x*p}if(r%2===1){let c=o[0];o[0]=o[1],o[1]=c}return{face:r,ij:o,level:s}}var $K=tc(dN(),1);function vTt(e){let t=e.padEnd(16,"0");return $K.default.fromString(t,16)}var bTt=100;function wTt({face:e,ij:t,level:r}){let n=[[0,0],[0,1],[1,1],[1,0],[0,0]],i=Math.max(1,Math.ceil(bTt*Math.pow(2,-r))),o=new Float64Array(4*i*2+2),s=0,c=0;for(let l=0;l<4;l++){let h=n[l].slice(0),p=n[l+1],x=(p[0]-h[0])/i,w=(p[1]-h[1])/i;for(let E=0;E<i;E++){h[0]+=x,h[1]+=w;let P=qK(t,r,h),B=GK(P),D=XK(e,B),W=YK(D);Math.abs(W[1])>89.999&&(W[0]=c);let X=W[0]-c;W[0]+=X>180?-360:X<-180?360:0,o[s++]=W[0],o[s++]=W[1],c=W[0]}}return o[s++]=o[0],o[s++]=o[1],o}function TTt(e){if(typeof e=="string"){if(e.indexOf("/")>0)return e;e=vTt(e)}return KK(e.toString())}function QK(e){let t=TTt(e),r=ZK(t);return wTt(r)}var ETt={getS2Token:{type:"accessor",value:e=>e.token}},qb=class extends Zf{indexToBounds(){let{data:t,getS2Token:r}=this.props;return{data:t,_normalize:!1,positionFormat:"XY",getPolygon:(n,i)=>QK(r(n,i))}}};qb.layerName="S2Layer";qb.defaultProps=ETt;var JK=qb;var mN=512;function MTt(e,t){let r=0,n=0,i=1<<e.length,o=i/mN;for(let s=0;s<e.length;s++){i>>=1;let c=parseInt(e[s]);c%2&&(r|=i),c>1&&(n|=i)}return[[r/o,mN-n/o],[(r+t)/o,mN-(n+t)/o]]}function tZ(e,t=1){let[r,n]=MTt(e,t),[i,o]=Tc(r),[s,c]=Tc(n);return[s,o,s,c,i,c,i,o,s,o]}var STt={getQuadkey:{type:"accessor",value:e=>e.quadkey}},Gb=class extends Zf{indexToBounds(){let{data:t,extruded:r,getQuadkey:n}=this.props,i=r?.99:1;return{data:t,_normalize:!1,positionFormat:"XY",getPolygon:(o,s)=>tZ(n(o,s),i),updateTriggers:{getPolygon:i}}}};Gb.layerName="QuadkeyLayer";Gb.defaultProps=STt;var eZ=Gb;var L0=class{constructor(t){this.index=t,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(t){this._bbox||(this._bbox=t,"west"in t?this.boundingBox=[[t.west,t.south],[t.east,t.north]]:this.boundingBox=[[t.left,t.top],[t.right,t.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return Boolean(this._loader)&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){let t=this.content?this.content.byteLength:0;return Number.isFinite(t)||console.error("byteLength not defined in tile data"),t}async _loadData({getData:t,requestScheduler:r,onLoad:n,onError:i}){let{index:o,id:s,bbox:c,userData:l,zoom:h}=this,p=this._loaderId;this._abortController=new AbortController;let{signal:x}=this._abortController,w=await r.scheduleRequest(this,B=>B.isSelected?1:-1);if(!w){this._isCancelled=!0;return}if(this._isCancelled){w.done();return}let E=null,P;try{E=await t({index:o,id:s,bbox:c,userData:l,zoom:h,signal:x})}catch(B){P=B||!0}finally{w.done()}if(p===this._loaderId){if(this._loader=void 0,this.content=E,this._isCancelled&&!E){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,P?i(P,this):n(this)}}loadData(t){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(t),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){this.isLoaded||(this._isCancelled=!0,this._abortController?.abort())}};var oa={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};var rZ=new ur,CTt=new ur,Im=class{constructor(t=[0,0,0],r=[0,0,0],n){n=n||rZ.copy(t).add(r).scale(.5),this.center=new ur(n),this.halfDiagonal=new ur(r).subtract(this.center),this.minimum=new ur(t),this.maximum=new ur(r)}clone(){return new Im(this.minimum,this.maximum,this.center)}equals(t){return this===t||Boolean(t)&&this.minimum.equals(t.minimum)&&this.maximum.equals(t.maximum)}transform(t){return this.center.transformAsPoint(t),this.halfDiagonal.transform(t),this.minimum.transform(t),this.maximum.transform(t),this}intersectPlane(t){let{halfDiagonal:r}=this,n=CTt.from(t.normal),i=r.x*Math.abs(n.x)+r.y*Math.abs(n.y)+r.z*Math.abs(n.z),o=this.center.dot(n)+t.distance;return o-i>0?oa.INSIDE:o+i<0?oa.OUTSIDE:oa.INTERSECTING}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){let r=rZ.from(t).subtract(this.center),{halfDiagonal:n}=this,i=0,o;return o=Math.abs(r.x)-n.x,o>0&&(i+=o*o),o=Math.abs(r.y)-n.y,o>0&&(i+=o*o),o=Math.abs(r.z)-n.z,o>0&&(i+=o*o),i}};var Xb=new ur,nZ=new ur,Rm=class{constructor(t=[0,0,0],r=0){this.radius=-0,this.center=new ur,this.fromCenterRadius(t,r)}fromCenterRadius(t,r){return this.center.from(t),this.radius=r,this}fromCornerPoints(t,r){return r=Xb.from(r),this.center=new ur().from(t).add(r).scale(.5),this.radius=this.center.distance(r),this}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.radius===t.radius}clone(){return new Rm(this.center,this.radius)}union(t){let r=this.center,n=this.radius,i=t.center,o=t.radius,s=Xb.copy(i).subtract(r),c=s.magnitude();if(n>=c+o)return this.clone();if(o>=c+n)return t.clone();let l=(n+c+o)*.5;return nZ.copy(s).scale((-n+l)/c).add(r),this.center.copy(nZ),this.radius=l,this}expand(t){let n=Xb.from(t).subtract(this.center).magnitude();return n>this.radius&&(this.radius=n),this}transform(t){this.center.transform(t);let r=Gs.getScaling(Xb,t);return this.radius=Math.max(r[0],Math.max(r[1],r[2]))*this.radius,this}distanceSquaredTo(t){let r=this.distanceTo(t);return r*r}distanceTo(t){let n=Xb.from(t).subtract(this.center);return Math.max(0,n.len()-this.radius)}intersectPlane(t){let r=this.center,n=this.radius,o=t.normal.dot(r)+t.distance;return o<-n?oa.OUTSIDE:o<n?oa.INTERSECTING:oa.INSIDE}};var PTt=new ur,ITt=new ur,G3=new ur,X3=new ur,Y3=new ur,RTt=new ur,LTt=new ur,id={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8},O0=class{constructor(t=[0,0,0],r=[0,0,0,0,0,0,0,0,0]){this.center=new ur().from(t),this.halfAxes=new Is(r)}get halfSize(){let t=this.halfAxes.getColumn(0),r=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new ur(t).len(),new ur(r).len(),new ur(n).len()]}get quaternion(){let t=this.halfAxes.getColumn(0),r=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),i=new ur(t).normalize(),o=new ur(r).normalize(),s=new ur(n).normalize();return new hm().fromMatrix3(new Is([...i,...o,...s]))}fromCenterHalfSizeQuaternion(t,r,n){let i=new hm(n),o=new Is().fromQuaternion(i);return o[0]=o[0]*r[0],o[1]=o[1]*r[0],o[2]=o[2]*r[0],o[3]=o[3]*r[1],o[4]=o[4]*r[1],o[5]=o[5]*r[1],o[6]=o[6]*r[2],o[7]=o[7]*r[2],o[8]=o[8]*r[2],this.center=new ur().from(t),this.halfAxes=o,this}clone(){return new O0(this.center,this.halfAxes)}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}getBoundingSphere(t=new Rm){let r=this.halfAxes,n=r.getColumn(0,G3),i=r.getColumn(1,X3),o=r.getColumn(2,Y3),s=PTt.copy(n).add(i).add(o);return t.center.copy(this.center),t.radius=s.magnitude(),t}intersectPlane(t){let r=this.center,n=t.normal,i=this.halfAxes,o=n.x,s=n.y,c=n.z,l=Math.abs(o*i[id.COLUMN0ROW0]+s*i[id.COLUMN0ROW1]+c*i[id.COLUMN0ROW2])+Math.abs(o*i[id.COLUMN1ROW0]+s*i[id.COLUMN1ROW1]+c*i[id.COLUMN1ROW2])+Math.abs(o*i[id.COLUMN2ROW0]+s*i[id.COLUMN2ROW1]+c*i[id.COLUMN2ROW2]),h=n.dot(r)+t.distance;return h<=-l?oa.OUTSIDE:h>=l?oa.INSIDE:oa.INTERSECTING}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){let r=ITt.from(t).subtract(this.center),n=this.halfAxes,i=n.getColumn(0,G3),o=n.getColumn(1,X3),s=n.getColumn(2,Y3),c=i.magnitude(),l=o.magnitude(),h=s.magnitude();i.normalize(),o.normalize(),s.normalize();let p=0,x;return x=Math.abs(r.dot(i))-c,x>0&&(p+=x*x),x=Math.abs(r.dot(o))-l,x>0&&(p+=x*x),x=Math.abs(r.dot(s))-h,x>0&&(p+=x*x),p}computePlaneDistances(t,r,n=[-0,-0]){let i=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,s=this.center,c=this.halfAxes,l=c.getColumn(0,G3),h=c.getColumn(1,X3),p=c.getColumn(2,Y3),x=RTt.copy(l).add(h).add(p).add(s),w=LTt.copy(x).subtract(t),E=r.dot(w);return i=Math.min(E,i),o=Math.max(E,o),x.copy(s).add(l).add(h).subtract(p),w.copy(x).subtract(t),E=r.dot(w),i=Math.min(E,i),o=Math.max(E,o),x.copy(s).add(l).subtract(h).add(p),w.copy(x).subtract(t),E=r.dot(w),i=Math.min(E,i),o=Math.max(E,o),x.copy(s).add(l).subtract(h).subtract(p),w.copy(x).subtract(t),E=r.dot(w),i=Math.min(E,i),o=Math.max(E,o),s.copy(x).subtract(l).add(h).add(p),w.copy(x).subtract(t),E=r.dot(w),i=Math.min(E,i),o=Math.max(E,o),s.copy(x).subtract(l).add(h).subtract(p),w.copy(x).subtract(t),E=r.dot(w),i=Math.min(E,i),o=Math.max(E,o),s.copy(x).subtract(l).subtract(h).add(p),w.copy(x).subtract(t),E=r.dot(w),i=Math.min(E,i),o=Math.max(E,o),s.copy(x).subtract(l).subtract(h).subtract(p),w.copy(x).subtract(t),E=r.dot(w),i=Math.min(E,i),o=Math.max(E,o),n[0]=i,n[1]=o,n}transform(t){this.center.transformAsPoint(t);let r=this.halfAxes.getColumn(0,G3);r.transformAsPoint(t);let n=this.halfAxes.getColumn(1,X3);n.transformAsPoint(t);let i=this.halfAxes.getColumn(2,Y3);return i.transformAsPoint(t),this.halfAxes=new Is([...r,...n,...i]),this}getTransform(){throw new Error("not implemented")}};var iZ=new ur,oZ=new ur,Vh=class{constructor(t=[0,0,1],r=0){this.normal=new ur,this.distance=-0,this.fromNormalDistance(t,r)}fromNormalDistance(t,r){return Vf(Number.isFinite(r)),this.normal.from(t).normalize(),this.distance=r,this}fromPointNormal(t,r){t=iZ.from(t),this.normal.from(r).normalize();let n=-this.normal.dot(t);return this.distance=n,this}fromCoefficients(t,r,n,i){return this.normal.set(t,r,n),Vf(Fa(this.normal.len(),1)),this.distance=i,this}clone(){return new Vh(this.normal,this.distance)}equals(t){return Fa(this.distance,t.distance)&&Fa(this.normal,t.normal)}getPointDistance(t){return this.normal.dot(t)+this.distance}transform(t){let r=oZ.copy(this.normal).transformAsVector(t).normalize(),n=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(n,r)}projectPointOntoPlane(t,r=[0,0,0]){let n=iZ.from(t),i=this.getPointDistance(n),o=oZ.copy(this.normal).scale(i);return n.subtract(o).to(r)}};var sZ=[new ur([1,0,0]),new ur([0,1,0]),new ur([0,0,1])],aZ=new ur,OTt=new ur,kl=class{constructor(t=[]){this.planes=t}fromBoundingSphere(t){this.planes.length=2*sZ.length;let r=t.center,n=t.radius,i=0;for(let o of sZ){let s=this.planes[i],c=this.planes[i+1];s||(s=this.planes[i]=new Vh),c||(c=this.planes[i+1]=new Vh);let l=aZ.copy(o).scale(-n).add(r);s.fromPointNormal(l,o);let h=aZ.copy(o).scale(n).add(r),p=OTt.copy(o).negate();c.fromPointNormal(h,p),i+=2}return this}computeVisibility(t){let r=oa.INSIDE;for(let n of this.planes)switch(t.intersectPlane(n)){case oa.OUTSIDE:return oa.OUTSIDE;case oa.INTERSECTING:r=oa.INTERSECTING;break;default:}return r}computeVisibilityWithPlaneMask(t,r){if(Vf(Number.isFinite(r),"parentPlaneMask is required."),r===kl.MASK_OUTSIDE||r===kl.MASK_INSIDE)return r;let n=kl.MASK_INSIDE,i=this.planes;for(let o=0;o<this.planes.length;++o){let s=o<31?1<<o:0;if(o<31&&!(r&s))continue;let c=i[o],l=t.intersectPlane(c);if(l===oa.OUTSIDE)return kl.MASK_OUTSIDE;l===oa.INTERSECTING&&(n|=s)}return n}};kl.MASK_OUTSIDE=4294967295;kl.MASK_INSIDE=0;kl.MASK_INDETERMINATE=2147483647;var e_e=new ur,r_e=new ur,n_e=new ur,i_e=new ur,o_e=new ur;var h_e=new ur,f_e=new ur,p_e=new ur,d_e=new ur,m_e=new ur,A_e=new ur,g_e=new ur,__e=new ur,y_e=new ur,x_e=new ur,v_e=new ur,b_e=new ur;var $f=new Is,DTt=new Is,NTt=new Is,K3=new Is,cZ=new Is;function _N(e,t={}){let r=W_.EPSILON20,n=10,i=0,o=0,s=DTt,c=NTt;s.identity(),c.copy(e);let l=r*kTt(c);for(;o<n&&FTt(c)>l;)zTt(c,K3),cZ.copy(K3).transpose(),c.multiplyRight(K3),c.multiplyLeft(cZ),s.multiplyRight(K3),++i>2&&(++o,i=0);return t.unitary=s.toTarget(t.unitary),t.diagonal=c.toTarget(t.diagonal),t}function kTt(e){let t=0;for(let r=0;r<9;++r){let n=e[r];t+=n*n}return Math.sqrt(t)}var AN=[1,0,0],gN=[2,2,1];function FTt(e){let t=0;for(let r=0;r<3;++r){let n=e[$f.getElementIndex(gN[r],AN[r])];t+=2*n*n}return Math.sqrt(t)}function zTt(e,t){let r=W_.EPSILON15,n=0,i=1;for(let h=0;h<3;++h){let p=Math.abs(e[$f.getElementIndex(gN[h],AN[h])]);p>n&&(i=h,n=p)}let o=AN[i],s=gN[i],c=1,l=0;if(Math.abs(e[$f.getElementIndex(s,o)])>r){let h=e[$f.getElementIndex(s,s)],p=e[$f.getElementIndex(o,o)],x=e[$f.getElementIndex(s,o)],w=(h-p)/2/x,E;w<0?E=-1/(-w+Math.sqrt(1+w*w)):E=1/(w+Math.sqrt(1+w*w)),c=1/Math.sqrt(1+E*E),l=E*c}return Is.IDENTITY.to(t),t[$f.getElementIndex(o,o)]=t[$f.getElementIndex(s,s)]=c,t[$f.getElementIndex(s,o)]=l,t[$f.getElementIndex(o,s)]=-l,t}var Lm=new ur,UTt=new ur,VTt=new ur,jTt=new ur,HTt=new ur,WTt=new Is,qTt={diagonal:new Is,unitary:new Is};function yN(e,t=new O0){if(!e||e.length===0)return t.halfAxes=new Is([0,0,0,0,0,0,0,0,0]),t.center=new ur,t;let r=e.length,n=new ur(0,0,0);for(let J of e)n.add(J);let i=1/r;n.multiplyByScalar(i);let o=0,s=0,c=0,l=0,h=0,p=0;for(let J of e){let G=Lm.copy(J).subtract(n);o+=G.x*G.x,s+=G.x*G.y,c+=G.x*G.z,l+=G.y*G.y,h+=G.y*G.z,p+=G.z*G.z}o*=i,s*=i,c*=i,l*=i,h*=i,p*=i;let x=WTt;x[0]=o,x[1]=s,x[2]=c,x[3]=s,x[4]=l,x[5]=h,x[6]=c,x[7]=h,x[8]=p;let{unitary:w}=_N(x,qTt),E=t.halfAxes.copy(w),P=E.getColumn(0,VTt),B=E.getColumn(1,jTt),D=E.getColumn(2,HTt),W=-Number.MAX_VALUE,X=-Number.MAX_VALUE,q=-Number.MAX_VALUE,$=Number.MAX_VALUE,et=Number.MAX_VALUE,F=Number.MAX_VALUE;for(let J of e)Lm.copy(J),W=Math.max(Lm.dot(P),W),X=Math.max(Lm.dot(B),X),q=Math.max(Lm.dot(D),q),$=Math.min(Lm.dot(P),$),et=Math.min(Lm.dot(B),et),F=Math.min(Lm.dot(D),F);P=P.multiplyByScalar(.5*($+W)),B=B.multiplyByScalar(.5*(et+X)),D=D.multiplyByScalar(.5*(F+q)),t.center.copy(P).add(B).add(D);let ut=UTt.set(W-$,X-et,q-F).multiplyByScalar(.5),ot=new Is([ut[0],0,0,0,ut[1],0,0,0,ut[2]]);return t.halfAxes.multiplyRight(ot),t}var Dy=512,lZ=3,uZ=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],hZ=uZ.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),GTt=hZ.concat([[.25,.5],[.75,.5]]),Om=class{constructor(t,r,n){this.x=t,this.y=r,this.z=n}get children(){if(!this._children){let t=this.x*2,r=this.y*2,n=this.z+1;this._children=[new Om(t,r,n),new Om(t,r+1,n),new Om(t+1,r,n),new Om(t+1,r+1,n)]}return this._children}update(t){let{viewport:r,cullingVolume:n,elevationBounds:i,minZ:o,maxZ:s,bounds:c,offset:l,project:h}=t,p=this.getBoundingVolume(i,l,h);if(c&&!this.insideBounds(c)||n.computeVisibility(p)<0)return!1;if(!this.childVisible){let{z:w}=this;if(w<s&&w>=o){let E=p.distanceTo(r.cameraPosition)*r.scale/r.height;w+=Math.floor(Math.log2(E))}if(w>=s)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(let w of this.children)w.update(t);return!0}getSelected(t=[]){if(this.selected&&t.push(this),this._children)for(let r of this._children)r.getSelected(t);return t}insideBounds([t,r,n,i]){let o=Math.pow(2,this.z),s=Dy/o;return this.x*s<n&&this.y*s<i&&(this.x+1)*s>t&&(this.y+1)*s>r}getBoundingVolume(t,r,n){if(n){let l=this.z<1?GTt:this.z<2?hZ:uZ,h=[];for(let p of l){let x=Z3(this.x+p[0],this.y+p[1],this.z);x[2]=t[0],h.push(n(x)),t[0]!==t[1]&&(x[2]=t[1],h.push(n(x)))}return yN(h)}let i=Math.pow(2,this.z),o=Dy/i,s=this.x*o+r*Dy,c=Dy-(this.y+1)*o;return new Im([s,c,t[0]],[s+o,c+o,t[1]])}};function fZ(e,t,r,n){let i=e instanceof Fh&&e.resolution?e.projectPosition:null,o=Object.values(e.getFrustumPlanes()).map(({normal:E,distance:P})=>new Vh(E.clone().negate(),P)),s=new kl(o),c=e.distanceScales.unitsPerMeter[2],l=r&&r[0]*c||0,h=r&&r[1]*c||0,p=e instanceof Uc&&e.pitch<=60?t:0;if(n){let[E,P,B,D]=n,W=za([E,D]),X=za([B,P]);n=[W[0],Dy-W[1],X[0],Dy-X[1]]}let x=new Om(0,0,0),w={viewport:e,project:i,cullingVolume:s,elevationBounds:[l,h],minZ:p,maxZ:t,bounds:n,offset:0};if(x.update(w),e instanceof Uc&&e.subViewports&&e.subViewports.length>1){for(w.offset=-1;x.update(w)&&!(--w.offset<-lZ););for(w.offset=1;x.update(w)&&!(++w.offset>lZ););}return x.getSelected()}var od=512,XTt=[-1/0,-1/0,1/0,1/0],Bm={type:"object",value:null,validate:(e,t)=>t.optional&&e===null||typeof e=="string"||Array.isArray(e)&&e.every(r=>typeof r=="string"),equal:(e,t)=>{if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t))return!1;let r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}};function dZ(e,t){let r=[t.transformAsPoint([e[0],e[1]]),t.transformAsPoint([e[2],e[1]]),t.transformAsPoint([e[0],e[3]]),t.transformAsPoint([e[2],e[3]])];return[Math.min(...r.map(i=>i[0])),Math.min(...r.map(i=>i[1])),Math.max(...r.map(i=>i[0])),Math.max(...r.map(i=>i[1]))]}function YTt(e){return Math.abs(e.split("").reduce((t,r)=>(t<<5)-t+r.charCodeAt(0)|0,0))}function Qf(e,t){if(!e||!e.length)return null;let{index:r,id:n}=t;if(Array.isArray(e)){let o=YTt(n)%e.length;e=e[o]}let i=e;for(let o of Object.keys(r)){let s=new RegExp(`{${o}}`,"g");i=i.replace(s,String(r[o]))}return Number.isInteger(r.y)&&Number.isInteger(r.z)&&(i=i.replace(/\{-y\}/g,String(Math.pow(2,r.z)-r.y-1))),i}function KTt(e,t,r){let n;if(t&&t.length===2){let[i,o]=t,s=e.getBounds({z:i}),c=e.getBounds({z:o});n=[Math.min(s[0],c[0]),Math.min(s[1],c[1]),Math.max(s[2],c[2]),Math.max(s[3],c[3])]}else n=e.getBounds();return e.isGeospatial?[Math.max(n[0],r[0]),Math.max(n[1],r[1]),Math.min(n[2],r[2]),Math.min(n[3],r[3])]:[Math.max(Math.min(n[0],r[2]),r[0]),Math.max(Math.min(n[1],r[3]),r[1]),Math.min(Math.max(n[2],r[0]),r[2]),Math.min(Math.max(n[3],r[1]),r[3])]}function mZ({viewport:e,z:t,cullRect:r}){return(e.subViewports||[e]).map(i=>xN(i,t||0,r))}function xN(e,t,r){if(!Array.isArray(t)){let o=r.x-e.x,s=r.y-e.y,{width:c,height:l}=r,h={targetZ:t},p=e.unproject([o,s],h),x=e.unproject([o+c,s],h),w=e.unproject([o,s+l],h),E=e.unproject([o+c,s+l],h);return[Math.min(p[0],x[0],w[0],E[0]),Math.min(p[1],x[1],w[1],E[1]),Math.max(p[0],x[0],w[0],E[0]),Math.max(p[1],x[1],w[1],E[1])]}let n=xN(e,t[0],r),i=xN(e,t[1],r);return[Math.min(n[0],i[0]),Math.min(n[1],i[1]),Math.max(n[2],i[2]),Math.max(n[3],i[3])]}function ZTt(e,t,r){return r?dZ(e,r).map(i=>i*t/od):e.map(n=>n*t/od)}function vN(e,t){return Math.pow(2,e)*od/t}function Z3(e,t,r){let n=vN(r,od),i=e/n*360-180,o=Math.PI-2*Math.PI*t/n,s=180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)));return[i,s]}function pZ(e,t,r,n){let i=vN(r,n);return[e/i*od,t/i*od]}function bN(e,t,r,n,i=od){if(e.isGeospatial){let[h,p]=Z3(t,r,n),[x,w]=Z3(t+1,r+1,n);return{west:h,north:p,east:x,south:w}}let[o,s]=pZ(t,r,n,i),[c,l]=pZ(t+1,r+1,n,i);return{left:o,top:s,right:c,bottom:l}}function $Tt(e,t,r,n,i){let o=KTt(e,null,n),s=vN(t,r),[c,l,h,p]=ZTt(o,s,i),x=[];for(let w=Math.floor(c);w<h;w++)for(let E=Math.floor(l);E<p;E++)x.push({x:w,y:E,z:t});return x}function wN({viewport:e,maxZoom:t,minZoom:r,zRange:n,extent:i,tileSize:o=od,modelMatrix:s,modelMatrixInverse:c,zoomOffset:l=0}){let h=e.isGeospatial?Math.round(e.zoom+Math.log2(od/o))+l:Math.ceil(e.zoom)+l;if(typeof r=="number"&&Number.isFinite(r)&&h<r){if(!i)return[];h=r}typeof t=="number"&&Number.isFinite(t)&&h>t&&(h=t);let p=i;return s&&c&&i&&!e.isGeospatial&&(p=dZ(i,s)),e.isGeospatial?fZ(e,h,n,i):$Tt(e,h,o,p||XTt,c)}function TN(e){return/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(e)}function EN(e){return Number.isFinite(e.west)&&Number.isFinite(e.north)&&Number.isFinite(e.east)&&Number.isFinite(e.south)}function AZ(e){let t={},r;return n=>{for(let i in n)if(!QTt(n[i],t[i])){r=e(n),t=n;break}return r}}function QTt(e,t){if(e===t)return!0;if(Array.isArray(e)){let r=e.length;if(!t||t.length!==r)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}return!1}var gZ=1,$3=2,JTt="never",tEt="no-overlap",Yb="best-available",eEt=5,rEt={[Yb]:iEt,[tEt]:oEt,[JTt]:()=>{}},nEt={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}},B0=class{constructor(t){this._getCullBounds=AZ(mZ),this.opts={...nEt,...t},this.setOptions(this.opts),this.onTileLoad=r=>{this.opts.onTileLoad?.(r),this.opts.maxCacheByteSize!==null&&(this._cacheByteSize+=r.byteLength,this._resizeCache())},this._requestScheduler=new $d({throttleRequests:this.opts.maxRequests>0||this.opts.debounceTime>0,maxRequests:this.opts.maxRequests,debounceTime:this.opts.debounceTime}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._zRange=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new Fn,this._modelMatrixInverse=new Fn}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(t=>t.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(t=>t.needsReload)}setOptions(t){Object.assign(this.opts,t),Number.isFinite(t.maxZoom)&&(this._maxZoom=Math.floor(t.maxZoom)),Number.isFinite(t.minZoom)&&(this._minZoom=Math.ceil(t.minZoom))}finalize(){for(let t of this._cache.values())t.isLoading&&t.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(let t of this._cache.keys()){let r=this._cache.get(t);!this._selectedTiles||!this._selectedTiles.includes(r)?this._cache.delete(t):r.setNeedsReload()}}update(t,{zRange:r,modelMatrix:n}={zRange:null,modelMatrix:null}){let i=n?new Fn(n):new Fn,o=!i.equals(this._modelMatrix);if(!this._viewport||!t.equals(this._viewport)||!Fa(this._zRange,r)||o){o&&(this._modelMatrixInverse=i.clone().invert(),this._modelMatrix=i),this._viewport=t,this._zRange=r;let c=this.getTileIndices({viewport:t,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:r,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=c.map(l=>this._getTile(l,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(c=>this._getTile(c.index,!0)));let s=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),s&&this._frameNumber++,this._frameNumber}isTileVisible(t,r){if(!t.isVisible)return!1;if(r&&this._viewport){let n=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:r}),{bbox:i}=t;for(let[o,s,c,l]of n){let h;if("west"in i)h=i.west<c&&i.east>o&&i.south<l&&i.north>s;else{let p=Math.min(i.top,i.bottom),x=Math.max(i.top,i.bottom);h=i.left<c&&i.right>o&&p<l&&x>s}if(h)return!0}return!1}return!0}getTileIndices({viewport:t,maxZoom:r,minZoom:n,zRange:i,modelMatrix:o,modelMatrixInverse:s}){let{tileSize:c,extent:l,zoomOffset:h}=this.opts;return wN({viewport:t,maxZoom:r,minZoom:n,zRange:i,tileSize:c,extent:l,modelMatrix:o,modelMatrixInverse:s,zoomOffset:h})}getTileId(t){return`${t.x}-${t.y}-${t.z}`}getTileZoom(t){return t.z}getTileMetadata(t){let{tileSize:r}=this.opts;return{bbox:bN(this._viewport,t.x,t.y,t.z,r)}}getParentIndex(t){let r=Math.floor(t.x/2),n=Math.floor(t.y/2),i=t.z-1;return{x:r,y:n,z:i}}updateTileStates(){let t=this.opts.refinementStrategy||Yb,r=new Array(this._cache.size),n=0;for(let i of this._cache.values())r[n++]=i.isVisible,i.isSelected=!1,i.isVisible=!1;for(let i of this._selectedTiles)i.isSelected=!0,i.isVisible=!0;(typeof t=="function"?t:rEt[t])(Array.from(this._cache.values())),n=0;for(let i of this._cache.values())if(r[n++]!==i.isVisible)return!0;return!1}_pruneRequests(){let{maxRequests:t=0}=this.opts,r=[],n=0;for(let i of this._cache.values())i.isLoading&&(n++,!i.isSelected&&!i.isVisible&&r.push(i));for(;t>0&&n>t&&r.length>0;)r.shift().abort(),n--}_rebuildTree(){let{_cache:t}=this;for(let r of t.values())r.parent=null,r.children&&(r.children.length=0);for(let r of t.values()){let n=this._getNearestAncestor(r);r.parent=n,n?.children&&n.children.push(r)}}_resizeCache(){let{_cache:t,opts:r}=this,n=r.maxCacheSize??(r.maxCacheByteSize!==null?1/0:eEt*this.selectedTiles.length),i=r.maxCacheByteSize??1/0;if(t.size>n||this._cacheByteSize>i){for(let[s,c]of t)if(!c.isVisible&&!c.isSelected&&(this._cacheByteSize-=r.maxCacheByteSize!==null?c.byteLength:0,t.delete(s),this.opts.onTileUnload?.(c)),t.size<=n&&this._cacheByteSize<=i)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((s,c)=>s.zoom-c.zoom),this._dirty=!1)}_getTile(t,r){let n=this.getTileId(t),i=this._cache.get(n),o=!1;return!i&&r?(i=new L0(t),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:n,zoom:this.getTileZoom(i.index)}),o=!0,this._cache.set(n,i),this._dirty=!0):i&&i.needsReload&&(o=!0),i&&o&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}_getNearestAncestor(t){let{_minZoom:r=0}=this,n=t.index;for(;this.getTileZoom(n)>r;){n=this.getParentIndex(n);let i=this._getTile(n);if(i)return i}return null}};function iEt(e){for(let t of e)t.state=0;for(let t of e)t.isSelected&&!_Z(t)&&MN(t);for(let t of e)t.isVisible=Boolean(t.state&$3)}function oEt(e){for(let r of e)r.state=0;for(let r of e)r.isSelected&&_Z(r);let t=Array.from(e).sort((r,n)=>r.zoom-n.zoom);for(let r of t)if(r.isVisible=Boolean(r.state&$3),r.children&&(r.isVisible||r.state&gZ))for(let n of r.children)n.state=gZ;else r.isSelected&&MN(r)}function _Z(e){let t=e;for(;t;){if(t.isLoaded||t.content)return t.state|=$3,!0;t=t.parent}return!1}function MN(e){for(let t of e.children)t.isLoaded||t.content?t.state|=$3:MN(t)}var sEt={TilesetClass:B0,data:{type:"data",value:[]},dataComparator:Bm.equal,renderSubLayers:{type:"function",value:e=>new C0(e)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:e=>{}},onTileUnload:{type:"function",value:e=>{}},onTileError:{type:"function",value:e=>console.error(e)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:Yb,zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0},Kb=class extends vs{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){this.state?.tileset?.finalize()}get isLoaded(){return Boolean(this.state?.tileset?.selectedTiles?.every(t=>t.isLoaded&&t.layers&&t.layers.every(r=>r.isLoaded)))}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState({changeFlags:t}){let{tileset:r}=this.state,n=t.propsOrDataChanged||t.updateTriggersChanged,i=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getTileData);r?n&&(r.setOptions(this._getTilesetOptions()),i?r.reloadAll():r.tiles.forEach(o=>{o.layers=null})):(r=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:r})),this._updateTileset()}_getTilesetOptions(){let{tileSize:t,maxCacheSize:r,maxCacheByteSize:n,refinementStrategy:i,extent:o,maxZoom:s,minZoom:c,maxRequests:l,debounceTime:h,zoomOffset:p}=this.props;return{maxCacheSize:r,maxCacheByteSize:n,maxZoom:s,minZoom:c,tileSize:t,refinementStrategy:i,extent:o,maxRequests:l,debounceTime:h,zoomOffset:p,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){let t=this.state.tileset,{zRange:r,modelMatrix:n}=this.props,i=t.update(this.context.viewport,{zRange:r,modelMatrix:n}),{isLoaded:o}=t,s=this.state.isLoaded!==o,c=this.state.frameNumber!==i;o&&(s||c)&&this._onViewportLoad(),c&&this.setState({frameNumber:i}),this.state.isLoaded=o}_onViewportLoad(){let{tileset:t}=this.state,{onViewportLoad:r}=this.props;r&&r(t.selectedTiles)}_onTileLoad(t){this.props.onTileLoad(t),t.layers=null,this.setNeedsUpdate()}_onTileError(t,r){this.props.onTileError(t),r.layers=null,this.setNeedsUpdate()}_onTileUnload(t){this.props.onTileUnload(t)}getTileData(t){let{data:r,getTileData:n,fetch:i}=this.props,{signal:o}=t;return t.url=typeof r=="string"||Array.isArray(r)?Qf(r,t):null,n?n(t):i&&t.url?i(t.url,{propName:"data",layer:this,signal:o}):null}renderSubLayers(t){return this.props.renderSubLayers(t)}getSubLayerPropsByTile(t){return null}getPickingInfo(t){let r=t.sourceLayer,n=r.props.tile,i=t.info;return i.picked&&(i.tile=n),i.sourceTile=n,i.sourceTileSubLayer=r,i}_updateAutoHighlight(t){t.sourceTileSubLayer.updateAutoHighlight(t)}renderLayers(){return this.state.tileset.tiles.map(t=>{let r=this.getSubLayerPropsByTile(t);if(!(!t.isLoaded&&!t.content))if(t.layers)r&&t.layers[0]&&Object.keys(r).some(n=>t.layers[0].props[n]!==r[n])&&(t.layers=t.layers.map(n=>n.clone(r)));else{let n=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:t.id,updateTriggers:this.props.updateTriggers}),data:t.content,_offset:0,tile:t});t.layers=Gf(n,Boolean).map(i=>i.clone({tile:t,...r}))}return t.layers})}filterSubLayer({layer:t,cullRect:r}){let{tile:n}=t.props;return this.state.tileset.isTileVisible(n,r)}};Kb.defaultProps=sEt;Kb.layerName="TileLayer";var D0=Kb;var yZ=`uniform tripsUniforms {
  bool fadeTrail;
  float trailLength;
  float currentTime;
} trips;
`,xZ={name:"trips",vs:yZ,fs:yZ,uniformTypes:{fadeTrail:"f32",trailLength:"f32",currentTime:"f32"}};var aEt={fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:e=>e.timestamps}},Zb=class extends Yf{getShaders(){let t=super.getShaders();return t.inject={"vs:#decl":`in float instanceTimestamps;
in float instanceNextTimestamps;
out float vTime;
`,"vs:#main-end":`vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;
`,"fs:#decl":`in float vTime;
`,"fs:#main-start":`if(vTime > trips.currentTime || (trips.fadeTrail && (vTime < trips.currentTime - trips.trailLength))) {
  discard;
}
`,"fs:DECKGL_FILTER_COLOR":`if(trips.fadeTrail) {
  color.a *= 1.0 - (trips.currentTime - vTime) / trips.trailLength;
}
`},t.modules=[...t.modules,xZ],t}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(t){let{fadeTrail:r,trailLength:n,currentTime:i}=this.props,o={fadeTrail:r,trailLength:n,currentTime:i};this.state.model.shaderInputs.setProps({trips:o}),super.draw(t)}};Zb.layerName="TripsLayer";Zb.defaultProps=aEt;var vZ=Zb;var no=function(e){e=e||{};var t=typeof e<"u"?e:{},r={},n;for(n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);var i=[],o="";function s(se){return t.locateFile?t.locateFile(se,o):o+se}var c;typeof document<"u"&&document.currentScript&&(o=document.currentScript.src),o.indexOf("blob:")!==0?o=o.substr(0,o.lastIndexOf("/")+1):o="",c=function(ve,er,jr){var _=new XMLHttpRequest;_.open("GET",ve,!0),_.responseType="arraybuffer",_.onload=function(){if(_.status==200||_.status==0&&_.response){er(_.response);return}var Ur=At(ve);if(Ur){er(Ur.buffer);return}jr()},_.onerror=jr,_.send(null)};var l=t.print||console.log.bind(console),h=t.printErr||console.warn.bind(console);for(n in r)r.hasOwnProperty(n)&&(t[n]=r[n]);r=null,t.arguments&&(i=t.arguments);var p=0,x=function(se){p=se},w=function(){return p},E=8;function P(se,ve,er,jr){switch(er=er||"i8",er.charAt(er.length-1)==="*"&&(er="i32"),er){case"i1":gt[se>>0]=ve;break;case"i8":gt[se>>0]=ve;break;case"i16":Ne[se>>1]=ve;break;case"i32":sr[se>>2]=ve;break;case"i64":ds=[ve>>>0,(ki=ve,+Xn(ki)>=1?ki>0?(Vi(+bs(ki/4294967296),4294967295)|0)>>>0:~~+Ui((ki-+(~~ki>>>0))/4294967296)>>>0:0)],sr[se>>2]=ds[0],sr[se+4>>2]=ds[1];break;case"float":Xr[se>>2]=ve;break;case"double":ir[se>>3]=ve;break;default:fn("invalid type for setValue: "+er)}}function B(se,ve,er){switch(ve=ve||"i8",ve.charAt(ve.length-1)==="*"&&(ve="i32"),ve){case"i1":return gt[se>>0];case"i8":return gt[se>>0];case"i16":return Ne[se>>1];case"i32":return sr[se>>2];case"i64":return sr[se>>2];case"float":return Xr[se>>2];case"double":return ir[se>>3];default:fn("invalid type for getValue: "+ve)}return null}var D=!1;function W(se,ve){se||fn("Assertion failed: "+ve)}function X(se){var ve=t["_"+se];return W(ve,"Cannot call unknown function "+se+", make sure it is exported"),ve}function q(se,ve,er,jr,_){var Pn={string:function(Hi){var Nn=0;if(Hi!=null&&Hi!==0){var kn=(Hi.length<<2)+1;Nn=ft(kn),J(Hi,Nn,kn)}return Nn},array:function(Hi){var Nn=ft(Hi.length);return mt(Hi,Nn),Nn}};function Ur(Hi){return ve==="string"?ut(Hi):ve==="boolean"?Boolean(Hi):Hi}var Rt=X(se),gn=[],ni=0;if(jr)for(var ji=0;ji<jr.length;ji++){var mi=Pn[er[ji]];mi?(ni===0&&(ni=Kt()),gn[ji]=mi(jr[ji])):gn[ji]=jr[ji]}var $n=Rt.apply(null,gn);return $n=Ur($n),ni!==0&&xt(ni),$n}function $(se,ve,er,jr){er=er||[];var _=er.every(function(Ur){return Ur==="number"}),Pn=ve!=="string";return Pn&&_&&!jr?X(se):function(){return q(se,ve,er,arguments,jr)}}var et=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function F(se,ve,er){for(var jr=ve+er,_=ve;se[_]&&!(_>=jr);)++_;if(_-ve>16&&se.subarray&&et)return et.decode(se.subarray(ve,_));for(var Pn="";ve<_;){var Ur=se[ve++];if(!(Ur&128)){Pn+=String.fromCharCode(Ur);continue}var Rt=se[ve++]&63;if((Ur&224)==192){Pn+=String.fromCharCode((Ur&31)<<6|Rt);continue}var gn=se[ve++]&63;if((Ur&240)==224?Ur=(Ur&15)<<12|Rt<<6|gn:Ur=(Ur&7)<<18|Rt<<12|gn<<6|se[ve++]&63,Ur<65536)Pn+=String.fromCharCode(Ur);else{var ni=Ur-65536;Pn+=String.fromCharCode(55296|ni>>10,56320|ni&1023)}}return Pn}function ut(se,ve){return se?F(ee,se,ve):""}function ot(se,ve,er,jr){if(!(jr>0))return 0;for(var _=er,Pn=er+jr-1,Ur=0;Ur<se.length;++Ur){var Rt=se.charCodeAt(Ur);if(Rt>=55296&&Rt<=57343){var gn=se.charCodeAt(++Ur);Rt=65536+((Rt&1023)<<10)|gn&1023}if(Rt<=127){if(er>=Pn)break;ve[er++]=Rt}else if(Rt<=2047){if(er+1>=Pn)break;ve[er++]=192|Rt>>6,ve[er++]=128|Rt&63}else if(Rt<=65535){if(er+2>=Pn)break;ve[er++]=224|Rt>>12,ve[er++]=128|Rt>>6&63,ve[er++]=128|Rt&63}else{if(er+3>=Pn)break;ve[er++]=240|Rt>>18,ve[er++]=128|Rt>>12&63,ve[er++]=128|Rt>>6&63,ve[er++]=128|Rt&63}}return ve[er]=0,er-_}function J(se,ve,er){return ot(se,ee,ve,er)}var G=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function mt(se,ve){gt.set(se,ve)}function Mt(se,ve){return se%ve>0&&(se+=ve-se%ve),se}var ct,gt,ee,Ne,Ue,sr,gr,Xr,ir;function on(se){ct=se,t.HEAP8=gt=new Int8Array(se),t.HEAP16=Ne=new Int16Array(se),t.HEAP32=sr=new Int32Array(se),t.HEAPU8=ee=new Uint8Array(se),t.HEAPU16=Ue=new Uint16Array(se),t.HEAPU32=gr=new Uint32Array(se),t.HEAPF32=Xr=new Float32Array(se),t.HEAPF64=ir=new Float64Array(se)}var Xe=5267040,He=24128,_n=t.TOTAL_MEMORY||33554432;t.buffer?ct=t.buffer:ct=new ArrayBuffer(_n),_n=ct.byteLength,on(ct),sr[He>>2]=Xe;function dt(se){for(;se.length>0;){var ve=se.shift();if(typeof ve=="function"){ve();continue}var er=ve.func;typeof er=="number"?ve.arg===void 0?t.dynCall_v(er):t.dynCall_vi(er,ve.arg):er(ve.arg===void 0?null:ve.arg)}}var wt=[],Ht=[],ue=[],Le=[];function Ee(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)qo(t.preRun.shift());dt(wt)}function Jr(){dt(Ht)}function bn(){dt(ue)}function ai(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)_i(t.postRun.shift());dt(Le)}function qo(se){wt.unshift(se)}function _i(se){Le.unshift(se)}var Xn=Math.abs,Ui=Math.ceil,bs=Math.floor,Vi=Math.min,Cn=0,yi=null,_o=null;function Nr(se){Cn++,t.monitorRunDependencies&&t.monitorRunDependencies(Cn)}function ar(se){if(Cn--,t.monitorRunDependencies&&t.monitorRunDependencies(Cn),Cn==0&&(yi!==null&&(clearInterval(yi),yi=null),_o)){var ve=_o;_o=null,ve()}}t.preloadedImages={},t.preloadedAudios={};var zr=null,hn="data:application/octet-stream;base64,";function ho(se){return String.prototype.startsWith?se.startsWith(hn):se.indexOf(hn)===0}var ki,ds;zr="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var es=24144;function rs(se){return se}function No(se){var ve=/\b__Z[\w\d_]+/g;return se.replace(ve,function(er){var jr=er;return er===jr?er:jr+" ["+er+"]"})}function ha(){var se=new Error;if(!se.stack){try{throw new Error(0)}catch(ve){se=ve}if(!se.stack)return"(no stack trace available)"}return se.stack.toString()}function ch(){var se=ha();return t.extraStackTrace&&(se+=`
`+t.extraStackTrace()),No(se)}function Xl(se,ve,er,jr){fn("Assertion failed: "+ut(se)+", at: "+[ve?ut(ve):"unknown filename",er,jr?ut(jr):"unknown function"])}function vu(){return gt.length}function wl(se,ve,er){ee.set(ee.subarray(ve,ve+er),se)}function el(se){return t.___errno_location&&(sr[t.___errno_location()>>2]=se),se}function fa(se){fn("OOM")}function hc(se){try{var ve=new ArrayBuffer(se);return ve.byteLength!=se?void 0:(new Int8Array(ve).set(gt),tf(ve),on(ve),1)}catch{}}function bu(se){var ve=vu(),er=16777216,jr=2147483648-er;if(se>jr)return!1;for(var _=16777216,Pn=Math.max(ve,_);Pn<se;)Pn<=536870912?Pn=Mt(2*Pn,er):Pn=Math.min(Mt((3*Pn+2147483648)/4,er),jr);var Ur=hc(Pn);return!!Ur}var fo=typeof atob=="function"?atob:function(se){var ve="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",er="",jr,_,Pn,Ur,Rt,gn,ni,ji=0;se=se.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Ur=ve.indexOf(se.charAt(ji++)),Rt=ve.indexOf(se.charAt(ji++)),gn=ve.indexOf(se.charAt(ji++)),ni=ve.indexOf(se.charAt(ji++)),jr=Ur<<2|Rt>>4,_=(Rt&15)<<4|gn>>2,Pn=(gn&3)<<6|ni,er=er+String.fromCharCode(jr),gn!==64&&(er=er+String.fromCharCode(_)),ni!==64&&(er=er+String.fromCharCode(Pn));while(ji<se.length);return er};function at(se){try{for(var ve=fo(se),er=new Uint8Array(ve.length),jr=0;jr<ve.length;++jr)er[jr]=ve.charCodeAt(jr);return er}catch{throw new Error("Converting base64 string to bytes failed.")}}function At(se){if(ho(se))return at(se.slice(hn.length))}var bt={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Lt={a:fn,b:x,c:w,d:Xl,e:el,f:vu,g:wl,h:bu,i:fa,j:rs,k:No,l:hc,m:ha,n:ch,o:es,p:He},vt=function(se,ve,er){var jr=new se.Int8Array(er),_=new se.Int32Array(er),Pn=new se.Uint8Array(er),Ur=new se.Float32Array(er),Rt=new se.Float64Array(er),gn=ve.o|0,ni=ve.p|0,ji=se.Math.floor,mi=se.Math.abs,$n=se.Math.sqrt,Hi=se.Math.pow,Nn=se.Math.cos,kn=se.Math.sin,Kn=se.Math.tan,Qs=se.Math.acos,dp=se.Math.asin,Fs=se.Math.atan,Fo=se.Math.atan2,Mu=se.Math.ceil,dc=se.Math.imul,Su=se.Math.min,Ai=se.Math.max,ma=se.Math.clz32,pn=ve.b,Bt=ve.c,dn=ve.d,mp=ve.e,Jl=ve.f,Ts=ve.g,af=ve.h,il=ve.i,It=24160;function mc(g){return jr=new Int8Array(g),Pn=new Uint8Array(g),_=new Int32Array(g),Ur=new Float32Array(g),Rt=new Float64Array(g),er=g,!0}function Tl(g){g=g|0;var A=0;return A=It,It=It+g|0,It=It+15&-16,A|0}function tu(){return It|0}function ph(g){g=g|0,It=g}function cf(g,A){g=g|0,A=A|0,It=g}function lf(g,A){g=g|0,A=A|0;var v=0,M=0,C=0;return(g|0)<0?(A=2,A|0):(g|0)>13780509?(A=be(15,A)|0,A|0):(v=((g|0)<0)<<31>>31,C=ya(g|0,v|0,3,0)|0,M=Bt()|0,v=ui(g|0,v|0,1,0)|0,v=ya(C|0,M|0,v|0,Bt()|0)|0,v=ui(v|0,Bt()|0,1,0)|0,g=Bt()|0,_[A>>2]=v,_[A+4>>2]=g,A=0,A|0)}function eu(g,A,v,M){return g=g|0,A=A|0,v=v|0,M=M|0,Cu(g,A,v,M,0)|0}function Cu(g,A,v,M,C){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0;var L=0,k=0,z=0,Z=0,nt=0;if(Z=It,It=It+16|0,k=Z,!(Ap(g,A,v,M,C)|0))return M=0,It=Z,M|0;do if((v|0)>=0){if((v|0)>13780509){if(L=be(15,k)|0,L|0)break;z=k,k=_[z>>2]|0,z=_[z+4>>2]|0}else L=((v|0)<0)<<31>>31,nt=ya(v|0,L|0,3,0)|0,z=Bt()|0,L=ui(v|0,L|0,1,0)|0,L=ya(nt|0,z|0,L|0,Bt()|0)|0,L=ui(L|0,Bt()|0,1,0)|0,z=Bt()|0,_[k>>2]=L,_[k+4>>2]=z,k=L;if(Mp(M|0,0,k<<3|0)|0,C|0){Mp(C|0,0,k<<2|0)|0,L=Wa(g,A,v,M,C,k,z,0)|0;break}L=Vo(k,4)|0,L?(nt=Wa(g,A,v,M,L,k,z,0)|0,vn(L),L=nt):L=13}else L=2;while(0);return nt=L,It=Z,nt|0}function Ap(g,A,v,M,C){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0;var L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0;if(me=It,It=It+16|0,re=me,Gt=me+8|0,Zt=re,_[Zt>>2]=g,_[Zt+4>>2]=A,(v|0)<0)return Gt=2,It=me,Gt|0;if(L=M,_[L>>2]=g,_[L+4>>2]=A,L=(C|0)!=0,L&&(_[C>>2]=0),ii(g,A)|0)return Gt=9,It=me,Gt|0;_[Gt>>2]=0;t:do if((v|0)>=1)if(L)for(_t=1,nt=0,Ot=0,Zt=1,L=g;;){if(!(nt|Ot)){if(L=Io(L,A,4,Gt,re)|0,L|0)break t;if(A=re,L=_[A>>2]|0,A=_[A+4>>2]|0,ii(L,A)|0){L=9;break t}}if(L=Io(L,A,_[22384+(Ot<<2)>>2]|0,Gt,re)|0,L|0)break t;if(A=re,L=_[A>>2]|0,A=_[A+4>>2]|0,g=M+(_t<<3)|0,_[g>>2]=L,_[g+4>>2]=A,_[C+(_t<<2)>>2]=Zt,g=nt+1|0,k=(g|0)==(Zt|0),z=Ot+1|0,Z=(z|0)==6,ii(L,A)|0){L=9;break t}if(Zt=Zt+(Z&k&1)|0,(Zt|0)>(v|0)){L=0;break}else _t=_t+1|0,nt=k?0:g,Ot=k?Z?0:z:Ot}else for(_t=1,nt=0,Ot=0,Zt=1,L=g;;){if(!(nt|Ot)){if(L=Io(L,A,4,Gt,re)|0,L|0)break t;if(A=re,L=_[A>>2]|0,A=_[A+4>>2]|0,ii(L,A)|0){L=9;break t}}if(L=Io(L,A,_[22384+(Ot<<2)>>2]|0,Gt,re)|0,L|0)break t;if(A=re,L=_[A>>2]|0,A=_[A+4>>2]|0,g=M+(_t<<3)|0,_[g>>2]=L,_[g+4>>2]=A,g=nt+1|0,k=(g|0)==(Zt|0),z=Ot+1|0,Z=(z|0)==6,ii(L,A)|0){L=9;break t}if(Zt=Zt+(Z&k&1)|0,(Zt|0)>(v|0)){L=0;break}else _t=_t+1|0,nt=k?0:g,Ot=k?Z?0:z:Ot}else L=0;while(0);return Gt=L,It=me,Gt|0}function Wa(g,A,v,M,C,L,k,z){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0,L=L|0,k=k|0,z=z|0;var Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0,ke=0,Be=0;if(me=It,It=It+16|0,re=me+8|0,Gt=me,Z=bh(g|0,A|0,L|0,k|0)|0,_t=Bt()|0,Ot=M+(Z<<3)|0,ke=Ot,Be=_[ke>>2]|0,ke=_[ke+4>>2]|0,nt=(Be|0)==(g|0)&(ke|0)==(A|0),!((Be|0)==0&(ke|0)==0|nt))do Z=ui(Z|0,_t|0,1,0)|0,Z=Fg(Z|0,Bt()|0,L|0,k|0)|0,_t=Bt()|0,Ot=M+(Z<<3)|0,Be=Ot,ke=_[Be>>2]|0,Be=_[Be+4>>2]|0,nt=(ke|0)==(g|0)&(Be|0)==(A|0);while(!((ke|0)==0&(Be|0)==0|nt));if(Z=C+(Z<<2)|0,nt&&(_[Z>>2]|0)<=(z|0)||(Be=Ot,_[Be>>2]=g,_[Be+4>>2]=A,_[Z>>2]=z,(z|0)>=(v|0)))return Be=0,It=me,Be|0;switch(nt=z+1|0,_[re>>2]=0,Z=Io(g,A,2,re,Gt)|0,Z|0){case 9:{Zt=9;break}case 0:{Z=Gt,Z=Wa(_[Z>>2]|0,_[Z+4>>2]|0,v,M,C,L,k,nt)|0,Z||(Zt=9);break}default:}t:do if((Zt|0)==9){switch(_[re>>2]=0,Z=Io(g,A,3,re,Gt)|0,Z|0){case 9:break;case 0:{if(Z=Gt,Z=Wa(_[Z>>2]|0,_[Z+4>>2]|0,v,M,C,L,k,nt)|0,Z|0)break t;break}default:break t}switch(_[re>>2]=0,Z=Io(g,A,1,re,Gt)|0,Z|0){case 9:break;case 0:{if(Z=Gt,Z=Wa(_[Z>>2]|0,_[Z+4>>2]|0,v,M,C,L,k,nt)|0,Z|0)break t;break}default:break t}switch(_[re>>2]=0,Z=Io(g,A,5,re,Gt)|0,Z|0){case 9:break;case 0:{if(Z=Gt,Z=Wa(_[Z>>2]|0,_[Z+4>>2]|0,v,M,C,L,k,nt)|0,Z|0)break t;break}default:break t}switch(_[re>>2]=0,Z=Io(g,A,4,re,Gt)|0,Z|0){case 9:break;case 0:{if(Z=Gt,Z=Wa(_[Z>>2]|0,_[Z+4>>2]|0,v,M,C,L,k,nt)|0,Z|0)break t;break}default:break t}switch(_[re>>2]=0,Z=Io(g,A,6,re,Gt)|0,Z|0){case 9:break;case 0:{if(Z=Gt,Z=Wa(_[Z>>2]|0,_[Z+4>>2]|0,v,M,C,L,k,nt)|0,Z|0)break t;break}default:break t}return Be=0,It=me,Be|0}while(0);return Be=Z,It=me,Be|0}function Io(g,A,v,M,C){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0;var L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0;if(v>>>0>6)return C=1,C|0;if(Ot=(_[M>>2]|0)%6|0,_[M>>2]=Ot,(Ot|0)>0){L=0;do v=El(v)|0,L=L+1|0;while((L|0)<(_[M>>2]|0))}if(Ot=Qe(g|0,A|0,45)|0,Bt()|0,_t=Ot&127,_t>>>0>121)return C=5,C|0;Z=As(g,A)|0,L=Qe(g|0,A|0,52)|0,Bt()|0,L=L&15;t:do if(!L)nt=8;else{for(;;){if(k=(15-L|0)*3|0,z=Qe(g|0,A|0,k|0)|0,Bt()|0,z=z&7,(z|0)==7){A=5;break}if(Gt=(zo(L)|0)==0,L=L+-1|0,Zt=xr(7,0,k|0)|0,A=A&~(Bt()|0),re=xr(_[(Gt?432:16)+(z*28|0)+(v<<2)>>2]|0,0,k|0)|0,k=Bt()|0,v=_[(Gt?640:224)+(z*28|0)+(v<<2)>>2]|0,g=re|g&~Zt,A=k|A,!v){v=0;break t}if(!L){nt=8;break t}}return A|0}while(0);(nt|0)==8&&(Gt=_[848+(_t*28|0)+(v<<2)>>2]|0,re=xr(Gt|0,0,45)|0,g=re|g,A=Bt()|0|A&-1040385,v=_[4272+(_t*28|0)+(v<<2)>>2]|0,(Gt&127|0)==127&&(Gt=xr(_[848+(_t*28|0)+20>>2]|0,0,45)|0,A=Bt()|0|A&-1040385,v=_[4272+(_t*28|0)+20>>2]|0,g=Ya(Gt|g,A)|0,A=Bt()|0,_[M>>2]=(_[M>>2]|0)+1)),z=Qe(g|0,A|0,45)|0,Bt()|0,z=z&127;t:do if(pr(z)|0){e:do if((As(g,A)|0)==1){if((_t|0)!=(z|0))if(sn(z,_[7696+(_t*28|0)>>2]|0)|0){g=mf(g,A)|0,k=1,A=Bt()|0;break}else dn(23313,22416,436,22424);switch(Z|0){case 3:{g=Ya(g,A)|0,A=Bt()|0,_[M>>2]=(_[M>>2]|0)+1,k=0;break e}case 5:{g=mf(g,A)|0,A=Bt()|0,_[M>>2]=(_[M>>2]|0)+5,k=0;break e}case 0:return Gt=9,Gt|0;default:return Gt=1,Gt|0}}else k=0;while(0);if((v|0)>0){L=0;do g=vp(g,A)|0,A=Bt()|0,L=L+1|0;while((L|0)!=(v|0))}if((_t|0)!=(z|0)){if(!(Pr(z)|0)){if((k|0)!=0|(As(g,A)|0)!=5)break;_[M>>2]=(_[M>>2]|0)+1;break}switch(Ot&127){case 8:case 118:break t;default:}(As(g,A)|0)!=3&&(_[M>>2]=(_[M>>2]|0)+1)}}else if((v|0)>0){L=0;do g=Ya(g,A)|0,A=Bt()|0,L=L+1|0;while((L|0)!=(v|0))}while(0);return _[M>>2]=((_[M>>2]|0)+v|0)%6|0,Gt=C,_[Gt>>2]=g,_[Gt+4>>2]=A,Gt=0,Gt|0}function zt(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0,k=0,z=0,Z=0,nt=0;for(z=It,It=It+16|0,L=z,k=z+8|0,C=(ii(g,A)|0)==0,C=C?1:2;;){if(_[k>>2]=0,nt=(Io(g,A,C,k,L)|0)==0,Z=L,nt&((_[Z>>2]|0)==(v|0)?(_[Z+4>>2]|0)==(M|0):0)){g=4;break}if(C=C+1|0,C>>>0>=7){C=7,g=4;break}}return(g|0)==4?(It=z,C|0):0}function ne(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0;if(Gt=It,It=It+16|0,Zt=Gt,re=Gt+8|0,Ot=Zt,_[Ot>>2]=g,_[Ot+4>>2]=A,!v)return re=M,_[re>>2]=g,_[re+4>>2]=A,re=0,It=Gt,re|0;_[re>>2]=0;t:do if(ii(g,A)|0)g=9;else{if(L=(v|0)>0,L){C=0,Ot=g;do{if(g=Io(Ot,A,4,re,Zt)|0,g|0)break t;if(A=Zt,Ot=_[A>>2]|0,A=_[A+4>>2]|0,C=C+1|0,ii(Ot,A)|0){g=9;break t}}while((C|0)<(v|0));if(_t=M,_[_t>>2]=Ot,_[_t+4>>2]=A,_t=v+-1|0,L){nt=0,g=1;do{if(C=22384+(nt<<2)|0,(nt|0)==5)for(k=_[C>>2]|0,L=0,C=g;;){if(g=Zt,g=Io(_[g>>2]|0,_[g+4>>2]|0,k,re,Zt)|0,g|0)break t;if((L|0)!=(_t|0))if(Z=Zt,z=_[Z>>2]|0,Z=_[Z+4>>2]|0,g=M+(C<<3)|0,_[g>>2]=z,_[g+4>>2]=Z,!(ii(z,Z)|0))g=C+1|0;else{g=9;break t}else g=C;if(L=L+1|0,(L|0)>=(v|0))break;C=g}else for(k=Zt,Z=_[C>>2]|0,z=0,C=g,L=_[k>>2]|0,k=_[k+4>>2]|0;;){if(g=Io(L,k,Z,re,Zt)|0,g|0)break t;if(k=Zt,L=_[k>>2]|0,k=_[k+4>>2]|0,g=M+(C<<3)|0,_[g>>2]=L,_[g+4>>2]=k,g=C+1|0,ii(L,k)|0){g=9;break t}if(z=z+1|0,(z|0)>=(v|0))break;C=g}nt=nt+1|0}while(nt>>>0<6);g=Zt,k=Ot,C=_[g>>2]|0,L=A,g=_[g+4>>2]|0}else k=Ot,C=Ot,L=A,g=A}else k=M,_[k>>2]=g,_[k+4>>2]=A,k=g,C=g,L=A,g=A;g=(k|0)==(C|0)&(L|0)==(g|0)?0:9}while(0);return re=g,It=Gt,re|0}function _e(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0,k=0,z=0,Z=0,nt=0;if(z=It,It=It+48|0,C=z+16|0,L=z+8|0,k=z,v|0)return k=15,It=z,k|0;if(nt=g,Z=_[nt+4>>2]|0,v=L,_[v>>2]=_[nt>>2],_[v+4>>2]=Z,_s(L,C),A=po(C,A,k)|0,!A){if(v=_[L>>2]|0,L=_[g+8>>2]|0,(L|0)>0){C=_[g+12>>2]|0,A=0;do v=(_[C+(A<<3)>>2]|0)+v|0,A=A+1|0;while((A|0)<(L|0))}A=k,C=_[A>>2]|0,A=_[A+4>>2]|0,L=((v|0)<0)<<31>>31,(A|0)<(L|0)|(A|0)==(L|0)&C>>>0<v>>>0?(A=k,_[A>>2]=v,_[A+4>>2]=L,A=L):v=C,Z=ui(v|0,A|0,12,0)|0,nt=Bt()|0,A=k,_[A>>2]=Z,_[A+4>>2]=nt,A=M,_[A>>2]=Z,_[A+4>>2]=nt,A=0}return nt=A,It=z,nt|0}function Ie(g,A,v,M,C,L,k){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0,L=L|0,k=k|0;var z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0,ke=0,Be=0,xe=0,Se=0,pe=0,Ir=0,Lr=0,Er=0,Br=0,Zi=0,Ii=0,Ri=0,In=0,Hn=0,Qn=0,eo=0,Rn=0,bo=0,xc=0,Sp=0;if(eo=It,It=It+64|0,Ri=eo+48|0,In=eo+32|0,Hn=eo+24|0,Ir=eo+8|0,Lr=eo,Z=_[g>>2]|0,(Z|0)<=0)return Qn=0,It=eo,Qn|0;for(Er=g+4|0,Br=Ri+8|0,Zi=In+8|0,Ii=Ir+8|0,z=0,Se=0;;){nt=_[Er>>2]|0,xe=nt+(Se<<4)|0,_[Ri>>2]=_[xe>>2],_[Ri+4>>2]=_[xe+4>>2],_[Ri+8>>2]=_[xe+8>>2],_[Ri+12>>2]=_[xe+12>>2],(Se|0)==(Z+-1|0)?(_[In>>2]=_[nt>>2],_[In+4>>2]=_[nt+4>>2],_[In+8>>2]=_[nt+8>>2],_[In+12>>2]=_[nt+12>>2]):(xe=nt+(Se+1<<4)|0,_[In>>2]=_[xe>>2],_[In+4>>2]=_[xe+4>>2],_[In+8>>2]=_[xe+8>>2],_[In+12>>2]=_[xe+12>>2]),Z=is(Ri,In,M,Hn)|0;t:do if(Z)nt=0,z=Z;else if(nt=Hn,Z=_[nt>>2]|0,nt=_[nt+4>>2]|0,(nt|0)>0|(nt|0)==0&Z>>>0>0){Be=0,xe=0;e:for(;;){if(Sp=+Rt[Ri>>3],ke=Oa(Z|0,nt|0,Be|0,xe|0)|0,xc=+(ke>>>0)+4294967296*+(Bt()|0),Rn=+(Z>>>0)+4294967296*+(nt|0),bo=+(Be>>>0)+4294967296*+(xe|0),Rt[Ir>>3]=Sp*xc/Rn+ +Rt[In>>3]*bo/Rn,Rt[Ii>>3]=+Rt[Br>>3]*xc/Rn+ +Rt[Zi>>3]*bo/Rn,Z=Hd(Ir,M,Lr)|0,Z|0){z=Z;break}ke=Lr,me=_[ke>>2]|0,ke=_[ke+4>>2]|0,Zt=bh(me|0,ke|0,A|0,v|0)|0,_t=Bt()|0,Z=k+(Zt<<3)|0,Ot=Z,nt=_[Ot>>2]|0,Ot=_[Ot+4>>2]|0;r:do if((nt|0)==0&(Ot|0)==0)pe=Z,Qn=16;else for(re=0,Gt=0;;){if((re|0)>(v|0)|(re|0)==(v|0)&Gt>>>0>A>>>0){z=1;break e}if((nt|0)==(me|0)&(Ot|0)==(ke|0))break r;if(Z=ui(Zt|0,_t|0,1,0)|0,Zt=Fg(Z|0,Bt()|0,A|0,v|0)|0,_t=Bt()|0,Gt=ui(Gt|0,re|0,1,0)|0,re=Bt()|0,Z=k+(Zt<<3)|0,Ot=Z,nt=_[Ot>>2]|0,Ot=_[Ot+4>>2]|0,(nt|0)==0&(Ot|0)==0){pe=Z,Qn=16;break}}while(0);if((Qn|0)==16&&(Qn=0,!((me|0)==0&(ke|0)==0))&&(Gt=pe,_[Gt>>2]=me,_[Gt+4>>2]=ke,Gt=L+(_[C>>2]<<3)|0,_[Gt>>2]=me,_[Gt+4>>2]=ke,Gt=C,Gt=ui(_[Gt>>2]|0,_[Gt+4>>2]|0,1,0)|0,me=Bt()|0,ke=C,_[ke>>2]=Gt,_[ke+4>>2]=me),Be=ui(Be|0,xe|0,1,0)|0,xe=Bt()|0,nt=Hn,Z=_[nt>>2]|0,nt=_[nt+4>>2]|0,!((nt|0)>(xe|0)|(nt|0)==(xe|0)&Z>>>0>Be>>>0)){nt=1;break t}}nt=0}else nt=1;while(0);if(Se=Se+1|0,!nt){Qn=21;break}if(Z=_[g>>2]|0,(Se|0)>=(Z|0)){z=0,Qn=21;break}}return(Qn|0)==21?(It=eo,z|0):0}function ze(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0,ke=0,Be=0,xe=0,Se=0,pe=0,Ir=0,Lr=0,Er=0,Br=0,Zi=0,Ii=0,Ri=0,In=0,Hn=0,Qn=0,eo=0,Rn=0,bo=0,xc=0;if(xc=It,It=It+112|0,Qn=xc+80|0,Z=xc+72|0,eo=xc,Rn=xc+56|0,v|0)return bo=15,It=xc,bo|0;if(nt=g+8|0,bo=Il((_[nt>>2]<<5)+32|0)|0,!bo)return bo=13,It=xc,bo|0;if(vo(g,bo),In=g,Hn=_[In+4>>2]|0,v=Z,_[v>>2]=_[In>>2],_[v+4>>2]=Hn,_s(Z,Qn),v=po(Qn,A,eo)|0,v)In=0,Hn=0;else{if(v=_[Z>>2]|0,L=_[nt>>2]|0,(L|0)>0){k=_[g+12>>2]|0,C=0;do v=(_[k+(C<<3)>>2]|0)+v|0,C=C+1|0;while((C|0)!=(L|0));C=v}else C=v;v=eo,L=_[v>>2]|0,v=_[v+4>>2]|0,k=((C|0)<0)<<31>>31,(v|0)<(k|0)|(v|0)==(k|0)&L>>>0<C>>>0?(v=eo,_[v>>2]=C,_[v+4>>2]=k,v=k):C=L,In=ui(C|0,v|0,12,0)|0,Hn=Bt()|0,v=eo,_[v>>2]=In,_[v+4>>2]=Hn,v=0}if(v|0)return vn(bo),bo=v,It=xc,bo|0;if(C=Vo(In,8)|0,!C)return vn(bo),bo=13,It=xc,bo|0;if(z=Vo(In,8)|0,!z)return vn(bo),vn(C),bo=13,It=xc,bo|0;Ii=Qn,_[Ii>>2]=0,_[Ii+4>>2]=0,Ii=g,Ri=_[Ii+4>>2]|0,v=Z,_[v>>2]=_[Ii>>2],_[v+4>>2]=Ri,v=Ie(Z,In,Hn,A,Qn,C,z)|0;t:do if(v)vn(C),vn(z),vn(bo);else{e:do if((_[nt>>2]|0)>0){for(k=g+12|0,L=0;v=Ie((_[k>>2]|0)+(L<<3)|0,In,Hn,A,Qn,C,z)|0,L=L+1|0,!(v|0);)if((L|0)>=(_[nt>>2]|0))break e;vn(C),vn(z),vn(bo);break t}while(0);(Hn|0)>0|(Hn|0)==0&In>>>0>0&&Mp(z|0,0,In<<3|0)|0,Ri=Qn,Ii=_[Ri+4>>2]|0;e:do if((Ii|0)>0|(Ii|0)==0&(_[Ri>>2]|0)>>>0>0){Er=C,Br=z,Zi=C,Ii=z,Ri=C,v=C,pe=C,Ir=z,Lr=z,C=z;r:for(;;){for(ke=0,Be=0,xe=0,Se=0,L=0,k=0;;){z=eo,Z=z+56|0;do _[z>>2]=0,z=z+4|0;while((z|0)<(Z|0));if(A=Er+(ke<<3)|0,nt=_[A>>2]|0,A=_[A+4>>2]|0,Ap(nt,A,1,eo,0)|0){z=eo,Z=z+56|0;do _[z>>2]=0,z=z+4|0;while((z|0)<(Z|0));z=Vo(7,4)|0,z|0&&(Wa(nt,A,1,eo,z,7,0,0)|0,vn(z))}for(me=0;;){Gt=eo+(me<<3)|0,re=_[Gt>>2]|0,Gt=_[Gt+4>>2]|0;n:do if((re|0)==0&(Gt|0)==0)z=L,Z=k;else{if(_t=bh(re|0,Gt|0,In|0,Hn|0)|0,nt=Bt()|0,z=M+(_t<<3)|0,A=z,Z=_[A>>2]|0,A=_[A+4>>2]|0,!((Z|0)==0&(A|0)==0)){Ot=0,Zt=0;do{if((Ot|0)>(Hn|0)|(Ot|0)==(Hn|0)&Zt>>>0>In>>>0)break r;if((Z|0)==(re|0)&(A|0)==(Gt|0)){z=L,Z=k;break n}z=ui(_t|0,nt|0,1,0)|0,_t=Fg(z|0,Bt()|0,In|0,Hn|0)|0,nt=Bt()|0,Zt=ui(Zt|0,Ot|0,1,0)|0,Ot=Bt()|0,z=M+(_t<<3)|0,A=z,Z=_[A>>2]|0,A=_[A+4>>2]|0}while(!((Z|0)==0&(A|0)==0))}(re|0)==0&(Gt|0)==0?(z=L,Z=k):(Bu(re,Gt,Rn)|0,Uo(g,bo,Rn)|0&&(Zt=ui(L|0,k|0,1,0)|0,k=Bt()|0,Ot=z,_[Ot>>2]=re,_[Ot+4>>2]=Gt,L=Br+(L<<3)|0,_[L>>2]=re,_[L+4>>2]=Gt,L=Zt),z=L,Z=k)}while(0);if(me=me+1|0,me>>>0>=7)break;L=z,k=Z}if(ke=ui(ke|0,Be|0,1,0)|0,Be=Bt()|0,xe=ui(xe|0,Se|0,1,0)|0,Se=Bt()|0,k=Qn,L=_[k>>2]|0,k=_[k+4>>2]|0,(Se|0)<(k|0)|(Se|0)==(k|0)&xe>>>0<L>>>0)L=z,k=Z;else break}if((k|0)>0|(k|0)==0&L>>>0>0){L=0,k=0;do Se=Er+(L<<3)|0,_[Se>>2]=0,_[Se+4>>2]=0,L=ui(L|0,k|0,1,0)|0,k=Bt()|0,Se=Qn,xe=_[Se+4>>2]|0;while((k|0)<(xe|0)|((k|0)==(xe|0)?L>>>0<(_[Se>>2]|0)>>>0:0))}if(Se=Qn,_[Se>>2]=z,_[Se+4>>2]=Z,(Z|0)>0|(Z|0)==0&z>>>0>0)me=C,ke=Lr,Be=Ri,xe=Ir,Se=Br,C=pe,Lr=v,Ir=Zi,pe=me,v=ke,Ri=Ii,Ii=Be,Zi=xe,Br=Er,Er=Se;else break e}vn(Zi),vn(Ii),vn(bo),v=1;break t}else v=z;while(0);vn(bo),vn(C),vn(v),v=0}while(0);return bo=v,It=xc,bo|0}function hr(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0;if(_t=It,It=It+176|0,Z=_t,(A|0)<1)return Za(v,0,0),nt=0,It=_t,nt|0;for(z=g,z=Qe(_[z>>2]|0,_[z+4>>2]|0,52)|0,Bt()|0,Za(v,(A|0)>6?A:6,z&15),z=0;M=g+(z<<3)|0,M=d(_[M>>2]|0,_[M+4>>2]|0,Z)|0,!(M|0);){if(M=_[Z>>2]|0,(M|0)>0){k=0;do L=Z+8+(k<<4)|0,k=k+1|0,M=Z+8+(((k|0)%(M|0)|0)<<4)|0,C=Cx(v,M,L)|0,C?Ng(v,C)|0:Wd(v,L,M)|0,M=_[Z>>2]|0;while((k|0)<(M|0))}if(z=z+1|0,(z|0)>=(A|0)){M=0,nt=13;break}}return(nt|0)==13?(It=_t,M|0):(_a(v),nt=M,It=_t,nt|0)}function nr(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0;if(L=It,It=It+32|0,M=L,C=L+16|0,g=hr(g,A,C)|0,g|0)return v=g,It=L,v|0;if(_[v>>2]=0,_[v+4>>2]=0,_[v+8>>2]=0,g=Fu(C)|0,g|0)do{A=$r(v)|0;do Kr(A,g)|0,k=g+16|0,_[M>>2]=_[k>>2],_[M+4>>2]=_[k+4>>2],_[M+8>>2]=_[k+8>>2],_[M+12>>2]=_[k+12>>2],Ng(C,g)|0,g=Tp(C,M)|0;while(g|0);g=Fu(C)|0}while(g|0);return _a(C),g=Sr(v)|0,g?(ei(v),k=g,It=L,k|0):(k=0,It=L,k|0)}function pr(g){return g=g|0,g>>>0>121?(g=0,g|0):(g=_[7696+(g*28|0)+16>>2]|0,g|0)}function Pr(g){return g=g|0,(g|0)==4|(g|0)==117|0}function Sn(g){return g=g|0,_[11120+((_[g>>2]|0)*216|0)+((_[g+4>>2]|0)*72|0)+((_[g+8>>2]|0)*24|0)+(_[g+12>>2]<<3)>>2]|0}function dr(g){return g=g|0,_[11120+((_[g>>2]|0)*216|0)+((_[g+4>>2]|0)*72|0)+((_[g+8>>2]|0)*24|0)+(_[g+12>>2]<<3)+4>>2]|0}function kr(g,A){g=g|0,A=A|0,g=7696+(g*28|0)|0,_[A>>2]=_[g>>2],_[A+4>>2]=_[g+4>>2],_[A+8>>2]=_[g+8>>2],_[A+12>>2]=_[g+12>>2]}function xn(g,A){g=g|0,A=A|0;var v=0,M=0;if(A>>>0>20)return A=-1,A|0;do if((_[11120+(A*216|0)>>2]|0)!=(g|0))if((_[11120+(A*216|0)+8>>2]|0)!=(g|0))if((_[11120+(A*216|0)+16>>2]|0)!=(g|0))if((_[11120+(A*216|0)+24>>2]|0)!=(g|0))if((_[11120+(A*216|0)+32>>2]|0)!=(g|0))if((_[11120+(A*216|0)+40>>2]|0)!=(g|0))if((_[11120+(A*216|0)+48>>2]|0)!=(g|0))if((_[11120+(A*216|0)+56>>2]|0)!=(g|0))if((_[11120+(A*216|0)+64>>2]|0)!=(g|0))if((_[11120+(A*216|0)+72>>2]|0)!=(g|0))if((_[11120+(A*216|0)+80>>2]|0)!=(g|0))if((_[11120+(A*216|0)+88>>2]|0)!=(g|0))if((_[11120+(A*216|0)+96>>2]|0)!=(g|0))if((_[11120+(A*216|0)+104>>2]|0)!=(g|0))if((_[11120+(A*216|0)+112>>2]|0)!=(g|0))if((_[11120+(A*216|0)+120>>2]|0)!=(g|0))if((_[11120+(A*216|0)+128>>2]|0)!=(g|0))if((_[11120+(A*216|0)+136>>2]|0)==(g|0))g=2,v=1,M=2;else{if((_[11120+(A*216|0)+144>>2]|0)==(g|0)){g=0,v=2,M=0;break}if((_[11120+(A*216|0)+152>>2]|0)==(g|0)){g=0,v=2,M=1;break}if((_[11120+(A*216|0)+160>>2]|0)==(g|0)){g=0,v=2,M=2;break}if((_[11120+(A*216|0)+168>>2]|0)==(g|0)){g=1,v=2,M=0;break}if((_[11120+(A*216|0)+176>>2]|0)==(g|0)){g=1,v=2,M=1;break}if((_[11120+(A*216|0)+184>>2]|0)==(g|0)){g=1,v=2,M=2;break}if((_[11120+(A*216|0)+192>>2]|0)==(g|0)){g=2,v=2,M=0;break}if((_[11120+(A*216|0)+200>>2]|0)==(g|0)){g=2,v=2,M=1;break}if((_[11120+(A*216|0)+208>>2]|0)==(g|0)){g=2,v=2,M=2;break}else g=-1;return g|0}else g=2,v=1,M=1;else g=2,v=1,M=0;else g=1,v=1,M=2;else g=1,v=1,M=1;else g=1,v=1,M=0;else g=0,v=1,M=2;else g=0,v=1,M=1;else g=0,v=1,M=0;else g=2,v=0,M=2;else g=2,v=0,M=1;else g=2,v=0,M=0;else g=1,v=0,M=2;else g=1,v=0,M=1;else g=1,v=0,M=0;else g=0,v=0,M=2;else g=0,v=0,M=1;else g=0,v=0,M=0;while(0);return A=_[11120+(A*216|0)+(v*72|0)+(g*24|0)+(M<<3)+4>>2]|0,A|0}function sn(g,A){return g=g|0,A=A|0,(_[7696+(g*28|0)+20>>2]|0)==(A|0)?(A=1,A|0):(A=(_[7696+(g*28|0)+24>>2]|0)==(A|0),A|0)}function xi(g,A){return g=g|0,A=A|0,_[848+(g*28|0)+(A<<2)>>2]|0}function Go(g,A){return g=g|0,A=A|0,(_[848+(g*28|0)>>2]|0)==(A|0)?(A=0,A|0):(_[848+(g*28|0)+4>>2]|0)==(A|0)?(A=1,A|0):(_[848+(g*28|0)+8>>2]|0)==(A|0)?(A=2,A|0):(_[848+(g*28|0)+12>>2]|0)==(A|0)?(A=3,A|0):(_[848+(g*28|0)+16>>2]|0)==(A|0)?(A=4,A|0):(_[848+(g*28|0)+20>>2]|0)==(A|0)?(A=5,A|0):((_[848+(g*28|0)+24>>2]|0)==(A|0)?6:7)|0}function zs(){return 122}function qa(g){g=g|0;var A=0,v=0,M=0;A=0;do xr(A|0,0,45)|0,M=Bt()|0|134225919,v=g+(A<<3)|0,_[v>>2]=-1,_[v+4>>2]=M,A=A+1|0;while((A|0)!=122);return 0}function Js(g){return g=g|0,+Rt[g+16>>3]<+Rt[g+24>>3]|0}function Ac(g,A){g=g|0,A=A|0;var v=0,M=0,C=0;return v=+Rt[A>>3],!(v>=+Rt[g+8>>3])||!(v<=+Rt[g>>3])?(A=0,A|0):(M=+Rt[g+16>>3],v=+Rt[g+24>>3],C=+Rt[A+8>>3],A=C>=v,g=C<=M&1,M<v?A&&(g=1):A||(g=0),A=(g|0)!=0,A|0)}function po(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0,ke=0;Gt=It,It=It+288|0,_t=Gt+264|0,Ot=Gt+96|0,nt=Gt,z=nt,Z=z+96|0;do _[z>>2]=0,z=z+4|0;while((z|0)<(Z|0));return A=O(A,nt)|0,A|0?(re=A,It=Gt,re|0):(Z=nt,nt=_[Z>>2]|0,Z=_[Z+4>>2]|0,Bu(nt,Z,_t)|0,d(nt,Z,Ot)|0,k=+Pt(_t,Ot+8|0),Rt[_t>>3]=+Rt[g>>3],Z=_t+8|0,Rt[Z>>3]=+Rt[g+16>>3],Rt[Ot>>3]=+Rt[g+8>>3],nt=Ot+8|0,Rt[nt>>3]=+Rt[g+24>>3],C=+Pt(_t,Ot),ke=+Rt[Z>>3]-+Rt[nt>>3],L=+mi(+ke),me=+Rt[_t>>3]-+Rt[Ot>>3],M=+mi(+me),!(ke==0|me==0)&&(ke=+VT(+L,+M),ke=+Mu(+(C*C/+Rx(+(ke/+Rx(+L,+M)),3)/(k*(k*2.59807621135)*.8))),Rt[gn>>3]=ke,Zt=~~ke>>>0,re=+mi(ke)>=1?ke>0?~~+Su(+ji(ke/4294967296),4294967295)>>>0:~~+Mu((ke-+(~~ke>>>0))/4294967296)>>>0:0,(_[gn+4>>2]&2146435072|0)!=2146435072)?(Ot=(Zt|0)==0&(re|0)==0,A=v,_[A>>2]=Ot?1:Zt,_[A+4>>2]=Ot?0:re,A=0):A=1,re=A,It=Gt,re|0)}function is(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0;nt=It,It=It+288|0,k=nt+264|0,z=nt+96|0,Z=nt,C=Z,L=C+96|0;do _[C>>2]=0,C=C+4|0;while((C|0)<(L|0));return v=O(v,Z)|0,v|0?(M=v,It=nt,M|0):(v=Z,C=_[v>>2]|0,v=_[v+4>>2]|0,Bu(C,v,k)|0,d(C,v,z)|0,_t=+Pt(k,z+8|0),_t=+Mu(+(+Pt(g,A)/(_t*2))),Rt[gn>>3]=_t,v=~~_t>>>0,C=+mi(_t)>=1?_t>0?~~+Su(+ji(_t/4294967296),4294967295)>>>0:~~+Mu((_t-+(~~_t>>>0))/4294967296)>>>0:0,(_[gn+4>>2]&2146435072|0)==2146435072?(M=1,It=nt,M|0):(Z=(v|0)==0&(C|0)==0,_[M>>2]=Z?1:v,_[M+4>>2]=Z?0:C,M=0,It=nt,M|0))}function gp(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0,_[g>>2]=A,_[g+4>>2]=v,_[g+8>>2]=M}function Dg(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0;Ot=A+8|0,_[Ot>>2]=0,Z=+Rt[g>>3],k=+mi(+Z),nt=+Rt[g+8>>3],z=+mi(+nt)/.8660254037844386,k=k+z*.5,v=~~k,g=~~z,k=k-+(v|0),z=z-+(g|0);do if(k<.5)if(k<.3333333333333333)if(_[A>>2]=v,z<(k+1)*.5){_[A+4>>2]=g;break}else{g=g+1|0,_[A+4>>2]=g;break}else if(Zt=1-k,g=(!(z<Zt)&1)+g|0,_[A+4>>2]=g,Zt<=z&z<k*2){v=v+1|0,_[A>>2]=v;break}else{_[A>>2]=v;break}else{if(!(k<.6666666666666666))if(v=v+1|0,_[A>>2]=v,z<k*.5){_[A+4>>2]=g;break}else{g=g+1|0,_[A+4>>2]=g;break}if(z<1-k){if(_[A+4>>2]=g,k*2+-1<z){_[A>>2]=v;break}}else g=g+1|0,_[A+4>>2]=g;v=v+1|0,_[A>>2]=v}while(0);do if(Z<0)if(g&1){_t=(g+1|0)/2|0,_t=Oa(v|0,((v|0)<0)<<31>>31|0,_t|0,((_t|0)<0)<<31>>31|0)|0,v=~~(+(v|0)-((+(_t>>>0)+4294967296*+(Bt()|0))*2+1)),_[A>>2]=v;break}else{_t=(g|0)/2|0,_t=Oa(v|0,((v|0)<0)<<31>>31|0,_t|0,((_t|0)<0)<<31>>31|0)|0,v=~~(+(v|0)-(+(_t>>>0)+4294967296*+(Bt()|0))*2),_[A>>2]=v;break}while(0);_t=A+4|0,nt<0&&(v=v-((g<<1|1|0)/2|0)|0,_[A>>2]=v,g=0-g|0,_[_t>>2]=g),M=g-v|0,(v|0)<0?(C=0-v|0,_[_t>>2]=M,_[Ot>>2]=C,_[A>>2]=0,g=M,v=0):C=0,(g|0)<0&&(v=v-g|0,_[A>>2]=v,C=C-g|0,_[Ot>>2]=C,_[_t>>2]=0,g=0),L=v-C|0,M=g-C|0,(C|0)<0&&(_[A>>2]=L,_[_t>>2]=M,_[Ot>>2]=0,g=M,v=L,C=0),M=(g|0)<(v|0)?g:v,M=(C|0)<(M|0)?C:M,!((M|0)<=0)&&(_[A>>2]=v-M,_[_t>>2]=g-M,_[Ot>>2]=C-M)}function li(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0;A=_[g>>2]|0,k=g+4|0,v=_[k>>2]|0,(A|0)<0&&(v=v-A|0,_[k>>2]=v,L=g+8|0,_[L>>2]=(_[L>>2]|0)-A,_[g>>2]=0,A=0),(v|0)<0?(A=A-v|0,_[g>>2]=A,L=g+8|0,C=(_[L>>2]|0)-v|0,_[L>>2]=C,_[k>>2]=0,v=0):(C=g+8|0,L=C,C=_[C>>2]|0),(C|0)<0&&(A=A-C|0,_[g>>2]=A,v=v-C|0,_[k>>2]=v,_[L>>2]=0,C=0),M=(v|0)<(A|0)?v:A,M=(C|0)<(M|0)?C:M,!((M|0)<=0)&&(_[g>>2]=A-M,_[k>>2]=v-M,_[L>>2]=C-M)}function _r(g,A){g=g|0,A=A|0;var v=0,M=0;M=_[g+8>>2]|0,v=+((_[g+4>>2]|0)-M|0),Rt[A>>3]=+((_[g>>2]|0)-M|0)-v*.5,Rt[A+8>>3]=v*.8660254037844386}function to(g,A,v){g=g|0,A=A|0,v=v|0,_[v>>2]=(_[A>>2]|0)+(_[g>>2]|0),_[v+4>>2]=(_[A+4>>2]|0)+(_[g+4>>2]|0),_[v+8>>2]=(_[A+8>>2]|0)+(_[g+8>>2]|0)}function uf(g,A,v){g=g|0,A=A|0,v=v|0,_[v>>2]=(_[g>>2]|0)-(_[A>>2]|0),_[v+4>>2]=(_[g+4>>2]|0)-(_[A+4>>2]|0),_[v+8>>2]=(_[g+8>>2]|0)-(_[A+8>>2]|0)}function dh(g,A){g=g|0,A=A|0;var v=0,M=0;v=dc(_[g>>2]|0,A)|0,_[g>>2]=v,v=g+4|0,M=dc(_[v>>2]|0,A)|0,_[v>>2]=M,g=g+8|0,A=dc(_[g>>2]|0,A)|0,_[g>>2]=A}function Ga(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0,z=0;k=_[g>>2]|0,z=(k|0)<0,M=(_[g+4>>2]|0)-(z?k:0)|0,L=(M|0)<0,C=(L?0-M|0:0)+((_[g+8>>2]|0)-(z?k:0))|0,v=(C|0)<0,g=v?0:C,A=(L?0:M)-(v?C:0)|0,C=(z?0:k)-(L?M:0)-(v?C:0)|0,v=(A|0)<(C|0)?A:C,v=(g|0)<(v|0)?g:v,M=(v|0)>0,g=g-(M?v:0)|0,A=A-(M?v:0)|0;t:do switch(C-(M?v:0)|0){case 0:switch(A|0){case 0:return z=g|0?(g|0)==1?1:7:0,z|0;case 1:return z=g|0?(g|0)==1?3:7:2,z|0;default:break t}case 1:switch(A|0){case 0:return z=g|0?(g|0)==1?5:7:4,z|0;case 1:{if(!g)g=6;else break t;return g|0}default:break t}default:}while(0);return z=7,z|0}function Xa(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0,z=0;k=g+8|0,C=_[k>>2]|0,L=(_[g>>2]|0)-C|0,z=g+4|0,C=(_[z>>2]|0)-C|0;do if(L>>>0>715827881|C>>>0>715827881){if(v=(L|0)>0,v){if((2147483647-L|0)<(L|0)||(2147483647-(L<<1)|0)<(L|0))return z=1,z|0}else if((-2147483648-L|0)>(L|0)||(-2147483648-(L<<1)|0)>(L|0))return z=1,z|0;if(A=L*3|0,(C|0)>0){if((2147483647-C|0)<(C|0))return z=1,z|0}else if((-2147483648-C|0)>(C|0))return z=1,z|0;if(M=C<<1,(L|0)>-1){if((A|-2147483648|0)>=(C|0))return z=1,z|0}else if((A^-2147483648|0)<(C|0))return z=1,z|0;if(v){if((2147483647-L|0)<(M|0))A=1;else{v=M;break}return A|0}else{if((-2147483648-L|0)>(M|0))A=1;else{v=M;break}return A|0}}else v=C<<1,A=L*3|0;while(0);M=al(+(A-C|0)/7)|0,_[g>>2]=M,C=al(+(v+L|0)/7)|0,_[z>>2]=C,_[k>>2]=0,v=(C|0)<(M|0),A=v?M:C,v=v?C:M;do if((v|0)<0){if((A|0)>0){if((A|-2147483648|0)<(v|0)&((v|0)!=-2147483648&(2147483647-A|0)>=(v|0)))break;dn(23313,22444,355,22455)}if((v|0)==-2147483648|(-2147483648-A|0)>(v|0)&&dn(23313,22444,355,22455),(A|0)>-1){if((A|-2147483648|0)<(v|0))break;dn(23313,22444,355,22455)}else{if((A^-2147483648|0)>=(v|0))break;dn(23313,22444,355,22455)}}while(0);return A=C-M|0,(M|0)<0?(v=0-M|0,_[z>>2]=A,_[k>>2]=v,_[g>>2]=0,M=0):(A=C,v=0),(A|0)<0&&(M=M-A|0,_[g>>2]=M,v=v-A|0,_[k>>2]=v,_[z>>2]=0,A=0),L=M-v|0,C=A-v|0,(v|0)<0?(_[g>>2]=L,_[z>>2]=C,_[k>>2]=0,A=C,C=L,v=0):C=M,M=(A|0)<(C|0)?A:C,M=(v|0)<(M|0)?v:M,(M|0)<=0?(z=0,z|0):(_[g>>2]=C-M,_[z>>2]=A-M,_[k>>2]=v-M,z=0,z|0)}function TA(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0,z=0;k=g+8|0,C=_[k>>2]|0,L=(_[g>>2]|0)-C|0,z=g+4|0,C=(_[z>>2]|0)-C|0;do if(L>>>0>715827881|C>>>0>715827881){if(v=(L|0)>0,v){if((2147483647-L|0)<(L|0))return z=1,z|0}else if((-2147483648-L|0)>(L|0))return z=1,z|0;if(A=L<<1,(C|0)>0){if((2147483647-C|0)<(C|0)||(2147483647-(C<<1)|0)<(C|0))return z=1,z|0}else if((-2147483648-C|0)>(C|0)||(-2147483648-(C<<1)|0)>(C|0))return z=1,z|0;if(M=C*3|0,v){if((2147483647-A|0)<(C|0))return z=1,z|0}else if((-2147483648-A|0)>(C|0))return z=1,z|0;if((C|0)>-1){if((M|-2147483648|0)<(L|0)){v=M;break}else A=1;return A|0}else{if((M^-2147483648|0)<(L|0))A=1;else{v=M;break}return A|0}}else v=C*3|0,A=L<<1;while(0);M=al(+(A+C|0)/7)|0,_[g>>2]=M,C=al(+(v-L|0)/7)|0,_[z>>2]=C,_[k>>2]=0,v=(C|0)<(M|0),A=v?M:C,v=v?C:M;do if((v|0)<0){if((A|0)>0){if((A|-2147483648|0)<(v|0)&((v|0)!=-2147483648&(2147483647-A|0)>=(v|0)))break;dn(23313,22444,404,22469)}if((v|0)==-2147483648|(-2147483648-A|0)>(v|0)&&dn(23313,22444,404,22469),(A|0)>-1){if((A|-2147483648|0)<(v|0))break;dn(23313,22444,404,22469)}else{if((A^-2147483648|0)>=(v|0))break;dn(23313,22444,404,22469)}}while(0);return A=C-M|0,(M|0)<0?(v=0-M|0,_[z>>2]=A,_[k>>2]=v,_[g>>2]=0,M=0):(A=C,v=0),(A|0)<0&&(M=M-A|0,_[g>>2]=M,v=v-A|0,_[k>>2]=v,_[z>>2]=0,A=0),L=M-v|0,C=A-v|0,(v|0)<0?(_[g>>2]=L,_[z>>2]=C,_[k>>2]=0,A=C,C=L,v=0):C=M,M=(A|0)<(C|0)?A:C,M=(v|0)<(M|0)?v:M,(M|0)<=0?(z=0,z|0):(_[g>>2]=C-M,_[z>>2]=A-M,_[k>>2]=v-M,z=0,z|0)}function lr(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0,z=0;k=g+8|0,v=_[k>>2]|0,A=(_[g>>2]|0)-v|0,z=g+4|0,v=(_[z>>2]|0)-v|0,M=al(+((A*3|0)-v|0)/7)|0,_[g>>2]=M,A=al(+((v<<1)+A|0)/7)|0,_[z>>2]=A,_[k>>2]=0,v=A-M|0,(M|0)<0?(L=0-M|0,_[z>>2]=v,_[k>>2]=L,_[g>>2]=0,A=v,M=0,v=L):v=0,(A|0)<0&&(M=M-A|0,_[g>>2]=M,v=v-A|0,_[k>>2]=v,_[z>>2]=0,A=0),L=M-v|0,C=A-v|0,(v|0)<0?(_[g>>2]=L,_[z>>2]=C,_[k>>2]=0,A=C,C=L,v=0):C=M,M=(A|0)<(C|0)?A:C,M=(v|0)<(M|0)?v:M,!((M|0)<=0)&&(_[g>>2]=C-M,_[z>>2]=A-M,_[k>>2]=v-M)}function Vd(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0,z=0;k=g+8|0,v=_[k>>2]|0,A=(_[g>>2]|0)-v|0,z=g+4|0,v=(_[z>>2]|0)-v|0,M=al(+((A<<1)+v|0)/7)|0,_[g>>2]=M,A=al(+((v*3|0)-A|0)/7)|0,_[z>>2]=A,_[k>>2]=0,v=A-M|0,(M|0)<0?(L=0-M|0,_[z>>2]=v,_[k>>2]=L,_[g>>2]=0,A=v,M=0,v=L):v=0,(A|0)<0&&(M=M-A|0,_[g>>2]=M,v=v-A|0,_[k>>2]=v,_[z>>2]=0,A=0),L=M-v|0,C=A-v|0,(v|0)<0?(_[g>>2]=L,_[z>>2]=C,_[k>>2]=0,A=C,C=L,v=0):C=M,M=(A|0)<(C|0)?A:C,M=(v|0)<(M|0)?v:M,!((M|0)<=0)&&(_[g>>2]=C-M,_[z>>2]=A-M,_[k>>2]=v-M)}function mh(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0,z=0;A=_[g>>2]|0,k=g+4|0,v=_[k>>2]|0,z=g+8|0,M=_[z>>2]|0,C=v+(A*3|0)|0,_[g>>2]=C,v=M+(v*3|0)|0,_[k>>2]=v,A=(M*3|0)+A|0,_[z>>2]=A,M=v-C|0,(C|0)<0?(A=A-C|0,_[k>>2]=M,_[z>>2]=A,_[g>>2]=0,v=M,M=0):M=C,(v|0)<0&&(M=M-v|0,_[g>>2]=M,A=A-v|0,_[z>>2]=A,_[k>>2]=0,v=0),L=M-A|0,C=v-A|0,(A|0)<0?(_[g>>2]=L,_[k>>2]=C,_[z>>2]=0,M=L,A=0):C=v,v=(C|0)<(M|0)?C:M,v=(A|0)<(v|0)?A:v,!((v|0)<=0)&&(_[g>>2]=M-v,_[k>>2]=C-v,_[z>>2]=A-v)}function ru(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0,z=0;C=_[g>>2]|0,k=g+4|0,A=_[k>>2]|0,z=g+8|0,v=_[z>>2]|0,M=(A*3|0)+C|0,C=v+(C*3|0)|0,_[g>>2]=C,_[k>>2]=M,A=(v*3|0)+A|0,_[z>>2]=A,v=M-C|0,(C|0)<0?(A=A-C|0,_[k>>2]=v,_[z>>2]=A,_[g>>2]=0,C=0):v=M,(v|0)<0&&(C=C-v|0,_[g>>2]=C,A=A-v|0,_[z>>2]=A,_[k>>2]=0,v=0),L=C-A|0,M=v-A|0,(A|0)<0?(_[g>>2]=L,_[k>>2]=M,_[z>>2]=0,C=L,A=0):M=v,v=(M|0)<(C|0)?M:C,v=(A|0)<(v|0)?A:v,!((v|0)<=0)&&(_[g>>2]=C-v,_[k>>2]=M-v,_[z>>2]=A-v)}function gc(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0,k=0,z=0;(A+-1|0)>>>0>=6||(C=(_[15440+(A*12|0)>>2]|0)+(_[g>>2]|0)|0,_[g>>2]=C,z=g+4|0,M=(_[15440+(A*12|0)+4>>2]|0)+(_[z>>2]|0)|0,_[z>>2]=M,k=g+8|0,A=(_[15440+(A*12|0)+8>>2]|0)+(_[k>>2]|0)|0,_[k>>2]=A,v=M-C|0,(C|0)<0?(A=A-C|0,_[z>>2]=v,_[k>>2]=A,_[g>>2]=0,M=0):(v=M,M=C),(v|0)<0&&(M=M-v|0,_[g>>2]=M,A=A-v|0,_[k>>2]=A,_[z>>2]=0,v=0),L=M-A|0,C=v-A|0,(A|0)<0?(_[g>>2]=L,_[z>>2]=C,_[k>>2]=0,M=L,A=0):C=v,v=(C|0)<(M|0)?C:M,v=(A|0)<(v|0)?A:v,!((v|0)<=0)&&(_[g>>2]=M-v,_[z>>2]=C-v,_[k>>2]=A-v))}function Ia(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0,z=0;C=_[g>>2]|0,k=g+4|0,A=_[k>>2]|0,z=g+8|0,v=_[z>>2]|0,M=A+C|0,C=v+C|0,_[g>>2]=C,_[k>>2]=M,A=v+A|0,_[z>>2]=A,v=M-C|0,(C|0)<0?(A=A-C|0,_[k>>2]=v,_[z>>2]=A,_[g>>2]=0,M=0):(v=M,M=C),(v|0)<0&&(M=M-v|0,_[g>>2]=M,A=A-v|0,_[z>>2]=A,_[k>>2]=0,v=0),L=M-A|0,C=v-A|0,(A|0)<0?(_[g>>2]=L,_[k>>2]=C,_[z>>2]=0,M=L,A=0):C=v,v=(C|0)<(M|0)?C:M,v=(A|0)<(v|0)?A:v,!((v|0)<=0)&&(_[g>>2]=M-v,_[k>>2]=C-v,_[z>>2]=A-v)}function Ah(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0,z=0;A=_[g>>2]|0,k=g+4|0,M=_[k>>2]|0,z=g+8|0,v=_[z>>2]|0,C=M+A|0,_[g>>2]=C,M=v+M|0,_[k>>2]=M,A=v+A|0,_[z>>2]=A,v=M-C|0,(C|0)<0?(A=A-C|0,_[k>>2]=v,_[z>>2]=A,_[g>>2]=0,M=0):(v=M,M=C),(v|0)<0&&(M=M-v|0,_[g>>2]=M,A=A-v|0,_[z>>2]=A,_[k>>2]=0,v=0),L=M-A|0,C=v-A|0,(A|0)<0?(_[g>>2]=L,_[k>>2]=C,_[z>>2]=0,M=L,A=0):C=v,v=(C|0)<(M|0)?C:M,v=(A|0)<(v|0)?A:v,!((v|0)<=0)&&(_[g>>2]=M-v,_[k>>2]=C-v,_[z>>2]=A-v)}function El(g){switch(g=g|0,g|0){case 1:{g=5;break}case 5:{g=4;break}case 4:{g=6;break}case 6:{g=2;break}case 2:{g=3;break}case 3:{g=1;break}default:}return g|0}function os(g){switch(g=g|0,g|0){case 1:{g=3;break}case 3:{g=2;break}case 2:{g=6;break}case 6:{g=4;break}case 4:{g=5;break}case 5:{g=1;break}default:}return g|0}function Ml(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0,z=0;A=_[g>>2]|0,k=g+4|0,v=_[k>>2]|0,z=g+8|0,M=_[z>>2]|0,C=v+(A<<1)|0,_[g>>2]=C,v=M+(v<<1)|0,_[k>>2]=v,A=(M<<1)+A|0,_[z>>2]=A,M=v-C|0,(C|0)<0?(A=A-C|0,_[k>>2]=M,_[z>>2]=A,_[g>>2]=0,v=M,M=0):M=C,(v|0)<0&&(M=M-v|0,_[g>>2]=M,A=A-v|0,_[z>>2]=A,_[k>>2]=0,v=0),L=M-A|0,C=v-A|0,(A|0)<0?(_[g>>2]=L,_[k>>2]=C,_[z>>2]=0,M=L,A=0):C=v,v=(C|0)<(M|0)?C:M,v=(A|0)<(v|0)?A:v,!((v|0)<=0)&&(_[g>>2]=M-v,_[k>>2]=C-v,_[z>>2]=A-v)}function EA(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0,z=0;C=_[g>>2]|0,k=g+4|0,A=_[k>>2]|0,z=g+8|0,v=_[z>>2]|0,M=(A<<1)+C|0,C=v+(C<<1)|0,_[g>>2]=C,_[k>>2]=M,A=(v<<1)+A|0,_[z>>2]=A,v=M-C|0,(C|0)<0?(A=A-C|0,_[k>>2]=v,_[z>>2]=A,_[g>>2]=0,C=0):v=M,(v|0)<0&&(C=C-v|0,_[g>>2]=C,A=A-v|0,_[z>>2]=A,_[k>>2]=0,v=0),L=C-A|0,M=v-A|0,(A|0)<0?(_[g>>2]=L,_[k>>2]=M,_[z>>2]=0,C=L,A=0):M=v,v=(M|0)<(C|0)?M:C,v=(A|0)<(v|0)?A:v,!((v|0)<=0)&&(_[g>>2]=C-v,_[k>>2]=M-v,_[z>>2]=A-v)}function gh(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0,k=0,z=0;return k=(_[g>>2]|0)-(_[A>>2]|0)|0,z=(k|0)<0,M=(_[g+4>>2]|0)-(_[A+4>>2]|0)-(z?k:0)|0,L=(M|0)<0,C=(z?0-k|0:0)+(_[g+8>>2]|0)-(_[A+8>>2]|0)+(L?0-M|0:0)|0,g=(C|0)<0,A=g?0:C,v=(L?0:M)-(g?C:0)|0,C=(z?0:k)-(L?M:0)-(g?C:0)|0,g=(v|0)<(C|0)?v:C,g=(A|0)<(g|0)?A:g,M=(g|0)>0,A=A-(M?g:0)|0,v=v-(M?g:0)|0,g=C-(M?g:0)|0,g=(g|0)>-1?g:0-g|0,v=(v|0)>-1?v:0-v|0,A=(A|0)>-1?A:0-A|0,A=(v|0)>(A|0)?v:A,((g|0)>(A|0)?g:A)|0}function MA(g,A){g=g|0,A=A|0;var v=0;v=_[g+8>>2]|0,_[A>>2]=(_[g>>2]|0)-v,_[A+4>>2]=(_[g+4>>2]|0)-v}function SA(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0,k=0,z=0;M=_[g>>2]|0,_[A>>2]=M,C=_[g+4>>2]|0,k=A+4|0,_[k>>2]=C,z=A+8|0,_[z>>2]=0,v=(C|0)<(M|0),g=v?M:C,v=v?C:M;do if((v|0)<0){if((g|0)>0){if((g|-2147483648|0)<(v|0)&((v|0)!=-2147483648&(2147483647-g|0)>=(v|0)))break;return g=1,g|0}if((v|0)==-2147483648|(-2147483648-g|0)>(v|0))return A=1,A|0;if((g|0)>-1){if((g|-2147483648|0)<(v|0))break;return g=1,g|0}else{if((g^-2147483648|0)<(v|0))g=1;else break;return g|0}}while(0);return g=C-M|0,(M|0)<0?(v=0-M|0,_[k>>2]=g,_[z>>2]=v,_[A>>2]=0,M=0):(g=C,v=0),(g|0)<0&&(M=M-g|0,_[A>>2]=M,v=v-g|0,_[z>>2]=v,_[k>>2]=0,g=0),L=M-v|0,C=g-v|0,(v|0)<0?(_[A>>2]=L,_[k>>2]=C,_[z>>2]=0,g=C,C=L,v=0):C=M,M=(g|0)<(C|0)?g:C,M=(v|0)<(M|0)?v:M,(M|0)<=0?(A=0,A|0):(_[A>>2]=C-M,_[k>>2]=g-M,_[z>>2]=v-M,A=0,A|0)}function Lc(g){g=g|0;var A=0,v=0,M=0,C=0;A=g+8|0,C=_[A>>2]|0,v=C-(_[g>>2]|0)|0,_[g>>2]=v,M=g+4|0,g=(_[M>>2]|0)-C|0,_[M>>2]=g,_[A>>2]=0-(g+v)}function _c(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0,z=0;v=_[g>>2]|0,A=0-v|0,_[g>>2]=A,k=g+8|0,_[k>>2]=0,z=g+4|0,M=_[z>>2]|0,C=M+v|0,(v|0)>0?(_[z>>2]=C,_[k>>2]=v,_[g>>2]=0,A=0,M=C):v=0,(M|0)<0?(L=A-M|0,_[g>>2]=L,v=v-M|0,_[k>>2]=v,_[z>>2]=0,C=L-v|0,A=0-v|0,(v|0)<0?(_[g>>2]=C,_[z>>2]=A,_[k>>2]=0,M=A,v=0):(M=0,C=L)):C=A,A=(M|0)<(C|0)?M:C,A=(v|0)<(A|0)?v:A,!((A|0)<=0)&&(_[g>>2]=C-A,_[z>>2]=M-A,_[k>>2]=v-A)}function Un(g,A,v,M,C){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0;var L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0;if(Ot=It,It=It+64|0,_t=Ot,z=Ot+56|0,!(!0&(A&2013265920|0)==134217728&(!0&(M&2013265920|0)==134217728)))return C=5,It=Ot,C|0;if((g|0)==(v|0)&(A|0)==(M|0))return _[C>>2]=0,C=0,It=Ot,C|0;if(k=Qe(g|0,A|0,52)|0,Bt()|0,k=k&15,nt=Qe(v|0,M|0,52)|0,Bt()|0,(k|0)!=(nt&15|0))return C=12,It=Ot,C|0;if(L=k+-1|0,k>>>0>1){yp(g,A,L,_t)|0,yp(v,M,L,z)|0,nt=_t,Z=_[nt>>2]|0,nt=_[nt+4>>2]|0;t:do if((Z|0)==(_[z>>2]|0)&&(nt|0)==(_[z+4>>2]|0)){k=(k^15)*3|0,L=Qe(g|0,A|0,k|0)|0,Bt()|0,L=L&7,k=Qe(v|0,M|0,k|0)|0,Bt()|0,k=k&7;do if((L|0)==0|(k|0)==0)_[C>>2]=1,L=0;else if((L|0)==7)L=5;else{if((L|0)==1|(k|0)==1&&ii(Z,nt)|0){L=5;break}if((_[15536+(L<<2)>>2]|0)!=(k|0)&&(_[15568+(L<<2)>>2]|0)!=(k|0))break t;_[C>>2]=1,L=0}while(0);return C=L,It=Ot,C|0}while(0)}L=_t,k=L+56|0;do _[L>>2]=0,L=L+4|0;while((L|0)<(k|0));return eu(g,A,1,_t)|0,A=_t,!((_[A>>2]|0)==(v|0)&&(_[A+4>>2]|0)==(M|0))&&(A=_t+8|0,!((_[A>>2]|0)==(v|0)&&(_[A+4>>2]|0)==(M|0)))&&(A=_t+16|0,!((_[A>>2]|0)==(v|0)&&(_[A+4>>2]|0)==(M|0)))&&(A=_t+24|0,!((_[A>>2]|0)==(v|0)&&(_[A+4>>2]|0)==(M|0)))&&(A=_t+32|0,!((_[A>>2]|0)==(v|0)&&(_[A+4>>2]|0)==(M|0)))&&(A=_t+40|0,!((_[A>>2]|0)==(v|0)&&(_[A+4>>2]|0)==(M|0)))?(L=_t+48|0,L=((_[L>>2]|0)==(v|0)?(_[L+4>>2]|0)==(M|0):0)&1):L=1,_[C>>2]=L,C=0,It=Ot,C|0}function Sl(g,A,v,M,C){return g=g|0,A=A|0,v=v|0,M=M|0,C=C|0,v=zt(g,A,v,M)|0,(v|0)==7?(C=11,C|0):(M=xr(v|0,0,56)|0,A=A&-2130706433|(Bt()|0)|268435456,_[C>>2]=g|M,_[C+4>>2]=A,C=0,C|0)}function Oc(g,A,v){return g=g|0,A=A|0,v=v|0,!0&(A&2013265920|0)==268435456?(_[v>>2]=g,_[v+4>>2]=A&-2130706433|134217728,v=0,v|0):(v=6,v|0)}function Us(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0;return C=It,It=It+16|0,M=C,_[M>>2]=0,!0&(A&2013265920|0)==268435456?(L=Qe(g|0,A|0,56)|0,Bt()|0,M=Io(g,A&-2130706433|134217728,L&7,M,v)|0,It=C,M|0):(M=6,It=C,M|0)}function _h(g,A){g=g|0,A=A|0;var v=0;switch(v=Qe(g|0,A|0,56)|0,Bt()|0,v&7){case 0:case 7:return v=0,v|0;default:}return v=A&-2130706433|134217728,!(!0&(A&2013265920|0)==268435456)||!0&(A&117440512|0)==16777216&(ii(g,v)|0)!=0?(v=0,v|0):(v=nu(g,v)|0,v|0)}function Pu(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0;return C=It,It=It+16|0,M=C,!0&(A&2013265920|0)==268435456?(L=A&-2130706433|134217728,k=v,_[k>>2]=g,_[k+4>>2]=L,_[M>>2]=0,A=Qe(g|0,A|0,56)|0,Bt()|0,M=Io(g,L,A&7,M,v+8|0)|0,It=C,M|0):(M=6,It=C,M|0)}function ol(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0;return C=(ii(g,A)|0)==0,A=A&-2130706433,M=v,_[M>>2]=C?g:0,_[M+4>>2]=C?A|285212672:0,M=v+8|0,_[M>>2]=g,_[M+4>>2]=A|301989888,M=v+16|0,_[M>>2]=g,_[M+4>>2]=A|318767104,M=v+24|0,_[M>>2]=g,_[M+4>>2]=A|335544320,M=v+32|0,_[M>>2]=g,_[M+4>>2]=A|352321536,v=v+40|0,_[v>>2]=g,_[v+4>>2]=A|369098752,0}function Es(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0;return k=It,It=It+16|0,C=k,L=A&-2130706433|134217728,!0&(A&2013265920|0)==268435456?(M=Qe(g|0,A|0,56)|0,Bt()|0,M=Pl(g,L,M&7)|0,(M|0)==-1?(_[v>>2]=0,L=6,It=k,L|0):(Ou(g,L,C)|0&&dn(23313,22484,282,22499),A=Qe(g|0,A|0,52)|0,Bt()|0,A=A&15,ii(g,L)|0?yc(C,A,M,2,v):hf(C,A,M,2,v),L=0,It=k,L|0)):(L=6,It=k,L|0)}function _p(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0;M=It,It=It+16|0,C=M,Wr(g,A,v,C),Dg(C,v+4|0),It=M}function Wr(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0,k=0,z=0,Z=0;if(z=It,It=It+16|0,Z=z,Or(g,v,Z),L=+Qs(+(1-+Rt[Z>>3]*.5)),L<1e-16){_[M>>2]=0,_[M+4>>2]=0,_[M+8>>2]=0,_[M+12>>2]=0,It=z;return}if(Z=_[v>>2]|0,C=+Rt[15920+(Z*24|0)>>3],C=+pt(C-+pt(+Ft(15600+(Z<<4)|0,g))),zo(A)|0?k=+pt(C+-.3334731722518321):k=C,C=+Kn(+L)/.381966011250105,(A|0)>0){g=0;do C=C*2.6457513110645907,g=g+1|0;while((g|0)!=(A|0))}L=+Nn(+k)*C,Rt[M>>3]=L,k=+kn(+k)*C,Rt[M+8>>3]=k,It=z}function Or(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0;if(L=It,It=It+32|0,C=L,wp(g,C),_[A>>2]=0,Rt[v>>3]=5,M=+Ki(16400,C),M<+Rt[v>>3]&&(_[A>>2]=0,Rt[v>>3]=M),M=+Ki(16424,C),M<+Rt[v>>3]&&(_[A>>2]=1,Rt[v>>3]=M),M=+Ki(16448,C),M<+Rt[v>>3]&&(_[A>>2]=2,Rt[v>>3]=M),M=+Ki(16472,C),M<+Rt[v>>3]&&(_[A>>2]=3,Rt[v>>3]=M),M=+Ki(16496,C),M<+Rt[v>>3]&&(_[A>>2]=4,Rt[v>>3]=M),M=+Ki(16520,C),M<+Rt[v>>3]&&(_[A>>2]=5,Rt[v>>3]=M),M=+Ki(16544,C),M<+Rt[v>>3]&&(_[A>>2]=6,Rt[v>>3]=M),M=+Ki(16568,C),M<+Rt[v>>3]&&(_[A>>2]=7,Rt[v>>3]=M),M=+Ki(16592,C),M<+Rt[v>>3]&&(_[A>>2]=8,Rt[v>>3]=M),M=+Ki(16616,C),M<+Rt[v>>3]&&(_[A>>2]=9,Rt[v>>3]=M),M=+Ki(16640,C),M<+Rt[v>>3]&&(_[A>>2]=10,Rt[v>>3]=M),M=+Ki(16664,C),M<+Rt[v>>3]&&(_[A>>2]=11,Rt[v>>3]=M),M=+Ki(16688,C),M<+Rt[v>>3]&&(_[A>>2]=12,Rt[v>>3]=M),M=+Ki(16712,C),M<+Rt[v>>3]&&(_[A>>2]=13,Rt[v>>3]=M),M=+Ki(16736,C),M<+Rt[v>>3]&&(_[A>>2]=14,Rt[v>>3]=M),M=+Ki(16760,C),M<+Rt[v>>3]&&(_[A>>2]=15,Rt[v>>3]=M),M=+Ki(16784,C),M<+Rt[v>>3]&&(_[A>>2]=16,Rt[v>>3]=M),M=+Ki(16808,C),M<+Rt[v>>3]&&(_[A>>2]=17,Rt[v>>3]=M),M=+Ki(16832,C),M<+Rt[v>>3]&&(_[A>>2]=18,Rt[v>>3]=M),M=+Ki(16856,C),!(M<+Rt[v>>3])){It=L;return}_[A>>2]=19,Rt[v>>3]=M,It=L}function Iu(g,A,v,M,C){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0;var L=0,k=0;if(L=+Nu(g),L<1e-16){A=15600+(A<<4)|0,_[C>>2]=_[A>>2],_[C+4>>2]=_[A+4>>2],_[C+8>>2]=_[A+8>>2],_[C+12>>2]=_[A+12>>2];return}if(k=+Fo(+ +Rt[g+8>>3],+ +Rt[g>>3]),(v|0)>0){g=0;do L=L/2.6457513110645907,g=g+1|0;while((g|0)!=(v|0))}M?(L=L/3,v=(zo(v)|0)==0,L=+Fs(+((v?L:L/2.6457513110645907)*.381966011250105))):(L=+Fs(+(L*.381966011250105)),zo(v)|0&&(k=+pt(k+.3334731722518321))),Yt(15600+(A<<4)|0,+pt(+Rt[15920+(A*24|0)>>3]-k),L,C)}function Aa(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0;M=It,It=It+16|0,C=M,_r(g+4|0,C),Iu(C,_[g>>2]|0,A,0,v),It=M}function yc(g,A,v,M,C){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0;var L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0,ke=0,Be=0,xe=0,Se=0,pe=0,Ir=0,Lr=0,Er=0,Br=0,Zi=0,Ii=0,Ri=0,In=0,Hn=0,Qn=0,eo=0,Rn=0;if(Qn=It,It=It+272|0,L=Qn+256|0,xe=Qn+240|0,Ri=Qn,In=Qn+224|0,Hn=Qn+208|0,Se=Qn+176|0,pe=Qn+160|0,Ir=Qn+192|0,Lr=Qn+144|0,Er=Qn+128|0,Br=Qn+112|0,Zi=Qn+96|0,Ii=Qn+80|0,_[L>>2]=A,_[xe>>2]=_[g>>2],_[xe+4>>2]=_[g+4>>2],_[xe+8>>2]=_[g+8>>2],_[xe+12>>2]=_[g+12>>2],Ms(xe,L,Ri),_[C>>2]=0,xe=M+v+((M|0)==5&1)|0,(xe|0)<=(v|0)){It=Qn;return}Z=_[L>>2]|0,nt=In+4|0,_t=Se+4|0,Ot=v+5|0,Zt=16880+(Z<<2)|0,re=16960+(Z<<2)|0,Gt=Er+8|0,me=Br+8|0,ke=Zi+8|0,Be=Hn+4|0,z=v;t:for(;;){k=Ri+(((z|0)%5|0)<<4)|0,_[Hn>>2]=_[k>>2],_[Hn+4>>2]=_[k+4>>2],_[Hn+8>>2]=_[k+8>>2],_[Hn+12>>2]=_[k+12>>2];do;while((Ra(Hn,Z,0,1)|0)==2);if((z|0)>(v|0)&(zo(A)|0)!=0){if(_[Se>>2]=_[Hn>>2],_[Se+4>>2]=_[Hn+4>>2],_[Se+8>>2]=_[Hn+8>>2],_[Se+12>>2]=_[Hn+12>>2],_r(nt,pe),M=_[Se>>2]|0,L=_[17040+(M*80|0)+(_[In>>2]<<2)>>2]|0,_[Se>>2]=_[18640+(M*80|0)+(L*20|0)>>2],k=_[18640+(M*80|0)+(L*20|0)+16>>2]|0,(k|0)>0){g=0;do Ia(_t),g=g+1|0;while((g|0)<(k|0))}switch(k=18640+(M*80|0)+(L*20|0)+4|0,_[Ir>>2]=_[k>>2],_[Ir+4>>2]=_[k+4>>2],_[Ir+8>>2]=_[k+8>>2],dh(Ir,(_[Zt>>2]|0)*3|0),to(_t,Ir,_t),li(_t),_r(_t,Lr),eo=+(_[re>>2]|0),Rt[Er>>3]=eo*3,Rt[Gt>>3]=0,Rn=eo*-1.5,Rt[Br>>3]=Rn,Rt[me>>3]=eo*2.598076211353316,Rt[Zi>>3]=Rn,Rt[ke>>3]=eo*-2.598076211353316,_[17040+((_[Se>>2]|0)*80|0)+(_[Hn>>2]<<2)>>2]|0){case 1:{g=Br,M=Er;break}case 3:{g=Zi,M=Br;break}case 2:{g=Er,M=Zi;break}default:{g=12;break t}}xh(pe,Lr,M,g,Ii),Iu(Ii,_[Se>>2]|0,Z,1,C+8+(_[C>>2]<<4)|0),_[C>>2]=(_[C>>2]|0)+1}if((z|0)<(Ot|0)&&(_r(Be,Se),Iu(Se,_[Hn>>2]|0,Z,1,C+8+(_[C>>2]<<4)|0),_[C>>2]=(_[C>>2]|0)+1),_[In>>2]=_[Hn>>2],_[In+4>>2]=_[Hn+4>>2],_[In+8>>2]=_[Hn+8>>2],_[In+12>>2]=_[Hn+12>>2],z=z+1|0,(z|0)>=(xe|0)){g=3;break}}if((g|0)==3){It=Qn;return}else(g|0)==12&&dn(22522,22569,571,22579)}function Ms(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0,z=0,Z=0;Z=It,It=It+128|0,M=Z+64|0,C=Z,L=M,k=20240,z=L+60|0;do _[L>>2]=_[k>>2],L=L+4|0,k=k+4|0;while((L|0)<(z|0));L=C,k=20304,z=L+60|0;do _[L>>2]=_[k>>2],L=L+4|0,k=k+4|0;while((L|0)<(z|0));z=(zo(_[A>>2]|0)|0)==0,M=z?M:C,C=g+4|0,Ml(C),EA(C),zo(_[A>>2]|0)|0&&(ru(C),_[A>>2]=(_[A>>2]|0)+1),_[v>>2]=_[g>>2],A=v+4|0,to(C,M,A),li(A),_[v+16>>2]=_[g>>2],A=v+20|0,to(C,M+12|0,A),li(A),_[v+32>>2]=_[g>>2],A=v+36|0,to(C,M+24|0,A),li(A),_[v+48>>2]=_[g>>2],A=v+52|0,to(C,M+36|0,A),li(A),_[v+64>>2]=_[g>>2],v=v+68|0,to(C,M+48|0,v),li(v),It=Z}function Ra(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0;if(Gt=It,It=It+32|0,Zt=Gt+12|0,z=Gt,re=g+4|0,Ot=_[16960+(A<<2)>>2]|0,_t=(M|0)!=0,Ot=_t?Ot*3|0:Ot,C=_[re>>2]|0,nt=g+8|0,k=_[nt>>2]|0,_t){if(L=g+12|0,M=_[L>>2]|0,C=k+C+M|0,(C|0)==(Ot|0))return re=1,It=Gt,re|0;Z=L}else Z=g+12|0,M=_[Z>>2]|0,C=k+C+M|0;if((C|0)<=(Ot|0))return re=0,It=Gt,re|0;do if((M|0)>0){if(M=_[g>>2]|0,(k|0)>0){L=18640+(M*80|0)+60|0,M=g;break}M=18640+(M*80|0)+40|0,v?(gp(Zt,Ot,0,0),uf(re,Zt,z),Ah(z),to(z,Zt,re),L=M,M=g):(L=M,M=g)}else L=18640+((_[g>>2]|0)*80|0)+20|0,M=g;while(0);if(_[M>>2]=_[L>>2],C=L+16|0,(_[C>>2]|0)>0){M=0;do Ia(re),M=M+1|0;while((M|0)<(_[C>>2]|0))}return g=L+4|0,_[Zt>>2]=_[g>>2],_[Zt+4>>2]=_[g+4>>2],_[Zt+8>>2]=_[g+8>>2],A=_[16880+(A<<2)>>2]|0,dh(Zt,_t?A*3|0:A),to(re,Zt,re),li(re),_t?M=((_[nt>>2]|0)+(_[re>>2]|0)+(_[Z>>2]|0)|0)==(Ot|0)?1:2:M=2,re=M,It=Gt,re|0}function CA(g,A){g=g|0,A=A|0;var v=0;do v=Ra(g,A,0,1)|0;while((v|0)==2);return v|0}function hf(g,A,v,M,C){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0;var L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0,ke=0,Be=0,xe=0,Se=0,pe=0,Ir=0,Lr=0,Er=0,Br=0,Zi=0,Ii=0,Ri=0;if(Zi=It,It=It+240|0,L=Zi+224|0,Ir=Zi+208|0,Lr=Zi,Er=Zi+192|0,Br=Zi+176|0,ke=Zi+160|0,Be=Zi+144|0,xe=Zi+128|0,Se=Zi+112|0,pe=Zi+96|0,_[L>>2]=A,_[Ir>>2]=_[g>>2],_[Ir+4>>2]=_[g+4>>2],_[Ir+8>>2]=_[g+8>>2],_[Ir+12>>2]=_[g+12>>2],vi(Ir,L,Lr),_[C>>2]=0,me=M+v+((M|0)==6&1)|0,(me|0)<=(v|0)){It=Zi;return}Z=_[L>>2]|0,nt=v+6|0,_t=16960+(Z<<2)|0,Ot=Be+8|0,Zt=xe+8|0,re=Se+8|0,Gt=Er+4|0,k=0,z=v,M=-1;t:for(;;){if(L=(z|0)%6|0,g=Lr+(L<<4)|0,_[Er>>2]=_[g>>2],_[Er+4>>2]=_[g+4>>2],_[Er+8>>2]=_[g+8>>2],_[Er+12>>2]=_[g+12>>2],g=k,k=Ra(Er,Z,0,1)|0,(z|0)>(v|0)&(zo(A)|0)!=0&&(g|0)!=1&&(_[Er>>2]|0)!=(M|0)){switch(_r(Lr+(((L+5|0)%6|0)<<4)+4|0,Br),_r(Lr+(L<<4)+4|0,ke),Ii=+(_[_t>>2]|0),Rt[Be>>3]=Ii*3,Rt[Ot>>3]=0,Ri=Ii*-1.5,Rt[xe>>3]=Ri,Rt[Zt>>3]=Ii*2.598076211353316,Rt[Se>>3]=Ri,Rt[re>>3]=Ii*-2.598076211353316,L=_[Ir>>2]|0,_[17040+(L*80|0)+(((M|0)==(L|0)?_[Er>>2]|0:M)<<2)>>2]|0){case 1:{g=xe,M=Be;break}case 3:{g=Se,M=xe;break}case 2:{g=Be,M=Se;break}default:{g=8;break t}}xh(Br,ke,M,g,pe),!(gf(Br,pe)|0)&&!(gf(ke,pe)|0)&&(Iu(pe,_[Ir>>2]|0,Z,1,C+8+(_[C>>2]<<4)|0),_[C>>2]=(_[C>>2]|0)+1)}if((z|0)<(nt|0)&&(_r(Gt,Br),Iu(Br,_[Er>>2]|0,Z,1,C+8+(_[C>>2]<<4)|0),_[C>>2]=(_[C>>2]|0)+1),z=z+1|0,(z|0)>=(me|0)){g=3;break}else M=_[Er>>2]|0}if((g|0)==3){It=Zi;return}else(g|0)==8&&dn(22606,22569,736,22651)}function vi(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0,z=0,Z=0;Z=It,It=It+160|0,M=Z+80|0,C=Z,L=M,k=20368,z=L+72|0;do _[L>>2]=_[k>>2],L=L+4|0,k=k+4|0;while((L|0)<(z|0));L=C,k=20448,z=L+72|0;do _[L>>2]=_[k>>2],L=L+4|0,k=k+4|0;while((L|0)<(z|0));z=(zo(_[A>>2]|0)|0)==0,M=z?M:C,C=g+4|0,Ml(C),EA(C),zo(_[A>>2]|0)|0&&(ru(C),_[A>>2]=(_[A>>2]|0)+1),_[v>>2]=_[g>>2],A=v+4|0,to(C,M,A),li(A),_[v+16>>2]=_[g>>2],A=v+20|0,to(C,M+12|0,A),li(A),_[v+32>>2]=_[g>>2],A=v+36|0,to(C,M+24|0,A),li(A),_[v+48>>2]=_[g>>2],A=v+52|0,to(C,M+36|0,A),li(A),_[v+64>>2]=_[g>>2],A=v+68|0,to(C,M+48|0,A),li(A),_[v+80>>2]=_[g>>2],v=v+84|0,to(C,M+60|0,v),li(v),It=Z}function Ss(g,A){return g=g|0,A=A|0,A=Qe(g|0,A|0,52)|0,Bt()|0,A&15|0}function PA(g,A){return g=g|0,A=A|0,A=Qe(g|0,A|0,45)|0,Bt()|0,A&127|0}function nu(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0,k=0,z=0;if(!(!0&(A&-16777216|0)==134217728)||(k=Qe(g|0,A|0,45)|0,Bt()|0,k=k&127,k>>>0>121))return A=0,A|0;v=Qe(g|0,A|0,52)|0,Bt()|0,v=v&15;do if(v|0){for(C=1,M=0;;){if(L=Qe(g|0,A|0,(15-C|0)*3|0)|0,Bt()|0,L=L&7,(L|0)!=0&(M^1))if((L|0)==1&(pr(k)|0)!=0){z=0,M=13;break}else M=1;if((L|0)==7){z=0,M=13;break}if(C>>>0<v>>>0)C=C+1|0;else{M=9;break}}if((M|0)==9){if((v|0)==15)z=1;else break;return z|0}else if((M|0)==13)return z|0}while(0);for(;;){if(z=Qe(g|0,A|0,(14-v|0)*3|0)|0,Bt()|0,!((z&7|0)==7&!0)){z=0,M=13;break}if(v>>>0<14)v=v+1|0;else{z=1,M=13;break}}return(M|0)==13?z|0:0}function yp(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0;if(L=Qe(g|0,A|0,52)|0,Bt()|0,L=L&15,v>>>0>15)return M=4,M|0;if((L|0)<(v|0))return M=12,M|0;if((L|0)==(v|0))return _[M>>2]=g,_[M+4>>2]=A,M=0,M|0;if(C=xr(v|0,0,52)|0,C=C|g,g=Bt()|0|A&-15728641,(L|0)>(v|0))do A=xr(7,0,(14-v|0)*3|0)|0,v=v+1|0,C=A|C,g=Bt()|0|g;while((v|0)<(L|0));return _[M>>2]=C,_[M+4>>2]=g,M=0,M|0}function Bc(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0,k=0;if(L=Qe(g|0,A|0,52)|0,Bt()|0,L=L&15,!((v|0)<16&(L|0)<=(v|0)))return M=4,M|0;C=v-L|0,v=Qe(g|0,A|0,45)|0,Bt()|0;t:do if(!(pr(v&127)|0))v=Fi(7,0,C,((C|0)<0)<<31>>31)|0,C=Bt()|0;else{e:do if(L|0){for(v=1;k=xr(7,0,(15-v|0)*3|0)|0,!!((k&g|0)==0&((Bt()|0)&A|0)==0);)if(v>>>0<L>>>0)v=v+1|0;else break e;v=Fi(7,0,C,((C|0)<0)<<31>>31)|0,C=Bt()|0;break t}while(0);v=Fi(7,0,C,((C|0)<0)<<31>>31)|0,v=ya(v|0,Bt()|0,5,0)|0,v=ui(v|0,Bt()|0,-5,-1)|0,v=Ep(v|0,Bt()|0,6,0)|0,v=ui(v|0,Bt()|0,1,0)|0,C=Bt()|0}while(0);return k=M,_[k>>2]=v,_[k+4>>2]=C,k=0,k|0}function ii(g,A){g=g|0,A=A|0;var v=0,M=0,C=0;if(C=Qe(g|0,A|0,45)|0,Bt()|0,!(pr(C&127)|0))return C=0,C|0;C=Qe(g|0,A|0,52)|0,Bt()|0,C=C&15;t:do if(!C)v=0;else for(M=1;;){if(v=Qe(g|0,A|0,(15-M|0)*3|0)|0,Bt()|0,v=v&7,v|0)break t;if(M>>>0<C>>>0)M=M+1|0;else{v=0;break}}while(0);return C=(v|0)==0&1,C|0}function ff(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0,k=0,z=0;if(k=It,It=It+16|0,L=k,K(L,g,A,v),A=L,g=_[A>>2]|0,A=_[A+4>>2]|0,(g|0)==0&(A|0)==0)return It=k,0;C=0,v=0;do z=M+(C<<3)|0,_[z>>2]=g,_[z+4>>2]=A,C=ui(C|0,v|0,1,0)|0,v=Bt()|0,it(L),z=L,g=_[z>>2]|0,A=_[z+4>>2]|0;while(!((g|0)==0&(A|0)==0));return It=k,0}function Cl(g,A,v,M){return g=g|0,A=A|0,v=v|0,M=M|0,(M|0)<(v|0)?(v=A,M=g,pn(v|0),M|0):(v=xr(-1,-1,((M-v|0)*3|0)+3|0)|0,M=xr(~v|0,~(Bt()|0)|0,(15-M|0)*3|0)|0,v=~(Bt()|0)&A,M=~M&g,pn(v|0),M|0)}function jd(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0;return C=Qe(g|0,A|0,52)|0,Bt()|0,C=C&15,(v|0)<16&(C|0)<=(v|0)?((C|0)<(v|0)&&(C=xr(-1,-1,((v+-1-C|0)*3|0)+3|0)|0,C=xr(~C|0,~(Bt()|0)|0,(15-v|0)*3|0)|0,A=~(Bt()|0)&A,g=~C&g),C=xr(v|0,0,52)|0,v=A&-15728641|(Bt()|0),_[M>>2]=g|C,_[M+4>>2]=v,M=0,M|0):(M=4,M|0)}function pf(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0,ke=0,Be=0,xe=0,Se=0,pe=0,Ir=0,Lr=0,Er=0,Br=0;if((v|0)==0&(M|0)==0)return Er=0,Er|0;if(C=g,L=_[C>>2]|0,C=_[C+4>>2]|0,!0&(C&15728640|0)==0){if(!((M|0)>0|(M|0)==0&v>>>0>0)||(Er=A,_[Er>>2]=L,_[Er+4>>2]=C,(v|0)==1&(M|0)==0))return Er=0,Er|0;C=1;do Ir=g+(C<<3)|0,Lr=_[Ir+4>>2]|0,Er=A+(C<<3)|0,_[Er>>2]=_[Ir>>2],_[Er+4>>2]=Lr,C=C+1|0;while(0<(M|0)|(M|0)==0&C>>>0<v>>>0);return C=0,C|0}if(pe=v<<3,Lr=Il(pe)|0,!Lr)return Er=13,Er|0;if(Ug(Lr|0,g|0,pe|0)|0,Ir=Vo(v,8)|0,!Ir)return vn(Lr),Er=13,Er|0;t:do if(v|0){e:for(;;){C=Lr,Be=_[C>>2]|0,C=_[C+4>>2]|0,xe=Qe(Be|0,C|0,52)|0,Bt()|0,xe=xe&15,Se=xe+-1|0,ke=(v|0)>0;r:do if((xe|0)!=0&ke){if(re=((v|0)<0)<<31>>31,Gt=xr(Se|0,0,52)|0,me=Bt()|0,Se>>>0>15){if(!((Be|0)==0&(C|0)==0)){Er=17;break e}for(L=0;;){if(L=L+1|0,(L|0)>=(v|0))break r;if(M=Lr+(L<<3)|0,me=_[M>>2]|0,M=_[M+4>>2]|0,!((me|0)==0&(M|0)==0)){C=M,Er=17;break e}}}for(L=0,g=Be,M=C;;){if(!((g|0)==0&(M|0)==0)){if(!(!0&(M&117440512|0)==0)){Er=22;break e}if(z=Qe(g|0,M|0,52)|0,Bt()|0,z=z&15,(z|0)<(Se|0)){C=12,Er=28;break e}if((z|0)!=(Se|0)&&(g=g|Gt,M=M&-15728641|me,z>>>0>=xe>>>0)){k=Se;do Zt=xr(7,0,(14-k|0)*3|0)|0,k=k+1|0,g=Zt|g,M=Bt()|0|M;while(k>>>0<z>>>0)}if(k=bh(g|0,M|0,v|0,re|0)|0,Bt()|0,nt=Ir+(k<<3)|0,z=nt,Z=_[z>>2]|0,z=_[z+4>>2]|0,(Z|0)==0&(z|0)==0)k=nt;else for(Zt=0;;){if((Zt|0)>(v|0)){Er=32;break e}if((Z|0)==(g|0)&(z&-117440513|0)==(M|0)){_t=Qe(Z|0,z|0,56)|0,Bt()|0,_t=_t&7,Ot=_t+1|0,Br=Qe(Z|0,z|0,45)|0,Bt()|0;n:do if(!(pr(Br&127)|0))z=7;else{if(Z=Qe(Z|0,z|0,52)|0,Bt()|0,Z=Z&15,!Z){z=6;break}for(z=1;;){if(Br=xr(7,0,(15-z|0)*3|0)|0,!((Br&g|0)==0&((Bt()|0)&M|0)==0)){z=7;break n}if(z>>>0<Z>>>0)z=z+1|0;else{z=6;break}}}while(0);if((_t+2|0)>>>0>z>>>0){Er=42;break e}Br=xr(Ot|0,0,56)|0,M=Bt()|0|M&-117440513,Ot=nt,_[Ot>>2]=0,_[Ot+4>>2]=0,g=Br|g}else k=(k+1|0)%(v|0)|0;if(nt=Ir+(k<<3)|0,z=nt,Z=_[z>>2]|0,z=_[z+4>>2]|0,(Z|0)==0&(z|0)==0){k=nt;break}else Zt=Zt+1|0}Br=k,_[Br>>2]=g,_[Br+4>>2]=M}if(L=L+1|0,(L|0)>=(v|0))break r;M=Lr+(L<<3)|0,g=_[M>>2]|0,M=_[M+4>>2]|0}}while(0);if((v+5|0)>>>0<11){Er=85;break}if(me=Vo((v|0)/6|0,8)|0,!me){Er=49;break}r:do if(ke){Zt=0,Ot=0;do{if(z=Ir+(Zt<<3)|0,M=z,L=_[M>>2]|0,M=_[M+4>>2]|0,!((L|0)==0&(M|0)==0)){Z=Qe(L|0,M|0,56)|0,Bt()|0,Z=Z&7,g=Z+1|0,nt=M&-117440513,Br=Qe(L|0,M|0,45)|0,Bt()|0;n:do if(pr(Br&127)|0){if(_t=Qe(L|0,M|0,52)|0,Bt()|0,_t=_t&15,_t|0)for(k=1;;){if(Br=xr(7,0,(15-k|0)*3|0)|0,!((L&Br|0)==0&(nt&(Bt()|0)|0)==0))break n;if(k>>>0<_t>>>0)k=k+1|0;else break}M=xr(g|0,0,56)|0,L=M|L,M=Bt()|0|nt,g=z,_[g>>2]=L,_[g+4>>2]=M,g=Z+2|0}while(0);(g|0)==7&&(Br=me+(Ot<<3)|0,_[Br>>2]=L,_[Br+4>>2]=M&-117440513,Ot=Ot+1|0)}Zt=Zt+1|0}while((Zt|0)!=(v|0));if(ke){if(Zt=((v|0)<0)<<31>>31,re=xr(Se|0,0,52)|0,Gt=Bt()|0,Se>>>0>15){if(!((Be|0)==0&(C|0)==0)){C=4,Er=84;break e}for(C=0;;){if(C=C+1|0,(C|0)>=(v|0)){L=0,C=Ot;break r}if(Br=Lr+(C<<3)|0,!((_[Br>>2]|0)==0&(_[Br+4>>2]|0)==0)){C=4,Er=84;break e}}}for(_t=0,L=0,nt=Be;;){do if(!((nt|0)==0&(C|0)==0)){if(z=Qe(nt|0,C|0,52)|0,Bt()|0,z=z&15,(z|0)<(Se|0)){C=12,Er=84;break e}do if((z|0)==(Se|0))M=nt,z=C;else{if(M=nt|re,g=C&-15728641|Gt,z>>>0<xe>>>0){z=g;break}k=Se;do Br=xr(7,0,(14-k|0)*3|0)|0,k=k+1|0,M=Br|M,g=Bt()|0|g;while(k>>>0<z>>>0);z=g}while(0);for(k=bh(M|0,z|0,v|0,Zt|0)|0,Bt()|0,g=0;;){if((g|0)>(v|0)){Er=77;break e}if(Br=Ir+(k<<3)|0,Z=_[Br+4>>2]|0,(Z&-117440513|0)==(z|0)&&(_[Br>>2]|0)==(M|0)){Er=79;break}if(k=(k+1|0)%(v|0)|0,Br=Ir+(k<<3)|0,(_[Br>>2]|0)==(M|0)&&(_[Br+4>>2]|0)==(z|0))break;g=g+1|0}if((Er|0)==79&&(Er=0,!0&(Z&117440512|0)==100663296))break;Br=A+(L<<3)|0,_[Br>>2]=nt,_[Br+4>>2]=C,L=L+1|0}while(0);if(C=_t+1|0,(C|0)>=(v|0)){C=Ot;break r}Br=Lr+(C<<3)|0,_t=C,nt=_[Br>>2]|0,C=_[Br+4>>2]|0}}else L=0,C=Ot}else L=0,C=0;while(0);if(Mp(Ir|0,0,pe|0)|0,Ug(Lr|0,me|0,C<<3|0)|0,vn(me),C)A=A+(L<<3)|0,v=C;else break t}if((Er|0)==17)!0&(C&117440512|0)==0?(C=4,Er=28):Er=22;else if((Er|0)==32)dn(23313,22674,362,22684);else{if((Er|0)==42)return vn(Lr),vn(Ir),Br=10,Br|0;if((Er|0)==49)return vn(Lr),vn(Ir),Br=13,Br|0;if((Er|0)==77)dn(23313,22674,462,22684);else{if((Er|0)==84)return vn(me),vn(Lr),vn(Ir),Br=C,Br|0;if((Er|0)==85){Ug(A|0,Lr|0,v<<3|0)|0;break}}}if((Er|0)==22)return vn(Lr),vn(Ir),Br=5,Br|0;if((Er|0)==28)return vn(Lr),vn(Ir),Br=C,Br|0}while(0);return vn(Lr),vn(Ir),Br=0,Br|0}function xp(g,A,v,M,C,L,k){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0,L=L|0,k=k|0;var z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0;if(me=It,It=It+16|0,Gt=me,!((v|0)>0|(v|0)==0&A>>>0>0))return Gt=0,It=me,Gt|0;if((k|0)>=16)return Gt=12,It=me,Gt|0;Zt=0,re=0,Ot=0,z=0;t:for(;;){if(nt=g+(Zt<<3)|0,Z=_[nt>>2]|0,nt=_[nt+4>>2]|0,_t=Qe(Z|0,nt|0,52)|0,Bt()|0,(_t&15|0)>(k|0)){z=12,Z=11;break}if(K(Gt,Z,nt,k),_t=Gt,nt=_[_t>>2]|0,_t=_[_t+4>>2]|0,(nt|0)==0&(_t|0)==0)Z=Ot;else{Z=Ot;do{if(!((z|0)<(L|0)|(z|0)==(L|0)&Z>>>0<C>>>0)){Z=10;break t}Ot=M+(Z<<3)|0,_[Ot>>2]=nt,_[Ot+4>>2]=_t,Z=ui(Z|0,z|0,1,0)|0,z=Bt()|0,it(Gt),Ot=Gt,nt=_[Ot>>2]|0,_t=_[Ot+4>>2]|0}while(!((nt|0)==0&(_t|0)==0))}if(Zt=ui(Zt|0,re|0,1,0)|0,re=Bt()|0,(re|0)<(v|0)|(re|0)==(v|0)&Zt>>>0<A>>>0)Ot=Z;else{z=0,Z=11;break}}return(Z|0)==10?(Gt=14,It=me,Gt|0):(Z|0)==11?(It=me,z|0):0}function IA(g,A,v,M,C){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0;var L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0;Zt=It,It=It+16|0,Ot=Zt;t:do if((v|0)>0|(v|0)==0&A>>>0>0){for(nt=0,k=0,L=0,_t=0;;){if(Z=g+(nt<<3)|0,z=_[Z>>2]|0,Z=_[Z+4>>2]|0,!((z|0)==0&(Z|0)==0)&&(Z=(Bc(z,Z,M,Ot)|0)==0,z=Ot,k=ui(_[z>>2]|0,_[z+4>>2]|0,k|0,L|0)|0,L=Bt()|0,!Z)){L=12;break}if(nt=ui(nt|0,_t|0,1,0)|0,_t=Bt()|0,!((_t|0)<(v|0)|(_t|0)==(v|0)&nt>>>0<A>>>0))break t}return It=Zt,L|0}else k=0,L=0;while(0);return _[C>>2]=k,_[C+4>>2]=L,C=0,It=Zt,C|0}function df(g,A){return g=g|0,A=A|0,A=Qe(g|0,A|0,52)|0,Bt()|0,A&1|0}function As(g,A){g=g|0,A=A|0;var v=0,M=0,C=0;if(C=Qe(g|0,A|0,52)|0,Bt()|0,C=C&15,!C)return C=0,C|0;for(M=1;;){if(v=Qe(g|0,A|0,(15-M|0)*3|0)|0,Bt()|0,v=v&7,v|0){M=5;break}if(M>>>0<C>>>0)M=M+1|0;else{v=0,M=5;break}}return(M|0)==5?v|0:0}function vp(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0,k=0,z=0,Z=0;if(Z=Qe(g|0,A|0,52)|0,Bt()|0,Z=Z&15,!Z)return z=A,Z=g,pn(z|0),Z|0;for(z=1,v=0;;){L=(15-z|0)*3|0,M=xr(7,0,L|0)|0,C=Bt()|0,k=Qe(g|0,A|0,L|0)|0,Bt()|0,L=xr(El(k&7)|0,0,L|0)|0,k=Bt()|0,g=L|g&~M,A=k|A&~C;t:do if(!v)if((L&M|0)==0&(k&C|0)==0)v=0;else if(M=Qe(g|0,A|0,52)|0,Bt()|0,M=M&15,!M)v=1;else{v=1;e:for(;;){switch(k=Qe(g|0,A|0,(15-v|0)*3|0)|0,Bt()|0,k&7){case 1:break e;case 0:break;default:{v=1;break t}}if(v>>>0<M>>>0)v=v+1|0;else{v=1;break t}}for(v=1;;)if(k=(15-v|0)*3|0,C=Qe(g|0,A|0,k|0)|0,Bt()|0,L=xr(7,0,k|0)|0,A=A&~(Bt()|0),k=xr(El(C&7)|0,0,k|0)|0,g=g&~L|k,A=A|(Bt()|0),v>>>0<M>>>0)v=v+1|0;else{v=1;break}}while(0);if(z>>>0<Z>>>0)z=z+1|0;else break}return pn(A|0),g|0}function Ya(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0,k=0;if(M=Qe(g|0,A|0,52)|0,Bt()|0,M=M&15,!M)return v=A,M=g,pn(v|0),M|0;for(v=1;L=(15-v|0)*3|0,k=Qe(g|0,A|0,L|0)|0,Bt()|0,C=xr(7,0,L|0)|0,A=A&~(Bt()|0),L=xr(El(k&7)|0,0,L|0)|0,g=L|g&~C,A=Bt()|0|A,v>>>0<M>>>0;)v=v+1|0;return pn(A|0),g|0}function Ru(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0,k=0,z=0,Z=0;if(Z=Qe(g|0,A|0,52)|0,Bt()|0,Z=Z&15,!Z)return z=A,Z=g,pn(z|0),Z|0;for(z=1,v=0;;){L=(15-z|0)*3|0,M=xr(7,0,L|0)|0,C=Bt()|0,k=Qe(g|0,A|0,L|0)|0,Bt()|0,L=xr(os(k&7)|0,0,L|0)|0,k=Bt()|0,g=L|g&~M,A=k|A&~C;t:do if(!v)if((L&M|0)==0&(k&C|0)==0)v=0;else if(M=Qe(g|0,A|0,52)|0,Bt()|0,M=M&15,!M)v=1;else{v=1;e:for(;;){switch(k=Qe(g|0,A|0,(15-v|0)*3|0)|0,Bt()|0,k&7){case 1:break e;case 0:break;default:{v=1;break t}}if(v>>>0<M>>>0)v=v+1|0;else{v=1;break t}}for(v=1;;)if(C=(15-v|0)*3|0,L=xr(7,0,C|0)|0,k=A&~(Bt()|0),A=Qe(g|0,A|0,C|0)|0,Bt()|0,A=xr(os(A&7)|0,0,C|0)|0,g=g&~L|A,A=k|(Bt()|0),v>>>0<M>>>0)v=v+1|0;else{v=1;break}}while(0);if(z>>>0<Z>>>0)z=z+1|0;else break}return pn(A|0),g|0}function mf(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0,k=0;if(M=Qe(g|0,A|0,52)|0,Bt()|0,M=M&15,!M)return v=A,M=g,pn(v|0),M|0;for(v=1;k=(15-v|0)*3|0,L=xr(7,0,k|0)|0,C=A&~(Bt()|0),A=Qe(g|0,A|0,k|0)|0,Bt()|0,A=xr(os(A&7)|0,0,k|0)|0,g=A|g&~L,A=Bt()|0|C,v>>>0<M>>>0;)v=v+1|0;return pn(A|0),g|0}function Lu(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0;if(Z=It,It=It+64|0,z=Z+40|0,M=Z+24|0,C=Z+12|0,L=Z,xr(A|0,0,52)|0,v=Bt()|0|134225919,!A)return(_[g+4>>2]|0)>2||(_[g+8>>2]|0)>2||(_[g+12>>2]|0)>2?(k=0,z=0,pn(k|0),It=Z,z|0):(xr(Sn(g)|0,0,45)|0,k=Bt()|0|v,z=-1,pn(k|0),It=Z,z|0);if(_[z>>2]=_[g>>2],_[z+4>>2]=_[g+4>>2],_[z+8>>2]=_[g+8>>2],_[z+12>>2]=_[g+12>>2],k=z+4|0,(A|0)>0)for(g=-1;_[M>>2]=_[k>>2],_[M+4>>2]=_[k+4>>2],_[M+8>>2]=_[k+8>>2],A&1?(lr(k),_[C>>2]=_[k>>2],_[C+4>>2]=_[k+4>>2],_[C+8>>2]=_[k+8>>2],mh(C)):(Vd(k),_[C>>2]=_[k>>2],_[C+4>>2]=_[k+4>>2],_[C+8>>2]=_[k+8>>2],ru(C)),uf(M,C,L),li(L),_t=(15-A|0)*3|0,nt=xr(7,0,_t|0)|0,v=v&~(Bt()|0),_t=xr(Ga(L)|0,0,_t|0)|0,g=_t|g&~nt,v=Bt()|0|v,(A|0)>1;)A=A+-1|0;else g=-1;t:do if((_[k>>2]|0)<=2&&(_[z+8>>2]|0)<=2&&(_[z+12>>2]|0)<=2){if(M=Sn(z)|0,A=xr(M|0,0,45)|0,A=A|g,g=Bt()|0|v&-1040385,L=dr(z)|0,!(pr(M)|0)){if((L|0)<=0)break;for(C=0;;){if(M=Qe(A|0,g|0,52)|0,Bt()|0,M=M&15,M)for(v=1;_t=(15-v|0)*3|0,z=Qe(A|0,g|0,_t|0)|0,Bt()|0,nt=xr(7,0,_t|0)|0,g=g&~(Bt()|0),_t=xr(El(z&7)|0,0,_t|0)|0,A=A&~nt|_t,g=g|(Bt()|0),v>>>0<M>>>0;)v=v+1|0;if(C=C+1|0,(C|0)==(L|0))break t}}C=Qe(A|0,g|0,52)|0,Bt()|0,C=C&15;e:do if(C){v=1;r:for(;;){switch(_t=Qe(A|0,g|0,(15-v|0)*3|0)|0,Bt()|0,_t&7){case 1:break r;case 0:break;default:break e}if(v>>>0<C>>>0)v=v+1|0;else break e}if(sn(M,_[z>>2]|0)|0)for(v=1;z=(15-v|0)*3|0,nt=xr(7,0,z|0)|0,_t=g&~(Bt()|0),g=Qe(A|0,g|0,z|0)|0,Bt()|0,g=xr(os(g&7)|0,0,z|0)|0,A=A&~nt|g,g=_t|(Bt()|0),v>>>0<C>>>0;)v=v+1|0;else for(v=1;_t=(15-v|0)*3|0,z=Qe(A|0,g|0,_t|0)|0,Bt()|0,nt=xr(7,0,_t|0)|0,g=g&~(Bt()|0),_t=xr(El(z&7)|0,0,_t|0)|0,A=A&~nt|_t,g=g|(Bt()|0),v>>>0<C>>>0;)v=v+1|0}while(0);if((L|0)>0){v=0;do A=vp(A,g)|0,g=Bt()|0,v=v+1|0;while((v|0)!=(L|0))}}else A=0,g=0;while(0);return nt=g,_t=A,pn(nt|0),It=Z,_t|0}function zo(g){return g=g|0,(g|0)%2|0|0}function Hd(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0;return C=It,It=It+16|0,M=C,A>>>0>15?(M=4,It=C,M|0):(_[g+4>>2]&2146435072|0)==2146435072||(_[g+8+4>>2]&2146435072|0)==2146435072?(M=3,It=C,M|0):(_p(g,A,M),A=Lu(M,A)|0,M=Bt()|0,_[v>>2]=A,_[v+4>>2]=M,(A|0)==0&(M|0)==0&&dn(23313,22674,786,22697),M=0,It=C,M|0)}function yh(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0;if(C=v+4|0,L=Qe(g|0,A|0,52)|0,Bt()|0,L=L&15,k=Qe(g|0,A|0,45)|0,Bt()|0,M=(L|0)==0,pr(k&127)|0){if(M)return k=1,k|0;M=1}else{if(M)return k=0,k|0;!(_[C>>2]|0)&&!(_[v+8>>2]|0)?M=(_[v+12>>2]|0)!=0&1:M=1}for(v=1;v&1?mh(C):ru(C),k=Qe(g|0,A|0,(15-v|0)*3|0)|0,Bt()|0,gc(C,k&7),v>>>0<L>>>0;)v=v+1|0;return M|0}function Ou(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0;if(_t=It,It=It+16|0,Z=_t,nt=Qe(g|0,A|0,45)|0,Bt()|0,nt=nt&127,nt>>>0>121)return _[v>>2]=0,_[v+4>>2]=0,_[v+8>>2]=0,_[v+12>>2]=0,nt=5,It=_t,nt|0;t:do if(pr(nt)|0&&(L=Qe(g|0,A|0,52)|0,Bt()|0,L=L&15,(L|0)!=0)){M=1;e:for(;;){switch(z=Qe(g|0,A|0,(15-M|0)*3|0)|0,Bt()|0,z&7){case 5:break e;case 0:break;default:{M=A;break t}}if(M>>>0<L>>>0)M=M+1|0;else{M=A;break t}}for(C=1,M=A;A=(15-C|0)*3|0,k=xr(7,0,A|0)|0,z=M&~(Bt()|0),M=Qe(g|0,M|0,A|0)|0,Bt()|0,M=xr(os(M&7)|0,0,A|0)|0,g=g&~k|M,M=z|(Bt()|0),C>>>0<L>>>0;)C=C+1|0}else M=A;while(0);if(z=7696+(nt*28|0)|0,_[v>>2]=_[z>>2],_[v+4>>2]=_[z+4>>2],_[v+8>>2]=_[z+8>>2],_[v+12>>2]=_[z+12>>2],!(yh(g,M,v)|0))return nt=0,It=_t,nt|0;if(k=v+4|0,_[Z>>2]=_[k>>2],_[Z+4>>2]=_[k+4>>2],_[Z+8>>2]=_[k+8>>2],L=Qe(g|0,M|0,52)|0,Bt()|0,z=L&15,L&1?(ru(k),L=z+1|0):L=z,!(pr(nt)|0))M=0;else{t:do if(!z)M=0;else for(A=1;;){if(C=Qe(g|0,M|0,(15-A|0)*3|0)|0,Bt()|0,C=C&7,C|0){M=C;break t}if(A>>>0<z>>>0)A=A+1|0;else{M=0;break}}while(0);M=(M|0)==4&1}if(!(Ra(v,L,M,0)|0))(L|0)!=(z|0)&&(_[k>>2]=_[Z>>2],_[k+4>>2]=_[Z+4>>2],_[k+8>>2]=_[Z+8>>2]);else{if(pr(nt)|0)do;while(Ra(v,L,0,0)|0);(L|0)!=(z|0)&&Vd(k)}return nt=0,It=_t,nt|0}function Bu(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0;return L=It,It=It+16|0,M=L,C=Ou(g,A,M)|0,C|0?(It=L,C|0):(C=Qe(g|0,A|0,52)|0,Bt()|0,Aa(M,C&15,v),C=0,It=L,C|0)}function d(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0,z=0;if(k=It,It=It+16|0,L=k,M=Ou(g,A,L)|0,M|0)return L=M,It=k,L|0;M=Qe(g|0,A|0,45)|0,Bt()|0,M=(pr(M&127)|0)==0,C=Qe(g|0,A|0,52)|0,Bt()|0,C=C&15;t:do if(!M){if(C|0)for(M=1;;){if(z=xr(7,0,(15-M|0)*3|0)|0,!((z&g|0)==0&((Bt()|0)&A|0)==0))break t;if(M>>>0<C>>>0)M=M+1|0;else break}return yc(L,C,0,5,v),z=0,It=k,z|0}while(0);return hf(L,C,0,6,v),z=0,It=k,z|0}function y(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0;if(C=Qe(g|0,A|0,45)|0,Bt()|0,!(pr(C&127)|0))return C=2,_[v>>2]=C,0;if(C=Qe(g|0,A|0,52)|0,Bt()|0,C=C&15,!C)return C=5,_[v>>2]=C,0;for(M=1;;){if(L=xr(7,0,(15-M|0)*3|0)|0,!((L&g|0)==0&((Bt()|0)&A|0)==0)){M=2,g=6;break}if(M>>>0<C>>>0)M=M+1|0;else{M=5,g=6;break}}return(g|0)==6&&(_[v>>2]=M),0}function m(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0;Ot=It,It=It+128|0,nt=Ot+112|0,L=Ot+96|0,_t=Ot,C=Qe(g|0,A|0,52)|0,Bt()|0,z=C&15,_[nt>>2]=z,k=Qe(g|0,A|0,45)|0,Bt()|0,k=k&127;t:do if(pr(k)|0){if(z|0)for(M=1;;){if(Z=xr(7,0,(15-M|0)*3|0)|0,!((Z&g|0)==0&((Bt()|0)&A|0)==0)){C=0;break t}if(M>>>0<z>>>0)M=M+1|0;else break}if(C&1)C=1;else return Z=xr(z+1|0,0,52)|0,_t=Bt()|0|A&-15728641,nt=xr(7,0,(14-z|0)*3|0)|0,_t=m((Z|g)&~nt,_t&~(Bt()|0),v)|0,It=Ot,_t|0}else C=0;while(0);if(M=Ou(g,A,L)|0,!M){C?(Ms(L,nt,_t),Z=5):(vi(L,nt,_t),Z=6);t:do if(pr(k)|0)if(!z)g=5;else for(M=1;;){if(k=xr(7,0,(15-M|0)*3|0)|0,!((k&g|0)==0&((Bt()|0)&A|0)==0)){g=2;break t}if(M>>>0<z>>>0)M=M+1|0;else{g=5;break}}else g=2;while(0);Mp(v|0,-1,g<<2|0)|0;t:do if(C)for(L=0;;){if(k=_t+(L<<4)|0,CA(k,_[nt>>2]|0)|0,k=_[k>>2]|0,z=_[v>>2]|0,(z|0)==-1|(z|0)==(k|0))M=v;else{C=0;do{if(C=C+1|0,C>>>0>=g>>>0){M=1;break t}M=v+(C<<2)|0,z=_[M>>2]|0}while(!((z|0)==-1|(z|0)==(k|0)))}if(_[M>>2]=k,L=L+1|0,L>>>0>=Z>>>0){M=0;break}}else for(L=0;;){if(k=_t+(L<<4)|0,Ra(k,_[nt>>2]|0,0,1)|0,k=_[k>>2]|0,z=_[v>>2]|0,(z|0)==-1|(z|0)==(k|0))M=v;else{C=0;do{if(C=C+1|0,C>>>0>=g>>>0){M=1;break t}M=v+(C<<2)|0,z=_[M>>2]|0}while(!((z|0)==-1|(z|0)==(k|0)))}if(_[M>>2]=k,L=L+1|0,L>>>0>=Z>>>0){M=0;break}}while(0)}return _t=M,It=Ot,_t|0}function T(){return 12}function O(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0,k=0,z=0,Z=0;if(g>>>0>15)return z=4,z|0;if(xr(g|0,0,52)|0,z=Bt()|0|134225919,!g){v=0,M=0;do pr(M)|0&&(xr(M|0,0,45)|0,k=z|(Bt()|0),g=A+(v<<3)|0,_[g>>2]=-1,_[g+4>>2]=k,v=v+1|0),M=M+1|0;while((M|0)!=122);return v=0,v|0}v=0,k=0;do{if(pr(k)|0){for(xr(k|0,0,45)|0,M=1,C=-1,L=z|(Bt()|0);Z=xr(7,0,(15-M|0)*3|0)|0,C=C&~Z,L=L&~(Bt()|0),(M|0)!=(g|0);)M=M+1|0;Z=A+(v<<3)|0,_[Z>>2]=C,_[Z+4>>2]=L,v=v+1|0}k=k+1|0}while((k|0)!=122);return v=0,v|0}function U(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0,ke=0,Be=0,xe=0;if(xe=It,It=It+16|0,ke=xe,Be=Qe(g|0,A|0,52)|0,Bt()|0,Be=Be&15,v>>>0>15)return Be=4,It=xe,Be|0;if((Be|0)<(v|0))return Be=12,It=xe,Be|0;if((Be|0)!=(v|0))if(L=xr(v|0,0,52)|0,L=L|g,z=Bt()|0|A&-15728641,(Be|0)>(v|0)){Z=v;do me=xr(7,0,(14-Z|0)*3|0)|0,Z=Z+1|0,L=me|L,z=Bt()|0|z;while((Z|0)<(Be|0));me=L}else me=L;else me=g,z=A;Gt=Qe(me|0,z|0,45)|0,Bt()|0;t:do if(pr(Gt&127)|0){if(Z=Qe(me|0,z|0,52)|0,Bt()|0,Z=Z&15,Z|0)for(L=1;;){if(Gt=xr(7,0,(15-L|0)*3|0)|0,!((Gt&me|0)==0&((Bt()|0)&z|0)==0)){nt=33;break t}if(L>>>0<Z>>>0)L=L+1|0;else break}if(Gt=M,_[Gt>>2]=0,_[Gt+4>>2]=0,(Be|0)>(v|0)){for(Gt=A&-15728641,re=Be;;){if(Zt=re,re=re+-1|0,re>>>0>15|(Be|0)<(re|0)){nt=19;break}if((Be|0)!=(re|0))if(L=xr(re|0,0,52)|0,L=L|g,Z=Bt()|0|Gt,(Be|0)<(Zt|0))Ot=L;else{nt=re;do Ot=xr(7,0,(14-nt|0)*3|0)|0,nt=nt+1|0,L=Ot|L,Z=Bt()|0|Z;while((nt|0)<(Be|0));Ot=L}else Ot=g,Z=A;if(_t=Qe(Ot|0,Z|0,45)|0,Bt()|0,!(pr(_t&127)|0))L=0;else{_t=Qe(Ot|0,Z|0,52)|0,Bt()|0,_t=_t&15;e:do if(!_t)L=0;else for(nt=1;;){if(L=Qe(Ot|0,Z|0,(15-nt|0)*3|0)|0,Bt()|0,L=L&7,L|0)break e;if(nt>>>0<_t>>>0)nt=nt+1|0;else{L=0;break}}while(0);L=(L|0)==0&1}if(Z=Qe(g|0,A|0,(15-Zt|0)*3|0)|0,Bt()|0,Z=Z&7,(Z|0)==7){C=5,nt=42;break}if(L=(L|0)!=0,(Z|0)==1&L){C=5,nt=42;break}if(Ot=Z+(((Z|0)!=0&L)<<31>>31)|0,Ot|0&&(nt=Be-Zt|0,nt=Fi(7,0,nt,((nt|0)<0)<<31>>31)|0,_t=Bt()|0,L?(L=ya(nt|0,_t|0,5,0)|0,L=ui(L|0,Bt()|0,-5,-1)|0,L=Ep(L|0,Bt()|0,6,0)|0,L=ui(L|0,Bt()|0,1,0)|0,Z=Bt()|0):(L=nt,Z=_t),Zt=Ot+-1|0,Zt=ya(nt|0,_t|0,Zt|0,((Zt|0)<0)<<31>>31|0)|0,Zt=ui(L|0,Z|0,Zt|0,Bt()|0)|0,Ot=Bt()|0,_t=M,_t=ui(Zt|0,Ot|0,_[_t>>2]|0,_[_t+4>>2]|0)|0,Ot=Bt()|0,Zt=M,_[Zt>>2]=_t,_[Zt+4>>2]=Ot),(re|0)<=(v|0)){nt=37;break}}if((nt|0)==19)dn(23313,22674,1099,22710);else if((nt|0)==37){k=M,C=_[k+4>>2]|0,k=_[k>>2]|0;break}else if((nt|0)==42)return It=xe,C|0}else C=0,k=0}else nt=33;while(0);t:do if((nt|0)==33)if(Gt=M,_[Gt>>2]=0,_[Gt+4>>2]=0,(Be|0)>(v|0)){for(L=Be;;){if(C=Qe(g|0,A|0,(15-L|0)*3|0)|0,Bt()|0,C=C&7,(C|0)==7){C=5;break}if(k=Be-L|0,k=Fi(7,0,k,((k|0)<0)<<31>>31)|0,C=ya(k|0,Bt()|0,C|0,0)|0,k=Bt()|0,Gt=M,k=ui(_[Gt>>2]|0,_[Gt+4>>2]|0,C|0,k|0)|0,C=Bt()|0,Gt=M,_[Gt>>2]=k,_[Gt+4>>2]=C,L=L+-1|0,(L|0)<=(v|0))break t}return It=xe,C|0}else C=0,k=0;while(0);return Bc(me,z,Be,ke)|0&&dn(23313,22674,1063,22725),Be=ke,ke=_[Be+4>>2]|0,((C|0)>-1|(C|0)==-1&k>>>0>4294967295)&((ke|0)>(C|0)|((ke|0)==(C|0)?(_[Be>>2]|0)>>>0>k>>>0:0))?(Be=0,It=xe,Be|0):(dn(23313,22674,1139,22710),0)}function j(g,A,v,M,C,L){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0,L=L|0;var k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0;if(Ot=It,It=It+16|0,k=Ot,C>>>0>15)return L=4,It=Ot,L|0;if(z=Qe(v|0,M|0,52)|0,Bt()|0,z=z&15,(z|0)>(C|0))return L=12,It=Ot,L|0;if(Bc(v,M,C,k)|0&&dn(23313,22674,1063,22725),_t=k,nt=_[_t+4>>2]|0,!(((A|0)>-1|(A|0)==-1&g>>>0>4294967295)&((nt|0)>(A|0)|((nt|0)==(A|0)?(_[_t>>2]|0)>>>0>g>>>0:0))))return L=2,It=Ot,L|0;_t=C-z|0,C=xr(C|0,0,52)|0,Z=Bt()|0|M&-15728641,nt=L,_[nt>>2]=C|v,_[nt+4>>2]=Z,nt=Qe(v|0,M|0,45)|0,Bt()|0;t:do if(pr(nt&127)|0){if(z|0)for(k=1;;){if(nt=xr(7,0,(15-k|0)*3|0)|0,!((nt&v|0)==0&((Bt()|0)&M|0)==0))break t;if(k>>>0<z>>>0)k=k+1|0;else break}if((_t|0)<1)return L=0,It=Ot,L|0;for(nt=z^15,M=-1,Z=1,k=1;;){z=_t-Z|0,z=Fi(7,0,z,((z|0)<0)<<31>>31)|0,v=Bt()|0;do if(k)if(k=ya(z|0,v|0,5,0)|0,k=ui(k|0,Bt()|0,-5,-1)|0,k=Ep(k|0,Bt()|0,6,0)|0,C=Bt()|0,(A|0)>(C|0)|(A|0)==(C|0)&g>>>0>k>>>0){A=ui(g|0,A|0,-1,-1)|0,A=Oa(A|0,Bt()|0,k|0,C|0)|0,k=Bt()|0,Zt=L,Gt=_[Zt>>2]|0,Zt=_[Zt+4>>2]|0,me=(nt+M|0)*3|0,re=xr(7,0,me|0)|0,Zt=Zt&~(Bt()|0),M=Ep(A|0,k|0,z|0,v|0)|0,g=Bt()|0,C=ui(M|0,g|0,2,0)|0,me=xr(C|0,Bt()|0,me|0)|0,Zt=Bt()|0|Zt,C=L,_[C>>2]=me|Gt&~re,_[C+4>>2]=Zt,g=ya(M|0,g|0,z|0,v|0)|0,g=Oa(A|0,k|0,g|0,Bt()|0)|0,k=0,A=Bt()|0;break}else{me=L,re=_[me>>2]|0,me=_[me+4>>2]|0,Gt=xr(7,0,(nt+M|0)*3|0)|0,me=me&~(Bt()|0),k=L,_[k>>2]=re&~Gt,_[k+4>>2]=me,k=1;break}else re=L,C=_[re>>2]|0,re=_[re+4>>2]|0,M=(nt+M|0)*3|0,Zt=xr(7,0,M|0)|0,re=re&~(Bt()|0),me=Ep(g|0,A|0,z|0,v|0)|0,k=Bt()|0,M=xr(me|0,k|0,M|0)|0,re=Bt()|0|re,Gt=L,_[Gt>>2]=M|C&~Zt,_[Gt+4>>2]=re,k=ya(me|0,k|0,z|0,v|0)|0,g=Oa(g|0,A|0,k|0,Bt()|0)|0,k=0,A=Bt()|0;while(0);if((_t|0)>(Z|0))M=~Z,Z=Z+1|0;else{A=0;break}}return It=Ot,A|0}while(0);if((_t|0)<1)return me=0,It=Ot,me|0;for(C=z^15,k=1;;)if(Gt=_t-k|0,Gt=Fi(7,0,Gt,((Gt|0)<0)<<31>>31)|0,me=Bt()|0,Z=L,v=_[Z>>2]|0,Z=_[Z+4>>2]|0,z=(C-k|0)*3|0,M=xr(7,0,z|0)|0,Z=Z&~(Bt()|0),Zt=Ep(g|0,A|0,Gt|0,me|0)|0,re=Bt()|0,z=xr(Zt|0,re|0,z|0)|0,Z=Bt()|0|Z,nt=L,_[nt>>2]=z|v&~M,_[nt+4>>2]=Z,me=ya(Zt|0,re|0,Gt|0,me|0)|0,g=Oa(g|0,A|0,me|0,Bt()|0)|0,A=Bt()|0,(_t|0)<=(k|0)){A=0;break}else k=k+1|0;return It=Ot,A|0}function K(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0;C=Qe(A|0,v|0,52)|0,Bt()|0,C=C&15,(A|0)==0&(v|0)==0|((M|0)>15|(C|0)>(M|0))?(M=-1,C=-1,A=0,v=0):(L=Cl(A,v,C+1|0,M)|0,v=(Bt()|0)&-15728641,A=xr(M|0,0,52)|0,A=L|A,v=v|(Bt()|0),L=(ii(A,v)|0)==0,M=L?-1:M),L=g,_[L>>2]=A,_[L+4>>2]=v,_[g+8>>2]=C,_[g+12>>2]=M}function it(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0,z=0,Z=0,nt=0;if(v=g,A=_[v>>2]|0,v=_[v+4>>2]|0,!((A|0)==0&(v|0)==0)&&(M=Qe(A|0,v|0,52)|0,Bt()|0,M=M&15,z=xr(1,0,(M^15)*3|0)|0,A=ui(z|0,Bt()|0,A|0,v|0)|0,v=Bt()|0,z=g,_[z>>2]=A,_[z+4>>2]=v,z=g+8|0,k=_[z>>2]|0,!((M|0)<(k|0)))){for(Z=g+12|0,L=M;;){if((L|0)==(k|0)){M=5;break}if(nt=(L|0)==(_[Z>>2]|0),C=(15-L|0)*3|0,M=Qe(A|0,v|0,C|0)|0,Bt()|0,M=M&7,nt&((M|0)==1&!0)){M=7;break}if(!((M|0)==7&!0)){M=10;break}if(nt=xr(1,0,C|0)|0,A=ui(A|0,v|0,nt|0,Bt()|0)|0,v=Bt()|0,nt=g,_[nt>>2]=A,_[nt+4>>2]=v,(L|0)>(k|0))L=L+-1|0;else{M=10;break}}if((M|0)==5){nt=g,_[nt>>2]=0,_[nt+4>>2]=0,_[z>>2]=-1,_[Z>>2]=-1;return}else if((M|0)==7){k=xr(1,0,C|0)|0,k=ui(A|0,v|0,k|0,Bt()|0)|0,z=Bt()|0,nt=g,_[nt>>2]=k,_[nt+4>>2]=z,_[Z>>2]=L+-1;return}else if((M|0)==10)return}}function pt(g){g=+g;var A=0;return A=g<0?g+6.283185307179586:g,+(g>=6.283185307179586?A+-6.283185307179586:A)}function Et(g,A){return g=g|0,A=A|0,+mi(+(+Rt[g>>3]-+Rt[A>>3]))<17453292519943298e-27?(A=+mi(+(+Rt[g+8>>3]-+Rt[A+8>>3]))<17453292519943298e-27,A|0):(A=0,A|0)}function Ct(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0;return C=+Rt[A>>3],M=+Rt[g>>3],L=+kn(+((C-M)*.5)),v=+kn(+((+Rt[A+8>>3]-+Rt[g+8>>3])*.5)),v=L*L+v*(+Nn(+C)*+Nn(+M)*v),+(+Fo(+ +$n(+v),+ +$n(+(1-v)))*2)}function Pt(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0;return C=+Rt[A>>3],M=+Rt[g>>3],L=+kn(+((C-M)*.5)),v=+kn(+((+Rt[A+8>>3]-+Rt[g+8>>3])*.5)),v=L*L+v*(+Nn(+C)*+Nn(+M)*v),+(+Fo(+ +$n(+v),+ +$n(+(1-v)))*2*6371.007180918475)}function Vt(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0;return C=+Rt[A>>3],M=+Rt[g>>3],L=+kn(+((C-M)*.5)),v=+kn(+((+Rt[A+8>>3]-+Rt[g+8>>3])*.5)),v=L*L+v*(+Nn(+C)*+Nn(+M)*v),+(+Fo(+ +$n(+v),+ +$n(+(1-v)))*2*6371.007180918475*1e3)}function Ft(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0,k=0;return L=+Rt[A>>3],M=+Nn(+L),C=+Rt[A+8>>3]-+Rt[g+8>>3],k=M*+kn(+C),v=+Rt[g>>3],+ +Fo(+k,+(+kn(+L)*+Nn(+v)-+Nn(+C)*(M*+kn(+v))))}function Yt(g,A,v,M){g=g|0,A=+A,v=+v,M=M|0;var C=0,L=0,k=0,z=0;if(v<1e-16){_[M>>2]=_[g>>2],_[M+4>>2]=_[g+4>>2],_[M+8>>2]=_[g+8>>2],_[M+12>>2]=_[g+12>>2];return}L=A<0?A+6.283185307179586:A,L=A>=6.283185307179586?L+-6.283185307179586:L;do if(L<1e-16)A=+Rt[g>>3]+v,Rt[M>>3]=A,C=M;else{if(C=+mi(+(L+-3.141592653589793))<1e-16,A=+Rt[g>>3],C){A=A-v,Rt[M>>3]=A,C=M;break}if(k=+Nn(+v),v=+kn(+v),A=k*+kn(+A)+ +Nn(+L)*(v*+Nn(+A)),A=A>1?1:A,A=+dp(+(A<-1?-1:A)),Rt[M>>3]=A,+mi(+(A+-1.5707963267948966))<1e-16){Rt[M>>3]=1.5707963267948966,Rt[M+8>>3]=0;return}if(+mi(+(A+1.5707963267948966))<1e-16){Rt[M>>3]=-1.5707963267948966,Rt[M+8>>3]=0;return}if(z=+Nn(+A),L=v*+kn(+L)/z,v=+Rt[g>>3],A=(k-+kn(+A)*+kn(+v))/+Nn(+v)/z,k=L>1?1:L,A=A>1?1:A,A=+Rt[g+8>>3]+ +Fo(+(k<-1?-1:k),+(A<-1?-1:A)),A>3.141592653589793)do A=A+-6.283185307179586;while(A>3.141592653589793);if(A<-3.141592653589793)do A=A+6.283185307179586;while(A<-3.141592653589793);Rt[M+8>>3]=A;return}while(0);if(+mi(+(A+-1.5707963267948966))<1e-16){Rt[C>>3]=1.5707963267948966,Rt[M+8>>3]=0;return}if(+mi(+(A+1.5707963267948966))<1e-16){Rt[C>>3]=-1.5707963267948966,Rt[M+8>>3]=0;return}if(A=+Rt[g+8>>3],A>3.141592653589793)do A=A+-6.283185307179586;while(A>3.141592653589793);if(A<-3.141592653589793)do A=A+6.283185307179586;while(A<-3.141592653589793);Rt[M+8>>3]=A}function Dt(g,A){return g=g|0,A=A|0,g>>>0>15?(A=4,A|0):(Rt[A>>3]=+Rt[20528+(g<<3)>>3],A=0,A|0)}function Xt(g,A){return g=g|0,A=A|0,g>>>0>15?(A=4,A|0):(Rt[A>>3]=+Rt[20656+(g<<3)>>3],A=0,A|0)}function te(g,A){return g=g|0,A=A|0,g>>>0>15?(A=4,A|0):(Rt[A>>3]=+Rt[20784+(g<<3)>>3],A=0,A|0)}function le(g,A){return g=g|0,A=A|0,g>>>0>15?(A=4,A|0):(Rt[A>>3]=+Rt[20912+(g<<3)>>3],A=0,A|0)}function be(g,A){g=g|0,A=A|0;var v=0;return g>>>0>15?(A=4,A|0):(v=Fi(7,0,g,((g|0)<0)<<31>>31)|0,v=ya(v|0,Bt()|0,120,0)|0,g=Bt()|0,_[A>>2]=v|2,_[A+4>>2]=g,A=0,A|0)}function Ae(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0;return Zt=+Rt[A>>3],_t=+Rt[g>>3],Z=+kn(+((Zt-_t)*.5)),L=+Rt[A+8>>3],nt=+Rt[g+8>>3],k=+kn(+((L-nt)*.5)),z=+Nn(+_t),Ot=+Nn(+Zt),k=Z*Z+k*(Ot*z*k),k=+Fo(+ +$n(+k),+ +$n(+(1-k)))*2,Z=+Rt[v>>3],Zt=+kn(+((Z-Zt)*.5)),M=+Rt[v+8>>3],L=+kn(+((M-L)*.5)),C=+Nn(+Z),L=Zt*Zt+L*(Ot*C*L),L=+Fo(+ +$n(+L),+ +$n(+(1-L)))*2,Z=+kn(+((_t-Z)*.5)),M=+kn(+((nt-M)*.5)),M=Z*Z+M*(z*C*M),M=+Fo(+ +$n(+M),+ +$n(+(1-M)))*2,C=(k+L+M)*.5,+(+Fs(+ +$n(+(+Kn(+(C*.5))*+Kn(+((C-k)*.5))*+Kn(+((C-L)*.5))*+Kn(+((C-M)*.5)))))*4)}function Me(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0,z=0;if(z=It,It=It+192|0,L=z+168|0,k=z,C=Bu(g,A,L)|0,C|0)return v=C,It=z,v|0;if(d(g,A,k)|0&&dn(23313,22742,386,22751),A=_[k>>2]|0,(A|0)>0){if(M=+Ae(k+8|0,k+8+(((A|0)!=1&1)<<4)|0,L)+0,(A|0)!=1){g=1;do C=g,g=g+1|0,M=M+ +Ae(k+8+(C<<4)|0,k+8+(((g|0)%(A|0)|0)<<4)|0,L);while((g|0)<(A|0))}}else M=0;return Rt[v>>3]=M,v=0,It=z,v|0}function Ve(g,A,v){return g=g|0,A=A|0,v=v|0,g=Me(g,A,v)|0,g|0||(Rt[v>>3]=+Rt[v>>3]*6371.007180918475*6371.007180918475),g|0}function Je(g,A,v){return g=g|0,A=A|0,v=v|0,g=Me(g,A,v)|0,g|0||(Rt[v>>3]=+Rt[v>>3]*6371.007180918475*6371.007180918475*1e3*1e3),g|0}function $e(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0;if(z=It,It=It+176|0,k=z,g=Es(g,A,k)|0,g|0)return k=g,It=z,k|0;if(Rt[v>>3]=0,g=_[k>>2]|0,(g|0)<=1)return k=0,It=z,k|0;A=g+-1|0,g=0,M=+Rt[k+8>>3],C=+Rt[k+16>>3],L=0;do g=g+1|0,nt=M,M=+Rt[k+8+(g<<4)>>3],_t=+kn(+((M-nt)*.5)),Z=C,C=+Rt[k+8+(g<<4)+8>>3],Z=+kn(+((C-Z)*.5)),Z=_t*_t+Z*(+Nn(+M)*+Nn(+nt)*Z),L=L+ +Fo(+ +$n(+Z),+ +$n(+(1-Z)))*2;while((g|0)<(A|0));return Rt[v>>3]=L,k=0,It=z,k|0}function wr(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0;if(z=It,It=It+176|0,k=z,g=Es(g,A,k)|0,g|0)return k=g,L=+Rt[v>>3],L=L*6371.007180918475,Rt[v>>3]=L,It=z,k|0;if(Rt[v>>3]=0,g=_[k>>2]|0,(g|0)<=1)return k=0,L=0,L=L*6371.007180918475,Rt[v>>3]=L,It=z,k|0;A=g+-1|0,g=0,M=+Rt[k+8>>3],C=+Rt[k+16>>3],L=0;do g=g+1|0,nt=M,M=+Rt[k+8+(g<<4)>>3],_t=+kn(+((M-nt)*.5)),Z=C,C=+Rt[k+8+(g<<4)+8>>3],Z=+kn(+((C-Z)*.5)),Z=_t*_t+Z*(+Nn(+nt)*+Nn(+M)*Z),L=L+ +Fo(+ +$n(+Z),+ +$n(+(1-Z)))*2;while((g|0)!=(A|0));return Rt[v>>3]=L,k=0,_t=L,_t=_t*6371.007180918475,Rt[v>>3]=_t,It=z,k|0}function qr(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0;if(z=It,It=It+176|0,k=z,g=Es(g,A,k)|0,g|0)return k=g,L=+Rt[v>>3],L=L*6371.007180918475,L=L*1e3,Rt[v>>3]=L,It=z,k|0;if(Rt[v>>3]=0,g=_[k>>2]|0,(g|0)<=1)return k=0,L=0,L=L*6371.007180918475,L=L*1e3,Rt[v>>3]=L,It=z,k|0;A=g+-1|0,g=0,M=+Rt[k+8>>3],C=+Rt[k+16>>3],L=0;do g=g+1|0,nt=M,M=+Rt[k+8+(g<<4)>>3],_t=+kn(+((M-nt)*.5)),Z=C,C=+Rt[k+8+(g<<4)+8>>3],Z=+kn(+((C-Z)*.5)),Z=_t*_t+Z*(+Nn(+nt)*+Nn(+M)*Z),L=L+ +Fo(+ +$n(+Z),+ +$n(+(1-Z)))*2;while((g|0)!=(A|0));return Rt[v>>3]=L,k=0,_t=L,_t=_t*6371.007180918475,_t=_t*1e3,Rt[v>>3]=_t,It=z,k|0}function $r(g){g=g|0;var A=0,v=0,M=0;return A=Vo(1,12)|0,A||dn(22832,22787,49,22845),v=g+4|0,M=_[v>>2]|0,M|0?(M=M+8|0,_[M>>2]=A,_[v>>2]=A,A|0):(_[g>>2]|0&&dn(22862,22787,61,22885),M=g,_[M>>2]=A,_[v>>2]=A,A|0)}function Kr(g,A){g=g|0,A=A|0;var v=0,M=0;return M=Il(24)|0,M||dn(22899,22787,78,22913),_[M>>2]=_[A>>2],_[M+4>>2]=_[A+4>>2],_[M+8>>2]=_[A+8>>2],_[M+12>>2]=_[A+12>>2],_[M+16>>2]=0,A=g+4|0,v=_[A>>2]|0,v|0?(_[v+16>>2]=M,_[A>>2]=M,M|0):(_[g>>2]|0&&dn(22928,22787,82,22913),_[g>>2]=M,_[A>>2]=M,M|0)}function ei(g){g=g|0;var A=0,v=0,M=0,C=0;if(g)for(M=1;;){if(A=_[g>>2]|0,A|0)do{if(v=_[A>>2]|0,v|0)do C=v,v=_[v+16>>2]|0,vn(C);while(v|0);C=A,A=_[A+8>>2]|0,vn(C)}while(A|0);if(A=g,g=_[g+8>>2]|0,M||vn(A),g)M=0;else break}}function Sr(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0,ke=0,Be=0,xe=0,Se=0,pe=0,Ir=0,Lr=0,Er=0,Br=0,Zi=0,Ii=0,Ri=0,In=0,Hn=0,Qn=0,eo=0,Rn=0;if(C=g+8|0,_[C>>2]|0)return Rn=1,Rn|0;if(M=_[g>>2]|0,!M)return Rn=0,Rn|0;A=M,v=0;do v=v+1|0,A=_[A+8>>2]|0;while(A|0);if(v>>>0<2)return Rn=0,Rn|0;Qn=Il(v<<2)|0,Qn||dn(22948,22787,317,22967),Hn=Il(v<<5)|0,Hn||dn(22989,22787,321,22967),_[g>>2]=0,Lr=g+4|0,_[Lr>>2]=0,_[C>>2]=0,v=0,In=0,Ir=0,Ot=0;t:for(;;){if(_t=_[M>>2]|0,_t){L=0,k=_t;do{if(Z=+Rt[k+8>>3],A=k,k=_[k+16>>2]|0,nt=(k|0)==0,C=nt?_t:k,z=+Rt[C+8>>3],+mi(+(Z-z))>3.141592653589793){Rn=14;break}L=L+(z-Z)*(+Rt[A>>3]+ +Rt[C>>3])}while(!nt);if((Rn|0)==14){Rn=0,L=0,A=_t;do pe=+Rt[A+8>>3],Ri=A+16|0,Ii=_[Ri>>2]|0,Ii=Ii|0?Ii:_t,Se=+Rt[Ii+8>>3],L=L+(+Rt[A>>3]+ +Rt[Ii>>3])*((Se<0?Se+6.283185307179586:Se)-(pe<0?pe+6.283185307179586:pe)),A=_[(A|0?Ri:M)>>2]|0;while(A|0)}L>0?(_[Qn+(In<<2)>>2]=M,In=In+1|0,C=Ir,A=Ot):Rn=19}else Rn=19;if((Rn|0)==19){Rn=0;do if(v){if(A=v+8|0,_[A>>2]|0){Rn=21;break t}if(v=Vo(1,12)|0,!v){Rn=23;break t}_[A>>2]=v,C=v+4|0,k=v,A=Ot}else if(Ot){C=Lr,k=Ot+8|0,A=M,v=g;break}else if(_[g>>2]|0){Rn=27;break t}else{C=Lr,k=g,A=M,v=g;break}while(0);if(_[k>>2]=M,_[C>>2]=M,k=Hn+(Ir<<5)|0,nt=_[M>>2]|0,nt){for(_t=Hn+(Ir<<5)+8|0,Rt[_t>>3]=17976931348623157e292,Ot=Hn+(Ir<<5)+24|0,Rt[Ot>>3]=17976931348623157e292,Rt[k>>3]=-17976931348623157e292,Zt=Hn+(Ir<<5)+16|0,Rt[Zt>>3]=-17976931348623157e292,Be=17976931348623157e292,xe=-17976931348623157e292,C=0,re=nt,Z=17976931348623157e292,me=17976931348623157e292,ke=-17976931348623157e292,z=-17976931348623157e292;L=+Rt[re>>3],pe=+Rt[re+8>>3],re=_[re+16>>2]|0,Gt=(re|0)==0,Se=+Rt[(Gt?nt:re)+8>>3],L<Z&&(Rt[_t>>3]=L,Z=L),pe<me&&(Rt[Ot>>3]=pe,me=pe),L>ke?Rt[k>>3]=L:L=ke,pe>z&&(Rt[Zt>>3]=pe,z=pe),Be=pe>0&pe<Be?pe:Be,xe=pe<0&pe>xe?pe:xe,C=C|+mi(+(pe-Se))>3.141592653589793,!Gt;)ke=L;C&&(Rt[Zt>>3]=xe,Rt[Ot>>3]=Be)}else _[k>>2]=0,_[k+4>>2]=0,_[k+8>>2]=0,_[k+12>>2]=0,_[k+16>>2]=0,_[k+20>>2]=0,_[k+24>>2]=0,_[k+28>>2]=0;C=Ir+1|0}if(Ri=M+8|0,M=_[Ri>>2]|0,_[Ri>>2]=0,M)Ir=C,Ot=A;else{Rn=45;break}}if((Rn|0)==21)dn(22765,22787,35,22799);else if((Rn|0)==23)dn(22819,22787,37,22799);else if((Rn|0)==27)dn(22862,22787,61,22885);else if((Rn|0)==45){t:do if((In|0)>0){for(Ri=(C|0)==0,Zi=C<<2,Ii=(g|0)==0,Br=0,A=0;;){if(Er=_[Qn+(Br<<2)>>2]|0,Ri)Rn=73;else{if(Ir=Il(Zi)|0,!Ir){Rn=50;break}if(Lr=Il(Zi)|0,!Lr){Rn=52;break}e:do if(Ii)v=0;else{for(C=0,v=0,k=g;M=Hn+(C<<5)|0,mn(_[k>>2]|0,M,_[Er>>2]|0)|0?(_[Ir+(v<<2)>>2]=k,_[Lr+(v<<2)>>2]=M,Gt=v+1|0):Gt=v,k=_[k+8>>2]|0,k;)C=C+1|0,v=Gt;if((Gt|0)>0)if(M=_[Ir>>2]|0,(Gt|0)==1)v=M;else for(Zt=0,re=-1,v=M,Ot=M;;){for(nt=_[Ot>>2]|0,M=0,k=0;C=_[_[Ir+(k<<2)>>2]>>2]|0,(C|0)==(nt|0)?_t=M:_t=M+((mn(C,_[Lr+(k<<2)>>2]|0,_[nt>>2]|0)|0)&1)|0,k=k+1|0,(k|0)!=(Gt|0);)M=_t;if(C=(_t|0)>(re|0),v=C?Ot:v,M=Zt+1|0,(M|0)==(Gt|0))break e;Zt=M,re=C?_t:re,Ot=_[Ir+(M<<2)>>2]|0}else v=0}while(0);if(vn(Ir),vn(Lr),v){if(C=v+4|0,M=_[C>>2]|0,M)v=M+8|0;else if(_[v>>2]|0){Rn=70;break}_[v>>2]=Er,_[C>>2]=Er}else Rn=73}if((Rn|0)==73){if(Rn=0,A=_[Er>>2]|0,A|0)do Lr=A,A=_[A+16>>2]|0,vn(Lr);while(A|0);vn(Er),A=1}if(Br=Br+1|0,(Br|0)>=(In|0)){eo=A;break t}}(Rn|0)==50?dn(23004,22787,249,23023):(Rn|0)==52?dn(23042,22787,252,23023):(Rn|0)==70&&dn(22862,22787,61,22885)}else eo=0;while(0);return vn(Qn),vn(Hn),Rn=eo,Rn|0}return 0}function mn(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0;if(!(Ac(A,v)|0)||(A=Js(A)|0,M=+Rt[v>>3],C=+Rt[v+8>>3],C=A&C<0?C+6.283185307179586:C,g=_[g>>2]|0,!g))return g=0,g|0;if(A){A=0,nt=C,v=g;t:for(;;){for(;k=+Rt[v>>3],C=+Rt[v+8>>3],v=v+16|0,_t=_[v>>2]|0,_t=_t|0?_t:g,L=+Rt[_t>>3],z=+Rt[_t+8>>3],k>L?(Z=k,k=z):(Z=L,L=k,k=C,C=z),M=M==L|M==Z?M+2220446049250313e-31:M,!!(M<L|M>Z);)if(v=_[v>>2]|0,!v){v=22;break t}if(z=k<0?k+6.283185307179586:k,k=C<0?C+6.283185307179586:C,nt=z==nt|k==nt?nt+-2220446049250313e-31:nt,Z=z+(k-z)*((M-L)/(Z-L)),(Z<0?Z+6.283185307179586:Z)>nt&&(A=A^1),v=_[v>>2]|0,!v){v=22;break}}if((v|0)==22)return A|0}else{A=0,nt=C,v=g;t:for(;;){for(;k=+Rt[v>>3],C=+Rt[v+8>>3],v=v+16|0,_t=_[v>>2]|0,_t=_t|0?_t:g,L=+Rt[_t>>3],z=+Rt[_t+8>>3],k>L?(Z=k,k=z):(Z=L,L=k,k=C,C=z),M=M==L|M==Z?M+2220446049250313e-31:M,!!(M<L|M>Z);)if(v=_[v>>2]|0,!v){v=22;break t}if(nt=k==nt|C==nt?nt+-2220446049250313e-31:nt,k+(C-k)*((M-L)/(Z-L))>nt&&(A=A^1),v=_[v>>2]|0,!v){v=22;break}}if((v|0)==22)return A|0}return 0}function An(g,A,v,M,C){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0;var L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0,ke=0,Be=0,xe=0;if(xe=It,It=It+32|0,Be=xe+16|0,ke=xe,L=Qe(g|0,A|0,52)|0,Bt()|0,L=L&15,re=Qe(v|0,M|0,52)|0,Bt()|0,(L|0)!=(re&15|0))return Be=12,It=xe,Be|0;if(nt=Qe(g|0,A|0,45)|0,Bt()|0,nt=nt&127,_t=Qe(v|0,M|0,45)|0,Bt()|0,_t=_t&127,nt>>>0>121|_t>>>0>121)return Be=5,It=xe,Be|0;if(re=(nt|0)!=(_t|0),re){if(z=Go(nt,_t)|0,(z|0)==7)return Be=1,It=xe,Be|0;Z=Go(_t,nt)|0,(Z|0)==7?dn(23066,23090,161,23100):(Gt=z,k=Z)}else Gt=0,k=0;Ot=pr(nt)|0,Zt=pr(_t)|0,_[Be>>2]=0,_[Be+4>>2]=0,_[Be+8>>2]=0,_[Be+12>>2]=0;do if(Gt){if(_t=_[4272+(nt*28|0)+(Gt<<2)>>2]|0,z=(_t|0)>0,Zt)if(z){nt=0,Z=v,z=M;do Z=Ru(Z,z)|0,z=Bt()|0,k=os(k)|0,(k|0)==1&&(k=os(1)|0),nt=nt+1|0;while((nt|0)!=(_t|0));_t=k,nt=Z,Z=z}else _t=k,nt=v,Z=M;else if(z){nt=0,Z=v,z=M;do Z=mf(Z,z)|0,z=Bt()|0,k=os(k)|0,nt=nt+1|0;while((nt|0)!=(_t|0));_t=k,nt=Z,Z=z}else _t=k,nt=v,Z=M;if(yh(nt,Z,Be)|0,re||dn(23115,23090,191,23100),z=(Ot|0)!=0,k=(Zt|0)!=0,z&k&&dn(23142,23090,192,23100),z){if(k=As(g,A)|0,(k|0)==7){L=5;break}if(jr[21872+(k*7|0)+Gt>>0]|0){L=1;break}Z=_[21040+(k*28|0)+(Gt<<2)>>2]|0,nt=Z}else if(k){if(k=As(nt,Z)|0,(k|0)==7){L=5;break}if(jr[21872+(k*7|0)+_t>>0]|0){L=1;break}nt=0,Z=_[21040+(_t*28|0)+(k<<2)>>2]|0}else nt=0,Z=0;if((nt|Z|0)<0)L=5;else{if((Z|0)>0){z=Be+4|0,k=0;do Ah(z),k=k+1|0;while((k|0)!=(Z|0))}if(_[ke>>2]=0,_[ke+4>>2]=0,_[ke+8>>2]=0,gc(ke,Gt),L|0)for(;zo(L)|0?mh(ke):ru(ke),(L|0)>1;)L=L+-1|0;if((nt|0)>0){L=0;do Ah(ke),L=L+1|0;while((L|0)!=(nt|0))}me=Be+4|0,to(me,ke,me),li(me),me=51}}else if(yh(v,M,Be)|0,(Ot|0)!=0&(Zt|0)!=0)if((_t|0)!=(nt|0)&&dn(23173,23090,261,23100),k=As(g,A)|0,L=As(v,M)|0,(k|0)==7|(L|0)==7)L=5;else if(jr[21872+(k*7|0)+L>>0]|0)L=1;else if(k=_[21040+(k*28|0)+(L<<2)>>2]|0,(k|0)>0){z=Be+4|0,L=0;do Ah(z),L=L+1|0;while((L|0)!=(k|0));me=51}else me=51;else me=51;while(0);return(me|0)==51&&(L=Be+4|0,_[C>>2]=_[L>>2],_[C+4>>2]=_[L+4>>2],_[C+8>>2]=_[L+8>>2],L=0),Be=L,It=xe,Be|0}function cn(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0,ke=0,Be=0,xe=0,Se=0;if(me=It,It=It+48|0,nt=me+36|0,k=me+24|0,z=me+12|0,Z=me,C=Qe(g|0,A|0,52)|0,Bt()|0,C=C&15,Zt=Qe(g|0,A|0,45)|0,Bt()|0,Zt=Zt&127,Zt>>>0>121)return M=5,It=me,M|0;if(_t=pr(Zt)|0,xr(C|0,0,52)|0,ke=Bt()|0|134225919,L=M,_[L>>2]=-1,_[L+4>>2]=ke,!C)return C=Ga(v)|0,(C|0)==7||(C=xi(Zt,C)|0,(C|0)==127)?(ke=1,It=me,ke|0):(re=xr(C|0,0,45)|0,Gt=Bt()|0,Zt=M,Gt=_[Zt+4>>2]&-1040385|Gt,ke=M,_[ke>>2]=_[Zt>>2]|re,_[ke+4>>2]=Gt,ke=0,It=me,ke|0);for(_[nt>>2]=_[v>>2],_[nt+4>>2]=_[v+4>>2],_[nt+8>>2]=_[v+8>>2],v=C;;){if(L=v,v=v+-1|0,_[k>>2]=_[nt>>2],_[k+4>>2]=_[nt+4>>2],_[k+8>>2]=_[nt+8>>2],zo(L)|0){if(C=Xa(nt)|0,C|0){v=13;break}_[z>>2]=_[nt>>2],_[z+4>>2]=_[nt+4>>2],_[z+8>>2]=_[nt+8>>2],mh(z)}else{if(C=TA(nt)|0,C|0){v=13;break}_[z>>2]=_[nt>>2],_[z+4>>2]=_[nt+4>>2],_[z+8>>2]=_[nt+8>>2],ru(z)}if(uf(k,z,Z),li(Z),C=M,xe=_[C>>2]|0,C=_[C+4>>2]|0,Se=(15-L|0)*3|0,Be=xr(7,0,Se|0)|0,C=C&~(Bt()|0),Se=xr(Ga(Z)|0,0,Se|0)|0,C=Bt()|0|C,ke=M,_[ke>>2]=Se|xe&~Be,_[ke+4>>2]=C,(L|0)<=1){v=14;break}}t:do if((v|0)!=13&&(v|0)==14)if((_[nt>>2]|0)<=1&&(_[nt+4>>2]|0)<=1&&(_[nt+8>>2]|0)<=1){v=Ga(nt)|0,C=xi(Zt,v)|0,(C|0)==127?Z=0:Z=pr(C)|0;e:do if(v){if(_t){if(C=As(g,A)|0,(C|0)==7){C=5;break t}if(L=_[21248+(C*28|0)+(v<<2)>>2]|0,(L|0)>0){C=v,v=0;do C=El(C)|0,v=v+1|0;while((v|0)!=(L|0))}else C=v;if((C|0)==1){C=9;break t}v=xi(Zt,C)|0,(v|0)==127&&dn(23200,23090,411,23230),pr(v)|0?dn(23245,23090,412,23230):(Gt=v,re=L,Ot=C)}else Gt=C,re=0,Ot=v;if(z=_[4272+(Zt*28|0)+(Ot<<2)>>2]|0,(z|0)<=-1&&dn(23276,23090,419,23230),!Z){if((re|0)<0){C=5;break t}if(re|0){L=M,C=0,v=_[L>>2]|0,L=_[L+4>>2]|0;do v=Ya(v,L)|0,L=Bt()|0,Se=M,_[Se>>2]=v,_[Se+4>>2]=L,C=C+1|0;while((C|0)<(re|0))}if((z|0)<=0){C=Gt,v=58;break}for(L=M,C=0,v=_[L>>2]|0,L=_[L+4>>2]|0;;)if(v=Ya(v,L)|0,L=Bt()|0,Se=M,_[Se>>2]=v,_[Se+4>>2]=L,C=C+1|0,(C|0)==(z|0)){C=Gt,v=58;break e}}if(k=Go(Gt,Zt)|0,(k|0)==7&&dn(23066,23090,428,23230),C=M,v=_[C>>2]|0,C=_[C+4>>2]|0,(z|0)>0){L=0;do v=Ya(v,C)|0,C=Bt()|0,Se=M,_[Se>>2]=v,_[Se+4>>2]=C,L=L+1|0;while((L|0)!=(z|0))}if(C=As(v,C)|0,(C|0)==7&&dn(23313,23090,440,23230),v=Pr(Gt)|0,v=_[(v?21664:21456)+(k*28|0)+(C<<2)>>2]|0,(v|0)<0&&dn(23313,23090,454,23230),!v)C=Gt,v=58;else{k=M,C=0,L=_[k>>2]|0,k=_[k+4>>2]|0;do L=vp(L,k)|0,k=Bt()|0,Se=M,_[Se>>2]=L,_[Se+4>>2]=k,C=C+1|0;while((C|0)<(v|0));C=Gt,v=58}}else if((_t|0)!=0&(Z|0)!=0){if(v=As(g,A)|0,L=M,L=As(_[L>>2]|0,_[L+4>>2]|0)|0,(v|0)==7|(L|0)==7){C=5;break t}if(L=_[21248+(v*28|0)+(L<<2)>>2]|0,(L|0)<0){C=5;break t}if(!L)v=59;else{z=M,v=0,k=_[z>>2]|0,z=_[z+4>>2]|0;do k=Ya(k,z)|0,z=Bt()|0,Se=M,_[Se>>2]=k,_[Se+4>>2]=z,v=v+1|0;while((v|0)<(L|0));v=58}}else v=58;while(0);if((v|0)==58&&Z&&(v=59),(v|0)==59&&(Se=M,(As(_[Se>>2]|0,_[Se+4>>2]|0)|0)==1)){C=9;break}Se=M,Be=_[Se>>2]|0,Se=_[Se+4>>2]&-1040385,xe=xr(C|0,0,45)|0,Se=Se|(Bt()|0),C=M,_[C>>2]=Be|xe,_[C+4>>2]=Se,C=0}else C=1;while(0);return Se=C,It=me,Se|0}function ln(g,A,v,M,C,L){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0,L=L|0;var k=0,z=0;return z=It,It=It+16|0,k=z,C?g=15:(g=An(g,A,v,M,k)|0,g||(MA(k,L),g=0)),It=z,g|0}function Tn(g,A,v,M,C){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0;var L=0,k=0;return k=It,It=It+16|0,L=k,M?v=15:(v=SA(v,L)|0,v||(v=cn(g,A,L,C)|0)),It=k,v|0}function an(g,A,v,M,C){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0;var L=0,k=0,z=0,Z=0;return Z=It,It=It+32|0,k=Z+12|0,z=Z,L=An(g,A,g,A,k)|0,L|0?(z=L,It=Z,z|0):(g=An(g,A,v,M,z)|0,g|0?(z=g,It=Z,z|0):(k=gh(k,z)|0,z=C,_[z>>2]=k,_[z+4>>2]=((k|0)<0)<<31>>31,z=0,It=Z,z|0))}function en(g,A,v,M,C){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0;var L=0,k=0,z=0,Z=0;return Z=It,It=It+32|0,k=Z+12|0,z=Z,L=An(g,A,g,A,k)|0,!L&&(L=An(g,A,v,M,z)|0,!L)?(M=gh(k,z)|0,M=ui(M|0,((M|0)<0)<<31>>31|0,1,0)|0,k=Bt()|0,z=C,_[z>>2]=M,_[z+4>>2]=k,z=0,It=Z,z|0):(z=L,It=Z,z|0)}function gs(g,A,v,M,C){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0;var L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0,ke=0,Be=0,xe=0,Se=0,pe=0,Ir=0,Lr=0,Er=0,Br=0;if(Er=It,It=It+48|0,k=Er+24|0,z=Er+12|0,Lr=Er,L=An(g,A,g,A,k)|0,!L&&(L=An(g,A,v,M,z)|0,!L)){pe=gh(k,z)|0,Ir=((pe|0)<0)<<31>>31,_[k>>2]=0,_[k+4>>2]=0,_[k+8>>2]=0,_[z>>2]=0,_[z+4>>2]=0,_[z+8>>2]=0,An(g,A,g,A,k)|0&&dn(23313,23090,691,23299),An(g,A,v,M,z)|0&&dn(23313,23090,696,23299),Lc(k),Lc(z),pe?(Ot=_[k>>2]|0,Gt=+(pe|0),Be=k+4|0,Zt=_[Be>>2]|0,xe=k+8|0,re=_[xe>>2]|0,Se=k,M=Ot,L=Zt,v=re,me=+((_[z>>2]|0)-Ot|0)/Gt,ke=+((_[z+4>>2]|0)-Zt|0)/Gt,Gt=+((_[z+8>>2]|0)-re|0)/Gt):(L=k+4|0,v=k+8|0,Be=L,xe=v,Se=k,M=_[k>>2]|0,L=_[L>>2]|0,v=_[v>>2]|0,me=0,ke=0,Gt=0),_[Lr>>2]=M,re=Lr+4|0,_[re>>2]=L,Zt=Lr+8|0,_[Zt>>2]=v;t:do if((pe|0)<0)L=0;else for(_t=0,Ot=0,L=M;;){nt=+(Ot>>>0)+4294967296*+(_t|0),Br=me*nt+ +(L|0),Z=ke*nt+ +(_[Be>>2]|0),nt=Gt*nt+ +(_[xe>>2]|0),v=~~+zg(+Br),k=~~+zg(+Z),L=~~+zg(+nt),Br=+mi(+(+(v|0)-Br)),Z=+mi(+(+(k|0)-Z)),nt=+mi(+(+(L|0)-nt));do if(Br>Z&Br>nt)v=0-(k+L)|0,M=k;else if(z=0-v|0,Z>nt){M=z-L|0;break}else{M=k,L=z-k|0;break}while(0);if(_[Lr>>2]=v,_[re>>2]=M,_[Zt>>2]=L,_c(Lr),L=cn(g,A,Lr,C+(Ot<<3)|0)|0,L|0)break t;if(!((_t|0)<(Ir|0)|(_t|0)==(Ir|0)&Ot>>>0<pe>>>0)){L=0;break t}L=ui(Ot|0,_t|0,1,0)|0,z=Bt()|0,_t=z,Ot=L,L=_[Se>>2]|0}while(0);return Lr=L,It=Er,Lr|0}return Lr=L,It=Er,Lr|0}function Fi(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0,k=0;if((v|0)==0&(M|0)==0)return C=0,L=1,pn(C|0),L|0;L=g,C=A,g=1,A=0;do k=(v&1|0)==0&!0,g=ya((k?1:L)|0,(k?0:C)|0,g|0,A|0)|0,A=Bt()|0,v=Ix(v|0,M|0,1)|0,M=Bt()|0,L=ya(L|0,C|0,L|0,C|0)|0,C=Bt()|0;while(!((v|0)==0&(M|0)==0));return pn(A|0),g|0}function Vs(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0;if(!(Ac(A,v)|0)||(A=Js(A)|0,M=+Rt[v>>3],C=+Rt[v+8>>3],C=A&C<0?C+6.283185307179586:C,Zt=_[g>>2]|0,(Zt|0)<=0))return Zt=0,Zt|0;if(Ot=_[g+4>>2]|0,A){A=0,_t=C,v=-1,g=0;t:for(;;){for(nt=g;k=+Rt[Ot+(nt<<4)>>3],C=+Rt[Ot+(nt<<4)+8>>3],g=(v+2|0)%(Zt|0)|0,L=+Rt[Ot+(g<<4)>>3],z=+Rt[Ot+(g<<4)+8>>3],k>L?(Z=k,k=z):(Z=L,L=k,k=C,C=z),M=M==L|M==Z?M+2220446049250313e-31:M,!!(M<L|M>Z);)if(v=nt+1|0,(v|0)>=(Zt|0)){v=22;break t}else g=nt,nt=v,v=g;if(z=k<0?k+6.283185307179586:k,k=C<0?C+6.283185307179586:C,_t=z==_t|k==_t?_t+-2220446049250313e-31:_t,Z=z+(k-z)*((M-L)/(Z-L)),(Z<0?Z+6.283185307179586:Z)>_t&&(A=A^1),g=nt+1|0,(g|0)>=(Zt|0)){v=22;break}else v=nt}if((v|0)==22)return A|0}else{A=0,_t=C,v=-1,g=0;t:for(;;){for(nt=g;k=+Rt[Ot+(nt<<4)>>3],C=+Rt[Ot+(nt<<4)+8>>3],g=(v+2|0)%(Zt|0)|0,L=+Rt[Ot+(g<<4)>>3],z=+Rt[Ot+(g<<4)+8>>3],k>L?(Z=k,k=z):(Z=L,L=k,k=C,C=z),M=M==L|M==Z?M+2220446049250313e-31:M,!!(M<L|M>Z);)if(v=nt+1|0,(v|0)>=(Zt|0)){v=22;break t}else g=nt,nt=v,v=g;if(_t=k==_t|C==_t?_t+-2220446049250313e-31:_t,k+(C-k)*((M-L)/(Z-L))>_t&&(A=A^1),g=nt+1|0,(g|0)>=(Zt|0)){v=22;break}else v=nt}if((v|0)==22)return A|0}return 0}function _s(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0,ke=0,Be=0,xe=0;if(Gt=_[g>>2]|0,!Gt){_[A>>2]=0,_[A+4>>2]=0,_[A+8>>2]=0,_[A+12>>2]=0,_[A+16>>2]=0,_[A+20>>2]=0,_[A+24>>2]=0,_[A+28>>2]=0;return}if(me=A+8|0,Rt[me>>3]=17976931348623157e292,ke=A+24|0,Rt[ke>>3]=17976931348623157e292,Rt[A>>3]=-17976931348623157e292,Be=A+16|0,Rt[Be>>3]=-17976931348623157e292,!((Gt|0)<=0)){for(Zt=_[g+4>>2]|0,nt=17976931348623157e292,_t=-17976931348623157e292,Ot=0,g=-1,L=17976931348623157e292,k=17976931348623157e292,Z=-17976931348623157e292,M=-17976931348623157e292,re=0;v=+Rt[Zt+(re<<4)>>3],z=+Rt[Zt+(re<<4)+8>>3],g=g+2|0,C=+Rt[Zt+(((g|0)==(Gt|0)?0:g)<<4)+8>>3],v<L&&(Rt[me>>3]=v,L=v),z<k&&(Rt[ke>>3]=z,k=z),v>Z?Rt[A>>3]=v:v=Z,z>M&&(Rt[Be>>3]=z,M=z),nt=z>0&z<nt?z:nt,_t=z<0&z>_t?z:_t,Ot=Ot|+mi(+(z-C))>3.141592653589793,g=re+1|0,(g|0)!=(Gt|0);)xe=re,Z=v,re=g,g=xe;Ot&&(Rt[Be>>3]=_t,Rt[ke>>3]=nt)}}function vo(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0,ke=0,Be=0,xe=0,Se=0,pe=0,Ir=0,Lr=0,Er=0;if(Gt=_[g>>2]|0,Gt){if(me=A+8|0,Rt[me>>3]=17976931348623157e292,ke=A+24|0,Rt[ke>>3]=17976931348623157e292,Rt[A>>3]=-17976931348623157e292,Be=A+16|0,Rt[Be>>3]=-17976931348623157e292,(Gt|0)>0){for(C=_[g+4>>2]|0,Zt=17976931348623157e292,re=-17976931348623157e292,M=0,v=-1,Z=17976931348623157e292,nt=17976931348623157e292,Ot=-17976931348623157e292,k=-17976931348623157e292,xe=0;L=+Rt[C+(xe<<4)>>3],_t=+Rt[C+(xe<<4)+8>>3],Lr=v+2|0,z=+Rt[C+(((Lr|0)==(Gt|0)?0:Lr)<<4)+8>>3],L<Z&&(Rt[me>>3]=L,Z=L),_t<nt&&(Rt[ke>>3]=_t,nt=_t),L>Ot?Rt[A>>3]=L:L=Ot,_t>k&&(Rt[Be>>3]=_t,k=_t),Zt=_t>0&_t<Zt?_t:Zt,re=_t<0&_t>re?_t:re,M=M|+mi(+(_t-z))>3.141592653589793,v=xe+1|0,(v|0)!=(Gt|0);)Lr=xe,Ot=L,xe=v,v=Lr;M&&(Rt[Be>>3]=re,Rt[ke>>3]=Zt)}}else _[A>>2]=0,_[A+4>>2]=0,_[A+8>>2]=0,_[A+12>>2]=0,_[A+16>>2]=0,_[A+20>>2]=0,_[A+24>>2]=0,_[A+28>>2]=0;if(Lr=g+8|0,v=_[Lr>>2]|0,!((v|0)<=0)){Ir=g+12|0,pe=0;do if(C=_[Ir>>2]|0,M=pe,pe=pe+1|0,ke=A+(pe<<5)|0,Be=_[C+(M<<3)>>2]|0,Be){if(xe=A+(pe<<5)+8|0,Rt[xe>>3]=17976931348623157e292,g=A+(pe<<5)+24|0,Rt[g>>3]=17976931348623157e292,Rt[ke>>3]=-17976931348623157e292,Se=A+(pe<<5)+16|0,Rt[Se>>3]=-17976931348623157e292,(Be|0)>0){for(Gt=_[C+(M<<3)+4>>2]|0,Zt=17976931348623157e292,re=-17976931348623157e292,C=0,M=-1,me=0,Z=17976931348623157e292,nt=17976931348623157e292,_t=-17976931348623157e292,k=-17976931348623157e292;L=+Rt[Gt+(me<<4)>>3],Ot=+Rt[Gt+(me<<4)+8>>3],M=M+2|0,z=+Rt[Gt+(((M|0)==(Be|0)?0:M)<<4)+8>>3],L<Z&&(Rt[xe>>3]=L,Z=L),Ot<nt&&(Rt[g>>3]=Ot,nt=Ot),L>_t?Rt[ke>>3]=L:L=_t,Ot>k&&(Rt[Se>>3]=Ot,k=Ot),Zt=Ot>0&Ot<Zt?Ot:Zt,re=Ot<0&Ot>re?Ot:re,C=C|+mi(+(Ot-z))>3.141592653589793,M=me+1|0,(M|0)!=(Be|0);)Er=me,me=M,_t=L,M=Er;C&&(Rt[Se>>3]=re,Rt[g>>3]=Zt)}}else _[ke>>2]=0,_[ke+4>>2]=0,_[ke+8>>2]=0,_[ke+12>>2]=0,_[ke+16>>2]=0,_[ke+20>>2]=0,_[ke+24>>2]=0,_[ke+28>>2]=0,v=_[Lr>>2]|0;while((pe|0)<(v|0))}}function Uo(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0;if(!(Vs(g,A,v)|0))return C=0,C|0;if(C=g+8|0,(_[C>>2]|0)<=0)return C=1,C|0;for(M=g+12|0,g=0;;){if(L=g,g=g+1|0,Vs((_[M>>2]|0)+(L<<3)|0,A+(g<<5)|0,v)|0){g=0,M=6;break}if((g|0)>=(_[C>>2]|0)){g=1,M=6;break}}return(M|0)==6?g|0:0}function Ka(){return 8}function ga(){return 16}function Du(){return 168}function La(){return 8}function sl(){return 16}function Dc(){return 12}function bp(){return 8}function Af(g){return g=g|0,+(+((_[g>>2]|0)>>>0)+4294967296*+(_[g+4>>2]|0))}function Nu(g){g=g|0;var A=0,v=0;return v=+Rt[g>>3],A=+Rt[g+8>>3],+ +$n(+(v*v+A*A))}function xh(g,A,v,M,C){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0;var L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0;nt=+Rt[g>>3],Z=+Rt[A>>3]-nt,z=+Rt[g+8>>3],k=+Rt[A+8>>3]-z,Ot=+Rt[v>>3],L=+Rt[M>>3]-Ot,Zt=+Rt[v+8>>3],_t=+Rt[M+8>>3]-Zt,L=(L*(z-Zt)-(nt-Ot)*_t)/(Z*_t-k*L),Rt[C>>3]=nt+Z*L,Rt[C+8>>3]=z+k*L}function gf(g,A){return g=g|0,A=A|0,+mi(+(+Rt[g>>3]-+Rt[A>>3]))<11920928955078125e-23?(A=+mi(+(+Rt[g+8>>3]-+Rt[A+8>>3]))<11920928955078125e-23,A|0):(A=0,A|0)}function Ki(g,A){g=g|0,A=A|0;var v=0,M=0,C=0;return C=+Rt[g>>3]-+Rt[A>>3],M=+Rt[g+8>>3]-+Rt[A+8>>3],v=+Rt[g+16>>3]-+Rt[A+16>>3],+(C*C+M*M+v*v)}function wp(g,A){g=g|0,A=A|0;var v=0,M=0,C=0;v=+Rt[g>>3],M=+Nn(+v),v=+kn(+v),Rt[A+16>>3]=v,v=+Rt[g+8>>3],C=M*+Nn(+v),Rt[A>>3]=C,v=M*+kn(+v),Rt[A+8>>3]=v}function Pl(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0;if(L=It,It=It+16|0,C=L,M=ii(g,A)|0,(v+-1|0)>>>0>5||(M=(M|0)!=0,(v|0)==1&M))return C=-1,It=L,C|0;do if(Ro(g,A,C)|0)M=-1;else if(M){M=((_[21936+(v<<2)>>2]|0)+5-(_[C>>2]|0)|0)%5|0;break}else{M=((_[21968+(v<<2)>>2]|0)+6-(_[C>>2]|0)|0)%6|0;break}while(0);return C=M,It=L,C|0}function Ro(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0,z=0,Z=0,nt=0;if(nt=It,It=It+32|0,k=nt+16|0,z=nt,M=Ou(g,A,k)|0,M|0)return v=M,It=nt,v|0;L=PA(g,A)|0,Z=As(g,A)|0,kr(L,z),M=xn(L,_[k>>2]|0)|0;t:do if(pr(L)|0){do switch(L|0){case 4:{g=0;break}case 14:{g=1;break}case 24:{g=2;break}case 38:{g=3;break}case 49:{g=4;break}case 58:{g=5;break}case 63:{g=6;break}case 72:{g=7;break}case 83:{g=8;break}case 97:{g=9;break}case 107:{g=10;break}case 117:{g=11;break}default:{M=1;break t}}while(0);if(C=_[22e3+(g*24|0)+8>>2]|0,A=_[22e3+(g*24|0)+16>>2]|0,g=_[k>>2]|0,(g|0)!=(_[z>>2]|0)&&(z=Pr(L)|0,g=_[k>>2]|0,z|(g|0)==(A|0)&&(M=(M+1|0)%6|0)),(Z|0)==3&(g|0)==(A|0)){M=(M+5|0)%6|0,C=22;break}(Z|0)==5&(g|0)==(C|0)&&(M=(M+1|0)%6|0),C=22}else C=22;while(0);return(C|0)==22&&(_[v>>2]=M,M=0),v=M,It=nt,v|0}function ys(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0,ke=0,Be=0,xe=0,Se=0;if(Se=It,It=It+32|0,xe=Se+24|0,ke=Se+20|0,Gt=Se+8|0,re=Se+16|0,Zt=Se,Z=(ii(g,A)|0)==0,Z=Z?6:5,_t=Qe(g|0,A|0,52)|0,Bt()|0,_t=_t&15,Z>>>0<=v>>>0)return M=2,It=Se,M|0;Ot=(_t|0)==0,!Ot&&(me=xr(7,0,(_t^15)*3|0)|0,(me&g|0)==0&((Bt()|0)&A|0)==0)?C=v:L=4;t:do if((L|0)==4){if(C=(ii(g,A)|0)!=0,((C?4:5)|0)<(v|0)||Ro(g,A,xe)|0||(L=(_[xe>>2]|0)+v|0,C?C=22288+(((L|0)%5|0)<<2)|0:C=22320+(((L|0)%6|0)<<2)|0,me=_[C>>2]|0,(me|0)==7))return M=1,It=Se,M|0;_[ke>>2]=0,C=Io(g,A,me,ke,Gt)|0;do if(!C){if(z=Gt,nt=_[z>>2]|0,z=_[z+4>>2]|0,k=z>>>0<A>>>0|(z|0)==(A|0)&nt>>>0<g>>>0,L=k?nt:g,k=k?z:A,!Ot&&(Ot=xr(7,0,(_t^15)*3|0)|0,(nt&Ot|0)==0&(z&(Bt()|0)|0)==0))C=v;else{if(z=(v+-1+Z|0)%(Z|0)|0,C=ii(g,A)|0,(z|0)<0&&dn(23313,23315,245,23324),Z=(C|0)!=0,((Z?4:5)|0)<(z|0)&&dn(23313,23315,245,23324),Ro(g,A,xe)|0&&dn(23313,23315,245,23324),C=(_[xe>>2]|0)+z|0,Z?C=22288+(((C|0)%5|0)<<2)|0:C=22320+(((C|0)%6|0)<<2)|0,z=_[C>>2]|0,(z|0)==7&&dn(23313,23315,245,23324),_[re>>2]=0,C=Io(g,A,z,re,Zt)|0,C|0)break;nt=Zt,Z=_[nt>>2]|0,nt=_[nt+4>>2]|0;do if(nt>>>0<k>>>0|(nt|0)==(k|0)&Z>>>0<L>>>0){if(ii(Z,nt)|0?L=zt(Z,nt,g,A)|0:L=_[22384+((((_[re>>2]|0)+(_[22352+(z<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,C=ii(Z,nt)|0,(L+-1|0)>>>0>5){C=-1,L=Z,k=nt;break}if(C=(C|0)!=0,(L|0)==1&C){C=-1,L=Z,k=nt;break}do if(Ro(Z,nt,xe)|0)C=-1;else if(C){C=((_[21936+(L<<2)>>2]|0)+5-(_[xe>>2]|0)|0)%5|0;break}else{C=((_[21968+(L<<2)>>2]|0)+6-(_[xe>>2]|0)|0)%6|0;break}while(0);L=Z,k=nt}else C=v;while(0);z=Gt,nt=_[z>>2]|0,z=_[z+4>>2]|0}if((L|0)==(nt|0)&(k|0)==(z|0)){if(Z=(ii(nt,z)|0)!=0,Z?g=zt(nt,z,g,A)|0:g=_[22384+((((_[ke>>2]|0)+(_[22352+(me<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,C=ii(nt,z)|0,(g+-1|0)>>>0<=5&&(Be=(C|0)!=0,!((g|0)==1&Be)))do if(Ro(nt,z,xe)|0)C=-1;else if(Be){C=((_[21936+(g<<2)>>2]|0)+5-(_[xe>>2]|0)|0)%5|0;break}else{C=((_[21968+(g<<2)>>2]|0)+6-(_[xe>>2]|0)|0)%6|0;break}while(0);else C=-1;C=C+1|0,C=(C|0)==6|Z&(C|0)==5?0:C}A=k,g=L;break t}while(0);return M=C,It=Se,M|0}while(0);return Be=xr(C|0,0,56)|0,xe=Bt()|0|A&-2130706433|536870912,_[M>>2]=Be|g,_[M+4>>2]=xe,M=0,It=Se,M|0}function ku(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0;return L=(ii(g,A)|0)==0,M=ys(g,A,0,v)|0,C=(M|0)==0,L?!C||(M=ys(g,A,1,v+8|0)|0,M|0)||(M=ys(g,A,2,v+16|0)|0,M|0)||(M=ys(g,A,3,v+24|0)|0,M|0)||(M=ys(g,A,4,v+32|0)|0,M)?(L=M,L|0):ys(g,A,5,v+40|0)|0:!C||(M=ys(g,A,1,v+8|0)|0,M|0)||(M=ys(g,A,2,v+16|0)|0,M|0)||(M=ys(g,A,3,v+24|0)|0,M|0)||(M=ys(g,A,4,v+32|0)|0,M|0)?(L=M,L|0):(L=v+40|0,_[L>>2]=0,_[L+4>>2]=0,L=0,L|0)}function vh(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0,z=0,Z=0;return Z=It,It=It+192|0,C=Z,L=Z+168|0,k=Qe(g|0,A|0,56)|0,Bt()|0,k=k&7,z=A&-2130706433|134217728,M=Ou(g,z,L)|0,M|0?(z=M,It=Z,z|0):(A=Qe(g|0,A|0,52)|0,Bt()|0,A=A&15,ii(g,z)|0?yc(L,A,k,1,C):hf(L,A,k,1,C),z=C+8|0,_[v>>2]=_[z>>2],_[v+4>>2]=_[z+4>>2],_[v+8>>2]=_[z+8>>2],_[v+12>>2]=_[z+12>>2],z=0,It=Z,z|0)}function gi(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0;return C=It,It=It+16|0,v=C,!(!0&(A&2013265920|0)==536870912)||(M=A&-2130706433|134217728,!(nu(g,M)|0))?(M=0,It=C,M|0):(L=Qe(g|0,A|0,56)|0,Bt()|0,L=(ys(g,M,L&7,v)|0)==0,M=v,M=L&((_[M>>2]|0)==(g|0)?(_[M+4>>2]|0)==(A|0):0)&1,It=C,M|0)}function Za(g,A,v){g=g|0,A=A|0,v=v|0;var M=0;(A|0)>0?(M=Vo(A,4)|0,_[g>>2]=M,M||dn(23337,23360,40,23374)):_[g>>2]=0,_[g+4>>2]=A,_[g+8>>2]=0,_[g+12>>2]=v}function _a(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0,z=0;C=g+4|0,L=g+12|0,k=g+8|0;t:for(;;){for(v=_[C>>2]|0,A=0;;){if((A|0)>=(v|0))break t;if(M=_[g>>2]|0,z=_[M+(A<<2)>>2]|0,!z)A=A+1|0;else break}A=M+(~~(+mi(+(+Hi(10,+ +(15-(_[L>>2]|0)|0))*(+Rt[z>>3]+ +Rt[z+8>>3])))%+(v|0))>>>0<<2)|0,v=_[A>>2]|0;e:do if(v|0){if(M=z+32|0,(v|0)==(z|0))_[A>>2]=_[M>>2];else{if(v=v+32|0,A=_[v>>2]|0,!A)break;for(;(A|0)!=(z|0);)if(v=A+32|0,A=_[v>>2]|0,!A)break e;_[v>>2]=_[M>>2]}vn(z),_[k>>2]=(_[k>>2]|0)+-1}while(0)}vn(_[g>>2]|0)}function Fu(g){g=g|0;var A=0,v=0,M=0;for(M=_[g+4>>2]|0,v=0;;){if((v|0)>=(M|0)){A=0,v=4;break}if(A=_[(_[g>>2]|0)+(v<<2)>>2]|0,!A)v=v+1|0;else{v=4;break}}return(v|0)==4?A|0:0}function Ng(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0;if(v=~~(+mi(+(+Hi(10,+ +(15-(_[g+12>>2]|0)|0))*(+Rt[A>>3]+ +Rt[A+8>>3])))%+(_[g+4>>2]|0))>>>0,v=(_[g>>2]|0)+(v<<2)|0,M=_[v>>2]|0,!M)return L=1,L|0;L=A+32|0;do if((M|0)!=(A|0)){if(v=_[M+32>>2]|0,!v)return L=1,L|0;for(C=v;;){if((C|0)==(A|0)){C=8;break}if(v=_[C+32>>2]|0,v)M=C,C=v;else{v=1,C=10;break}}if((C|0)==8){_[M+32>>2]=_[L>>2];break}else if((C|0)==10)return v|0}else _[v>>2]=_[L>>2];while(0);return vn(A),L=g+8|0,_[L>>2]=(_[L>>2]|0)+-1,L=0,L|0}function Wd(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0;L=Il(40)|0,L||dn(23390,23360,98,23403),_[L>>2]=_[A>>2],_[L+4>>2]=_[A+4>>2],_[L+8>>2]=_[A+8>>2],_[L+12>>2]=_[A+12>>2],C=L+16|0,_[C>>2]=_[v>>2],_[C+4>>2]=_[v+4>>2],_[C+8>>2]=_[v+8>>2],_[C+12>>2]=_[v+12>>2],_[L+32>>2]=0,C=~~(+mi(+(+Hi(10,+ +(15-(_[g+12>>2]|0)|0))*(+Rt[A>>3]+ +Rt[A+8>>3])))%+(_[g+4>>2]|0))>>>0,C=(_[g>>2]|0)+(C<<2)|0,M=_[C>>2]|0;do if(!M)_[C>>2]=L;else{for(;!(Et(M,A)|0&&Et(M+16|0,v)|0);)if(C=_[M+32>>2]|0,M=C|0?C:M,!(_[M+32>>2]|0)){k=10;break}if((k|0)==10){_[M+32>>2]=L;break}return vn(L),k=M,k|0}while(0);return k=g+8|0,_[k>>2]=(_[k>>2]|0)+1,k=L,k|0}function Cx(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0;if(C=~~(+mi(+(+Hi(10,+ +(15-(_[g+12>>2]|0)|0))*(+Rt[A>>3]+ +Rt[A+8>>3])))%+(_[g+4>>2]|0))>>>0,C=_[(_[g>>2]|0)+(C<<2)>>2]|0,!C)return v=0,v|0;if(!v){for(g=C;;){if(Et(g,A)|0){M=10;break}if(g=_[g+32>>2]|0,!g){g=0,M=10;break}}if((M|0)==10)return g|0}for(g=C;;){if(Et(g,A)|0&&Et(g+16|0,v)|0){M=10;break}if(g=_[g+32>>2]|0,!g){g=0,M=10;break}}return(M|0)==10?g|0:0}function Tp(g,A){g=g|0,A=A|0;var v=0;if(v=~~(+mi(+(+Hi(10,+ +(15-(_[g+12>>2]|0)|0))*(+Rt[A>>3]+ +Rt[A+8>>3])))%+(_[g+4>>2]|0))>>>0,g=_[(_[g>>2]|0)+(v<<2)>>2]|0,!g)return v=0,v|0;for(;;){if(Et(g,A)|0){A=5;break}if(g=_[g+32>>2]|0,!g){g=0,A=5;break}}return(A|0)==5?g|0:0}function kg(){return 23424}function _f(g){return g=+g,+ +jT(+g)}function al(g){return g=+g,~~+_f(g)|0}function Il(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0,me=0,ke=0,Be=0,xe=0,Se=0,pe=0,Ir=0;Ir=It,It=It+16|0,Zt=Ir;do if(g>>>0<245){if(nt=g>>>0<11?16:g+11&-8,g=nt>>>3,Ot=_[5857]|0,v=Ot>>>g,v&3|0)return A=(v&1^1)+g|0,g=23468+(A<<1<<2)|0,v=g+8|0,M=_[v>>2]|0,C=M+8|0,L=_[C>>2]|0,(L|0)==(g|0)?_[5857]=Ot&~(1<<A):(_[L+12>>2]=g,_[v>>2]=L),pe=A<<3,_[M+4>>2]=pe|3,pe=M+pe+4|0,_[pe>>2]=_[pe>>2]|1,pe=C,It=Ir,pe|0;if(_t=_[5859]|0,nt>>>0>_t>>>0){if(v|0)return A=2<<g,A=v<<g&(A|0-A),A=(A&0-A)+-1|0,z=A>>>12&16,A=A>>>z,v=A>>>5&8,A=A>>>v,L=A>>>2&4,A=A>>>L,g=A>>>1&2,A=A>>>g,M=A>>>1&1,M=(v|z|L|g|M)+(A>>>M)|0,A=23468+(M<<1<<2)|0,g=A+8|0,L=_[g>>2]|0,z=L+8|0,v=_[z>>2]|0,(v|0)==(A|0)?(g=Ot&~(1<<M),_[5857]=g):(_[v+12>>2]=A,_[g>>2]=v,g=Ot),pe=M<<3,k=pe-nt|0,_[L+4>>2]=nt|3,C=L+nt|0,_[C+4>>2]=k|1,_[L+pe>>2]=k,_t|0&&(M=_[5862]|0,A=_t>>>3,v=23468+(A<<1<<2)|0,A=1<<A,g&A?(g=v+8|0,A=_[g>>2]|0):(_[5857]=g|A,A=v,g=v+8|0),_[g>>2]=M,_[A+12>>2]=M,_[M+8>>2]=A,_[M+12>>2]=v),_[5859]=k,_[5862]=C,pe=z,It=Ir,pe|0;if(L=_[5858]|0,L){for(v=(L&0-L)+-1|0,C=v>>>12&16,v=v>>>C,M=v>>>5&8,v=v>>>M,k=v>>>2&4,v=v>>>k,z=v>>>1&2,v=v>>>z,Z=v>>>1&1,Z=_[23732+((M|C|k|z|Z)+(v>>>Z)<<2)>>2]|0,v=Z,z=Z,Z=(_[Z+4>>2]&-8)-nt|0;g=_[v+16>>2]|0,!(!g&&(g=_[v+20>>2]|0,!g));)k=(_[g+4>>2]&-8)-nt|0,C=k>>>0<Z>>>0,v=g,z=C?g:z,Z=C?k:Z;if(k=z+nt|0,k>>>0>z>>>0){C=_[z+24>>2]|0,A=_[z+12>>2]|0;do if((A|0)==(z|0)){if(g=z+20|0,A=_[g>>2]|0,!A&&(g=z+16|0,A=_[g>>2]|0,!A)){v=0;break}for(;;)if(M=A+20|0,v=_[M>>2]|0,v)A=v,g=M;else if(M=A+16|0,v=_[M>>2]|0,v)A=v,g=M;else break;_[g>>2]=0,v=A}else v=_[z+8>>2]|0,_[v+12>>2]=A,_[A+8>>2]=v,v=A;while(0);do if(C|0){if(A=_[z+28>>2]|0,g=23732+(A<<2)|0,(z|0)==(_[g>>2]|0)){if(_[g>>2]=v,!v){_[5858]=L&~(1<<A);break}}else if(pe=C+16|0,_[((_[pe>>2]|0)==(z|0)?pe:C+20|0)>>2]=v,!v)break;_[v+24>>2]=C,A=_[z+16>>2]|0,A|0&&(_[v+16>>2]=A,_[A+24>>2]=v),A=_[z+20>>2]|0,A|0&&(_[v+20>>2]=A,_[A+24>>2]=v)}while(0);return Z>>>0<16?(pe=Z+nt|0,_[z+4>>2]=pe|3,pe=z+pe+4|0,_[pe>>2]=_[pe>>2]|1):(_[z+4>>2]=nt|3,_[k+4>>2]=Z|1,_[k+Z>>2]=Z,_t|0&&(M=_[5862]|0,A=_t>>>3,v=23468+(A<<1<<2)|0,A=1<<A,A&Ot?(g=v+8|0,A=_[g>>2]|0):(_[5857]=A|Ot,A=v,g=v+8|0),_[g>>2]=M,_[A+12>>2]=M,_[M+8>>2]=A,_[M+12>>2]=v),_[5859]=Z,_[5862]=k),pe=z+8|0,It=Ir,pe|0}else Ot=nt}else Ot=nt}else Ot=nt}else if(g>>>0<=4294967231)if(g=g+11|0,nt=g&-8,M=_[5858]|0,M){C=0-nt|0,g=g>>>8,g?nt>>>0>16777215?Z=31:(Ot=(g+1048320|0)>>>16&8,me=g<<Ot,z=(me+520192|0)>>>16&4,me=me<<z,Z=(me+245760|0)>>>16&2,Z=14-(z|Ot|Z)+(me<<Z>>>15)|0,Z=nt>>>(Z+7|0)&1|Z<<1):Z=0,v=_[23732+(Z<<2)>>2]|0;t:do if(!v)v=0,g=0,me=61;else for(g=0,z=nt<<((Z|0)==31?0:25-(Z>>>1)|0),L=0;;){if(k=(_[v+4>>2]&-8)-nt|0,k>>>0<C>>>0)if(k)g=v,C=k;else{g=v,C=0,me=65;break t}if(me=_[v+20>>2]|0,v=_[v+16+(z>>>31<<2)>>2]|0,L=(me|0)==0|(me|0)==(v|0)?L:me,v)z=z<<1;else{v=L,me=61;break}}while(0);if((me|0)==61){if((v|0)==0&(g|0)==0){if(g=2<<Z,g=(g|0-g)&M,!g){Ot=nt;break}Ot=(g&0-g)+-1|0,k=Ot>>>12&16,Ot=Ot>>>k,L=Ot>>>5&8,Ot=Ot>>>L,z=Ot>>>2&4,Ot=Ot>>>z,Z=Ot>>>1&2,Ot=Ot>>>Z,v=Ot>>>1&1,g=0,v=_[23732+((L|k|z|Z|v)+(Ot>>>v)<<2)>>2]|0}v?me=65:(z=g,k=C)}if((me|0)==65)for(L=v;;)if(Ot=(_[L+4>>2]&-8)-nt|0,v=Ot>>>0<C>>>0,C=v?Ot:C,g=v?L:g,v=_[L+16>>2]|0,v||(v=_[L+20>>2]|0),v)L=v;else{z=g,k=C;break}if(z|0&&k>>>0<((_[5859]|0)-nt|0)>>>0&&(_t=z+nt|0,_t>>>0>z>>>0)){L=_[z+24>>2]|0,A=_[z+12>>2]|0;do if((A|0)==(z|0)){if(g=z+20|0,A=_[g>>2]|0,!A&&(g=z+16|0,A=_[g>>2]|0,!A)){A=0;break}for(;;)if(C=A+20|0,v=_[C>>2]|0,v)A=v,g=C;else if(C=A+16|0,v=_[C>>2]|0,v)A=v,g=C;else break;_[g>>2]=0}else pe=_[z+8>>2]|0,_[pe+12>>2]=A,_[A+8>>2]=pe;while(0);do if(L){if(g=_[z+28>>2]|0,v=23732+(g<<2)|0,(z|0)==(_[v>>2]|0)){if(_[v>>2]=A,!A){M=M&~(1<<g),_[5858]=M;break}}else if(pe=L+16|0,_[((_[pe>>2]|0)==(z|0)?pe:L+20|0)>>2]=A,!A)break;_[A+24>>2]=L,g=_[z+16>>2]|0,g|0&&(_[A+16>>2]=g,_[g+24>>2]=A),g=_[z+20>>2]|0,g&&(_[A+20>>2]=g,_[g+24>>2]=A)}while(0);t:do if(k>>>0<16)pe=k+nt|0,_[z+4>>2]=pe|3,pe=z+pe+4|0,_[pe>>2]=_[pe>>2]|1;else{if(_[z+4>>2]=nt|3,_[_t+4>>2]=k|1,_[_t+k>>2]=k,A=k>>>3,k>>>0<256){v=23468+(A<<1<<2)|0,g=_[5857]|0,A=1<<A,g&A?(g=v+8|0,A=_[g>>2]|0):(_[5857]=g|A,A=v,g=v+8|0),_[g>>2]=_t,_[A+12>>2]=_t,_[_t+8>>2]=A,_[_t+12>>2]=v;break}if(A=k>>>8,A?k>>>0>16777215?v=31:(Se=(A+1048320|0)>>>16&8,pe=A<<Se,xe=(pe+520192|0)>>>16&4,pe=pe<<xe,v=(pe+245760|0)>>>16&2,v=14-(xe|Se|v)+(pe<<v>>>15)|0,v=k>>>(v+7|0)&1|v<<1):v=0,A=23732+(v<<2)|0,_[_t+28>>2]=v,g=_t+16|0,_[g+4>>2]=0,_[g>>2]=0,g=1<<v,!(M&g)){_[5858]=M|g,_[A>>2]=_t,_[_t+24>>2]=A,_[_t+12>>2]=_t,_[_t+8>>2]=_t;break}A=_[A>>2]|0;e:do if((_[A+4>>2]&-8|0)!=(k|0)){for(M=k<<((v|0)==31?0:25-(v>>>1)|0);v=A+16+(M>>>31<<2)|0,g=_[v>>2]|0,!!g;)if((_[g+4>>2]&-8|0)==(k|0)){A=g;break e}else M=M<<1,A=g;_[v>>2]=_t,_[_t+24>>2]=A,_[_t+12>>2]=_t,_[_t+8>>2]=_t;break t}while(0);Se=A+8|0,pe=_[Se>>2]|0,_[pe+12>>2]=_t,_[Se>>2]=_t,_[_t+8>>2]=pe,_[_t+12>>2]=A,_[_t+24>>2]=0}while(0);return pe=z+8|0,It=Ir,pe|0}else Ot=nt}else Ot=nt;else Ot=-1;while(0);if(v=_[5859]|0,v>>>0>=Ot>>>0)return A=v-Ot|0,g=_[5862]|0,A>>>0>15?(pe=g+Ot|0,_[5862]=pe,_[5859]=A,_[pe+4>>2]=A|1,_[g+v>>2]=A,_[g+4>>2]=Ot|3):(_[5859]=0,_[5862]=0,_[g+4>>2]=v|3,pe=g+v+4|0,_[pe>>2]=_[pe>>2]|1),pe=g+8|0,It=Ir,pe|0;if(k=_[5860]|0,k>>>0>Ot>>>0)return xe=k-Ot|0,_[5860]=xe,pe=_[5863]|0,Se=pe+Ot|0,_[5863]=Se,_[Se+4>>2]=xe|1,_[pe+4>>2]=Ot|3,pe=pe+8|0,It=Ir,pe|0;if(_[5975]|0?g=_[5977]|0:(_[5977]=4096,_[5976]=4096,_[5978]=-1,_[5979]=-1,_[5980]=0,_[5968]=0,_[5975]=Zt&-16^1431655768,g=4096),z=Ot+48|0,Z=Ot+47|0,L=g+Z|0,C=0-g|0,nt=L&C,nt>>>0<=Ot>>>0||(g=_[5967]|0,g|0&&(_t=_[5965]|0,Zt=_t+nt|0,Zt>>>0<=_t>>>0|Zt>>>0>g>>>0)))return pe=0,It=Ir,pe|0;t:do if(_[5968]&4)A=0,me=143;else{v=_[5863]|0;e:do if(v){for(M=23876;Zt=_[M>>2]|0,!(Zt>>>0<=v>>>0&&(Zt+(_[M+4>>2]|0)|0)>>>0>v>>>0);)if(g=_[M+8>>2]|0,g)M=g;else{me=128;break e}if(A=L-k&C,A>>>0<2147483647)if(g=yf(A|0)|0,(g|0)==((_[M>>2]|0)+(_[M+4>>2]|0)|0)){if((g|0)!=-1){k=A,L=g,me=145;break t}}else M=g,me=136;else A=0}else me=128;while(0);do if((me|0)==128)if(v=yf(0)|0,(v|0)!=-1&&(A=v,re=_[5976]|0,Gt=re+-1|0,A=(Gt&A|0?(Gt+A&0-re)-A|0:0)+nt|0,re=_[5965]|0,Gt=A+re|0,A>>>0>Ot>>>0&A>>>0<2147483647)){if(Zt=_[5967]|0,Zt|0&&Gt>>>0<=re>>>0|Gt>>>0>Zt>>>0){A=0;break}if(g=yf(A|0)|0,(g|0)==(v|0)){k=A,L=v,me=145;break t}else M=g,me=136}else A=0;while(0);do if((me|0)==136){if(v=0-A|0,!(z>>>0>A>>>0&(A>>>0<2147483647&(M|0)!=-1)))if((M|0)==-1){A=0;break}else{k=A,L=M,me=145;break t}if(g=_[5977]|0,g=Z-A+g&0-g,g>>>0>=2147483647){k=A,L=M,me=145;break t}if((yf(g|0)|0)==-1){yf(v|0)|0,A=0;break}else{k=g+A|0,L=M,me=145;break t}}while(0);_[5968]=_[5968]|4,me=143}while(0);if((me|0)==143&&nt>>>0<2147483647&&(xe=yf(nt|0)|0,Gt=yf(0)|0,ke=Gt-xe|0,Be=ke>>>0>(Ot+40|0)>>>0,!((xe|0)==-1|Be^1|xe>>>0<Gt>>>0&((xe|0)!=-1&(Gt|0)!=-1)^1))&&(k=Be?ke:A,L=xe,me=145),(me|0)==145){A=(_[5965]|0)+k|0,_[5965]=A,A>>>0>(_[5966]|0)>>>0&&(_[5966]=A),Z=_[5863]|0;t:do if(Z){for(A=23876;;){if(g=_[A>>2]|0,v=_[A+4>>2]|0,(L|0)==(g+v|0)){me=154;break}if(M=_[A+8>>2]|0,M)A=M;else break}if((me|0)==154&&(Se=A+4|0,(_[A+12>>2]&8|0)==0)&&L>>>0>Z>>>0&g>>>0<=Z>>>0){_[Se>>2]=v+k,pe=(_[5860]|0)+k|0,xe=Z+8|0,xe=xe&7|0?0-xe&7:0,Se=Z+xe|0,xe=pe-xe|0,_[5863]=Se,_[5860]=xe,_[Se+4>>2]=xe|1,_[Z+pe+4>>2]=40,_[5864]=_[5979];break}for(L>>>0<(_[5861]|0)>>>0&&(_[5861]=L),v=L+k|0,A=23876;;){if((_[A>>2]|0)==(v|0)){me=162;break}if(g=_[A+8>>2]|0,g)A=g;else break}if((me|0)==162&&!(_[A+12>>2]&8|0)){_[A>>2]=L,_t=A+4|0,_[_t>>2]=(_[_t>>2]|0)+k,_t=L+8|0,_t=L+(_t&7|0?0-_t&7:0)|0,A=v+8|0,A=v+(A&7|0?0-A&7:0)|0,nt=_t+Ot|0,z=A-_t-Ot|0,_[_t+4>>2]=Ot|3;e:do if((Z|0)==(A|0))pe=(_[5860]|0)+z|0,_[5860]=pe,_[5863]=nt,_[nt+4>>2]=pe|1;else{if((_[5862]|0)==(A|0)){pe=(_[5859]|0)+z|0,_[5859]=pe,_[5862]=nt,_[nt+4>>2]=pe|1,_[nt+pe>>2]=pe;break}if(g=_[A+4>>2]|0,(g&3|0)==1){k=g&-8,M=g>>>3;r:do if(g>>>0<256)if(g=_[A+8>>2]|0,v=_[A+12>>2]|0,(v|0)==(g|0)){_[5857]=_[5857]&~(1<<M);break}else{_[g+12>>2]=v,_[v+8>>2]=g;break}else{L=_[A+24>>2]|0,g=_[A+12>>2]|0;do if((g|0)==(A|0)){if(v=A+16|0,M=v+4|0,g=_[M>>2]|0,g)v=M;else if(g=_[v>>2]|0,!g){g=0;break}for(;;)if(C=g+20|0,M=_[C>>2]|0,M)g=M,v=C;else if(C=g+16|0,M=_[C>>2]|0,M)g=M,v=C;else break;_[v>>2]=0}else pe=_[A+8>>2]|0,_[pe+12>>2]=g,_[g+8>>2]=pe;while(0);if(!L)break;v=_[A+28>>2]|0,M=23732+(v<<2)|0;do if((_[M>>2]|0)!=(A|0)){if(pe=L+16|0,_[((_[pe>>2]|0)==(A|0)?pe:L+20|0)>>2]=g,!g)break r}else{if(_[M>>2]=g,g|0)break;_[5858]=_[5858]&~(1<<v);break r}while(0);if(_[g+24>>2]=L,v=A+16|0,M=_[v>>2]|0,M|0&&(_[g+16>>2]=M,_[M+24>>2]=g),v=_[v+4>>2]|0,!v)break;_[g+20>>2]=v,_[v+24>>2]=g}while(0);A=A+k|0,C=k+z|0}else C=z;if(A=A+4|0,_[A>>2]=_[A>>2]&-2,_[nt+4>>2]=C|1,_[nt+C>>2]=C,A=C>>>3,C>>>0<256){v=23468+(A<<1<<2)|0,g=_[5857]|0,A=1<<A,g&A?(g=v+8|0,A=_[g>>2]|0):(_[5857]=g|A,A=v,g=v+8|0),_[g>>2]=nt,_[A+12>>2]=nt,_[nt+8>>2]=A,_[nt+12>>2]=v;break}A=C>>>8;do if(!A)M=0;else{if(C>>>0>16777215){M=31;break}Se=(A+1048320|0)>>>16&8,pe=A<<Se,xe=(pe+520192|0)>>>16&4,pe=pe<<xe,M=(pe+245760|0)>>>16&2,M=14-(xe|Se|M)+(pe<<M>>>15)|0,M=C>>>(M+7|0)&1|M<<1}while(0);if(A=23732+(M<<2)|0,_[nt+28>>2]=M,g=nt+16|0,_[g+4>>2]=0,_[g>>2]=0,g=_[5858]|0,v=1<<M,!(g&v)){_[5858]=g|v,_[A>>2]=nt,_[nt+24>>2]=A,_[nt+12>>2]=nt,_[nt+8>>2]=nt;break}A=_[A>>2]|0;r:do if((_[A+4>>2]&-8|0)!=(C|0)){for(M=C<<((M|0)==31?0:25-(M>>>1)|0);v=A+16+(M>>>31<<2)|0,g=_[v>>2]|0,!!g;)if((_[g+4>>2]&-8|0)==(C|0)){A=g;break r}else M=M<<1,A=g;_[v>>2]=nt,_[nt+24>>2]=A,_[nt+12>>2]=nt,_[nt+8>>2]=nt;break e}while(0);Se=A+8|0,pe=_[Se>>2]|0,_[pe+12>>2]=nt,_[Se>>2]=nt,_[nt+8>>2]=pe,_[nt+12>>2]=A,_[nt+24>>2]=0}while(0);return pe=_t+8|0,It=Ir,pe|0}for(A=23876;g=_[A>>2]|0,!(g>>>0<=Z>>>0&&(pe=g+(_[A+4>>2]|0)|0,pe>>>0>Z>>>0));)A=_[A+8>>2]|0;C=pe+-47|0,g=C+8|0,g=C+(g&7|0?0-g&7:0)|0,C=Z+16|0,g=g>>>0<C>>>0?Z:g,A=g+8|0,v=k+-40|0,xe=L+8|0,xe=xe&7|0?0-xe&7:0,Se=L+xe|0,xe=v-xe|0,_[5863]=Se,_[5860]=xe,_[Se+4>>2]=xe|1,_[L+v+4>>2]=40,_[5864]=_[5979],v=g+4|0,_[v>>2]=27,_[A>>2]=_[5969],_[A+4>>2]=_[5970],_[A+8>>2]=_[5971],_[A+12>>2]=_[5972],_[5969]=L,_[5970]=k,_[5972]=0,_[5971]=A,A=g+24|0;do Se=A,A=A+4|0,_[A>>2]=7;while((Se+8|0)>>>0<pe>>>0);if((g|0)!=(Z|0)){if(L=g-Z|0,_[v>>2]=_[v>>2]&-2,_[Z+4>>2]=L|1,_[g>>2]=L,A=L>>>3,L>>>0<256){v=23468+(A<<1<<2)|0,g=_[5857]|0,A=1<<A,g&A?(g=v+8|0,A=_[g>>2]|0):(_[5857]=g|A,A=v,g=v+8|0),_[g>>2]=Z,_[A+12>>2]=Z,_[Z+8>>2]=A,_[Z+12>>2]=v;break}if(A=L>>>8,A?L>>>0>16777215?M=31:(Se=(A+1048320|0)>>>16&8,pe=A<<Se,xe=(pe+520192|0)>>>16&4,pe=pe<<xe,M=(pe+245760|0)>>>16&2,M=14-(xe|Se|M)+(pe<<M>>>15)|0,M=L>>>(M+7|0)&1|M<<1):M=0,v=23732+(M<<2)|0,_[Z+28>>2]=M,_[Z+20>>2]=0,_[C>>2]=0,A=_[5858]|0,g=1<<M,!(A&g)){_[5858]=A|g,_[v>>2]=Z,_[Z+24>>2]=v,_[Z+12>>2]=Z,_[Z+8>>2]=Z;break}A=_[v>>2]|0;e:do if((_[A+4>>2]&-8|0)!=(L|0)){for(M=L<<((M|0)==31?0:25-(M>>>1)|0);v=A+16+(M>>>31<<2)|0,g=_[v>>2]|0,!!g;)if((_[g+4>>2]&-8|0)==(L|0)){A=g;break e}else M=M<<1,A=g;_[v>>2]=Z,_[Z+24>>2]=A,_[Z+12>>2]=Z,_[Z+8>>2]=Z;break t}while(0);Se=A+8|0,pe=_[Se>>2]|0,_[pe+12>>2]=Z,_[Se>>2]=Z,_[Z+8>>2]=pe,_[Z+12>>2]=A,_[Z+24>>2]=0}}else pe=_[5861]|0,(pe|0)==0|L>>>0<pe>>>0&&(_[5861]=L),_[5969]=L,_[5970]=k,_[5972]=0,_[5866]=_[5975],_[5865]=-1,_[5870]=23468,_[5869]=23468,_[5872]=23476,_[5871]=23476,_[5874]=23484,_[5873]=23484,_[5876]=23492,_[5875]=23492,_[5878]=23500,_[5877]=23500,_[5880]=23508,_[5879]=23508,_[5882]=23516,_[5881]=23516,_[5884]=23524,_[5883]=23524,_[5886]=23532,_[5885]=23532,_[5888]=23540,_[5887]=23540,_[5890]=23548,_[5889]=23548,_[5892]=23556,_[5891]=23556,_[5894]=23564,_[5893]=23564,_[5896]=23572,_[5895]=23572,_[5898]=23580,_[5897]=23580,_[5900]=23588,_[5899]=23588,_[5902]=23596,_[5901]=23596,_[5904]=23604,_[5903]=23604,_[5906]=23612,_[5905]=23612,_[5908]=23620,_[5907]=23620,_[5910]=23628,_[5909]=23628,_[5912]=23636,_[5911]=23636,_[5914]=23644,_[5913]=23644,_[5916]=23652,_[5915]=23652,_[5918]=23660,_[5917]=23660,_[5920]=23668,_[5919]=23668,_[5922]=23676,_[5921]=23676,_[5924]=23684,_[5923]=23684,_[5926]=23692,_[5925]=23692,_[5928]=23700,_[5927]=23700,_[5930]=23708,_[5929]=23708,_[5932]=23716,_[5931]=23716,pe=k+-40|0,xe=L+8|0,xe=xe&7|0?0-xe&7:0,Se=L+xe|0,xe=pe-xe|0,_[5863]=Se,_[5860]=xe,_[Se+4>>2]=xe|1,_[L+pe+4>>2]=40,_[5864]=_[5979];while(0);if(A=_[5860]|0,A>>>0>Ot>>>0)return xe=A-Ot|0,_[5860]=xe,pe=_[5863]|0,Se=pe+Ot|0,_[5863]=Se,_[Se+4>>2]=xe|1,_[pe+4>>2]=Ot|3,pe=pe+8|0,It=Ir,pe|0}return pe=kg()|0,_[pe>>2]=12,pe=0,It=Ir,pe|0}function vn(g){g=g|0;var A=0,v=0,M=0,C=0,L=0,k=0,z=0,Z=0;if(!g)return;v=g+-8|0,C=_[5861]|0,g=_[g+-4>>2]|0,A=g&-8,Z=v+A|0;do if(g&1)z=v,k=v;else{if(M=_[v>>2]|0,!(g&3)||(k=v+(0-M)|0,L=M+A|0,k>>>0<C>>>0))return;if((_[5862]|0)==(k|0)){if(g=Z+4|0,A=_[g>>2]|0,(A&3|0)!=3){z=k,A=L;break}_[5859]=L,_[g>>2]=A&-2,_[k+4>>2]=L|1,_[k+L>>2]=L;return}if(v=M>>>3,M>>>0<256)if(g=_[k+8>>2]|0,A=_[k+12>>2]|0,(A|0)==(g|0)){_[5857]=_[5857]&~(1<<v),z=k,A=L;break}else{_[g+12>>2]=A,_[A+8>>2]=g,z=k,A=L;break}C=_[k+24>>2]|0,g=_[k+12>>2]|0;do if((g|0)==(k|0)){if(A=k+16|0,v=A+4|0,g=_[v>>2]|0,g)A=v;else if(g=_[A>>2]|0,!g){g=0;break}for(;;)if(M=g+20|0,v=_[M>>2]|0,v)g=v,A=M;else if(M=g+16|0,v=_[M>>2]|0,v)g=v,A=M;else break;_[A>>2]=0}else z=_[k+8>>2]|0,_[z+12>>2]=g,_[g+8>>2]=z;while(0);if(C){if(A=_[k+28>>2]|0,v=23732+(A<<2)|0,(_[v>>2]|0)==(k|0)){if(_[v>>2]=g,!g){_[5858]=_[5858]&~(1<<A),z=k,A=L;break}}else if(z=C+16|0,_[((_[z>>2]|0)==(k|0)?z:C+20|0)>>2]=g,!g){z=k,A=L;break}_[g+24>>2]=C,A=k+16|0,v=_[A>>2]|0,v|0&&(_[g+16>>2]=v,_[v+24>>2]=g),A=_[A+4>>2]|0,A?(_[g+20>>2]=A,_[A+24>>2]=g,z=k,A=L):(z=k,A=L)}else z=k,A=L}while(0);if(k>>>0>=Z>>>0||(g=Z+4|0,M=_[g>>2]|0,!(M&1)))return;if(M&2)_[g>>2]=M&-2,_[z+4>>2]=A|1,_[k+A>>2]=A,C=A;else{if((_[5863]|0)==(Z|0)){if(Z=(_[5860]|0)+A|0,_[5860]=Z,_[5863]=z,_[z+4>>2]=Z|1,(z|0)!=(_[5862]|0))return;_[5862]=0,_[5859]=0;return}if((_[5862]|0)==(Z|0)){Z=(_[5859]|0)+A|0,_[5859]=Z,_[5862]=k,_[z+4>>2]=Z|1,_[k+Z>>2]=Z;return}C=(M&-8)+A|0,v=M>>>3;do if(M>>>0<256)if(A=_[Z+8>>2]|0,g=_[Z+12>>2]|0,(g|0)==(A|0)){_[5857]=_[5857]&~(1<<v);break}else{_[A+12>>2]=g,_[g+8>>2]=A;break}else{L=_[Z+24>>2]|0,g=_[Z+12>>2]|0;do if((g|0)==(Z|0)){if(A=Z+16|0,v=A+4|0,g=_[v>>2]|0,g)A=v;else if(g=_[A>>2]|0,!g){v=0;break}for(;;)if(M=g+20|0,v=_[M>>2]|0,v)g=v,A=M;else if(M=g+16|0,v=_[M>>2]|0,v)g=v,A=M;else break;_[A>>2]=0,v=g}else v=_[Z+8>>2]|0,_[v+12>>2]=g,_[g+8>>2]=v,v=g;while(0);if(L|0){if(g=_[Z+28>>2]|0,A=23732+(g<<2)|0,(_[A>>2]|0)==(Z|0)){if(_[A>>2]=v,!v){_[5858]=_[5858]&~(1<<g);break}}else if(M=L+16|0,_[((_[M>>2]|0)==(Z|0)?M:L+20|0)>>2]=v,!v)break;_[v+24>>2]=L,g=Z+16|0,A=_[g>>2]|0,A|0&&(_[v+16>>2]=A,_[A+24>>2]=v),g=_[g+4>>2]|0,g|0&&(_[v+20>>2]=g,_[g+24>>2]=v)}}while(0);if(_[z+4>>2]=C|1,_[k+C>>2]=C,(z|0)==(_[5862]|0)){_[5859]=C;return}}if(g=C>>>3,C>>>0<256){v=23468+(g<<1<<2)|0,A=_[5857]|0,g=1<<g,A&g?(A=v+8|0,g=_[A>>2]|0):(_[5857]=A|g,g=v,A=v+8|0),_[A>>2]=z,_[g+12>>2]=z,_[z+8>>2]=g,_[z+12>>2]=v;return}g=C>>>8,g?C>>>0>16777215?M=31:(k=(g+1048320|0)>>>16&8,Z=g<<k,L=(Z+520192|0)>>>16&4,Z=Z<<L,M=(Z+245760|0)>>>16&2,M=14-(L|k|M)+(Z<<M>>>15)|0,M=C>>>(M+7|0)&1|M<<1):M=0,g=23732+(M<<2)|0,_[z+28>>2]=M,_[z+20>>2]=0,_[z+16>>2]=0,A=_[5858]|0,v=1<<M;t:do if(!(A&v))_[5858]=A|v,_[g>>2]=z,_[z+24>>2]=g,_[z+12>>2]=z,_[z+8>>2]=z;else{g=_[g>>2]|0;e:do if((_[g+4>>2]&-8|0)!=(C|0)){for(M=C<<((M|0)==31?0:25-(M>>>1)|0);v=g+16+(M>>>31<<2)|0,A=_[v>>2]|0,!!A;)if((_[A+4>>2]&-8|0)==(C|0)){g=A;break e}else M=M<<1,g=A;_[v>>2]=z,_[z+24>>2]=g,_[z+12>>2]=z,_[z+8>>2]=z;break t}while(0);k=g+8|0,Z=_[k>>2]|0,_[Z+12>>2]=z,_[k>>2]=z,_[z+8>>2]=Z,_[z+12>>2]=g,_[z+24>>2]=0}while(0);if(Z=(_[5865]|0)+-1|0,_[5865]=Z,!(Z|0)){for(g=23884;g=_[g>>2]|0,g;)g=g+8|0;_[5865]=-1}}function Vo(g,A){g=g|0,A=A|0;var v=0;return g?(v=dc(A,g)|0,(A|g)>>>0>65535&&(v=((v>>>0)/(g>>>0)|0|0)==(A|0)?v:-1)):v=0,g=Il(v)|0,!g||!(_[g+-4>>2]&3)||Mp(g|0,0,v|0)|0,g|0}function ui(g,A,v,M){return g=g|0,A=A|0,v=v|0,M=M|0,v=g+v>>>0,pn(A+M+(v>>>0<g>>>0|0)>>>0|0),v|0|0}function Oa(g,A,v,M){return g=g|0,A=A|0,v=v|0,M=M|0,M=A-M-(v>>>0>g>>>0|0)>>>0,pn(M|0),g-v>>>0|0|0}function UT(g){return g=g|0,(g?31-(ma(g^g-1)|0)|0:32)|0}function Px(g,A,v,M,C){g=g|0,A=A|0,v=v|0,M=M|0,C=C|0;var L=0,k=0,z=0,Z=0,nt=0,_t=0,Ot=0,Zt=0,re=0,Gt=0;if(_t=g,Z=A,nt=Z,k=v,Zt=M,z=Zt,!nt)return L=(C|0)!=0,z?L?(_[C>>2]=g|0,_[C+4>>2]=A&0,Zt=0,C=0,pn(Zt|0),C|0):(Zt=0,C=0,pn(Zt|0),C|0):(L&&(_[C>>2]=(_t>>>0)%(k>>>0),_[C+4>>2]=0),Zt=0,C=(_t>>>0)/(k>>>0)>>>0,pn(Zt|0),C|0);L=(z|0)==0;do if(k){if(!L){if(L=(ma(z|0)|0)-(ma(nt|0)|0)|0,L>>>0<=31){Ot=L+1|0,z=31-L|0,A=L-31>>31,k=Ot,g=_t>>>(Ot>>>0)&A|nt<<z,A=nt>>>(Ot>>>0)&A,L=0,z=_t<<z;break}return C?(_[C>>2]=g|0,_[C+4>>2]=Z|A&0,Zt=0,C=0,pn(Zt|0),C|0):(Zt=0,C=0,pn(Zt|0),C|0)}if(L=k-1|0,L&k|0){z=(ma(k|0)|0)+33-(ma(nt|0)|0)|0,Gt=64-z|0,Ot=32-z|0,Z=Ot>>31,re=z-32|0,A=re>>31,k=z,g=Ot-1>>31&nt>>>(re>>>0)|(nt<<Ot|_t>>>(z>>>0))&A,A=A&nt>>>(z>>>0),L=_t<<Gt&Z,z=(nt<<Gt|_t>>>(re>>>0))&Z|_t<<Ot&z-33>>31;break}return C|0&&(_[C>>2]=L&_t,_[C+4>>2]=0),(k|0)==1?(re=Z|A&0,Gt=g|0|0,pn(re|0),Gt|0):(Gt=UT(k|0)|0,re=nt>>>(Gt>>>0)|0,Gt=nt<<32-Gt|_t>>>(Gt>>>0)|0,pn(re|0),Gt|0)}else{if(L)return C|0&&(_[C>>2]=(nt>>>0)%(k>>>0),_[C+4>>2]=0),re=0,Gt=(nt>>>0)/(k>>>0)>>>0,pn(re|0),Gt|0;if(!_t)return C|0&&(_[C>>2]=0,_[C+4>>2]=(nt>>>0)%(z>>>0)),re=0,Gt=(nt>>>0)/(z>>>0)>>>0,pn(re|0),Gt|0;if(L=z-1|0,!(L&z))return C|0&&(_[C>>2]=g|0,_[C+4>>2]=L&nt|A&0),re=0,Gt=nt>>>((UT(z|0)|0)>>>0),pn(re|0),Gt|0;if(L=(ma(z|0)|0)-(ma(nt|0)|0)|0,L>>>0<=30){A=L+1|0,z=31-L|0,k=A,g=nt<<z|_t>>>(A>>>0),A=nt>>>(A>>>0),L=0,z=_t<<z;break}return C?(_[C>>2]=g|0,_[C+4>>2]=Z|A&0,re=0,Gt=0,pn(re|0),Gt|0):(re=0,Gt=0,pn(re|0),Gt|0)}while(0);if(!k)nt=z,Z=0,z=0;else{Ot=v|0|0,_t=Zt|M&0,nt=ui(Ot|0,_t|0,-1,-1)|0,v=Bt()|0,Z=z,z=0;do M=Z,Z=L>>>31|Z<<1,L=z|L<<1,M=g<<1|M>>>31|0,Zt=g>>>31|A<<1|0,Oa(nt|0,v|0,M|0,Zt|0)|0,Gt=Bt()|0,re=Gt>>31|((Gt|0)<0?-1:0)<<1,z=re&1,g=Oa(M|0,Zt|0,re&Ot|0,(((Gt|0)<0?-1:0)>>31|((Gt|0)<0?-1:0)<<1)&_t|0)|0,A=Bt()|0,k=k-1|0;while(k|0);nt=Z,Z=0}return k=0,C|0&&(_[C>>2]=g,_[C+4>>2]=A),re=(L|0)>>>31|(nt|k)<<1|(k<<1|L>>>31)&0|Z,Gt=(L<<1|0>>>31)&-2|z,pn(re|0),Gt|0}function Ep(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0,k=0,z=0,Z=0,nt=0;return nt=A>>31|((A|0)<0?-1:0)<<1,Z=((A|0)<0?-1:0)>>31|((A|0)<0?-1:0)<<1,L=M>>31|((M|0)<0?-1:0)<<1,C=((M|0)<0?-1:0)>>31|((M|0)<0?-1:0)<<1,z=Oa(nt^g|0,Z^A|0,nt|0,Z|0)|0,k=Bt()|0,g=L^nt,A=C^Z,Oa((Px(z,k,Oa(L^v|0,C^M|0,L|0,C|0)|0,Bt()|0,0)|0)^g|0,(Bt()|0)^A|0,g|0,A|0)|0}function JR(g,A){g=g|0,A=A|0;var v=0,M=0,C=0,L=0;return L=g&65535,C=A&65535,v=dc(C,L)|0,M=g>>>16,g=(v>>>16)+(dc(C,M)|0)|0,C=A>>>16,A=dc(C,L)|0,pn((g>>>16)+(dc(C,M)|0)+(((g&65535)+A|0)>>>16)|0),g+A<<16|v&65535|0|0}function ya(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0;return C=g,L=v,v=JR(C,L)|0,g=Bt()|0,pn((dc(A,L)|0)+(dc(M,C)|0)+g|g&0|0),v|0|0|0}function Fg(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0,k=0,z=0,Z=0,nt=0;return C=It,It=It+16|0,z=C|0,k=A>>31|((A|0)<0?-1:0)<<1,L=((A|0)<0?-1:0)>>31|((A|0)<0?-1:0)<<1,nt=M>>31|((M|0)<0?-1:0)<<1,Z=((M|0)<0?-1:0)>>31|((M|0)<0?-1:0)<<1,g=Oa(k^g|0,L^A|0,k|0,L|0)|0,A=Bt()|0,Px(g,A,Oa(nt^v|0,Z^M|0,nt|0,Z|0)|0,Bt()|0,z)|0,M=Oa(_[z>>2]^k|0,_[z+4>>2]^L|0,k|0,L|0)|0,v=Bt()|0,It=C,pn(v|0),M|0}function bh(g,A,v,M){g=g|0,A=A|0,v=v|0,M=M|0;var C=0,L=0;return L=It,It=It+16|0,C=L|0,Px(g,A,v,M,C)|0,It=L,pn(_[C+4>>2]|0),_[C>>2]|0|0}function Ix(g,A,v){return g=g|0,A=A|0,v=v|0,(v|0)<32?(pn(A>>v|0),g>>>v|(A&(1<<v)-1)<<32-v):(pn(((A|0)<0?-1:0)|0),A>>v-32|0)}function Qe(g,A,v){return g=g|0,A=A|0,v=v|0,(v|0)<32?(pn(A>>>v|0),g>>>v|(A&(1<<v)-1)<<32-v):(pn(0),A>>>v-32|0)}function xr(g,A,v){return g=g|0,A=A|0,v=v|0,(v|0)<32?(pn(A<<v|(g&(1<<v)-1<<32-v)>>>32-v|0),g<<v):(pn(g<<v-32|0),0)}function VT(g,A){return g=+g,A=+A,g!=g?+A:A!=A?+g:+Ai(+g,+A)}function Rx(g,A){return g=+g,A=+A,g!=g?+A:A!=A?+g:+Su(+g,+A)}function zg(g){return g=+g,g>=0?+ji(g+.5):+Mu(g-.5)}function Ug(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0;if((v|0)>=8192)return Ts(g|0,A|0,v|0)|0,g|0;if(L=g|0,C=g+v|0,(g&3)==(A&3)){for(;g&3;){if(!v)return L|0;jr[g>>0]=jr[A>>0]|0,g=g+1|0,A=A+1|0,v=v-1|0}for(v=C&-4|0,M=v-64|0;(g|0)<=(M|0);)_[g>>2]=_[A>>2],_[g+4>>2]=_[A+4>>2],_[g+8>>2]=_[A+8>>2],_[g+12>>2]=_[A+12>>2],_[g+16>>2]=_[A+16>>2],_[g+20>>2]=_[A+20>>2],_[g+24>>2]=_[A+24>>2],_[g+28>>2]=_[A+28>>2],_[g+32>>2]=_[A+32>>2],_[g+36>>2]=_[A+36>>2],_[g+40>>2]=_[A+40>>2],_[g+44>>2]=_[A+44>>2],_[g+48>>2]=_[A+48>>2],_[g+52>>2]=_[A+52>>2],_[g+56>>2]=_[A+56>>2],_[g+60>>2]=_[A+60>>2],g=g+64|0,A=A+64|0;for(;(g|0)<(v|0);)_[g>>2]=_[A>>2],g=g+4|0,A=A+4|0}else for(v=C-4|0;(g|0)<(v|0);)jr[g>>0]=jr[A>>0]|0,jr[g+1>>0]=jr[A+1>>0]|0,jr[g+2>>0]=jr[A+2>>0]|0,jr[g+3>>0]=jr[A+3>>0]|0,g=g+4|0,A=A+4|0;for(;(g|0)<(C|0);)jr[g>>0]=jr[A>>0]|0,g=g+1|0,A=A+1|0;return L|0}function Mp(g,A,v){g=g|0,A=A|0,v=v|0;var M=0,C=0,L=0,k=0;if(L=g+v|0,A=A&255,(v|0)>=67){for(;g&3;)jr[g>>0]=A,g=g+1|0;for(M=L&-4|0,k=A|A<<8|A<<16|A<<24,C=M-64|0;(g|0)<=(C|0);)_[g>>2]=k,_[g+4>>2]=k,_[g+8>>2]=k,_[g+12>>2]=k,_[g+16>>2]=k,_[g+20>>2]=k,_[g+24>>2]=k,_[g+28>>2]=k,_[g+32>>2]=k,_[g+36>>2]=k,_[g+40>>2]=k,_[g+44>>2]=k,_[g+48>>2]=k,_[g+52>>2]=k,_[g+56>>2]=k,_[g+60>>2]=k,g=g+64|0;for(;(g|0)<(M|0);)_[g>>2]=k,g=g+4|0}for(;(g|0)<(L|0);)jr[g>>0]=A,g=g+1|0;return L-v|0}function jT(g){return g=+g,g>=0?+ji(g+.5):+Mu(g-.5)}function yf(g){g=g|0;var A=0,v=0,M=0;return M=Jl()|0,v=_[ni>>2]|0,A=v+g|0,(g|0)>0&(A|0)<(v|0)|(A|0)<0?(il(A|0)|0,mp(12),-1):(A|0)>(M|0)&&!(af(A|0)|0)?(mp(12),-1):(_[ni>>2]=A,v|0)}return{___divdi3:Ep,___muldi3:ya,___remdi3:Fg,___uremdi3:bh,_areNeighborCells:Un,_bitshift64Ashr:Ix,_bitshift64Lshr:Qe,_bitshift64Shl:xr,_calloc:Vo,_cellAreaKm2:Ve,_cellAreaM2:Je,_cellAreaRads2:Me,_cellToBoundary:d,_cellToCenterChild:jd,_cellToChildPos:U,_cellToChildren:ff,_cellToChildrenSize:Bc,_cellToLatLng:Bu,_cellToLocalIj:ln,_cellToParent:yp,_cellToVertex:ys,_cellToVertexes:ku,_cellsToDirectedEdge:Sl,_cellsToLinkedMultiPolygon:nr,_childPosToCell:j,_compactCells:pf,_destroyLinkedMultiPolygon:ei,_directedEdgeToBoundary:Es,_directedEdgeToCells:Pu,_edgeLengthKm:wr,_edgeLengthM:qr,_edgeLengthRads:$e,_emscripten_replace_memory:mc,_free:vn,_getBaseCellNumber:PA,_getDirectedEdgeDestination:Us,_getDirectedEdgeOrigin:Oc,_getHexagonAreaAvgKm2:Dt,_getHexagonAreaAvgM2:Xt,_getHexagonEdgeLengthAvgKm:te,_getHexagonEdgeLengthAvgM:le,_getIcosahedronFaces:m,_getNumCells:be,_getPentagons:O,_getRes0Cells:qa,_getResolution:Ss,_greatCircleDistanceKm:Pt,_greatCircleDistanceM:Vt,_greatCircleDistanceRads:Ct,_gridDisk:eu,_gridDiskDistances:Cu,_gridDistance:an,_gridPathCells:gs,_gridPathCellsSize:en,_gridRingUnsafe:ne,_i64Add:ui,_i64Subtract:Oa,_isPentagon:ii,_isResClassIII:df,_isValidCell:nu,_isValidDirectedEdge:_h,_isValidVertex:gi,_latLngToCell:Hd,_llvm_maxnum_f64:VT,_llvm_minnum_f64:Rx,_llvm_round_f64:zg,_localIjToCell:Tn,_malloc:Il,_maxFaceCount:y,_maxGridDiskSize:lf,_maxPolygonToCellsSize:_e,_memcpy:Ug,_memset:Mp,_originToDirectedEdges:ol,_pentagonCount:T,_polygonToCells:ze,_readInt64AsDoubleFromPointer:Af,_res0CellCount:zs,_round:jT,_sbrk:yf,_sizeOfCellBoundary:Du,_sizeOfCoordIJ:bp,_sizeOfGeoLoop:La,_sizeOfGeoPolygon:sl,_sizeOfH3Index:Ka,_sizeOfLatLng:ga,_sizeOfLinkedGeoPolygon:Dc,_uncompactCells:xp,_uncompactCellsSize:IA,_vertexToLatLng:vh,establishStackSpace:cf,stackAlloc:Tl,stackRestore:ph,stackSave:tu}}(bt,Lt,ct),Qt=t.___divdi3=vt.___divdi3,Jt=t.___muldi3=vt.___muldi3,St=t.___remdi3=vt.___remdi3,jt=t.___uremdi3=vt.___uremdi3,ce=t._areNeighborCells=vt._areNeighborCells,je=t._bitshift64Ashr=vt._bitshift64Ashr,Ge=t._bitshift64Lshr=vt._bitshift64Lshr,Pe=t._bitshift64Shl=vt._bitshift64Shl,We=t._calloc=vt._calloc,Rr=t._cellAreaKm2=vt._cellAreaKm2,Cr=t._cellAreaM2=vt._cellAreaM2,Re=t._cellAreaRads2=vt._cellAreaRads2,yr=t._cellToBoundary=vt._cellToBoundary,tr=t._cellToCenterChild=vt._cellToCenterChild,cr=t._cellToChildPos=vt._cellToChildPos,wn=t._cellToChildren=vt._cellToChildren,fr=t._cellToChildrenSize=vt._cellToChildrenSize,On=t._cellToLatLng=vt._cellToLatLng,Ci=t._cellToLocalIj=vt._cellToLocalIj,Bn=t._cellToParent=vt._cellToParent,Zn=t._cellToVertex=vt._cellToVertex,Yn=t._cellToVertexes=vt._cellToVertexes,Ns=t._cellsToDirectedEdge=vt._cellsToDirectedEdge,di=t._cellsToLinkedMultiPolygon=vt._cellsToLinkedMultiPolygon,yo=t._childPosToCell=vt._childPosToCell,Pi=t._compactCells=vt._compactCells,Dn=t._destroyLinkedMultiPolygon=vt._destroyLinkedMultiPolygon,ci=t._directedEdgeToBoundary=vt._directedEdgeToBoundary,pa=t._directedEdgeToCells=vt._directedEdgeToCells,lh=t._edgeLengthKm=vt._edgeLengthKm,ns=t._edgeLengthM=vt._edgeLengthM,ks=t._edgeLengthRads=vt._edgeLengthRads,tf=t._emscripten_replace_memory=vt._emscripten_replace_memory,ws=t._free=vt._free,Xi=t._getBaseCellNumber=vt._getBaseCellNumber,Yl=t._getDirectedEdgeDestination=vt._getDirectedEdgeDestination,Zs=t._getDirectedEdgeOrigin=vt._getDirectedEdgeOrigin,ms=t._getHexagonAreaAvgKm2=vt._getHexagonAreaAvgKm2,Sa=t._getHexagonAreaAvgM2=vt._getHexagonAreaAvgM2,Yi=t._getHexagonEdgeLengthAvgKm=vt._getHexagonEdgeLengthAvgKm,Ca=t._getHexagonEdgeLengthAvgM=vt._getHexagonEdgeLengthAvgM,Pa=t._getIcosahedronFaces=vt._getIcosahedronFaces,yA=t._getNumCells=vt._getNumCells,fc=t._getPentagons=vt._getPentagons,Rc=t._getRes0Cells=vt._getRes0Cells,rl=t._getResolution=vt._getResolution,ko=t._greatCircleDistanceKm=vt._greatCircleDistanceKm,nl=t._greatCircleDistanceM=vt._greatCircleDistanceM,$s=t._greatCircleDistanceRads=vt._greatCircleDistanceRads,Ha=t._gridDisk=vt._gridDisk,wu=t._gridDiskDistances=vt._gridDiskDistances,Id=t._gridDistance=vt._gridDistance,Rd=t._gridPathCells=vt._gridPathCells,ef=t._gridPathCellsSize=vt._gridPathCellsSize,Ld=t._gridRingUnsafe=vt._gridRingUnsafe,Od=t._i64Add=vt._i64Add,Bd=t._i64Subtract=vt._i64Subtract,Dd=t._isPentagon=vt._isPentagon,uh=t._isResClassIII=vt._isResClassIII,hp=t._isValidCell=vt._isValidCell,rf=t._isValidDirectedEdge=vt._isValidDirectedEdge,xA=t._isValidVertex=vt._isValidVertex,hh=t._latLngToCell=vt._latLngToCell,pc=t._llvm_maxnum_f64=vt._llvm_maxnum_f64,Kl=t._llvm_minnum_f64=vt._llvm_minnum_f64,Zl=t._llvm_round_f64=vt._llvm_round_f64,Tu=t._localIjToCell=vt._localIjToCell,$l=t._malloc=vt._malloc,Ql=t._maxFaceCount=vt._maxFaceCount,fp=t._maxGridDiskSize=vt._maxGridDiskSize,da=t._maxPolygonToCellsSize=vt._maxPolygonToCellsSize,xo=t._memcpy=vt._memcpy,Eu=t._memset=vt._memset,pp=t._originToDirectedEdges=vt._originToDirectedEdges,vA=t._pentagonCount=vt._pentagonCount,bA=t._polygonToCells=vt._polygonToCells,nf=t._readInt64AsDoubleFromPointer=vt._readInt64AsDoubleFromPointer,Nd=t._res0CellCount=vt._res0CellCount,kd=t._round=vt._round,Fd=t._sbrk=vt._sbrk,fh=t._sizeOfCellBoundary=vt._sizeOfCellBoundary,zd=t._sizeOfCoordIJ=vt._sizeOfCoordIJ,Ud=t._sizeOfGeoLoop=vt._sizeOfGeoLoop,of=t._sizeOfGeoPolygon=vt._sizeOfGeoPolygon,sf=t._sizeOfH3Index=vt._sizeOfH3Index,wA=t._sizeOfLatLng=vt._sizeOfLatLng,R=t._sizeOfLinkedGeoPolygon=vt._sizeOfLinkedGeoPolygon,V=t._uncompactCells=vt._uncompactCells,Y=t._uncompactCellsSize=vt._uncompactCellsSize,tt=t._vertexToLatLng=vt._vertexToLatLng,ht=t.establishStackSpace=vt.establishStackSpace,ft=t.stackAlloc=vt.stackAlloc,xt=t.stackRestore=vt.stackRestore,Kt=t.stackSave=vt.stackSave;if(t.asm=vt,t.cwrap=$,t.setValue=P,t.getValue=B,zr){ho(zr)||(zr=s(zr));{Nr("memory initializer");var Wt=function(se){se.byteLength&&(se=new Uint8Array(se)),ee.set(se,E),t.memoryInitializerRequest&&delete t.memoryInitializerRequest.response,ar("memory initializer")},oe=function(){c(zr,Wt,function(){throw"could not load memory initializer "+zr})},Oe=At(zr);if(Oe)Wt(Oe.buffer);else if(t.memoryInitializerRequest){var Fe=function(){var se=t.memoryInitializerRequest,ve=se.response;if(se.status!==200&&se.status!==0){var er=At(t.memoryInitializerRequestURL);if(er)ve=er.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+se.status+", retrying "+zr),oe();return}}Wt(ve)};t.memoryInitializerRequest.response?setTimeout(Fe,0):t.memoryInitializerRequest.addEventListener("load",Fe)}else oe()}}var ae;_o=function se(){ae||rr(),ae||(_o=se)};function rr(se){if(se=se||i,Cn>0||(Ee(),Cn>0))return;function ve(){ae||(ae=!0,!D&&(Jr(),bn(),t.onRuntimeInitialized&&t.onRuntimeInitialized(),ai()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),ve()},1)):ve()}t.run=rr;function fn(se){throw t.onAbort&&t.onAbort(se),se+="",l(se),h(se),D=!0,"abort("+se+"). Build with -s ASSERTIONS=1 for more info."}if(t.abort=fn,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return rr(),e}(typeof no=="object"?no:{}),oi="number",zn=oi,$b=oi,qn=oi,Gn=oi,jc=oi,rn=oi,cEt=[["sizeOfH3Index",oi],["sizeOfLatLng",oi],["sizeOfCellBoundary",oi],["sizeOfGeoLoop",oi],["sizeOfGeoPolygon",oi],["sizeOfLinkedGeoPolygon",oi],["sizeOfCoordIJ",oi],["readInt64AsDoubleFromPointer",oi],["isValidCell",$b,[qn,Gn]],["latLngToCell",zn,[oi,oi,jc,rn]],["cellToLatLng",zn,[qn,Gn,rn]],["cellToBoundary",zn,[qn,Gn,rn]],["maxGridDiskSize",zn,[oi,rn]],["gridDisk",zn,[qn,Gn,oi,rn]],["gridDiskDistances",zn,[qn,Gn,oi,rn,rn]],["gridRingUnsafe",zn,[qn,Gn,oi,rn]],["maxPolygonToCellsSize",zn,[rn,jc,oi,rn]],["polygonToCells",zn,[rn,jc,oi,rn]],["cellsToLinkedMultiPolygon",zn,[rn,oi,rn]],["destroyLinkedMultiPolygon",null,[rn]],["compactCells",zn,[rn,rn,oi,oi]],["uncompactCells",zn,[rn,oi,oi,rn,oi,jc]],["uncompactCellsSize",zn,[rn,oi,oi,jc,rn]],["isPentagon",$b,[qn,Gn]],["isResClassIII",$b,[qn,Gn]],["getBaseCellNumber",oi,[qn,Gn]],["getResolution",oi,[qn,Gn]],["maxFaceCount",zn,[qn,Gn,rn]],["getIcosahedronFaces",zn,[qn,Gn,rn]],["cellToParent",zn,[qn,Gn,jc,rn]],["cellToChildren",zn,[qn,Gn,jc,rn]],["cellToCenterChild",zn,[qn,Gn,jc,rn]],["cellToChildrenSize",zn,[qn,Gn,jc,rn]],["cellToChildPos",zn,[qn,Gn,jc,rn]],["childPosToCell",zn,[oi,oi,qn,Gn,jc,rn]],["areNeighborCells",zn,[qn,Gn,qn,Gn,rn]],["cellsToDirectedEdge",zn,[qn,Gn,qn,Gn,rn]],["getDirectedEdgeOrigin",zn,[qn,Gn,rn]],["getDirectedEdgeDestination",zn,[qn,Gn,rn]],["isValidDirectedEdge",$b,[qn,Gn]],["directedEdgeToCells",zn,[qn,Gn,rn]],["originToDirectedEdges",zn,[qn,Gn,rn]],["directedEdgeToBoundary",zn,[qn,Gn,rn]],["gridDistance",zn,[qn,Gn,qn,Gn,rn]],["gridPathCells",zn,[qn,Gn,qn,Gn,rn]],["gridPathCellsSize",zn,[qn,Gn,qn,Gn,rn]],["cellToLocalIj",zn,[qn,Gn,qn,Gn,oi,rn]],["localIjToCell",zn,[qn,Gn,rn,oi,rn]],["getHexagonAreaAvgM2",zn,[jc,rn]],["getHexagonAreaAvgKm2",zn,[jc,rn]],["getHexagonEdgeLengthAvgM",zn,[jc,rn]],["getHexagonEdgeLengthAvgKm",zn,[jc,rn]],["greatCircleDistanceM",oi,[rn,rn]],["greatCircleDistanceKm",oi,[rn,rn]],["greatCircleDistanceRads",oi,[rn,rn]],["cellAreaM2",zn,[qn,Gn,rn]],["cellAreaKm2",zn,[qn,Gn,rn]],["cellAreaRads2",zn,[qn,Gn,rn]],["edgeLengthM",zn,[qn,Gn,rn]],["edgeLengthKm",zn,[qn,Gn,rn]],["edgeLengthRads",zn,[qn,Gn,rn]],["getNumCells",zn,[jc,rn]],["getRes0Cells",zn,[rn]],["res0CellCount",oi],["getPentagons",zn,[oi,rn]],["pentagonCount",oi],["cellToVertex",zn,[qn,Gn,oi,rn]],["cellToVertexes",zn,[qn,Gn,rn]],["vertexToLatLng",zn,[qn,Gn,rn]],["isValidVertex",$b,[qn,Gn]]],lEt=0,uEt=1,hEt=2,fEt=3,EZ=4,pEt=5,dEt=6,mEt=7,AEt=8,gEt=9,_Et=10,yEt=11,xEt=12,vEt=13,bEt=14,wEt=15,Mc={};Mc[lEt]="Success";Mc[uEt]="The operation failed but a more specific error is not available";Mc[hEt]="Argument was outside of acceptable range";Mc[fEt]="Latitude or longitude arguments were outside of acceptable range";Mc[EZ]="Resolution argument was outside of acceptable range";Mc[pEt]="Cell argument was not valid";Mc[dEt]="Directed edge argument was not valid";Mc[mEt]="Undirected edge argument was not valid";Mc[AEt]="Vertex argument was not valid";Mc[gEt]="Pentagon distortion was encountered";Mc[_Et]="Duplicate input";Mc[yEt]="Cell arguments were not neighbors";Mc[xEt]="Cell arguments had incompatible resolutions";Mc[vEt]="Memory allocation failed";Mc[bEt]="Bounds of provided memory were insufficient";Mc[wEt]="Mode or flags argument was not valid";var MZ=1e3,TEt=1001,SZ=1002,tC={};tC[MZ]="Unknown unit";tC[TEt]="Array length out of bounds";tC[SZ]="Got unexpected null value for H3 index";var EEt="Unknown error";function CZ(e,t,r){var n=r&&"value"in r,i=new Error((e[t]||EEt)+" (code: "+t+(n?", value: "+r.value:"")+")");return i.code=t,i}function PZ(e,t){var r=arguments.length===2?{value:t}:{};return CZ(Mc,e,r)}function IZ(e,t){var r=arguments.length===2?{value:t}:{};return CZ(tC,e,r)}function N0(e){if(e!==0)throw PZ(e)}var Ta={};cEt.forEach(function(t){Ta[t[0]]=no.cwrap.apply(no,t)});var Ny=16;var RZ=4,bZ=4,Dm=8,MEt=8,Q3=Ta.sizeOfH3Index(),LZ=Ta.sizeOfLatLng(),SEt=Ta.sizeOfCellBoundary(),yye=Ta.sizeOfGeoPolygon(),xye=Ta.sizeOfGeoLoop(),CEt=Ta.sizeOfLinkedGeoPolygon(),vye=Ta.sizeOfCoordIJ(),wZ={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function PEt(e){if(typeof e!="number"||e<0||e>15||Math.floor(e)!==e)throw PZ(EZ,e);return e}function IEt(e){if(!e)throw IZ(SZ);return e}var bye=Math.pow(2,32)-1;var REt=/[^0-9a-fA-F]/;function k0(e){if(Array.isArray(e)&&e.length===2&&Number.isInteger(e[0])&&Number.isInteger(e[1]))return e;if(typeof e!="string"||REt.test(e))return[0,0];var t=parseInt(e.substring(0,e.length-8),Ny),r=parseInt(e.substring(e.length-8),Ny);return[r,t]}function TZ(e){if(e>=0)return e.toString(Ny);e=e&2147483647;var t=OZ(8,e.toString(Ny)),r=(parseInt(t[0],Ny)+8).toString(Ny);return t=r+t.substring(1),t}function LEt(e,t){return TZ(t)+OZ(8,TZ(e))}function OZ(e,t){for(var r=e-t.length,n="",i=0;i<r;i++)n+="0";return n=n+t,n}var wye=Math.pow(2,32);function OEt(e,t){t===void 0&&(t=0);var r=no.getValue(e+Q3*t,"i32"),n=no.getValue(e+Q3*t+RZ,"i32");return n?LEt(r,n):null}function BEt(e,t){return t===void 0&&(t=0),no.getValue(e+Dm*t,"double")}function DEt(e){return Ta.readInt64AsDoubleFromPointer(e)}function NEt(e,t,r){no.HEAPU32.set(k0(e),t/RZ+2*r)}function kEt(e,t){for(var r=t.length,n=0;n<r;n++)NEt(t[n],e,n)}function J3(e){return VEt(no.getValue(e,"double"))}function SN(e){return[J3(e),J3(e+Dm)]}function BZ(e){return[J3(e+Dm),J3(e)]}function FEt(e,t,r){for(var n=no.getValue(e,"i32"),i=e+Dm,o=[],s=t?BZ:SN,c=0;c<n*2;c+=2)o.push(s(i+Dm*c));return r&&o.push(o[0]),o}function zEt(e,t){for(var r=[],n=t?BZ:SN,i,o,s,c;e;){for(r.push(i=[]),o=no.getValue(e,"i8*");o;){for(i.push(s=[]),c=no.getValue(o,"i8*");c;)s.push(n(c)),c=no.getValue(c+Dm*2,"i8*");t&&s.push(s[0]),o=no.getValue(o+bZ*2,"i8*")}e=no.getValue(e+bZ*2,"i8*")}return r}function DZ(e){var t=k0(e),r=t[0],n=t[1];return Boolean(Ta.isPentagon(r,n))}function NZ(e){var t=k0(e),r=t[0],n=t[1];return Ta.isValidCell(r,n)?Ta.getResolution(r,n):-1}function kZ(e,t,r){var n=no._malloc(LZ);no.HEAPF64.set([e,t].map(UEt),n/Dm);var i=no._malloc(Q3);try{return N0(Ta.latLngToCell(n,r,i)),IEt(OEt(i))}finally{no._free(i),no._free(n)}}function Qb(e){var t=no._malloc(LZ),r=k0(e),n=r[0],i=r[1];try{return N0(Ta.cellToLatLng(n,i,t)),SN(t)}finally{no._free(t)}}function FZ(e,t){var r=no._malloc(SEt),n=k0(e),i=n[0],o=n[1];try{return N0(Ta.cellToBoundary(i,o,r)),FEt(r,t,t)}finally{no._free(r)}}function zZ(e,t){if(!e||!e.length)return[];var r=e.length,n=no._calloc(r,Q3);kEt(n,e);var i=no._calloc(CEt);try{return N0(Ta.cellsToLinkedMultiPolygon(n,r,i)),zEt(i,t)}finally{Ta.destroyLinkedMultiPolygon(i),no._free(i),no._free(n)}}function UZ(e,t){var r=k0(e),n=r[0],i=r[1],o=k0(t),s=o[0],c=o[1],l=no._malloc(MEt);try{return N0(Ta.gridDistance(n,i,s,c,l)),DEt(l)}finally{no._free(l)}}function VZ(e,t){PEt(e);var r=no._malloc(Dm);try{switch(t){case wZ.m:N0(Ta.getHexagonEdgeLengthAvgM(e,r));break;case wZ.km:N0(Ta.getHexagonEdgeLengthAvgKm(e,r));break;default:throw IZ(MZ,t)}return BEt(r)}finally{no._free(r)}}function UEt(e){return e*Math.PI/180}function VEt(e){return e*180/Math.PI}function eC(e,t){t=t===void 0?e[0][0]:t;for(let r of e){let n=r[0]-t;n>180?r[0]-=360:n<-180&&(r[0]+=360)}}function jEt(e,t,r){let[n,i]=Qb(e),o=t.length;eC(t,i);let s=t[0]===t[o-1]?o-1:o;for(let c=0;c<s;c++)t[c][0]=ka(i,t[c][0],r),t[c][1]=ka(n,t[c][1],r)}function jZ(e,t,r){let n=e(t,r),[i,o]=Qb(n);return[o,i]}function CN(e,t=1){let r=FZ(e,!0);return t!==1?jEt(e,r,t):eC(r),r}function HZ(e){let t=new Float64Array(e.length*2),r=0;for(let n of e)t[r++]=n[0],t[r++]=n[1];return t}var HEt=10;function WEt(e,t){let r;return e==null?r=t:typeof e=="object"?r={...e,coverage:t}:r={getHexagon:e,coverage:t},r}var qEt={...Mm.defaultProps,highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:e=>e.hexagon},extruded:!0},Nm=class extends vs{initializeState(){Nm._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}shouldUpdateState({changeFlags:t}){return this._shouldUseHighPrecision()?t.propsOrDataChanged:t.somethingChanged}updateState({props:t,changeFlags:r}){if(t.highPrecision!==!0&&(r.dataChanged||r.updateTriggersChanged&&r.updateTriggersChanged.getHexagon)){let n=this._calculateH3DataProps();this.setState(n)}this._updateVertices(this.context.viewport)}_calculateH3DataProps(){let t=-1,r=!1,n=!1,{iterable:i,objectInfo:o}=Xs(this.props.data);for(let s of i){o.index++;let c=this.props.getHexagon(s,o),l=NZ(c);if(t<0){if(t=l,!this.props.highPrecision)break}else if(t!==l){n=!0;break}if(DZ(c)){r=!0;break}}return{resolution:t,edgeLengthKM:t>=0?VZ(t,"km"):0,hasMultipleRes:n,hasPentagon:r}}_shouldUseHighPrecision(){if(this.props.highPrecision==="auto"){let{resolution:t,hasPentagon:r,hasMultipleRes:n}=this.state,{viewport:i}=this.context;return Boolean(i?.resolution)||n||r||t>=0&&t<=5}return this.props.highPrecision}_updateVertices(t){if(this._shouldUseHighPrecision())return;let{resolution:r,edgeLengthKM:n,centerHex:i}=this.state;if(r<0)return;let o=this.props.centerHexagon||kZ(t.latitude,t.longitude,r);if(i===o)return;if(i)try{if(UZ(i,o)*n<HEt)return}catch{}let{unitsPerMeter:s}=t.distanceScales,c=CN(o),[l,h]=Qb(o),[p,x]=t.projectFlat([h,l]);c=c.map(w=>{let E=t.projectFlat(w);return[(E[0]-p)/s[0],(E[1]-x)/s[1]]}),this.setState({centerHex:o,vertices:c})}renderLayers(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}_getForwardProps(){let{elevationScale:t,material:r,coverage:n,extruded:i,wireframe:o,stroked:s,filled:c,lineWidthUnits:l,lineWidthScale:h,lineWidthMinPixels:p,lineWidthMaxPixels:x,getFillColor:w,getElevation:E,getLineColor:P,getLineWidth:B,transitions:D,updateTriggers:W}=this.props;return{elevationScale:t,extruded:i,coverage:n,wireframe:o,stroked:s,filled:c,lineWidthUnits:l,lineWidthScale:h,lineWidthMinPixels:p,lineWidthMaxPixels:x,material:r,getElevation:E,getFillColor:w,getLineColor:P,getLineWidth:B,transitions:D,updateTriggers:{getFillColor:W.getFillColor,getElevation:W.getElevation,getLineColor:W.getLineColor,getLineWidth:W.getLineWidth}}}_renderPolygonLayer(){let{data:t,getHexagon:r,updateTriggers:n,coverage:i}=this.props,o=this.getSubLayerClass("hexagon-cell-hifi",Mm),s=this._getForwardProps();return s.updateTriggers.getPolygon=WEt(n.getHexagon,i),new o(s,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:s.updateTriggers}),{data:t,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:(c,l)=>{let h=r(c,l);return HZ(CN(h,i))}})}_renderColumnLayer(){let{data:t,getHexagon:r,updateTriggers:n}=this.props,i=this.getSubLayerClass("hexagon-cell",Xf),o=this._getForwardProps();return o.updateTriggers.getPosition=n.getHexagon,new i(o,this.getSubLayerProps({id:"hexagon-cell",flatShading:!0,updateTriggers:o.updateTriggers}),{data:t,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:jZ.bind(null,r)})}};Nm.defaultProps=qEt;Nm.layerName="H3HexagonLayer";Nm._checkH3Lib=()=>{};var rC=Nm;var GEt={getHexagons:{type:"accessor",value:e=>e.hexagons}},Jb=class extends Zf{initializeState(){rC._checkH3Lib()}updateState({props:t,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&r.updateTriggersChanged.getHexagons){let{data:n,getHexagons:i}=t,o=[],{iterable:s,objectInfo:c}=Xs(n);for(let l of s){c.index++;let h=i(l,c),p=zZ(h,!0);for(let x of p){for(let w of x)eC(w);o.push(this.getSubLayerRow({polygon:x},l,c.index))}}this.setState({polygons:o})}}indexToBounds(){let{getElevation:t,getFillColor:r,getLineColor:n,getLineWidth:i}=this.props;return{data:this.state.polygons,getPolygon:o=>o.polygon,getElevation:this.getSubLayerAccessor(t),getFillColor:this.getSubLayerAccessor(r),getLineColor:this.getSubLayerAccessor(n),getLineWidth:this.getSubLayerAccessor(i)}}};Jb.layerName="H3ClusterLayer";Jb.defaultProps=GEt;var WZ=Jb;var PN=Math.PI/180,nC=new Float32Array(16),qZ=new Float32Array(12);function GZ(e,t,r){let n=t[0]*PN,i=t[1]*PN,o=t[2]*PN,s=Math.sin(o),c=Math.sin(n),l=Math.sin(i),h=Math.cos(o),p=Math.cos(n),x=Math.cos(i),w=r[0],E=r[1],P=r[2];e[0]=w*x*p,e[1]=w*l*p,e[2]=w*-c,e[3]=E*(-l*h+x*c*s),e[4]=E*(x*h+l*c*s),e[5]=E*p*s,e[6]=P*(l*s+x*c*h),e[7]=P*(-x*s+l*c*h),e[8]=P*p*h}function XZ(e){return e[0]=e[0],e[1]=e[1],e[2]=e[2],e[3]=e[4],e[4]=e[5],e[5]=e[6],e[6]=e[8],e[7]=e[9],e[8]=e[10],e[9]=e[12],e[10]=e[13],e[11]=e[14],e.subarray(0,12)}var iC={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrixCol0:{size:3,elementOffset:0},instanceModelMatrixCol1:{size:3,elementOffset:3},instanceModelMatrixCol2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(e,{startRow:t,endRow:r}){let{data:n,getOrientation:i,getScale:o,getTranslation:s,getTransformMatrix:c}=this.props,l=Array.isArray(c),h=l&&c.length===16,p=Array.isArray(o),x=Array.isArray(i),w=Array.isArray(s),E=h||!l&&Boolean(c(n[0]));E?e.constant=h:e.constant=x&&p&&w;let P=e.value;if(e.constant){let B;E?(nC.set(c),B=XZ(nC)):(B=qZ,GZ(B,i,o),B.set(s,9)),e.value=new Float32Array(B)}else{let B=t*e.size,{iterable:D,objectInfo:W}=Xs(n,t,r);for(let X of D){W.index++;let q;if(E)nC.set(h?c:c(X,W)),q=XZ(nC);else{q=qZ;let $=x?i:i(X,W),et=p?o:o(X,W);GZ(q,$,et),q.set(w?s:s(X,W),9)}P[B++]=q[0],P[B++]=q[1],P[B++]=q[2],P[B++]=q[3],P[B++]=q[4],P[B++]=q[5],P[B++]=q[6],P[B++]=q[7],P[B++]=q[8],P[B++]=q[9],P[B++]=q[10],P[B++]=q[11]}}}};function oC(e,t){return t===Yr.CARTESIAN||t===Yr.METER_OFFSETS||t===Yr.DEFAULT&&!e.isGeospatial}var YZ=`uniform simpleMeshUniforms {
  float sizeScale;
  bool composeModelMatrix;
  bool hasTexture;
  bool flatShading;
} simpleMesh;
`,KZ={name:"simpleMesh",vs:YZ,fs:YZ,uniformTypes:{sizeScale:"f32",composeModelMatrix:"f32",hasTexture:"f32",flatShading:"f32"}};var ZZ=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec3 instanceModelMatrixCol0;
in vec3 instanceModelMatrixCol1;
in vec3 instanceModelMatrixCol2;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = texCoords;
geometry.pickingColor = instancePickingColors;
vTexCoord = texCoords;
cameraPosition = project.cameraPosition;
vColor = vec4(colors * instanceColors.rgb, instanceColors.a);
mat3 instanceModelMatrix = mat3(instanceModelMatrixCol0, instanceModelMatrixCol1, instanceModelMatrixCol2);
vec3 pos = (instanceModelMatrix * positions) * simpleMesh.sizeScale + instanceTranslation;
if (simpleMesh.composeModelMatrix) {
DECKGL_FILTER_SIZE(pos, geometry);
normals_commonspace = project_normal(instanceModelMatrix * normals);
geometry.worldPosition += pos;
gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
geometry.position = position_commonspace;
}
else {
pos = project_size(pos);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
geometry.position = position_commonspace;
normals_commonspace = project_normal(instanceModelMatrix * normals);
}
geometry.normal = normals_commonspace;
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var $Z=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs
precision highp float;
uniform sampler2D sampler;
in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
geometry.uv = vTexCoord;
vec3 normal;
if (simpleMesh.flatShading) {
normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
} else {
normal = normals_commonspace;
}
vec4 color = simpleMesh.hasTexture ? texture(sampler, vTexCoord) : vColor;
DECKGL_FILTER_COLOR(color, geometry);
vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
fragColor = vec4(lightColor, color.a * layer.opacity);
}
`;function IN(e){let t=e.positions||e.POSITION;br.assert(t,'no "postions" or "POSITION" attribute in mesh');let r=t.value.length/t.size,n=e.COLOR_0||e.colors;n||(n={size:3,value:new Float32Array(r*3).fill(1)});let i=e.NORMAL||e.normals;i||(i={size:3,value:new Float32Array(r*3).fill(0)});let o=e.TEXCOORD_0||e.texCoords;return o||(o={size:2,value:new Float32Array(r*2).fill(0)}),{positions:t,colors:n,normals:i,texCoords:o}}function QZ(e){return e instanceof Mi?(e.attributes=IN(e.attributes),e):e.attributes?new Mi({...e,topology:"triangle-list",attributes:IN(e.attributes)}):new Mi({topology:"triangle-list",attributes:IN(e)})}var XEt=[0,0,0,255],YEt={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:e=>e.position},getColor:{type:"accessor",value:XEt},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0,value:null}},tw=class extends qi{getShaders(){return super.getShaders({vs:ZZ,fs:$Z,modules:[Ei,q_,Mo,KZ]})}getBounds(){if(this.props._instanced)return super.getBounds();let t=this.state.positionBounds;if(t)return t;let{mesh:r}=this.props;if(!r)return null;if(t=r.header?.boundingBox,!t){let{attributes:n}=QZ(r);n.POSITION=n.POSITION||n.positions,t=Bp(n)}return this.state.positionBounds=t,t}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:"float64",fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:"unorm8",transition:!0,size:this.props.colorFormat.length,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:iC}),this.setState({emptyTexture:this.context.device.createTexture({data:new Uint8Array(4),width:1,height:1})})}updateState(t){super.updateState(t);let{props:r,oldProps:n,changeFlags:i}=t;if(r.mesh!==n.mesh||i.extensionsChanged){if(this.state.positionBounds=null,this.state.model?.destroy(),r.mesh){this.state.model=this.getModel(r.mesh);let o=r.mesh.attributes||r.mesh;this.setState({hasNormals:Boolean(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}r.texture!==n.texture&&r.texture instanceof fi&&this.setTexture(r.texture),this.state.model&&this.state.model.setTopology(this.props.wireframe?"line-strip":"triangle-list")}finalizeState(t){super.finalizeState(t),this.state.emptyTexture.delete()}draw({uniforms:t}){let{model:r}=this.state;if(!r)return;let{viewport:n,renderPass:i}=this.context,{sizeScale:o,coordinateSystem:s,_instanced:c}=this.props,l={sizeScale:o,composeModelMatrix:!c||oC(n,s),flatShading:!this.state.hasNormals};r.shaderInputs.setProps({simpleMesh:l}),r.draw(i)}get isLoaded(){return Boolean(this.state?.model&&super.isLoaded)}getModel(t){let r=new jn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:QZ(t),isInstanced:!0}),{texture:n}=this.props,{emptyTexture:i}=this.state,o={sampler:n||i,hasTexture:Boolean(n)};return r.shaderInputs.setProps({simpleMesh:o}),r}setTexture(t){let{emptyTexture:r,model:n}=this.state;if(n){let i={sampler:t||r,hasTexture:Boolean(t)};n.shaderInputs.setProps({simpleMesh:i})}}};tw.defaultProps=YEt;tw.layerName="SimpleMeshLayer";var F0=tw;var jh;(function(e){e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.ONE=1]="ONE",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.LINEAR=9729]="LINEAR",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL"})(jh||(jh={}));function rw(e,t,r,n){let i={defines:{MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},bindings:{},uniforms:{camera:[0,0,0],metallicRoughnessValues:[1,1]},parameters:{},glParameters:{},generatedTextures:[]};i.defines.USE_TEX_LOD=1;let{imageBasedLightingEnvironment:o}=n;return o&&(i.bindings.pbr_diffuseEnvSampler=o.diffuseEnvSampler.texture,i.bindings.pbr_specularEnvSampler=o.specularEnvSampler.texture,i.bindings.pbr_BrdfLUT=o.brdfLutTexture.texture,i.uniforms.scaleIBLAmbient=[1,1]),n?.pbrDebug&&(i.defines.PBR_DEBUG=1,i.uniforms.scaleDiffBaseMR=[0,0,0,0],i.uniforms.scaleFGDSpec=[0,0,0,0]),r.NORMAL&&(i.defines.HAS_NORMALS=1),r.TANGENT&&n?.useTangents&&(i.defines.HAS_TANGENTS=1),r.TEXCOORD_0&&(i.defines.HAS_UV=1),n?.imageBasedLightingEnvironment&&(i.defines.USE_IBL=1),n?.lights&&(i.defines.USE_LIGHTS=1),t&&KEt(e,t,i),i}function KEt(e,t,r){if(r.uniforms.unlit=Boolean(t.unlit),t.pbrMetallicRoughness&&ZEt(e,t.pbrMetallicRoughness,r),t.normalTexture){ew(e,t.normalTexture,"pbr_normalSampler","HAS_NORMALMAP",r);let{scale:n=1}=t.normalTexture;r.uniforms.normalScale=n}if(t.occlusionTexture){ew(e,t.occlusionTexture,"pbr_occlusionSampler","HAS_OCCLUSIONMAP",r);let{strength:n=1}=t.occlusionTexture;r.uniforms.occlusionStrength=n}switch(t.emissiveTexture&&(ew(e,t.emissiveTexture,"pbr_emissiveSampler","HAS_EMISSIVEMAP",r),r.uniforms.emissiveFactor=t.emissiveFactor||[0,0,0]),t.alphaMode){case"MASK":let{alphaCutoff:n=.5}=t;r.defines.ALPHA_CUTOFF=1,r.uniforms.alphaCutoff=n;break;case"BLEND":qe.warn("glTF BLEND alphaMode might not work well because it requires mesh sorting")(),r.parameters.blendColorOperation="add",r.parameters.blendColorSrcFactor="src-alpha",r.parameters.blendColorDstFactor="one-minus-src-alpha",r.parameters.blendAlphaOperation="add",r.parameters.blendAlphaSrcFactor="one",r.parameters.blendAlphaDstFactor="one-minus-src-alpha",r.glParameters.blend=!0,r.glParameters.blendEquation=jh.FUNC_ADD,r.glParameters.blendFunc=[jh.SRC_ALPHA,jh.ONE_MINUS_SRC_ALPHA,jh.ONE,jh.ONE_MINUS_SRC_ALPHA];break}}function ZEt(e,t,r){t.baseColorTexture&&ew(e,t.baseColorTexture,"pbr_baseColorSampler","HAS_BASECOLORMAP",r),r.uniforms.baseColorFactor=t.baseColorFactor||[1,1,1,1],t.metallicRoughnessTexture&&ew(e,t.metallicRoughnessTexture,"pbr_metallicRoughnessSampler","HAS_METALROUGHNESSMAP",r);let{metallicFactor:n=1,roughnessFactor:i=1}=t;r.uniforms.metallicRoughnessValues=[n,i]}function ew(e,t,r,n=null,i){let o=t?.texture?.sampler?.parameters||{},s=t.texture.source.image,c,l={};s.compressed?(c=s,l={[jh.TEXTURE_MIN_FILTER]:s.data.length>1?jh.LINEAR_MIPMAP_NEAREST:jh.LINEAR}):c={data:s};let h=e.createTexture({id:t.uniformName||t.id,parameters:{...o,...l},pixelStore:{[jh.UNPACK_FLIP_Y_WEBGL]:!1},...c});i.bindings[r]=h,n&&(i.defines[n]=1),i.generatedTextures.push(h)}var JZ="4.2.1";var sC={TRANSCODER:"basis_transcoder.js",TRANSCODER_WASM:"basis_transcoder.wasm",ENCODER:"basis_encoder.js",ENCODER_WASM:"basis_encoder.wasm"},t$;async function LN(e){PL(e.modules);let t=IL("basis");return t||(t$||=$Et(e),await t$)}async function $Et(e){let t=null,r=null;return[t,r]=await Promise.all([await Pf(sC.TRANSCODER,"textures",e),await Pf(sC.TRANSCODER_WASM,"textures",e)]),t=t||globalThis.BASIS,await QEt(t,r)}function QEt(e,t){let r={};return t&&(r.wasmBinary=t),new Promise(n=>{e(r).then(i=>{let{BasisFile:o,initializeBasis:s}=i;s(),n({BasisFile:o})})})}var RN;async function ON(e){let t=e.modules||{};return t.basisEncoder?t.basisEncoder:(RN=RN||JEt(e),await RN)}async function JEt(e){let t=null,r=null;return[t,r]=await Promise.all([await Pf(sC.ENCODER,"textures",e),await Pf(sC.ENCODER_WASM,"textures",e)]),t=t||globalThis.BASIS,await tMt(t,r)}function tMt(e,t){let r={};return t&&(r.wasmBinary=t),new Promise(n=>{e(r).then(i=>{let{BasisFile:o,KTX2File:s,initializeBasis:c,BasisEncoder:l}=i;c(),n({BasisFile:o,KTX2File:s,BasisEncoder:l})})})}var z0={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919};var eMt=["","WEBKIT_","MOZ_"],e$={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"},aC=null;function r$(e){if(!aC){e=e||rMt()||void 0,aC=new Set;for(let t of eMt)for(let r in e$)if(e&&e.getExtension(`${t}${r}`)){let n=e$[r];aC.add(n)}}return aC}function rMt(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}var c1e=new Uint8Array([0]);var n$,i$,o$,s$,a$,c$,l$,u$;(function(e){e[e.NONE=0]="NONE",e[e.BASISLZ=1]="BASISLZ",e[e.ZSTD=2]="ZSTD",e[e.ZLIB=3]="ZLIB"})(n$||(n$={})),function(e){e[e.BASICFORMAT=0]="BASICFORMAT"}(i$||(i$={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.ETC1S=163]="ETC1S",e[e.UASTC=166]="UASTC"}(o$||(o$={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.SRGB=1]="SRGB"}(s$||(s$={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.LINEAR=1]="LINEAR",e[e.SRGB=2]="SRGB",e[e.ITU=3]="ITU",e[e.NTSC=4]="NTSC",e[e.SLOG=5]="SLOG",e[e.SLOG2=6]="SLOG2"}(a$||(a$={})),function(e){e[e.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",e[e.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(c$||(c$={})),function(e){e[e.RGB=0]="RGB",e[e.RRR=3]="RRR",e[e.GGG=4]="GGG",e[e.AAA=15]="AAA"}(l$||(l$={})),function(e){e[e.RGB=0]="RGB",e[e.RGBA=3]="RGBA",e[e.RRR=4]="RRR",e[e.RRRG=5]="RRRG"}(u$||(u$={}));var pu=[171,75,84,88,32,50,48,187,13,10,26,10];function h$(e){let t=new Uint8Array(e);return!(t.byteLength<pu.length||t[0]!==pu[0]||t[1]!==pu[1]||t[2]!==pu[2]||t[3]!==pu[3]||t[4]!==pu[4]||t[5]!==pu[5]||t[6]!==pu[6]||t[7]!==pu[7]||t[8]!==pu[8]||t[9]!==pu[9]||t[10]!==pu[10]||t[11]!==pu[11])}var nMt={etc1:{basisFormat:0,compressed:!0,format:z0.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:z0.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:z0.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:z0.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:z0.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:z0.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function DN(e,t){if(t.basis.containerFormat==="auto"){if(h$(e)){let n=await ON(t);return f$(n.KTX2File,e,t)}let{BasisFile:r}=await LN(t);return BN(r,e,t)}switch(t.basis.module){case"encoder":let r=await ON(t);switch(t.basis.containerFormat){case"ktx2":return f$(r.KTX2File,e,t);case"basis":default:return BN(r.BasisFile,e,t)}case"transcoder":default:let{BasisFile:n}=await LN(t);return BN(n,e,t)}}function BN(e,t,r){let n=new e(new Uint8Array(t));try{if(!n.startTranscoding())throw new Error("Failed to start basis transcoding");let i=n.getNumImages(),o=[];for(let s=0;s<i;s++){let c=n.getNumLevels(s),l=[];for(let h=0;h<c;h++)l.push(iMt(n,s,h,r));o.push(l)}return o}finally{n.close(),n.delete()}}function iMt(e,t,r,n){let i=e.getImageWidth(t,r),o=e.getImageHeight(t,r),s=e.getHasAlpha(),{compressed:c,format:l,basisFormat:h}=p$(n,s),p=e.getImageTranscodedSizeInBytes(t,r,h),x=new Uint8Array(p);if(!e.transcodeImage(x,t,r,h,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:o,data:x,compressed:c,format:l,hasAlpha:s}}function f$(e,t,r){let n=new e(new Uint8Array(t));try{if(!n.startTranscoding())throw new Error("failed to start KTX2 transcoding");let i=n.getLevels(),o=[];for(let s=0;s<i;s++){o.push(oMt(n,s,r));break}return[o]}finally{n.close(),n.delete()}}function oMt(e,t,r){let{alphaFlag:n,height:i,width:o}=e.getImageLevelInfo(t,0,0),{compressed:s,format:c,basisFormat:l}=p$(r,n),h=e.getImageTranscodedSizeInBytes(t,0,0,l),p=new Uint8Array(h);if(!e.transcodeImage(p,t,0,0,l,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:o,height:i,data:p,compressed:s,levelSize:h,hasAlpha:n,format:c}}function p$(e,t){let r=e&&e.basis&&e.basis.format;return r==="auto"&&(r=cC()),typeof r=="object"&&(r=t?r.alpha:r.noAlpha),r=r.toLowerCase(),nMt[r]}function cC(){let e=r$();return e.has("astc")?"astc-4x4":e.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:e.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:e.has("etc1")?"etc1":e.has("etc2")?"etc2":"rgb565"}var d$={dataType:null,batchType:null,name:"Basis",id:"basis",module:"textures",version:JZ,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},NN={...d$,parse:DN};var sMt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},aMt={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},FN=class{name;startTime=0;playing=!0;speed=1;channels=[];constructor(t){Object.assign(this,t)}animate(t){if(!this.playing)return;let n=(t/1e3-this.startTime)*this.speed;this.channels.forEach(({sampler:i,target:o,path:s})=>{pMt(n,i,o,s),lMt(o,o._node)})}},lC=class{animations;constructor(t){this.animations=t.animations.map((r,n)=>{let i=r.name||`Animation-${n}`,o=r.samplers.map(({input:c,interpolation:l="LINEAR",output:h})=>({input:m$(t.accessors[c]),interpolation:l,output:m$(t.accessors[h])})),s=r.channels.map(({sampler:c,target:l})=>({sampler:o[c],target:t.nodes[l.node],path:l.path}));return new FN({name:i,channels:s})})}animate(t){this.setTime(t)}setTime(t){this.animations.forEach(r=>r.animate(t))}getAnimations(){return this.animations}};function m$(e){if(!e._animation){let t=aMt[e.componentType],r=sMt[e.type],n=r*e.count,{buffer:i,byteOffset:o}=e.bufferView.data,s=new t(i,o+(e.byteOffset||0),n);if(r===1)e._animation=Array.from(s);else{let c=[];for(let l=0;l<s.length;l+=r)c.push(Array.from(s.slice(l,l+r)));e._animation=c}}return e._animation}var cMt=new Fn;function lMt(e,t){if(t.matrix.identity(),e.translation&&t.matrix.translate(e.translation),e.rotation){let r=cMt.fromQuaternion(e.rotation);t.matrix.multiplyRight(r)}e.scale&&t.matrix.scale(e.scale)}var kN=new hm;function uMt(e,t,r,n,i){if(t==="rotation"){kN.slerp({start:r,target:n,ratio:i});for(let o=0;o<kN.length;o++)e[t][o]=kN[o]}else for(let o=0;o<r.length;o++)e[t][o]=i*n[o]+(1-i)*r[o]}function hMt(e,t,{p0:r,outTangent0:n,inTangent1:i,p1:o,tDiff:s,ratio:c}){for(let l=0;l<e[t].length;l++){let h=n[l]*s,p=i[l]*s;e[t][l]=(2*Math.pow(c,3)-3*Math.pow(c,2)+1)*r[l]+(Math.pow(c,3)-2*Math.pow(c,2)+c)*h+(-2*Math.pow(c,3)+3*Math.pow(c,2))*o[l]+(Math.pow(c,3)-Math.pow(c,2))*p}}function fMt(e,t,r){for(let n=0;n<r.length;n++)e[t][n]=r[n]}function pMt(e,{input:t,interpolation:r,output:n},i,o){let s=t[t.length-1],c=e%s,l=t.findIndex(w=>w>=c),h=Math.max(0,l-1);if(!Array.isArray(i[o]))switch(o){case"translation":i[o]=[0,0,0];break;case"rotation":i[o]=[0,0,0,1];break;case"scale":i[o]=[1,1,1];break;default:qe.warn(`Bad animation path ${o}`)()}let p=t[h],x=t[l];switch(r){case"STEP":fMt(i,o,n[h]);break;case"LINEAR":if(x>p){let w=(c-p)/(x-p);uMt(i,o,n[h],n[l],w)}break;case"CUBICSPLINE":if(x>p){let w=(c-p)/(x-p),E=x-p,P=n[3*h+1],B=n[3*h+2],D=n[3*l+0],W=n[3*l+1];hMt(i,o,{p0:P,outTangent0:B,inTangent1:D,p1:W,tDiff:E,ratio:w})}break;default:qe.warn(`Interpolation ${r} not supported`)();break}}var dMt=`
layout(0) positions: vec4; // in vec4 POSITION;

  #ifdef HAS_NORMALS
    in vec4 normals; // in vec4 NORMAL;
  #endif

  #ifdef HAS_TANGENTS
    in vec4 TANGENT;
  #endif

  #ifdef HAS_UV
    // in vec2 TEXCOORD_0;
    in vec2 texCoords;
  #endif

@vertex
  void main(void) {
    vec4 _NORMAL = vec4(0.);
    vec4 _TANGENT = vec4(0.);
    vec2 _TEXCOORD_0 = vec2(0.);

    #ifdef HAS_NORMALS
      _NORMAL = normals;
    #endif

    #ifdef HAS_TANGENTS
      _TANGENT = TANGENT;
    #endif

    #ifdef HAS_UV
      _TEXCOORD_0 = texCoords;
    #endif

    pbr_setPositionNormalTangentUV(positions, _NORMAL, _TANGENT, _TEXCOORD_0);
    gl_Position = u_MVPMatrix * positions;
  }

@fragment
  out vec4 fragmentColor;

  void main(void) {
    vec3 pos = pbr_vPosition;
    fragmentColor = pbr_filterColor(vec4(1.0));
  }
`,mMt=`#version 300 es

  // in vec4 POSITION;
  in vec4 positions;

  #ifdef HAS_NORMALS
    // in vec4 NORMAL;
    in vec4 normals;
  #endif

  #ifdef HAS_TANGENTS
    in vec4 TANGENT;
  #endif

  #ifdef HAS_UV
    // in vec2 TEXCOORD_0;
    in vec2 texCoords;
  #endif

  void main(void) {
    vec4 _NORMAL = vec4(0.);
    vec4 _TANGENT = vec4(0.);
    vec2 _TEXCOORD_0 = vec2(0.);

    #ifdef HAS_NORMALS
      _NORMAL = normals;
    #endif

    #ifdef HAS_TANGENTS
      _TANGENT = TANGENT;
    #endif

    #ifdef HAS_UV
      _TEXCOORD_0 = texCoords;
    #endif

    pbr_setPositionNormalTangentUV(positions, _NORMAL, _TANGENT, _TEXCOORD_0);
    gl_Position = pbrProjection.modelViewProjectionMatrix * positions;
  }
`,AMt=`#version 300 es
  out vec4 fragmentColor;

  void main(void) {
    vec3 pos = pbr_vPosition;
    fragmentColor = pbr_filterColor(vec4(1.0));
  }
`;function A$(e,t){let{id:r,geometry:n,material:i,vertexCount:o,materialOptions:s,modelOptions:c}=t,l=rw(e,i,n.attributes,s);qe.info(4,"createGLTFModel defines: ",l.defines)();let h=[],p={depthWriteEnabled:!0,depthCompare:"less",depthFormat:"depth24plus",cullMode:"back"},x={id:r,source:dMt,vs:mMt,fs:AMt,geometry:n,topology:n.topology,vertexCount:o,modules:[r0],...c,defines:{...l.defines,...c.defines},parameters:{...p,...l.parameters,...c.parameters}},w=new jn(e,x),{camera:E,...P}={...l.uniforms,...c.uniforms,...l.bindings,...c.bindings};return w.shaderInputs.setProps({pbrMaterial:P,pbrProjection:{camera:E}}),new Wf({managedResources:h,model:w})}var U0;(function(e){e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(U0||(U0={}));function g$(e){switch(e){case U0.POINTS:return"point-list";case U0.LINES:return"line-list";case U0.LINE_STRIP:return"line-strip";case U0.TRIANGLES:return"triangle-list";case U0.TRIANGLE_STRIP:return"triangle-strip";default:throw new Error(String(e))}}var gMt={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1},uC=class{device;options;gltf;constructor(t,r={}){this.device=t,this.options={...gMt,...r}}instantiate(t){return this.gltf=zN(t),(this.gltf.scenes||[]).map(n=>this.createScene(n))}createAnimator(){return Array.isArray(this.gltf.animations)?new lC(this.gltf):null}createScene(t){let n=(t.nodes||[]).map(o=>this.createNode(o));return new hu({id:t.name||t.id,children:n})}createNode(t){if(!t._node){let i=(t.children||[]).map(s=>this.createNode(s));t.mesh&&i.push(this.createMesh(t.mesh));let o=new hu({id:t.name||t.id,children:i});if(t.matrix)o.setMatrix(t.matrix);else{if(o.matrix.identity(),t.translation&&o.matrix.translate(t.translation),t.rotation){let s=new Fn().fromQuaternion(t.rotation);o.matrix.multiplyRight(s)}t.scale&&o.matrix.scale(t.scale)}t._node=o}let r=this.gltf.nodes.find(n=>n.id===t.id);return r._node=t._node,t._node}createMesh(t){if(!t._mesh){let n=(t.primitives||[]).map((o,s)=>this.createPrimitive(o,s,t)),i=new hu({id:t.name||t.id,children:n});t._mesh=i}return t._mesh}createPrimitive(t,r,n){let i=t.name||`${n.name||n.id}-primitive-${r}`,o=g$(t.mode||4),s=t.indices?t.indices.count:this.getVertexCount(t.attributes),c=A$(this.device,{id:i,geometry:this.createGeometry(i,t,o),material:t.material,materialOptions:this.options,modelOptions:this.options.modelOptions,vertexCount:s});return c.bounds=[t.attributes.POSITION.min,t.attributes.POSITION.max],c}getVertexCount(t){throw new Error("getVertexCount not implemented")}createGeometry(t,r,n){let i={};for(let[o,s]of Object.entries(r.attributes)){let{components:c,size:l,value:h}=s;i[o]={size:l??c,value:h}}return new Mi({id:t,topology:n,indices:r.indices.value,attributes:i})}createBuffer(t,r){t.bufferView||(t.bufferView={});let{bufferView:n}=t;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[r]||(n.lumaBuffers[r]=this.device.createBuffer({id:`from-${n.id}`,data:n.data||t.value})),n.lumaBuffers[r]}createSampler(t){return t}needsPOT(){return!1}};function zN(e){if(ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof ImageBitmap)return e;if(Array.isArray(e))return e.map(zN);if(e&&typeof e=="object"){let t={};for(let r in e)t[r]=zN(e[r]);return t}return e}function UN(e,t,r){let n=new uC(e,r),i=n.instantiate(t),o=n.createAnimator();return{scenes:i,animator:o}}var VN={};Lo(VN,{decode:()=>PMt,name:()=>CMt});function Ua(e,t){if(!e)throw new Error(t||"assert failed: gltf")}var hC={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},fC={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4};var _Mt=1.33,_$=["SCALAR","VEC2","VEC3","VEC4"],yMt=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],xMt=new Map(yMt),vMt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},bMt={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},wMt={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function pC(e){return _$[e-1]||_$[0]}function ky(e){let t=xMt.get(e.constructor);if(!t)throw new Error("Illegal typed array");return t}function Fy(e,t){let r=wMt[e.componentType],n=vMt[e.type],i=bMt[e.componentType],o=e.count*n,s=e.count*n*i;Ua(s>=0&&s<=t.byteLength);let c=fC[e.componentType],l=hC[e.type];return{ArrayType:r,length:o,byteLength:s,componentByteSize:c,numberOfComponentsInElement:l}}function nw(e){let{images:t,bufferViews:r}=e;t=t||[],r=r||[];let n=t.map(s=>s.bufferView);r=r.filter(s=>!n.includes(s));let i=r.reduce((s,c)=>s+c.byteLength,0),o=t.reduce((s,c)=>{let{width:l,height:h}=c.image;return s+l*h},0);return i+Math.ceil(4*o*_Mt)}function y$(e,t,r){let n=e.bufferViews[r];Ua(n);let i=n.buffer,o=t[i];Ua(o);let s=(n.byteOffset||0)+o.byteOffset;return new Uint8Array(o.arrayBuffer,s,n.byteLength)}function x$(e,t,r){let n=typeof r=="number"?e.accessors?.[r]:r;if(!n)throw new Error(`No gltf accessor ${JSON.stringify(r)}`);let i=e.bufferViews?.[n.bufferView||0];if(!i)throw new Error(`No gltf buffer view for accessor ${i}`);let{arrayBuffer:o,byteOffset:s}=t[i.buffer],c=(s||0)+(n.byteOffset||0)+(i.byteOffset||0),{ArrayType:l,length:h,componentByteSize:p,numberOfComponentsInElement:x}=Fy(n,i),w=p*x,E=i.byteStride||w;if(typeof i.byteStride>"u"||i.byteStride===w)return new l(o,c,h);let P=new l(h);for(let B=0;B<n.count;B++){let D=new l(o,c+B*E,x);P.set(D,B*x)}return P}function TMt(){return{asset:{version:"2.0",generator:"loaders.gl"},buffers:[],extensions:{},extensionsRequired:[],extensionsUsed:[]}}var go=class{gltf;sourceBuffers;byteLength;constructor(t){this.gltf={json:t?.json||TMt(),buffers:t?.buffers||[],images:t?.images||[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(t){return this.json[t]}getExtraData(t){return(this.json.extras||{})[t]}hasExtension(t){let r=this.getUsedExtensions().find(i=>i===t),n=this.getRequiredExtensions().find(i=>i===t);return typeof r=="string"||typeof n=="string"}getExtension(t){let r=this.getUsedExtensions().find(i=>i===t),n=this.json.extensions||{};return r?n[t]:null}getRequiredExtension(t){return this.getRequiredExtensions().find(n=>n===t)?this.getExtension(t):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(t,r){return(t.extensions||{})[r]}getScene(t){return this.getObject("scenes",t)}getNode(t){return this.getObject("nodes",t)}getSkin(t){return this.getObject("skins",t)}getMesh(t){return this.getObject("meshes",t)}getMaterial(t){return this.getObject("materials",t)}getAccessor(t){return this.getObject("accessors",t)}getTexture(t){return this.getObject("textures",t)}getSampler(t){return this.getObject("samplers",t)}getImage(t){return this.getObject("images",t)}getBufferView(t){return this.getObject("bufferViews",t)}getBuffer(t){return this.getObject("buffers",t)}getObject(t,r){if(typeof r=="object")return r;let n=this.json[t]&&this.json[t][r];if(!n)throw new Error(`glTF file error: Could not find ${t}[${r}]`);return n}getTypedArrayForBufferView(t){t=this.getBufferView(t);let r=t.buffer,n=this.gltf.buffers[r];Ua(n);let i=(t.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,i,t.byteLength)}getTypedArrayForAccessor(t){let r=this.getAccessor(t);return x$(this.gltf.json,this.gltf.buffers,r)}getTypedArrayForImageData(t){t=this.getAccessor(t);let r=this.getBufferView(t.bufferView),i=this.getBuffer(r.buffer).data,o=r.byteOffset||0;return new Uint8Array(i,o,r.byteLength)}addApplicationData(t,r){return this.json[t]=r,this}addExtraData(t,r){return this.json.extras=this.json.extras||{},this.json.extras[t]=r,this}addObjectExtension(t,r,n){return t.extensions=t.extensions||{},t.extensions[r]=n,this.registerUsedExtension(r),this}setObjectExtension(t,r,n){let i=t.extensions||{};i[r]=n}removeObjectExtension(t,r){let n=t?.extensions||{};if(n[r]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];let i=this.json.extensionsRemoved;i.includes(r)||i.push(r)}delete n[r]}addExtension(t,r={}){return Ua(r),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=r,this.registerUsedExtension(t),r}addRequiredExtension(t,r={}){return Ua(r),this.addExtension(t,r),this.registerRequiredExtension(t),r}registerUsedExtension(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(r=>r===t)||this.json.extensionsUsed.push(t)}registerRequiredExtension(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(r=>r===t)||this.json.extensionsRequired.push(t)}removeExtension(t){if(this.json.extensions?.[t]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];let r=this.json.extensionsRemoved;r.includes(t)||r.push(t)}this.json.extensions&&delete this.json.extensions[t],this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t)}setDefaultScene(t){this.json.scene=t}addScene(t){let{nodeIndices:r}=t;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:r}),this.json.scenes.length-1}addNode(t){let{meshIndex:r,matrix:n}=t;this.json.nodes=this.json.nodes||[];let i={mesh:r};return n&&(i.matrix=n),this.json.nodes.push(i),this.json.nodes.length-1}addMesh(t){let{attributes:r,indices:n,material:i,mode:o=4}=t,c={primitives:[{attributes:this._addAttributes(r),mode:o}]};if(n){let l=this._addIndices(n);c.primitives[0].indices=l}return Number.isFinite(i)&&(c.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(c),this.json.meshes.length-1}addPointCloud(t){let n={primitives:[{attributes:this._addAttributes(t),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(n),this.json.meshes.length-1}addImage(t,r){let n=ZA(t),i=r||n?.mimeType,s={bufferView:this.addBufferView(t),mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(s),this.json.images.length-1}addBufferView(t,r=0,n=this.byteLength){let i=t.byteLength;Ua(Number.isFinite(i)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);let o={buffer:r,byteOffset:n,byteLength:i};return this.byteLength+=Zd(i,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(o),this.json.bufferViews.length-1}addAccessor(t,r){let n={bufferView:t,type:pC(r.size),componentType:r.componentType,count:r.count,max:r.max,min:r.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}addBinaryBuffer(t,r={size:3}){let n=this.addBufferView(t),i={min:r.min,max:r.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(t,r.size));let o={size:r.size,componentType:ky(t),count:Math.round(t.length/r.size),min:i.min,max:i.max};return this.addAccessor(n,Object.assign(o,r))}addTexture(t){let{imageIndex:r}=t,n={source:r};return this.json.textures=this.json.textures||[],this.json.textures.push(n),this.json.textures.length-1}addMaterial(t){return this.json.materials=this.json.materials||[],this.json.materials.push(t),this.json.materials.length-1}createBinaryChunk(){this.gltf.buffers=[];let t=this.byteLength,r=new ArrayBuffer(t),n=new Uint8Array(r),i=0;for(let o of this.sourceBuffers||[])i=jL(o,n,i);this.json?.buffers?.[0]?this.json.buffers[0].byteLength=t:this.json.buffers=[{byteLength:t}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(t,r){let n=!0;for(;n;){let i=t.indexOf(r);i>-1?t.splice(i,1):n=!1}}_addAttributes(t={}){let r={};for(let n in t){let i=t[n],o=this._getGltfAttributeName(n),s=this.addBinaryBuffer(i.value,i);r[o]=s}return r}_addIndices(t){return this.addBinaryBuffer(t,{size:1})}_getGltfAttributeName(t){switch(t.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return t}}_getAccessorMinMax(t,r){let n={min:null,max:null};if(t.length<r)return n;n.min=[],n.max=[];let i=t.subarray(0,r);for(let o of i)n.min.push(o),n.max.push(o);for(let o=r;o<t.length;o+=r)for(let s=0;s<r;s++)n.min[0+s]=Math.min(n.min[0+s],t[o+s]),n.max[0+s]=Math.max(n.max[0+s],t[o+s]);return n}};function v$(e){return(e%1+1)%1}var b$={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16,BOOLEAN:1,STRING:1,ENUM:1},EMt={INT8:Int8Array,UINT8:Uint8Array,INT16:Int16Array,UINT16:Uint16Array,INT32:Int32Array,UINT32:Uint32Array,INT64:BigInt64Array,UINT64:BigUint64Array,FLOAT32:Float32Array,FLOAT64:Float64Array},w$={INT8:1,UINT8:1,INT16:2,UINT16:2,INT32:4,UINT32:4,INT64:8,UINT64:8,FLOAT32:4,FLOAT64:8};function iw(e,t){return w$[t]*b$[e]}function zy(e,t,r,n){if(r!=="UINT8"&&r!=="UINT16"&&r!=="UINT32"&&r!=="UINT64")return null;let i=e.getTypedArrayForBufferView(t),o=Uy(i,"SCALAR",r,n+1);return o instanceof BigInt64Array||o instanceof BigUint64Array?null:o}function Uy(e,t,r,n=1){let i=b$[t],o=EMt[r],s=w$[r],c=n*i,l=c*s,h=e.buffer,p=e.byteOffset;return p%s!==0&&(h=new Uint8Array(h).slice(p,p+l).buffer,p=0),new o(h,p,c)}function Vy(e,t,r){let n=`TEXCOORD_${t.texCoord||0}`,i=r.attributes[n],o=e.getTypedArrayForAccessor(i),s=e.gltf.json,c=t.index,l=s.textures?.[c]?.source;if(typeof l<"u"){let h=s.images?.[l]?.mimeType,p=e.gltf.images?.[l];if(p&&typeof p.width<"u"){let x=[];for(let w=0;w<o.length;w+=2){let E=MMt(p,h,o,w,t.channels);x.push(E)}return x}}return[]}function dC(e,t,r,n,i){if(!r?.length)return;let o=[];for(let p of r){let x=n.findIndex(w=>w===p);x===-1&&(x=n.push(p)-1),o.push(x)}let s=new Uint32Array(o),c=e.gltf.buffers.push({arrayBuffer:s.buffer,byteOffset:s.byteOffset,byteLength:s.byteLength})-1,l=e.addBufferView(s,c,0),h=e.addAccessor(l,{size:1,componentType:ky(s),count:s.length});i.attributes[t]=h}function MMt(e,t,r,n,i=[0]){let o={r:{offset:0,shift:0},g:{offset:1,shift:8},b:{offset:2,shift:16},a:{offset:3,shift:24}},s=r[n],c=r[n+1],l=1;t&&(t.indexOf("image/jpeg")!==-1||t.indexOf("image/png")!==-1)&&(l=4);let h=SMt(s,c,e,l),p=0;for(let x of i){let w=typeof x=="number"?Object.values(o)[x]:o[x],E=h+w.offset,P=Lv(e);if(P.data.length<=E)throw new Error(`${P.data.length} <= ${E}`);let B=P.data[E];p|=B<<w.shift}return p}function SMt(e,t,r,n=1){let i=r.width,o=v$(e)*(i-1),s=Math.round(o),c=r.height,l=v$(t)*(c-1),h=Math.round(l),p=r.components?r.components:n;return(h*i+s)*p}function mC(e,t,r,n,i){let o=[];for(let s=0;s<t;s++){let c=r[s],l=r[s+1]-r[s];if(l+c>n)break;let h=c/i,p=l/i;o.push(e.slice(h,h+p))}return o}function AC(e,t,r){let n=[];for(let i=0;i<t;i++){let o=i*r;n.push(e.slice(o,o+r))}return n}function gC(e,t,r,n){if(r)throw new Error("Not implemented - arrayOffsets for strings is specified");if(n){let i=[],o=new TextDecoder("utf8"),s=0;for(let c=0;c<e;c++){let l=n[c+1]-n[c];if(l+s<=t.length){let h=t.subarray(s,l+s),p=o.decode(h);i.push(p),s+=l}}return i}return[]}var T$="EXT_mesh_features",CMt=T$;async function PMt(e,t){let r=new go(e);IMt(r,t)}function IMt(e,t){let r=e.gltf.json;if(r.meshes)for(let n of r.meshes)for(let i of n.primitives)RMt(e,i,t)}function RMt(e,t,r){if(!r?.gltf?.loadBuffers)return;let i=t.extensions?.[T$]?.featureIds;if(i)for(let o of i){let s;if(typeof o.attribute<"u"){let c=`_FEATURE_ID_${o.attribute}`,l=t.attributes[c];s=e.getTypedArrayForAccessor(l)}else typeof o.texture<"u"&&r?.gltf?.loadImages?s=Vy(e,o.texture,t):s=[];o.data=s}}var WN={};Lo(WN,{decode:()=>OMt,name:()=>LMt});var jN="EXT_structural_metadata",LMt=jN;async function OMt(e,t){let r=new go(e);BMt(r,t)}function BMt(e,t){if(!t.gltf?.loadBuffers)return;let r=e.getExtension(jN);r&&(t.gltf?.loadImages&&DMt(e,r),NMt(e,r))}function DMt(e,t){let r=t.propertyTextures,n=e.gltf.json;if(r&&n.meshes)for(let i of n.meshes)for(let o of i.primitives)FMt(e,r,o,t)}function NMt(e,t){let r=t.schema;if(!r)return;let n=r.classes,i=t.propertyTables;if(n&&i)for(let o in n){let s=kMt(i,o);s&&UMt(e,r,s)}}function kMt(e,t){for(let r of e)if(r.class===t)return r;return null}function FMt(e,t,r,n){if(!t)return;let o=r.extensions?.[jN]?.propertyTextures;if(o)for(let s of o){let c=t[s];zMt(e,c,r,n)}}function zMt(e,t,r,n){if(!t.properties)return;n.dataAttributeNames||(n.dataAttributeNames=[]);let i=t.class;for(let o in t.properties){let s=`${i}_${o}`,c=t.properties?.[o];if(!c)continue;c.data||(c.data=[]);let l=c.data,h=Vy(e,c,r);h!==null&&(dC(e,s,h,l,r),c.data=l,n.dataAttributeNames.push(s))}}function UMt(e,t,r){let n=t.classes?.[r.class];if(!n)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${r.class}`);let i=r.count;for(let o in n.properties){let s=n.properties[o],c=r.properties?.[o];if(c){let l=VMt(e,t,s,i,c);c.data=l}}}function VMt(e,t,r,n,i){let o=[],s=i.values,c=e.getTypedArrayForBufferView(s),l=jMt(e,r,i,n),h=HMt(e,i,n);switch(r.type){case"SCALAR":case"VEC2":case"VEC3":case"VEC4":case"MAT2":case"MAT3":case"MAT4":{o=WMt(r,n,c,l);break}case"BOOLEAN":throw new Error(`Not implemented - classProperty.type=${r.type}`);case"STRING":{o=gC(n,c,l,h);break}case"ENUM":{o=qMt(t,r,n,c,l);break}default:throw new Error(`Unknown classProperty type ${r.type}`)}return o}function jMt(e,t,r,n){return t.array&&typeof t.count>"u"&&typeof r.arrayOffsets<"u"?zy(e,r.arrayOffsets,r.arrayOffsetType||"UINT32",n):null}function HMt(e,t,r){return typeof t.stringOffsets<"u"?zy(e,t.stringOffsets,t.stringOffsetType||"UINT32",r):null}function WMt(e,t,r,n){let i=e.array,o=e.count,s=iw(e.type,e.componentType),c=r.byteLength/s,l;return e.componentType?l=Uy(r,e.type,e.componentType,c):l=r,i?n?mC(l,t,n,r.length,s):o?AC(l,t,o):[]:l}function qMt(e,t,r,n,i){let o=t.enumType;if(!o)throw new Error("Incorrect data in the EXT_structural_metadata extension: classProperty.enumType is not set for type ENUM");let s=e.enums?.[o];if(!s)throw new Error(`Incorrect data in the EXT_structural_metadata extension: schema.enums does't contain ${o}`);let c=s.valueType||"UINT16",l=iw(t.type,c),h=n.byteLength/l,p=Uy(n,t.type,c,h);if(p||(p=n),t.array){if(i)return GMt({valuesData:p,numberOfElements:r,arrayOffsets:i,valuesDataBytesLength:n.length,elementSize:l,enumEntry:s});let x=t.count;return x?XMt(p,r,x,s):[]}return HN(p,0,r,s)}function GMt(e){let{valuesData:t,numberOfElements:r,arrayOffsets:n,valuesDataBytesLength:i,elementSize:o,enumEntry:s}=e,c=[];for(let l=0;l<r;l++){let h=n[l],p=n[l+1]-n[l];if(p+h>i)break;let x=h/o,w=p/o,E=HN(t,x,w,s);c.push(E)}return c}function XMt(e,t,r,n){let i=[];for(let o=0;o<t;o++){let s=r*o,c=HN(e,s,r,n);i.push(c)}return i}function HN(e,t,r,n){let i=[];for(let o=0;o<r;o++)if(e instanceof BigInt64Array||e instanceof BigUint64Array)i.push("");else{let s=e[t+o],c=YMt(n,s);c?i.push(c.name):i.push("")}return i}function YMt(e,t){for(let r of e.values)if(r.value===t)return r;return null}var qN={};Lo(qN,{decode:()=>ZMt,name:()=>KMt});var E$="EXT_feature_metadata",KMt=E$;async function ZMt(e,t){let r=new go(e);$Mt(r,t)}function $Mt(e,t){if(!t.gltf?.loadBuffers)return;let r=e.getExtension(E$);r&&(t.gltf?.loadImages&&QMt(e,r),JMt(e,r))}function QMt(e,t){let r=t.schema;if(!r)return;let n=r.classes,{featureTextures:i}=t;if(n&&i)for(let o in n){let s=n[o],c=eSt(i,o);c&&nSt(e,c,s)}}function JMt(e,t){let r=t.schema;if(!r)return;let n=r.classes,i=t.featureTables;if(n&&i)for(let o in n){let s=tSt(i,o);s&&rSt(e,r,s)}}function tSt(e,t){for(let r in e){let n=e[r];if(n.class===t)return n}return null}function eSt(e,t){for(let r in e){let n=e[r];if(n.class===t)return n}return null}function rSt(e,t,r){if(!r.class)return;let n=t.classes?.[r.class];if(!n)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${r.class}`);let i=r.count;for(let o in n.properties){let s=n.properties[o],c=r.properties?.[o];if(c){let l=iSt(e,t,s,i,c);c.data=l}}}function nSt(e,t,r){let n=t.class;for(let i in r.properties){let o=t?.properties?.[i];if(o){let s=lSt(e,o,n);o.data=s}}}function iSt(e,t,r,n,i){let o=[],s=i.bufferView,c=e.getTypedArrayForBufferView(s),l=oSt(e,r,i,n),h=sSt(e,r,i,n);return r.type==="STRING"||r.componentType==="STRING"?o=gC(n,c,l,h):aSt(r)&&(o=cSt(r,n,c,l)),o}function oSt(e,t,r,n){return t.type==="ARRAY"&&typeof t.componentCount>"u"&&typeof r.arrayOffsetBufferView<"u"?zy(e,r.arrayOffsetBufferView,r.offsetType||"UINT32",n):null}function sSt(e,t,r,n){return typeof r.stringOffsetBufferView<"u"?zy(e,r.stringOffsetBufferView,r.offsetType||"UINT32",n):null}function aSt(e){let t=["UINT8","INT16","UINT16","INT32","UINT32","INT64","UINT64","FLOAT32","FLOAT64"];return t.includes(e.type)||typeof e.componentType<"u"&&t.includes(e.componentType)}function cSt(e,t,r,n){let i=e.type==="ARRAY",o=e.componentCount,s="SCALAR",c=e.componentType||e.type,l=iw(s,c),h=r.byteLength/l,p=Uy(r,s,c,h);return i?n?mC(p,t,n,r.length,l):o?AC(p,t,o):[]:p}function lSt(e,t,r){let n=e.gltf.json;if(!n.meshes)return[];let i=[];for(let o of n.meshes)for(let s of o.primitives)uSt(e,r,t,i,s);return i}function uSt(e,t,r,n,i){let o={channels:r.channels,...r.texture},s=Vy(e,o,i);s&&dC(e,t,s,n,i)}var M$="4.2.1";var jy=!0,S$=1735152710,YN=12,_C=8,hSt=1313821514,fSt=5130562,pSt=0,dSt=0,mSt=1;function ASt(e,t=0){return`${String.fromCharCode(e.getUint8(t+0))}${String.fromCharCode(e.getUint8(t+1))}${String.fromCharCode(e.getUint8(t+2))}${String.fromCharCode(e.getUint8(t+3))}`}function C$(e,t=0,r={}){let n=new DataView(e),{magic:i=S$}=r,o=n.getUint32(t,!1);return o===i||o===S$}function P$(e,t,r=0,n={}){let i=new DataView(t),o=ASt(i,r+0),s=i.getUint32(r+4,jy),c=i.getUint32(r+8,jy);switch(Object.assign(e,{header:{byteOffset:r,byteLength:c,hasBinChunk:!1},type:o,version:s,json:{},binChunks:[]}),r+=YN,e.version){case 1:return gSt(e,i,r);case 2:return _St(e,i,r,n={});default:throw new Error(`Invalid GLB version ${e.version}. Only supports version 1 and 2.`)}}function gSt(e,t,r){Ti(e.header.byteLength>YN+_C);let n=t.getUint32(r+0,jy),i=t.getUint32(r+4,jy);return r+=_C,Ti(i===pSt),GN(e,t,r,n),r+=n,r+=XN(e,t,r,e.header.byteLength),r}function _St(e,t,r,n){return Ti(e.header.byteLength>YN+_C),ySt(e,t,r,n),r+e.header.byteLength}function ySt(e,t,r,n){for(;r+8<=e.header.byteLength;){let i=t.getUint32(r+0,jy),o=t.getUint32(r+4,jy);switch(r+=_C,o){case hSt:GN(e,t,r,i);break;case fSt:XN(e,t,r,i);break;case dSt:n.strict||GN(e,t,r,i);break;case mSt:n.strict||XN(e,t,r,i);break;default:break}r+=Zd(i,4)}return r}function GN(e,t,r,n){let i=new Uint8Array(t.buffer,r,n),s=new TextDecoder("utf8").decode(i);return e.json=JSON.parse(s),Zd(n,4)}function XN(e,t,r,n){return e.header.hasBinChunk=!0,e.binChunks.push({byteOffset:r,byteLength:n,arrayBuffer:t.buffer}),Zd(n,4)}function KN(e,t){if(e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:"))return e;let n=t.baseUri||t.uri;if(!n)throw new Error(`'baseUri' must be provided to resolve relative url ${e}`);return n.substr(0,n.lastIndexOf("/")+1)+e}var $N={};Lo($N,{decode:()=>RSt,name:()=>ISt});var xSt="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",vSt="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",bSt=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),wSt=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),TSt={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ESt={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function I$(e,t,r,n,i,o="NONE"){let s=await MSt();PSt(s,s.exports[ESt[i]],e,t,r,n,s.exports[TSt[o||"NONE"]])}var ZN;async function MSt(){return ZN||(ZN=SSt()),ZN}async function SSt(){let e=xSt;WebAssembly.validate(bSt)&&(e=vSt,console.log("Warning: meshopt_decoder is using experimental SIMD support"));let t=await WebAssembly.instantiate(CSt(e),{});return await t.instance.exports.__wasm_call_ctors(),t.instance}function CSt(e){let t=new Uint8Array(e.length);for(let n=0;n<e.length;++n){let i=e.charCodeAt(n);t[n]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let r=0;for(let n=0;n<e.length;++n)t[r++]=t[n]<60?wSt[t[n]]:(t[n]-60)*64+t[++n];return t.buffer.slice(0,r)}function PSt(e,t,r,n,i,o,s){let c=e.exports.sbrk,l=n+3&-4,h=c(l*i),p=c(o.length),x=new Uint8Array(e.exports.memory.buffer);x.set(o,p);let w=t(h,n,i,p,o.length);if(w===0&&s&&s(h,l,i),r.set(x.subarray(h,h+n*i)),c(h-c(0)),w!==0)throw new Error(`Malformed buffer data: ${w}`)}var yC="EXT_meshopt_compression",ISt=yC;async function RSt(e,t){let r=new go(e);if(!t?.gltf?.decompressMeshes||!t.gltf?.loadBuffers)return;let n=[];for(let i of e.json.bufferViews||[])n.push(LSt(r,i));await Promise.all(n),r.removeExtension(yC)}async function LSt(e,t){let r=e.getObjectExtension(t,yC);if(r){let{byteOffset:n=0,byteLength:i=0,byteStride:o,count:s,mode:c,filter:l="NONE",buffer:h}=r,p=e.gltf.buffers[h],x=new Uint8Array(p.arrayBuffer,p.byteOffset+n,i),w=new Uint8Array(e.gltf.buffers[t.buffer].arrayBuffer,t.byteOffset,t.byteLength);await I$(w,s,o,x,c,l),e.removeObjectExtension(t,yC)}}var QN={};Lo(QN,{name:()=>OSt,preprocess:()=>BSt});var Hy="EXT_texture_webp",OSt=Hy;function BSt(e,t){let r=new go(e);if(!KO("image/webp")){if(r.getRequiredExtensions().includes(Hy))throw new Error(`gltf: Required extension ${Hy} not supported by browser`);return}let{json:n}=r;for(let i of n.textures||[]){let o=r.getObjectExtension(i,Hy);o&&(i.source=o.source),r.removeObjectExtension(i,Hy)}r.removeExtension(Hy)}var JN={};Lo(JN,{name:()=>DSt,preprocess:()=>NSt});var xC="KHR_texture_basisu",DSt=xC;function NSt(e,t){let r=new go(e),{json:n}=r;for(let i of n.textures||[]){let o=r.getObjectExtension(i,xC);o&&(i.source=o.source,r.removeObjectExtension(i,xC))}r.removeExtension(xC)}var ik={};Lo(ik,{decode:()=>QSt,encode:()=>JSt,name:()=>ZSt,preprocess:()=>$St});var R$="4.2.1";var L$={dataType:null,batchType:null,name:"Draco",id:"draco",module:"draco",version:R$,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:typeof WebAssembly=="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};function B$(e,t,r){let n=D$(t.metadata),i=[],o=kSt(t.attributes);for(let s in e){let c=e[s],l=O$(s,c,o[s]);i.push(l)}if(r){let s=O$("indices",r);i.push(s)}return{fields:i,metadata:n}}function kSt(e){let t={};for(let r in e){let n=e[r];t[n.name||"undefined"]=n}return t}function O$(e,t,r){let n=r?D$(r.metadata):void 0;return bL(e,t,n)}function D$(e){Object.entries(e);let t={};for(let r in e)t[`${r}.string`]=JSON.stringify(e[r]);return t}var N$={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},FSt={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},zSt=4,ow=class{draco;decoder;metadataQuerier;constructor(t){this.draco=t,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(t,r={}){let n=new this.draco.DecoderBuffer;n.Init(new Int8Array(t),t.byteLength),this._disableAttributeTransforms(r);let i=this.decoder.GetEncodedGeometryType(n),o=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let s;switch(i){case this.draco.TRIANGULAR_MESH:s=this.decoder.DecodeBufferToMesh(n,o);break;case this.draco.POINT_CLOUD:s=this.decoder.DecodeBufferToPointCloud(n,o);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!s.ok()||!o.ptr){let w=`DRACO decompression failed: ${s.error_msg()}`;throw new Error(w)}let c=this._getDracoLoaderData(o,i,r),l=this._getMeshData(o,c,r),h=Bp(l.attributes),p=B$(l.attributes,c,l.indices);return{loader:"draco",loaderData:c,header:{vertexCount:o.num_points(),boundingBox:h},...l,schema:p}}finally{this.draco.destroy(n),o&&this.draco.destroy(o)}}_getDracoLoaderData(t,r,n){let i=this._getTopLevelMetadata(t),o=this._getDracoAttributes(t,n);return{geometry_type:r,num_attributes:t.num_attributes(),num_points:t.num_points(),num_faces:t instanceof this.draco.Mesh?t.num_faces():0,metadata:i,attributes:o}}_getDracoAttributes(t,r){let n={};for(let i=0;i<t.num_attributes();i++){let o=this.decoder.GetAttribute(t,i),s=this._getAttributeMetadata(t,i);n[o.unique_id()]={unique_id:o.unique_id(),attribute_type:o.attribute_type(),data_type:o.data_type(),num_components:o.num_components(),byte_offset:o.byte_offset(),byte_stride:o.byte_stride(),normalized:o.normalized(),attribute_index:i,metadata:s};let c=this._getQuantizationTransform(o,r);c&&(n[o.unique_id()].quantization_transform=c);let l=this._getOctahedronTransform(o,r);l&&(n[o.unique_id()].octahedron_transform=l)}return n}_getMeshData(t,r,n){let i=this._getMeshAttributes(r,t,n);if(!i.POSITION)throw new Error("DRACO: No position attribute found.");if(t instanceof this.draco.Mesh)switch(n.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(t),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(t),size:1}}}return{topology:"point-list",mode:0,attributes:i}}_getMeshAttributes(t,r,n){let i={};for(let o of Object.values(t.attributes)){let s=this._deduceAttributeName(o,n);o.name=s;let c=this._getAttributeValues(r,o);if(c){let{value:l,size:h}=c;i[s]={value:l,size:h,byteOffset:o.byte_offset,byteStride:o.byte_stride,normalized:o.normalized}}}return i}_getTriangleListIndices(t){let n=t.num_faces()*3,i=n*zSt,o=this.draco._malloc(i);try{return this.decoder.GetTrianglesUInt32Array(t,i,o),new Uint32Array(this.draco.HEAPF32.buffer,o,n).slice()}finally{this.draco._free(o)}}_getTriangleStripIndices(t){let r=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(t,r),jSt(r)}finally{this.draco.destroy(r)}}_getAttributeValues(t,r){let n=FSt[r.data_type];if(!n)return console.warn(`DRACO: Unsupported attribute type ${r.data_type}`),null;let i=r.num_components,s=t.num_points()*i,c=s*n.BYTES_PER_ELEMENT,l=USt(this.draco,n),h,p=this.draco._malloc(c);try{let x=this.decoder.GetAttribute(t,r.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(t,x,l,c,p),h=new n(this.draco.HEAPF32.buffer,p,s).slice()}finally{this.draco._free(p)}return{value:h,size:i}}_deduceAttributeName(t,r){let n=t.unique_id;for(let[s,c]of Object.entries(r.extraAttributes||{}))if(c===n)return s;let i=t.attribute_type;for(let s in N$)if(this.draco[s]===i)return N$[s];let o=r.attributeNameEntry||"name";return t.metadata[o]?t.metadata[o].string:`CUSTOM_ATTRIBUTE_${n}`}_getTopLevelMetadata(t){let r=this.decoder.GetMetadata(t);return this._getDracoMetadata(r)}_getAttributeMetadata(t,r){let n=this.decoder.GetAttributeMetadata(t,r);return this._getDracoMetadata(n)}_getDracoMetadata(t){if(!t||!t.ptr)return{};let r={},n=this.metadataQuerier.NumEntries(t);for(let i=0;i<n;i++){let o=this.metadataQuerier.GetEntryName(t,i);r[o]=this._getDracoMetadataField(t,o)}return r}_getDracoMetadataField(t,r){let n=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(t,r,n);let i=VSt(n);return{int:this.metadataQuerier.GetIntEntry(t,r),string:this.metadataQuerier.GetStringEntry(t,r),double:this.metadataQuerier.GetDoubleEntry(t,r),intArray:i}}finally{this.draco.destroy(n)}}_disableAttributeTransforms(t){let{quantizedAttributes:r=[],octahedronAttributes:n=[]}=t,i=[...r,...n];for(let o of i)this.decoder.SkipAttributeTransform(this.draco[o])}_getQuantizationTransform(t,r){let{quantizedAttributes:n=[]}=r,i=t.attribute_type();if(n.map(s=>this.decoder[s]).includes(i)){let s=new this.draco.AttributeQuantizationTransform;try{if(s.InitFromAttribute(t))return{quantization_bits:s.quantization_bits(),range:s.range(),min_values:new Float32Array([1,2,3]).map(c=>s.min_value(c))}}finally{this.draco.destroy(s)}}return null}_getOctahedronTransform(t,r){let{octahedronAttributes:n=[]}=r,i=t.attribute_type();if(n.map(s=>this.decoder[s]).includes(i)){let s=new this.draco.AttributeQuantizationTransform;try{if(s.InitFromAttribute(t))return{quantization_bits:s.quantization_bits()}}finally{this.draco.destroy(s)}}return null}};function USt(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32;default:return e.DT_INVALID}}function VSt(e){let t=e.size(),r=new Int32Array(t);for(let n=0;n<t;n++)r[n]=e.GetValue(n);return r}function jSt(e){let t=e.size(),r=new Int32Array(t);for(let n=0;n<t;n++)r[n]=e.GetValue(n);return r}var HSt="1.5.6",WSt="1.4.1",tk=`https://www.gstatic.com/draco/versioned/decoders/${HSt}`,Fl={DECODER:"draco_wasm_wrapper.js",DECODER_WASM:"draco_decoder.wasm",FALLBACK_DECODER:"draco_decoder.js",ENCODER:"draco_encoder.js"},ek={[Fl.DECODER]:`${tk}/${Fl.DECODER}`,[Fl.DECODER_WASM]:`${tk}/${Fl.DECODER_WASM}`,[Fl.FALLBACK_DECODER]:`${tk}/${Fl.FALLBACK_DECODER}`,[Fl.ENCODER]:`https://raw.githubusercontent.com/google/draco/${WSt}/javascript/${Fl.ENCODER}`},rk;async function k$(e){let t=e.modules||{};return t.draco3d?rk||=t.draco3d.createDecoderModule({}).then(r=>({draco:r})):rk||=qSt(e),await rk}async function qSt(e){let t,r;switch(e.draco&&e.draco.decoderType){case"js":t=await Pf(ek[Fl.FALLBACK_DECODER],"draco",e,Fl.FALLBACK_DECODER);break;case"wasm":default:[t,r]=await Promise.all([await Pf(ek[Fl.DECODER],"draco",e,Fl.DECODER),await Pf(ek[Fl.DECODER_WASM],"draco",e,Fl.DECODER_WASM)])}return t=t||globalThis.DracoDecoderModule,await GSt(t,r)}function GSt(e,t){let r={};return t&&(r.wasmBinary=t),new Promise(n=>{e({...r,onModuleLoaded:i=>n({draco:i})})})}var vC={...L$,parse:XSt};async function XSt(e,t){let{draco:r}=await k$(t),n=new ow(r);try{return n.parseSync(e,t?.draco)}finally{n.destroy()}}function F$(e){let t={};for(let r in e){let n=e[r];if(r!=="indices"){let i=nk(n);t[r]=i}}return t}function nk(e){let{buffer:t,size:r,count:n}=YSt(e);return{value:t,size:r,byteOffset:0,count:n,type:pC(r),componentType:ky(t)}}function YSt(e){let t=e,r=1,n=0;return e&&e.value&&(t=e.value,r=e.size||1),t&&(ArrayBuffer.isView(t)||(t=KSt(t,Float32Array)),n=t.length/r),{buffer:t,size:r,count:n}}function KSt(e,t,r=!1){return e?Array.isArray(e)?new t(e):r&&!(e instanceof t)?new t(e):e:null}var km="KHR_draco_mesh_compression",ZSt=km;function $St(e,t,r){let n=new go(e);for(let i of z$(n))n.getObjectExtension(i,km)}async function QSt(e,t,r){if(!t?.gltf?.decompressMeshes)return;let n=new go(e),i=[];for(let o of z$(n))n.getObjectExtension(o,km)&&i.push(t3t(n,o,t,r));await Promise.all(i),n.removeExtension(km)}function JSt(e,t={}){let r=new go(e);for(let n of r.json.meshes||[])e3t(n,t),r.addRequiredExtension(km)}async function t3t(e,t,r,n){let i=e.getObjectExtension(t,km);if(!i)return;let o=e.getTypedArrayForBufferView(i.bufferView),s=zA(o.buffer,o.byteOffset),c={...r};delete c["3d-tiles"];let l=await iu(s,vC,c,n),h=F$(l.attributes);for(let[p,x]of Object.entries(h))if(p in t.attributes){let w=t.attributes[p],E=e.getAccessor(w);E?.min&&E?.max&&(x.min=E.min,x.max=E.max)}t.attributes=h,l.indices&&(t.indices=nk(l.indices)),e.removeObjectExtension(t,km),r3t(t)}function e3t(e,t,r=4,n,i){if(!n.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");let o=n.DracoWriter.encodeSync({attributes:e}),s=i?.parseSync?.({attributes:e}),c=n._addFauxAttributes(s.attributes),l=n.addBufferView(o);return{primitives:[{attributes:c,mode:r,extensions:{[km]:{bufferView:l,attributes:c}}}]}}function r3t(e){if(!e.attributes&&Object.keys(e.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*z$(e){for(let t of e.json.meshes||[])for(let r of t.primitives)yield r}var hk={};Lo(hk,{decode:()=>_3t,name:()=>m3t});var Hxe=1/Math.PI*180,Wxe=1/180*Math.PI,n3t={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...n3t}};var Sc=globalThis.mathgl.config;function U$(e,{precision:t=Sc.precision}={}){return e=i3t(e),`${parseFloat(e.toPrecision(t))}`}function Wy(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function ok(e,t,r){let n=Sc.EPSILON;r&&(Sc.EPSILON=r);try{if(e===t)return!0;if(Wy(e)&&Wy(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!ok(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<=Sc.EPSILON*Math.max(1,Math.abs(e),Math.abs(t)):!1}finally{Sc.EPSILON=n}}function i3t(e){return Math.round(e/Sc.EPSILON)*Sc.EPSILON}var qy=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(t,r=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+r];return this.check()}toArray(t=[],r=0){for(let n=0;n<this.ELEMENTS;++n)t[r+n]=this[n];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:Wy(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Sc)}formatString(t){let r="";for(let n=0;n<this.ELEMENTS;++n)r+=(n>0?", ":"")+U$(this[n],t);return`${t.printTypes?this.constructor.name:""}[${r}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(!ok(this[r],t[r]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==t[r])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,r,n){if(n===void 0)return this.lerp(this,t,r);for(let i=0;i<this.ELEMENTS;++i){let o=t[i],s=typeof r=="number"?r:r[i];this[i]=o+n*(s-o)}return this.check()}min(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(t[r],this[r]);return this.check()}max(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(t[r],this[r]);return this.check()}clamp(t,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),r[n]);return this.check()}add(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]+=r[n];return this.check()}subtract(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]-=r[n];return this.check()}scale(t){if(typeof t=="number")for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;else for(let r=0;r<this.ELEMENTS&&r<t.length;++r)this[r]*=t[r];return this.check()}multiplyByScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}check(){if(Sc.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)t=t&&Number.isFinite(this[r]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=t;return this.check()}addScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),r);return this.check()}get elements(){return this}};function o3t(e,t){if(e.length!==t)return!1;for(let r=0;r<e.length;++r)if(!Number.isFinite(e[r]))return!1;return!0}function Hc(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function V$(e,t,r=""){if(Sc.debug&&!o3t(e,t))throw new Error(`math.gl: ${r} some fields set to invalid numbers'`);return e}function sk(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}var bC=class extends qy{get x(){return this[0]}set x(t){this[0]=Hc(t)}get y(){return this[1]}set y(t){this[1]=Hc(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let r=0;r<this.ELEMENTS;++r)t+=this[r]*this[r];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let r=0;for(let n=0;n<this.ELEMENTS;++n){let i=this[n]-t[n];r+=i*i}return Hc(r)}dot(t){let r=0;for(let n=0;n<this.ELEMENTS;++n)r+=this[n]*t[n];return Hc(r)}normalize(){let t=this.magnitude();if(t!==0)for(let r=0;r<this.ELEMENTS;++r)this[r]/=t;return this.check()}multiply(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]*=r[n];return this.check()}divide(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]/=r[n];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return sk(t>=0&&t<this.ELEMENTS,"index is out of range"),Hc(this[t])}setComponent(t,r){return sk(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=r,this.check()}addVectors(t,r){return this.copy(t).add(r)}subVectors(t,r){return this.copy(t).subtract(r)}multiplyVectors(t,r){return this.copy(t).multiply(r)}addScaledVector(t,r){return this.add(new this.constructor(t).multiplyScalar(r))}};var Gy=typeof Float32Array<"u"?Float32Array:Array;var eve=Math.PI/180;function l3t(){let e=new Gy(2);return Gy!=Float32Array&&(e[0]=0,e[1]=0),e}function H$(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e}var rve=function(){let e=l3t();return function(t,r,n,i,o,s){let c,l;for(r||(r=2),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],o(e,e,s),t[c]=e[0],t[c+1]=e[1];return t}}();function W$(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[3]*n+r[7]*i+r[11]*o||1;return e[0]=(r[0]*n+r[4]*i+r[8]*o)/s,e[1]=(r[1]*n+r[5]*i+r[9]*o)/s,e[2]=(r[2]*n+r[6]*i+r[10]*o)/s,e}function q$(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e[2]=t[2],e}function G$(e,t,r){let n=t[0],i=t[1],o=t[2];return e[0]=r[0]*n+r[3]*i+r[6]*o,e[1]=r[1]*n+r[4]*i+r[7]*o,e[2]=r[2]*n+r[5]*i+r[8]*o,e[3]=t[3],e}function u3t(){let e=new Gy(3);return Gy!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function h3t(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function X$(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[0],c=r[1],l=r[2];return e[0]=i*l-o*c,e[1]=o*s-n*l,e[2]=n*c-i*s,e}function Y$(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[3]*n+r[7]*i+r[11]*o+r[15];return s=s||1,e[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/s,e[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/s,e[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/s,e}function wC(e,t,r){let n=t[0],i=t[1],o=t[2];return e[0]=n*r[0]+i*r[3]+o*r[6],e[1]=n*r[1]+i*r[4]+o*r[7],e[2]=n*r[2]+i*r[5]+o*r[8],e}function K$(e,t,r){let n=r[0],i=r[1],o=r[2],s=r[3],c=t[0],l=t[1],h=t[2],p=i*h-o*l,x=o*c-n*h,w=n*l-i*c,E=i*w-o*x,P=o*p-n*w,B=n*x-i*p,D=s*2;return p*=D,x*=D,w*=D,E*=2,P*=2,B*=2,e[0]=c+p+E,e[1]=l+x+P,e[2]=h+w+B,e}function Z$(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function $$(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function Q$(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function J$(e,t){let r=e[0],n=e[1],i=e[2],o=t[0],s=t[1],c=t[2],l=Math.sqrt((r*r+n*n+i*i)*(o*o+s*s+c*c)),h=l&&h3t(e,t)/l;return Math.acos(Math.min(Math.max(h,-1),1))}var ove=function(){let e=u3t();return function(t,r,n,i,o,s){let c,l;for(r||(r=3),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],o(e,e,s),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2];return t}}();var ak=[0,0,0],TC,V0=class extends bC{static get ZERO(){return TC||(TC=new V0(0,0,0),Object.freeze(TC)),TC}constructor(t=0,r=0,n=0){super(-0,-0,-0),arguments.length===1&&Wy(t)?this.copy(t):(Sc.debug&&(Hc(t),Hc(r),Hc(n)),this[0]=t,this[1]=r,this[2]=n)}set(t,r,n){return this[0]=t,this[1]=r,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return Sc.debug&&(Hc(t.x),Hc(t.y),Hc(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=Hc(t)}angle(t){return J$(this,t)}cross(t){return X$(this,this,t),this.check()}rotateX({radians:t,origin:r=ak}){return Z$(this,this,r,t),this.check()}rotateY({radians:t,origin:r=ak}){return $$(this,this,r,t),this.check()}rotateZ({radians:t,origin:r=ak}){return Q$(this,this,r,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return Y$(this,this,t),this.check()}transformAsVector(t){return W$(this,this,t),this.check()}transformByMatrix3(t){return wC(this,this,t),this.check()}transformByMatrix2(t){return q$(this,this,t),this.check()}transformByQuaternion(t){return K$(this,this,t),this.check()}};var EC=class extends qy{toString(){let t="[";if(Sc.printRowMajor){t+="row-major:";for(let r=0;r<this.RANK;++r)for(let n=0;n<this.RANK;++n)t+=` ${this[n*this.RANK+r]}`}else{t+="column-major:";for(let r=0;r<this.ELEMENTS;++r)t+=` ${this[r]}`}return t+="]",t}getElementIndex(t,r){return r*this.RANK+t}getElement(t,r){return this[r*this.RANK+t]}setElement(t,r,n){return this[r*this.RANK+t]=Hc(n),this}getColumn(t,r=new Array(this.RANK).fill(-0)){let n=t*this.RANK;for(let i=0;i<this.RANK;++i)r[i]=this[n+i];return r}setColumn(t,r){let n=t*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=r[i];return this}};function tQ(e,t){if(e===t){let r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function eQ(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],c=t[5],l=t[6],h=t[7],p=t[8],x=p*s-c*h,w=-p*o+c*l,E=h*o-s*l,P=r*x+n*w+i*E;return P?(P=1/P,e[0]=x*P,e[1]=(-p*n+i*h)*P,e[2]=(c*n-i*s)*P,e[3]=w*P,e[4]=(p*r-i*l)*P,e[5]=(-c*r+i*o)*P,e[6]=E*P,e[7]=(-h*r+n*l)*P,e[8]=(s*r-n*o)*P,e):null}function rQ(e){let t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],c=e[6],l=e[7],h=e[8];return t*(h*o-s*l)+r*(-h*i+s*c)+n*(l*i-o*c)}function ck(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=r[0],E=r[1],P=r[2],B=r[3],D=r[4],W=r[5],X=r[6],q=r[7],$=r[8];return e[0]=w*n+E*s+P*h,e[1]=w*i+E*c+P*p,e[2]=w*o+E*l+P*x,e[3]=B*n+D*s+W*h,e[4]=B*i+D*c+W*p,e[5]=B*o+D*l+W*x,e[6]=X*n+q*s+$*h,e[7]=X*i+q*c+$*p,e[8]=X*o+q*l+$*x,e}function nQ(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=r[0],E=r[1];return e[0]=n,e[1]=i,e[2]=o,e[3]=s,e[4]=c,e[5]=l,e[6]=w*n+E*s+h,e[7]=w*i+E*c+p,e[8]=w*o+E*l+x,e}function iQ(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=Math.sin(r),E=Math.cos(r);return e[0]=E*n+w*s,e[1]=E*i+w*c,e[2]=E*o+w*l,e[3]=E*s-w*n,e[4]=E*c-w*i,e[5]=E*l-w*o,e[6]=h,e[7]=p,e[8]=x,e}function lk(e,t,r){let n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function oQ(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r+r,c=n+n,l=i+i,h=r*s,p=n*s,x=n*c,w=i*s,E=i*c,P=i*l,B=o*s,D=o*c,W=o*l;return e[0]=1-x-P,e[3]=p-W,e[6]=w+D,e[1]=p+W,e[4]=1-h-P,e[7]=E-B,e[2]=w-D,e[5]=E+B,e[8]=1-h-x,e}var uk;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL1ROW0=3]="COL1ROW0",e[e.COL1ROW1=4]="COL1ROW1",e[e.COL1ROW2=5]="COL1ROW2",e[e.COL2ROW0=6]="COL2ROW0",e[e.COL2ROW1=7]="COL2ROW1",e[e.COL2ROW2=8]="COL2ROW2"})(uk||(uk={}));var f3t=Object.freeze([1,0,0,0,1,0,0,0,1]),sd=class extends EC{static get IDENTITY(){return d3t()}static get ZERO(){return p3t()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return uk}constructor(t,...r){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):r.length>0?this.copy([t,...r]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(f3t)}fromObject(t){return this.check()}fromQuaternion(t){return oQ(this,t),this.check()}set(t,r,n,i,o,s,c,l,h){return this[0]=t,this[1]=r,this[2]=n,this[3]=i,this[4]=o,this[5]=s,this[6]=c,this[7]=l,this[8]=h,this.check()}setRowMajor(t,r,n,i,o,s,c,l,h){return this[0]=t,this[1]=i,this[2]=c,this[3]=r,this[4]=o,this[5]=l,this[6]=n,this[7]=s,this[8]=h,this.check()}determinant(){return rQ(this)}transpose(){return tQ(this,this),this.check()}invert(){return eQ(this,this),this.check()}multiplyLeft(t){return ck(this,t,this),this.check()}multiplyRight(t){return ck(this,this,t),this.check()}rotate(t){return iQ(this,this,t),this.check()}scale(t){return Array.isArray(t)?lk(this,this,t):lk(this,this,[t,t]),this.check()}translate(t){return nQ(this,this,t),this.check()}transform(t,r){let n;switch(t.length){case 2:n=H$(r||[-0,-0],t,this);break;case 3:n=wC(r||[-0,-0,-0],t,this);break;case 4:n=G$(r||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return V$(n,t.length),n}transformVector(t,r){return this.transform(t,r)}transformVector2(t,r){return this.transform(t,r)}transformVector3(t,r){return this.transform(t,r)}},MC,SC=null;function p3t(){return MC||(MC=new sd([0,0,0,0,0,0,0,0,0]),Object.freeze(MC)),MC}function d3t(){return SC||(SC=new sd,Object.freeze(SC)),SC}var PC="KHR_texture_transform",m3t=PC,CC=new V0,A3t=new sd,g3t=new sd;async function _3t(e,t){if(!new go(e).hasExtension(PC)||!t.gltf?.loadBuffers)return;let i=e.json.materials||[];for(let o=0;o<i.length;o++)y3t(o,e)}function y3t(e,t){let r=t.json.materials?.[e],n=[r?.pbrMetallicRoughness?.baseColorTexture,r?.emissiveTexture,r?.normalTexture,r?.occlusionTexture,r?.pbrMetallicRoughness?.metallicRoughnessTexture],i=[];for(let o of n)o&&o?.extensions?.[PC]&&x3t(t,e,o,i)}function x3t(e,t,r,n){let i=v3t(r,n);if(!i)return;let o=e.json.meshes||[];for(let s of o)for(let c of s.primitives){let l=c.material;Number.isFinite(l)&&t===l&&b3t(e,c,i)}}function v3t(e,t){let r=e.extensions?.[PC],{texCoord:n=0}=e,{texCoord:i=n}=r;if(!(t.findIndex(([s,c])=>s===n&&c===i)!==-1)){let s=E3t(r);return n!==i&&(e.texCoord=i),t.push([n,i]),{originalTexCoord:n,texCoord:i,matrix:s}}return null}function b3t(e,t,r){let{originalTexCoord:n,texCoord:i,matrix:o}=r,s=t.attributes[`TEXCOORD_${n}`];if(Number.isFinite(s)){let c=e.json.accessors?.[s];if(c&&c.bufferView){let l=e.json.bufferViews?.[c.bufferView];if(l){let{arrayBuffer:h,byteOffset:p}=e.buffers[l.buffer],x=(p||0)+(c.byteOffset||0)+(l.byteOffset||0),{ArrayType:w,length:E}=Fy(c,l),P=fC[c.componentType],B=hC[c.type],D=l.byteStride||P*B,W=new Float32Array(E);for(let X=0;X<c.count;X++){let q=new w(h,x+X*D,2);CC.set(q[0],q[1],1),CC.transformByMatrix3(o),W.set([CC[0],CC[1]],X*B)}n===i?w3t(c,l,e.buffers,W):T3t(i,c,t,e,W)}}}}function w3t(e,t,r,n){e.componentType=5126,r.push({arrayBuffer:n.buffer,byteOffset:0,byteLength:n.buffer.byteLength}),t.buffer=r.length-1,t.byteLength=n.buffer.byteLength,t.byteOffset=0,delete t.byteStride}function T3t(e,t,r,n,i){n.buffers.push({arrayBuffer:i.buffer,byteOffset:0,byteLength:i.buffer.byteLength});let o=n.json.bufferViews;if(!o)return;o.push({buffer:n.buffers.length-1,byteLength:i.buffer.byteLength,byteOffset:0});let s=n.json.accessors;s&&(s.push({bufferView:o?.length-1,byteOffset:0,componentType:5126,count:t.count,type:"VEC2"}),r.attributes[`TEXCOORD_${e}`]=s.length-1)}function E3t(e){let{offset:t=[0,0],rotation:r=0,scale:n=[1,1]}=e,i=new sd().set(1,0,0,0,1,0,t[0],t[1],1),o=A3t.set(Math.cos(r),Math.sin(r),0,-Math.sin(r),Math.cos(r),0,0,0,1),s=g3t.set(n[0],0,0,0,n[1],0,0,0,1);return i.multiplyRight(o).multiplyRight(s)}var fk={};Lo(fk,{decode:()=>S3t,encode:()=>C3t,name:()=>M3t});var j0="KHR_lights_punctual",M3t=j0;async function S3t(e){let t=new go(e),{json:r}=t,n=t.getExtension(j0);n&&(t.json.lights=n.lights,t.removeExtension(j0));for(let i of r.nodes||[]){let o=t.getObjectExtension(i,j0);o&&(i.light=o.light),t.removeObjectExtension(i,j0)}}async function C3t(e){let t=new go(e),{json:r}=t;if(r.lights){let n=t.addExtension(j0);Ua(!n.lights),n.lights=r.lights,delete r.lights}if(t.json.lights){for(let n of t.json.lights){let i=n.node;t.addObjectExtension(i,j0,n)}delete t.json.lights}}var pk={};Lo(pk,{decode:()=>I3t,encode:()=>R3t,name:()=>P3t});var sw="KHR_materials_unlit",P3t=sw;async function I3t(e){let t=new go(e),{json:r}=t;for(let n of r.materials||[])n.extensions&&n.extensions.KHR_materials_unlit&&(n.unlit=!0),t.removeObjectExtension(n,sw);t.removeExtension(sw)}function R3t(e){let t=new go(e),{json:r}=t;if(t.materials)for(let n of r.materials||[])n.unlit&&(delete n.unlit,t.addObjectExtension(n,sw,{}),t.addExtension(sw))}var dk={};Lo(dk,{decode:()=>O3t,encode:()=>B3t,name:()=>L3t});var aw="KHR_techniques_webgl",L3t=aw;async function O3t(e){let t=new go(e),{json:r}=t,n=t.getExtension(aw);if(n){let i=D3t(n,t);for(let o of r.materials||[]){let s=t.getObjectExtension(o,aw);s&&(o.technique=Object.assign({},s,i[s.technique]),o.technique.values=N3t(o.technique,t)),t.removeObjectExtension(o,aw)}t.removeExtension(aw)}}async function B3t(e,t){}function D3t(e,t){let{programs:r=[],shaders:n=[],techniques:i=[]}=e,o=new TextDecoder;return n.forEach(s=>{if(Number.isFinite(s.bufferView))s.code=o.decode(t.getTypedArrayForBufferView(s.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),r.forEach(s=>{s.fragmentShader=n[s.fragmentShader],s.vertexShader=n[s.vertexShader]}),i.forEach(s=>{s.program=r[s.program]}),i}function N3t(e,t){let r=Object.assign({},e.values);return Object.keys(e.uniforms||{}).forEach(n=>{e.uniforms[n].value&&!(n in r)&&(r[n]=e.uniforms[n].value)}),Object.keys(r).forEach(n=>{typeof r[n]=="object"&&r[n].index!==void 0&&(r[n].texture=t.getTexture(r[n].index))}),r}var sQ=[WN,VN,$N,QN,JN,ik,fk,pk,dk,hk,qN];function aQ(e,t={},r){let n=sQ.filter(i=>lQ(i.name,t));for(let i of n)i.preprocess?.(e,t,r)}async function cQ(e,t={},r){let n=sQ.filter(i=>lQ(i.name,t));for(let i of n)await i.decode?.(e,t,r)}function lQ(e,t){let r=t?.gltf?.excludeExtensions||{};return!(e in r&&!r[e])}var mk="KHR_binary_glTF";function uQ(e){let t=new go(e),{json:r}=t;for(let n of r.images||[]){let i=t.getObjectExtension(n,mk);i&&Object.assign(n,i),t.removeObjectExtension(n,mk)}r.buffers&&r.buffers[0]&&delete r.buffers[0].uri,t.removeExtension(mk)}var hQ={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},F3t={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"},Ak=class{idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}};json;normalize(t,r){this.json=t.json;let n=t.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn(`glTF: Unknown version ${n.asset.version}`);return}if(!r.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),uQ(t),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)}_addAsset(t){t.asset=t.asset||{},t.asset.version="2.0",t.asset.generator=t.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(t){for(let r in hQ)this._convertTopLevelObjectToArray(t,r)}_convertTopLevelObjectToArray(t,r){let n=t[r];if(!(!n||Array.isArray(n))){t[r]=[];for(let i in n){let o=n[i];o.id=o.id||i;let s=t[r].length;t[r].push(o),this.idToIndexMap[r][i]=s}}}_convertObjectIdsToArrayIndices(t){for(let r in hQ)this._convertIdsToIndices(t,r);"scene"in t&&(t.scene=this._convertIdToIndex(t.scene,"scene"));for(let r of t.textures)this._convertTextureIds(r);for(let r of t.meshes)this._convertMeshIds(r);for(let r of t.nodes)this._convertNodeIds(r);for(let r of t.scenes)this._convertSceneIds(r)}_convertTextureIds(t){t.source&&(t.source=this._convertIdToIndex(t.source,"image"))}_convertMeshIds(t){for(let r of t.primitives){let{attributes:n,indices:i,material:o}=r;for(let s in n)n[s]=this._convertIdToIndex(n[s],"accessor");i&&(r.indices=this._convertIdToIndex(i,"accessor")),o&&(r.material=this._convertIdToIndex(o,"material"))}}_convertNodeIds(t){t.children&&(t.children=t.children.map(r=>this._convertIdToIndex(r,"node"))),t.meshes&&(t.meshes=t.meshes.map(r=>this._convertIdToIndex(r,"mesh")))}_convertSceneIds(t){t.nodes&&(t.nodes=t.nodes.map(r=>this._convertIdToIndex(r,"node")))}_convertIdsToIndices(t,r){t[r]||(console.warn(`gltf v1: json doesn't contain attribute ${r}`),t[r]=[]);for(let n of t[r])for(let i in n){let o=n[i],s=this._convertIdToIndex(o,i);n[i]=s}}_convertIdToIndex(t,r){let n=F3t[r];if(n in this.idToIndexMap){let i=this.idToIndexMap[n][t];if(!Number.isFinite(i))throw new Error(`gltf v1: failed to resolve ${r} with id ${t}`);return i}return t}_updateObjects(t){for(let r of this.json.buffers)delete r.type}_updateMaterial(t){for(let r of t.materials){r.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};let n=r.values?.tex||r.values?.texture2d_0||r.values?.diffuseTex,i=t.textures.findIndex(o=>o.id===n);i!==-1&&(r.pbrMetallicRoughness.baseColorTexture={index:i})}}};function fQ(e,t={}){return new Ak().normalize(e,t)}async function pQ(e,t,r=0,n,i){return z3t(e,t,r,n),fQ(e,{normalize:n?.gltf?.normalize}),aQ(e,n,i),n?.gltf?.loadBuffers&&e.json.buffers&&await U3t(e,n,i),n?.gltf?.loadImages&&await V3t(e,n,i),await cQ(e,n,i),e}function z3t(e,t,r,n){if(n.uri&&(e.baseUri=n.uri),t instanceof ArrayBuffer&&!C$(t,r,n)&&(t=new TextDecoder().decode(t)),typeof t=="string")e.json=zL(t);else if(t instanceof ArrayBuffer){let s={};r=P$(s,t,r,n.glb),Ua(s.type==="glTF",`Invalid GLB magic string ${s.type}`),e._glb=s,e.json=s.json}else Ua(!1,"GLTF: must be ArrayBuffer or string");let i=e.json.buffers||[];if(e.buffers=new Array(i.length).fill(null),e._glb&&e._glb.header.hasBinChunk){let{binChunks:s}=e._glb;e.buffers[0]={arrayBuffer:s[0].arrayBuffer,byteOffset:s[0].byteOffset,byteLength:s[0].byteLength}}let o=e.json.images||[];e.images=new Array(o.length).fill({})}async function U3t(e,t,r){let n=e.json.buffers||[];for(let i=0;i<n.length;++i){let o=n[i];if(o.uri){let{fetch:s}=r;Ua(s);let c=KN(o.uri,t),h=await(await r?.fetch?.(c))?.arrayBuffer?.();e.buffers[i]={arrayBuffer:h,byteOffset:0,byteLength:h.byteLength},delete o.uri}else e.buffers[i]===null&&(e.buffers[i]={arrayBuffer:new ArrayBuffer(o.byteLength),byteOffset:0,byteLength:o.byteLength})}}async function V3t(e,t,r){let n=j3t(e),i=e.json.images||[],o=[];for(let s of n)o.push(H3t(e,i[s],s,t,r));return await Promise.all(o)}function j3t(e){let t=new Set,r=e.json.textures||[];for(let n of r)n.source!==void 0&&t.add(n.source);return Array.from(t).sort()}async function H3t(e,t,r,n,i){let o;if(t.uri&&!t.hasOwnProperty("bufferView")){let c=KN(t.uri,n),{fetch:l}=i;o=await(await l(c)).arrayBuffer(),t.bufferView={data:o}}if(Number.isFinite(t.bufferView)){let c=y$(e.json,e.buffers,t.bufferView);o=zA(c.buffer,c.byteOffset,c.byteLength)}Ua(o,"glTF image has no data");let s=await iu(o,[Uf,NN],{...n,mimeType:t.mimeType,basis:n.basis||{format:cC()}},i);s&&s[0]&&(s={compressed:!0,mipmaps:!1,width:s[0].width,height:s[0].height,data:s[0]}),e.images=e.images||[],e.images[r]=s}var ad={dataType:null,batchType:null,name:"glTF",id:"gltf",module:"gltf",version:M$,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:W3t,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0},log:console}};async function W3t(e,t={},r){t={...ad.options,...t},t.gltf={...ad.options.gltf,...t.gltf};let{byteOffset:n=0}=t;return await pQ({},e,n,t,r)}var q3t={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},G3t={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Qu={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},X3t={magFilter:Qu.TEXTURE_MAG_FILTER,minFilter:Qu.TEXTURE_MIN_FILTER,wrapS:Qu.TEXTURE_WRAP_S,wrapT:Qu.TEXTURE_WRAP_T},Y3t={[Qu.TEXTURE_MAG_FILTER]:Qu.LINEAR,[Qu.TEXTURE_MIN_FILTER]:Qu.NEAREST_MIPMAP_LINEAR,[Qu.TEXTURE_WRAP_S]:Qu.REPEAT,[Qu.TEXTURE_WRAP_T]:Qu.REPEAT};function K3t(){return{id:"default-sampler",parameters:Y3t}}function Z3t(e){return G3t[e]}function $3t(e){return q3t[e]}var gk=class{baseUri="";jsonUnprocessed;json;buffers=[];images=[];postProcess(t,r={}){let{json:n,buffers:i=[],images:o=[]}=t,{baseUri:s=""}=t;return Ua(n),this.baseUri=s,this.buffers=i,this.images=o,this.jsonUnprocessed=n,this.json=this._resolveTree(t.json,r),this.json}_resolveTree(t,r={}){let n={...t};return this.json=n,t.bufferViews&&(n.bufferViews=t.bufferViews.map((i,o)=>this._resolveBufferView(i,o))),t.images&&(n.images=t.images.map((i,o)=>this._resolveImage(i,o))),t.samplers&&(n.samplers=t.samplers.map((i,o)=>this._resolveSampler(i,o))),t.textures&&(n.textures=t.textures.map((i,o)=>this._resolveTexture(i,o))),t.accessors&&(n.accessors=t.accessors.map((i,o)=>this._resolveAccessor(i,o))),t.materials&&(n.materials=t.materials.map((i,o)=>this._resolveMaterial(i,o))),t.meshes&&(n.meshes=t.meshes.map((i,o)=>this._resolveMesh(i,o))),t.nodes&&(n.nodes=t.nodes.map((i,o)=>this._resolveNode(i,o)),n.nodes=n.nodes.map((i,o)=>this._resolveNodeChildren(i))),t.skins&&(n.skins=t.skins.map((i,o)=>this._resolveSkin(i,o))),t.scenes&&(n.scenes=t.scenes.map((i,o)=>this._resolveScene(i,o))),typeof this.json.scene=="number"&&n.scenes&&(n.scene=n.scenes[this.json.scene]),n}getScene(t){return this._get(this.json.scenes,t)}getNode(t){return this._get(this.json.nodes,t)}getSkin(t){return this._get(this.json.skins,t)}getMesh(t){return this._get(this.json.meshes,t)}getMaterial(t){return this._get(this.json.materials,t)}getAccessor(t){return this._get(this.json.accessors,t)}getCamera(t){return this._get(this.json.cameras,t)}getTexture(t){return this._get(this.json.textures,t)}getSampler(t){return this._get(this.json.samplers,t)}getImage(t){return this._get(this.json.images,t)}getBufferView(t){return this._get(this.json.bufferViews,t)}getBuffer(t){return this._get(this.json.buffers,t)}_get(t,r){if(typeof r=="object")return r;let n=t&&t[r];return n||console.warn(`glTF file error: Could not find ${t}[${r}]`),n}_resolveScene(t,r){return{...t,id:t.id||`scene-${r}`,nodes:(t.nodes||[]).map(n=>this.getNode(n))}}_resolveNode(t,r){let n={...t,id:t?.id||`node-${r}`};return t.mesh!==void 0&&(n.mesh=this.getMesh(t.mesh)),t.camera!==void 0&&(n.camera=this.getCamera(t.camera)),t.skin!==void 0&&(n.skin=this.getSkin(t.skin)),t.meshes!==void 0&&t.meshes.length&&(n.mesh=t.meshes.reduce((i,o)=>{let s=this.getMesh(o);return i.id=s.id,i.primitives=i.primitives.concat(s.primitives),i},{primitives:[]})),n}_resolveNodeChildren(t){return t.children&&(t.children=t.children.map(r=>this.getNode(r))),t}_resolveSkin(t,r){let n=typeof t.inverseBindMatrices=="number"?this.getAccessor(t.inverseBindMatrices):void 0;return{...t,id:t.id||`skin-${r}`,inverseBindMatrices:n}}_resolveMesh(t,r){let n={...t,id:t.id||`mesh-${r}`,primitives:[]};return t.primitives&&(n.primitives=t.primitives.map(i=>{let o={...i,attributes:{},indices:void 0,material:void 0},s=i.attributes;for(let c in s)o.attributes[c]=this.getAccessor(s[c]);return i.indices!==void 0&&(o.indices=this.getAccessor(i.indices)),i.material!==void 0&&(o.material=this.getMaterial(i.material)),o})),n}_resolveMaterial(t,r){let n={...t,id:t.id||`material-${r}`};if(n.normalTexture&&(n.normalTexture={...n.normalTexture},n.normalTexture.texture=this.getTexture(n.normalTexture.index)),n.occlusionTexture&&(n.occlusionTexture={...n.occlusionTexture},n.occlusionTexture.texture=this.getTexture(n.occlusionTexture.index)),n.emissiveTexture&&(n.emissiveTexture={...n.emissiveTexture},n.emissiveTexture.texture=this.getTexture(n.emissiveTexture.index)),n.emissiveFactor||(n.emissiveFactor=n.emissiveTexture?[1,1,1]:[0,0,0]),n.pbrMetallicRoughness){n.pbrMetallicRoughness={...n.pbrMetallicRoughness};let i=n.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture={...i.baseColorTexture},i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture={...i.metallicRoughnessTexture},i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return n}_resolveAccessor(t,r){let n=Z3t(t.componentType),i=$3t(t.type),o=n*i,s={...t,id:t.id||`accessor-${r}`,bytesPerComponent:n,components:i,bytesPerElement:o,value:void 0,bufferView:void 0,sparse:void 0};if(t.bufferView!==void 0&&(s.bufferView=this.getBufferView(t.bufferView)),s.bufferView){let c=s.bufferView.buffer,{ArrayType:l,byteLength:h}=Fy(s,s.bufferView),p=(s.bufferView.byteOffset||0)+(s.byteOffset||0)+c.byteOffset,x=c.arrayBuffer.slice(p,p+h);s.bufferView.byteStride&&(x=this._getValueFromInterleavedBuffer(c,p,s.bufferView.byteStride,s.bytesPerElement,s.count)),s.value=new l(x)}return s}_getValueFromInterleavedBuffer(t,r,n,i,o){let s=new Uint8Array(o*i);for(let c=0;c<o;c++){let l=r+c*n;s.set(new Uint8Array(t.arrayBuffer.slice(l,l+i)),c*i)}return s.buffer}_resolveTexture(t,r){return{...t,id:t.id||`texture-${r}`,sampler:typeof t.sampler=="number"?this.getSampler(t.sampler):K3t(),source:typeof t.source=="number"?this.getImage(t.source):void 0}}_resolveSampler(t,r){let n={id:t.id||`sampler-${r}`,...t,parameters:{}};for(let i in n){let o=this._enumSamplerParameter(i);o!==void 0&&(n.parameters[o]=n[i])}return n}_enumSamplerParameter(t){return X3t[t]}_resolveImage(t,r){let n={...t,id:t.id||`image-${r}`,image:null,bufferView:t.bufferView!==void 0?this.getBufferView(t.bufferView):void 0},i=this.images[r];return i&&(n.image=i),n}_resolveBufferView(t,r){let n=t.buffer,i=this.buffers[n].arrayBuffer,o=this.buffers[n].byteOffset||0;return t.byteOffset&&(o+=t.byteOffset),{id:`bufferView-${r}`,...t,buffer:this.buffers[n],data:new Uint8Array(i,o,t.byteLength)}}_resolveCamera(t,r){let n={...t,id:t.id||`camera-${r}`};return n.perspective,n.orthographic,n}};function H0(e,t){return new gk().postProcess(e,t)}async function dQ(e){let t=[];return e.scenes.forEach(r=>{r.traverse(n=>{Object.values(n.model.uniforms).forEach(i=>{i.loaded===!1&&t.push(i)})})}),await Q3t(()=>t.some(r=>!r.loaded))}async function Q3t(e){for(;e();)await new Promise(t=>requestAnimationFrame(t))}var mQ=`uniform scenegraphUniforms {
  float sizeScale;
  float sizeMinPixels;
  float sizeMaxPixels;
  mat4 sceneModelMatrix;
  bool composeModelMatrix;
} scenegraph;
`,AQ={name:"scenegraph",vs:mQ,fs:mQ,uniformTypes:{sizeScale:"f32",sizeMinPixels:"f32",sizeMaxPixels:"f32",sceneModelMatrix:"mat4x4<f32>",composeModelMatrix:"f32"}};var gQ=`#version 300 es
#define SHADER_NAME scenegraph-layer-vertex-shader
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec3 instanceModelMatrixCol0;
in vec3 instanceModelMatrixCol1;
in vec3 instanceModelMatrixCol2;
in vec3 instanceTranslation;
in vec3 positions;
#ifdef HAS_UV
in vec2 texCoords;
#endif
#ifdef LIGHTING_PBR
#ifdef HAS_NORMALS
in vec3 normals;
#endif
#endif
out vec4 vColor;
#ifndef LIGHTING_PBR
#ifdef HAS_UV
out vec2 vTEXCOORD_0;
#endif
#endif
void main(void) {
#if defined(HAS_UV) && !defined(LIGHTING_PBR)
vTEXCOORD_0 = texCoords;
geometry.uv = texCoords;
#endif
geometry.worldPosition = instancePositions;
geometry.pickingColor = instancePickingColors;
mat3 instanceModelMatrix = mat3(instanceModelMatrixCol0, instanceModelMatrixCol1, instanceModelMatrixCol2);
vec3 normal = vec3(0.0, 0.0, 1.0);
#ifdef LIGHTING_PBR
#ifdef HAS_NORMALS
normal = instanceModelMatrix * (scenegraph.sceneModelMatrix * vec4(normals, 0.0)).xyz;
#endif
#endif
float originalSize = project_size_to_pixel(scenegraph.sizeScale);
float clampedSize = clamp(originalSize, scenegraph.sizeMinPixels, scenegraph.sizeMaxPixels);
vec3 pos = (instanceModelMatrix * (scenegraph.sceneModelMatrix * vec4(positions, 1.0)).xyz) * scenegraph.sizeScale * (clampedSize / originalSize) + instanceTranslation;
if(scenegraph.composeModelMatrix) {
DECKGL_FILTER_SIZE(pos, geometry);
geometry.normal = project_normal(normal);
geometry.worldPosition += pos;
gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
}
else {
pos = project_size(pos);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);
geometry.normal = project_normal(normal);
}
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
#ifdef LIGHTING_PBR
pbr_vPosition = geometry.position.xyz;
#ifdef HAS_NORMALS
pbr_vNormal = geometry.normal;
#endif
#ifdef HAS_UV
pbr_vUV = texCoords;
#else
pbr_vUV = vec2(0., 0.);
#endif
geometry.uv = pbr_vUV;
#endif
vColor = instanceColors;
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var _Q=`#version 300 es
#define SHADER_NAME scenegraph-layer-fragment-shader
in vec4 vColor;
out vec4 fragColor;
#ifndef LIGHTING_PBR
#if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
in vec2 vTEXCOORD_0;
uniform sampler2D pbr_baseColorSampler;
#endif
#endif
void main(void) {
#ifdef LIGHTING_PBR
fragColor = vColor * pbr_filterColor(vec4(0));
geometry.uv = pbr_vUV;
#else
#if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
fragColor = vColor * texture(pbr_baseColorSampler, vTEXCOORD_0);
geometry.uv = vTEXCOORD_0;
#else
fragColor = vColor;
#endif
#endif
fragColor.a *= layer.opacity;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var yQ=[255,255,255,255],J3t={scenegraph:{type:"object",value:null,async:!0},getScene:e=>e&&e.scenes?typeof e.scene=="object"?e.scene:e.scenes[e.scene||0]:e,getAnimator:e=>e&&e.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:e=>e.position},getColor:{type:"accessor",value:yQ},_lighting:"flat",_imageBasedLightingEnvironment:void 0,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[ad]},cw=class extends qi{getShaders(){let t={},r;this.props._lighting==="pbr"?(r=r0,t.LIGHTING_PBR=1):r={name:"pbrMaterial"};let n=[Ei,Mo,AQ,r];return super.getShaders({defines:t,vs:gQ,fs:_Q,modules:n})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:"unorm8",size:this.props.colorFormat.length,accessor:"getColor",defaultValue:yQ,transition:!0},instanceModelMatrix:iC})}updateState(t){super.updateState(t);let{props:r,oldProps:n}=t;r.scenegraph!==n.scenegraph?this._updateScenegraph():r._animations!==n._animations&&this._applyAnimationsProp(this.state.animator,r._animations)}finalizeState(t){super.finalizeState(t),this.state.scenegraph?.destroy()}get isLoaded(){return Boolean(this.state?.scenegraph&&super.isLoaded)}_updateScenegraph(){let t=this.props,{device:r}=this.context,n=null;if(t.scenegraph instanceof Zu)n={scenes:[t.scenegraph]};else if(t.scenegraph&&typeof t.scenegraph=="object"){let c=t.scenegraph,l=c.json?H0(c):c,h=UN(r,l,this._getModelOptions());n={gltf:l,...h},dQ(h).then(()=>{this.setNeedsRedraw()}).catch(p=>{this.raiseError(p,"loading glTF")})}let i={layer:this,device:this.context.device},o=t.getScene(n,i),s=t.getAnimator(n,i);if(o instanceof hu){this.state.scenegraph?.destroy(),this._applyAnimationsProp(s,t._animations);let c=[];o.traverse(l=>{l instanceof Wf&&c.push(l.model)}),this.setState({scenegraph:o,animator:s,models:c}),this.getAttributeManager().invalidateAll()}else o!==null&&br.warn("invalid scenegraph:",o)()}_applyAnimationsProp(t,r){if(!t||!r)return;let n=t.getAnimations();Object.keys(r).sort().forEach(i=>{let o=r[i];if(i==="*")n.forEach(s=>{Object.assign(s,o)});else if(Number.isFinite(Number(i))){let s=Number(i);s>=0&&s<n.length?Object.assign(n[s],o):br.warn(`animation ${i} not found`)()}else{let s=n.find(({name:c})=>c===i);s?Object.assign(s,o):br.warn(`animation ${i} not found`)()}})}_getModelOptions(){let{_imageBasedLightingEnvironment:t}=this.props,r;return t&&(typeof t=="function"?r=t({gl:this.context.gl,layer:this}):r=t),{imageBasedLightingEnvironment:r,modelOptions:{id:this.props.id,isInstanced:!0,bufferLayout:this.getAttributeManager().getBufferLayouts(),...this.getShaders()},useTangents:!1}}draw({context:t}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(t.timeline.getTime()),this.setNeedsRedraw());let{viewport:r,renderPass:n}=this.context,{sizeScale:i,sizeMinPixels:o,sizeMaxPixels:s,coordinateSystem:c}=this.props,l=this.getNumInstances();this.state.scenegraph.traverse((h,{worldMatrix:p})=>{if(h instanceof Wf){let{model:x}=h;x.setInstanceCount(l);let w={camera:x.uniforms.cameraPosition},E={sizeScale:i,sizeMinPixels:o,sizeMaxPixels:s,composeModelMatrix:oC(r,c),sceneModelMatrix:p};x.shaderInputs.setProps({pbrProjection:w,scenegraph:E}),x.draw(n)}})}};cw.defaultProps=J3t;cw.layerName="ScenegraphLayer";var IC=cw;var xQ=`uniform meshUniforms {
  bool pickFeatureIds;
} mesh;
`,vQ={name:"mesh",vs:xQ,fs:xQ,uniformTypes:{pickFeatureIds:"f32"}};var bQ=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec4 uvRegions;
in vec3 featureIdsPickingColors;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec3 instanceModelMatrixCol0;
in vec3 instanceModelMatrixCol1;
in vec3 instanceModelMatrixCol2;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;
vec2 applyUVRegion(vec2 uv) {
#ifdef HAS_UV_REGIONS
return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;
#else
return uv;
#endif
}
void main(void) {
vec2 uv = applyUVRegion(texCoords);
geometry.uv = uv;
if (mesh.pickFeatureIds) {
geometry.pickingColor = featureIdsPickingColors;
} else {
geometry.pickingColor = instancePickingColors;
}
mat3 instanceModelMatrix = mat3(instanceModelMatrixCol0, instanceModelMatrixCol1, instanceModelMatrixCol2);
vTexCoord = uv;
cameraPosition = project.cameraPosition;
vColor = vec4(colors * instanceColors.rgb, instanceColors.a);
vec3 pos = (instanceModelMatrix * positions) * simpleMesh.sizeScale;
vec3 projectedPosition = project_position(positions);
position_commonspace = vec4(projectedPosition, 1.0);
gl_Position = project_common_position_to_clipspace(position_commonspace);
geometry.position = position_commonspace;
normals_commonspace = project_normal(instanceModelMatrix * normals);
geometry.normal = normals_commonspace;
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
#ifdef MODULE_PBRMATERIAL
pbr_vPosition = geometry.position.xyz;
#ifdef HAS_NORMALS
pbr_vNormal = geometry.normal;
#endif
#ifdef HAS_UV
pbr_vUV = uv;
#else
pbr_vUV = vec2(0., 0.);
#endif
geometry.uv = pbr_vUV;
#endif
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var wQ=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs
precision highp float;
uniform sampler2D sampler;
in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
#ifdef MODULE_PBRMATERIAL
fragColor = vColor * pbr_filterColor(vec4(0));
geometry.uv = pbr_vUV;
fragColor.a *= layer.opacity;
#else
geometry.uv = vTexCoord;
vec3 normal;
if (simpleMesh.flatShading) {
normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
} else {
normal = normals_commonspace;
}
vec4 color = simpleMesh.hasTexture ? texture(sampler, vTexCoord) : vColor;
vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
fragColor = vec4(lightColor, color.a * layer.opacity);
#endif
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function tCt(e){let t=e.positions||e.POSITION,r=t.value.length/t.size;e.COLOR_0||e.colors||(e.colors={size:4,value:new Uint8Array(r*4).fill(255),normalized:!0})}var eCt={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}},lw=class extends F0{getShaders(){let t=super.getShaders();return t.modules.push(r0,vQ),{...t,vs:bQ,fs:wQ}}initializeState(){let{featureIds:t}=this.props;super.initializeState();let r=this.getAttributeManager();t&&r.add({featureIdsPickingColors:{type:"uint8",size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState(t){super.updateState(t);let{props:r,oldProps:n}=t;r.pbrMaterial!==n.pbrMaterial&&this.updatePbrMaterialUniforms(r.pbrMaterial)}draw(t){let{featureIds:r}=this.props,{model:n}=this.state;if(!n)return;let i={pickFeatureIds:Boolean(r)},o={camera:n.uniforms.cameraPosition};n.shaderInputs.setProps({pbrProjection:o,mesh:i}),super.draw(t)}getModel(t){let{id:r}=this.props,n=this.parseMaterial(this.props.pbrMaterial,t);this.setState({parsedPBRMaterial:n});let i=this.getShaders();return tCt(t.attributes),new jn(this.context.device,{...this.getShaders(),id:r,geometry:t,bufferLayout:this.getAttributeManager().getBufferLayouts(),defines:{...i.defines,...n?.defines,HAS_UV_REGIONS:t.attributes.uvRegions?1:0},parameters:n?.parameters,isInstanced:!0})}updatePbrMaterialUniforms(t){let{model:r}=this.state;if(r){let{mesh:n}=this.props,i=this.parseMaterial(t,n);this.setState({parsedPBRMaterial:i});let{pbr_baseColorSampler:o}=i.bindings,{emptyTexture:s}=this.state,c={sampler:o||s,hasTexture:Boolean(o)},{camera:l,...h}={...i.bindings,...i.uniforms};r.shaderInputs.setProps({simpleMesh:c,pbrMaterial:h})}}parseMaterial(t,r){let n=Boolean(t.pbrMetallicRoughness&&t.pbrMetallicRoughness.baseColorTexture);return rw(this.context.device,{unlit:n,...t},{NORMAL:r.attributes.normals,TEXCOORD_0:r.attributes.texCoords},{pbrDebug:!1,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(t){let r=this.props.featureIds,n=new Uint8ClampedArray(r.length*t.size),i=[];for(let o=0;o<r.length;o++)this.encodePickingColor(r[o],i),n[o*3]=i[0],n[o*3+1]=i[1],n[o*3+2]=i[2];t.value=n}finalizeState(t){super.finalizeState(t),this.state.parsedPBRMaterial?.generatedTextures.forEach(r=>r.destroy()),this.setState({parsedPBRMaterial:null})}};lw.layerName="MeshLayer";lw.defaultProps=eCt;var TQ=lw;var rCt=1/Math.PI*180,B2e=1/180*Math.PI,nCt={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...nCt}};var sa=globalThis.mathgl.config;function _k(e,{precision:t=sa.precision}={}){return e=iCt(e),`${parseFloat(e.toPrecision(t))}`}function Jf(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Ju(e,t){return sCt(e,r=>r*rCt,t)}function RC(e,t,r){let n=sa.EPSILON;r&&(sa.EPSILON=r);try{if(e===t)return!0;if(Jf(e)&&Jf(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!RC(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<=sa.EPSILON*Math.max(1,Math.abs(e),Math.abs(t)):!1}finally{sa.EPSILON=n}}function iCt(e){return Math.round(e/sa.EPSILON)*sa.EPSILON}function oCt(e){return e.clone?e.clone():new Array(e.length)}function sCt(e,t,r){if(Jf(e)){let n=e;r=r||oCt(n);for(let i=0;i<r.length&&i<n.length;++i){let o=typeof e=="number"?e:e[i];r[i]=t(o,i,r)}return r}return t(e)}var Fm=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(t,r=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+r];return this.check()}toArray(t=[],r=0){for(let n=0;n<this.ELEMENTS;++n)t[r+n]=this[n];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:Jf(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(sa)}formatString(t){let r="";for(let n=0;n<this.ELEMENTS;++n)r+=(n>0?", ":"")+_k(this[n],t);return`${t.printTypes?this.constructor.name:""}[${r}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(!RC(this[r],t[r]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==t[r])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,r,n){if(n===void 0)return this.lerp(this,t,r);for(let i=0;i<this.ELEMENTS;++i){let o=t[i],s=typeof r=="number"?r:r[i];this[i]=o+n*(s-o)}return this.check()}min(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(t[r],this[r]);return this.check()}max(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(t[r],this[r]);return this.check()}clamp(t,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),r[n]);return this.check()}add(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]+=r[n];return this.check()}subtract(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]-=r[n];return this.check()}scale(t){if(typeof t=="number")for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;else for(let r=0;r<this.ELEMENTS&&r<t.length;++r)this[r]*=t[r];return this.check()}multiplyByScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}check(){if(sa.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)t=t&&Number.isFinite(this[r]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=t;return this.check()}addScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),r);return this.check()}get elements(){return this}};function aCt(e,t){if(e.length!==t)return!1;for(let r=0;r<e.length;++r)if(!Number.isFinite(e[r]))return!1;return!0}function io(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function zm(e,t,r=""){if(sa.debug&&!aCt(e,t))throw new Error(`math.gl: ${r} some fields set to invalid numbers'`);return e}function yk(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}var Xy=class extends Fm{get x(){return this[0]}set x(t){this[0]=io(t)}get y(){return this[1]}set y(t){this[1]=io(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let r=0;r<this.ELEMENTS;++r)t+=this[r]*this[r];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let r=0;for(let n=0;n<this.ELEMENTS;++n){let i=this[n]-t[n];r+=i*i}return io(r)}dot(t){let r=0;for(let n=0;n<this.ELEMENTS;++n)r+=this[n]*t[n];return io(r)}normalize(){let t=this.magnitude();if(t!==0)for(let r=0;r<this.ELEMENTS;++r)this[r]/=t;return this.check()}multiply(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]*=r[n];return this.check()}divide(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]/=r[n];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return yk(t>=0&&t<this.ELEMENTS,"index is out of range"),io(this[t])}setComponent(t,r){return yk(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=r,this.check()}addVectors(t,r){return this.copy(t).add(r)}subVectors(t,r){return this.copy(t).subtract(r)}multiplyVectors(t,r){return this.copy(t).multiply(r)}addScaledVector(t,r){return this.add(new this.constructor(t).multiplyScalar(r))}};var Wc=typeof Float32Array<"u"?Float32Array:Array;var q2e=Math.PI/180;function cCt(){let e=new Wc(2);return Wc!=Float32Array&&(e[0]=0,e[1]=0),e}function SQ(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e}function CQ(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e}var G2e=function(){let e=cCt();return function(t,r,n,i,o,s){let c,l;for(r||(r=2),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],o(e,e,s),t[c]=e[0],t[c+1]=e[1];return t}}();function PQ(e,t,r){let n=t[0],i=t[1],o=r[3]*n+r[7]*i||1;return e[0]=(r[0]*n+r[4]*i)/o,e[1]=(r[1]*n+r[5]*i)/o,e}function LC(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[3]*n+r[7]*i+r[11]*o||1;return e[0]=(r[0]*n+r[4]*i+r[8]*o)/s,e[1]=(r[1]*n+r[5]*i+r[9]*o)/s,e[2]=(r[2]*n+r[6]*i+r[10]*o)/s,e}function IQ(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e[2]=t[2],e}function RQ(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e[2]=t[2],e[3]=t[3],e}function OC(e,t,r){let n=t[0],i=t[1],o=t[2];return e[0]=r[0]*n+r[3]*i+r[6]*o,e[1]=r[1]*n+r[4]*i+r[7]*o,e[2]=r[2]*n+r[5]*i+r[8]*o,e[3]=t[3],e}function xk(){let e=new Wc(3);return Wc!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function lCt(e){let t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function vk(e,t,r){let n=new Wc(3);return n[0]=e,n[1]=t,n[2]=r,n}function LQ(e,t){let r=t[0],n=t[1],i=t[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function bk(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Yy(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[0],c=r[1],l=r[2];return e[0]=i*l-o*c,e[1]=o*s-n*l,e[2]=n*c-i*s,e}function Ky(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[3]*n+r[7]*i+r[11]*o+r[15];return s=s||1,e[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/s,e[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/s,e[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/s,e}function BC(e,t,r){let n=t[0],i=t[1],o=t[2];return e[0]=n*r[0]+i*r[3]+o*r[6],e[1]=n*r[1]+i*r[4]+o*r[7],e[2]=n*r[2]+i*r[5]+o*r[8],e}function DC(e,t,r){let n=r[0],i=r[1],o=r[2],s=r[3],c=t[0],l=t[1],h=t[2],p=i*h-o*l,x=o*c-n*h,w=n*l-i*c,E=i*w-o*x,P=o*p-n*w,B=n*x-i*p,D=s*2;return p*=D,x*=D,w*=D,E*=2,P*=2,B*=2,e[0]=c+p+E,e[1]=l+x+P,e[2]=h+w+B,e}function OQ(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function BQ(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function DQ(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function NQ(e,t){let r=e[0],n=e[1],i=e[2],o=t[0],s=t[1],c=t[2],l=Math.sqrt((r*r+n*n+i*i)*(o*o+s*s+c*c)),h=l&&bk(e,t)/l;return Math.acos(Math.min(Math.max(h,-1),1))}var kQ=lCt;var K2e=function(){let e=xk();return function(t,r,n,i,o,s){let c,l;for(r||(r=3),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],o(e,e,s),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2];return t}}();var wk=[0,0,0],NC,nn=class extends Xy{static get ZERO(){return NC||(NC=new nn(0,0,0),Object.freeze(NC)),NC}constructor(t=0,r=0,n=0){super(-0,-0,-0),arguments.length===1&&Jf(t)?this.copy(t):(sa.debug&&(io(t),io(r),io(n)),this[0]=t,this[1]=r,this[2]=n)}set(t,r,n){return this[0]=t,this[1]=r,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return sa.debug&&(io(t.x),io(t.y),io(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=io(t)}angle(t){return NQ(this,t)}cross(t){return Yy(this,this,t),this.check()}rotateX({radians:t,origin:r=wk}){return OQ(this,this,r,t),this.check()}rotateY({radians:t,origin:r=wk}){return BQ(this,this,r,t),this.check()}rotateZ({radians:t,origin:r=wk}){return DQ(this,this,r,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return Ky(this,this,t),this.check()}transformAsVector(t){return LC(this,this,t),this.check()}transformByMatrix3(t){return BC(this,this,t),this.check()}transformByMatrix2(t){return IQ(this,this,t),this.check()}transformByQuaternion(t){return DC(this,this,t),this.check()}};var kC,Zy=class extends Xy{static get ZERO(){return kC||(kC=new Zy(0,0,0,0),Object.freeze(kC)),kC}constructor(t=0,r=0,n=0,i=0){super(-0,-0,-0,-0),Jf(t)&&arguments.length===1?this.copy(t):(sa.debug&&(io(t),io(r),io(n),io(i)),this[0]=t,this[1]=r,this[2]=n,this[3]=i)}set(t,r,n,i){return this[0]=t,this[1]=r,this[2]=n,this[3]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return sa.debug&&(io(t.x),io(t.y),io(t.z),io(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=io(t)}get w(){return this[3]}set w(t){this[3]=io(t)}transform(t){return Ky(this,this,t),this.check()}transformByMatrix3(t){return OC(this,this,t),this.check()}transformByMatrix2(t){return RQ(this,this,t),this.check()}transformByQuaternion(t){return DC(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}};var $y=class extends Fm{toString(){let t="[";if(sa.printRowMajor){t+="row-major:";for(let r=0;r<this.RANK;++r)for(let n=0;n<this.RANK;++n)t+=` ${this[n*this.RANK+r]}`}else{t+="column-major:";for(let r=0;r<this.ELEMENTS;++r)t+=` ${this[r]}`}return t+="]",t}getElementIndex(t,r){return r*this.RANK+t}getElement(t,r){return this[r*this.RANK+t]}setElement(t,r,n){return this[r*this.RANK+t]=io(n),this}getColumn(t,r=new Array(this.RANK).fill(-0)){let n=t*this.RANK;for(let i=0;i<this.RANK;++i)r[i]=this[n+i];return r}setColumn(t,r){let n=t*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=r[i];return this}};function FQ(){let e=new Wc(9);return Wc!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function zQ(e,t){if(e===t){let r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function UQ(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],c=t[5],l=t[6],h=t[7],p=t[8],x=p*s-c*h,w=-p*o+c*l,E=h*o-s*l,P=r*x+n*w+i*E;return P?(P=1/P,e[0]=x*P,e[1]=(-p*n+i*h)*P,e[2]=(c*n-i*s)*P,e[3]=w*P,e[4]=(p*r-i*l)*P,e[5]=(-c*r+i*o)*P,e[6]=E*P,e[7]=(-h*r+n*l)*P,e[8]=(s*r-n*o)*P,e):null}function VQ(e){let t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],c=e[6],l=e[7],h=e[8];return t*(h*o-s*l)+r*(-h*i+s*c)+n*(l*i-o*c)}function Tk(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=r[0],E=r[1],P=r[2],B=r[3],D=r[4],W=r[5],X=r[6],q=r[7],$=r[8];return e[0]=w*n+E*s+P*h,e[1]=w*i+E*c+P*p,e[2]=w*o+E*l+P*x,e[3]=B*n+D*s+W*h,e[4]=B*i+D*c+W*p,e[5]=B*o+D*l+W*x,e[6]=X*n+q*s+$*h,e[7]=X*i+q*c+$*p,e[8]=X*o+q*l+$*x,e}function jQ(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=r[0],E=r[1];return e[0]=n,e[1]=i,e[2]=o,e[3]=s,e[4]=c,e[5]=l,e[6]=w*n+E*s+h,e[7]=w*i+E*c+p,e[8]=w*o+E*l+x,e}function HQ(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=Math.sin(r),E=Math.cos(r);return e[0]=E*n+w*s,e[1]=E*i+w*c,e[2]=E*o+w*l,e[3]=E*s-w*n,e[4]=E*c-w*i,e[5]=E*l-w*o,e[6]=h,e[7]=p,e[8]=x,e}function Ek(e,t,r){let n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function WQ(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r+r,c=n+n,l=i+i,h=r*s,p=n*s,x=n*c,w=i*s,E=i*c,P=i*l,B=o*s,D=o*c,W=o*l;return e[0]=1-x-P,e[3]=p-W,e[6]=w+D,e[1]=p+W,e[4]=1-h-P,e[7]=E-B,e[2]=w-D,e[5]=E+B,e[8]=1-h-x,e}var Mk;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL1ROW0=3]="COL1ROW0",e[e.COL1ROW1=4]="COL1ROW1",e[e.COL1ROW2=5]="COL1ROW2",e[e.COL2ROW0=6]="COL2ROW0",e[e.COL2ROW1=7]="COL2ROW1",e[e.COL2ROW2=8]="COL2ROW2"})(Mk||(Mk={}));var fCt=Object.freeze([1,0,0,0,1,0,0,0,1]),W0=class extends $y{static get IDENTITY(){return dCt()}static get ZERO(){return pCt()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return Mk}constructor(t,...r){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):r.length>0?this.copy([t,...r]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(fCt)}fromObject(t){return this.check()}fromQuaternion(t){return WQ(this,t),this.check()}set(t,r,n,i,o,s,c,l,h){return this[0]=t,this[1]=r,this[2]=n,this[3]=i,this[4]=o,this[5]=s,this[6]=c,this[7]=l,this[8]=h,this.check()}setRowMajor(t,r,n,i,o,s,c,l,h){return this[0]=t,this[1]=i,this[2]=c,this[3]=r,this[4]=o,this[5]=l,this[6]=n,this[7]=s,this[8]=h,this.check()}determinant(){return VQ(this)}transpose(){return zQ(this,this),this.check()}invert(){return UQ(this,this),this.check()}multiplyLeft(t){return Tk(this,t,this),this.check()}multiplyRight(t){return Tk(this,this,t),this.check()}rotate(t){return HQ(this,this,t),this.check()}scale(t){return Array.isArray(t)?Ek(this,this,t):Ek(this,this,[t,t]),this.check()}translate(t){return jQ(this,this,t),this.check()}transform(t,r){let n;switch(t.length){case 2:n=SQ(r||[-0,-0],t,this);break;case 3:n=BC(r||[-0,-0,-0],t,this);break;case 4:n=OC(r||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return zm(n,t.length),n}transformVector(t,r){return this.transform(t,r)}transformVector2(t,r){return this.transform(t,r)}transformVector3(t,r){return this.transform(t,r)}},FC,zC=null;function pCt(){return FC||(FC=new W0([0,0,0,0,0,0,0,0,0]),Object.freeze(FC)),FC}function dCt(){return zC||(zC=new W0,Object.freeze(zC)),zC}function mCt(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function qQ(e,t){if(e===t){let r=t[1],n=t[2],i=t[3],o=t[6],s=t[7],c=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=i,e[13]=s,e[14]=c}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function GQ(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],c=t[5],l=t[6],h=t[7],p=t[8],x=t[9],w=t[10],E=t[11],P=t[12],B=t[13],D=t[14],W=t[15],X=r*c-n*s,q=r*l-i*s,$=r*h-o*s,et=n*l-i*c,F=n*h-o*c,ut=i*h-o*l,ot=p*B-x*P,J=p*D-w*P,G=p*W-E*P,mt=x*D-w*B,Mt=x*W-E*B,ct=w*W-E*D,gt=X*ct-q*Mt+$*mt+et*G-F*J+ut*ot;return gt?(gt=1/gt,e[0]=(c*ct-l*Mt+h*mt)*gt,e[1]=(i*Mt-n*ct-o*mt)*gt,e[2]=(B*ut-D*F+W*et)*gt,e[3]=(w*F-x*ut-E*et)*gt,e[4]=(l*G-s*ct-h*J)*gt,e[5]=(r*ct-i*G+o*J)*gt,e[6]=(D*$-P*ut-W*q)*gt,e[7]=(p*ut-w*$+E*q)*gt,e[8]=(s*Mt-c*G+h*ot)*gt,e[9]=(n*G-r*Mt-o*ot)*gt,e[10]=(P*F-B*$+W*X)*gt,e[11]=(x*$-p*F-E*X)*gt,e[12]=(c*J-s*mt-l*ot)*gt,e[13]=(r*mt-n*J+i*ot)*gt,e[14]=(B*q-P*et-D*X)*gt,e[15]=(p*et-x*q+w*X)*gt,e):null}function XQ(e){let t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],c=e[6],l=e[7],h=e[8],p=e[9],x=e[10],w=e[11],E=e[12],P=e[13],B=e[14],D=e[15],W=t*s-r*o,X=t*c-n*o,q=r*c-n*s,$=h*P-p*E,et=h*B-x*E,F=p*B-x*P,ut=t*F-r*et+n*$,ot=o*F-s*et+c*$,J=h*q-p*X+x*W,G=E*q-P*X+B*W;return l*ut-i*ot+D*J-w*G}function Sk(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=t[9],E=t[10],P=t[11],B=t[12],D=t[13],W=t[14],X=t[15],q=r[0],$=r[1],et=r[2],F=r[3];return e[0]=q*n+$*c+et*x+F*B,e[1]=q*i+$*l+et*w+F*D,e[2]=q*o+$*h+et*E+F*W,e[3]=q*s+$*p+et*P+F*X,q=r[4],$=r[5],et=r[6],F=r[7],e[4]=q*n+$*c+et*x+F*B,e[5]=q*i+$*l+et*w+F*D,e[6]=q*o+$*h+et*E+F*W,e[7]=q*s+$*p+et*P+F*X,q=r[8],$=r[9],et=r[10],F=r[11],e[8]=q*n+$*c+et*x+F*B,e[9]=q*i+$*l+et*w+F*D,e[10]=q*o+$*h+et*E+F*W,e[11]=q*s+$*p+et*P+F*X,q=r[12],$=r[13],et=r[14],F=r[15],e[12]=q*n+$*c+et*x+F*B,e[13]=q*i+$*l+et*w+F*D,e[14]=q*o+$*h+et*E+F*W,e[15]=q*s+$*p+et*P+F*X,e}function YQ(e,t,r){let n=r[0],i=r[1],o=r[2],s,c,l,h,p,x,w,E,P,B,D,W;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*o+t[12],e[13]=t[1]*n+t[5]*i+t[9]*o+t[13],e[14]=t[2]*n+t[6]*i+t[10]*o+t[14],e[15]=t[3]*n+t[7]*i+t[11]*o+t[15]):(s=t[0],c=t[1],l=t[2],h=t[3],p=t[4],x=t[5],w=t[6],E=t[7],P=t[8],B=t[9],D=t[10],W=t[11],e[0]=s,e[1]=c,e[2]=l,e[3]=h,e[4]=p,e[5]=x,e[6]=w,e[7]=E,e[8]=P,e[9]=B,e[10]=D,e[11]=W,e[12]=s*n+p*i+P*o+t[12],e[13]=c*n+x*i+B*o+t[13],e[14]=l*n+w*i+D*o+t[14],e[15]=h*n+E*i+W*o+t[15]),e}function KQ(e,t,r){let n=r[0],i=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function ZQ(e,t,r,n){let i=n[0],o=n[1],s=n[2],c=Math.sqrt(i*i+o*o+s*s),l,h,p,x,w,E,P,B,D,W,X,q,$,et,F,ut,ot,J,G,mt,Mt,ct,gt,ee;return c<1e-6?null:(c=1/c,i*=c,o*=c,s*=c,h=Math.sin(r),l=Math.cos(r),p=1-l,x=t[0],w=t[1],E=t[2],P=t[3],B=t[4],D=t[5],W=t[6],X=t[7],q=t[8],$=t[9],et=t[10],F=t[11],ut=i*i*p+l,ot=o*i*p+s*h,J=s*i*p-o*h,G=i*o*p-s*h,mt=o*o*p+l,Mt=s*o*p+i*h,ct=i*s*p+o*h,gt=o*s*p-i*h,ee=s*s*p+l,e[0]=x*ut+B*ot+q*J,e[1]=w*ut+D*ot+$*J,e[2]=E*ut+W*ot+et*J,e[3]=P*ut+X*ot+F*J,e[4]=x*G+B*mt+q*Mt,e[5]=w*G+D*mt+$*Mt,e[6]=E*G+W*mt+et*Mt,e[7]=P*G+X*mt+F*Mt,e[8]=x*ct+B*gt+q*ee,e[9]=w*ct+D*gt+$*ee,e[10]=E*ct+W*gt+et*ee,e[11]=P*ct+X*gt+F*ee,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function $Q(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[4],s=t[5],c=t[6],l=t[7],h=t[8],p=t[9],x=t[10],w=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+h*n,e[5]=s*i+p*n,e[6]=c*i+x*n,e[7]=l*i+w*n,e[8]=h*i-o*n,e[9]=p*i-s*n,e[10]=x*i-c*n,e[11]=w*i-l*n,e}function QQ(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[0],s=t[1],c=t[2],l=t[3],h=t[8],p=t[9],x=t[10],w=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-h*n,e[1]=s*i-p*n,e[2]=c*i-x*n,e[3]=l*i-w*n,e[8]=o*n+h*i,e[9]=s*n+p*i,e[10]=c*n+x*i,e[11]=l*n+w*i,e}function JQ(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[0],s=t[1],c=t[2],l=t[3],h=t[4],p=t[5],x=t[6],w=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+h*n,e[1]=s*i+p*n,e[2]=c*i+x*n,e[3]=l*i+w*n,e[4]=h*i-o*n,e[5]=p*i-s*n,e[6]=x*i-c*n,e[7]=w*i-l*n,e}function tJ(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r+r,c=n+n,l=i+i,h=r*s,p=n*s,x=n*c,w=i*s,E=i*c,P=i*l,B=o*s,D=o*c,W=o*l;return e[0]=1-x-P,e[1]=p+W,e[2]=w-D,e[3]=0,e[4]=p-W,e[5]=1-h-P,e[6]=E+B,e[7]=0,e[8]=w+D,e[9]=E-B,e[10]=1-h-x,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function eJ(e,t,r,n,i,o,s){let c=1/(r-t),l=1/(i-n),h=1/(o-s);return e[0]=o*2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o*2*l,e[6]=0,e[7]=0,e[8]=(r+t)*c,e[9]=(i+n)*l,e[10]=(s+o)*h,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*o*2*h,e[15]=0,e}function ACt(e,t,r,n,i){let o=1/Math.tan(t/2);if(e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0){let s=1/(n-i);e[10]=(i+n)*s,e[14]=2*i*n*s}else e[10]=-1,e[14]=-2*n;return e}var rJ=ACt;function gCt(e,t,r,n,i,o,s){let c=1/(t-r),l=1/(n-i),h=1/(o-s);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*h,e[11]=0,e[12]=(t+r)*c,e[13]=(i+n)*l,e[14]=(s+o)*h,e[15]=1,e}var nJ=gCt;function iJ(e,t,r,n){let i,o,s,c,l,h,p,x,w,E,P=t[0],B=t[1],D=t[2],W=n[0],X=n[1],q=n[2],$=r[0],et=r[1],F=r[2];return Math.abs(P-$)<1e-6&&Math.abs(B-et)<1e-6&&Math.abs(D-F)<1e-6?mCt(e):(x=P-$,w=B-et,E=D-F,i=1/Math.sqrt(x*x+w*w+E*E),x*=i,w*=i,E*=i,o=X*E-q*w,s=q*x-W*E,c=W*w-X*x,i=Math.sqrt(o*o+s*s+c*c),i?(i=1/i,o*=i,s*=i,c*=i):(o=0,s=0,c=0),l=w*c-E*s,h=E*o-x*c,p=x*s-w*o,i=Math.sqrt(l*l+h*h+p*p),i?(i=1/i,l*=i,h*=i,p*=i):(l=0,h=0,p=0),e[0]=o,e[1]=l,e[2]=x,e[3]=0,e[4]=s,e[5]=h,e[6]=w,e[7]=0,e[8]=c,e[9]=p,e[10]=E,e[11]=0,e[12]=-(o*P+s*B+c*D),e[13]=-(l*P+h*B+p*D),e[14]=-(x*P+w*B+E*D),e[15]=1,e)}function _Ct(){let e=new Wc(4);return Wc!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function oJ(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function sJ(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function aJ(e){let t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function cJ(e){let t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function lJ(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r*r+n*n+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),e[0]=r*s,e[1]=n*s,e[2]=i*s,e[3]=o*s,e}function uJ(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function hJ(e,t,r,n){let i=t[0],o=t[1],s=t[2],c=t[3];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=s+n*(r[2]-s),e[3]=c+n*(r[3]-c),e}function fJ(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*s,e[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*s,e[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*s,e[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*s,e}function pJ(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[0],c=r[1],l=r[2],h=r[3],p=h*n+c*o-l*i,x=h*i+l*n-s*o,w=h*o+s*i-c*n,E=-s*n-c*i-l*o;return e[0]=p*h+E*-s+x*-l-w*-c,e[1]=x*h+E*-c+w*-s-p*-l,e[2]=w*h+E*-l+p*-c-x*-s,e[3]=t[3],e}var xbe=function(){let e=_Ct();return function(t,r,n,i,o,s){let c,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],e[3]=t[c+3],o(e,e,s),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2],t[c+3]=e[3];return t}}();var Ik;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"})(Ik||(Ik={}));var xCt=45*Math.PI/180,vCt=1,Ck=.1,Pk=500,bCt=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Ho=class extends $y{static get IDENTITY(){return TCt()}static get ZERO(){return wCt()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Ik}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,r,n,i,o,s,c,l,h,p,x,w,E,P,B,D){return this[0]=t,this[1]=r,this[2]=n,this[3]=i,this[4]=o,this[5]=s,this[6]=c,this[7]=l,this[8]=h,this[9]=p,this[10]=x,this[11]=w,this[12]=E,this[13]=P,this[14]=B,this[15]=D,this.check()}setRowMajor(t,r,n,i,o,s,c,l,h,p,x,w,E,P,B,D){return this[0]=t,this[1]=o,this[2]=h,this[3]=E,this[4]=r,this[5]=s,this[6]=p,this[7]=P,this[8]=n,this[9]=c,this[10]=x,this[11]=B,this[12]=i,this[13]=l,this[14]=w,this[15]=D,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(bCt)}fromObject(t){return this.check()}fromQuaternion(t){return tJ(this,t),this.check()}frustum(t){let{left:r,right:n,bottom:i,top:o,near:s=Ck,far:c=Pk}=t;return c===1/0?ECt(this,r,n,i,o,s):eJ(this,r,n,i,o,s,c),this.check()}lookAt(t){let{eye:r,center:n=[0,0,0],up:i=[0,1,0]}=t;return iJ(this,r,n,i),this.check()}ortho(t){let{left:r,right:n,bottom:i,top:o,near:s=Ck,far:c=Pk}=t;return nJ(this,r,n,i,o,s,c),this.check()}orthographic(t){let{fovy:r=xCt,aspect:n=vCt,focalDistance:i=1,near:o=Ck,far:s=Pk}=t;dJ(r);let c=r/2,l=i*Math.tan(c),h=l*n;return this.ortho({left:-h,right:h,bottom:-l,top:l,near:o,far:s})}perspective(t){let{fovy:r=45*Math.PI/180,aspect:n=1,near:i=.1,far:o=500}=t;return dJ(r),rJ(this,r,n,i,o),this.check()}determinant(){return XQ(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];let n=this.getScale(r),i=1/n[0],o=1/n[1],s=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*o,t[2]=this[2]*s,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*o,t[6]=this[6]*s,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*o,t[10]=this[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];let n=this.getScale(r),i=1/n[0],o=1/n[1],s=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*o,t[2]=this[2]*s,t[3]=this[4]*i,t[4]=this[5]*o,t[5]=this[6]*s,t[6]=this[8]*i,t[7]=this[9]*o,t[8]=this[10]*s,t}transpose(){return qQ(this,this),this.check()}invert(){return GQ(this,this),this.check()}multiplyLeft(t){return Sk(this,t,this),this.check()}multiplyRight(t){return Sk(this,this,t),this.check()}rotateX(t){return $Q(this,this,t),this.check()}rotateY(t){return QQ(this,this,t),this.check()}rotateZ(t){return JQ(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,r){return ZQ(this,this,t,r),this.check()}scale(t){return KQ(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return YQ(this,this,t),this.check()}transform(t,r){return t.length===4?(r=fJ(r||[-0,-0,-0,-0],t,this),zm(r,4),r):this.transformAsPoint(t,r)}transformAsPoint(t,r){let{length:n}=t,i;switch(n){case 2:i=CQ(r||[-0,-0],t,this);break;case 3:i=Ky(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return zm(i,t.length),i}transformAsVector(t,r){let n;switch(t.length){case 2:n=PQ(r||[-0,-0],t,this);break;case 3:n=LC(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return zm(n,t.length),n}transformPoint(t,r){return this.transformAsPoint(t,r)}transformVector(t,r){return this.transformAsPoint(t,r)}transformDirection(t,r){return this.transformAsVector(t,r)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,r,n){return this.identity().translate([t,r,n])}},UC,VC;function wCt(){return UC||(UC=new Ho([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(UC)),UC}function TCt(){return VC||(VC=new Ho,Object.freeze(VC)),VC}function dJ(e){if(e>Math.PI*2)throw Error("expected radians")}function ECt(e,t,r,n,i,o){let s=2*o/(r-t),c=2*o/(i-n),l=(r+t)/(r-t),h=(i+n)/(i-n),p=-1,x=-1,w=-2*o;return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=l,e[9]=h,e[10]=p,e[11]=x,e[12]=0,e[13]=0,e[14]=w,e[15]=0,e}function mJ(){let e=new Wc(4);return Wc!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function AJ(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Rk(e,t,r){r=r*.5;let n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function Lk(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=r[0],l=r[1],h=r[2],p=r[3];return e[0]=n*p+s*c+i*h-o*l,e[1]=i*p+s*l+o*c-n*h,e[2]=o*p+s*h+n*l-i*c,e[3]=s*p-n*c-i*l-o*h,e}function gJ(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],s=t[3],c=Math.sin(r),l=Math.cos(r);return e[0]=n*l+s*c,e[1]=i*l+o*c,e[2]=o*l-i*c,e[3]=s*l-n*c,e}function _J(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],s=t[3],c=Math.sin(r),l=Math.cos(r);return e[0]=n*l-o*c,e[1]=i*l+s*c,e[2]=o*l+n*c,e[3]=s*l-i*c,e}function yJ(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],s=t[3],c=Math.sin(r),l=Math.cos(r);return e[0]=n*l+i*c,e[1]=i*l-n*c,e[2]=o*l+s*c,e[3]=s*l-o*c,e}function xJ(e,t){let r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e}function hw(e,t,r,n){let i=t[0],o=t[1],s=t[2],c=t[3],l=r[0],h=r[1],p=r[2],x=r[3],w,E,P,B,D;return w=i*l+o*h+s*p+c*x,w<0&&(w=-w,l=-l,h=-h,p=-p,x=-x),1-w>1e-6?(E=Math.acos(w),D=Math.sin(E),P=Math.sin((1-n)*E)/D,B=Math.sin(n*E)/D):(P=1-n,B=n),e[0]=P*i+B*l,e[1]=P*o+B*h,e[2]=P*s+B*p,e[3]=P*c+B*x,e}function vJ(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r*r+n*n+i*i+o*o,c=s?1/s:0;return e[0]=-r*c,e[1]=-n*c,e[2]=-i*c,e[3]=o*c,e}function bJ(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function Ok(e,t){let r=t[0]+t[4]+t[8],n;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{let i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);let o=(i+1)%3,s=(i+2)%3;n=Math.sqrt(t[i*3+i]-t[o*3+o]-t[s*3+s]+1),e[i]=.5*n,n=.5/n,e[3]=(t[o*3+s]-t[s*3+o])*n,e[o]=(t[o*3+i]+t[i*3+o])*n,e[s]=(t[s*3+i]+t[i*3+s])*n}return e}var wJ=oJ;var TJ=sJ,EJ=uJ,MJ=hJ,SJ=aJ;var CJ=cJ;var PJ=lJ;var IJ=function(){let e=xk(),t=vk(1,0,0),r=vk(0,1,0);return function(n,i,o){let s=bk(i,o);return s<-.999999?(Yy(e,t,i),kQ(e)<1e-6&&Yy(e,r,i),LQ(e,e),Rk(n,e,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Yy(e,i,o),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+s,PJ(n,n))}}(),Bbe=function(){let e=mJ(),t=mJ();return function(r,n,i,o,s,c){return hw(e,n,s,c),hw(t,i,o,c),hw(r,e,t,2*c*(1-c)),r}}(),Dbe=function(){let e=FQ();return function(t,r,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],PJ(t,Ok(t,e))}}();var MCt=[0,0,0,1],fw=class extends Fm{constructor(t=0,r=0,n=0,i=1){super(-0,-0,-0,-0),Array.isArray(t)&&arguments.length===1?this.copy(t):this.set(t,r,n,i)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,r,n,i){return this[0]=t,this[1]=r,this[2]=n,this[3]=i,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return Ok(this,t),this.check()}fromAxisRotation(t,r){return Rk(this,t,r),this.check()}identity(){return AJ(this),this.check()}setAxisAngle(t,r){return this.fromAxisRotation(t,r)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=io(t)}get y(){return this[1]}set y(t){this[1]=io(t)}get z(){return this[2]}set z(t){this[2]=io(t)}get w(){return this[3]}set w(t){this[3]=io(t)}len(){return SJ(this)}lengthSquared(){return CJ(this)}dot(t){return EJ(this,t)}rotationTo(t,r){return IJ(this,t,r),this.check()}add(t){return wJ(this,this,t),this.check()}calculateW(){return xJ(this,this),this.check()}conjugate(){return bJ(this,this),this.check()}invert(){return vJ(this,this),this.check()}lerp(t,r,n){return n===void 0?this.lerp(this,t,r):(MJ(this,t,r,n),this.check())}multiplyRight(t){return Lk(this,this,t),this.check()}multiplyLeft(t){return Lk(this,t,this),this.check()}normalize(){let t=this.len(),r=t>0?1/t:0;return this[0]=this[0]*r,this[1]=this[1]*r,this[2]=this[2]*r,this[3]=this[3]*r,t===0&&(this[3]=1),this.check()}rotateX(t){return gJ(this,this,t),this.check()}rotateY(t){return _J(this,this,t),this.check()}rotateZ(t){return yJ(this,this,t),this.check()}scale(t){return TJ(this,this,t),this.check()}slerp(t,r,n){let i,o,s;switch(arguments.length){case 1:({start:i=MCt,target:o,ratio:s}=t);break;case 2:i=this,o=t,s=r;break;default:i=t,o=r,s=n}return hw(this,i,o,s),this.check()}transformVector4(t,r=new Zy){return pJ(r,t,this),zm(r,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,r){return this.setAxisAngle(t,r)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}};var CCt=1/Math.PI*180,PCt=1/180*Math.PI,ICt={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...ICt}};var aa=globalThis.mathgl.config;function Bk(e,{precision:t=aa.precision}={}){return e=RCt(e),`${parseFloat(e.toPrecision(t))}`}function Um(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Dk(e){return RJ(e)}function Nk(e){return LJ(e)}function RJ(e,t){return OJ(e,r=>r*PCt,t)}function LJ(e,t){return OJ(e,r=>r*CCt,t)}function ld(e,t,r){let n=aa.EPSILON;r&&(aa.EPSILON=r);try{if(e===t)return!0;if(Um(e)&&Um(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!ld(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<=aa.EPSILON*Math.max(1,Math.abs(e),Math.abs(t)):!1}finally{aa.EPSILON=n}}function RCt(e){return Math.round(e/aa.EPSILON)*aa.EPSILON}function LCt(e){return e.clone?e.clone():new Array(e.length)}function OJ(e,t,r){if(Um(e)){let n=e;r=r||LCt(n);for(let i=0;i<r.length&&i<n.length;++i){let o=typeof e=="number"?e:e[i];r[i]=t(o,i,r)}return r}return t(e)}var Qy=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(t,r=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+r];return this.check()}toArray(t=[],r=0){for(let n=0;n<this.ELEMENTS;++n)t[r+n]=this[n];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:Um(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(aa)}formatString(t){let r="";for(let n=0;n<this.ELEMENTS;++n)r+=(n>0?", ":"")+Bk(this[n],t);return`${t.printTypes?this.constructor.name:""}[${r}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(!ld(this[r],t[r]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==t[r])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,r,n){if(n===void 0)return this.lerp(this,t,r);for(let i=0;i<this.ELEMENTS;++i){let o=t[i],s=typeof r=="number"?r:r[i];this[i]=o+n*(s-o)}return this.check()}min(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(t[r],this[r]);return this.check()}max(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(t[r],this[r]);return this.check()}clamp(t,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),r[n]);return this.check()}add(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]+=r[n];return this.check()}subtract(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]-=r[n];return this.check()}scale(t){if(typeof t=="number")for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;else for(let r=0;r<this.ELEMENTS&&r<t.length;++r)this[r]*=t[r];return this.check()}multiplyByScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}check(){if(aa.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)t=t&&Number.isFinite(this[r]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=t;return this.check()}addScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),r);return this.check()}get elements(){return this}};function OCt(e,t){if(e.length!==t)return!1;for(let r=0;r<e.length;++r)if(!Number.isFinite(e[r]))return!1;return!0}function qc(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function jC(e,t,r=""){if(aa.debug&&!OCt(e,t))throw new Error(`math.gl: ${r} some fields set to invalid numbers'`);return e}function th(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}var HC=class extends Qy{get x(){return this[0]}set x(t){this[0]=qc(t)}get y(){return this[1]}set y(t){this[1]=qc(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let r=0;r<this.ELEMENTS;++r)t+=this[r]*this[r];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let r=0;for(let n=0;n<this.ELEMENTS;++n){let i=this[n]-t[n];r+=i*i}return qc(r)}dot(t){let r=0;for(let n=0;n<this.ELEMENTS;++n)r+=this[n]*t[n];return qc(r)}normalize(){let t=this.magnitude();if(t!==0)for(let r=0;r<this.ELEMENTS;++r)this[r]/=t;return this.check()}multiply(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]*=r[n];return this.check()}divide(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]/=r[n];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return th(t>=0&&t<this.ELEMENTS,"index is out of range"),qc(this[t])}setComponent(t,r){return th(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=r,this.check()}addVectors(t,r){return this.copy(t).add(r)}subVectors(t,r){return this.copy(t).subtract(r)}multiplyVectors(t,r){return this.copy(t).multiply(r)}addScaledVector(t,r){return this.add(new this.constructor(t).multiplyScalar(r))}};var Hh=typeof Float32Array<"u"?Float32Array:Array,pw=Math.random;function Jy(e){return e>=0?Math.round(e):e%.5===0?Math.floor(e):Math.round(e)}var ywe=Math.PI/180;function BCt(){let e=new Hh(2);return Hh!=Float32Array&&(e[0]=0,e[1]=0),e}function BJ(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e}var xwe=function(){let e=BCt();return function(t,r,n,i,o,s){let c,l;for(r||(r=2),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],o(e,e,s),t[c]=e[0],t[c+1]=e[1];return t}}();function DJ(e,t,r){let n=t[0],i=t[1],o=r[3]*n+r[7]*i||1;return e[0]=(r[0]*n+r[4]*i)/o,e[1]=(r[1]*n+r[5]*i)/o,e}function WC(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[3]*n+r[7]*i+r[11]*o||1;return e[0]=(r[0]*n+r[4]*i+r[8]*o)/s,e[1]=(r[1]*n+r[5]*i+r[9]*o)/s,e[2]=(r[2]*n+r[6]*i+r[10]*o)/s,e}function NJ(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e[2]=t[2],e}var t1={};Lo(t1,{add:()=>zCt,angle:()=>qk,bezier:()=>JCt,ceil:()=>UCt,clone:()=>DCt,copy:()=>kCt,create:()=>kJ,cross:()=>zk,dist:()=>cPt,distance:()=>jJ,div:()=>aPt,divide:()=>VJ,dot:()=>Fk,equals:()=>iPt,exactEquals:()=>nPt,floor:()=>VCt,forEach:()=>fPt,fromValues:()=>NCt,hermite:()=>QCt,inverse:()=>YCt,len:()=>uPt,length:()=>FJ,lerp:()=>ZCt,max:()=>HCt,min:()=>jCt,mul:()=>sPt,multiply:()=>UJ,negate:()=>XCt,normalize:()=>KCt,random:()=>tPt,rotateX:()=>jk,rotateY:()=>Hk,rotateZ:()=>Wk,round:()=>WCt,scale:()=>qCt,scaleAndAdd:()=>GCt,set:()=>FCt,slerp:()=>$Ct,sqrDist:()=>lPt,sqrLen:()=>hPt,squaredDistance:()=>HJ,squaredLength:()=>WJ,str:()=>rPt,sub:()=>oPt,subtract:()=>zJ,transformMat3:()=>Uk,transformMat4:()=>dw,transformQuat:()=>Vk,zero:()=>ePt});function kJ(){let e=new Hh(3);return Hh!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function DCt(e){let t=new Hh(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function FJ(e){let t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function NCt(e,t,r){let n=new Hh(3);return n[0]=e,n[1]=t,n[2]=r,n}function kCt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function FCt(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function zCt(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function zJ(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function UJ(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function VJ(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function UCt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function VCt(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function jCt(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function HCt(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function WCt(e,t){return e[0]=Jy(t[0]),e[1]=Jy(t[1]),e[2]=Jy(t[2]),e}function qCt(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function GCt(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function jJ(e,t){let r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)}function HJ(e,t){let r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function WJ(e){let t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function XCt(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function YCt(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function KCt(e,t){let r=t[0],n=t[1],i=t[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function Fk(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function zk(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[0],c=r[1],l=r[2];return e[0]=i*l-o*c,e[1]=o*s-n*l,e[2]=n*c-i*s,e}function ZCt(e,t,r,n){let i=t[0],o=t[1],s=t[2];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=s+n*(r[2]-s),e}function $Ct(e,t,r,n){let i=Math.acos(Math.min(Math.max(Fk(t,r),-1),1)),o=Math.sin(i),s=Math.sin((1-n)*i)/o,c=Math.sin(n*i)/o;return e[0]=s*t[0]+c*r[0],e[1]=s*t[1]+c*r[1],e[2]=s*t[2]+c*r[2],e}function QCt(e,t,r,n,i,o){let s=o*o,c=s*(2*o-3)+1,l=s*(o-2)+o,h=s*(o-1),p=s*(3-2*o);return e[0]=t[0]*c+r[0]*l+n[0]*h+i[0]*p,e[1]=t[1]*c+r[1]*l+n[1]*h+i[1]*p,e[2]=t[2]*c+r[2]*l+n[2]*h+i[2]*p,e}function JCt(e,t,r,n,i,o){let s=1-o,c=s*s,l=o*o,h=c*s,p=3*o*c,x=3*l*s,w=l*o;return e[0]=t[0]*h+r[0]*p+n[0]*x+i[0]*w,e[1]=t[1]*h+r[1]*p+n[1]*x+i[1]*w,e[2]=t[2]*h+r[2]*p+n[2]*x+i[2]*w,e}function tPt(e,t){t=t===void 0?1:t;let r=pw()*2*Math.PI,n=pw()*2-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e}function dw(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[3]*n+r[7]*i+r[11]*o+r[15];return s=s||1,e[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/s,e[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/s,e[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/s,e}function Uk(e,t,r){let n=t[0],i=t[1],o=t[2];return e[0]=n*r[0]+i*r[3]+o*r[6],e[1]=n*r[1]+i*r[4]+o*r[7],e[2]=n*r[2]+i*r[5]+o*r[8],e}function Vk(e,t,r){let n=r[0],i=r[1],o=r[2],s=r[3],c=t[0],l=t[1],h=t[2],p=i*h-o*l,x=o*c-n*h,w=n*l-i*c,E=i*w-o*x,P=o*p-n*w,B=n*x-i*p,D=s*2;return p*=D,x*=D,w*=D,E*=2,P*=2,B*=2,e[0]=c+p+E,e[1]=l+x+P,e[2]=h+w+B,e}function jk(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function Hk(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function Wk(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function qk(e,t){let r=e[0],n=e[1],i=e[2],o=t[0],s=t[1],c=t[2],l=Math.sqrt((r*r+n*n+i*i)*(o*o+s*s+c*c)),h=l&&Fk(e,t)/l;return Math.acos(Math.min(Math.max(h,-1),1))}function ePt(e){return e[0]=0,e[1]=0,e[2]=0,e}function rPt(e){return`vec3(${e[0]}, ${e[1]}, ${e[2]})`}function nPt(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function iPt(e,t){let r=e[0],n=e[1],i=e[2],o=t[0],s=t[1],c=t[2];return Math.abs(r-o)<=1e-6*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=1e-6*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-c)<=1e-6*Math.max(1,Math.abs(i),Math.abs(c))}var oPt=zJ,sPt=UJ,aPt=VJ,cPt=jJ,lPt=HJ,uPt=FJ,hPt=WJ,fPt=function(){let e=kJ();return function(t,r,n,i,o,s){let c,l;for(r||(r=3),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],o(e,e,s),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2];return t}}();var Gk=[0,0,0],qC,Gi=class extends HC{static get ZERO(){return qC||(qC=new Gi(0,0,0),Object.freeze(qC)),qC}constructor(t=0,r=0,n=0){super(-0,-0,-0),arguments.length===1&&Um(t)?this.copy(t):(aa.debug&&(qc(t),qc(r),qc(n)),this[0]=t,this[1]=r,this[2]=n)}set(t,r,n){return this[0]=t,this[1]=r,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return aa.debug&&(qc(t.x),qc(t.y),qc(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=qc(t)}angle(t){return qk(this,t)}cross(t){return zk(this,this,t),this.check()}rotateX({radians:t,origin:r=Gk}){return jk(this,this,r,t),this.check()}rotateY({radians:t,origin:r=Gk}){return Hk(this,this,r,t),this.check()}rotateZ({radians:t,origin:r=Gk}){return Wk(this,this,r,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return dw(this,this,t),this.check()}transformAsVector(t){return WC(this,this,t),this.check()}transformByMatrix3(t){return Uk(this,this,t),this.check()}transformByMatrix2(t){return NJ(this,this,t),this.check()}transformByQuaternion(t){return Vk(this,this,t),this.check()}};var GC=class extends Qy{toString(){let t="[";if(aa.printRowMajor){t+="row-major:";for(let r=0;r<this.RANK;++r)for(let n=0;n<this.RANK;++n)t+=` ${this[n*this.RANK+r]}`}else{t+="column-major:";for(let r=0;r<this.ELEMENTS;++r)t+=` ${this[r]}`}return t+="]",t}getElementIndex(t,r){return r*this.RANK+t}getElement(t,r){return this[r*this.RANK+t]}setElement(t,r,n){return this[r*this.RANK+t]=qc(n),this}getColumn(t,r=new Array(this.RANK).fill(-0)){let n=t*this.RANK;for(let i=0;i<this.RANK;++i)r[i]=this[n+i];return r}setColumn(t,r){let n=t*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=r[i];return this}};function pPt(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function qJ(e,t){if(e===t){let r=t[1],n=t[2],i=t[3],o=t[6],s=t[7],c=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=i,e[13]=s,e[14]=c}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function GJ(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],c=t[5],l=t[6],h=t[7],p=t[8],x=t[9],w=t[10],E=t[11],P=t[12],B=t[13],D=t[14],W=t[15],X=r*c-n*s,q=r*l-i*s,$=r*h-o*s,et=n*l-i*c,F=n*h-o*c,ut=i*h-o*l,ot=p*B-x*P,J=p*D-w*P,G=p*W-E*P,mt=x*D-w*B,Mt=x*W-E*B,ct=w*W-E*D,gt=X*ct-q*Mt+$*mt+et*G-F*J+ut*ot;return gt?(gt=1/gt,e[0]=(c*ct-l*Mt+h*mt)*gt,e[1]=(i*Mt-n*ct-o*mt)*gt,e[2]=(B*ut-D*F+W*et)*gt,e[3]=(w*F-x*ut-E*et)*gt,e[4]=(l*G-s*ct-h*J)*gt,e[5]=(r*ct-i*G+o*J)*gt,e[6]=(D*$-P*ut-W*q)*gt,e[7]=(p*ut-w*$+E*q)*gt,e[8]=(s*Mt-c*G+h*ot)*gt,e[9]=(n*G-r*Mt-o*ot)*gt,e[10]=(P*F-B*$+W*X)*gt,e[11]=(x*$-p*F-E*X)*gt,e[12]=(c*J-s*mt-l*ot)*gt,e[13]=(r*mt-n*J+i*ot)*gt,e[14]=(B*q-P*et-D*X)*gt,e[15]=(p*et-x*q+w*X)*gt,e):null}function XJ(e){let t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],c=e[6],l=e[7],h=e[8],p=e[9],x=e[10],w=e[11],E=e[12],P=e[13],B=e[14],D=e[15],W=t*s-r*o,X=t*c-n*o,q=r*c-n*s,$=h*P-p*E,et=h*B-x*E,F=p*B-x*P,ut=t*F-r*et+n*$,ot=o*F-s*et+c*$,J=h*q-p*X+x*W,G=E*q-P*X+B*W;return l*ut-i*ot+D*J-w*G}function Xk(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=t[9],E=t[10],P=t[11],B=t[12],D=t[13],W=t[14],X=t[15],q=r[0],$=r[1],et=r[2],F=r[3];return e[0]=q*n+$*c+et*x+F*B,e[1]=q*i+$*l+et*w+F*D,e[2]=q*o+$*h+et*E+F*W,e[3]=q*s+$*p+et*P+F*X,q=r[4],$=r[5],et=r[6],F=r[7],e[4]=q*n+$*c+et*x+F*B,e[5]=q*i+$*l+et*w+F*D,e[6]=q*o+$*h+et*E+F*W,e[7]=q*s+$*p+et*P+F*X,q=r[8],$=r[9],et=r[10],F=r[11],e[8]=q*n+$*c+et*x+F*B,e[9]=q*i+$*l+et*w+F*D,e[10]=q*o+$*h+et*E+F*W,e[11]=q*s+$*p+et*P+F*X,q=r[12],$=r[13],et=r[14],F=r[15],e[12]=q*n+$*c+et*x+F*B,e[13]=q*i+$*l+et*w+F*D,e[14]=q*o+$*h+et*E+F*W,e[15]=q*s+$*p+et*P+F*X,e}function YJ(e,t,r){let n=r[0],i=r[1],o=r[2],s,c,l,h,p,x,w,E,P,B,D,W;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*o+t[12],e[13]=t[1]*n+t[5]*i+t[9]*o+t[13],e[14]=t[2]*n+t[6]*i+t[10]*o+t[14],e[15]=t[3]*n+t[7]*i+t[11]*o+t[15]):(s=t[0],c=t[1],l=t[2],h=t[3],p=t[4],x=t[5],w=t[6],E=t[7],P=t[8],B=t[9],D=t[10],W=t[11],e[0]=s,e[1]=c,e[2]=l,e[3]=h,e[4]=p,e[5]=x,e[6]=w,e[7]=E,e[8]=P,e[9]=B,e[10]=D,e[11]=W,e[12]=s*n+p*i+P*o+t[12],e[13]=c*n+x*i+B*o+t[13],e[14]=l*n+w*i+D*o+t[14],e[15]=h*n+E*i+W*o+t[15]),e}function KJ(e,t,r){let n=r[0],i=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function ZJ(e,t,r,n){let i=n[0],o=n[1],s=n[2],c=Math.sqrt(i*i+o*o+s*s),l,h,p,x,w,E,P,B,D,W,X,q,$,et,F,ut,ot,J,G,mt,Mt,ct,gt,ee;return c<1e-6?null:(c=1/c,i*=c,o*=c,s*=c,h=Math.sin(r),l=Math.cos(r),p=1-l,x=t[0],w=t[1],E=t[2],P=t[3],B=t[4],D=t[5],W=t[6],X=t[7],q=t[8],$=t[9],et=t[10],F=t[11],ut=i*i*p+l,ot=o*i*p+s*h,J=s*i*p-o*h,G=i*o*p-s*h,mt=o*o*p+l,Mt=s*o*p+i*h,ct=i*s*p+o*h,gt=o*s*p-i*h,ee=s*s*p+l,e[0]=x*ut+B*ot+q*J,e[1]=w*ut+D*ot+$*J,e[2]=E*ut+W*ot+et*J,e[3]=P*ut+X*ot+F*J,e[4]=x*G+B*mt+q*Mt,e[5]=w*G+D*mt+$*Mt,e[6]=E*G+W*mt+et*Mt,e[7]=P*G+X*mt+F*Mt,e[8]=x*ct+B*gt+q*ee,e[9]=w*ct+D*gt+$*ee,e[10]=E*ct+W*gt+et*ee,e[11]=P*ct+X*gt+F*ee,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function $J(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[4],s=t[5],c=t[6],l=t[7],h=t[8],p=t[9],x=t[10],w=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+h*n,e[5]=s*i+p*n,e[6]=c*i+x*n,e[7]=l*i+w*n,e[8]=h*i-o*n,e[9]=p*i-s*n,e[10]=x*i-c*n,e[11]=w*i-l*n,e}function QJ(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[0],s=t[1],c=t[2],l=t[3],h=t[8],p=t[9],x=t[10],w=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-h*n,e[1]=s*i-p*n,e[2]=c*i-x*n,e[3]=l*i-w*n,e[8]=o*n+h*i,e[9]=s*n+p*i,e[10]=c*n+x*i,e[11]=l*n+w*i,e}function JJ(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[0],s=t[1],c=t[2],l=t[3],h=t[4],p=t[5],x=t[6],w=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+h*n,e[1]=s*i+p*n,e[2]=c*i+x*n,e[3]=l*i+w*n,e[4]=h*i-o*n,e[5]=p*i-s*n,e[6]=x*i-c*n,e[7]=w*i-l*n,e}function ttt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r+r,c=n+n,l=i+i,h=r*s,p=n*s,x=n*c,w=i*s,E=i*c,P=i*l,B=o*s,D=o*c,W=o*l;return e[0]=1-x-P,e[1]=p+W,e[2]=w-D,e[3]=0,e[4]=p-W,e[5]=1-h-P,e[6]=E+B,e[7]=0,e[8]=w+D,e[9]=E-B,e[10]=1-h-x,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ett(e,t,r,n,i,o,s){let c=1/(r-t),l=1/(i-n),h=1/(o-s);return e[0]=o*2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o*2*l,e[6]=0,e[7]=0,e[8]=(r+t)*c,e[9]=(i+n)*l,e[10]=(s+o)*h,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*o*2*h,e[15]=0,e}function dPt(e,t,r,n,i){let o=1/Math.tan(t/2);if(e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0){let s=1/(n-i);e[10]=(i+n)*s,e[14]=2*i*n*s}else e[10]=-1,e[14]=-2*n;return e}var rtt=dPt;function mPt(e,t,r,n,i,o,s){let c=1/(t-r),l=1/(n-i),h=1/(o-s);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*h,e[11]=0,e[12]=(t+r)*c,e[13]=(i+n)*l,e[14]=(s+o)*h,e[15]=1,e}var ntt=mPt;function itt(e,t,r,n){let i,o,s,c,l,h,p,x,w,E,P=t[0],B=t[1],D=t[2],W=n[0],X=n[1],q=n[2],$=r[0],et=r[1],F=r[2];return Math.abs(P-$)<1e-6&&Math.abs(B-et)<1e-6&&Math.abs(D-F)<1e-6?pPt(e):(x=P-$,w=B-et,E=D-F,i=1/Math.sqrt(x*x+w*w+E*E),x*=i,w*=i,E*=i,o=X*E-q*w,s=q*x-W*E,c=W*w-X*x,i=Math.sqrt(o*o+s*s+c*c),i?(i=1/i,o*=i,s*=i,c*=i):(o=0,s=0,c=0),l=w*c-E*s,h=E*o-x*c,p=x*s-w*o,i=Math.sqrt(l*l+h*h+p*p),i?(i=1/i,l*=i,h*=i,p*=i):(l=0,h=0,p=0),e[0]=o,e[1]=l,e[2]=x,e[3]=0,e[4]=s,e[5]=h,e[6]=w,e[7]=0,e[8]=c,e[9]=p,e[10]=E,e[11]=0,e[12]=-(o*P+s*B+c*D),e[13]=-(l*P+h*B+p*D),e[14]=-(x*P+w*B+E*D),e[15]=1,e)}function APt(){let e=new Hh(4);return Hh!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function ott(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*s,e[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*s,e[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*s,e[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*s,e}var Bwe=function(){let e=APt();return function(t,r,n,i,o,s){let c,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],e[3]=t[c+3],o(e,e,s),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2],t[c+3]=e[3];return t}}();var Zk;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"})(Zk||(Zk={}));var gPt=45*Math.PI/180,_Pt=1,Yk=.1,Kk=500,yPt=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Vm=class extends GC{static get IDENTITY(){return vPt()}static get ZERO(){return xPt()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Zk}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,r,n,i,o,s,c,l,h,p,x,w,E,P,B,D){return this[0]=t,this[1]=r,this[2]=n,this[3]=i,this[4]=o,this[5]=s,this[6]=c,this[7]=l,this[8]=h,this[9]=p,this[10]=x,this[11]=w,this[12]=E,this[13]=P,this[14]=B,this[15]=D,this.check()}setRowMajor(t,r,n,i,o,s,c,l,h,p,x,w,E,P,B,D){return this[0]=t,this[1]=o,this[2]=h,this[3]=E,this[4]=r,this[5]=s,this[6]=p,this[7]=P,this[8]=n,this[9]=c,this[10]=x,this[11]=B,this[12]=i,this[13]=l,this[14]=w,this[15]=D,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(yPt)}fromObject(t){return this.check()}fromQuaternion(t){return ttt(this,t),this.check()}frustum(t){let{left:r,right:n,bottom:i,top:o,near:s=Yk,far:c=Kk}=t;return c===1/0?bPt(this,r,n,i,o,s):ett(this,r,n,i,o,s,c),this.check()}lookAt(t){let{eye:r,center:n=[0,0,0],up:i=[0,1,0]}=t;return itt(this,r,n,i),this.check()}ortho(t){let{left:r,right:n,bottom:i,top:o,near:s=Yk,far:c=Kk}=t;return ntt(this,r,n,i,o,s,c),this.check()}orthographic(t){let{fovy:r=gPt,aspect:n=_Pt,focalDistance:i=1,near:o=Yk,far:s=Kk}=t;stt(r);let c=r/2,l=i*Math.tan(c),h=l*n;return this.ortho({left:-h,right:h,bottom:-l,top:l,near:o,far:s})}perspective(t){let{fovy:r=45*Math.PI/180,aspect:n=1,near:i=.1,far:o=500}=t;return stt(r),rtt(this,r,n,i,o),this.check()}determinant(){return XJ(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];let n=this.getScale(r),i=1/n[0],o=1/n[1],s=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*o,t[2]=this[2]*s,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*o,t[6]=this[6]*s,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*o,t[10]=this[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];let n=this.getScale(r),i=1/n[0],o=1/n[1],s=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*o,t[2]=this[2]*s,t[3]=this[4]*i,t[4]=this[5]*o,t[5]=this[6]*s,t[6]=this[8]*i,t[7]=this[9]*o,t[8]=this[10]*s,t}transpose(){return qJ(this,this),this.check()}invert(){return GJ(this,this),this.check()}multiplyLeft(t){return Xk(this,t,this),this.check()}multiplyRight(t){return Xk(this,this,t),this.check()}rotateX(t){return $J(this,this,t),this.check()}rotateY(t){return QJ(this,this,t),this.check()}rotateZ(t){return JJ(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,r){return ZJ(this,this,t,r),this.check()}scale(t){return KJ(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return YJ(this,this,t),this.check()}transform(t,r){return t.length===4?(r=ott(r||[-0,-0,-0,-0],t,this),jC(r,4),r):this.transformAsPoint(t,r)}transformAsPoint(t,r){let{length:n}=t,i;switch(n){case 2:i=BJ(r||[-0,-0],t,this);break;case 3:i=dw(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return jC(i,t.length),i}transformAsVector(t,r){let n;switch(t.length){case 2:n=DJ(r||[-0,-0],t,this);break;case 3:n=WC(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return jC(n,t.length),n}transformPoint(t,r){return this.transformAsPoint(t,r)}transformVector(t,r){return this.transformAsPoint(t,r)}transformDirection(t,r){return this.transformAsVector(t,r)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,r,n){return this.identity().translate([t,r,n])}},XC,YC;function xPt(){return XC||(XC=new Vm([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(XC)),XC}function vPt(){return YC||(YC=new Vm,Object.freeze(YC)),YC}function stt(e){if(e>Math.PI*2)throw Error("expected radians")}function bPt(e,t,r,n,i,o){let s=2*o/(r-t),c=2*o/(i-n),l=(r+t)/(r-t),h=(i+n)/(i-n),p=-1,x=-1,w=-2*o;return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=l,e[9]=h,e[10]=p,e[11]=x,e[12]=0,e[13]=0,e[14]=w,e[15]=0,e}var jm={};Lo(jm,{EPSILON1:()=>wPt,EPSILON10:()=>LPt,EPSILON11:()=>OPt,EPSILON12:()=>BPt,EPSILON13:()=>DPt,EPSILON14:()=>NPt,EPSILON15:()=>kPt,EPSILON16:()=>FPt,EPSILON17:()=>zPt,EPSILON18:()=>UPt,EPSILON19:()=>VPt,EPSILON2:()=>TPt,EPSILON20:()=>jPt,EPSILON3:()=>EPt,EPSILON4:()=>MPt,EPSILON5:()=>SPt,EPSILON6:()=>CPt,EPSILON7:()=>PPt,EPSILON8:()=>IPt,EPSILON9:()=>RPt,PI_OVER_FOUR:()=>WPt,PI_OVER_SIX:()=>qPt,PI_OVER_TWO:()=>HPt,TWO_PI:()=>GPt});var wPt=.1,TPt=.01,EPt=.001,MPt=1e-4,SPt=1e-5,CPt=1e-6,PPt=1e-7,IPt=1e-8,RPt=1e-9,LPt=1e-10,OPt=1e-11,BPt=1e-12,DPt=1e-13,NPt=1e-14,kPt=1e-15,FPt=1e-16,zPt=1e-17,UPt=1e-18,VPt=1e-19,jPt=1e-20,HPt=Math.PI/2,WPt=Math.PI/4,qPt=Math.PI/6,GPt=Math.PI*2;var hd=6356752314245179e-9,XPt={radii:[6378137,6378137,hd],radiiSquared:[6378137*6378137,6378137*6378137,hd*hd],oneOverRadii:[1/6378137,1/6378137,1/hd],oneOverRadiiSquared:[1/(6378137*6378137),1/(6378137*6378137),1/(hd*hd)],maximumRadius:Math.max(6378137,6378137,hd),centerToleranceSquared:.1};function KC(e){return e}var uTe=new Gi;function YPt(e,t=[],r=KC){return"longitude"in e?(t[0]=r(e.longitude),t[1]=r(e.latitude),t[2]=e.height):"x"in e?(t[0]=r(e.x),t[1]=r(e.y),t[2]=e.z):(t[0]=r(e[0]),t[1]=r(e[1]),t[2]=e[2]),t}function att(e,t=[]){return YPt(e,t,aa._cartographicRadians?KC:Dk)}function KPt(e,t,r=KC){return"longitude"in t?(t.longitude=r(e[0]),t.latitude=r(e[1]),t.height=e[2]):"x"in t?(t.x=r(e[0]),t.y=r(e[1]),t.z=e[2]):(t[0]=r(e[0]),t[1]=r(e[1]),t[2]=e[2]),t}function ctt(e,t){return KPt(e,t,aa._cartographicRadians?KC:Nk)}var ltt=1e-14,ZPt=new Gi,utt={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},$k={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},mw={east:new Gi,north:new Gi,up:new Gi,west:new Gi,south:new Gi,down:new Gi},$Pt=new Gi,QPt=new Gi,JPt=new Gi;function Qk(e,t,r,n,i,o){let s=utt[t]&&utt[t][r];th(s&&(!n||n===s));let c,l,h,p=ZPt.copy(i);if(ld(p.x,0,ltt)&&ld(p.y,0,ltt)){let w=Math.sign(p.z);c=$Pt.fromArray($k[t]),t!=="east"&&t!=="west"&&c.scale(w),l=QPt.fromArray($k[r]),r!=="east"&&r!=="west"&&l.scale(w),h=JPt.fromArray($k[n]),n!=="east"&&n!=="west"&&h.scale(w)}else{let{up:w,east:E,north:P}=mw;E.set(-p.y,p.x,0).normalize(),e.geodeticSurfaceNormal(p,w),P.copy(w).cross(E);let{down:B,west:D,south:W}=mw;B.copy(w).scale(-1),D.copy(E).scale(-1),W.copy(P).scale(-1),c=mw[t],l=mw[r],h=mw[n]}return o[0]=c.x,o[1]=c.y,o[2]=c.z,o[3]=0,o[4]=l.x,o[5]=l.y,o[6]=l.z,o[7]=0,o[8]=h.x,o[9]=h.y,o[10]=h.z,o[11]=0,o[12]=p.x,o[13]=p.y,o[14]=p.z,o[15]=1,o}var e1=new Gi,tIt=new Gi,eIt=new Gi;function htt(e,t,r=[]){let{oneOverRadii:n,oneOverRadiiSquared:i,centerToleranceSquared:o}=t;e1.from(e);let s=e1.x,c=e1.y,l=e1.z,h=n.x,p=n.y,x=n.z,w=s*s*h*h,E=c*c*p*p,P=l*l*x*x,B=w+E+P,D=Math.sqrt(1/B);if(!Number.isFinite(D))return;let W=tIt;if(W.copy(e).scale(D),B<o)return W.to(r);let X=i.x,q=i.y,$=i.z,et=eIt;et.set(W.x*X*2,W.y*q*2,W.z*$*2);let F=(1-D)*e1.len()/(.5*et.len()),ut=0,ot,J,G,mt;do{F-=ut,ot=1/(1+F*X),J=1/(1+F*q),G=1/(1+F*$);let Mt=ot*ot,ct=J*J,gt=G*G,ee=Mt*ot,Ne=ct*J,Ue=gt*G;mt=w*Mt+E*ct+P*gt-1;let gr=-2*(w*ee*X+E*Ne*q+P*Ue*$);ut=mt/gr}while(Math.abs(mt)>jm.EPSILON12);return e1.scale([ot,J,G]).to(r)}var ZC=new Gi,ftt=new Gi,iIt=new Gi,Wh=new Gi,oIt=new Gi,$C=new Gi,Si=class{constructor(t=0,r=0,n=0){this.centerToleranceSquared=jm.EPSILON1,th(t>=0),th(r>=0),th(n>=0),this.radii=new Gi(t,r,n),this.radiiSquared=new Gi(t*t,r*r,n*n),this.radiiToTheFourth=new Gi(t*t*t*t,r*r*r*r,n*n*n*n),this.oneOverRadii=new Gi(t===0?0:1/t,r===0?0:1/r,n===0?0:1/n),this.oneOverRadiiSquared=new Gi(t===0?0:1/(t*t),r===0?0:1/(r*r),n===0?0:1/(n*n)),this.minimumRadius=Math.min(t,r,n),this.maximumRadius=Math.max(t,r,n),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(t){return this===t||Boolean(t&&this.radii.equals(t.radii))}toString(){return this.radii.toString()}cartographicToCartesian(t,r=[0,0,0]){let n=ftt,i=iIt,[,,o]=t;this.geodeticSurfaceNormalCartographic(t,n),i.copy(this.radiiSquared).scale(n);let s=Math.sqrt(n.dot(i));return i.scale(1/s),n.scale(o),i.add(n),i.to(r)}cartesianToCartographic(t,r=[0,0,0]){$C.from(t);let n=this.scaleToGeodeticSurface($C,Wh);if(!n)return;let i=this.geodeticSurfaceNormal(n,ftt),o=oIt;o.copy($C).subtract(n);let s=Math.atan2(i.y,i.x),c=Math.asin(i.z),l=Math.sign(t1.dot(o,$C))*t1.length(o);return ctt([s,c,l],r)}eastNorthUpToFixedFrame(t,r=new Vm){return Qk(this,"east","north","up",t,r)}localFrameToFixedFrame(t,r,n,i,o=new Vm){return Qk(this,t,r,n,i,o)}geocentricSurfaceNormal(t,r=[0,0,0]){return ZC.from(t).normalize().to(r)}geodeticSurfaceNormalCartographic(t,r=[0,0,0]){let n=att(t),i=n[0],o=n[1],s=Math.cos(o);return ZC.set(s*Math.cos(i),s*Math.sin(i),Math.sin(o)).normalize(),ZC.to(r)}geodeticSurfaceNormal(t,r=[0,0,0]){return ZC.from(t).scale(this.oneOverRadiiSquared).normalize().to(r)}scaleToGeodeticSurface(t,r){return htt(t,this,r)}scaleToGeocentricSurface(t,r=[0,0,0]){Wh.from(t);let n=Wh.x,i=Wh.y,o=Wh.z,s=this.oneOverRadiiSquared,c=1/Math.sqrt(n*n*s.x+i*i*s.y+o*o*s.z);return Wh.multiplyScalar(c).to(r)}transformPositionToScaledSpace(t,r=[0,0,0]){return Wh.from(t).scale(this.oneOverRadii).to(r)}transformPositionFromScaledSpace(t,r=[0,0,0]){return Wh.from(t).scale(this.radii).to(r)}getSurfaceNormalIntersectionWithZAxis(t,r=0,n=[0,0,0]){th(ld(this.radii.x,this.radii.y,jm.EPSILON15)),th(this.radii.z>0),Wh.from(t);let i=Wh.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(i)>=this.radii.z-r))return Wh.set(0,0,i).to(n)}};Si.WGS84=new Si(6378137,6378137,hd);var QC=class{item;previous;next;constructor(t,r,n){this.item=t,this.previous=r,this.next=n}};var JC=class{head=null;tail=null;_length=0;get length(){return this._length}add(t){let r=new QC(t,this.tail,null);return this.tail?(this.tail.next=r,this.tail=r):(this.head=r,this.tail=r),++this._length,r}remove(t){t&&(t.previous&&t.next?(t.previous.next=t.next,t.next.previous=t.previous):t.previous?(t.previous.next=null,this.tail=t.previous):t.next?(t.next.previous=null,this.head=t.next):(this.head=null,this.tail=null),t.next=null,t.previous=null,--this._length)}splice(t,r){t!==r&&(this.remove(r),this._insert(t,r))}_insert(t,r){let n=t.next;t.next=r,this.tail===t?this.tail=r:n.previous=r,r.next=n,r.previous=t,++this._length}};var tP=class{_list;_sentinel;_trimTiles;constructor(){this._list=new JC,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(t){let r=t._cacheNode;r&&this._list.splice(this._sentinel,r)}add(t,r,n){r._cacheNode||(r._cacheNode=this._list.add(r),n&&n(t,r))}unloadTile(t,r,n){let i=r._cacheNode;i&&(this._list.remove(i),r._cacheNode=null,n&&n(t,r))}unloadTiles(t,r){let n=this._trimTiles;this._trimTiles=!1;let i=this._list,o=t.maximumMemoryUsage*1024*1024,s=this._sentinel,c=i.head;for(;c!==s&&(t.gpuMemoryUsageInBytes>o||n);){let l=c.item;c=c.next,this.unloadTile(t,l,r)}}trim(){this._trimTiles=!0}};function ptt(e,t){Ti(e),Ti(t);let{rtcCenter:r,gltfUpAxis:n}=t,{computedTransform:i,boundingVolume:{center:o}}=e,s=new Ho(i);switch(r&&s.translate(r),n){case"Z":break;case"Y":let x=new Ho().rotateX(Math.PI/2);s=s.multiplyRight(x);break;case"X":let w=new Ho().rotateY(-Math.PI/2);s=s.multiplyRight(w);break;default:break}t.isQuantized&&s.translate(t.quantizedVolumeOffset).scale(t.quantizedVolumeScale);let c=new nn(o);t.cartesianModelMatrix=s,t.cartesianOrigin=c;let l=Si.WGS84.cartesianToCartographic(c,new nn),p=Si.WGS84.eastNorthUpToFixedFrame(c).invert();t.cartographicModelMatrix=p.multiplyRight(s),t.cartographicOrigin=l,t.coordinateSystem||(t.modelMatrix=t.cartographicModelMatrix)}var nc={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};var NTe=1/Math.PI*180,kTe=1/180*Math.PI,sIt={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...sIt}};var ca=globalThis.mathgl.config;function Jk(e,{precision:t=ca.precision}={}){return e=aIt(e),`${parseFloat(e.toPrecision(t))}`}function fd(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Hm(e,t,r){let n=ca.EPSILON;r&&(ca.EPSILON=r);try{if(e===t)return!0;if(fd(e)&&fd(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!Hm(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<=ca.EPSILON*Math.max(1,Math.abs(e),Math.abs(t)):!1}finally{ca.EPSILON=n}}function aIt(e){return Math.round(e/ca.EPSILON)*ca.EPSILON}var Wm=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(t,r=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+r];return this.check()}toArray(t=[],r=0){for(let n=0;n<this.ELEMENTS;++n)t[r+n]=this[n];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:fd(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(ca)}formatString(t){let r="";for(let n=0;n<this.ELEMENTS;++n)r+=(n>0?", ":"")+Jk(this[n],t);return`${t.printTypes?this.constructor.name:""}[${r}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(!Hm(this[r],t[r]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==t[r])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,r,n){if(n===void 0)return this.lerp(this,t,r);for(let i=0;i<this.ELEMENTS;++i){let o=t[i],s=typeof r=="number"?r:r[i];this[i]=o+n*(s-o)}return this.check()}min(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(t[r],this[r]);return this.check()}max(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(t[r],this[r]);return this.check()}clamp(t,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),r[n]);return this.check()}add(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]+=r[n];return this.check()}subtract(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]-=r[n];return this.check()}scale(t){if(typeof t=="number")for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;else for(let r=0;r<this.ELEMENTS&&r<t.length;++r)this[r]*=t[r];return this.check()}multiplyByScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}check(){if(ca.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)t=t&&Number.isFinite(this[r]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=t;return this.check()}addScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),r);return this.check()}get elements(){return this}};function cIt(e,t){if(e.length!==t)return!1;for(let r=0;r<e.length;++r)if(!Number.isFinite(e[r]))return!1;return!0}function oo(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function eP(e,t,r=""){if(ca.debug&&!cIt(e,t))throw new Error(`math.gl: ${r} some fields set to invalid numbers'`);return e}function tp(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}var r1=class extends Wm{get x(){return this[0]}set x(t){this[0]=oo(t)}get y(){return this[1]}set y(t){this[1]=oo(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let r=0;r<this.ELEMENTS;++r)t+=this[r]*this[r];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let r=0;for(let n=0;n<this.ELEMENTS;++n){let i=this[n]-t[n];r+=i*i}return oo(r)}dot(t){let r=0;for(let n=0;n<this.ELEMENTS;++n)r+=this[n]*t[n];return oo(r)}normalize(){let t=this.magnitude();if(t!==0)for(let r=0;r<this.ELEMENTS;++r)this[r]/=t;return this.check()}multiply(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]*=r[n];return this.check()}divide(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]/=r[n];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return tp(t>=0&&t<this.ELEMENTS,"index is out of range"),oo(this[t])}setComponent(t,r){return tp(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=r,this.check()}addVectors(t,r){return this.copy(t).add(r)}subVectors(t,r){return this.copy(t).subtract(r)}multiplyVectors(t,r){return this.copy(t).multiply(r)}addScaledVector(t,r){return this.add(new this.constructor(t).multiplyScalar(r))}};var Ls=typeof Float32Array<"u"?Float32Array:Array;var YTe=Math.PI/180;function lIt(){let e=new Ls(2);return Ls!=Float32Array&&(e[0]=0,e[1]=0),e}function Att(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e}var KTe=function(){let e=lIt();return function(t,r,n,i,o,s){let c,l;for(r||(r=2),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],o(e,e,s),t[c]=e[0],t[c+1]=e[1];return t}}();function gtt(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[3]*n+r[7]*i+r[11]*o||1;return e[0]=(r[0]*n+r[4]*i+r[8]*o)/s,e[1]=(r[1]*n+r[5]*i+r[9]*o)/s,e[2]=(r[2]*n+r[6]*i+r[10]*o)/s,e}function _tt(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e[2]=t[2],e}function ytt(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e[2]=t[2],e[3]=t[3],e}function rP(e,t,r){let n=t[0],i=t[1],o=t[2];return e[0]=r[0]*n+r[3]*i+r[6]*o,e[1]=r[1]*n+r[4]*i+r[7]*o,e[2]=r[2]*n+r[5]*i+r[8]*o,e[3]=t[3],e}function tF(){let e=new Ls(3);return Ls!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function uIt(e){let t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function eF(e,t,r){let n=new Ls(3);return n[0]=e,n[1]=t,n[2]=r,n}function xtt(e,t){let r=t[0],n=t[1],i=t[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function rF(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function i1(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[0],c=r[1],l=r[2];return e[0]=i*l-o*c,e[1]=o*s-n*l,e[2]=n*c-i*s,e}function nP(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[3]*n+r[7]*i+r[11]*o+r[15];return s=s||1,e[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/s,e[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/s,e[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/s,e}function iP(e,t,r){let n=t[0],i=t[1],o=t[2];return e[0]=n*r[0]+i*r[3]+o*r[6],e[1]=n*r[1]+i*r[4]+o*r[7],e[2]=n*r[2]+i*r[5]+o*r[8],e}function oP(e,t,r){let n=r[0],i=r[1],o=r[2],s=r[3],c=t[0],l=t[1],h=t[2],p=i*h-o*l,x=o*c-n*h,w=n*l-i*c,E=i*w-o*x,P=o*p-n*w,B=n*x-i*p,D=s*2;return p*=D,x*=D,w*=D,E*=2,P*=2,B*=2,e[0]=c+p+E,e[1]=l+x+P,e[2]=h+w+B,e}function vtt(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function btt(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function wtt(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function Ttt(e,t){let r=e[0],n=e[1],i=e[2],o=t[0],s=t[1],c=t[2],l=Math.sqrt((r*r+n*n+i*i)*(o*o+s*s+c*c)),h=l&&rF(e,t)/l;return Math.acos(Math.min(Math.max(h,-1),1))}var Ett=uIt;var QTe=function(){let e=tF();return function(t,r,n,i,o,s){let c,l;for(r||(r=3),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],o(e,e,s),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2];return t}}();var nF=[0,0,0],sP,tn=class extends r1{static get ZERO(){return sP||(sP=new tn(0,0,0),Object.freeze(sP)),sP}constructor(t=0,r=0,n=0){super(-0,-0,-0),arguments.length===1&&fd(t)?this.copy(t):(ca.debug&&(oo(t),oo(r),oo(n)),this[0]=t,this[1]=r,this[2]=n)}set(t,r,n){return this[0]=t,this[1]=r,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return ca.debug&&(oo(t.x),oo(t.y),oo(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=oo(t)}angle(t){return Ttt(this,t)}cross(t){return i1(this,this,t),this.check()}rotateX({radians:t,origin:r=nF}){return vtt(this,this,r,t),this.check()}rotateY({radians:t,origin:r=nF}){return btt(this,this,r,t),this.check()}rotateZ({radians:t,origin:r=nF}){return wtt(this,this,r,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return nP(this,this,t),this.check()}transformAsVector(t){return gtt(this,this,t),this.check()}transformByMatrix3(t){return iP(this,this,t),this.check()}transformByMatrix2(t){return _tt(this,this,t),this.check()}transformByQuaternion(t){return oP(this,this,t),this.check()}};var aP,o1=class extends r1{static get ZERO(){return aP||(aP=new o1(0,0,0,0),Object.freeze(aP)),aP}constructor(t=0,r=0,n=0,i=0){super(-0,-0,-0,-0),fd(t)&&arguments.length===1?this.copy(t):(ca.debug&&(oo(t),oo(r),oo(n),oo(i)),this[0]=t,this[1]=r,this[2]=n,this[3]=i)}set(t,r,n,i){return this[0]=t,this[1]=r,this[2]=n,this[3]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return ca.debug&&(oo(t.x),oo(t.y),oo(t.z),oo(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=oo(t)}get w(){return this[3]}set w(t){this[3]=oo(t)}transform(t){return nP(this,this,t),this.check()}transformByMatrix3(t){return rP(this,this,t),this.check()}transformByMatrix2(t){return ytt(this,this,t),this.check()}transformByQuaternion(t){return oP(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}};var cP=class extends Wm{toString(){let t="[";if(ca.printRowMajor){t+="row-major:";for(let r=0;r<this.RANK;++r)for(let n=0;n<this.RANK;++n)t+=` ${this[n*this.RANK+r]}`}else{t+="column-major:";for(let r=0;r<this.ELEMENTS;++r)t+=` ${this[r]}`}return t+="]",t}getElementIndex(t,r){return r*this.RANK+t}getElement(t,r){return this[r*this.RANK+t]}setElement(t,r,n){return this[r*this.RANK+t]=oo(n),this}getColumn(t,r=new Array(this.RANK).fill(-0)){let n=t*this.RANK;for(let i=0;i<this.RANK;++i)r[i]=this[n+i];return r}setColumn(t,r){let n=t*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=r[i];return this}};function Mtt(){let e=new Ls(9);return Ls!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Stt(e,t){if(e===t){let r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Ctt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],c=t[5],l=t[6],h=t[7],p=t[8],x=p*s-c*h,w=-p*o+c*l,E=h*o-s*l,P=r*x+n*w+i*E;return P?(P=1/P,e[0]=x*P,e[1]=(-p*n+i*h)*P,e[2]=(c*n-i*s)*P,e[3]=w*P,e[4]=(p*r-i*l)*P,e[5]=(-c*r+i*o)*P,e[6]=E*P,e[7]=(-h*r+n*l)*P,e[8]=(s*r-n*o)*P,e):null}function Ptt(e){let t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],c=e[6],l=e[7],h=e[8];return t*(h*o-s*l)+r*(-h*i+s*c)+n*(l*i-o*c)}function iF(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=r[0],E=r[1],P=r[2],B=r[3],D=r[4],W=r[5],X=r[6],q=r[7],$=r[8];return e[0]=w*n+E*s+P*h,e[1]=w*i+E*c+P*p,e[2]=w*o+E*l+P*x,e[3]=B*n+D*s+W*h,e[4]=B*i+D*c+W*p,e[5]=B*o+D*l+W*x,e[6]=X*n+q*s+$*h,e[7]=X*i+q*c+$*p,e[8]=X*o+q*l+$*x,e}function Itt(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=r[0],E=r[1];return e[0]=n,e[1]=i,e[2]=o,e[3]=s,e[4]=c,e[5]=l,e[6]=w*n+E*s+h,e[7]=w*i+E*c+p,e[8]=w*o+E*l+x,e}function Rtt(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=Math.sin(r),E=Math.cos(r);return e[0]=E*n+w*s,e[1]=E*i+w*c,e[2]=E*o+w*l,e[3]=E*s-w*n,e[4]=E*c-w*i,e[5]=E*l-w*o,e[6]=h,e[7]=p,e[8]=x,e}function oF(e,t,r){let n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Ltt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r+r,c=n+n,l=i+i,h=r*s,p=n*s,x=n*c,w=i*s,E=i*c,P=i*l,B=o*s,D=o*c,W=o*l;return e[0]=1-x-P,e[3]=p-W,e[6]=w+D,e[1]=p+W,e[4]=1-h-P,e[7]=E-B,e[2]=w-D,e[5]=E+B,e[8]=1-h-x,e}var sF;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL1ROW0=3]="COL1ROW0",e[e.COL1ROW1=4]="COL1ROW1",e[e.COL1ROW2=5]="COL1ROW2",e[e.COL2ROW0=6]="COL2ROW0",e[e.COL2ROW1=7]="COL2ROW1",e[e.COL2ROW2=8]="COL2ROW2"})(sF||(sF={}));var pIt=Object.freeze([1,0,0,0,1,0,0,0,1]),Os=class extends cP{static get IDENTITY(){return mIt()}static get ZERO(){return dIt()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return sF}constructor(t,...r){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):r.length>0?this.copy([t,...r]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(pIt)}fromObject(t){return this.check()}fromQuaternion(t){return Ltt(this,t),this.check()}set(t,r,n,i,o,s,c,l,h){return this[0]=t,this[1]=r,this[2]=n,this[3]=i,this[4]=o,this[5]=s,this[6]=c,this[7]=l,this[8]=h,this.check()}setRowMajor(t,r,n,i,o,s,c,l,h){return this[0]=t,this[1]=i,this[2]=c,this[3]=r,this[4]=o,this[5]=l,this[6]=n,this[7]=s,this[8]=h,this.check()}determinant(){return Ptt(this)}transpose(){return Stt(this,this),this.check()}invert(){return Ctt(this,this),this.check()}multiplyLeft(t){return iF(this,t,this),this.check()}multiplyRight(t){return iF(this,this,t),this.check()}rotate(t){return Rtt(this,this,t),this.check()}scale(t){return Array.isArray(t)?oF(this,this,t):oF(this,this,[t,t]),this.check()}translate(t){return Itt(this,this,t),this.check()}transform(t,r){let n;switch(t.length){case 2:n=Att(r||[-0,-0],t,this);break;case 3:n=iP(r||[-0,-0,-0],t,this);break;case 4:n=rP(r||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return eP(n,t.length),n}transformVector(t,r){return this.transform(t,r)}transformVector2(t,r){return this.transform(t,r)}transformVector3(t,r){return this.transform(t,r)}},lP,uP=null;function dIt(){return lP||(lP=new Os([0,0,0,0,0,0,0,0,0]),Object.freeze(lP)),lP}function mIt(){return uP||(uP=new Os,Object.freeze(uP)),uP}var Aw={};Lo(Aw,{add:()=>tRt,adjoint:()=>wIt,clone:()=>gIt,copy:()=>_It,create:()=>AIt,decompose:()=>UIt,determinant:()=>TIt,equals:()=>iRt,exactEquals:()=>nRt,frob:()=>JIt,fromQuat:()=>HIt,fromQuat2:()=>kIt,fromRotation:()=>OIt,fromRotationTranslation:()=>Dtt,fromRotationTranslationScale:()=>VIt,fromRotationTranslationScaleOrigin:()=>jIt,fromScaling:()=>LIt,fromTranslation:()=>RIt,fromValues:()=>yIt,fromXRotation:()=>BIt,fromYRotation:()=>DIt,fromZRotation:()=>NIt,frustum:()=>WIt,getRotation:()=>zIt,getScaling:()=>Ntt,getTranslation:()=>FIt,identity:()=>Ott,invert:()=>bIt,lookAt:()=>ZIt,mul:()=>oRt,multiply:()=>Btt,multiplyScalar:()=>eRt,multiplyScalarAndAdd:()=>rRt,ortho:()=>YIt,orthoNO:()=>Ftt,orthoZO:()=>KIt,perspective:()=>qIt,perspectiveFromFieldOfView:()=>XIt,perspectiveNO:()=>ktt,perspectiveZO:()=>GIt,rotate:()=>SIt,rotateX:()=>CIt,rotateY:()=>PIt,rotateZ:()=>IIt,scale:()=>MIt,set:()=>xIt,str:()=>QIt,sub:()=>sRt,subtract:()=>ztt,targetTo:()=>$It,translate:()=>EIt,transpose:()=>vIt});function AIt(){let e=new Ls(16);return Ls!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function gIt(e){let t=new Ls(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function _It(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function yIt(e,t,r,n,i,o,s,c,l,h,p,x,w,E,P,B){let D=new Ls(16);return D[0]=e,D[1]=t,D[2]=r,D[3]=n,D[4]=i,D[5]=o,D[6]=s,D[7]=c,D[8]=l,D[9]=h,D[10]=p,D[11]=x,D[12]=w,D[13]=E,D[14]=P,D[15]=B,D}function xIt(e,t,r,n,i,o,s,c,l,h,p,x,w,E,P,B,D){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=s,e[6]=c,e[7]=l,e[8]=h,e[9]=p,e[10]=x,e[11]=w,e[12]=E,e[13]=P,e[14]=B,e[15]=D,e}function Ott(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function vIt(e,t){if(e===t){let r=t[1],n=t[2],i=t[3],o=t[6],s=t[7],c=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=i,e[13]=s,e[14]=c}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function bIt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],c=t[5],l=t[6],h=t[7],p=t[8],x=t[9],w=t[10],E=t[11],P=t[12],B=t[13],D=t[14],W=t[15],X=r*c-n*s,q=r*l-i*s,$=r*h-o*s,et=n*l-i*c,F=n*h-o*c,ut=i*h-o*l,ot=p*B-x*P,J=p*D-w*P,G=p*W-E*P,mt=x*D-w*B,Mt=x*W-E*B,ct=w*W-E*D,gt=X*ct-q*Mt+$*mt+et*G-F*J+ut*ot;return gt?(gt=1/gt,e[0]=(c*ct-l*Mt+h*mt)*gt,e[1]=(i*Mt-n*ct-o*mt)*gt,e[2]=(B*ut-D*F+W*et)*gt,e[3]=(w*F-x*ut-E*et)*gt,e[4]=(l*G-s*ct-h*J)*gt,e[5]=(r*ct-i*G+o*J)*gt,e[6]=(D*$-P*ut-W*q)*gt,e[7]=(p*ut-w*$+E*q)*gt,e[8]=(s*Mt-c*G+h*ot)*gt,e[9]=(n*G-r*Mt-o*ot)*gt,e[10]=(P*F-B*$+W*X)*gt,e[11]=(x*$-p*F-E*X)*gt,e[12]=(c*J-s*mt-l*ot)*gt,e[13]=(r*mt-n*J+i*ot)*gt,e[14]=(B*q-P*et-D*X)*gt,e[15]=(p*et-x*q+w*X)*gt,e):null}function wIt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],c=t[5],l=t[6],h=t[7],p=t[8],x=t[9],w=t[10],E=t[11],P=t[12],B=t[13],D=t[14],W=t[15],X=r*c-n*s,q=r*l-i*s,$=r*h-o*s,et=n*l-i*c,F=n*h-o*c,ut=i*h-o*l,ot=p*B-x*P,J=p*D-w*P,G=p*W-E*P,mt=x*D-w*B,Mt=x*W-E*B,ct=w*W-E*D;return e[0]=c*ct-l*Mt+h*mt,e[1]=i*Mt-n*ct-o*mt,e[2]=B*ut-D*F+W*et,e[3]=w*F-x*ut-E*et,e[4]=l*G-s*ct-h*J,e[5]=r*ct-i*G+o*J,e[6]=D*$-P*ut-W*q,e[7]=p*ut-w*$+E*q,e[8]=s*Mt-c*G+h*ot,e[9]=n*G-r*Mt-o*ot,e[10]=P*F-B*$+W*X,e[11]=x*$-p*F-E*X,e[12]=c*J-s*mt-l*ot,e[13]=r*mt-n*J+i*ot,e[14]=B*q-P*et-D*X,e[15]=p*et-x*q+w*X,e}function TIt(e){let t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],c=e[6],l=e[7],h=e[8],p=e[9],x=e[10],w=e[11],E=e[12],P=e[13],B=e[14],D=e[15],W=t*s-r*o,X=t*c-n*o,q=r*c-n*s,$=h*P-p*E,et=h*B-x*E,F=p*B-x*P,ut=t*F-r*et+n*$,ot=o*F-s*et+c*$,J=h*q-p*X+x*W,G=E*q-P*X+B*W;return l*ut-i*ot+D*J-w*G}function Btt(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=t[9],E=t[10],P=t[11],B=t[12],D=t[13],W=t[14],X=t[15],q=r[0],$=r[1],et=r[2],F=r[3];return e[0]=q*n+$*c+et*x+F*B,e[1]=q*i+$*l+et*w+F*D,e[2]=q*o+$*h+et*E+F*W,e[3]=q*s+$*p+et*P+F*X,q=r[4],$=r[5],et=r[6],F=r[7],e[4]=q*n+$*c+et*x+F*B,e[5]=q*i+$*l+et*w+F*D,e[6]=q*o+$*h+et*E+F*W,e[7]=q*s+$*p+et*P+F*X,q=r[8],$=r[9],et=r[10],F=r[11],e[8]=q*n+$*c+et*x+F*B,e[9]=q*i+$*l+et*w+F*D,e[10]=q*o+$*h+et*E+F*W,e[11]=q*s+$*p+et*P+F*X,q=r[12],$=r[13],et=r[14],F=r[15],e[12]=q*n+$*c+et*x+F*B,e[13]=q*i+$*l+et*w+F*D,e[14]=q*o+$*h+et*E+F*W,e[15]=q*s+$*p+et*P+F*X,e}function EIt(e,t,r){let n=r[0],i=r[1],o=r[2],s,c,l,h,p,x,w,E,P,B,D,W;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*o+t[12],e[13]=t[1]*n+t[5]*i+t[9]*o+t[13],e[14]=t[2]*n+t[6]*i+t[10]*o+t[14],e[15]=t[3]*n+t[7]*i+t[11]*o+t[15]):(s=t[0],c=t[1],l=t[2],h=t[3],p=t[4],x=t[5],w=t[6],E=t[7],P=t[8],B=t[9],D=t[10],W=t[11],e[0]=s,e[1]=c,e[2]=l,e[3]=h,e[4]=p,e[5]=x,e[6]=w,e[7]=E,e[8]=P,e[9]=B,e[10]=D,e[11]=W,e[12]=s*n+p*i+P*o+t[12],e[13]=c*n+x*i+B*o+t[13],e[14]=l*n+w*i+D*o+t[14],e[15]=h*n+E*i+W*o+t[15]),e}function MIt(e,t,r){let n=r[0],i=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function SIt(e,t,r,n){let i=n[0],o=n[1],s=n[2],c=Math.sqrt(i*i+o*o+s*s),l,h,p,x,w,E,P,B,D,W,X,q,$,et,F,ut,ot,J,G,mt,Mt,ct,gt,ee;return c<1e-6?null:(c=1/c,i*=c,o*=c,s*=c,h=Math.sin(r),l=Math.cos(r),p=1-l,x=t[0],w=t[1],E=t[2],P=t[3],B=t[4],D=t[5],W=t[6],X=t[7],q=t[8],$=t[9],et=t[10],F=t[11],ut=i*i*p+l,ot=o*i*p+s*h,J=s*i*p-o*h,G=i*o*p-s*h,mt=o*o*p+l,Mt=s*o*p+i*h,ct=i*s*p+o*h,gt=o*s*p-i*h,ee=s*s*p+l,e[0]=x*ut+B*ot+q*J,e[1]=w*ut+D*ot+$*J,e[2]=E*ut+W*ot+et*J,e[3]=P*ut+X*ot+F*J,e[4]=x*G+B*mt+q*Mt,e[5]=w*G+D*mt+$*Mt,e[6]=E*G+W*mt+et*Mt,e[7]=P*G+X*mt+F*Mt,e[8]=x*ct+B*gt+q*ee,e[9]=w*ct+D*gt+$*ee,e[10]=E*ct+W*gt+et*ee,e[11]=P*ct+X*gt+F*ee,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function CIt(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[4],s=t[5],c=t[6],l=t[7],h=t[8],p=t[9],x=t[10],w=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+h*n,e[5]=s*i+p*n,e[6]=c*i+x*n,e[7]=l*i+w*n,e[8]=h*i-o*n,e[9]=p*i-s*n,e[10]=x*i-c*n,e[11]=w*i-l*n,e}function PIt(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[0],s=t[1],c=t[2],l=t[3],h=t[8],p=t[9],x=t[10],w=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-h*n,e[1]=s*i-p*n,e[2]=c*i-x*n,e[3]=l*i-w*n,e[8]=o*n+h*i,e[9]=s*n+p*i,e[10]=c*n+x*i,e[11]=l*n+w*i,e}function IIt(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[0],s=t[1],c=t[2],l=t[3],h=t[4],p=t[5],x=t[6],w=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+h*n,e[1]=s*i+p*n,e[2]=c*i+x*n,e[3]=l*i+w*n,e[4]=h*i-o*n,e[5]=p*i-s*n,e[6]=x*i-c*n,e[7]=w*i-l*n,e}function RIt(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function LIt(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function OIt(e,t,r){let n=r[0],i=r[1],o=r[2],s=Math.sqrt(n*n+i*i+o*o),c,l,h;return s<1e-6?null:(s=1/s,n*=s,i*=s,o*=s,l=Math.sin(t),c=Math.cos(t),h=1-c,e[0]=n*n*h+c,e[1]=i*n*h+o*l,e[2]=o*n*h-i*l,e[3]=0,e[4]=n*i*h-o*l,e[5]=i*i*h+c,e[6]=o*i*h+n*l,e[7]=0,e[8]=n*o*h+i*l,e[9]=i*o*h-n*l,e[10]=o*o*h+c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function BIt(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function DIt(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function NIt(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Dtt(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=n+n,l=i+i,h=o+o,p=n*c,x=n*l,w=n*h,E=i*l,P=i*h,B=o*h,D=s*c,W=s*l,X=s*h;return e[0]=1-(E+B),e[1]=x+X,e[2]=w-W,e[3]=0,e[4]=x-X,e[5]=1-(p+B),e[6]=P+D,e[7]=0,e[8]=w+W,e[9]=P-D,e[10]=1-(p+E),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function kIt(e,t){let r=new Ls(3),n=-t[0],i=-t[1],o=-t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=n*n+i*i+o*o+s*s;return x>0?(r[0]=(c*s+p*n+l*o-h*i)*2/x,r[1]=(l*s+p*i+h*n-c*o)*2/x,r[2]=(h*s+p*o+c*i-l*n)*2/x):(r[0]=(c*s+p*n+l*o-h*i)*2,r[1]=(l*s+p*i+h*n-c*o)*2,r[2]=(h*s+p*o+c*i-l*n)*2),Dtt(e,t,r),e}function FIt(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Ntt(e,t){let r=t[0],n=t[1],i=t[2],o=t[4],s=t[5],c=t[6],l=t[8],h=t[9],p=t[10];return e[0]=Math.sqrt(r*r+n*n+i*i),e[1]=Math.sqrt(o*o+s*s+c*c),e[2]=Math.sqrt(l*l+h*h+p*p),e}function zIt(e,t){let r=new Ls(3);Ntt(r,t);let n=1/r[0],i=1/r[1],o=1/r[2],s=t[0]*n,c=t[1]*i,l=t[2]*o,h=t[4]*n,p=t[5]*i,x=t[6]*o,w=t[8]*n,E=t[9]*i,P=t[10]*o,B=s+p+P,D=0;return B>0?(D=Math.sqrt(B+1)*2,e[3]=.25*D,e[0]=(x-E)/D,e[1]=(w-l)/D,e[2]=(c-h)/D):s>p&&s>P?(D=Math.sqrt(1+s-p-P)*2,e[3]=(x-E)/D,e[0]=.25*D,e[1]=(c+h)/D,e[2]=(w+l)/D):p>P?(D=Math.sqrt(1+p-s-P)*2,e[3]=(w-l)/D,e[0]=(c+h)/D,e[1]=.25*D,e[2]=(x+E)/D):(D=Math.sqrt(1+P-s-p)*2,e[3]=(c-h)/D,e[0]=(w+l)/D,e[1]=(x+E)/D,e[2]=.25*D),e}function UIt(e,t,r,n){t[0]=n[12],t[1]=n[13],t[2]=n[14];let i=n[0],o=n[1],s=n[2],c=n[4],l=n[5],h=n[6],p=n[8],x=n[9],w=n[10];r[0]=Math.sqrt(i*i+o*o+s*s),r[1]=Math.sqrt(c*c+l*l+h*h),r[2]=Math.sqrt(p*p+x*x+w*w);let E=1/r[0],P=1/r[1],B=1/r[2],D=i*E,W=o*P,X=s*B,q=c*E,$=l*P,et=h*B,F=p*E,ut=x*P,ot=w*B,J=D+$+ot,G=0;return J>0?(G=Math.sqrt(J+1)*2,e[3]=.25*G,e[0]=(et-ut)/G,e[1]=(F-X)/G,e[2]=(W-q)/G):D>$&&D>ot?(G=Math.sqrt(1+D-$-ot)*2,e[3]=(et-ut)/G,e[0]=.25*G,e[1]=(W+q)/G,e[2]=(F+X)/G):$>ot?(G=Math.sqrt(1+$-D-ot)*2,e[3]=(F-X)/G,e[0]=(W+q)/G,e[1]=.25*G,e[2]=(et+ut)/G):(G=Math.sqrt(1+ot-D-$)*2,e[3]=(W-q)/G,e[0]=(F+X)/G,e[1]=(et+ut)/G,e[2]=.25*G),e}function VIt(e,t,r,n){let i=t[0],o=t[1],s=t[2],c=t[3],l=i+i,h=o+o,p=s+s,x=i*l,w=i*h,E=i*p,P=o*h,B=o*p,D=s*p,W=c*l,X=c*h,q=c*p,$=n[0],et=n[1],F=n[2];return e[0]=(1-(P+D))*$,e[1]=(w+q)*$,e[2]=(E-X)*$,e[3]=0,e[4]=(w-q)*et,e[5]=(1-(x+D))*et,e[6]=(B+W)*et,e[7]=0,e[8]=(E+X)*F,e[9]=(B-W)*F,e[10]=(1-(x+P))*F,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function jIt(e,t,r,n,i){let o=t[0],s=t[1],c=t[2],l=t[3],h=o+o,p=s+s,x=c+c,w=o*h,E=o*p,P=o*x,B=s*p,D=s*x,W=c*x,X=l*h,q=l*p,$=l*x,et=n[0],F=n[1],ut=n[2],ot=i[0],J=i[1],G=i[2],mt=(1-(B+W))*et,Mt=(E+$)*et,ct=(P-q)*et,gt=(E-$)*F,ee=(1-(w+W))*F,Ne=(D+X)*F,Ue=(P+q)*ut,sr=(D-X)*ut,gr=(1-(w+B))*ut;return e[0]=mt,e[1]=Mt,e[2]=ct,e[3]=0,e[4]=gt,e[5]=ee,e[6]=Ne,e[7]=0,e[8]=Ue,e[9]=sr,e[10]=gr,e[11]=0,e[12]=r[0]+ot-(mt*ot+gt*J+Ue*G),e[13]=r[1]+J-(Mt*ot+ee*J+sr*G),e[14]=r[2]+G-(ct*ot+Ne*J+gr*G),e[15]=1,e}function HIt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r+r,c=n+n,l=i+i,h=r*s,p=n*s,x=n*c,w=i*s,E=i*c,P=i*l,B=o*s,D=o*c,W=o*l;return e[0]=1-x-P,e[1]=p+W,e[2]=w-D,e[3]=0,e[4]=p-W,e[5]=1-h-P,e[6]=E+B,e[7]=0,e[8]=w+D,e[9]=E-B,e[10]=1-h-x,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function WIt(e,t,r,n,i,o,s){let c=1/(r-t),l=1/(i-n),h=1/(o-s);return e[0]=o*2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o*2*l,e[6]=0,e[7]=0,e[8]=(r+t)*c,e[9]=(i+n)*l,e[10]=(s+o)*h,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*o*2*h,e[15]=0,e}function ktt(e,t,r,n,i){let o=1/Math.tan(t/2);if(e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0){let s=1/(n-i);e[10]=(i+n)*s,e[14]=2*i*n*s}else e[10]=-1,e[14]=-2*n;return e}var qIt=ktt;function GIt(e,t,r,n,i){let o=1/Math.tan(t/2);if(e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0){let s=1/(n-i);e[10]=i*s,e[14]=i*n*s}else e[10]=-1,e[14]=-n;return e}function XIt(e,t,r,n){let i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),s=Math.tan(t.leftDegrees*Math.PI/180),c=Math.tan(t.rightDegrees*Math.PI/180),l=2/(s+c),h=2/(i+o);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=h,e[6]=0,e[7]=0,e[8]=-((s-c)*l*.5),e[9]=(i-o)*h*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function Ftt(e,t,r,n,i,o,s){let c=1/(t-r),l=1/(n-i),h=1/(o-s);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*h,e[11]=0,e[12]=(t+r)*c,e[13]=(i+n)*l,e[14]=(s+o)*h,e[15]=1,e}var YIt=Ftt;function KIt(e,t,r,n,i,o,s){let c=1/(t-r),l=1/(n-i),h=1/(o-s);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=h,e[11]=0,e[12]=(t+r)*c,e[13]=(i+n)*l,e[14]=o*h,e[15]=1,e}function ZIt(e,t,r,n){let i,o,s,c,l,h,p,x,w,E,P=t[0],B=t[1],D=t[2],W=n[0],X=n[1],q=n[2],$=r[0],et=r[1],F=r[2];return Math.abs(P-$)<1e-6&&Math.abs(B-et)<1e-6&&Math.abs(D-F)<1e-6?Ott(e):(x=P-$,w=B-et,E=D-F,i=1/Math.sqrt(x*x+w*w+E*E),x*=i,w*=i,E*=i,o=X*E-q*w,s=q*x-W*E,c=W*w-X*x,i=Math.sqrt(o*o+s*s+c*c),i?(i=1/i,o*=i,s*=i,c*=i):(o=0,s=0,c=0),l=w*c-E*s,h=E*o-x*c,p=x*s-w*o,i=Math.sqrt(l*l+h*h+p*p),i?(i=1/i,l*=i,h*=i,p*=i):(l=0,h=0,p=0),e[0]=o,e[1]=l,e[2]=x,e[3]=0,e[4]=s,e[5]=h,e[6]=w,e[7]=0,e[8]=c,e[9]=p,e[10]=E,e[11]=0,e[12]=-(o*P+s*B+c*D),e[13]=-(l*P+h*B+p*D),e[14]=-(x*P+w*B+E*D),e[15]=1,e)}function $It(e,t,r,n){let i=t[0],o=t[1],s=t[2],c=n[0],l=n[1],h=n[2],p=i-r[0],x=o-r[1],w=s-r[2],E=p*p+x*x+w*w;E>0&&(E=1/Math.sqrt(E),p*=E,x*=E,w*=E);let P=l*w-h*x,B=h*p-c*w,D=c*x-l*p;return E=P*P+B*B+D*D,E>0&&(E=1/Math.sqrt(E),P*=E,B*=E,D*=E),e[0]=P,e[1]=B,e[2]=D,e[3]=0,e[4]=x*D-w*B,e[5]=w*P-p*D,e[6]=p*B-x*P,e[7]=0,e[8]=p,e[9]=x,e[10]=w,e[11]=0,e[12]=i,e[13]=o,e[14]=s,e[15]=1,e}function QIt(e){return`mat4(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]}, ${e[4]}, ${e[5]}, ${e[6]}, ${e[7]}, ${e[8]}, ${e[9]}, ${e[10]}, ${e[11]}, ${e[12]}, ${e[13]}, ${e[14]}, ${e[15]})`}function JIt(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]+e[3]*e[3]+e[4]*e[4]+e[5]*e[5]+e[6]*e[6]+e[7]*e[7]+e[8]*e[8]+e[9]*e[9]+e[10]*e[10]+e[11]*e[11]+e[12]*e[12]+e[13]*e[13]+e[14]*e[14]+e[15]*e[15])}function tRt(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function ztt(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function eRt(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function rRt(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function nRt(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function iRt(e,t){let r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],c=e[5],l=e[6],h=e[7],p=e[8],x=e[9],w=e[10],E=e[11],P=e[12],B=e[13],D=e[14],W=e[15],X=t[0],q=t[1],$=t[2],et=t[3],F=t[4],ut=t[5],ot=t[6],J=t[7],G=t[8],mt=t[9],Mt=t[10],ct=t[11],gt=t[12],ee=t[13],Ne=t[14],Ue=t[15];return Math.abs(r-X)<=1e-6*Math.max(1,Math.abs(r),Math.abs(X))&&Math.abs(n-q)<=1e-6*Math.max(1,Math.abs(n),Math.abs(q))&&Math.abs(i-$)<=1e-6*Math.max(1,Math.abs(i),Math.abs($))&&Math.abs(o-et)<=1e-6*Math.max(1,Math.abs(o),Math.abs(et))&&Math.abs(s-F)<=1e-6*Math.max(1,Math.abs(s),Math.abs(F))&&Math.abs(c-ut)<=1e-6*Math.max(1,Math.abs(c),Math.abs(ut))&&Math.abs(l-ot)<=1e-6*Math.max(1,Math.abs(l),Math.abs(ot))&&Math.abs(h-J)<=1e-6*Math.max(1,Math.abs(h),Math.abs(J))&&Math.abs(p-G)<=1e-6*Math.max(1,Math.abs(p),Math.abs(G))&&Math.abs(x-mt)<=1e-6*Math.max(1,Math.abs(x),Math.abs(mt))&&Math.abs(w-Mt)<=1e-6*Math.max(1,Math.abs(w),Math.abs(Mt))&&Math.abs(E-ct)<=1e-6*Math.max(1,Math.abs(E),Math.abs(ct))&&Math.abs(P-gt)<=1e-6*Math.max(1,Math.abs(P),Math.abs(gt))&&Math.abs(B-ee)<=1e-6*Math.max(1,Math.abs(B),Math.abs(ee))&&Math.abs(D-Ne)<=1e-6*Math.max(1,Math.abs(D),Math.abs(Ne))&&Math.abs(W-Ue)<=1e-6*Math.max(1,Math.abs(W),Math.abs(Ue))}var oRt=Btt,sRt=ztt;function aRt(){let e=new Ls(4);return Ls!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Utt(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function Vtt(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function jtt(e){let t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function Htt(e){let t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function Wtt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r*r+n*n+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),e[0]=r*s,e[1]=n*s,e[2]=i*s,e[3]=o*s,e}function qtt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Gtt(e,t,r,n){let i=t[0],o=t[1],s=t[2],c=t[3];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=s+n*(r[2]-s),e[3]=c+n*(r[3]-c),e}function Xtt(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[0],c=r[1],l=r[2],h=r[3],p=h*n+c*o-l*i,x=h*i+l*n-s*o,w=h*o+s*i-c*n,E=-s*n-c*i-l*o;return e[0]=p*h+E*-s+x*-l-w*-c,e[1]=x*h+E*-c+w*-s-p*-l,e[2]=w*h+E*-l+p*-c-x*-s,e[3]=t[3],e}var bEe=function(){let e=aRt();return function(t,r,n,i,o,s){let c,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],e[3]=t[c+3],o(e,e,s),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2],t[c+3]=e[3];return t}}();function Ytt(){let e=new Ls(4);return Ls!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Ktt(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function aF(e,t,r){r=r*.5;let n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function cF(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=r[0],l=r[1],h=r[2],p=r[3];return e[0]=n*p+s*c+i*h-o*l,e[1]=i*p+s*l+o*c-n*h,e[2]=o*p+s*h+n*l-i*c,e[3]=s*p-n*c-i*l-o*h,e}function Ztt(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],s=t[3],c=Math.sin(r),l=Math.cos(r);return e[0]=n*l+s*c,e[1]=i*l+o*c,e[2]=o*l-i*c,e[3]=s*l-n*c,e}function $tt(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],s=t[3],c=Math.sin(r),l=Math.cos(r);return e[0]=n*l-o*c,e[1]=i*l+s*c,e[2]=o*l+n*c,e[3]=s*l-i*c,e}function Qtt(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],s=t[3],c=Math.sin(r),l=Math.cos(r);return e[0]=n*l+i*c,e[1]=i*l-n*c,e[2]=o*l+s*c,e[3]=s*l-o*c,e}function Jtt(e,t){let r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e}function gw(e,t,r,n){let i=t[0],o=t[1],s=t[2],c=t[3],l=r[0],h=r[1],p=r[2],x=r[3],w,E,P,B,D;return w=i*l+o*h+s*p+c*x,w<0&&(w=-w,l=-l,h=-h,p=-p,x=-x),1-w>1e-6?(E=Math.acos(w),D=Math.sin(E),P=Math.sin((1-n)*E)/D,B=Math.sin(n*E)/D):(P=1-n,B=n),e[0]=P*i+B*l,e[1]=P*o+B*h,e[2]=P*s+B*p,e[3]=P*c+B*x,e}function tet(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r*r+n*n+i*i+o*o,c=s?1/s:0;return e[0]=-r*c,e[1]=-n*c,e[2]=-i*c,e[3]=o*c,e}function eet(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function lF(e,t){let r=t[0]+t[4]+t[8],n;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{let i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);let o=(i+1)%3,s=(i+2)%3;n=Math.sqrt(t[i*3+i]-t[o*3+o]-t[s*3+s]+1),e[i]=.5*n,n=.5/n,e[3]=(t[o*3+s]-t[s*3+o])*n,e[o]=(t[o*3+i]+t[i*3+o])*n,e[s]=(t[s*3+i]+t[i*3+s])*n}return e}var ret=Utt;var net=Vtt,iet=qtt,oet=Gtt,set=jtt;var aet=Htt;var cet=Wtt;var uet=function(){let e=tF(),t=eF(1,0,0),r=eF(0,1,0);return function(n,i,o){let s=rF(i,o);return s<-.999999?(i1(e,t,i),Ett(e)<1e-6&&i1(e,r,i),xtt(e,e),aF(n,e,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(i1(e,i,o),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+s,cet(n,n))}}(),CEe=function(){let e=Ytt(),t=Ytt();return function(r,n,i,o,s,c){return gw(e,n,s,c),gw(t,i,o,c),gw(r,e,t,2*c*(1-c)),r}}(),PEe=function(){let e=Mtt();return function(t,r,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],cet(t,lF(t,e))}}();var lRt=[0,0,0,1],s1=class extends Wm{constructor(t=0,r=0,n=0,i=1){super(-0,-0,-0,-0),Array.isArray(t)&&arguments.length===1?this.copy(t):this.set(t,r,n,i)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,r,n,i){return this[0]=t,this[1]=r,this[2]=n,this[3]=i,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return lF(this,t),this.check()}fromAxisRotation(t,r){return aF(this,t,r),this.check()}identity(){return Ktt(this),this.check()}setAxisAngle(t,r){return this.fromAxisRotation(t,r)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=oo(t)}get y(){return this[1]}set y(t){this[1]=oo(t)}get z(){return this[2]}set z(t){this[2]=oo(t)}get w(){return this[3]}set w(t){this[3]=oo(t)}len(){return set(this)}lengthSquared(){return aet(this)}dot(t){return iet(this,t)}rotationTo(t,r){return uet(this,t,r),this.check()}add(t){return ret(this,this,t),this.check()}calculateW(){return Jtt(this,this),this.check()}conjugate(){return eet(this,this),this.check()}invert(){return tet(this,this),this.check()}lerp(t,r,n){return n===void 0?this.lerp(this,t,r):(oet(this,t,r,n),this.check())}multiplyRight(t){return cF(this,this,t),this.check()}multiplyLeft(t){return cF(this,t,this),this.check()}normalize(){let t=this.len(),r=t>0?1/t:0;return this[0]=this[0]*r,this[1]=this[1]*r,this[2]=this[2]*r,this[3]=this[3]*r,t===0&&(this[3]=1),this.check()}rotateX(t){return Ztt(this,this,t),this.check()}rotateY(t){return $tt(this,this,t),this.check()}rotateZ(t){return Qtt(this,this,t),this.check()}scale(t){return net(this,this,t),this.check()}slerp(t,r,n){let i,o,s;switch(arguments.length){case 1:({start:i=lRt,target:o,ratio:s}=t);break;case 2:i=this,o=t,s=r;break;default:i=t,o=r,s=n}return gw(this,i,o,s),this.check()}transformVector4(t,r=new o1){return Xtt(r,t,this),eP(r,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,r){return this.setAxisAngle(t,r)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}};var a1={};Lo(a1,{EPSILON1:()=>uRt,EPSILON10:()=>yRt,EPSILON11:()=>xRt,EPSILON12:()=>vRt,EPSILON13:()=>bRt,EPSILON14:()=>wRt,EPSILON15:()=>TRt,EPSILON16:()=>ERt,EPSILON17:()=>MRt,EPSILON18:()=>SRt,EPSILON19:()=>CRt,EPSILON2:()=>hRt,EPSILON20:()=>PRt,EPSILON3:()=>fRt,EPSILON4:()=>pRt,EPSILON5:()=>dRt,EPSILON6:()=>mRt,EPSILON7:()=>ARt,EPSILON8:()=>gRt,EPSILON9:()=>_Rt,PI_OVER_FOUR:()=>RRt,PI_OVER_SIX:()=>LRt,PI_OVER_TWO:()=>IRt,TWO_PI:()=>ORt});var uRt=.1,hRt=.01,fRt=.001,pRt=1e-4,dRt=1e-5,mRt=1e-6,ARt=1e-7,gRt=1e-8,_Rt=1e-9,yRt=1e-10,xRt=1e-11,vRt=1e-12,bRt=1e-13,wRt=1e-14,TRt=1e-15,ERt=1e-16,MRt=1e-17,SRt=1e-18,CRt=1e-19,PRt=1e-20,IRt=Math.PI/2,RRt=Math.PI/4,LRt=Math.PI/6,ORt=Math.PI*2;var aMe=new tn,cMe=new tn;var _w=new tn,het=new tn,eh=class{constructor(t=[0,0,0],r=0){this.radius=-0,this.center=new tn,this.fromCenterRadius(t,r)}fromCenterRadius(t,r){return this.center.from(t),this.radius=r,this}fromCornerPoints(t,r){return r=_w.from(r),this.center=new tn().from(t).add(r).scale(.5),this.radius=this.center.distance(r),this}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.radius===t.radius}clone(){return new eh(this.center,this.radius)}union(t){let r=this.center,n=this.radius,i=t.center,o=t.radius,s=_w.copy(i).subtract(r),c=s.magnitude();if(n>=c+o)return this.clone();if(o>=c+n)return t.clone();let l=(n+c+o)*.5;return het.copy(s).scale((-n+l)/c).add(r),this.center.copy(het),this.radius=l,this}expand(t){let n=_w.from(t).subtract(this.center).magnitude();return n>this.radius&&(this.radius=n),this}transform(t){this.center.transform(t);let r=Aw.getScaling(_w,t);return this.radius=Math.max(r[0],Math.max(r[1],r[2]))*this.radius,this}distanceSquaredTo(t){let r=this.distanceTo(t);return r*r}distanceTo(t){let n=_w.from(t).subtract(this.center);return Math.max(0,n.len()-this.radius)}intersectPlane(t){let r=this.center,n=this.radius,o=t.normal.dot(r)+t.distance;return o<-n?nc.OUTSIDE:o<n?nc.INTERSECTING:nc.INSIDE}};var BRt=new tn,DRt=new tn,hP=new tn,fP=new tn,pP=new tn,NRt=new tn,kRt=new tn,pd={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8},qh=class{constructor(t=[0,0,0],r=[0,0,0,0,0,0,0,0,0]){this.center=new tn().from(t),this.halfAxes=new Os(r)}get halfSize(){let t=this.halfAxes.getColumn(0),r=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new tn(t).len(),new tn(r).len(),new tn(n).len()]}get quaternion(){let t=this.halfAxes.getColumn(0),r=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),i=new tn(t).normalize(),o=new tn(r).normalize(),s=new tn(n).normalize();return new s1().fromMatrix3(new Os([...i,...o,...s]))}fromCenterHalfSizeQuaternion(t,r,n){let i=new s1(n),o=new Os().fromQuaternion(i);return o[0]=o[0]*r[0],o[1]=o[1]*r[0],o[2]=o[2]*r[0],o[3]=o[3]*r[1],o[4]=o[4]*r[1],o[5]=o[5]*r[1],o[6]=o[6]*r[2],o[7]=o[7]*r[2],o[8]=o[8]*r[2],this.center=new tn().from(t),this.halfAxes=o,this}clone(){return new qh(this.center,this.halfAxes)}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}getBoundingSphere(t=new eh){let r=this.halfAxes,n=r.getColumn(0,hP),i=r.getColumn(1,fP),o=r.getColumn(2,pP),s=BRt.copy(n).add(i).add(o);return t.center.copy(this.center),t.radius=s.magnitude(),t}intersectPlane(t){let r=this.center,n=t.normal,i=this.halfAxes,o=n.x,s=n.y,c=n.z,l=Math.abs(o*i[pd.COLUMN0ROW0]+s*i[pd.COLUMN0ROW1]+c*i[pd.COLUMN0ROW2])+Math.abs(o*i[pd.COLUMN1ROW0]+s*i[pd.COLUMN1ROW1]+c*i[pd.COLUMN1ROW2])+Math.abs(o*i[pd.COLUMN2ROW0]+s*i[pd.COLUMN2ROW1]+c*i[pd.COLUMN2ROW2]),h=n.dot(r)+t.distance;return h<=-l?nc.OUTSIDE:h>=l?nc.INSIDE:nc.INTERSECTING}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){let r=DRt.from(t).subtract(this.center),n=this.halfAxes,i=n.getColumn(0,hP),o=n.getColumn(1,fP),s=n.getColumn(2,pP),c=i.magnitude(),l=o.magnitude(),h=s.magnitude();i.normalize(),o.normalize(),s.normalize();let p=0,x;return x=Math.abs(r.dot(i))-c,x>0&&(p+=x*x),x=Math.abs(r.dot(o))-l,x>0&&(p+=x*x),x=Math.abs(r.dot(s))-h,x>0&&(p+=x*x),p}computePlaneDistances(t,r,n=[-0,-0]){let i=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,s=this.center,c=this.halfAxes,l=c.getColumn(0,hP),h=c.getColumn(1,fP),p=c.getColumn(2,pP),x=NRt.copy(l).add(h).add(p).add(s),w=kRt.copy(x).subtract(t),E=r.dot(w);return i=Math.min(E,i),o=Math.max(E,o),x.copy(s).add(l).add(h).subtract(p),w.copy(x).subtract(t),E=r.dot(w),i=Math.min(E,i),o=Math.max(E,o),x.copy(s).add(l).subtract(h).add(p),w.copy(x).subtract(t),E=r.dot(w),i=Math.min(E,i),o=Math.max(E,o),x.copy(s).add(l).subtract(h).subtract(p),w.copy(x).subtract(t),E=r.dot(w),i=Math.min(E,i),o=Math.max(E,o),s.copy(x).subtract(l).add(h).add(p),w.copy(x).subtract(t),E=r.dot(w),i=Math.min(E,i),o=Math.max(E,o),s.copy(x).subtract(l).add(h).subtract(p),w.copy(x).subtract(t),E=r.dot(w),i=Math.min(E,i),o=Math.max(E,o),s.copy(x).subtract(l).subtract(h).add(p),w.copy(x).subtract(t),E=r.dot(w),i=Math.min(E,i),o=Math.max(E,o),s.copy(x).subtract(l).subtract(h).subtract(p),w.copy(x).subtract(t),E=r.dot(w),i=Math.min(E,i),o=Math.max(E,o),n[0]=i,n[1]=o,n}transform(t){this.center.transformAsPoint(t);let r=this.halfAxes.getColumn(0,hP);r.transformAsPoint(t);let n=this.halfAxes.getColumn(1,fP);n.transformAsPoint(t);let i=this.halfAxes.getColumn(2,pP);return i.transformAsPoint(t),this.halfAxes=new Os([...r,...n,...i]),this}getTransform(){throw new Error("not implemented")}};var fet=new tn,pet=new tn,Gc=class{constructor(t=[0,0,1],r=0){this.normal=new tn,this.distance=-0,this.fromNormalDistance(t,r)}fromNormalDistance(t,r){return tp(Number.isFinite(r)),this.normal.from(t).normalize(),this.distance=r,this}fromPointNormal(t,r){t=fet.from(t),this.normal.from(r).normalize();let n=-this.normal.dot(t);return this.distance=n,this}fromCoefficients(t,r,n,i){return this.normal.set(t,r,n),tp(Hm(this.normal.len(),1)),this.distance=i,this}clone(){return new Gc(this.normal,this.distance)}equals(t){return Hm(this.distance,t.distance)&&Hm(this.normal,t.normal)}getPointDistance(t){return this.normal.dot(t)+this.distance}transform(t){let r=pet.copy(this.normal).transformAsVector(t).normalize(),n=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(n,r)}projectPointOntoPlane(t,r=[0,0,0]){let n=fet.from(t),i=this.getPointDistance(n),o=pet.copy(this.normal).scale(i);return n.subtract(o).to(r)}};var det=[new tn([1,0,0]),new tn([0,1,0]),new tn([0,0,1])],met=new tn,FRt=new tn,ic=class{constructor(t=[]){this.planes=t}fromBoundingSphere(t){this.planes.length=2*det.length;let r=t.center,n=t.radius,i=0;for(let o of det){let s=this.planes[i],c=this.planes[i+1];s||(s=this.planes[i]=new Gc),c||(c=this.planes[i+1]=new Gc);let l=met.copy(o).scale(-n).add(r);s.fromPointNormal(l,o);let h=met.copy(o).scale(n).add(r),p=FRt.copy(o).negate();c.fromPointNormal(h,p),i+=2}return this}computeVisibility(t){let r=nc.INSIDE;for(let n of this.planes)switch(t.intersectPlane(n)){case nc.OUTSIDE:return nc.OUTSIDE;case nc.INTERSECTING:r=nc.INTERSECTING;break;default:}return r}computeVisibilityWithPlaneMask(t,r){if(tp(Number.isFinite(r),"parentPlaneMask is required."),r===ic.MASK_OUTSIDE||r===ic.MASK_INSIDE)return r;let n=ic.MASK_INSIDE,i=this.planes;for(let o=0;o<this.planes.length;++o){let s=o<31?1<<o:0;if(o<31&&!(r&s))continue;let c=i[o],l=t.intersectPlane(c);if(l===nc.OUTSIDE)return ic.MASK_OUTSIDE;l===nc.INTERSECTING&&(n|=s)}return n}};ic.MASK_OUTSIDE=4294967295;ic.MASK_INSIDE=0;ic.MASK_INDETERMINATE=2147483647;var SMe=new tn,CMe=new tn,PMe=new tn,IMe=new tn,RMe=new tn;var kMe=new tn,FMe=new tn,zMe=new tn,UMe=new tn,VMe=new tn,jMe=new tn,HMe=new tn,WMe=new tn,qMe=new tn,GMe=new tn,XMe=new tn,YMe=new tn;var ep=new Os,URt=new Os,VRt=new Os,dP=new Os,Aet=new Os;function fF(e,t={}){let r=a1.EPSILON20,n=10,i=0,o=0,s=URt,c=VRt;s.identity(),c.copy(e);let l=r*jRt(c);for(;o<n&&HRt(c)>l;)WRt(c,dP),Aet.copy(dP).transpose(),c.multiplyRight(dP),c.multiplyLeft(Aet),s.multiplyRight(dP),++i>2&&(++o,i=0);return t.unitary=s.toTarget(t.unitary),t.diagonal=c.toTarget(t.diagonal),t}function jRt(e){let t=0;for(let r=0;r<9;++r){let n=e[r];t+=n*n}return Math.sqrt(t)}var uF=[1,0,0],hF=[2,2,1];function HRt(e){let t=0;for(let r=0;r<3;++r){let n=e[ep.getElementIndex(hF[r],uF[r])];t+=2*n*n}return Math.sqrt(t)}function WRt(e,t){let r=a1.EPSILON15,n=0,i=1;for(let h=0;h<3;++h){let p=Math.abs(e[ep.getElementIndex(hF[h],uF[h])]);p>n&&(i=h,n=p)}let o=uF[i],s=hF[i],c=1,l=0;if(Math.abs(e[ep.getElementIndex(s,o)])>r){let h=e[ep.getElementIndex(s,s)],p=e[ep.getElementIndex(o,o)],x=e[ep.getElementIndex(s,o)],w=(h-p)/2/x,E;w<0?E=-1/(-w+Math.sqrt(1+w*w)):E=1/(w+Math.sqrt(1+w*w)),c=1/Math.sqrt(1+E*E),l=E*c}return Os.IDENTITY.to(t),t[ep.getElementIndex(o,o)]=t[ep.getElementIndex(s,s)]=c,t[ep.getElementIndex(s,o)]=l,t[ep.getElementIndex(o,s)]=-l,t}var qm=new tn,GRt=new tn,XRt=new tn,YRt=new tn,KRt=new tn,ZRt=new Os,$Rt={diagonal:new Os,unitary:new Os};function pF(e,t=new qh){if(!e||e.length===0)return t.halfAxes=new Os([0,0,0,0,0,0,0,0,0]),t.center=new tn,t;let r=e.length,n=new tn(0,0,0);for(let J of e)n.add(J);let i=1/r;n.multiplyByScalar(i);let o=0,s=0,c=0,l=0,h=0,p=0;for(let J of e){let G=qm.copy(J).subtract(n);o+=G.x*G.x,s+=G.x*G.y,c+=G.x*G.z,l+=G.y*G.y,h+=G.y*G.z,p+=G.z*G.z}o*=i,s*=i,c*=i,l*=i,h*=i,p*=i;let x=ZRt;x[0]=o,x[1]=s,x[2]=c,x[3]=s,x[4]=l,x[5]=h,x[6]=c,x[7]=h,x[8]=p;let{unitary:w}=fF(x,$Rt),E=t.halfAxes.copy(w),P=E.getColumn(0,XRt),B=E.getColumn(1,YRt),D=E.getColumn(2,KRt),W=-Number.MAX_VALUE,X=-Number.MAX_VALUE,q=-Number.MAX_VALUE,$=Number.MAX_VALUE,et=Number.MAX_VALUE,F=Number.MAX_VALUE;for(let J of e)qm.copy(J),W=Math.max(qm.dot(P),W),X=Math.max(qm.dot(B),X),q=Math.max(qm.dot(D),q),$=Math.min(qm.dot(P),$),et=Math.min(qm.dot(B),et),F=Math.min(qm.dot(D),F);P=P.multiplyByScalar(.5*($+W)),B=B.multiplyByScalar(.5*(et+X)),D=D.multiplyByScalar(.5*(F+q)),t.center.copy(P).add(B).add(D);let ut=GRt.set(W-$,X-et,q-F).multiplyByScalar(.5),ot=new Os([ut[0],0,0,0,ut[1],0,0,0,ut[2]]);return t.halfAxes.multiplyRight(ot),t}var get=new nn,dF=new nn,mF=new ic([new Gc,new Gc,new Gc,new Gc,new Gc,new Gc]);function yet(e,t){let{cameraDirection:r,cameraUp:n,height:i}=e,{metersPerUnit:o}=e.distanceScales,s=mP(e,e.center),c=Si.WGS84.eastNorthUpToFixedFrame(s),l=e.unprojectPosition(e.cameraPosition),h=Si.WGS84.cartographicToCartesian(l,new nn),p=new nn(c.transformAsVector(new nn(r).scale(o))).normalize(),x=new nn(c.transformAsVector(new nn(n).scale(o))).normalize();QRt(e);let w=e.constructor,{longitude:E,latitude:P,width:B,bearing:D,zoom:W}=e,X=new w({longitude:E,latitude:P,height:i,width:B,bearing:D,zoom:W,pitch:0});return{camera:{position:h,direction:p,up:x},viewport:e,topDownViewport:X,height:i,cullingVolume:mF,frameNumber:t,sseDenominator:1.15}}function xet(e,t,r){if(r===0||e.length<=r)return[e,[]];let n=[],{longitude:i,latitude:o}=t.viewport;for(let[h,p]of e.entries()){let[x,w]=p.header.mbs,E=Math.abs(i-x),P=Math.abs(o-w),B=Math.sqrt(P*P+E*E);n.push([h,B])}let s=n.sort((h,p)=>h[1]-p[1]),c=[];for(let h=0;h<r;h++)c.push(e[s[h][0]]);let l=[];for(let h=r;h<s.length;h++)l.push(e[s[h][0]]);return[c,l]}function QRt(e){let t=e.getFrustumPlanes(),r=_et(t.near,e.cameraPosition),n=mP(e,r),i=mP(e,e.cameraPosition,dF),o=0;mF.planes[o++].fromPointNormal(n,get.copy(n).subtract(i));for(let s in t){if(s==="near")continue;let c=t[s],l=_et(c,r,dF),h=mP(e,l,dF);mF.planes[o++].fromPointNormal(h,get.copy(n).subtract(h))}}function _et(e,t,r=new nn){let n=e.normal.dot(t);return r.copy(e.normal).scale(e.distance-n).add(t),r}function mP(e,t,r=new nn){let n=e.unprojectPosition(t);return Si.WGS84.cartographicToCartesian(n,r)}var JRt=6378137,tLt=6378137,AF=6356752314245179e-9,c1=new nn;function vet(e,t){if(e instanceof qh){let{halfAxes:r}=e,n=eLt(r);return Math.log2(AF/(n+t[2]))}else if(e instanceof eh){let{radius:r}=e;return Math.log2(AF/(r+t[2]))}else if(e.width&&e.height){let{width:r,height:n}=e,i=Math.log2(JRt/r),o=Math.log2(tLt/n);return(i+o)/2}return 1}function gF(e,t,r){Si.WGS84.cartographicToCartesian([e.xmax,e.ymax,e.zmax],c1);let n=Math.sqrt(Math.pow(c1[0]-r[0],2)+Math.pow(c1[1]-r[1],2)+Math.pow(c1[2]-r[2],2));return Math.log2(AF/(n+t[2]))}function bet(e,t,r){let[n,i,o,s]=e;return gF({xmin:n,xmax:o,ymin:i,ymax:s,zmin:0,zmax:0},t,r)}function eLt(e){e.getColumn(0,c1);let t=e.getColumn(1),r=e.getColumn(2);return c1.add(t).add(r).len()}var Al={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},Xc;(function(e){e[e.ADD=1]="ADD",e[e.REPLACE=2]="REPLACE"})(Xc||(Xc={}));var rh;(function(e){e.EMPTY="empty",e.SCENEGRAPH="scenegraph",e.POINTCLOUD="pointcloud",e.MESH="mesh"})(rh||(rh={}));var oc;(function(e){e.I3S="I3S",e.TILES3D="TILES3D"})(oc||(oc={}));var dd;(function(e){e.GEOMETRIC_ERROR="geometricError",e.MAX_SCREEN_THRESHOLD="maxScreenThreshold"})(dd||(dd={}));var wet={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0};function Cet(e){return e!=null}var Yc=new nn,AP=new nn,rLt=new nn,nLt=new nn,q0=new nn,Tet=new nn,Eet=new nn,Met=new nn;function gP(e,t,r){if(Ti(e,"3D Tile: boundingVolume must be defined"),e.box)return Iet(e.box,t,r);if(e.region)return oLt(e.region);if(e.sphere)return iLt(e.sphere,t,r);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function Pet(e,t){if(e.box)return sLt(t);if(e.region){let[r,n,i,o,s,c]=e.region;return[[Ju(r),Ju(n),s],[Ju(i),Ju(o),c]]}if(e.sphere)return aLt(t);throw new Error("Unkown boundingVolume type")}function Iet(e,t,r){let n=new nn(e[0],e[1],e[2]);t.transform(n,n);let i=[];if(e.length===10){let h=e.slice(3,6),p=new fw;p.fromArray(e,6);let x=new nn([1,0,0]),w=new nn([0,1,0]),E=new nn([0,0,1]);x.transformByQuaternion(p),x.scale(h[0]),w.transformByQuaternion(p),w.scale(h[1]),E.transformByQuaternion(p),E.scale(h[2]),i=[...x.toArray(),...w.toArray(),...E.toArray()]}else i=[...e.slice(3,6),...e.slice(6,9),...e.slice(9,12)];let o=t.transformAsVector(i.slice(0,3)),s=t.transformAsVector(i.slice(3,6)),c=t.transformAsVector(i.slice(6,9)),l=new W0([o[0],o[1],o[2],s[0],s[1],s[2],c[0],c[1],c[2]]);return Cet(r)?(r.center=n,r.halfAxes=l,r):new qh(n,l)}function iLt(e,t,r){let n=new nn(e[0],e[1],e[2]);t.transform(n,n);let i=t.getScale(AP),o=Math.max(Math.max(i[0],i[1]),i[2]),s=e[3]*o;return Cet(r)?(r.center=n,r.radius=s,r):new eh(n,s)}function oLt(e){let[t,r,n,i,o,s]=e,c=Si.WGS84.cartographicToCartesian([Ju(t),Ju(i),o],rLt),l=Si.WGS84.cartographicToCartesian([Ju(n),Ju(r),s],nLt),h=new nn().addVectors(c,l).multiplyByScalar(.5);return Si.WGS84.cartesianToCartographic(h,q0),Si.WGS84.cartographicToCartesian([Ju(n),q0[1],q0[2]],Tet),Si.WGS84.cartographicToCartesian([q0[0],Ju(i),q0[2]],Eet),Si.WGS84.cartographicToCartesian([q0[0],q0[1],s],Met),Iet([...h,...Tet.subtract(h),...Eet.subtract(h),...Met.subtract(h)],new Ho)}function sLt(e){let t=Ret(),{halfAxes:r}=e,n=new nn(r.getColumn(0)),i=new nn(r.getColumn(1)),o=new nn(r.getColumn(2));for(let s=0;s<2;s++){for(let c=0;c<2;c++){for(let l=0;l<2;l++)Yc.copy(e.center),Yc.add(n),Yc.add(i),Yc.add(o),Let(t,Yc),o.negate();i.negate()}n.negate()}return t}function aLt(e){let t=Ret(),{center:r,radius:n}=e,i=Si.WGS84.scaleToGeodeticSurface(r,Yc),o;i?o=Si.WGS84.geodeticSurfaceNormal(i):o=new nn(0,0,1);let s=new nn(o[2],-o[1],0);s.len()>0?s.normalize():s=new nn(0,1,0);let c=s.clone().cross(o);for(let l of[s,c,o]){AP.copy(l).scale(n);for(let h=0;h<2;h++)Yc.copy(r),Yc.add(AP),Let(t,Yc),AP.negate()}return t}function Ret(){return[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]]}function Let(e,t){Si.WGS84.cartesianToCartographic(t,Yc),e[0][0]=Math.min(e[0][0],Yc[0]),e[0][1]=Math.min(e[0][1],Yc[1]),e[0][2]=Math.min(e[0][2],Yc[2]),e[1][0]=Math.max(e[1][0],Yc[0]),e[1][1]=Math.max(e[1][1],Yc[1]),e[1][2]=Math.max(e[1][2],Yc[2])}var OSe=new nn,BSe=new nn,DSe=new Ho,NSe=new nn,kSe=new nn,FSe=new nn;function cLt(e,t){let r=e*t;return 1-Math.exp(-(r*r))}function lLt(e,t){if(e.dynamicScreenSpaceError&&e.dynamicScreenSpaceErrorComputedDensity){let r=e.dynamicScreenSpaceErrorComputedDensity,n=e.dynamicScreenSpaceErrorFactor;return cLt(t,r)*n}return 0}function Oet(e,t,r){let n=e.tileset,i=e.parent&&e.parent.lodMetricValue||e.lodMetricValue,o=r?i:e.lodMetricValue;if(o===0)return 0;let s=Math.max(e._distanceToCamera,1e-7),{height:c,sseDenominator:l}=t,{viewDistanceScale:h}=n.options,p=o*c*(h||1)/(s*l);return p-=lLt(n,s),p}var _F=new nn,Bet=new nn,Gm=new nn,Det=new nn,uLt=new nn,yF=new Ho,Net=new Ho;function ket(e,t){if(e.lodMetricValue===0||isNaN(e.lodMetricValue))return"DIG";let r=2*xF(e,t);return r<2?"OUT":!e.header.children||r<=e.lodMetricValue?"DRAW":e.header.children?"DIG":"OUT"}function xF(e,t){let{topDownViewport:r}=t,n=e.header.mbs[1],i=e.header.mbs[0],o=e.header.mbs[2],s=e.header.mbs[3],c=[...e.boundingVolume.center],l=r.unprojectPosition(r.cameraPosition);Si.WGS84.cartographicToCartesian(l,_F),Bet.copy(_F).subtract(c).normalize(),Si.WGS84.eastNorthUpToFixedFrame(c,yF),Net.copy(yF).invert(),Gm.copy(_F).transform(Net);let h=Math.sqrt(Gm[0]*Gm[0]+Gm[1]*Gm[1]),p=h*h/Gm[2];Det.copy([Gm[0],Gm[1],p]);let w=Det.transform(yF).subtract(c).normalize(),P=Bet.cross(w).normalize().scale(s).add(c),B=Si.WGS84.cartesianToCartographic(P),D=r.project([i,n,o]),W=r.project(B);return uLt.copy(D).subtract(W).magnitude()}function Fet(e){return{assetGltfUpAxis:e.asset&&e.asset.gltfUpAxis||"Y"}}var yw=class{_map=new Map;_array;_length;constructor(t=0){this._array=new Array(t),this._length=t}get length(){return this._length}set length(t){this._length=t,t>this._array.length&&(this._array.length=t)}get values(){return this._array}get(t){return Ti(t<this._array.length),this._array[t]}set(t,r){Ti(t>=0),t>=this.length&&(this.length=t+1),this._map.has(this._array[t])&&this._map.delete(this._array[t]),this._array[t]=r,this._map.set(r,t)}delete(t){let r=this._map.get(t);r>=0&&(this._array.splice(r,1),this._map.delete(t),this.length--)}peek(){return this._array[this._length-1]}push(t){if(!this._map.has(t)){let r=this.length++;this._array[r]=t,this._map.set(t,r)}}pop(){let t=this._array[--this.length];return this._map.delete(t),t}reserve(t){Ti(t>=0),t>this._array.length&&(this._array.length=t)}resize(t){Ti(t>=0),this.length=t}trim(t){t==null&&(t=this.length),this._array.length=t}reset(){this._array=[],this._map=new Map,this._length=0}find(t){return this._map.has(t)}};var hLt={loadSiblings:!1,skipLevelOfDetail:!1,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""},rp=class{options;root=null;selectedTiles={};requestedTiles={};emptyTiles={};lastUpdate=new Date().getTime();updateDebounceTime=1e3;_traversalStack=new yw;_emptyTraversalStack=new yw;_frameNumber=null;traversalFinished(t){return!0}constructor(t){this.options={...hLt,...t}}traverse(t,r,n){this.root=t,this.options={...this.options,...n},this.reset(),this.updateTile(t,r),this._frameNumber=r.frameNumber,this.executeTraversal(t,r)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(t,r){let n=this._traversalStack;for(t._selectionDepth=1,n.push(t);n.length>0;){let o=n.pop(),s=!1;this.canTraverse(o,r)&&(this.updateChildTiles(o,r),s=this.updateAndPushChildren(o,r,n,o.hasRenderContent?o._selectionDepth+1:o._selectionDepth));let c=o.parent,l=Boolean(!c||c._shouldRefine),h=!s;o.hasRenderContent?o.refine===Xc.ADD?(this.loadTile(o,r),this.selectTile(o,r)):o.refine===Xc.REPLACE&&(this.loadTile(o,r),h&&this.selectTile(o,r)):(this.emptyTiles[o.id]=o,this.loadTile(o,r),h&&this.selectTile(o,r)),this.touchTile(o,r),o._shouldRefine=s&&l}let i=new Date().getTime();(this.traversalFinished(r)||i-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=i,this.options.onTraversalEnd(r))}updateChildTiles(t,r){let n=t.children;for(let i of n)this.updateTile(i,r)}updateAndPushChildren(t,r,n,i){let{loadSiblings:o,skipLevelOfDetail:s}=this.options,c=t.children;c.sort(this.compareDistanceToCamera.bind(this));let l=t.refine===Xc.REPLACE&&t.hasRenderContent&&!s,h=!1,p=!0;for(let x of c)if(x._selectionDepth=i,x.isVisibleAndInRequestVolume?(n.find(x)&&n.delete(x),n.push(x),h=!0):(l||o)&&(this.loadTile(x,r),this.touchTile(x,r)),l){let w;if(x._inRequestVolume?x.hasRenderContent?w=x.contentAvailable:w=this.executeEmptyTraversal(x,r):w=!1,p=p&&w,!p)return!1}return h||(p=!1),p}updateTile(t,r){this.updateTileVisibility(t,r)}selectTile(t,r){this.shouldSelectTile(t)&&(t._selectedFrame=r.frameNumber,this.selectedTiles[t.id]=t)}loadTile(t,r){this.shouldLoadTile(t)&&(t._requestedFrame=r.frameNumber,t._priority=t._getPriority(),this.requestedTiles[t.id]=t)}touchTile(t,r){t.tileset._cache.touch(t),t._touchedFrame=r.frameNumber}canTraverse(t,r,n=!1,i=!1){return t.hasChildren?t.hasTilesetContent?!t.contentExpired:!i&&!t.isVisibleAndInRequestVolume?!1:this.shouldRefine(t,r,n):!1}shouldLoadTile(t){return t.hasUnloadedContent||t.contentExpired}shouldSelectTile(t){return t.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(t,r,n=!1){let i=t._screenSpaceError;return n&&(i=t.getScreenSpaceError(r,!0)),i>t.tileset.memoryAdjustedScreenSpaceError}updateTileVisibility(t,r){let n=[];if(this.options.viewportTraversersMap)for(let i in this.options.viewportTraversersMap)this.options.viewportTraversersMap[i]===r.viewport.id&&n.push(i);else n.push(r.viewport.id);t.updateVisibility(r,n)}compareDistanceToCamera(t,r){return t._distanceToCamera-r._distanceToCamera}anyChildrenVisible(t,r){let n=!1;for(let i of t.children)i.updateVisibility(r),n=n||i.isVisibleAndInRequestVolume;return n}executeEmptyTraversal(t,r){let n=!0,i=this._emptyTraversalStack;for(i.push(t);i.length>0;){let o=i.pop(),s=!o.hasRenderContent&&this.canTraverse(o,r,!1,!1),c=!o.hasRenderContent&&o.children.length===0;if(!s&&!o.contentAvailable&&!c&&(n=!1),this.updateTile(o,r),o.isVisibleAndInRequestVolume||(this.loadTile(o,r),this.touchTile(o,r)),s){let l=o.children;for(let h of l)i.push(h)}}return n}};var zet=new nn;function fLt(e){return e!=null}var G0=class{tileset;header;id;url;parent;refine;type;contentUrl;lodMetricType="geometricError";lodMetricValue=0;boundingVolume=null;content=null;contentState=Al.UNLOADED;gpuMemoryUsageInBytes=0;children=[];depth=0;viewportIds=[];transform=new Ho;extensions=null;implicitTiling=null;userData={};computedTransform;hasEmptyContent=!1;hasTilesetContent=!1;traverser=new rp({});_cacheNode=null;_frameNumber=null;_expireDate=null;_expiredContent=null;_boundingBox=void 0;_distanceToCamera=0;_screenSpaceError=0;_visibilityPlaneMask;_visible=void 0;_contentBoundingVolume;_viewerRequestVolume;_initialTransform=new Ho;_priority=0;_selectedFrame=0;_requestedFrame=0;_selectionDepth=0;_touchedFrame=0;_centerZDepth=0;_shouldRefine=!1;_stackLength=0;_visitedFrame=0;_inRequestVolume=!1;_lodJudge=null;constructor(t,r,n,i=""){this.header=r,this.tileset=t,this.id=i||r.id,this.url=r.url,this.parent=n,this.refine=this._getRefine(r.refine),this.type=r.type,this.contentUrl=r.contentUrl,this._initializeLodMetric(r),this._initializeTransforms(r),this._initializeBoundingVolumes(r),this._initializeContent(r),this._initializeRenderingState(r),Object.seal(this)}destroy(){this.header=null}isDestroyed(){return this.header===null}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return this.contentState===Al.READY||this.hasEmptyContent}get contentAvailable(){return Boolean(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return this.contentState===Al.UNLOADED}get contentExpired(){return this.contentState===Al.EXPIRED}get contentFailed(){return this.contentState===Al.FAILED}get distanceToCamera(){return this._distanceToCamera}get screenSpaceError(){return this._screenSpaceError}get boundingBox(){return this._boundingBox||(this._boundingBox=Pet(this.header.boundingVolume,this.boundingVolume)),this._boundingBox}getScreenSpaceError(t,r){switch(this.tileset.type){case oc.I3S:return xF(this,t);case oc.TILES3D:return Oet(this,t,r);default:throw new Error("Unsupported tileset type")}}unselect(){this._selectedFrame=0}_getGpuMemoryUsageInBytes(){return this.content.gpuMemoryUsageInBytes||this.content.byteLength||0}_getPriority(){let t=this.tileset._traverser,{skipLevelOfDetail:r}=t.options,n=this.refine===Xc.ADD||r;if(n&&!this.isVisible&&this._visible!==void 0||this.tileset._frameNumber-this._touchedFrame>=1||this.contentState===Al.UNLOADED)return-1;let i=this.parent,s=i&&(!n||this._screenSpaceError===0||i.hasTilesetContent)?i._screenSpaceError:this._screenSpaceError,c=t.root?t.root._screenSpaceError:0;return Math.max(c-s,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=Al.LOADING;let r=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!r)return this.contentState=Al.UNLOADED,!1;try{let n=this.tileset.getTileUrl(this.contentUrl),i=this.tileset.loader,o={...this.tileset.loadOptions,[i.id]:{...this.tileset.loadOptions[i.id],isTileset:this.type==="json",...this._getLoaderSpecificOptions(i.id)}};return this.content=await xa(n,i,o),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=Al.READY,this._onContentLoaded(),!0}catch(n){throw this.contentState=Al.FAILED,n}finally{r.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=Al.UNLOADED,!0}updateVisibility(t,r){if(this._frameNumber===t.frameNumber)return;let n=this.parent,i=n?n._visibilityPlaneMask:ic.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){let o=n?n.computedTransform:this.tileset.modelMatrix;this._updateTransform(o)}this._distanceToCamera=this.distanceToTile(t),this._screenSpaceError=this.getScreenSpaceError(t,!1),this._visibilityPlaneMask=this.visibility(t,i),this._visible=this._visibilityPlaneMask!==ic.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(t),this._frameNumber=t.frameNumber,this.viewportIds=r}visibility(t,r){let{cullingVolume:n}=t,{boundingVolume:i}=this;return n.computeVisibilityWithPlaneMask(i,r)}contentVisibility(){return!0}distanceToTile(t){let r=this.boundingVolume;return Math.sqrt(Math.max(r.distanceSquaredTo(t.camera.position),0))}cameraSpaceZDepth({camera:t}){let r=this.boundingVolume;return zet.subVectors(r.center,t.position),t.direction.dot(zet)}insideViewerRequestVolume(t){let r=this._viewerRequestVolume;return!r||r.distanceSquaredTo(t.camera.position)<=0}updateExpiration(){if(fLt(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){let t=Date.now();Date.lessThan(this._expireDate,t)&&(this.contentState=Al.EXPIRED,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(t){"lodMetricType"in t?this.lodMetricType=t.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in t?this.lodMetricValue=t.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(t){this.transform=t.transform?new Ho(t.transform):new Ho;let r=this.parent,n=this.tileset,i=r&&r.computedTransform?r.computedTransform.clone():n.modelMatrix.clone();this.computedTransform=new Ho(i).multiplyRight(this.transform);let o=r&&r._initialTransform?r._initialTransform.clone():new Ho;this._initialTransform=new Ho(o).multiplyRight(this.transform)}_initializeBoundingVolumes(t){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(t)}_initializeContent(t){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=Al.UNLOADED,this.hasTilesetContent=!1,t.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(t){this.depth=t.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=ic.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(t){return t||this.parent&&this.parent.refine||Xc.REPLACE}_isTileset(){return this.contentUrl.indexOf(".json")!==-1}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0;break;default:}this._isTileset()?this.hasTilesetContent=!0:this.gpuMemoryUsageInBytes=this._getGpuMemoryUsageInBytes()}_updateBoundingVolume(t){this.boundingVolume=gP(t.boundingVolume,this.computedTransform,this.boundingVolume);let r=t.content;r&&(r.boundingVolume&&(this._contentBoundingVolume=gP(r.boundingVolume,this.computedTransform,this._contentBoundingVolume)),t.viewerRequestVolume&&(this._viewerRequestVolume=gP(t.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(t=new Ho){let r=t.clone().multiplyRight(this.transform);r.equals(this.computedTransform)||(this.computedTransform=r,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(t){switch(t){case"i3s":return{...this.tileset.options.i3s,_tileOptions:{attributeUrls:this.header.attributeUrls,textureUrl:this.header.textureUrl,textureFormat:this.header.textureFormat,textureLoaderOptions:this.header.textureLoaderOptions,materialDefinition:this.header.materialDefinition,isDracoGeometry:this.header.isDracoGeometry,mbs:this.header.mbs},_tilesetOptions:{store:this.tileset.tileset.store,attributeStorageInfo:this.tileset.tileset.attributeStorageInfo,fields:this.tileset.tileset.fields},isTileHeader:!1};case"3d-tiles":case"cesium-ion":default:return Fet(this.tileset.tileset)}}};var _P=class extends rp{compareDistanceToCamera(t,r){return r._distanceToCamera===0&&t._distanceToCamera===0?r._centerZDepth-t._centerZDepth:r._distanceToCamera-t._distanceToCamera}updateTileVisibility(t,r){if(super.updateTileVisibility(t,r),!t.isVisibleAndInRequestVolume)return;let n=t.children.length>0;if(t.hasTilesetContent&&n){let s=t.children[0];this.updateTileVisibility(s,r),t._visible=s._visible;return}if(this.meetsScreenSpaceErrorEarly(t,r)){t._visible=!1;return}let i=t.refine===Xc.REPLACE,o=t._optimChildrenWithinParent===wet.USE_OPTIMIZATION;if(i&&o&&n&&!this.anyChildrenVisible(t,r)){t._visible=!1;return}}meetsScreenSpaceErrorEarly(t,r){let{parent:n}=t;return!n||n.hasTilesetContent||n.refine!==Xc.ADD?!1:!this.shouldRefine(t,r,!0)}};var yP=class{frameNumberMap=new Map;register(t,r){let n=this.frameNumberMap.get(t)||new Map,i=n.get(r)||0;n.set(r,i+1),this.frameNumberMap.set(t,n)}deregister(t,r){let n=this.frameNumberMap.get(t);if(!n)return;let i=n.get(r)||1;n.set(r,i-1)}isZero(t,r){return(this.frameNumberMap.get(t)?.get(r)||0)===0}};var vF={REQUESTED:"REQUESTED",COMPLETED:"COMPLETED",ERROR:"ERROR"},xP=class{_statusMap;pendingTilesRegister=new yP;constructor(){this._statusMap={}}add(t,r,n,i){if(!this._statusMap[r]){let{frameNumber:o,viewport:{id:s}}=i;this._statusMap[r]={request:t,callback:n,key:r,frameState:i,status:vF.REQUESTED},this.pendingTilesRegister.register(s,o),t().then(c=>{this._statusMap[r].status=vF.COMPLETED;let{frameNumber:l,viewport:{id:h}}=this._statusMap[r].frameState;this.pendingTilesRegister.deregister(h,l),this._statusMap[r].callback(c,i)}).catch(c=>{this._statusMap[r].status=vF.ERROR;let{frameNumber:l,viewport:{id:h}}=this._statusMap[r].frameState;this.pendingTilesRegister.deregister(h,l),n(c)})}}update(t,r){if(this._statusMap[t]){let{frameNumber:n,viewport:{id:i}}=this._statusMap[t].frameState;this.pendingTilesRegister.deregister(i,n);let{frameNumber:o,viewport:{id:s}}=r;this.pendingTilesRegister.register(s,o),this._statusMap[t].frameState=r}}find(t){return this._statusMap[t]}hasPendingTiles(t,r){return!this.pendingTilesRegister.isZero(t,r)}};var vP=class extends rp{_tileManager;constructor(t){super(t),this._tileManager=new xP}traversalFinished(t){return!this._tileManager.hasPendingTiles(t.viewport.id,this._frameNumber||0)}shouldRefine(t,r){return t._lodJudge=ket(t,r),t._lodJudge==="DIG"}updateChildTiles(t,r){let n=t.header.children||[],i=t.children,o=t.tileset;for(let s of n){let c=`${s.id}-${r.viewport.id}`,l=i&&i.find(h=>h.id===c);if(l)l&&this.updateTile(l,r);else{let h=()=>this._loadTile(s.id,o);this._tileManager.find(c)?this._tileManager.update(c,r):(o.tileset.nodePages&&(h=()=>o.tileset.nodePagesTile.formTileFromNodePages(s.id)),this._tileManager.add(h,c,x=>this._onTileLoad(x,t,c),r))}}return!1}async _loadTile(t,r){let{loader:n}=r,i=r.getTileUrl(`${r.url}/nodes/${t}`),o={...r.loadOptions,i3s:{...r.loadOptions.i3s,isTileHeader:!0}};return await xa(i,n,o)}_onTileLoad(t,r,n){let i=new G0(r.tileset,t,r,n);r.children.push(i);let o=this._tileManager.find(i.id).frameState;this.updateTile(i,o),this._frameNumber===o.frameNumber&&(this.traversalFinished(o)||new Date().getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(i,o)}};var pLt={description:"",ellipsoid:Si.WGS84,modelMatrix:new Ho,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,memoryCacheOverflow:1,maximumTilesSelected:0,debounceTime:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:e=>e,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,memoryAdjustedScreenSpaceError:!1,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},bP="Tiles In Tileset(s)",bF="Tiles In Memory",Uet="Tiles In View",Vet="Tiles To Render",jet="Tiles Loaded",wF="Tiles Loading",Het="Tiles Unloaded",Wet="Failed Tile Loads",qet="Points/Vertices",TF="Tile Memory Use",Get="Maximum Screen Space Error",xw=class{options;loadOptions;type;tileset;loader;url;basePath;modelMatrix;ellipsoid;lodMetricType;lodMetricValue;refine;root=null;roots={};asset={};description="";properties;extras=null;attributions={};credits={};stats;contentFormats={draco:!1,meshopt:!1,dds:!1,ktx2:!1};cartographicCenter=null;cartesianCenter=null;zoom=1;boundingVolume=null;dynamicScreenSpaceErrorComputedDensity=0;maximumMemoryUsage=32;gpuMemoryUsageInBytes=0;memoryAdjustedScreenSpaceError=0;_cacheBytes=0;_cacheOverflowBytes=0;_frameNumber=0;_queryParams={};_extensionsUsed=[];_tiles={};_pendingCount=0;selectedTiles=[];traverseCounter=0;geometricError=0;lastUpdatedVieports=null;_requestedTiles=[];_emptyTiles=[];frameStateData={};_traverser;_cache=new tP;_requestScheduler;updatePromise=null;tilesetInitializationPromise;constructor(t,r){this.options={...pLt,...r},this.tileset=t,this.loader=t.loader,this.type=t.type,this.url=t.url,this.basePath=t.basePath||ou.dirname(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=t.lodMetricType,this.lodMetricValue=t.lodMetricValue,this.refine=t.root.refine,this.loadOptions=this.options.loadOptions||{},this._traverser=this._initializeTraverser(),this._requestScheduler=new $d({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this.memoryAdjustedScreenSpaceError=this.options.maximumScreenSpaceError,this._cacheBytes=this.options.maximumMemoryUsage*1024*1024,this._cacheOverflowBytes=this.options.memoryCacheOverflow*1024*1024,this.stats=new Nc({id:this.url}),this._initializeStats(),this.tilesetInitializationPromise=this._initializeTileSet(t)}destroy(){this._destroy()}isLoaded(){return this._pendingCount===0&&this._frameNumber!==0&&this._requestedTiles.length===0}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return new URLSearchParams(this._queryParams).toString()}setProps(t){this.options={...this.options,...t}}getTileUrl(t){if(t.startsWith("data:"))return t;let n=t;return this.queryParams.length&&(n=`${t}${t.includes("?")?"&":"?"}${this.queryParams}`),n}hasExtension(t){return Boolean(this._extensionsUsed.indexOf(t)>-1)}update(t=null){this.tilesetInitializationPromise.then(()=>{!t&&this.lastUpdatedVieports?t=this.lastUpdatedVieports:this.lastUpdatedVieports=t,t&&this.doUpdate(t)})}async selectTiles(t=null){return await this.tilesetInitializationPromise,t&&(this.lastUpdatedVieports=t),this.updatePromise||(this.updatePromise=new Promise(r=>{setTimeout(()=>{this.lastUpdatedVieports&&this.doUpdate(this.lastUpdatedVieports),r(this._frameNumber),this.updatePromise=null},this.options.debounceTime)})),this.updatePromise}adjustScreenSpaceError(){this.gpuMemoryUsageInBytes<this._cacheBytes?this.memoryAdjustedScreenSpaceError=Math.max(this.memoryAdjustedScreenSpaceError/1.02,this.options.maximumScreenSpaceError):this.gpuMemoryUsageInBytes>this._cacheBytes+this._cacheOverflowBytes&&(this.memoryAdjustedScreenSpaceError*=1.02)}doUpdate(t){if("loadTiles"in this.options&&!this.options.loadTiles||this.traverseCounter>0)return;let r=t instanceof Array?t:[t];this._cache.reset(),this._frameNumber++,this.traverseCounter=r.length;let n=[];for(let i of r){let o=i.id;this._needTraverse(o)?n.push(o):this.traverseCounter--}for(let i of r){let o=i.id;if(this.roots[o]||(this.roots[o]=this._initializeTileHeaders(this.tileset,null)),!n.includes(o))continue;let s=yet(i,this._frameNumber);this._traverser.traverse(this.roots[o],s,this.options)}}_needTraverse(t){let r=t;return this.options.viewportTraversersMap&&(r=this.options.viewportTraversersMap[t]),r===t}_onTraversalEnd(t){let r=t.viewport.id;this.frameStateData[r]||(this.frameStateData[r]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});let n=this.frameStateData[r],i=Object.values(this._traverser.selectedTiles),[o,s]=xet(i,t,this.options.maximumTilesSelected);n.selectedTiles=o;for(let c of s)c.unselect();n._requestedTiles=Object.values(this._traverser.requestedTiles),n._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,!(this.traverseCounter>0)&&this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(let t in this.frameStateData){let r=this.frameStateData[t];this.selectedTiles=this.selectedTiles.concat(r.selectedTiles),this._requestedTiles=this._requestedTiles.concat(r._requestedTiles),this._emptyTiles=this._emptyTiles.concat(r._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(let t of this.selectedTiles)this._tiles[t.id]=t;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(t,r){if(t.length!==r.length)return!0;let n=new Set(t.map(s=>s.id)),i=new Set(r.map(s=>s.id)),o=t.filter(s=>!i.has(s.id)).length>0;return o=o||r.filter(s=>!n.has(s.id)).length>0,o}_loadTiles(){for(let t of this._requestedTiles)t.contentUnloaded&&this._loadTile(t)}_unloadTiles(){this._cache.unloadTiles(this,(t,r)=>t._unloadTile(r))}_updateStats(){let t=0,r=0;for(let n of this.selectedTiles)n.contentAvailable&&n.content&&(t++,n.content.pointCount?r+=n.content.pointCount:r+=n.content.vertexCount);this.stats.get(Uet).count=this.selectedTiles.length,this.stats.get(Vet).count=t,this.stats.get(qet).count=r,this.stats.get(Get).count=this.memoryAdjustedScreenSpaceError}async _initializeTileSet(t){this.type===oc.I3S&&(this.calculateViewPropsI3S(),t.root=await t.root),this.root=this._initializeTileHeaders(t,null),this.type===oc.TILES3D&&(this._initializeTiles3DTileset(t),this.calculateViewPropsTiles3D()),this.type===oc.I3S&&this._initializeI3STileset()}calculateViewPropsI3S(){let t=this.tileset.fullExtent;if(t){let{xmin:n,xmax:i,ymin:o,ymax:s,zmin:c,zmax:l}=t;this.cartographicCenter=new nn(n+(i-n)/2,o+(s-o)/2,c+(l-c)/2),this.cartesianCenter=new nn,Si.WGS84.cartographicToCartesian(this.cartographicCenter,this.cartesianCenter),this.zoom=gF(t,this.cartographicCenter,this.cartesianCenter);return}let r=this.tileset.store?.extent;if(r){let[n,i,o,s]=r;this.cartographicCenter=new nn(n+(o-n)/2,i+(s-i)/2,0),this.cartesianCenter=new nn,Si.WGS84.cartographicToCartesian(this.cartographicCenter,this.cartesianCenter),this.zoom=bet(r,this.cartographicCenter,this.cartesianCenter);return}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new nn,this.zoom=1}calculateViewPropsTiles3D(){let t=this.root,{center:r}=t.boundingVolume;if(!r){console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new nn,this.zoom=1;return}r[0]!==0||r[1]!==0||r[2]!==0?(this.cartographicCenter=new nn,Si.WGS84.cartesianToCartographic(r,this.cartographicCenter)):this.cartographicCenter=new nn(0,0,-Si.WGS84.radii[0]),this.cartesianCenter=r,this.zoom=vet(t.boundingVolume,this.cartographicCenter)}_initializeStats(){this.stats.get(bP),this.stats.get(wF),this.stats.get(bF),this.stats.get(Uet),this.stats.get(Vet),this.stats.get(jet),this.stats.get(Het),this.stats.get(Wet),this.stats.get(qet),this.stats.get(TF,"memory"),this.stats.get(Get)}_initializeTileHeaders(t,r){let n=new G0(this,t.root,r);if(r&&(r.children.push(n),n.depth=r.depth+1),this.type===oc.TILES3D){let i=[];for(i.push(n);i.length>0;){let o=i.pop();this.stats.get(bP).incrementCount();let s=o.header.children||[];for(let c of s){let l=new G0(this,c,o);if(l.contentUrl?.includes("?session=")){let p=new URL(l.contentUrl).searchParams.get("session");p&&(this._queryParams.session=p)}o.children.push(l),l.depth=o.depth+1,i.push(l)}}}return n}_initializeTraverser(){let t;switch(this.type){case oc.TILES3D:t=_P;break;case oc.I3S:t=vP;break;default:t=rp}return new t({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(t){this._destroySubtree(t)}async _loadTile(t){let r;try{this._onStartTileLoading(),r=await t.loadContent()}catch(n){this._onTileLoadError(t,n instanceof Error?n:new Error("load failed"))}finally{this._onEndTileLoading(),this._onTileLoad(t,r)}}_onTileLoadError(t,r){this.stats.get(Wet).incrementCount();let n=r.message||r.toString(),i=t.url;console.error(`A 3D tile failed to load: ${t.url} ${n}`),this.options.onTileError(t,n,i)}_onTileLoad(t,r){if(r){if(this.type===oc.I3S){let n=this.tileset?.nodePagesTile?.nodesInNodePages||0;this.stats.get(bP).reset(),this.stats.get(bP).addCount(n)}t&&t.content&&ptt(t,t.content),this.updateContentTypes(t),this._addTileToCache(t),this.options.onTileLoad(t)}}updateContentTypes(t){if(this.type===oc.I3S)switch(t.header.isDracoGeometry&&(this.contentFormats.draco=!0),t.header.textureFormat){case"dds":this.contentFormats.dds=!0;break;case"ktx2":this.contentFormats.ktx2=!0;break;default:}else if(this.type===oc.TILES3D){let{extensionsRemoved:r=[]}=t.content?.gltf||{};r.includes("KHR_draco_mesh_compression")&&(this.contentFormats.draco=!0),r.includes("EXT_meshopt_compression")&&(this.contentFormats.meshopt=!0),r.includes("KHR_texture_basisu")&&(this.contentFormats.ktx2=!0)}}_onStartTileLoading(){this._pendingCount++,this.stats.get(wF).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(wF).decrementCount()}_addTileToCache(t){this._cache.add(this,t,r=>r._updateCacheStats(t))}_updateCacheStats(t){this.stats.get(jet).incrementCount(),this.stats.get(bF).incrementCount(),this.gpuMemoryUsageInBytes+=t.gpuMemoryUsageInBytes||0,this.stats.get(TF).count=this.gpuMemoryUsageInBytes,this.options.memoryAdjustedScreenSpaceError&&this.adjustScreenSpaceError()}_unloadTile(t){this.gpuMemoryUsageInBytes-=t.gpuMemoryUsageInBytes||0,this.stats.get(bF).decrementCount(),this.stats.get(Het).incrementCount(),this.stats.get(TF).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(t),t.unloadContent()}_destroy(){let t=[];for(this.root&&t.push(this.root);t.length>0;){let r=t.pop();for(let n of r.children)t.push(n);this._destroyTile(r)}this.root=null}_destroySubtree(t){let r=t,n=[];for(n.push(r);n.length>0;){t=n.pop();for(let i of t.children)n.push(i);t!==r&&this._destroyTile(t)}r.children=[]}_destroyTile(t){this._cache.unloadTile(this,t),this._unloadTile(t),t.destroy()}_initializeTiles3DTileset(t){if(t.queryString){let r=new URLSearchParams(t.queryString),n=Object.fromEntries(r.entries());this._queryParams={...this._queryParams,...n}}if(this.asset=t.asset,!this.asset)throw new Error("Tileset must have an asset property.");if(this.asset.version!=="0.0"&&this.asset.version!=="1.0"&&this.asset.version!=="1.1")throw new Error("The tileset must be 3D Tiles version either 0.0 or 1.0 or 1.1.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=t.properties,this.geometricError=t.geometricError,this._extensionsUsed=t.extensionsUsed||[],this.extras=t.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}};var wP="4.2.1";var X0={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"},D3e=Object.keys(X0);function EF(e,t,r){Ti(e instanceof ArrayBuffer);let n=new TextDecoder("utf8"),i=new Uint8Array(e,t,r);return n.decode(i)}function Xet(e,t=0){let r=new DataView(e);return`${String.fromCharCode(r.getUint8(t+0))}${String.fromCharCode(r.getUint8(t+1))}${String.fromCharCode(r.getUint8(t+2))}${String.fromCharCode(r.getUint8(t+3))}`}var dLt={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},la={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},pi={...dLt,...la};var MF={[la.DOUBLE]:Float64Array,[la.FLOAT]:Float32Array,[la.UNSIGNED_SHORT]:Uint16Array,[la.UNSIGNED_INT]:Uint32Array,[la.UNSIGNED_BYTE]:Uint8Array,[la.BYTE]:Int8Array,[la.SHORT]:Int16Array,[la.INT]:Int32Array},mLt={DOUBLE:la.DOUBLE,FLOAT:la.FLOAT,UNSIGNED_SHORT:la.UNSIGNED_SHORT,UNSIGNED_INT:la.UNSIGNED_INT,UNSIGNED_BYTE:la.UNSIGNED_BYTE,BYTE:la.BYTE,SHORT:la.SHORT,INT:la.INT},SF="Failed to convert GL type",Kc=class{static fromTypedArray(t){t=ArrayBuffer.isView(t)?t.constructor:t;for(let r in MF)if(MF[r]===t)return r;throw new Error(SF)}static fromName(t){let r=mLt[t];if(!r)throw new Error(SF);return r}static getArrayType(t){switch(t){case la.UNSIGNED_SHORT_5_6_5:case la.UNSIGNED_SHORT_4_4_4_4:case la.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:let r=MF[t];if(!r)throw new Error(SF);return r}}static getByteSize(t){return Kc.getArrayType(t).BYTES_PER_ELEMENT}static validate(t){return Boolean(Kc.getArrayType(t))}static createTypedArray(t,r,n=0,i){i===void 0&&(i=(r.byteLength-n)/Kc.getByteSize(t));let o=Kc.getArrayType(t);return new o(r,n,i)}};var j3e=1/Math.PI*180,H3e=1/180*Math.PI,ALt={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...ALt}};var Cc=globalThis.mathgl.config;function CF(e,{precision:t=Cc.precision}={}){return e=gLt(e),`${parseFloat(e.toPrecision(t))}`}function np(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function PF(e,t,r){return yLt(e,n=>Math.max(t,Math.min(r,n)))}function TP(e,t,r){let n=Cc.EPSILON;r&&(Cc.EPSILON=r);try{if(e===t)return!0;if(np(e)&&np(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!TP(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<=Cc.EPSILON*Math.max(1,Math.abs(e),Math.abs(t)):!1}finally{Cc.EPSILON=n}}function gLt(e){return Math.round(e/Cc.EPSILON)*Cc.EPSILON}function _Lt(e){return e.clone?e.clone():new Array(e.length)}function yLt(e,t,r){if(np(e)){let n=e;r=r||_Lt(n);for(let i=0;i<r.length&&i<n.length;++i){let o=typeof e=="number"?e:e[i];r[i]=t(o,i,r)}return r}return t(e)}var EP=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(t,r=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+r];return this.check()}toArray(t=[],r=0){for(let n=0;n<this.ELEMENTS;++n)t[r+n]=this[n];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:np(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Cc)}formatString(t){let r="";for(let n=0;n<this.ELEMENTS;++n)r+=(n>0?", ":"")+CF(this[n],t);return`${t.printTypes?this.constructor.name:""}[${r}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(!TP(this[r],t[r]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==t[r])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,r,n){if(n===void 0)return this.lerp(this,t,r);for(let i=0;i<this.ELEMENTS;++i){let o=t[i],s=typeof r=="number"?r:r[i];this[i]=o+n*(s-o)}return this.check()}min(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(t[r],this[r]);return this.check()}max(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(t[r],this[r]);return this.check()}clamp(t,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),r[n]);return this.check()}add(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]+=r[n];return this.check()}subtract(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]-=r[n];return this.check()}scale(t){if(typeof t=="number")for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;else for(let r=0;r<this.ELEMENTS&&r<t.length;++r)this[r]*=t[r];return this.check()}multiplyByScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}check(){if(Cc.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)t=t&&Number.isFinite(this[r]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=t;return this.check()}addScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),r);return this.check()}get elements(){return this}};function Va(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function IF(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}var l1=class extends EP{get x(){return this[0]}set x(t){this[0]=Va(t)}get y(){return this[1]}set y(t){this[1]=Va(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let r=0;r<this.ELEMENTS;++r)t+=this[r]*this[r];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let r=0;for(let n=0;n<this.ELEMENTS;++n){let i=this[n]-t[n];r+=i*i}return Va(r)}dot(t){let r=0;for(let n=0;n<this.ELEMENTS;++n)r+=this[n]*t[n];return Va(r)}normalize(){let t=this.magnitude();if(t!==0)for(let r=0;r<this.ELEMENTS;++r)this[r]/=t;return this.check()}multiply(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]*=r[n];return this.check()}divide(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]/=r[n];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return IF(t>=0&&t<this.ELEMENTS,"index is out of range"),Va(this[t])}setComponent(t,r){return IF(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=r,this.check()}addVectors(t,r){return this.copy(t).add(r)}subVectors(t,r){return this.copy(t).subtract(r)}multiplyVectors(t,r){return this.copy(t).multiply(r)}addScaledVector(t,r){return this.add(new this.constructor(t).multiplyScalar(r))}};var u1=typeof Float32Array<"u"?Float32Array:Array;var J3e=Math.PI/180;function wLt(){let e=new u1(2);return u1!=Float32Array&&(e[0]=0,e[1]=0),e}function Ket(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e}function Zet(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}function $et(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e}function Qet(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e}var tCe=function(){let e=wLt();return function(t,r,n,i,o,s){let c,l;for(r||(r=2),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],o(e,e,s),t[c]=e[0],t[c+1]=e[1];return t}}();function Jet(e,t,r){let n=t[0],i=t[1],o=r[3]*n+r[7]*i||1;return e[0]=(r[0]*n+r[4]*i)/o,e[1]=(r[1]*n+r[5]*i)/o,e}function trt(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[3]*n+r[7]*i+r[11]*o||1;return e[0]=(r[0]*n+r[4]*i+r[8]*o)/s,e[1]=(r[1]*n+r[5]*i+r[9]*o)/s,e[2]=(r[2]*n+r[6]*i+r[10]*o)/s,e}function ert(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e[2]=t[2],e}var Y0=class extends l1{constructor(t=0,r=0){super(2),np(t)&&arguments.length===1?this.copy(t):(Cc.debug&&(Va(t),Va(r)),this[0]=t,this[1]=r)}set(t,r){return this[0]=t,this[1]=r,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return Cc.debug&&(Va(t.x),Va(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return Qet(this,this,t),this.check()}transformAsVector(t){return Jet(this,this,t),this.check()}transformByMatrix3(t){return $et(this,this,t),this.check()}transformByMatrix2x3(t){return Zet(this,this,t),this.check()}transformByMatrix2(t){return Ket(this,this,t),this.check()}};function TLt(){let e=new u1(3);return u1!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function ELt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function rrt(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[0],c=r[1],l=r[2];return e[0]=i*l-o*c,e[1]=o*s-n*l,e[2]=n*c-i*s,e}function nrt(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[3]*n+r[7]*i+r[11]*o+r[15];return s=s||1,e[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/s,e[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/s,e[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/s,e}function irt(e,t,r){let n=t[0],i=t[1],o=t[2];return e[0]=n*r[0]+i*r[3]+o*r[6],e[1]=n*r[1]+i*r[4]+o*r[7],e[2]=n*r[2]+i*r[5]+o*r[8],e}function ort(e,t,r){let n=r[0],i=r[1],o=r[2],s=r[3],c=t[0],l=t[1],h=t[2],p=i*h-o*l,x=o*c-n*h,w=n*l-i*c,E=i*w-o*x,P=o*p-n*w,B=n*x-i*p,D=s*2;return p*=D,x*=D,w*=D,E*=2,P*=2,B*=2,e[0]=c+p+E,e[1]=l+x+P,e[2]=h+w+B,e}function srt(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function art(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function crt(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function lrt(e,t){let r=e[0],n=e[1],i=e[2],o=t[0],s=t[1],c=t[2],l=Math.sqrt((r*r+n*n+i*i)*(o*o+s*s+c*c)),h=l&&ELt(e,t)/l;return Math.acos(Math.min(Math.max(h,-1),1))}var lCe=function(){let e=TLt();return function(t,r,n,i,o,s){let c,l;for(r||(r=3),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],o(e,e,s),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2];return t}}();var RF=[0,0,0],MP,K0=class extends l1{static get ZERO(){return MP||(MP=new K0(0,0,0),Object.freeze(MP)),MP}constructor(t=0,r=0,n=0){super(-0,-0,-0),arguments.length===1&&np(t)?this.copy(t):(Cc.debug&&(Va(t),Va(r),Va(n)),this[0]=t,this[1]=r,this[2]=n)}set(t,r,n){return this[0]=t,this[1]=r,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return Cc.debug&&(Va(t.x),Va(t.y),Va(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=Va(t)}angle(t){return lrt(this,t)}cross(t){return rrt(this,this,t),this.check()}rotateX({radians:t,origin:r=RF}){return srt(this,this,r,t),this.check()}rotateY({radians:t,origin:r=RF}){return art(this,this,r,t),this.check()}rotateZ({radians:t,origin:r=RF}){return crt(this,this,r,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return nrt(this,this,t),this.check()}transformAsVector(t){return trt(this,this,t),this.check()}transformByMatrix3(t){return irt(this,this,t),this.check()}transformByMatrix2(t){return ert(this,this,t),this.check()}transformByQuaternion(t){return ort(this,this,t),this.check()}};function urt(e,t){if(!e)throw new Error(`math.gl assertion failed. ${t}`)}function LF(e,t=[0,0,0]){let r=e>>11&31,n=e>>5&63,i=e&31;return t[0]=r<<3,t[1]=n<<2,t[2]=i<<3,t}var VCe=1/256;var jCe=new Y0,HCe=new K0,WCe=new Y0,qCe=new Y0,GCe=new Uint8Array(1);function hrt(e,t=255){return PF(e,0,t)/t*2-1}function frt(e){return e<0?-1:1}function prt(e,t,r,n){if(urt(n),e<0||e>r||t<0||t>r)throw new Error(`x and y must be unsigned normalized integers between 0 and ${r}`);if(n.x=hrt(e,r),n.y=hrt(t,r),n.z=1-(Math.abs(n.x)+Math.abs(n.y)),n.z<0){let i=n.x;n.x=(1-Math.abs(n.y))*frt(i),n.y=(1-Math.abs(i))*frt(n.y)}return n.normalize()}function OF(e,t,r){return prt(e,t,255,r)}var fPe=1/Math.PI*180,pPe=1/180*Math.PI,MLt={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...MLt}};var Ea=globalThis.mathgl.config;function drt(e,{precision:t=Ea.precision}={}){return e=SLt(e),`${parseFloat(e.toPrecision(t))}`}function Xm(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function BF(e,t,r){let n=Ea.EPSILON;r&&(Ea.EPSILON=r);try{if(e===t)return!0;if(Xm(e)&&Xm(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!BF(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<=Ea.EPSILON*Math.max(1,Math.abs(e),Math.abs(t)):!1}finally{Ea.EPSILON=n}}function SLt(e){return Math.round(e/Ea.EPSILON)*Ea.EPSILON}var Ym=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(t,r=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+r];return this.check()}toArray(t=[],r=0){for(let n=0;n<this.ELEMENTS;++n)t[r+n]=this[n];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:Xm(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Ea)}formatString(t){let r="";for(let n=0;n<this.ELEMENTS;++n)r+=(n>0?", ":"")+drt(this[n],t);return`${t.printTypes?this.constructor.name:""}[${r}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(!BF(this[r],t[r]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==t[r])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,r,n){if(n===void 0)return this.lerp(this,t,r);for(let i=0;i<this.ELEMENTS;++i){let o=t[i],s=typeof r=="number"?r:r[i];this[i]=o+n*(s-o)}return this.check()}min(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(t[r],this[r]);return this.check()}max(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(t[r],this[r]);return this.check()}clamp(t,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),r[n]);return this.check()}add(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]+=r[n];return this.check()}subtract(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]-=r[n];return this.check()}scale(t){if(typeof t=="number")for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;else for(let r=0;r<this.ELEMENTS&&r<t.length;++r)this[r]*=t[r];return this.check()}multiplyByScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}check(){if(Ea.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)t=t&&Number.isFinite(this[r]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=t;return this.check()}addScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),r);return this.check()}get elements(){return this}};function CLt(e,t){if(e.length!==t)return!1;for(let r=0;r<e.length;++r)if(!Number.isFinite(e[r]))return!1;return!0}function so(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function Km(e,t,r=""){if(Ea.debug&&!CLt(e,t))throw new Error(`math.gl: ${r} some fields set to invalid numbers'`);return e}function DF(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}var h1=class extends Ym{get x(){return this[0]}set x(t){this[0]=so(t)}get y(){return this[1]}set y(t){this[1]=so(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let r=0;r<this.ELEMENTS;++r)t+=this[r]*this[r];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let r=0;for(let n=0;n<this.ELEMENTS;++n){let i=this[n]-t[n];r+=i*i}return so(r)}dot(t){let r=0;for(let n=0;n<this.ELEMENTS;++n)r+=this[n]*t[n];return so(r)}normalize(){let t=this.magnitude();if(t!==0)for(let r=0;r<this.ELEMENTS;++r)this[r]/=t;return this.check()}multiply(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]*=r[n];return this.check()}divide(...t){for(let r of t)for(let n=0;n<this.ELEMENTS;++n)this[n]/=r[n];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return DF(t>=0&&t<this.ELEMENTS,"index is out of range"),so(this[t])}setComponent(t,r){return DF(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=r,this.check()}addVectors(t,r){return this.copy(t).add(r)}subVectors(t,r){return this.copy(t).subtract(r)}multiplyVectors(t,r){return this.copy(t).multiply(r)}addScaledVector(t,r){return this.add(new this.constructor(t).multiplyScalar(r))}};var Zc=typeof Float32Array<"u"?Float32Array:Array;var TPe=Math.PI/180;function PLt(){let e=new Zc(2);return Zc!=Float32Array&&(e[0]=0,e[1]=0),e}function grt(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e}function _rt(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e}var EPe=function(){let e=PLt();return function(t,r,n,i,o,s){let c,l;for(r||(r=2),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],o(e,e,s),t[c]=e[0],t[c+1]=e[1];return t}}();function yrt(e,t,r){let n=t[0],i=t[1],o=r[3]*n+r[7]*i||1;return e[0]=(r[0]*n+r[4]*i)/o,e[1]=(r[1]*n+r[5]*i)/o,e}function SP(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[3]*n+r[7]*i+r[11]*o||1;return e[0]=(r[0]*n+r[4]*i+r[8]*o)/s,e[1]=(r[1]*n+r[5]*i+r[9]*o)/s,e[2]=(r[2]*n+r[6]*i+r[10]*o)/s,e}function xrt(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e[2]=t[2],e}function vrt(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e[2]=t[2],e[3]=t[3],e}function CP(e,t,r){let n=t[0],i=t[1],o=t[2];return e[0]=r[0]*n+r[3]*i+r[6]*o,e[1]=r[1]*n+r[4]*i+r[7]*o,e[2]=r[2]*n+r[5]*i+r[8]*o,e[3]=t[3],e}function NF(){let e=new Zc(3);return Zc!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function ILt(e){let t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function kF(e,t,r){let n=new Zc(3);return n[0]=e,n[1]=t,n[2]=r,n}function brt(e,t){let r=t[0],n=t[1],i=t[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function FF(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function f1(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[0],c=r[1],l=r[2];return e[0]=i*l-o*c,e[1]=o*s-n*l,e[2]=n*c-i*s,e}function p1(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[3]*n+r[7]*i+r[11]*o+r[15];return s=s||1,e[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/s,e[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/s,e[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/s,e}function PP(e,t,r){let n=t[0],i=t[1],o=t[2];return e[0]=n*r[0]+i*r[3]+o*r[6],e[1]=n*r[1]+i*r[4]+o*r[7],e[2]=n*r[2]+i*r[5]+o*r[8],e}function IP(e,t,r){let n=r[0],i=r[1],o=r[2],s=r[3],c=t[0],l=t[1],h=t[2],p=i*h-o*l,x=o*c-n*h,w=n*l-i*c,E=i*w-o*x,P=o*p-n*w,B=n*x-i*p,D=s*2;return p*=D,x*=D,w*=D,E*=2,P*=2,B*=2,e[0]=c+p+E,e[1]=l+x+P,e[2]=h+w+B,e}function wrt(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function Trt(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function Ert(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function Mrt(e,t){let r=e[0],n=e[1],i=e[2],o=t[0],s=t[1],c=t[2],l=Math.sqrt((r*r+n*n+i*i)*(o*o+s*s+c*c)),h=l&&FF(e,t)/l;return Math.acos(Math.min(Math.max(h,-1),1))}var Srt=ILt;var CPe=function(){let e=NF();return function(t,r,n,i,o,s){let c,l;for(r||(r=3),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],o(e,e,s),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2];return t}}();var zF=[0,0,0],RP,So=class extends h1{static get ZERO(){return RP||(RP=new So(0,0,0),Object.freeze(RP)),RP}constructor(t=0,r=0,n=0){super(-0,-0,-0),arguments.length===1&&Xm(t)?this.copy(t):(Ea.debug&&(so(t),so(r),so(n)),this[0]=t,this[1]=r,this[2]=n)}set(t,r,n){return this[0]=t,this[1]=r,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return Ea.debug&&(so(t.x),so(t.y),so(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=so(t)}angle(t){return Mrt(this,t)}cross(t){return f1(this,this,t),this.check()}rotateX({radians:t,origin:r=zF}){return wrt(this,this,r,t),this.check()}rotateY({radians:t,origin:r=zF}){return Trt(this,this,r,t),this.check()}rotateZ({radians:t,origin:r=zF}){return Ert(this,this,r,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return p1(this,this,t),this.check()}transformAsVector(t){return SP(this,this,t),this.check()}transformByMatrix3(t){return PP(this,this,t),this.check()}transformByMatrix2(t){return xrt(this,this,t),this.check()}transformByQuaternion(t){return IP(this,this,t),this.check()}};var LP,d1=class extends h1{static get ZERO(){return LP||(LP=new d1(0,0,0,0),Object.freeze(LP)),LP}constructor(t=0,r=0,n=0,i=0){super(-0,-0,-0,-0),Xm(t)&&arguments.length===1?this.copy(t):(Ea.debug&&(so(t),so(r),so(n),so(i)),this[0]=t,this[1]=r,this[2]=n,this[3]=i)}set(t,r,n,i){return this[0]=t,this[1]=r,this[2]=n,this[3]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return Ea.debug&&(so(t.x),so(t.y),so(t.z),so(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=so(t)}get w(){return this[3]}set w(t){this[3]=so(t)}transform(t){return p1(this,this,t),this.check()}transformByMatrix3(t){return CP(this,this,t),this.check()}transformByMatrix2(t){return vrt(this,this,t),this.check()}transformByQuaternion(t){return IP(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}};var m1=class extends Ym{toString(){let t="[";if(Ea.printRowMajor){t+="row-major:";for(let r=0;r<this.RANK;++r)for(let n=0;n<this.RANK;++n)t+=` ${this[n*this.RANK+r]}`}else{t+="column-major:";for(let r=0;r<this.ELEMENTS;++r)t+=` ${this[r]}`}return t+="]",t}getElementIndex(t,r){return r*this.RANK+t}getElement(t,r){return this[r*this.RANK+t]}setElement(t,r,n){return this[r*this.RANK+t]=so(n),this}getColumn(t,r=new Array(this.RANK).fill(-0)){let n=t*this.RANK;for(let i=0;i<this.RANK;++i)r[i]=this[n+i];return r}setColumn(t,r){let n=t*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=r[i];return this}};function Crt(){let e=new Zc(9);return Zc!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Prt(e,t){if(e===t){let r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Irt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],c=t[5],l=t[6],h=t[7],p=t[8],x=p*s-c*h,w=-p*o+c*l,E=h*o-s*l,P=r*x+n*w+i*E;return P?(P=1/P,e[0]=x*P,e[1]=(-p*n+i*h)*P,e[2]=(c*n-i*s)*P,e[3]=w*P,e[4]=(p*r-i*l)*P,e[5]=(-c*r+i*o)*P,e[6]=E*P,e[7]=(-h*r+n*l)*P,e[8]=(s*r-n*o)*P,e):null}function Rrt(e){let t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],c=e[6],l=e[7],h=e[8];return t*(h*o-s*l)+r*(-h*i+s*c)+n*(l*i-o*c)}function UF(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=r[0],E=r[1],P=r[2],B=r[3],D=r[4],W=r[5],X=r[6],q=r[7],$=r[8];return e[0]=w*n+E*s+P*h,e[1]=w*i+E*c+P*p,e[2]=w*o+E*l+P*x,e[3]=B*n+D*s+W*h,e[4]=B*i+D*c+W*p,e[5]=B*o+D*l+W*x,e[6]=X*n+q*s+$*h,e[7]=X*i+q*c+$*p,e[8]=X*o+q*l+$*x,e}function Lrt(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=r[0],E=r[1];return e[0]=n,e[1]=i,e[2]=o,e[3]=s,e[4]=c,e[5]=l,e[6]=w*n+E*s+h,e[7]=w*i+E*c+p,e[8]=w*o+E*l+x,e}function Ort(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=Math.sin(r),E=Math.cos(r);return e[0]=E*n+w*s,e[1]=E*i+w*c,e[2]=E*o+w*l,e[3]=E*s-w*n,e[4]=E*c-w*i,e[5]=E*l-w*o,e[6]=h,e[7]=p,e[8]=x,e}function VF(e,t,r){let n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Brt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r+r,c=n+n,l=i+i,h=r*s,p=n*s,x=n*c,w=i*s,E=i*c,P=i*l,B=o*s,D=o*c,W=o*l;return e[0]=1-x-P,e[3]=p-W,e[6]=w+D,e[1]=p+W,e[4]=1-h-P,e[7]=E-B,e[2]=w-D,e[5]=E+B,e[8]=1-h-x,e}var jF;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL1ROW0=3]="COL1ROW0",e[e.COL1ROW1=4]="COL1ROW1",e[e.COL1ROW2=5]="COL1ROW2",e[e.COL2ROW0=6]="COL2ROW0",e[e.COL2ROW1=7]="COL2ROW1",e[e.COL2ROW2=8]="COL2ROW2"})(jF||(jF={}));var OLt=Object.freeze([1,0,0,0,1,0,0,0,1]),Z0=class extends m1{static get IDENTITY(){return DLt()}static get ZERO(){return BLt()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return jF}constructor(t,...r){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):r.length>0?this.copy([t,...r]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(OLt)}fromObject(t){return this.check()}fromQuaternion(t){return Brt(this,t),this.check()}set(t,r,n,i,o,s,c,l,h){return this[0]=t,this[1]=r,this[2]=n,this[3]=i,this[4]=o,this[5]=s,this[6]=c,this[7]=l,this[8]=h,this.check()}setRowMajor(t,r,n,i,o,s,c,l,h){return this[0]=t,this[1]=i,this[2]=c,this[3]=r,this[4]=o,this[5]=l,this[6]=n,this[7]=s,this[8]=h,this.check()}determinant(){return Rrt(this)}transpose(){return Prt(this,this),this.check()}invert(){return Irt(this,this),this.check()}multiplyLeft(t){return UF(this,t,this),this.check()}multiplyRight(t){return UF(this,this,t),this.check()}rotate(t){return Ort(this,this,t),this.check()}scale(t){return Array.isArray(t)?VF(this,this,t):VF(this,this,[t,t]),this.check()}translate(t){return Lrt(this,this,t),this.check()}transform(t,r){let n;switch(t.length){case 2:n=grt(r||[-0,-0],t,this);break;case 3:n=PP(r||[-0,-0,-0],t,this);break;case 4:n=CP(r||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Km(n,t.length),n}transformVector(t,r){return this.transform(t,r)}transformVector2(t,r){return this.transform(t,r)}transformVector3(t,r){return this.transform(t,r)}},OP,BP=null;function BLt(){return OP||(OP=new Z0([0,0,0,0,0,0,0,0,0]),Object.freeze(OP)),OP}function DLt(){return BP||(BP=new Z0,Object.freeze(BP)),BP}function NLt(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Drt(e,t){if(e===t){let r=t[1],n=t[2],i=t[3],o=t[6],s=t[7],c=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=i,e[13]=s,e[14]=c}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function Nrt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],c=t[5],l=t[6],h=t[7],p=t[8],x=t[9],w=t[10],E=t[11],P=t[12],B=t[13],D=t[14],W=t[15],X=r*c-n*s,q=r*l-i*s,$=r*h-o*s,et=n*l-i*c,F=n*h-o*c,ut=i*h-o*l,ot=p*B-x*P,J=p*D-w*P,G=p*W-E*P,mt=x*D-w*B,Mt=x*W-E*B,ct=w*W-E*D,gt=X*ct-q*Mt+$*mt+et*G-F*J+ut*ot;return gt?(gt=1/gt,e[0]=(c*ct-l*Mt+h*mt)*gt,e[1]=(i*Mt-n*ct-o*mt)*gt,e[2]=(B*ut-D*F+W*et)*gt,e[3]=(w*F-x*ut-E*et)*gt,e[4]=(l*G-s*ct-h*J)*gt,e[5]=(r*ct-i*G+o*J)*gt,e[6]=(D*$-P*ut-W*q)*gt,e[7]=(p*ut-w*$+E*q)*gt,e[8]=(s*Mt-c*G+h*ot)*gt,e[9]=(n*G-r*Mt-o*ot)*gt,e[10]=(P*F-B*$+W*X)*gt,e[11]=(x*$-p*F-E*X)*gt,e[12]=(c*J-s*mt-l*ot)*gt,e[13]=(r*mt-n*J+i*ot)*gt,e[14]=(B*q-P*et-D*X)*gt,e[15]=(p*et-x*q+w*X)*gt,e):null}function krt(e){let t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],c=e[6],l=e[7],h=e[8],p=e[9],x=e[10],w=e[11],E=e[12],P=e[13],B=e[14],D=e[15],W=t*s-r*o,X=t*c-n*o,q=r*c-n*s,$=h*P-p*E,et=h*B-x*E,F=p*B-x*P,ut=t*F-r*et+n*$,ot=o*F-s*et+c*$,J=h*q-p*X+x*W,G=E*q-P*X+B*W;return l*ut-i*ot+D*J-w*G}function HF(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],l=t[5],h=t[6],p=t[7],x=t[8],w=t[9],E=t[10],P=t[11],B=t[12],D=t[13],W=t[14],X=t[15],q=r[0],$=r[1],et=r[2],F=r[3];return e[0]=q*n+$*c+et*x+F*B,e[1]=q*i+$*l+et*w+F*D,e[2]=q*o+$*h+et*E+F*W,e[3]=q*s+$*p+et*P+F*X,q=r[4],$=r[5],et=r[6],F=r[7],e[4]=q*n+$*c+et*x+F*B,e[5]=q*i+$*l+et*w+F*D,e[6]=q*o+$*h+et*E+F*W,e[7]=q*s+$*p+et*P+F*X,q=r[8],$=r[9],et=r[10],F=r[11],e[8]=q*n+$*c+et*x+F*B,e[9]=q*i+$*l+et*w+F*D,e[10]=q*o+$*h+et*E+F*W,e[11]=q*s+$*p+et*P+F*X,q=r[12],$=r[13],et=r[14],F=r[15],e[12]=q*n+$*c+et*x+F*B,e[13]=q*i+$*l+et*w+F*D,e[14]=q*o+$*h+et*E+F*W,e[15]=q*s+$*p+et*P+F*X,e}function Frt(e,t,r){let n=r[0],i=r[1],o=r[2],s,c,l,h,p,x,w,E,P,B,D,W;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*o+t[12],e[13]=t[1]*n+t[5]*i+t[9]*o+t[13],e[14]=t[2]*n+t[6]*i+t[10]*o+t[14],e[15]=t[3]*n+t[7]*i+t[11]*o+t[15]):(s=t[0],c=t[1],l=t[2],h=t[3],p=t[4],x=t[5],w=t[6],E=t[7],P=t[8],B=t[9],D=t[10],W=t[11],e[0]=s,e[1]=c,e[2]=l,e[3]=h,e[4]=p,e[5]=x,e[6]=w,e[7]=E,e[8]=P,e[9]=B,e[10]=D,e[11]=W,e[12]=s*n+p*i+P*o+t[12],e[13]=c*n+x*i+B*o+t[13],e[14]=l*n+w*i+D*o+t[14],e[15]=h*n+E*i+W*o+t[15]),e}function zrt(e,t,r){let n=r[0],i=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Urt(e,t,r,n){let i=n[0],o=n[1],s=n[2],c=Math.sqrt(i*i+o*o+s*s),l,h,p,x,w,E,P,B,D,W,X,q,$,et,F,ut,ot,J,G,mt,Mt,ct,gt,ee;return c<1e-6?null:(c=1/c,i*=c,o*=c,s*=c,h=Math.sin(r),l=Math.cos(r),p=1-l,x=t[0],w=t[1],E=t[2],P=t[3],B=t[4],D=t[5],W=t[6],X=t[7],q=t[8],$=t[9],et=t[10],F=t[11],ut=i*i*p+l,ot=o*i*p+s*h,J=s*i*p-o*h,G=i*o*p-s*h,mt=o*o*p+l,Mt=s*o*p+i*h,ct=i*s*p+o*h,gt=o*s*p-i*h,ee=s*s*p+l,e[0]=x*ut+B*ot+q*J,e[1]=w*ut+D*ot+$*J,e[2]=E*ut+W*ot+et*J,e[3]=P*ut+X*ot+F*J,e[4]=x*G+B*mt+q*Mt,e[5]=w*G+D*mt+$*Mt,e[6]=E*G+W*mt+et*Mt,e[7]=P*G+X*mt+F*Mt,e[8]=x*ct+B*gt+q*ee,e[9]=w*ct+D*gt+$*ee,e[10]=E*ct+W*gt+et*ee,e[11]=P*ct+X*gt+F*ee,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Vrt(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[4],s=t[5],c=t[6],l=t[7],h=t[8],p=t[9],x=t[10],w=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+h*n,e[5]=s*i+p*n,e[6]=c*i+x*n,e[7]=l*i+w*n,e[8]=h*i-o*n,e[9]=p*i-s*n,e[10]=x*i-c*n,e[11]=w*i-l*n,e}function jrt(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[0],s=t[1],c=t[2],l=t[3],h=t[8],p=t[9],x=t[10],w=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-h*n,e[1]=s*i-p*n,e[2]=c*i-x*n,e[3]=l*i-w*n,e[8]=o*n+h*i,e[9]=s*n+p*i,e[10]=c*n+x*i,e[11]=l*n+w*i,e}function Hrt(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[0],s=t[1],c=t[2],l=t[3],h=t[4],p=t[5],x=t[6],w=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+h*n,e[1]=s*i+p*n,e[2]=c*i+x*n,e[3]=l*i+w*n,e[4]=h*i-o*n,e[5]=p*i-s*n,e[6]=x*i-c*n,e[7]=w*i-l*n,e}function Wrt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r+r,c=n+n,l=i+i,h=r*s,p=n*s,x=n*c,w=i*s,E=i*c,P=i*l,B=o*s,D=o*c,W=o*l;return e[0]=1-x-P,e[1]=p+W,e[2]=w-D,e[3]=0,e[4]=p-W,e[5]=1-h-P,e[6]=E+B,e[7]=0,e[8]=w+D,e[9]=E-B,e[10]=1-h-x,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function qrt(e,t,r,n,i,o,s){let c=1/(r-t),l=1/(i-n),h=1/(o-s);return e[0]=o*2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o*2*l,e[6]=0,e[7]=0,e[8]=(r+t)*c,e[9]=(i+n)*l,e[10]=(s+o)*h,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*o*2*h,e[15]=0,e}function kLt(e,t,r,n,i){let o=1/Math.tan(t/2);if(e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0){let s=1/(n-i);e[10]=(i+n)*s,e[14]=2*i*n*s}else e[10]=-1,e[14]=-2*n;return e}var Grt=kLt;function FLt(e,t,r,n,i,o,s){let c=1/(t-r),l=1/(n-i),h=1/(o-s);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*h,e[11]=0,e[12]=(t+r)*c,e[13]=(i+n)*l,e[14]=(s+o)*h,e[15]=1,e}var Xrt=FLt;function Yrt(e,t,r,n){let i,o,s,c,l,h,p,x,w,E,P=t[0],B=t[1],D=t[2],W=n[0],X=n[1],q=n[2],$=r[0],et=r[1],F=r[2];return Math.abs(P-$)<1e-6&&Math.abs(B-et)<1e-6&&Math.abs(D-F)<1e-6?NLt(e):(x=P-$,w=B-et,E=D-F,i=1/Math.sqrt(x*x+w*w+E*E),x*=i,w*=i,E*=i,o=X*E-q*w,s=q*x-W*E,c=W*w-X*x,i=Math.sqrt(o*o+s*s+c*c),i?(i=1/i,o*=i,s*=i,c*=i):(o=0,s=0,c=0),l=w*c-E*s,h=E*o-x*c,p=x*s-w*o,i=Math.sqrt(l*l+h*h+p*p),i?(i=1/i,l*=i,h*=i,p*=i):(l=0,h=0,p=0),e[0]=o,e[1]=l,e[2]=x,e[3]=0,e[4]=s,e[5]=h,e[6]=w,e[7]=0,e[8]=c,e[9]=p,e[10]=E,e[11]=0,e[12]=-(o*P+s*B+c*D),e[13]=-(l*P+h*B+p*D),e[14]=-(x*P+w*B+E*D),e[15]=1,e)}function zLt(){let e=new Zc(4);return Zc!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Krt(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function Zrt(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function $rt(e){let t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function Qrt(e){let t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function Jrt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r*r+n*n+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),e[0]=r*s,e[1]=n*s,e[2]=i*s,e[3]=o*s,e}function tnt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function ent(e,t,r,n){let i=t[0],o=t[1],s=t[2],c=t[3];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=s+n*(r[2]-s),e[3]=c+n*(r[3]-c),e}function rnt(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*s,e[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*s,e[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*s,e[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*s,e}function nnt(e,t,r){let n=t[0],i=t[1],o=t[2],s=r[0],c=r[1],l=r[2],h=r[3],p=h*n+c*o-l*i,x=h*i+l*n-s*o,w=h*o+s*i-c*n,E=-s*n-c*i-l*o;return e[0]=p*h+E*-s+x*-l-w*-c,e[1]=x*h+E*-c+w*-s-p*-l,e[2]=w*h+E*-l+p*-c-x*-s,e[3]=t[3],e}var JPe=function(){let e=zLt();return function(t,r,n,i,o,s){let c,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,c=n;c<l;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],e[3]=t[c+3],o(e,e,s),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2],t[c+3]=e[3];return t}}();var GF;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"})(GF||(GF={}));var VLt=45*Math.PI/180,jLt=1,WF=.1,qF=500,HLt=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Zm=class extends m1{static get IDENTITY(){return qLt()}static get ZERO(){return WLt()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return GF}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,r,n,i,o,s,c,l,h,p,x,w,E,P,B,D){return this[0]=t,this[1]=r,this[2]=n,this[3]=i,this[4]=o,this[5]=s,this[6]=c,this[7]=l,this[8]=h,this[9]=p,this[10]=x,this[11]=w,this[12]=E,this[13]=P,this[14]=B,this[15]=D,this.check()}setRowMajor(t,r,n,i,o,s,c,l,h,p,x,w,E,P,B,D){return this[0]=t,this[1]=o,this[2]=h,this[3]=E,this[4]=r,this[5]=s,this[6]=p,this[7]=P,this[8]=n,this[9]=c,this[10]=x,this[11]=B,this[12]=i,this[13]=l,this[14]=w,this[15]=D,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(HLt)}fromObject(t){return this.check()}fromQuaternion(t){return Wrt(this,t),this.check()}frustum(t){let{left:r,right:n,bottom:i,top:o,near:s=WF,far:c=qF}=t;return c===1/0?GLt(this,r,n,i,o,s):qrt(this,r,n,i,o,s,c),this.check()}lookAt(t){let{eye:r,center:n=[0,0,0],up:i=[0,1,0]}=t;return Yrt(this,r,n,i),this.check()}ortho(t){let{left:r,right:n,bottom:i,top:o,near:s=WF,far:c=qF}=t;return Xrt(this,r,n,i,o,s,c),this.check()}orthographic(t){let{fovy:r=VLt,aspect:n=jLt,focalDistance:i=1,near:o=WF,far:s=qF}=t;int(r);let c=r/2,l=i*Math.tan(c),h=l*n;return this.ortho({left:-h,right:h,bottom:-l,top:l,near:o,far:s})}perspective(t){let{fovy:r=45*Math.PI/180,aspect:n=1,near:i=.1,far:o=500}=t;return int(r),Grt(this,r,n,i,o),this.check()}determinant(){return krt(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];let n=this.getScale(r),i=1/n[0],o=1/n[1],s=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*o,t[2]=this[2]*s,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*o,t[6]=this[6]*s,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*o,t[10]=this[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];let n=this.getScale(r),i=1/n[0],o=1/n[1],s=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*o,t[2]=this[2]*s,t[3]=this[4]*i,t[4]=this[5]*o,t[5]=this[6]*s,t[6]=this[8]*i,t[7]=this[9]*o,t[8]=this[10]*s,t}transpose(){return Drt(this,this),this.check()}invert(){return Nrt(this,this),this.check()}multiplyLeft(t){return HF(this,t,this),this.check()}multiplyRight(t){return HF(this,this,t),this.check()}rotateX(t){return Vrt(this,this,t),this.check()}rotateY(t){return jrt(this,this,t),this.check()}rotateZ(t){return Hrt(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,r){return Urt(this,this,t,r),this.check()}scale(t){return zrt(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return Frt(this,this,t),this.check()}transform(t,r){return t.length===4?(r=rnt(r||[-0,-0,-0,-0],t,this),Km(r,4),r):this.transformAsPoint(t,r)}transformAsPoint(t,r){let{length:n}=t,i;switch(n){case 2:i=_rt(r||[-0,-0],t,this);break;case 3:i=p1(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Km(i,t.length),i}transformAsVector(t,r){let n;switch(t.length){case 2:n=yrt(r||[-0,-0],t,this);break;case 3:n=SP(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Km(n,t.length),n}transformPoint(t,r){return this.transformAsPoint(t,r)}transformVector(t,r){return this.transformAsPoint(t,r)}transformDirection(t,r){return this.transformAsVector(t,r)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,r,n){return this.identity().translate([t,r,n])}},DP,NP;function WLt(){return DP||(DP=new Zm([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(DP)),DP}function qLt(){return NP||(NP=new Zm,Object.freeze(NP)),NP}function int(e){if(e>Math.PI*2)throw Error("expected radians")}function GLt(e,t,r,n,i,o){let s=2*o/(r-t),c=2*o/(i-n),l=(r+t)/(r-t),h=(i+n)/(i-n),p=-1,x=-1,w=-2*o;return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=l,e[9]=h,e[10]=p,e[11]=x,e[12]=0,e[13]=0,e[14]=w,e[15]=0,e}function ont(){let e=new Zc(4);return Zc!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function snt(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function XF(e,t,r){r=r*.5;let n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function YF(e,t,r){let n=t[0],i=t[1],o=t[2],s=t[3],c=r[0],l=r[1],h=r[2],p=r[3];return e[0]=n*p+s*c+i*h-o*l,e[1]=i*p+s*l+o*c-n*h,e[2]=o*p+s*h+n*l-i*c,e[3]=s*p-n*c-i*l-o*h,e}function ant(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],s=t[3],c=Math.sin(r),l=Math.cos(r);return e[0]=n*l+s*c,e[1]=i*l+o*c,e[2]=o*l-i*c,e[3]=s*l-n*c,e}function cnt(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],s=t[3],c=Math.sin(r),l=Math.cos(r);return e[0]=n*l-o*c,e[1]=i*l+s*c,e[2]=o*l+n*c,e[3]=s*l-i*c,e}function lnt(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],s=t[3],c=Math.sin(r),l=Math.cos(r);return e[0]=n*l+i*c,e[1]=i*l-n*c,e[2]=o*l+s*c,e[3]=s*l-o*c,e}function unt(e,t){let r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e}function bw(e,t,r,n){let i=t[0],o=t[1],s=t[2],c=t[3],l=r[0],h=r[1],p=r[2],x=r[3],w,E,P,B,D;return w=i*l+o*h+s*p+c*x,w<0&&(w=-w,l=-l,h=-h,p=-p,x=-x),1-w>1e-6?(E=Math.acos(w),D=Math.sin(E),P=Math.sin((1-n)*E)/D,B=Math.sin(n*E)/D):(P=1-n,B=n),e[0]=P*i+B*l,e[1]=P*o+B*h,e[2]=P*s+B*p,e[3]=P*c+B*x,e}function hnt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],s=r*r+n*n+i*i+o*o,c=s?1/s:0;return e[0]=-r*c,e[1]=-n*c,e[2]=-i*c,e[3]=o*c,e}function fnt(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function KF(e,t){let r=t[0]+t[4]+t[8],n;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{let i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);let o=(i+1)%3,s=(i+2)%3;n=Math.sqrt(t[i*3+i]-t[o*3+o]-t[s*3+s]+1),e[i]=.5*n,n=.5/n,e[3]=(t[o*3+s]-t[s*3+o])*n,e[o]=(t[o*3+i]+t[i*3+o])*n,e[s]=(t[s*3+i]+t[i*3+s])*n}return e}var pnt=Krt;var dnt=Zrt,mnt=tnt,Ant=ent,gnt=$rt;var _nt=Qrt;var ynt=Jrt;var xnt=function(){let e=NF(),t=kF(1,0,0),r=kF(0,1,0);return function(n,i,o){let s=FF(i,o);return s<-.999999?(f1(e,t,i),Srt(e)<1e-6&&f1(e,r,i),brt(e,e),XF(n,e,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(f1(e,i,o),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+s,ynt(n,n))}}(),pIe=function(){let e=ont(),t=ont();return function(r,n,i,o,s,c){return bw(e,n,s,c),bw(t,i,o,c),bw(r,e,t,2*c*(1-c)),r}}(),dIe=function(){let e=Crt();return function(t,r,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],ynt(t,KF(t,e))}}();var XLt=[0,0,0,1],ww=class extends Ym{constructor(t=0,r=0,n=0,i=1){super(-0,-0,-0,-0),Array.isArray(t)&&arguments.length===1?this.copy(t):this.set(t,r,n,i)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,r,n,i){return this[0]=t,this[1]=r,this[2]=n,this[3]=i,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return KF(this,t),this.check()}fromAxisRotation(t,r){return XF(this,t,r),this.check()}identity(){return snt(this),this.check()}setAxisAngle(t,r){return this.fromAxisRotation(t,r)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=so(t)}get y(){return this[1]}set y(t){this[1]=so(t)}get z(){return this[2]}set z(t){this[2]=so(t)}get w(){return this[3]}set w(t){this[3]=so(t)}len(){return gnt(this)}lengthSquared(){return _nt(this)}dot(t){return mnt(this,t)}rotationTo(t,r){return xnt(this,t,r),this.check()}add(t){return pnt(this,this,t),this.check()}calculateW(){return unt(this,this),this.check()}conjugate(){return fnt(this,this),this.check()}invert(){return hnt(this,this),this.check()}lerp(t,r,n){return n===void 0?this.lerp(this,t,r):(Ant(this,t,r,n),this.check())}multiplyRight(t){return YF(this,this,t),this.check()}multiplyLeft(t){return YF(this,t,this),this.check()}normalize(){let t=this.len(),r=t>0?1/t:0;return this[0]=this[0]*r,this[1]=this[1]*r,this[2]=this[2]*r,this[3]=this[3]*r,t===0&&(this[3]=1),this.check()}rotateX(t){return ant(this,this,t),this.check()}rotateY(t){return cnt(this,this,t),this.check()}rotateZ(t){return lnt(this,this,t),this.check()}scale(t){return dnt(this,this,t),this.check()}slerp(t,r,n){let i,o,s;switch(arguments.length){case 1:({start:i=XLt,target:o,ratio:s}=t);break;case 2:i=this,o=t,s=r;break;default:i=t,o=r,s=n}return bw(this,i,o,s),this.check()}transformVector4(t,r=new d1){return nnt(r,t,this),Km(r,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,r){return this.setAxisAngle(t,r)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}};var Ad=class{json;buffer;featuresLength=0;_cachedTypedArrays={};constructor(t,r){this.json=t,this.buffer=r}getExtension(t){return this.json.extensions&&this.json.extensions[t]}hasProperty(t){return Boolean(this.json[t])}getGlobalProperty(t,r=pi.UNSIGNED_INT,n=1){let i=this.json[t];return i&&Number.isFinite(i.byteOffset)?this._getTypedArrayFromBinary(t,r,n,1,i.byteOffset):i}getPropertyArray(t,r,n){let i=this.json[t];return i&&Number.isFinite(i.byteOffset)?("componentType"in i&&(r=Kc.fromName(i.componentType)),this._getTypedArrayFromBinary(t,r,n,this.featuresLength,i.byteOffset)):this._getTypedArrayFromArray(t,r,i)}getProperty(t,r,n,i,o){let s=this.json[t];if(!s)return s;let c=this.getPropertyArray(t,r,n);if(n===1)return c[i];for(let l=0;l<n;++l)o[l]=c[n*i+l];return o}_getTypedArrayFromBinary(t,r,n,i,o){let s=this._cachedTypedArrays,c=s[t];return c||(c=Kc.createTypedArray(r,this.buffer.buffer,this.buffer.byteOffset+o,i*n),s[t]=c),c}_getTypedArrayFromArray(t,r,n){let i=this._cachedTypedArrays,o=i[t];return o||(o=Kc.createTypedArray(r,n),i[t]=o),o}};var YLt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},KLt={SCALAR:(e,t)=>e[t],VEC2:(e,t)=>[e[2*t+0],e[2*t+1]],VEC3:(e,t)=>[e[3*t+0],e[3*t+1],e[3*t+2]],VEC4:(e,t)=>[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]],MAT2:(e,t)=>[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]],MAT3:(e,t)=>[e[9*t+0],e[9*t+1],e[9*t+2],e[9*t+3],e[9*t+4],e[9*t+5],e[9*t+6],e[9*t+7],e[9*t+8]],MAT4:(e,t)=>[e[16*t+0],e[16*t+1],e[16*t+2],e[16*t+3],e[16*t+4],e[16*t+5],e[16*t+6],e[16*t+7],e[16*t+8],e[16*t+9],e[16*t+10],e[16*t+11],e[16*t+12],e[16*t+13],e[16*t+14],e[16*t+15]]},ZLt={SCALAR:(e,t,r)=>{t[r]=e},VEC2:(e,t,r)=>{t[2*r+0]=e[0],t[2*r+1]=e[1]},VEC3:(e,t,r)=>{t[3*r+0]=e[0],t[3*r+1]=e[1],t[3*r+2]=e[2]},VEC4:(e,t,r)=>{t[4*r+0]=e[0],t[4*r+1]=e[1],t[4*r+2]=e[2],t[4*r+3]=e[3]},MAT2:(e,t,r)=>{t[4*r+0]=e[0],t[4*r+1]=e[1],t[4*r+2]=e[2],t[4*r+3]=e[3]},MAT3:(e,t,r)=>{t[9*r+0]=e[0],t[9*r+1]=e[1],t[9*r+2]=e[2],t[9*r+3]=e[3],t[9*r+4]=e[4],t[9*r+5]=e[5],t[9*r+6]=e[6],t[9*r+7]=e[7],t[9*r+8]=e[8],t[9*r+9]=e[9]},MAT4:(e,t,r)=>{t[16*r+0]=e[0],t[16*r+1]=e[1],t[16*r+2]=e[2],t[16*r+3]=e[3],t[16*r+4]=e[4],t[16*r+5]=e[5],t[16*r+6]=e[6],t[16*r+7]=e[7],t[16*r+8]=e[8],t[16*r+9]=e[9],t[16*r+10]=e[10],t[16*r+11]=e[11],t[16*r+12]=e[12],t[16*r+13]=e[13],t[16*r+14]=e[14],t[16*r+15]=e[15]}};function vnt(e,t,r,n){let{componentType:i}=e;Ti(e.componentType);let o=typeof i=="string"?Kc.fromName(i):i,s=YLt[e.type],c=KLt[e.type],l=ZLt[e.type];return r+=e.byteOffset,{values:Kc.createTypedArray(o,t,r,s*n),type:o,size:s,unpacker:c,packer:l}}var ip=e=>e!==void 0;function bnt(e,t,r){if(!t)return null;let n=e.getExtension("3DTILES_batch_table_hierarchy"),i=t.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),t.extensions=t.extensions||{},t.extensions["3DTILES_batch_table_hierarchy"]=i,n=i),n?$Lt(n,r):null}function $Lt(e,t){let r,n,i,o=e.instancesLength,s=e.classes,c=e.classIds,l=e.parentCounts,h=e.parentIds,p=o;ip(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),c=i.createArrayBufferView(t.buffer,t.byteOffset+c.byteOffset,o));let x;if(ip(l))for(ip(l.byteOffset)&&(l.componentType=defaultValue(l.componentType,GL.UNSIGNED_SHORT),l.type=AttributeType.SCALAR,i=getBinaryAccessor(l),l=i.createArrayBufferView(t.buffer,t.byteOffset+l.byteOffset,o)),x=new Uint16Array(o),p=0,r=0;r<o;++r)x[r]=p,p+=l[r];ip(h)&&ip(h.byteOffset)&&(h.componentType=defaultValue(h.componentType,GL.UNSIGNED_SHORT),h.type=AttributeType.SCALAR,i=getBinaryAccessor(h),h=i.createArrayBufferView(t.buffer,t.byteOffset+h.byteOffset,p));let w=s.length;for(r=0;r<w;++r){let D=s[r].length,W=s[r].instances,X=getBinaryProperties(D,W,t);s[r].instances=combine(X,W)}let E=new Array(w).fill(0),P=new Uint16Array(o);for(r=0;r<o;++r)n=c[r],P[r]=E[n],++E[n];let B={classes:s,classIds:c,classIndexes:P,parentCounts:l,parentIndexes:x,parentIds:h};return tOt(B),B}function A1(e,t,r){if(!e)return;let n=e.parentCounts;return e.parentIds?r(e,t):n>0?QLt(e,t,r):JLt(e,t,r)}function QLt(e,t,r){let n=e.classIds,i=e.parentCounts,o=e.parentIds,s=e.parentIndexes,c=n.length,l=scratchVisited;l.length=Math.max(l.length,c);let h=++marker,p=scratchStack;for(p.length=0,p.push(t);p.length>0;){if(t=p.pop(),l[t]===h)continue;l[t]=h;let x=r(e,t);if(ip(x))return x;let w=i[t],E=s[t];for(let P=0;P<w;++P){let B=o[E+P];B!==t&&p.push(B)}}return null}function JLt(e,t,r){let n=!0;for(;n;){let i=r(e,t);if(ip(i))return i;let o=e.parentIds[t];n=o!==t,t=o}throw new Error("traverseHierarchySingleParent")}function tOt(e){let t=[],n=e.classIds.length;for(let i=0;i<n;++i)wnt(e,i,stack)}function wnt(e,t,r){let n=e.parentCounts,i=e.parentIds,o=e.parentIndexes,c=e.classIds.length;if(!ip(i))return;assert(t<c,`Parent index ${t} exceeds the total number of instances: ${c}`),assert(r.indexOf(t)===-1,"Circular dependency detected in the batch table hierarchy."),r.push(t);let l=ip(n)?n[t]:1,h=ip(n)?o[t]:t;for(let p=0;p<l;++p){let x=i[h+p];x!==t&&wnt(e,x,r)}r.pop(t)}function zl(e){return e!=null}var kP=(e,t)=>e,eOt={HIERARCHY:!0,extensions:!0,extras:!0},$0=class{json;binary;featureCount;_extensions;_properties;_binaryProperties;_hierarchy;constructor(t,r,n,i={}){Ti(n>=0),this.json=t||{},this.binary=r,this.featureCount=n,this._extensions=this.json?.extensions||{},this._properties={};for(let o in this.json)eOt[o]||(this._properties[o]=this.json[o]);this._binaryProperties=this._initializeBinaryProperties(),i["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=bnt(this,this.json,this.binary))}getExtension(t){return this.json&&this.json.extensions&&this.json.extensions[t]}memorySizeInBytes(){return 0}isClass(t,r){if(this._checkBatchId(t),Ti(typeof r=="string",r),this._hierarchy){let n=A1(this._hierarchy,t,(i,o)=>{let s=i.classIds[o];return i.classes[s].name===r});return zl(n)}return!1}isExactClass(t,r){return Ti(typeof r=="string",r),this.getExactClassName(t)===r}getExactClassName(t){if(this._checkBatchId(t),this._hierarchy){let r=this._hierarchy.classIds[t];return this._hierarchy.classes[r].name}}hasProperty(t,r){return this._checkBatchId(t),Ti(typeof r=="string",r),zl(this._properties[r])||this._hasPropertyInHierarchy(t,r)}getPropertyNames(t,r){this._checkBatchId(t),r=zl(r)?r:[],r.length=0;let n=Object.keys(this._properties);return r.push(...n),this._hierarchy&&this._getPropertyNamesInHierarchy(t,r),r}getProperty(t,r){if(this._checkBatchId(t),Ti(typeof r=="string",r),this._binaryProperties){let i=this._binaryProperties[r];if(zl(i))return this._getBinaryProperty(i,t)}let n=this._properties[r];if(zl(n))return kP(n[t],!0);if(this._hierarchy){let i=this._getHierarchyProperty(t,r);if(zl(i))return i}}setProperty(t,r,n){let i=this.featureCount;if(this._checkBatchId(t),Ti(typeof r=="string",r),this._binaryProperties){let s=this._binaryProperties[r];if(s){this._setBinaryProperty(s,t,n);return}}if(this._hierarchy&&this._setHierarchyProperty(this,t,r,n))return;let o=this._properties[r];zl(o)||(this._properties[r]=new Array(i),o=this._properties[r]),o[t]=kP(n,!0)}_checkBatchId(t){if(!(t>=0&&t<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(t,r){return t.unpack(t.typedArray,r)}_setBinaryProperty(t,r,n){t.pack(n,t.typedArray,r)}_initializeBinaryProperties(){let t=null;for(let r in this._properties){let n=this._properties[r],i=this._initializeBinaryProperty(r,n);i&&(t=t||{},t[r]=i)}return t}_initializeBinaryProperty(t,r){if("byteOffset"in r){let n=r;Ti(this.binary,`Property ${t} requires a batch table binary.`),Ti(n.type,`Property ${t} requires a type.`);let i=vnt(n,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:i.values,componentCount:i.size,unpack:i.unpacker,pack:i.packer}}return null}_hasPropertyInHierarchy(t,r){if(!this._hierarchy)return!1;let n=A1(this._hierarchy,t,(i,o)=>{let s=i.classIds[o],c=i.classes[s].instances;return zl(c[r])});return zl(n)}_getPropertyNamesInHierarchy(t,r){A1(this._hierarchy,t,(n,i)=>{let o=n.classIds[i],s=n.classes[o].instances;for(let c in s)s.hasOwnProperty(c)&&r.indexOf(c)===-1&&r.push(c)})}_getHierarchyProperty(t,r){return A1(this._hierarchy,t,(n,i)=>{let o=n.classIds[i],s=n.classes[o],c=n.classIndexes[i],l=s.instances[r];return zl(l)?zl(l.typedArray)?this._getBinaryProperty(l,c):kP(l[c],!0):null})}_setHierarchyProperty(t,r,n,i){let o=A1(this._hierarchy,r,(s,c)=>{let l=s.classIds[c],h=s.classes[l],p=s.classIndexes[c],x=h.instances[n];return zl(x)?(Ti(c===r,`Inherited property "${n}" is read-only.`),zl(x.typedArray)?this._setBinaryProperty(x,p,i):x[p]=kP(i,!0),!0):!1});return zl(o)}};function $m(e,t,r=0){let n=new DataView(t);if(e.magic=n.getUint32(r,!0),r+=4,e.version=n.getUint32(r,!0),r+=4,e.byteLength=n.getUint32(r,!0),r+=4,e.version!==1)throw new Error(`3D Tile Version ${e.version} not supported`);return r}var g1=4,Tnt="b3dm tile in legacy format.";function _1(e,t,r){let n=new DataView(t),i;e.header=e.header||{};let o=n.getUint32(r,!0);r+=g1;let s=n.getUint32(r,!0);r+=g1;let c=n.getUint32(r,!0);r+=g1;let l=n.getUint32(r,!0);return r+=g1,c>=570425344?(r-=g1*2,i=o,c=s,l=0,o=0,s=0,console.warn(Tnt)):l>=570425344&&(r-=g1,i=c,c=o,l=s,o=0,s=0,console.warn(Tnt)),e.header.featureTableJsonByteLength=o,e.header.featureTableBinaryByteLength=s,e.header.batchTableJsonByteLength=c,e.header.batchTableBinaryByteLength=l,e.header.batchLength=i,r}function y1(e,t,r,n){return r=rOt(e,t,r,n),r=nOt(e,t,r,n),r}function rOt(e,t,r,n){let{featureTableJsonByteLength:i,featureTableBinaryByteLength:o,batchLength:s}=e.header||{};if(e.featureTableJson={BATCH_LENGTH:s||0},i&&i>0){let c=EF(t,r,i);e.featureTableJson=JSON.parse(c)}return r+=i||0,e.featureTableBinary=new Uint8Array(t,r,o),r+=o||0,r}function nOt(e,t,r,n){let{batchTableJsonByteLength:i,batchTableBinaryByteLength:o}=e.header||{};if(i&&i>0){let s=EF(t,r,i);e.batchTableJson=JSON.parse(s),r+=i,o&&o>0&&(e.batchTableBinary=new Uint8Array(t,r,o),e.batchTableBinary=new Uint8Array(e.batchTableBinary),r+=o)}return r}function ZF(e,t,r){if(!t&&(!e||!e.batchIds||!r))return null;let{batchIds:n,isRGB565:i,pointCount:o=0}=e;if(n&&r){let s=new Uint8ClampedArray(o*3);for(let c=0;c<o;c++){let l=n[c],p=r.getProperty(l,"dimensions").map(x=>x*255);s[c*3]=p[0],s[c*3+1]=p[1],s[c*3+2]=p[2]}return{type:pi.UNSIGNED_BYTE,value:s,size:3,normalized:!0}}if(t&&i){let s=new Uint8ClampedArray(o*3);for(let c=0;c<o;c++){let l=LF(t[c]);s[c*3]=l[0],s[c*3+1]=l[1],s[c*3+2]=l[2]}return{type:pi.UNSIGNED_BYTE,value:s,size:3,normalized:!0}}return t&&t.length===o*3?{type:pi.UNSIGNED_BYTE,value:t,size:3,normalized:!0}:{type:pi.UNSIGNED_BYTE,value:t||new Uint8ClampedArray,size:4,normalized:!0}}var Ent=new So;function Mnt(e,t){if(!t)return null;if(e.isOctEncoded16P){let r=new Float32Array((e.pointsLength||0)*3);for(let n=0;n<(e.pointsLength||0);n++)OF(t[n*2],t[n*2+1],Ent),Ent.toArray(r,n*3);return{type:pi.FLOAT,size:2,value:r}}return{type:pi.FLOAT,size:2,value:t}}function Snt(e,t,r){return e.isQuantized?r["3d-tiles"]&&r["3d-tiles"].decodeQuantizedPositions?(e.isQuantized=!1,iOt(e,t)):{type:pi.UNSIGNED_SHORT,value:t,size:3,normalized:!0}:t}function iOt(e,t){let r=new So,n=new Float32Array(e.pointCount*3);for(let i=0;i<e.pointCount;i++)r.set(t[i*3],t[i*3+1],t[i*3+2]).scale(1/e.quantizedRange).multiply(e.quantizedVolumeScale).add(e.quantizedVolumeOffset).toArray(n,i*3);return n}async function Cnt(e,t,r,n,i){r=$m(e,t,r),r=_1(e,t,r),r=y1(e,t,r,n),oOt(e);let{featureTable:o,batchTable:s}=sOt(e);return await hOt(e,o,s,n,i),aOt(e,o,n),cOt(e,o,s),lOt(e,o),r}function oOt(e){e.attributes={positions:null,colors:null,normals:null,batchIds:null},e.isQuantized=!1,e.isTranslucent=!1,e.isRGB565=!1,e.isOctEncoded16P=!1}function sOt(e){let t=new Ad(e.featureTableJson,e.featureTableBinary),r=t.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(r))throw new Error("POINTS_LENGTH must be defined");t.featuresLength=r,e.featuresLength=r,e.pointsLength=r,e.pointCount=r,e.rtcCenter=t.getGlobalProperty("RTC_CENTER",pi.FLOAT,3);let n=uOt(e,t);return{featureTable:t,batchTable:n}}function aOt(e,t,r){if(e.attributes=e.attributes||{positions:null,colors:null,normals:null,batchIds:null},!e.attributes.positions){if(t.hasProperty("POSITION"))e.attributes.positions=t.getPropertyArray("POSITION",pi.FLOAT,3);else if(t.hasProperty("POSITION_QUANTIZED")){let n=t.getPropertyArray("POSITION_QUANTIZED",pi.UNSIGNED_SHORT,3);if(e.isQuantized=!0,e.quantizedRange=(1<<16)-1,e.quantizedVolumeScale=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",pi.FLOAT,3),!e.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(e.quantizedVolumeOffset=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",pi.FLOAT,3),!e.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");e.attributes.positions=Snt(e,n,r)}}if(!e.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function cOt(e,t,r){if(e.attributes=e.attributes||{positions:null,colors:null,normals:null,batchIds:null},!e.attributes.colors){let n=null;t.hasProperty("RGBA")?(n=t.getPropertyArray("RGBA",pi.UNSIGNED_BYTE,4),e.isTranslucent=!0):t.hasProperty("RGB")?n=t.getPropertyArray("RGB",pi.UNSIGNED_BYTE,3):t.hasProperty("RGB565")&&(n=t.getPropertyArray("RGB565",pi.UNSIGNED_SHORT,1),e.isRGB565=!0),e.attributes.colors=ZF(e,n,r)}t.hasProperty("CONSTANT_RGBA")&&(e.constantRGBA=t.getGlobalProperty("CONSTANT_RGBA",pi.UNSIGNED_BYTE,4))}function lOt(e,t){if(e.attributes=e.attributes||{positions:null,colors:null,normals:null,batchIds:null},!e.attributes.normals){let r=null;t.hasProperty("NORMAL")?r=t.getPropertyArray("NORMAL",pi.FLOAT,3):t.hasProperty("NORMAL_OCT16P")&&(r=t.getPropertyArray("NORMAL_OCT16P",pi.UNSIGNED_BYTE,2),e.isOctEncoded16P=!0),e.attributes.normals=Mnt(e,r)}}function uOt(e,t){let r=null;if(!e.batchIds&&t.hasProperty("BATCH_ID")&&(e.batchIds=t.getPropertyArray("BATCH_ID",pi.UNSIGNED_SHORT,1),e.batchIds)){let n=t.getGlobalProperty("BATCH_LENGTH");if(!n)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");let{batchTableJson:i,batchTableBinary:o}=e;r=new $0(i,o,n)}return r}async function hOt(e,t,r,n,i){let o,s,c,l=e.batchTableJson&&e.batchTableJson.extensions&&e.batchTableJson.extensions["3DTILES_draco_point_compression"];l&&(c=l.properties);let h=t.getExtension("3DTILES_draco_point_compression");if(h){s=h.properties;let x=h.byteOffset,w=h.byteLength;if(!s||!Number.isFinite(x)||!w)throw new Error("Draco properties, byteOffset, and byteLength must be defined");o=(e.featureTableBinary||[]).slice(x,x+w),e.hasPositions=Number.isFinite(s.POSITION),e.hasColors=Number.isFinite(s.RGB)||Number.isFinite(s.RGBA),e.hasNormals=Number.isFinite(s.NORMAL),e.hasBatchIds=Number.isFinite(s.BATCH_ID),e.isTranslucent=Number.isFinite(s.RGBA)}if(!o)return!0;let p={buffer:o,properties:{...s,...c},featureTableProperties:s,batchTableProperties:c,dequantizeInShader:!1};return await fOt(e,p,n,i)}async function fOt(e,t,r,n){if(!n)return;let i={...r,draco:{...r?.draco,extraAttributes:t.batchTableProperties||{}}};delete i["3d-tiles"];let o=await iu(t.buffer,vC,i,n),s=o.attributes.POSITION&&o.attributes.POSITION.value,c=o.attributes.COLOR_0&&o.attributes.COLOR_0.value,l=o.attributes.NORMAL&&o.attributes.NORMAL.value,h=o.attributes.BATCH_ID&&o.attributes.BATCH_ID.value,p=s&&o.attributes.POSITION.value.quantization,x=l&&o.attributes.NORMAL.value.quantization;if(p){let E=o.POSITION.data.quantization,P=E.range;e.quantizedVolumeScale=new So(P,P,P),e.quantizedVolumeOffset=new So(E.minValues),e.quantizedRange=(1<<E.quantizationBits)-1,e.isQuantizedDraco=!0}x&&(e.octEncodedRange=(1<<o.NORMAL.data.quantization.quantizationBits)-1,e.isOctEncodedDraco=!0);let w={};if(t.batchTableProperties)for(let E of Object.keys(t.batchTableProperties))o.attributes[E]&&o.attributes[E].value&&(w[E.toLowerCase()]=o.attributes[E].value);e.attributes={positions:s,colors:ZF(e,c,void 0),normals:l,batchIds:h,...w}}var FP={URI:0,EMBEDDED:1};function zP(e,t,r,n){e.rotateYtoZ=!0;let i=(e.byteOffset||0)+(e.byteLength||0)-r;if(i===0)throw new Error("glTF byte length must be greater than 0.");return e.gltfUpAxis=n?.["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y",e.gltfArrayBuffer=zA(t,r,i),e.gltfByteOffset=0,e.gltfByteLength=i,r%4===0||console.warn(`${e.type}: embedded glb is not aligned to a 4-byte boundary.`),(e.byteOffset||0)+(e.byteLength||0)}async function UP(e,t,r,n){let i=r?.["3d-tiles"]||{};if(pOt(e,t,r),i.loadGLTF){if(!n)return;if(e.gltfUrl){let{fetch:o}=n,s=await o(e.gltfUrl,r);e.gltfArrayBuffer=await s.arrayBuffer(),e.gltfByteOffset=0}if(e.gltfArrayBuffer){let o=await iu(e.gltfArrayBuffer,ad,r,n);e.gltf=H0(o),e.gpuMemoryUsageInBytes=nw(e.gltf),delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength}}}function pOt(e,t,r){switch(t){case FP.URI:if(e.gltfArrayBuffer){let n=new Uint8Array(e.gltfArrayBuffer,e.gltfByteOffset),o=new TextDecoder().decode(n);e.gltfUrl=o.replace(/[\s\0]+$/,"")}delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength;break;case FP.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}async function Pnt(e,t,r,n,i){r=dOt(e,t,r,n,i),await UP(e,FP.EMBEDDED,n,i);let o=e?.gltf?.extensions;return o&&o.CESIUM_RTC&&(e.rtcCenter=o.CESIUM_RTC.center),r}function dOt(e,t,r,n,i){r=$m(e,t,r),r=_1(e,t,r),r=y1(e,t,r,n),r=zP(e,t,r,n);let o=new Ad(e.featureTableJson,e.featureTableBinary);return e.rtcCenter=o.getGlobalProperty("RTC_CENTER",pi.FLOAT,3),r}async function Int(e,t,r,n,i){return r=mOt(e,t,r,n,i),await UP(e,e.gltfFormat||0,n,i),r}function mOt(e,t,r,n,i){if(r=$m(e,t,r),e.version!==1)throw new Error(`Instanced 3D Model version ${e.version} is not supported`);r=_1(e,t,r);let o=new DataView(t);if(e.gltfFormat=o.getUint32(r,!0),r+=4,r=y1(e,t,r,n),r=zP(e,t,r,n),!e?.header?.featureTableJsonByteLength||e.header.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");let s=new Ad(e.featureTableJson,e.featureTableBinary),c=s.getGlobalProperty("INSTANCES_LENGTH");if(s.featuresLength=c,!Number.isFinite(c))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");e.eastNorthUp=s.getGlobalProperty("EAST_NORTH_UP"),e.rtcCenter=s.getGlobalProperty("RTC_CENTER",pi.FLOAT,3);let l=new $0(e.batchTableJson,e.batchTableBinary,c);return AOt(e,s,l,c),r}function AOt(e,t,r,n){let i=new Array(n),o=new So,s=new So,c=new So,l=new So,h=new Z0,p=new ww,x=new So,w={},E=new Zm,P=[],B=[],D=[],W=[];for(let X=0;X<n;X++){let q;if(t.hasProperty("POSITION"))q=t.getProperty("POSITION",pi.FLOAT,3,X,o);else if(t.hasProperty("POSITION_QUANTIZED")){q=t.getProperty("POSITION_QUANTIZED",pi.UNSIGNED_SHORT,3,X,o);let G=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",pi.FLOAT,3);if(!G)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");let mt=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",pi.FLOAT,3);if(!mt)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");let Mt=65535;for(let ct=0;ct<3;ct++)q[ct]=q[ct]/Mt*mt[ct]+G[ct]}if(!q)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");o.copy(q),w.translation=o,e.normalUp=t.getProperty("NORMAL_UP",pi.FLOAT,3,X,P),e.normalRight=t.getProperty("NORMAL_RIGHT",pi.FLOAT,3,X,B);let $=!1;if(e.normalUp){if(!e.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");e.hasCustomOrientation=!0}else{if(e.octNormalUp=t.getProperty("NORMAL_UP_OCT32P",pi.UNSIGNED_SHORT,2,X,P),e.octNormalRight=t.getProperty("NORMAL_RIGHT_OCT32P",pi.UNSIGNED_SHORT,2,X,B),e.octNormalUp)throw e.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");e.eastNorthUp?(Si.WGS84.eastNorthUpToFixedFrame(o,E),E.getRotationMatrix3(h)):h.identity()}$&&(l.copy(s).cross(c).normalize(),h.setColumn(0,s),h.setColumn(1,c),h.setColumn(2,l)),p.fromMatrix3(h),w.rotation=p,x.set(1,1,1);let et=t.getProperty("SCALE",pi.FLOAT,1,X,D);Number.isFinite(et)&&x.multiplyByScalar(et);let F=t.getProperty("SCALE_NON_UNIFORM",pi.FLOAT,3,X,P);F&&x.scale(F),w.scale=x;let ut=t.getProperty("BATCH_ID",pi.UNSIGNED_SHORT,1,X,W);ut===void 0&&(ut=X);let ot=new Zm().fromQuaternion(w.rotation);E.identity(),E.translate(w.translation),E.multiplyRight(ot),E.scale(w.scale);let J=E.clone();i[X]={modelMatrix:J,batchId:ut}}e.instances=i}async function Rnt(e,t,r,n,i,o){r=$m(e,t,r);let s=new DataView(t);for(e.tilesLength=s.getUint32(r,!0),r+=4,e.tiles=[];e.tiles.length<e.tilesLength&&(e.byteLength||0)-r>12;){let c={shape:"tile3d"};e.tiles.push(c),r=await o(t,r,n,i,c)}return r}async function Lnt(e,t,r,n){if(e.rotateYtoZ=!0,e.gltfUpAxis=r?.["3d-tiles"]?.assetGltfUpAxis?r["3d-tiles"].assetGltfUpAxis:"Y",r?.["3d-tiles"]?.loadGLTF){if(!n)return t.byteLength;let i=await iu(t,ad,r,n);e.gltf=H0(i),e.gpuMemoryUsageInBytes=nw(e.gltf)}else e.gltfArrayBuffer=t;return t.byteLength}async function $F(e,t=0,r,n,i={shape:"tile3d"}){switch(i.byteOffset=t,i.type=Xet(e,t),i.type){case X0.COMPOSITE:return await Rnt(i,e,t,r,n,$F);case X0.BATCHED_3D_MODEL:return await Pnt(i,e,t,r,n);case X0.GLTF:return await Lnt(i,e,r,n);case X0.INSTANCED_3D_MODEL:return await Int(i,e,t,r,n);case X0.POINT_CLOUD:return await Cnt(i,e,t,r,n);default:throw new Error(`3DTileLoader: unknown type ${i.type}`)}}async function QF(e,t,r){if(new Uint32Array(e.slice(0,4))[0]!==1952609651)throw new Error("Wrong subtree file magic number");if(new Uint32Array(e.slice(4,8))[0]!==1)throw new Error("Wrong subtree file verson, must be 1");let o=Ont(e.slice(8,16)),s=new Uint8Array(e,24,o),l=new TextDecoder("utf8").decode(s),h=JSON.parse(l),p=Ont(e.slice(16,24)),x=new ArrayBuffer(0);if(p&&(x=e.slice(24+o)),await VP(h,h.tileAvailability,x,r),Array.isArray(h.contentAvailability))for(let w of h.contentAvailability)await VP(h,w,x,r);else await VP(h,h.contentAvailability,x,r);return await VP(h,h.childSubtreeAvailability,x,r),h}async function VP(e,t,r,n){let i=Number.isFinite(t.bitstream)?t.bitstream:t.bufferView;if(typeof i!="number")return;let o=e.bufferViews[i],s=e.buffers[o.buffer];if(!n?.baseUrl)throw new Error("Url is not provided");if(!n.fetch)throw new Error("fetch is not provided");if(s.uri){let l=`${n?.baseUrl||""}/${s.uri}`,p=await(await n.fetch(l)).arrayBuffer();t.explicitBitstream=new Uint8Array(p,o.byteOffset,o.byteLength);return}let c=e.buffers.slice(0,o.buffer).reduce((l,h)=>l+h.byteLength,0);t.explicitBitstream=new Uint8Array(r.slice(c,c+s.byteLength),o.byteOffset,o.byteLength)}function Ont(e){let t=new DataView(e),r=t.getUint32(0,!0),n=t.getUint32(4,!0);return r+2**32*n}var jP={dataType:null,batchType:null,id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:wP,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:QF,options:{}};var nh=null;try{nh=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Qo(e,t,r){this.low=e|0,this.high=t|0,this.unsigned=!!r}Qo.prototype.__isLong__;Object.defineProperty(Qo.prototype,"__isLong__",{value:!0});function $c(e){return(e&&e.__isLong__)===!0}function Bnt(e){var t=Math.clz32(e&-e);return e?31-t:t}Qo.isLong=$c;var Dnt={},Nnt={};function Q0(e,t){var r,n,i;return t?(e>>>=0,(i=0<=e&&e<256)&&(n=Nnt[e],n)?n:(r=ao(e,0,!0),i&&(Nnt[e]=r),r)):(e|=0,(i=-128<=e&&e<128)&&(n=Dnt[e],n)?n:(r=ao(e,e<0?-1:0,!1),i&&(Dnt[e]=r),r))}Qo.fromInt=Q0;function ih(e,t){if(isNaN(e))return t?gd:Gh;if(t){if(e<0)return gd;if(e>=Unt)return Hnt}else{if(e<=-Fnt)return Ul;if(e+1>=Fnt)return jnt}return e<0?ih(-e,t).neg():ao(e%v1|0,e/v1|0,t)}Qo.fromNumber=ih;function ao(e,t,r){return new Qo(e,t,r)}Qo.fromBits=ao;var HP=Math.pow;function t5(e,t,r){if(e.length===0)throw Error("empty string");if(typeof t=="number"?(r=t,t=!1):t=!!t,e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return t?gd:Gh;if(r=r||10,r<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return t5(e.substring(1),t,r).neg();for(var i=ih(HP(r,8)),o=Gh,s=0;s<e.length;s+=8){var c=Math.min(8,e.length-s),l=parseInt(e.substring(s,s+c),r);if(c<8){var h=ih(HP(r,c));o=o.mul(h).add(ih(l))}else o=o.mul(i),o=o.add(ih(l))}return o.unsigned=t,o}Qo.fromString=t5;function Xh(e,t){return typeof e=="number"?ih(e,t):typeof e=="string"?t5(e,t):ao(e.low,e.high,typeof t=="boolean"?t:e.unsigned)}Qo.fromValue=Xh;var knt=1<<16,gOt=1<<24,v1=knt*knt,Unt=v1*v1,Fnt=Unt/2,znt=Q0(gOt),Gh=Q0(0);Qo.ZERO=Gh;var gd=Q0(0,!0);Qo.UZERO=gd;var x1=Q0(1);Qo.ONE=x1;var Vnt=Q0(1,!0);Qo.UONE=Vnt;var JF=Q0(-1);Qo.NEG_ONE=JF;var jnt=ao(-1,2147483647,!1);Qo.MAX_VALUE=jnt;var Hnt=ao(-1,-1,!0);Qo.MAX_UNSIGNED_VALUE=Hnt;var Ul=ao(0,-2147483648,!1);Qo.MIN_VALUE=Ul;var Ar=Qo.prototype;Ar.toInt=function(){return this.unsigned?this.low>>>0:this.low};Ar.toNumber=function(){return this.unsigned?(this.high>>>0)*v1+(this.low>>>0):this.high*v1+(this.low>>>0)};Ar.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Ul)){var r=ih(t),n=this.div(r),i=n.mul(r).sub(this);return n.toString(t)+i.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var o=ih(HP(t,6),this.unsigned),s=this,c="";;){var l=s.div(o),h=s.sub(l.mul(o)).toInt()>>>0,p=h.toString(t);if(s=l,s.isZero())return p+c;for(;p.length<6;)p="0"+p;c=""+p+c}};Ar.getHighBits=function(){return this.high};Ar.getHighBitsUnsigned=function(){return this.high>>>0};Ar.getLowBits=function(){return this.low};Ar.getLowBitsUnsigned=function(){return this.low>>>0};Ar.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Ul)?64:this.neg().getNumBitsAbs();for(var t=this.high!=0?this.high:this.low,r=31;r>0&&!(t&1<<r);r--);return this.high!=0?r+33:r+1};Ar.isZero=function(){return this.high===0&&this.low===0};Ar.eqz=Ar.isZero;Ar.isNegative=function(){return!this.unsigned&&this.high<0};Ar.isPositive=function(){return this.unsigned||this.high>=0};Ar.isOdd=function(){return(this.low&1)===1};Ar.isEven=function(){return(this.low&1)===0};Ar.equals=function(t){return $c(t)||(t=Xh(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low};Ar.eq=Ar.equals;Ar.notEquals=function(t){return!this.eq(t)};Ar.neq=Ar.notEquals;Ar.ne=Ar.notEquals;Ar.lessThan=function(t){return this.comp(t)<0};Ar.lt=Ar.lessThan;Ar.lessThanOrEqual=function(t){return this.comp(t)<=0};Ar.lte=Ar.lessThanOrEqual;Ar.le=Ar.lessThanOrEqual;Ar.greaterThan=function(t){return this.comp(t)>0};Ar.gt=Ar.greaterThan;Ar.greaterThanOrEqual=function(t){return this.comp(t)>=0};Ar.gte=Ar.greaterThanOrEqual;Ar.ge=Ar.greaterThanOrEqual;Ar.compare=function(t){if($c(t)||(t=Xh(t)),this.eq(t))return 0;var r=this.isNegative(),n=t.isNegative();return r&&!n?-1:!r&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1};Ar.comp=Ar.compare;Ar.negate=function(){return!this.unsigned&&this.eq(Ul)?Ul:this.not().add(x1)};Ar.neg=Ar.negate;Ar.add=function(t){$c(t)||(t=Xh(t));var r=this.high>>>16,n=this.high&65535,i=this.low>>>16,o=this.low&65535,s=t.high>>>16,c=t.high&65535,l=t.low>>>16,h=t.low&65535,p=0,x=0,w=0,E=0;return E+=o+h,w+=E>>>16,E&=65535,w+=i+l,x+=w>>>16,w&=65535,x+=n+c,p+=x>>>16,x&=65535,p+=r+s,p&=65535,ao(w<<16|E,p<<16|x,this.unsigned)};Ar.subtract=function(t){return $c(t)||(t=Xh(t)),this.add(t.neg())};Ar.sub=Ar.subtract;Ar.multiply=function(t){if(this.isZero())return this;if($c(t)||(t=Xh(t)),nh){var r=nh.mul(this.low,this.high,t.low,t.high);return ao(r,nh.get_high(),this.unsigned)}if(t.isZero())return this.unsigned?gd:Gh;if(this.eq(Ul))return t.isOdd()?Ul:Gh;if(t.eq(Ul))return this.isOdd()?Ul:Gh;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(znt)&&t.lt(znt))return ih(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,i=this.high&65535,o=this.low>>>16,s=this.low&65535,c=t.high>>>16,l=t.high&65535,h=t.low>>>16,p=t.low&65535,x=0,w=0,E=0,P=0;return P+=s*p,E+=P>>>16,P&=65535,E+=o*p,w+=E>>>16,E&=65535,E+=s*h,w+=E>>>16,E&=65535,w+=i*p,x+=w>>>16,w&=65535,w+=o*h,x+=w>>>16,w&=65535,w+=s*l,x+=w>>>16,w&=65535,x+=n*p+i*h+o*l+s*c,x&=65535,ao(E<<16|P,x<<16|w,this.unsigned)};Ar.mul=Ar.multiply;Ar.divide=function(t){if($c(t)||(t=Xh(t)),t.isZero())throw Error("division by zero");if(nh){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var r=(this.unsigned?nh.div_u:nh.div_s)(this.low,this.high,t.low,t.high);return ao(r,nh.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?gd:Gh;var n,i,o;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return gd;if(t.gt(this.shru(1)))return Vnt;o=gd}else{if(this.eq(Ul)){if(t.eq(x1)||t.eq(JF))return Ul;if(t.eq(Ul))return x1;var s=this.shr(1);return n=s.div(t).shl(1),n.eq(Gh)?t.isNegative()?x1:JF:(i=this.sub(t.mul(n)),o=n.add(i.div(t)),o)}else if(t.eq(Ul))return this.unsigned?gd:Gh;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();o=Gh}for(i=this;i.gte(t);){n=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var c=Math.ceil(Math.log(n)/Math.LN2),l=c<=48?1:HP(2,c-48),h=ih(n),p=h.mul(t);p.isNegative()||p.gt(i);)n-=l,h=ih(n,this.unsigned),p=h.mul(t);h.isZero()&&(h=x1),o=o.add(h),i=i.sub(p)}return o};Ar.div=Ar.divide;Ar.modulo=function(t){if($c(t)||(t=Xh(t)),nh){var r=(this.unsigned?nh.rem_u:nh.rem_s)(this.low,this.high,t.low,t.high);return ao(r,nh.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))};Ar.mod=Ar.modulo;Ar.rem=Ar.modulo;Ar.not=function(){return ao(~this.low,~this.high,this.unsigned)};Ar.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};Ar.clz=Ar.countLeadingZeros;Ar.countTrailingZeros=function(){return this.low?Bnt(this.low):Bnt(this.high)+32};Ar.ctz=Ar.countTrailingZeros;Ar.and=function(t){return $c(t)||(t=Xh(t)),ao(this.low&t.low,this.high&t.high,this.unsigned)};Ar.or=function(t){return $c(t)||(t=Xh(t)),ao(this.low|t.low,this.high|t.high,this.unsigned)};Ar.xor=function(t){return $c(t)||(t=Xh(t)),ao(this.low^t.low,this.high^t.high,this.unsigned)};Ar.shiftLeft=function(t){return $c(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?ao(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):ao(0,this.low<<t-32,this.unsigned)};Ar.shl=Ar.shiftLeft;Ar.shiftRight=function(t){return $c(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?ao(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):ao(this.high>>t-32,this.high>=0?0:-1,this.unsigned)};Ar.shr=Ar.shiftRight;Ar.shiftRightUnsigned=function(t){return $c(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?ao(this.low>>>t|this.high<<32-t,this.high>>>t,this.unsigned):t===32?ao(this.high,0,this.unsigned):ao(this.high>>>t-32,0,this.unsigned)};Ar.shru=Ar.shiftRightUnsigned;Ar.shr_u=Ar.shiftRightUnsigned;Ar.rotateLeft=function(t){var r;return $c(t)&&(t=t.toInt()),(t&=63)===0?this:t===32?ao(this.high,this.low,this.unsigned):t<32?(r=32-t,ao(this.low<<t|this.high>>>r,this.high<<t|this.low>>>r,this.unsigned)):(t-=32,r=32-t,ao(this.high<<t|this.low>>>r,this.low<<t|this.high>>>r,this.unsigned))};Ar.rotl=Ar.rotateLeft;Ar.rotateRight=function(t){var r;return $c(t)&&(t=t.toInt()),(t&=63)===0?this:t===32?ao(this.high,this.low,this.unsigned):t<32?(r=32-t,ao(this.high<<r|this.low>>>t,this.low<<r|this.high>>>t,this.unsigned)):(t-=32,r=32-t,ao(this.low<<r|this.high>>>t,this.high<<r|this.low>>>t,this.unsigned))};Ar.rotr=Ar.rotateRight;Ar.toSigned=function(){return this.unsigned?ao(this.low,this.high,!1):this};Ar.toUnsigned=function(){return this.unsigned?this:ao(this.low,this.high,!0)};Ar.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()};Ar.toBytesLE=function(){var t=this.high,r=this.low;return[r&255,r>>>8&255,r>>>16&255,r>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]};Ar.toBytesBE=function(){var t=this.high,r=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,r>>>24,r>>>16&255,r>>>8&255,r&255]};Qo.fromBytes=function(t,r,n){return n?Qo.fromBytesLE(t,r):Qo.fromBytesBE(t,r)};Qo.fromBytesLE=function(t,r){return new Qo(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,r)};Qo.fromBytesBE=function(t,r){return new Qo(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],r)};var b1=Qo;var _Ot=16;function Tw(e){e==="X"&&(e="");let t=e.padEnd(_Ot,"0");return b1.fromString(t,!0,16)}function e5(e){if(e.isZero())return"X";let t=e.countTrailingZeros(),r=t%4;t=(t-r)/4;let n=t;t*=4;let o=e.shiftRightUnsigned(t).toString(16).replace(/0+$/,"");return Array(17-n-o.length).join("0")+o}function r5(e,t){let r=yOt(e).shiftRightUnsigned(2);return e.add(b1.fromNumber(2*t+1-4).multiply(r))}function yOt(e){return e.and(e.not().add(1))}var xOt=3,vOt=30,bOt=2*vOt+1,Wnt=180/Math.PI;function Gnt(e){if(e.length===0)throw new Error(`Invalid Hilbert quad key ${e}`);let t=e.split("/"),r=parseInt(t[0],10),n=t[1],i=n.length,o=0,s=[0,0];for(let c=i-1;c>=0;c--){o=i-c;let l=n[c],h=0,p=0;l==="1"?p=1:l==="2"?(h=1,p=1):l==="3"&&(h=1);let x=Math.pow(2,o-1);wOt(x,s,h,p),s[0]+=x*h,s[1]+=x*p}if(r%2===1){let c=s[0];s[0]=s[1],s[1]=c}return{face:r,ij:s,level:o}}function Xnt(e){if(e.isZero())return"";let t=e.toString(2);for(;t.length<xOt+bOt;)t="0"+t;let r=t.lastIndexOf("1"),n=t.substring(0,3),i=t.substring(3,r),o=i.length/2,s=b1.fromString(n,!0,2).toString(10),c="";if(o!==0)for(c=b1.fromString(i,!0,2).toString(4);c.length<o;)c="0"+c;return`${s}/${c}`}function n5(e,t,r){let n=1<<t;return[(e[0]+r[0])/n,(e[1]+r[1])/n]}function qnt(e){return e>=.5?1/3*(4*e*e-1):1/3*(1-4*(1-e)*(1-e))}function i5(e){return[qnt(e[0]),qnt(e[1])]}function o5(e,[t,r]){switch(e){case 0:return[1,t,r];case 1:return[-t,1,r];case 2:return[-t,-r,1];case 3:return[-1,-r,-t];case 4:return[r,-1,-t];case 5:return[r,t,-1];default:throw new Error("Invalid face")}}function s5([e,t,r]){let n=Math.atan2(r,Math.sqrt(e*e+t*t));return[Math.atan2(t,e)*Wnt,n*Wnt]}function wOt(e,t,r,n){if(n===0){r===1&&(t[0]=e-1-t[0],t[1]=e-1-t[1]);let i=t[0];t[0]=t[1],t[1]=i}}function Ynt(e){let t=n5(e.ij,e.level,[.5,.5]),r=i5(t),n=o5(e.face,r);return s5(n)}var TOt=100;function a5(e){let{face:t,ij:r,level:n}=e,i=[[0,0],[0,1],[1,1],[1,0],[0,0]],o=Math.max(1,Math.ceil(TOt*Math.pow(2,-n))),s=new Float64Array(4*o*2+2),c=0,l=0;for(let h=0;h<4;h++){let p=i[h].slice(0),x=i[h+1],w=(x[0]-p[0])/o,E=(x[1]-p[1])/o;for(let P=0;P<o;P++){p[0]+=w,p[1]+=E;let B=n5(r,n,p),D=i5(B),W=o5(t,D),X=s5(W);Math.abs(X[1])>89.999&&(X[0]=l);let q=X[0]-l;X[0]+=q>180?-360:q<-180?360:0,s[c++]=X[0],s[c++]=X[1],l=X[0]}}return s[c++]=s[0],s[c++]=s[1],s}function w1(e){let t=EOt(e);return Gnt(t)}function EOt(e){if(e.indexOf("/")>0)return e;let t=Tw(e);return Xnt(t)}function c5(e){let t=w1(e);return Ynt(t)}function Znt(e){let t;if(e.face===2||e.face===5){let r=null,n=0;for(let i=0;i<4;i++){let o=`${e.face}/${i}`,s=w1(o),c=a5(s);(typeof r>"u"||r===null)&&(r=new Float64Array(4*c.length)),r.set(c,n),n+=c.length}t=Knt(r)}else{let r=a5(e);t=Knt(r)}return t}function Knt(e){if(e.length%2!==0)throw new Error("Invalid corners");let t=[],r=[];for(let n=0;n<e.length;n+=2)t.push(e[n]),r.push(e[n+1]);return t.sort((n,i)=>n-i),r.sort((n,i)=>n-i),{west:t[0],east:t[t.length-1],north:r[r.length-1],south:r[0]}}function l5(e,t){let r=t?.minimumHeight||0,n=t?.maximumHeight||0,i=w1(e),o=Znt(i),s=o.west,c=o.south,l=o.east,h=o.north,p=[];return p.push(new So(s,h,r)),p.push(new So(l,h,r)),p.push(new So(l,c,r)),p.push(new So(s,c,r)),p.push(new So(s,h,n)),p.push(new So(l,h,n)),p.push(new So(l,c,n)),p.push(new So(s,c,n)),p}function WP(e){let t=e.token,r={minimumHeight:e.minimumHeight,maximumHeight:e.maximumHeight},n=l5(t,r),i=c5(t),o=i[0],s=i[1],c=Si.WGS84.cartographicToCartesian([o,s,r.maximumHeight]),l=new So(c[0],c[1],c[2]);n.push(l);let h=pF(n);return[...h.center,...h.halfAxes]}var MOt=4,SOt=8,COt={QUADTREE:MOt,OCTREE:SOt};function POt(e,t,r){if(e?.box){let n=Tw(e.s2VolumeInfo.token),i=r5(n,t),o=e5(i),s={...e.s2VolumeInfo};switch(s.token=o,r){case"OCTREE":let h=e.s2VolumeInfo,p=h.maximumHeight-h.minimumHeight,x=p/2,w=h.minimumHeight+p/2;h.minimumHeight=w-x,h.maximumHeight=w+x;break;default:break}return{box:WP(s),s2VolumeInfo:s}}}async function h5(e){let{implicitOptions:t,parentData:r={mortonIndex:0,x:0,y:0,z:0},childIndex:n=0,s2VolumeBox:i,loaderOptions:o}=e,{subtree:s,level:c=0,globalData:l={level:0,mortonIndex:0,x:0,y:0,z:0}}=e,{subdivisionScheme:h,subtreeLevels:p,maximumLevel:x,contentUrlTemplate:w,subtreesUriTemplate:E,basePath:P}=t,B={children:[],lodMetricValue:0,contentUrl:""};if(!x)return CL.once(`Missing 'maximumLevel' or 'availableLevels' property. The subtree ${w} won't be loaded...`),B;let D=c+l.level;if(D>x)return B;let W=COt[h],X=Math.log2(W),q=n&1,$=n>>1&1,et=n>>2&1,F=(W**c-1)/(W-1),ut=J0(r.mortonIndex,n,X),ot=F+ut,J=J0(r.x,q,1),G=J0(r.y,$,1),mt=J0(r.z,et,1),Mt=!1;c>=p&&(Mt=u5(s.childSubtreeAvailability,ut));let ct=J0(l.x,J,c),gt=J0(l.y,G,c),ee=J0(l.z,mt,c);if(Mt){let Xr=`${P}/${E}`,ir=qP(Xr,D,ct,gt,ee);s=await xa(ir,jP,o),l={mortonIndex:ut,x:J,y:G,z:mt,level:c},ut=0,ot=0,J=0,G=0,mt=0,c=0}if(!u5(s.tileAvailability,ot))return B;u5(s.contentAvailability,ot)&&(B.contentUrl=qP(w,D,ct,gt,ee));let sr=c+1,gr={mortonIndex:ut,x:J,y:G,z:mt};for(let Xr=0;Xr<W;Xr++){let ir=POt(i,Xr,h),on=await h5({subtree:s,implicitOptions:t,loaderOptions:o,parentData:gr,childIndex:Xr,level:sr,globalData:{...l},s2VolumeBox:ir});if(on.contentUrl||on.children.length){let Xe=D+1,_n=IOt(on,Xe,{childTileX:J,childTileY:G,childTileZ:mt},t,i);B.children.push(_n)}}return B}function u5(e,t){let r;return Array.isArray(e)?(r=e[0],e.length>1&&CL.once('Not supported extension "3DTILES_multiple_contents" has been detected')):r=e,"constant"in r?Boolean(r.constant):r.explicitBitstream?OOt(t,r.explicitBitstream):!1}function IOt(e,t,r,n,i){let{basePath:o,refine:s,getRefine:c,lodMetricType:l,getTileType:h,rootLodMetricValue:p,rootBoundingVolume:x}=n,w=e.contentUrl&&e.contentUrl.replace(`${o}/`,""),E=p/2**t,P=i?.box?{box:i.box}:x,B=ROt(t,P,r);return{children:e.children,contentUrl:e.contentUrl,content:{uri:w},id:e.contentUrl,refine:c(s),type:h(e),lodMetricType:l,lodMetricValue:E,geometricError:E,transform:e.transform,boundingVolume:B}}function ROt(e,t,r){if(t.region){let{childTileX:n,childTileY:i,childTileZ:o}=r,[s,c,l,h,p,x]=t.region,w=2**e,E=(l-s)/w,P=(h-c)/w,B=(x-p)/w,[D,W]=[s+E*n,s+E*(n+1)],[X,q]=[c+P*i,c+P*(i+1)],[$,et]=[p+B*o,p+B*(o+1)];return{region:[D,X,W,q,$,et]}}if(t.box)return t;throw new Error(`Unsupported bounding volume type ${JSON.stringify(t)}`)}function J0(e,t,r){return(e<<r)+t}function qP(e,t,r,n,i){let o=LOt({level:t,x:r,y:n,z:i});return e.replace(/{level}|{x}|{y}|{z}/gi,s=>o[s])}function LOt(e){let t={};for(let r in e)t[`{${r}}`]=e[r];return t}function OOt(e,t){let r=Math.floor(e/8),n=e%8;return(t[r]>>n&1)===1}function p5(e,t=""){if(!t)return rh.EMPTY;let n=t.split("?")[0].split(".").pop();switch(n){case"pnts":return rh.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return rh.SCENEGRAPH;default:return n||rh.EMPTY}}function d5(e){switch(e){case"REPLACE":case"replace":return Xc.REPLACE;case"ADD":case"add":return Xc.ADD;default:return e}}function f5(e,t){if(/^[a-z][0-9a-z+.-]*:/i.test(t)){let n=new URL(e,`${t}/`);return decodeURI(n.toString())}else if(e.startsWith("/"))return e;return ou.resolve(t,e)}function $nt(e,t){if(!e)return null;let r;if(e.content){let i=e.content.uri||e.content?.url;typeof i<"u"&&(r=f5(i,t))}return{...e,id:r,contentUrl:r,lodMetricType:dd.GEOMETRIC_ERROR,lodMetricValue:e.geometricError,transformMatrix:e.transform,type:p5(e,r),refine:d5(e.refine)}}async function tit(e,t,r){let n=null,i=Jnt(e.root);i&&e.root?n=await Qnt(e.root,e,t,i,r):n=$nt(e.root,t);let o=[];for(o.push(n);o.length>0;){let s=o.pop()||{},c=s.children||[],l=[];for(let h of c){let p=Jnt(h),x;p?x=await Qnt(h,e,t,p,r):x=$nt(h,t),x&&(l.push(x),o.push(x))}s.children=l}return n}async function Qnt(e,t,r,n,i){let{subdivisionScheme:o,maximumLevel:s,availableLevels:c,subtreeLevels:l,subtrees:{uri:h}}=n,p=qP(h,0,0,0,0),x=f5(p,r),w=await xa(x,jP,i),E=e.content?.uri,P=E?f5(E,r):"",B=t?.root?.refine,D=e.geometricError,W=e.boundingVolume.extensions?.["3DTILES_bounding_volume_S2"];if(W){let et={box:WP(W),s2VolumeInfo:W};e.boundingVolume=et}let X=e.boundingVolume,q={contentUrlTemplate:P,subtreesUriTemplate:h,subdivisionScheme:o,subtreeLevels:l,maximumLevel:Number.isFinite(c)?c-1:s,refine:B,basePath:r,lodMetricType:dd.GEOMETRIC_ERROR,rootLodMetricValue:D,rootBoundingVolume:X,getTileType:p5,getRefine:d5};return await BOt(e,r,w,q,i)}async function BOt(e,t,r,n,i){if(!e)return null;let{children:o,contentUrl:s}=await h5({subtree:r,implicitOptions:n,loaderOptions:i}),c,l=null;return s&&(c=s,l={uri:s.replace(`${t}/`,"")}),{...e,id:c,contentUrl:c,lodMetricType:dd.GEOMETRIC_ERROR,lodMetricValue:e.geometricError,transformMatrix:e.transform,type:p5(e,c),refine:d5(e.refine),content:l||e.content,children:o}}function Jnt(e){return e?.extensions?.["3DTILES_implicit_tiling"]||e?.implicitTiling}var GP={dataType:null,batchType:null,id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:wP,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:DOt,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};async function DOt(e,t={},r){let n=t["3d-tiles"]||{},i;return n.isTileset==="auto"?i=r?.url&&r.url.indexOf(".json")!==-1:i=n.isTileset,i?NOt(e,t,r):kOt(e,t,r)}async function NOt(e,t,r){let n=JSON.parse(new TextDecoder().decode(e)),i=r?.url||"",o=FOt(i),s=await tit(n,o,t||{});return{...n,shape:"tileset3d",loader:GP,url:i,queryString:r?.queryString||"",basePath:o,root:s||n.root,type:oc.TILES3D,lodMetricType:dd.GEOMETRIC_ERROR,lodMetricValue:n.root?.geometricError||0}}async function kOt(e,t,r){let n={content:{shape:"tile3d",featureIds:null}};return await $F(e,0,t,r,n.content),n.content}function FOt(e){return ou.dirname(e)}var eit=[0],zOt={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:"",loader:GP,onTilesetLoad:{type:"function",value:e=>{}},onTileLoad:{type:"function",value:e=>{}},onTileUnload:{type:"function",value:e=>{}},onTileError:{type:"function",value:(e,t,r)=>{}},_getMeshColor:{type:"function",value:e=>[255,255,255]}},Ew=class extends vs{initializeState(){"onTileLoadFail"in this.props&&br.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){return Boolean(this.state?.tileset3d?.isLoaded()&&super.isLoaded)}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState({props:t,oldProps:r,changeFlags:n}){if(t.data&&t.data!==r.data&&this._loadTileset(t.data),n.viewportChanged){let{activeViewports:i}=this.state;Object.keys(i).length&&(this._updateTileset(i),this.state.lastUpdatedViewports=i,this.state.activeViewports={})}if(n.propsChanged){let{layerMap:i}=this.state;for(let o in i)i[o].needsUpdate=!0}}activateViewport(t){let{activeViewports:r,lastUpdatedViewports:n}=this.state;this.internalState.viewport=t,r[t.id]=t;let i=n?.[t.id];(!i||!t.equals(i))&&(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo({info:t,sourceLayer:r}){let n=r&&r.props.tile;return t.picked&&(t.object=n),t.sourceTile=n,t}filterSubLayer({layer:t,viewport:r}){let{tile:n}=t.props,{id:i}=r;return n.selected&&n.viewportIds.includes(i)}_updateAutoHighlight(t){let r=t.sourceTile,n=this.state.layerMap[r?.id];n&&n.layer&&n.layer.updateAutoHighlight(t)}async _loadTileset(t){let{loadOptions:r={}}=this.props,n=this.props.loader||this.props.loaders,i=Array.isArray(n)?n[0]:n,o={loadOptions:{...r}},s=t;if(i.preload){let h=await i.preload(t,r);h.url&&(s=h.url),h.headers&&(o.loadOptions.fetch={...o.loadOptions.fetch,headers:h.headers}),Object.assign(o,h)}let c=await xa(s,i,o.loadOptions),l=new xw(c,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError,...o});this.setState({tileset3d:l,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(l)}_onTileLoad(t){let{lastUpdatedViewports:r}=this.state;this.props.onTileLoad(t),this._updateTileset(r),this.setNeedsUpdate()}_onTileUnload(t){delete this.state.layerMap[t.id],this.props.onTileUnload(t)}_updateTileset(t){if(!t)return;let{tileset3d:r}=this.state,{timeline:n}=this.context,i=Object.keys(t).length;!n||!i||!r||r.selectTiles(Object.values(t)).then(o=>{this.state.frameNumber!==o&&this.setState({frameNumber:o})})}_getSubLayer(t,r){if(!t.content)return null;switch(t.type){case rh.POINTCLOUD:return this._makePointCloudLayer(t,r);case rh.SCENEGRAPH:return this._make3DModelLayer(t);case rh.MESH:return this._makeSimpleMeshLayer(t,r);default:throw new Error(`Tile3DLayer: Failed to render layer of type ${t.content.type}`)}}_makePointCloudLayer(t,r){let{attributes:n,pointCount:i,constantRGBA:o,cartographicOrigin:s,modelMatrix:c}=t.content,{positions:l,normals:h,colors:p}=n;if(!l)return null;let x=r&&r.props.data||{header:{vertexCount:i},attributes:{POSITION:l,NORMAL:h,COLOR_0:p}},{pointSize:w,getPointColor:E}=this.props,P=this.getSubLayerClass("pointcloud",n3);return new P({pointSize:w},this.getSubLayerProps({id:"pointcloud"}),{id:`${this.id}-pointcloud-${t.id}`,tile:t,data:x,coordinateSystem:Yr.METER_OFFSETS,coordinateOrigin:s,modelMatrix:c,getColor:o||E,_offset:0})}_make3DModelLayer(t){let{gltf:r,instances:n,cartographicOrigin:i,modelMatrix:o}=t.content,s=this.getSubLayerClass("scenegraph",IC);return new s({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:`${this.id}-scenegraph-${t.id}`,tile:t,data:n||eit,scenegraph:r,coordinateSystem:Yr.METER_OFFSETS,coordinateOrigin:i,modelMatrix:o,getTransformMatrix:c=>c.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(t,r){let n=t.content,{attributes:i,indices:o,modelMatrix:s,cartographicOrigin:c,coordinateSystem:l=Yr.METER_OFFSETS,material:h,featureIds:p}=n,{_getMeshColor:x}=this.props,w=r&&r.props.mesh||new Mi({topology:"triangle-list",attributes:UOt(i),indices:o}),E=this.getSubLayerClass("mesh",TQ);return new E(this.getSubLayerProps({id:"mesh"}),{id:`${this.id}-mesh-${t.id}`,tile:t,mesh:w,data:eit,getColor:x(t),pbrMaterial:h,modelMatrix:s,coordinateOrigin:c,coordinateSystem:l,featureIds:p,_offset:0})}renderLayers(){let{tileset3d:t,layerMap:r}=this.state;return t?t.tiles.map(n=>{let i=r[n.id]=r[n.id]||{tile:n},{layer:o}=i;return n.selected&&(o?i.needsUpdate&&(o=this._getSubLayer(n,o),i.needsUpdate=!1):o=this._getSubLayer(n)),i.layer=o,o}).filter(Boolean):null}};Ew.defaultProps=zOt;Ew.layerName="Tile3DLayer";var rit=Ew;function UOt(e){let t={};return t.positions={...e.positions,value:new Float32Array(e.positions.value)},e.normals&&(t.normals=e.normals),e.texCoords&&(t.texCoords=e.texCoords),e.colors&&(t.colors=e.colors),e.uvRegions&&(t.uvRegions=e.uvRegions),t}var VOt=new Map([["centerX",Float64Array.BYTES_PER_ELEMENT],["centerY",Float64Array.BYTES_PER_ELEMENT],["centerZ",Float64Array.BYTES_PER_ELEMENT],["minHeight",Float32Array.BYTES_PER_ELEMENT],["maxHeight",Float32Array.BYTES_PER_ELEMENT],["boundingSphereCenterX",Float64Array.BYTES_PER_ELEMENT],["boundingSphereCenterY",Float64Array.BYTES_PER_ELEMENT],["boundingSphereCenterZ",Float64Array.BYTES_PER_ELEMENT],["boundingSphereRadius",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointX",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointY",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointZ",Float64Array.BYTES_PER_ELEMENT]]);function m5(e){return e>>1^-(e&1)}function jOt(e){let t=0,r={};for(let[n,i]of VOt){let o=i===8?e.getFloat64:e.getFloat32;r[n]=o.call(e,t,!0),t+=i}return{header:r,headerEndPosition:t}}function HOt(e,t){let r=t,n=3,i=e.getUint32(r,!0),o=new Uint16Array(i*n);r+=Uint32Array.BYTES_PER_ELEMENT;let s=Uint16Array.BYTES_PER_ELEMENT,c=i*s,l=r,h=l+c,p=h+c,x=0,w=0,E=0;for(let P=0;P<i;P++)x+=m5(e.getUint16(l+s*P,!0)),w+=m5(e.getUint16(h+s*P,!0)),E+=m5(e.getUint16(p+s*P,!0)),o[P]=x,o[P+i]=w,o[P+i*2]=E;return r+=c*3,{vertexData:o,vertexDataEndPosition:r}}function Mw(e,t,r,n,i=!0){let o;if(n===2?o=new Uint16Array(e,t,r):o=new Uint32Array(e,t,r),!i)return o;let s=0;for(let c=0;c<o.length;++c){let l=o[c];o[c]=s-l,l===0&&++s}return o}function WOt(e,t,r){let n=r,i=3,s=t.length/i>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT;n%s!==0&&(n+=s-n%s);let c=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;let l=c*3,h=Mw(e.buffer,n,l,s);return n+=l*s,{triangleIndicesEndPosition:n,triangleIndices:h}}function qOt(e,t,r){let n=r,i=3,s=t.length/i>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT,c=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;let l=Mw(e.buffer,n,c,s,!1);n+=c*s;let h=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;let p=Mw(e.buffer,n,h,s,!1);n+=h*s;let x=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;let w=Mw(e.buffer,n,x,s,!1);n+=x*s;let E=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;let P=Mw(e.buffer,n,E,s,!1);return n+=E*s,{edgeIndicesEndPosition:n,westIndices:l,southIndices:p,eastIndices:w,northIndices:P}}function GOt(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function XOt(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}function YOt(e,t){let r={};if(e.byteLength<=t)return{extensions:r,extensionsEndPosition:t};let n=t;for(;n<e.byteLength;){let i=e.getUint8(n,!0);n+=Uint8Array.BYTES_PER_ELEMENT;let o=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;let s=new DataView(e.buffer,n,o);switch(i){case 1:{r.vertexNormals=GOt(s);break}case 2:{r.waterMask=XOt(s);break}default:}n+=o}return{extensions:r,extensionsEndPosition:n}}var tg={header:0,vertices:1,triangleIndices:2,edgeIndices:3,extensions:4},KOt={maxDecodingStep:tg.extensions};function A5(e,t){let r=Object.assign({},KOt,t),n=new DataView(e),{header:i,headerEndPosition:o}=jOt(n);if(r.maxDecodingStep<tg.vertices)return{header:i};let{vertexData:s,vertexDataEndPosition:c}=HOt(n,o);if(r.maxDecodingStep<tg.triangleIndices)return{header:i,vertexData:s};let{triangleIndices:l,triangleIndicesEndPosition:h}=WOt(n,s,c);if(r.maxDecodingStep<tg.edgeIndices)return{header:i,vertexData:s,triangleIndices:l};let{westIndices:p,southIndices:x,eastIndices:w,northIndices:E,edgeIndicesEndPosition:P}=qOt(n,s,h);if(r.maxDecodingStep<tg.extensions)return{header:i,vertexData:s,triangleIndices:l,westIndices:p,northIndices:E,eastIndices:w,southIndices:x};let{extensions:B}=YOt(n,P);return{header:i,vertexData:s,triangleIndices:l,westIndices:p,northIndices:E,eastIndices:w,southIndices:x,extensions:B}}function XP(e,t,r,n){let i=n?$Ot(n,e.POSITION.value):ZOt(t),o=new e.POSITION.value.constructor(i.length*6),s=new e.TEXCOORD_0.value.constructor(i.length*4),c=new t.constructor(i.length*6);for(let h=0;h<i.length;h++){let p=i[h];QOt({edge:p,edgeIndex:h,attributes:e,skirtHeight:r,newPosition:o,newTexcoord0:s,newTriangles:c})}e.POSITION.value=fv(e.POSITION.value,o),e.TEXCOORD_0.value=fv(e.TEXCOORD_0.value,s);let l=t instanceof Array?t.concat(c):fv(t,c);return{attributes:e,triangles:l}}function ZOt(e){let t=[];for(let i=0;i<e.length;i+=3)t.push([e[i],e[i+1]]),t.push([e[i+1],e[i+2]]),t.push([e[i+2],e[i]]);t.sort((i,o)=>Math.min(...i)-Math.min(...o)||Math.max(...i)-Math.max(...o));let r=[],n=0;for(;n<t.length;)t[n][0]===t[n+1]?.[1]&&t[n][1]===t[n+1]?.[0]?n+=2:(r.push(t[n]),n++);return r}function $Ot(e,t){e.westIndices.sort((n,i)=>t[3*n+1]-t[3*i+1]),e.eastIndices.sort((n,i)=>t[3*i+1]-t[3*n+1]),e.southIndices.sort((n,i)=>t[3*i]-t[3*n]),e.northIndices.sort((n,i)=>t[3*n]-t[3*i]);let r=[];for(let n in e){let i=e[n];for(let o=0;o<i.length-1;o++)r.push([i[o],i[o+1]])}return r}function QOt({edge:e,edgeIndex:t,attributes:r,skirtHeight:n,newPosition:i,newTexcoord0:o,newTriangles:s}){let c=r.POSITION.value.length,l=t*2,h=t*2+1;i.set(r.POSITION.value.subarray(e[0]*3,e[0]*3+3),l*3),i[l*3+2]=i[l*3+2]-n,i.set(r.POSITION.value.subarray(e[1]*3,e[1]*3+3),h*3),i[h*3+2]=i[h*3+2]-n,o.set(r.TEXCOORD_0.value.subarray(e[0]*2,e[0]*2+2),l*2),o.set(r.TEXCOORD_0.value.subarray(e[1]*2,e[1]*2+2),h*2);let p=t*2*3;s[p]=e[0],s[p+1]=c/3+h,s[p+2]=e[1],s[p+3]=c/3+h,s[p+4]=e[0],s[p+5]=c/3+l}function g5(e,t={}){let{bounds:r}=t,{header:n,vertexData:i,triangleIndices:o,westIndices:s,northIndices:c,eastIndices:l,southIndices:h}=A5(e,tg.triangleIndices),p=o,x=JOt(i,n,r),w=Bp(x);if(t?.skirtHeight){let{attributes:E,triangles:P}=XP(x,p,t.skirtHeight,{westIndices:s,northIndices:c,eastIndices:l,southIndices:h});x=E,p=P}return{loaderData:{header:{}},header:{vertexCount:p.length,boundingBox:w},schema:void 0,topology:"triangle-list",mode:4,indices:{value:p,size:1},attributes:x}}function JOt(e,t,r){let{minHeight:n,maxHeight:i}=t,[o,s,c,l]=r||[0,0,1,1],h=c-o,p=l-s,x=i-n,w=e.length/3,E=new Float32Array(w*3),P=new Float32Array(w*2);for(let B=0;B<w;B++){let D=e[B]/32767,W=e[B+w]/32767,X=e[B+w*2]/32767;E[3*B+0]=D*h+o,E[3*B+1]=W*p+s,E[3*B+2]=X*x+n,P[2*B+0]=D,P[2*B+1]=W}return{POSITION:{value:E,size:3},TEXCOORD_0:{value:P,size:2}}}var Sw=class{constructor(t=257){this.gridSize=t;let r=t-1;if(r&r-1)throw new Error(`Expected grid size to be 2^n+1, got ${t}.`);this.numTriangles=r*r*2-2,this.numParentTriangles=this.numTriangles-r*r,this.indices=new Uint32Array(this.gridSize*this.gridSize),this.coords=new Uint16Array(this.numTriangles*4);for(let n=0;n<this.numTriangles;n++){let i=n+2,o=0,s=0,c=0,l=0,h=0,p=0;for(i&1?c=l=h=r:o=s=p=r;(i>>=1)>1;){let w=o+c>>1,E=s+l>>1;i&1?(c=o,l=s,o=h,s=p):(o=c,s=l,c=h,l=p),h=w,p=E}let x=n*4;this.coords[x+0]=o,this.coords[x+1]=s,this.coords[x+2]=c,this.coords[x+3]=l}}createTile(t){return new _5(t,this)}},_5=class{constructor(t,r){let n=r.gridSize;if(t.length!==n*n)throw new Error(`Expected terrain data of length ${n*n} (${n} x ${n}), got ${t.length}.`);this.terrain=t,this.martini=r,this.errors=new Float32Array(t.length),this.update()}update(){let{numTriangles:t,numParentTriangles:r,coords:n,gridSize:i}=this.martini,{terrain:o,errors:s}=this;for(let c=t-1;c>=0;c--){let l=c*4,h=n[l+0],p=n[l+1],x=n[l+2],w=n[l+3],E=h+x>>1,P=p+w>>1,B=E+P-p,D=P+h-E,W=(o[p*i+h]+o[w*i+x])/2,X=P*i+E,q=Math.abs(W-o[X]);if(s[X]=Math.max(s[X],q),c<r){let $=(p+D>>1)*i+(h+B>>1),et=(w+D>>1)*i+(x+B>>1);s[X]=Math.max(s[X],s[$],s[et])}}}getMesh(t=0){let{gridSize:r,indices:n}=this.martini,{errors:i}=this,o=0,s=0,c=r-1;n.fill(0);function l(E,P,B,D,W,X){let q=E+B>>1,$=P+D>>1;Math.abs(E-W)+Math.abs(P-X)>1&&i[$*r+q]>t?(l(W,X,E,P,q,$),l(B,D,W,X,q,$)):(n[P*r+E]=n[P*r+E]||++o,n[D*r+B]=n[D*r+B]||++o,n[X*r+W]=n[X*r+W]||++o,s++)}l(0,0,c,c,c,0),l(c,c,0,0,0,c);let h=new Uint16Array(o*2),p=new Uint32Array(s*3),x=0;function w(E,P,B,D,W,X){let q=E+B>>1,$=P+D>>1;if(Math.abs(E-W)+Math.abs(P-X)>1&&i[$*r+q]>t)w(W,X,E,P,q,$),w(B,D,W,X,q,$);else{let et=n[P*r+E]-1,F=n[D*r+B]-1,ut=n[X*r+W]-1;h[2*et]=E,h[2*et+1]=P,h[2*F]=B,h[2*F+1]=D,h[2*ut]=W,h[2*ut+1]=X,p[x++]=et,p[x++]=F,p[x++]=ut}}return w(0,0,c,c,c,0),w(c,c,0,0,0,c),{vertices:h,triangles:p}}};var Cw=class{constructor(t,r,n=r){this.data=t,this.width=r,this.height=n,this.coords=[],this.triangles=[],this._halfedges=[],this._candidates=[],this._queueIndices=[],this._queue=[],this._errors=[],this._rms=[],this._pending=[],this._pendingLen=0,this._rmsSum=0;let i=r-1,o=n-1,s=this._addPoint(0,0),c=this._addPoint(i,0),l=this._addPoint(0,o),h=this._addPoint(i,o),p=this._addTriangle(h,s,l,-1,-1,-1);this._addTriangle(s,h,c,p,-1,-1),this._flush()}run(t=1){for(;this.getMaxError()>t;)this.refine()}refine(){this._step(),this._flush()}getMaxError(){return this._errors[0]}getRMSD(){return this._rmsSum>0?Math.sqrt(this._rmsSum/(this.width*this.height)):0}heightAt(t,r){return this.data[this.width*r+t]}_flush(){let t=this.coords;for(let r=0;r<this._pendingLen;r++){let n=this._pending[r],i=2*this.triangles[n*3+0],o=2*this.triangles[n*3+1],s=2*this.triangles[n*3+2];this._findCandidate(t[i],t[i+1],t[o],t[o+1],t[s],t[s+1],n)}this._pendingLen=0}_findCandidate(t,r,n,i,o,s,c){let l=Math.min(t,n,o),h=Math.min(r,i,s),p=Math.max(t,n,o),x=Math.max(r,i,s),w=eg(n,i,o,s,l,h),E=eg(o,s,t,r,l,h),P=eg(t,r,n,i,l,h),B=i-r,D=t-n,W=s-i,X=n-o,q=r-s,$=o-t,et=eg(t,r,n,i,o,s),F=this.heightAt(t,r)/et,ut=this.heightAt(n,i)/et,ot=this.heightAt(o,s)/et,J=0,G=0,mt=0,Mt=0;for(let ct=h;ct<=x;ct++){let gt=0;w<0&&W!==0&&(gt=Math.max(gt,Math.floor(-w/W))),E<0&&q!==0&&(gt=Math.max(gt,Math.floor(-E/q))),P<0&&B!==0&&(gt=Math.max(gt,Math.floor(-P/B)));let ee=w+W*gt,Ne=E+q*gt,Ue=P+B*gt,sr=!1;for(let gr=l+gt;gr<=p;gr++){if(ee>=0&&Ne>=0&&Ue>=0){sr=!0;let Xr=F*ee+ut*Ne+ot*Ue,ir=Math.abs(Xr-this.heightAt(gr,ct));Mt+=ir*ir,ir>J&&(J=ir,G=gr,mt=ct)}else if(sr)break;ee+=W,Ne+=q,Ue+=B}w+=X,E+=$,P+=D}(G===t&&mt===r||G===n&&mt===i||G===o&&mt===s)&&(J=0),this._candidates[2*c]=G,this._candidates[2*c+1]=mt,this._rms[c]=Mt,this._queuePush(c,J,Mt)}_step(){let t=this._queuePop(),r=t*3+0,n=t*3+1,i=t*3+2,o=this.triangles[r],s=this.triangles[n],c=this.triangles[i],l=this.coords[2*o],h=this.coords[2*o+1],p=this.coords[2*s],x=this.coords[2*s+1],w=this.coords[2*c],E=this.coords[2*c+1],P=this._candidates[2*t],B=this._candidates[2*t+1],D=this._addPoint(P,B);if(eg(l,h,p,x,P,B)===0)this._handleCollinear(D,r);else if(eg(p,x,w,E,P,B)===0)this._handleCollinear(D,n);else if(eg(w,E,l,h,P,B)===0)this._handleCollinear(D,i);else{let W=this._halfedges[r],X=this._halfedges[n],q=this._halfedges[i],$=this._addTriangle(o,s,D,W,-1,-1,r),et=this._addTriangle(s,c,D,X,-1,$+1),F=this._addTriangle(c,o,D,q,$+2,et+1);this._legalize($),this._legalize(et),this._legalize(F)}}_addPoint(t,r){let n=this.coords.length>>1;return this.coords.push(t,r),n}_addTriangle(t,r,n,i,o,s,c=this.triangles.length){let l=c/3;return this.triangles[c+0]=t,this.triangles[c+1]=r,this.triangles[c+2]=n,this._halfedges[c+0]=i,this._halfedges[c+1]=o,this._halfedges[c+2]=s,i>=0&&(this._halfedges[i]=c+0),o>=0&&(this._halfedges[o]=c+1),s>=0&&(this._halfedges[s]=c+2),this._candidates[2*l+0]=0,this._candidates[2*l+1]=0,this._queueIndices[l]=-1,this._rms[l]=0,this._pending[this._pendingLen++]=l,c}_legalize(t){let r=this._halfedges[t];if(r<0)return;let n=t-t%3,i=r-r%3,o=n+(t+1)%3,s=n+(t+2)%3,c=i+(r+2)%3,l=i+(r+1)%3,h=this.triangles[s],p=this.triangles[t],x=this.triangles[o],w=this.triangles[c],E=this.coords;if(!tBt(E[2*h],E[2*h+1],E[2*p],E[2*p+1],E[2*x],E[2*x+1],E[2*w],E[2*w+1]))return;let P=this._halfedges[o],B=this._halfedges[s],D=this._halfedges[c],W=this._halfedges[l];this._queueRemove(n/3),this._queueRemove(i/3);let X=this._addTriangle(h,w,x,-1,D,P,n),q=this._addTriangle(w,h,p,X,B,W,i);this._legalize(X+1),this._legalize(q+2)}_handleCollinear(t,r){let n=r-r%3,i=n+(r+1)%3,o=n+(r+2)%3,s=this.triangles[o],c=this.triangles[r],l=this.triangles[i],h=this._halfedges[i],p=this._halfedges[o],x=this._halfedges[r];if(x<0){let F=this._addTriangle(t,s,c,-1,p,-1,n),ut=this._addTriangle(s,t,l,F,-1,h);this._legalize(F+1),this._legalize(ut+2);return}let w=x-x%3,E=w+(x+2)%3,P=w+(x+1)%3,B=this.triangles[E],D=this._halfedges[E],W=this._halfedges[P];this._queueRemove(w/3);let X=this._addTriangle(s,c,t,p,-1,-1,n),q=this._addTriangle(c,B,t,W,-1,X+1,w),$=this._addTriangle(B,l,t,D,-1,q+1),et=this._addTriangle(l,s,t,h,X+2,$+1);this._legalize(X),this._legalize(q),this._legalize($),this._legalize(et)}_queuePush(t,r,n){let i=this._queue.length;this._queueIndices[t]=i,this._queue.push(t),this._errors.push(r),this._rmsSum+=n,this._queueUp(i)}_queuePop(){let t=this._queue.length-1;return this._queueSwap(0,t),this._queueDown(0,t),this._queuePopBack()}_queuePopBack(){let t=this._queue.pop();return this._errors.pop(),this._rmsSum-=this._rms[t],this._queueIndices[t]=-1,t}_queueRemove(t){let r=this._queueIndices[t];if(r<0){let i=this._pending.indexOf(t);if(i!==-1)this._pending[i]=this._pending[--this._pendingLen];else throw new Error("Broken triangulation (something went wrong).");return}let n=this._queue.length-1;n!==r&&(this._queueSwap(r,n),this._queueDown(r,n)||this._queueUp(r)),this._queuePopBack()}_queueLess(t,r){return this._errors[t]>this._errors[r]}_queueSwap(t,r){let n=this._queue[t],i=this._queue[r];this._queue[t]=i,this._queue[r]=n,this._queueIndices[n]=r,this._queueIndices[i]=t;let o=this._errors[t];this._errors[t]=this._errors[r],this._errors[r]=o}_queueUp(t){let r=t;for(;;){let n=r-1>>1;if(n===r||!this._queueLess(r,n))break;this._queueSwap(n,r),r=n}}_queueDown(t,r){let n=t;for(;;){let i=2*n+1;if(i>=r||i<0)break;let o=i+1,s=i;if(o<r&&this._queueLess(o,i)&&(s=o),!this._queueLess(s,n))break;this._queueSwap(n,s),n=s}return n>t}};function eg(e,t,r,n,i,o){return(r-i)*(t-o)-(n-o)*(e-i)}function tBt(e,t,r,n,i,o,s,c){let l=e-s,h=t-c,p=r-s,x=n-c,w=i-s,E=o-c,P=l*l+h*h,B=p*p+x*x,D=w*w+E*E;return l*(x*D-B*E)-h*(p*D-B*w)+P*(p*E-x*w)<0}function oit(e,t){let{meshMaxError:r,bounds:n,elevationDecoder:i}=t,{data:o,width:s,height:c}=e,l,h;switch(t.tesselator){case"martini":l=YP(o,s,c,i,t.tesselator),h=nit(r,s,l);break;case"delatin":l=YP(o,s,c,i,t.tesselator),h=iit(r,s,c,l);break;default:s===c&&!(c&s-1)?(l=YP(o,s,c,i,"martini"),h=nit(r,s,l)):(l=YP(o,s,c,i,"delatin"),h=iit(r,s,c,l));break}let{vertices:p}=h,{triangles:x}=h,w=eBt(p,l,s,c,n),E=Bp(w);if(t.skirtHeight){let{attributes:P,triangles:B}=XP(w,x,t.skirtHeight);w=P,x=B}return{loaderData:{header:{}},header:{vertexCount:x.length,boundingBox:E},mode:4,indices:{value:Uint32Array.from(x),size:1},attributes:w}}function nit(e,t,r){let n=t+1,o=new Sw(n).createTile(r),{vertices:s,triangles:c}=o.getMesh(e);return{vertices:s,triangles:c}}function iit(e,t,r,n){let i=new Cw(n,t+1,r+1);i.run(e);let{coords:o,triangles:s}=i;return{vertices:o,triangles:s}}function YP(e,t,r,n,i){let{rScaler:o,bScaler:s,gScaler:c,offset:l}=n,h=new Float32Array((t+1)*(r+1));for(let p=0,x=0;x<r;x++)for(let w=0;w<t;w++,p++){let E=p*4,P=e[E+0],B=e[E+1],D=e[E+2];h[p+x]=P*o+B*c+D*s+l}if(i==="martini"){for(let p=(t+1)*t,x=0;x<t;x++,p++)h[p]=h[p-t-1];for(let p=r,x=0;x<r+1;x++,p+=r+1)h[p]=h[p-1]}return h}function eBt(e,t,r,n,i){let o=r+1,s=e.length/2,c=new Float32Array(s*3),l=new Float32Array(s*2),[h,p,x,w]=i||[0,0,r,n],E=(x-h)/r,P=(w-p)/n;for(let B=0;B<s;B++){let D=e[B*2],W=e[B*2+1],X=W*o+D;c[3*B+0]=D*E+h,c[3*B+1]=-W*P+w,c[3*B+2]=t[X],l[2*B+0]=D/r,l[2*B+1]=W/n}return{POSITION:{value:c,size:3},TEXCOORD_0:{value:l,size:2}}}var KP="4.2.1";var ZP={dataType:null,batchType:null,name:"Terrain",id:"terrain",module:"terrain",version:KP,worker:!0,extensions:["png","pngraw","jpg","jpeg","gif","webp","bmp"],mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp"],options:{terrain:{tesselator:"auto",bounds:void 0,meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0},skirtHeight:void 0}}};var sit={dataType:null,batchType:null,name:"Quantized Mesh",id:"quantized-mesh",module:"terrain",version:KP,worker:!0,extensions:["terrain"],mimeTypes:["application/vnd.quantized-mesh"],options:{"quantized-mesh":{bounds:[0,0,1,1],skirtHeight:null}}};var rBt={...ZP,parse:nBt};async function nBt(e,t,r){let n={...t,mimeType:"application/x.image",image:{...t?.image,type:"data"}},i=await iu(e,[],n,r),o={...rBt.options.terrain,...t?.terrain};return oit(i,o)}var _Oe={...sit,parseSync:(e,t)=>g5(e,t?.["quantized-mesh"]),parse:async(e,t)=>g5(e,t?.["quantized-mesh"])};var ait=[1],iBt={...D0.defaultProps,elevationData:Bm,texture:{...Bm,optional:!0},meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:"",wireframe:!1,material:!0,loaders:[ZP]};function cit(e){return Array.isArray(e)?e.join(";"):e||""}var Pw=class extends vs{updateState({props:t,oldProps:r}){let n=t.elevationData!==r.elevationData;if(n){let{elevationData:o}=t,s=o&&(Array.isArray(o)||o.includes("{x}")&&o.includes("{y}"));this.setState({isTiled:s})}let i=n||t.meshMaxError!==r.meshMaxError||t.elevationDecoder!==r.elevationDecoder||t.bounds!==r.bounds;if(!this.state.isTiled&&i){let o=this.loadTerrain(t);this.setState({terrain:o})}t.workerUrl&&br.removed("workerUrl","loadOptions.terrain.workerUrl")()}loadTerrain({elevationData:t,bounds:r,elevationDecoder:n,meshMaxError:i,signal:o}){if(!t)return null;let s=this.getLoadOptions();s={...s,terrain:{skirtHeight:this.state.isTiled?i*2:0,...s?.terrain,bounds:r,meshMaxError:i,elevationDecoder:n}};let{fetch:c}=this.props;return c(t,{propName:"elevationData",layer:this,loadOptions:s,signal:o})}getTiledTerrainData(t){let{elevationData:r,fetch:n,texture:i,elevationDecoder:o,meshMaxError:s}=this.props,{viewport:c}=this.context,l=Qf(r,t),h=i&&Qf(i,t),{signal:p}=t,x=[0,0],w=[0,0];if(c.isGeospatial){let D=t.bbox;x=c.projectFlat([D.west,D.south]),w=c.projectFlat([D.east,D.north])}else{let D=t.bbox;x=[D.left,D.bottom],w=[D.right,D.top]}let E=[x[0],x[1],w[0],w[1]],P=this.loadTerrain({elevationData:l,bounds:E,elevationDecoder:o,meshMaxError:s,signal:p}),B=h?n(h,{propName:"texture",layer:this,loaders:[],signal:p}).catch(D=>null):Promise.resolve(null);return Promise.all([P,B])}renderSubLayers(t){let r=this.getSubLayerClass("mesh",F0),{color:n,wireframe:i,material:o}=this.props,{data:s}=t;if(!s)return null;let[c,l]=s;return new r(t,{data:ait,mesh:c,texture:l,_instanced:!1,coordinateSystem:Yr.CARTESIAN,getPosition:h=>[0,0,0],getColor:n,wireframe:i,material:o})}onViewportLoad(t){if(!t)return;let{zRange:r}=this.state,n=t.map(s=>s.content).filter(Boolean).map(s=>s[0].header.boundingBox.map(l=>l[2]));if(n.length===0)return;let i=Math.min(...n.map(s=>s[0])),o=Math.max(...n.map(s=>s[1]));(!r||i<r[0]||o>r[1])&&this.setState({zRange:[i,o]})}renderLayers(){let{color:t,material:r,elevationData:n,texture:i,wireframe:o,meshMaxError:s,elevationDecoder:c,tileSize:l,maxZoom:h,minZoom:p,extent:x,maxRequests:w,onTileLoad:E,onTileUnload:P,onTileError:B,maxCacheSize:D,maxCacheByteSize:W,refinementStrategy:X}=this.props;if(this.state.isTiled)return new D0(this.getSubLayerProps({id:"tiles"}),{getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:cit(n),texture:cit(i),meshMaxError:s,elevationDecoder:c}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize:l,maxZoom:h,minZoom:p,extent:x,maxRequests:w,onTileLoad:E,onTileUnload:P,onTileError:B,maxCacheSize:D,maxCacheByteSize:W,refinementStrategy:X});if(!n)return null;let q=this.getSubLayerClass("mesh",F0);return new q(this.getSubLayerProps({id:"mesh"}),{data:ait,mesh:this.state.terrain,texture:i,_instanced:!1,getPosition:$=>[0,0,0],getColor:t,material:r,wireframe:o})}};Pw.defaultProps=iBt;Pw.layerName="TerrainLayer";var lit=Pw;var oBt={clipBounds:[0,0,1,1],clipByInstance:void 0},uit=`
uniform clipUniforms {
  vec4 bounds;
} clip;

bool clip_isInBounds(vec2 position) {
  return position.x >= clip.bounds[0] && position.y >= clip.bounds[1] && position.x < clip.bounds[2] && position.y < clip.bounds[3];
}
`,sBt={name:"clip",vs:uit,uniformTypes:{bounds:"vec4<f32>"}},aBt={"vs:#decl":`
out float clip_isVisible;
`,"vs:DECKGL_FILTER_GL_POSITION":`
  clip_isVisible = float(clip_isInBounds(geometry.worldPosition.xy));
`,"fs:#decl":`
in float clip_isVisible;
`,"fs:DECKGL_FILTER_COLOR":`
  if (clip_isVisible < 0.5) discard;
`},cBt={name:"clip",fs:uit,uniformTypes:{bounds:"vec4<f32>"}},lBt={"vs:#decl":`
out vec2 clip_commonPosition;
`,"vs:DECKGL_FILTER_GL_POSITION":`
  clip_commonPosition = geometry.position.xy;
`,"fs:#decl":`
in vec2 clip_commonPosition;
`,"fs:DECKGL_FILTER_COLOR":`
  if (!clip_isInBounds(clip_commonPosition)) discard;
`},Iw=class extends QS{getShaders(){let t="instancePositions"in this.getAttributeManager().attributes;return this.props.clipByInstance!==void 0&&(t=Boolean(this.props.clipByInstance)),this.state.clipByInstance=t,t?{modules:[sBt],inject:aBt}:{modules:[cBt],inject:lBt}}draw(){let{clipBounds:t}=this.props,r={};if(this.state.clipByInstance)r.bounds=t;else{let n=this.projectPosition([t[0],t[1],0]),i=this.projectPosition([t[2],t[3],0]);r.bounds=[Math.min(n[0],i[0]),Math.min(n[1],i[1]),Math.max(n[0],i[0]),Math.max(n[1],i[1])]}this.setShaderModuleProps({clip:r})}};Iw.defaultProps=oBt;Iw.extensionName="ClipExtension";var y5=Iw;var Rw={x:0,y:1,z:2};function rg(e,t={}){let{start:r=0,end:n=e.length,plane:i="xy"}=t,o=t.size||2,s=0,c=Rw[i[0]],l=Rw[i[1]];for(let h=r,p=n-o;h<n;h+=o)s+=(e[h+c]-e[p+c])*(e[h+l]+e[p+l]),p=h;return s/2}function v5(e,t,r=2,n,i="xy"){let o=t&&t.length,s=o?t[0]*r:e.length,c=fit(e,0,s,r,!0,n&&n[0],i),l=[];if(!c||c.next===c.prev)return l;let h,p,x,w,E,P,B;if(o&&(c=ABt(e,t,c,r,n,i)),e.length>80*r){w=p=e[0],E=x=e[1];for(let D=r;D<s;D+=r)P=e[D],B=e[D+1],P<w&&(w=P),B<E&&(E=B),P>p&&(p=P),B>x&&(x=B);h=Math.max(p-w,x-E),h=h!==0?32767/h:0}return Lw(c,l,r,w,E,h,0),l}function fit(e,t,r,n,i,o,s){let c,l;o===void 0&&(o=rg(e,{start:t,end:r,size:n,plane:s}));let h=Rw[s[0]],p=Rw[s[1]];if(i===o<0)for(c=t;c<r;c+=n)l=hit(c,e[c+h],e[c+p],l);else for(c=r-n;c>=t;c-=n)l=hit(c,e[c+h],e[c+p],l);return l&&JP(l,l.next)&&(Bw(l),l=l.next),l}function ng(e,t){if(!e)return e;t||(t=e);let r=e,n;do if(n=!1,!r.steiner&&(JP(r,r.next)||Bs(r.prev,r,r.next)===0)){if(Bw(r),r=t=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==t);return t}function Lw(e,t,r,n,i,o,s){if(!e)return;!s&&o&&vBt(e,n,i,o);let c=e,l,h;for(;e.prev!==e.next;){if(l=e.prev,h=e.next,o?pBt(e,n,i,o):fBt(e)){t.push(l.i/r|0),t.push(e.i/r|0),t.push(h.i/r|0),Bw(e),e=h.next,c=h.next;continue}if(e=h,e===c){s?s===1?(e=dBt(ng(e),t,r),Lw(e,t,r,n,i,o,2)):s===2&&mBt(e,t,r,n,i,o):Lw(ng(e),t,r,n,i,o,1);break}}}function fBt(e){let t=e.prev,r=e,n=e.next;if(Bs(t,r,n)>=0)return!1;let i=t.x,o=r.x,s=n.x,c=t.y,l=r.y,h=n.y,p=i<o?i<s?i:s:o<s?o:s,x=c<l?c<h?c:h:l<h?l:h,w=i>o?i>s?i:s:o>s?o:s,E=c>l?c>h?c:h:l>h?l:h,P=n.next;for(;P!==t;){if(P.x>=p&&P.x<=w&&P.y>=x&&P.y<=E&&T1(i,c,o,l,s,h,P.x,P.y)&&Bs(P.prev,P,P.next)>=0)return!1;P=P.next}return!0}function pBt(e,t,r,n){let i=e.prev,o=e,s=e.next;if(Bs(i,o,s)>=0)return!1;let c=i.x,l=o.x,h=s.x,p=i.y,x=o.y,w=s.y,E=c<l?c<h?c:h:l<h?l:h,P=p<x?p<w?p:w:x<w?x:w,B=c>l?c>h?c:h:l>h?l:h,D=p>x?p>w?p:w:x>w?x:w,W=x5(E,P,t,r,n),X=x5(B,D,t,r,n),q=e.prevZ,$=e.nextZ;for(;q&&q.z>=W&&$&&$.z<=X;){if(q.x>=E&&q.x<=B&&q.y>=P&&q.y<=D&&q!==i&&q!==s&&T1(c,p,l,x,h,w,q.x,q.y)&&Bs(q.prev,q,q.next)>=0||(q=q.prevZ,$.x>=E&&$.x<=B&&$.y>=P&&$.y<=D&&$!==i&&$!==s&&T1(c,p,l,x,h,w,$.x,$.y)&&Bs($.prev,$,$.next)>=0))return!1;$=$.nextZ}for(;q&&q.z>=W;){if(q.x>=E&&q.x<=B&&q.y>=P&&q.y<=D&&q!==i&&q!==s&&T1(c,p,l,x,h,w,q.x,q.y)&&Bs(q.prev,q,q.next)>=0)return!1;q=q.prevZ}for(;$&&$.z<=X;){if($.x>=E&&$.x<=B&&$.y>=P&&$.y<=D&&$!==i&&$!==s&&T1(c,p,l,x,h,w,$.x,$.y)&&Bs($.prev,$,$.next)>=0)return!1;$=$.nextZ}return!0}function dBt(e,t,r){let n=e;do{let i=n.prev,o=n.next.next;!JP(i,o)&&pit(i,n,n.next,o)&&Ow(i,o)&&Ow(o,i)&&(t.push(i.i/r|0),t.push(n.i/r|0),t.push(o.i/r|0),Bw(n),Bw(n.next),n=e=o),n=n.next}while(n!==e);return ng(n)}function mBt(e,t,r,n,i,o){let s=e;do{let c=s.next.next;for(;c!==s.prev;){if(s.i!==c.i&&TBt(s,c)){let l=dit(s,c);s=ng(s,s.next),l=ng(l,l.next),Lw(s,t,r,n,i,o,0),Lw(l,t,r,n,i,o,0);return}c=c.next}s=s.next}while(s!==e)}function ABt(e,t,r,n,i,o){let s=[],c,l,h,p,x;for(c=0,l=t.length;c<l;c++)h=t[c]*n,p=c<l-1?t[c+1]*n:e.length,x=fit(e,h,p,n,!1,i&&i[c+1],o),x===x.next&&(x.steiner=!0),s.push(wBt(x));for(s.sort(gBt),c=0;c<s.length;c++)r=_Bt(s[c],r);return r}function gBt(e,t){return e.x-t.x}function _Bt(e,t){let r=yBt(e,t);if(!r)return t;let n=dit(r,e);return ng(n,n.next),ng(r,r.next)}function yBt(e,t){let r=t,n=e.x,i=e.y,o=-1/0,s;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){let w=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(w<=n&&w>o&&(o=w,s=r.x<r.next.x?r:r.next,w===n))return s}r=r.next}while(r!==t);if(!s)return null;let c=s,l=s.x,h=s.y,p=1/0,x;r=s;do n>=r.x&&r.x>=l&&n!==r.x&&T1(i<h?n:o,i,l,h,i<h?o:n,i,r.x,r.y)&&(x=Math.abs(i-r.y)/(n-r.x),Ow(r,e)&&(x<p||x===p&&(r.x>s.x||r.x===s.x&&xBt(s,r)))&&(s=r,p=x)),r=r.next;while(r!==c);return s}function xBt(e,t){return Bs(e.prev,e,t.prev)<0&&Bs(t.next,e,e.next)<0}function vBt(e,t,r,n){let i=e;do i.z===0&&(i.z=x5(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,bBt(i)}function bBt(e){let t,r,n=1,i,o,s,c,l,h;do{for(o=e,e=null,h=null,i=0;o;){for(i++,c=o,s=0,r=0;r<n&&(s++,c=c.nextZ,!!c);r++);for(l=n;s>0||l>0&&c;)s!==0&&(l===0||!c||o.z<=c.z)?(t=o,o=o.nextZ,s--):(t=c,c=c.nextZ,l--),h?h.nextZ=t:e=t,t.prevZ=h,h=t;o=c}h.nextZ=null,n*=2}while(i>1);return e}function x5(e,t,r,n,i){return e=(e-r)*i|0,t=(t-n)*i|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function wBt(e){let t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function T1(e,t,r,n,i,o,s,c){return(i-s)*(t-c)>=(e-s)*(o-c)&&(e-s)*(n-c)>=(r-s)*(t-c)&&(r-s)*(o-c)>=(i-s)*(n-c)}function TBt(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!EBt(e,t)&&(Ow(e,t)&&Ow(t,e)&&MBt(e,t)&&(Bs(e.prev,e,t.prev)||Bs(e,t.prev,t))||JP(e,t)&&Bs(e.prev,e,e.next)>0&&Bs(t.prev,t,t.next)>0)}function Bs(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function JP(e,t){return e.x===t.x&&e.y===t.y}function pit(e,t,r,n){let i=QP(Bs(e,t,r)),o=QP(Bs(e,t,n)),s=QP(Bs(r,n,e)),c=QP(Bs(r,n,t));return!!(i!==o&&s!==c||i===0&&$P(e,r,t)||o===0&&$P(e,n,t)||s===0&&$P(r,e,n)||c===0&&$P(r,t,n))}function $P(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function QP(e){return e>0?1:e<0?-1:0}function EBt(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&pit(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function Ow(e,t){return Bs(e.prev,e,e.next)<0?Bs(e,t,e.next)>=0&&Bs(e,e.prev,t)>=0:Bs(e,t,e.prev)<0||Bs(e,e.next,t)<0}function MBt(e,t){let r=e,n=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==e);return n}function dit(e,t){let r=new Dw(e.i,e.x,e.y),n=new Dw(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function hit(e,t,r,n){let i=new Dw(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Bw(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}var Dw=class{constructor(t,r,n){this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1,this.i=t,this.x=r,this.y=n}};function T5(e,t,r){let n=RBt(e),i=Object.keys(n).filter(o=>n[o]!==Array);return LBt(e,{propArrayTypes:n,...t},{numericPropKeys:r&&r.numericPropKeys||i,PositionDataType:r?r.PositionDataType:Float32Array,triangulate:r?r.triangulate:!0})}function RBt(e){let t={};for(let r of e)if(r.properties)for(let n in r.properties){let i=r.properties[n];t[n]=FBt(i,t[n])}return t}function LBt(e,t,r){let{pointPositionsCount:n,pointFeaturesCount:i,linePositionsCount:o,linePathsCount:s,lineFeaturesCount:c,polygonPositionsCount:l,polygonObjectsCount:h,polygonRingsCount:p,polygonFeaturesCount:x,propArrayTypes:w,coordLength:E}=t,{numericPropKeys:P=[],PositionDataType:B=Float32Array,triangulate:D=!0}=r,W=e[0]&&"id"in e[0],X=e.length>65535?Uint32Array:Uint16Array,q={type:"Point",positions:new B(n*E),globalFeatureIds:new X(n),featureIds:i>65535?new Uint32Array(n):new Uint16Array(n),numericProps:{},properties:[],fields:[]},$={type:"LineString",pathIndices:o>65535?new Uint32Array(s+1):new Uint16Array(s+1),positions:new B(o*E),globalFeatureIds:new X(o),featureIds:c>65535?new Uint32Array(o):new Uint16Array(o),numericProps:{},properties:[],fields:[]},et={type:"Polygon",polygonIndices:l>65535?new Uint32Array(h+1):new Uint16Array(h+1),primitivePolygonIndices:l>65535?new Uint32Array(p+1):new Uint16Array(p+1),positions:new B(l*E),globalFeatureIds:new X(l),featureIds:x>65535?new Uint32Array(l):new Uint16Array(l),numericProps:{},properties:[],fields:[]};D&&(et.triangles=[]);for(let ut of[q,$,et])for(let ot of P){let J=w[ot];ut.numericProps[ot]=new J(ut.positions.length/E)}$.pathIndices[s]=o,et.polygonIndices[h]=l,et.primitivePolygonIndices[p]=l;let F={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0};for(let ut of e){let ot=ut.geometry,J=ut.properties||{};switch(ot.type){case"Point":OBt(ot,q,F,E,J),q.properties.push(w5(J,P)),W&&q.fields.push({id:ut.id}),F.pointFeature++;break;case"LineString":BBt(ot,$,F,E,J),$.properties.push(w5(J,P)),W&&$.fields.push({id:ut.id}),F.lineFeature++;break;case"Polygon":DBt(ot,et,F,E,J),et.properties.push(w5(J,P)),W&&et.fields.push({id:ut.id}),F.polygonFeature++;break;default:throw new Error("Invalid geometry type")}F.feature++}return kBt(q,$,et,E)}function OBt(e,t,r,n,i){t.positions.set(e.data,r.pointPosition*n);let o=e.data.length/n;E5(t,i,r.pointPosition,o),t.globalFeatureIds.fill(r.feature,r.pointPosition,r.pointPosition+o),t.featureIds.fill(r.pointFeature,r.pointPosition,r.pointPosition+o),r.pointPosition+=o}function BBt(e,t,r,n,i){t.positions.set(e.data,r.linePosition*n);let o=e.data.length/n;E5(t,i,r.linePosition,o),t.globalFeatureIds.fill(r.feature,r.linePosition,r.linePosition+o),t.featureIds.fill(r.lineFeature,r.linePosition,r.linePosition+o);for(let s=0,c=e.indices.length;s<c;++s){let l=e.indices[s],h=s===c-1?e.data.length:e.indices[s+1];t.pathIndices[r.linePath++]=r.linePosition,r.linePosition+=(h-l)/n}}function DBt(e,t,r,n,i){t.positions.set(e.data,r.polygonPosition*n);let o=e.data.length/n;E5(t,i,r.polygonPosition,o),t.globalFeatureIds.fill(r.feature,r.polygonPosition,r.polygonPosition+o),t.featureIds.fill(r.polygonFeature,r.polygonPosition,r.polygonPosition+o);for(let s=0,c=e.indices.length;s<c;++s){let l=r.polygonPosition;t.polygonIndices[r.polygonObject++]=l;let h=e.areas[s],p=e.indices[s],x=e.indices[s+1];for(let E=0,P=p.length;E<P;++E){let B=p[E],D=E===P-1?x===void 0?e.data.length:x[0]:p[E+1];t.primitivePolygonIndices[r.polygonRing++]=r.polygonPosition,r.polygonPosition+=(D-B)/n}let w=r.polygonPosition;NBt(t,h,p,{startPosition:l,endPosition:w,coordLength:n})}}function NBt(e,t,r,{startPosition:n,endPosition:i,coordLength:o}){if(!e.triangles)return;let s=n*o,c=i*o,l=e.positions.subarray(s,c),h=r[0],p=r.slice(1).map(w=>(w-h)/o),x=v5(l,p,o,t);for(let w=0,E=x.length;w<E;++w)e.triangles.push(n+x[w])}function b5(e,t){let r={};for(let n in e)r[n]={value:e[n],size:t};return r}function kBt(e,t,r,n){let i={shape:"binary-feature-collection",points:{...e,positions:{value:e.positions,size:n},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1},numericProps:b5(e.numericProps,1)},lines:{...t,positions:{value:t.positions,size:n},pathIndices:{value:t.pathIndices,size:1},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1},numericProps:b5(t.numericProps,1)},polygons:{...r,positions:{value:r.positions,size:n},polygonIndices:{value:r.polygonIndices,size:1},primitivePolygonIndices:{value:r.primitivePolygonIndices,size:1},globalFeatureIds:{value:r.globalFeatureIds,size:1},featureIds:{value:r.featureIds,size:1},numericProps:b5(r.numericProps,1)}};return i.polygons&&r.triangles&&(i.polygons.triangles={value:new Uint32Array(r.triangles),size:1}),i}function E5(e,t,r,n){for(let i in e.numericProps)if(i in t){let o=t[i];e.numericProps[i].fill(o,r,r+n)}}function w5(e,t){let r={};for(let n in e)t.includes(n)||(r[n]=e[n]);return r}function FBt(e,t){return t===Array||!Number.isFinite(e)?Array:t===Float64Array||Math.fround(e)!==e?Float64Array:Float32Array}function rI(e,t){let r=t?.globalFeatureId;return r!==void 0?zBt(e,r):UBt(e,t?.type)}function zBt(e,t){let r=_it(e);for(let n of r){let i=0,o=n.featureIds.value[0];for(let s=0;s<n.featureIds.value.length;s++){let c=n.featureIds.value[s];if(c!==o){if(t===n.globalFeatureIds.value[i])return tI(n,i,s);i=s,o=c}}if(t===n.globalFeatureIds.value[i])return tI(n,i,n.featureIds.value.length)}throw new Error(`featureId:${t} not found`)}function UBt(e,t){let r=_it(e,t);return VBt(r)}function git(e,t,r){switch(e.type){case"Point":return qBt(e,t,r);case"LineString":return WBt(e,t,r);case"Polygon":return yit(e,t,r);default:let n=e;throw new Error(`Unsupported geometry type: ${n?.type}`)}}function _it(e,t){let r=[];return e.points&&(e.points.type="Point",r.push(e.points)),e.lines&&(e.lines.type="LineString",r.push(e.lines)),e.polygons&&(e.polygons.type="Polygon",r.push(e.polygons)),r}function VBt(e){let t=[];for(let r of e){if(r.featureIds.value.length===0)continue;let n=0,i=r.featureIds.value[0];for(let o=0;o<r.featureIds.value.length;o++){let s=r.featureIds.value[o];s!==i&&(t.push(tI(r,n,o)),n=o,i=s)}t.push(tI(r,n,r.featureIds.value.length))}return t}function tI(e,t,r){let n=git(e,t,r),i=HBt(e,t,r),o=jBt(e,t,r);return{type:"Feature",geometry:n,properties:i,...o}}function jBt(e,t=0,r){return e.fields&&e.fields[e.featureIds.value[t]]}function HBt(e,t=0,r){let n=Object.assign({},e.properties[e.featureIds.value[t]]);for(let i in e.numericProps)n[i]=e.numericProps[i].value[t];return n}function yit(e,t=-1/0,r=1/0){let{positions:n}=e,i=e.polygonIndices.value.filter(l=>l>=t&&l<=r),o=e.primitivePolygonIndices.value.filter(l=>l>=t&&l<=r);if(!(i.length>2)){let l=[];for(let h=0;h<o.length-1;h++){let p=o[h],x=o[h+1],w=eI(n,p,x);l.push(w)}return{type:"Polygon",coordinates:l}}let c=[];for(let l=0;l<i.length-1;l++){let h=i[l],p=i[l+1],x=yit(e,h,p).coordinates;c.push(x)}return{type:"MultiPolygon",coordinates:c}}function WBt(e,t=-1/0,r=1/0){let{positions:n}=e,i=e.pathIndices.value.filter(c=>c>=t&&c<=r);if(!(i.length>2))return{type:"LineString",coordinates:eI(n,i[0],i[1])};let s=[];for(let c=0;c<i.length-1;c++){let l=eI(n,i[c],i[c+1]);s.push(l)}return{type:"MultiLineString",coordinates:s}}function qBt(e,t,r){let{positions:n}=e,i=eI(n,t,r);return i.length>1?{type:"MultiPoint",coordinates:i}:{type:"Point",coordinates:i[0]}}function eI(e,t,r){t=t||0,r=r||e.value.length/e.size;let n=[];for(let i=t;i<r;i++){let o=Array();for(let s=i*e.size;s<(i+1)*e.size;s++)o.push(Number(e.value[s]));n.push(o)}return n}var L5=tc(Mit(),1);function Sit(e){let t=e.length;if(t<=1)return[e];let r=[],n,i;for(let o=0;o<t;o++){let s=l4t(e[o]);s!==0&&(i===void 0&&(i=s<0),i===s<0?(n&&r.push(n),n=[e[o]]):n&&n.push(e[o]))}return n&&r.push(n),r}function l4t(e){let t=0;for(let r=0,n=e.length-1,i,o;r<e.length;n=r++)i=e[r],o=e[n],t+=(o[0]-i[0])*(i[1]+o[1]);return t}function Cit(e,t,r){t&&r&&(e===1?t.id=r.readVarint():e===2?u4t(r,t):e===3?t.type=r.readVarint():e===4&&(t._geometry=r.pos))}function u4t(e,t){let r=e.readVarint()+e.pos;for(;e.pos<r;){let n=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[n]=i}}var S1=class{properties;extent;type;id;_pbf;_geometry;_keys;_values;static get types(){return["Unknown","Point","LineString","Polygon"]}constructor(t,r,n,i,o){this.properties={},this.extent=n,this.type=0,this.id=null,this._pbf=t,this._geometry=-1,this._keys=i,this._values=o,t.readFields(Cit,this,r)}loadGeometry(){let t=this._pbf;t.pos=this._geometry;let r=t.readVarint()+t.pos,n=1,i=0,o=0,s=0,c=[],l;for(;t.pos<r;){if(i<=0){let h=t.readVarint();n=h&7,i=h>>3}if(i--,n===1||n===2)o+=t.readSVarint(),s+=t.readSVarint(),n===1&&(l&&c.push(l),l=[]),l&&l.push([o,s]);else if(n===7)l&&l.push(l[0].slice());else throw new Error(`unknown command ${n}`)}return l&&c.push(l),c}bbox(){let t=this._pbf;t.pos=this._geometry;let r=t.readVarint()+t.pos,n=1,i=0,o=0,s=0,c=1/0,l=-1/0,h=1/0,p=-1/0;for(;t.pos<r;){if(i<=0){let x=t.readVarint();n=x&7,i=x>>3}if(i--,n===1||n===2)o+=t.readSVarint(),s+=t.readSVarint(),o<c&&(c=o),o>l&&(l=o),s<h&&(h=s),s>p&&(p=s);else if(n!==7)throw new Error(`unknown command ${n}`)}return[c,h,l,p]}_toGeoJSON(t){let r=this.loadGeometry(),n=S1.types[this.type],i,o;switch(this.type){case 1:let c=[];for(i=0;i<r.length;i++)c[i]=r[i][0];r=c,t(r,this);break;case 2:for(i=0;i<r.length;i++)t(r[i],this);break;case 3:for(r=Sit(r),i=0;i<r.length;i++)for(o=0;o<r[i].length;o++)t(r[i][o],this);break}r.length===1?r=r[0]:n=`Multi${n}`;let s={type:"Feature",geometry:{type:n,coordinates:r},properties:this.properties};return this.id!==null&&(s.id=this.id),s}toGeoJSON(t){if(typeof t=="function")return this._toGeoJSON(t);let{x:r,y:n,z:i}=t,o=this.extent*Math.pow(2,i),s=this.extent*r,c=this.extent*n;function l(h){for(let p=0;p<h.length;p++){let x=h[p];x[0]=(x[0]+s)*360/o-180;let w=180-(x[1]+c)*360/o;x[1]=360/Math.PI*Math.atan(Math.exp(w*Math.PI/180))-90}}return this._toGeoJSON(l)}};var oI=class{version;name;extent;length;_pbf;_keys;_values;_features;constructor(t,r){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(h4t,this,r),this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];let r=this._pbf.readVarint()+this._pbf.pos;return new S1(this._pbf,r,this.extent,this._keys,this._values)}};function h4t(e,t,r){t&&r&&(e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(f4t(r)))}function f4t(e){let t=null,r=e.readVarint()+e.pos;for(;e.pos<r;){let n=e.readVarint()>>3;t=n===1?e.readString():n===2?e.readFloat():n===3?e.readDouble():n===4?e.readVarint64():n===5?e.readVarint():n===6?e.readSVarint():n===7?e.readBoolean():null}return t}var sI=class{layers;constructor(t,r){this.layers=t.readFields(p4t,{},r)}};function p4t(e,t,r){if(e===3&&r){let n=new oI(r,r.readVarint()+r.pos);n.length&&t&&(t[n.name]=n)}}function Pit(e){let t=e.indices.length,r="Polygon";if(t<=1)return{type:r,data:e.data,areas:[[rg(e.data)]],indices:[e.indices]};let n=[],i=[],o=[],s=[],c,l=0;for(let h,p=0,x;p<t;p++){x=e.indices[p]-l,h=e.indices[p+1]-l||e.data.length;let w=e.data.slice(x,h),E=rg(w);if(E===0){let P=e.data.slice(0,x),B=e.data.slice(h);e.data=P.concat(B),l+=h-x;continue}c===void 0&&(c=E<0),c===E<0?(s.length&&(n.push(o),i.push(s)),s=[x],o=[E]):(o.push(E),s.push(x))}return o&&n.push(o),s.length&&i.push(s),{type:r,areas:n,indices:i,data:e.data}}function Iit(e,t,r,n){for(let i=0,o=e.length;i<o;i+=2){e[i]=(e[i]+t)*360/n-180;let s=180-(e[i+1]+r)*360/n;e[i+1]=360/Math.PI*Math.atan(Math.exp(s*Math.PI/180))-90}}function Rit(e,t,r){t&&r&&(e===1?t.id=r.readVarint():e===2?d4t(r,t):e===3?t.type=r.readVarint():e===4&&(t._geometry=r.pos))}function d4t(e,t){let r=e.readVarint()+e.pos;for(;e.pos<r;){let n=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[n]=i}}var Lit,ig,C5,aI,P5,I5,Nw;var cI=class{properties;extent;type;id;_pbf;_geometry;_keys;_values;_geometryInfo;constructor(t,r,n,i,o,s){this.properties={},this.extent=n,this.type=0,this.id=null,this._pbf=t,this._geometry=-1,this._keys=i,this._values=o,this._geometryInfo=s,t.readFields(Rit,this,r)}loadGeometry(){let t=this._pbf;t.pos=this._geometry,Lit=t.readVarint()+t.pos,ig=1,aI=0,P5=0,I5=0,Nw=0;let r=[],n=[];for(;t.pos<Lit;)if(aI<=0&&(C5=t.readVarint(),ig=C5&7,aI=C5>>3),aI--,ig===1||ig===2)P5+=t.readSVarint(),I5+=t.readSVarint(),ig===1&&r.push(Nw),n.push(P5,I5),Nw+=2;else if(ig===7){if(Nw>0){let i=r[r.length-1];n.push(n[i],n[i+1]),Nw+=2}}else throw new Error(`unknown command ${ig}`);return{data:n,indices:r}}_toBinaryCoordinates(t){let r=this.loadGeometry(),n;t(r.data,this);let i=2;switch(this.type){case 1:this._geometryInfo.pointFeaturesCount++,this._geometryInfo.pointPositionsCount+=r.indices.length,n={type:"Point",...r};break;case 2:this._geometryInfo.lineFeaturesCount++,this._geometryInfo.linePathsCount+=r.indices.length,this._geometryInfo.linePositionsCount+=r.data.length/i,n={type:"LineString",...r};break;case 3:n=Pit(r),this._geometryInfo.polygonFeaturesCount++,this._geometryInfo.polygonObjectsCount+=n.indices.length;for(let s of n.indices)this._geometryInfo.polygonRingsCount+=s.length;this._geometryInfo.polygonPositionsCount+=n.data.length/i;break;default:throw new Error(`Invalid geometry type: ${this.type}`)}let o={type:"Feature",geometry:n,properties:this.properties};return this.id!==null&&(o.id=this.id),o}toBinaryCoordinates(t){if(typeof t=="function")return this._toBinaryCoordinates(t);let{x:r,y:n,z:i}=t,o=this.extent*Math.pow(2,i),s=this.extent*r,c=this.extent*n;return this._toBinaryCoordinates(l=>Iit(l,s,c,o))}};var lI=class{version;name;extent;length;_pbf;_keys;_values;_features;constructor(t,r){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(m4t,this,r),this.length=this._features.length}feature(t,r){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];let n=this._pbf.readVarint()+this._pbf.pos;return new cI(this._pbf,n,this.extent,this._keys,this._values,r)}};function m4t(e,t,r){t&&r&&(e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(A4t(r)))}function A4t(e){let t=null,r=e.readVarint()+e.pos;for(;e.pos<r;){let n=e.readVarint()>>3;t=n===1?e.readString():n===2?e.readFloat():n===3?e.readDouble():n===4?e.readVarint64():n===5?e.readVarint():n===6?e.readSVarint():n===7?e.readBoolean():null}return t}var uI=class{layers;constructor(t,r){this.layers=t.readFields(g4t,{},r)}};function g4t(e,t,r){if(e===3&&r){let n=new lI(r,r.readVarint()+r.pos);n.length&&t&&(t[n.name]=n)}}function O5(e,t){let r=y4t(t),n=t?.gis?.format||t?.mvt?.shape||t?.shape;switch(n){case"columnar-table":return{shape:"columnar-table",data:R5(e,r)};case"geojson-table":return{shape:"geojson-table",type:"FeatureCollection",features:Oit(e,r)};case"geojson":return Oit(e,r);case"binary-geometry":return R5(e,r);case"binary":return R5(e,r);default:throw new Error(n||"undefined shape")}}function R5(e,t){let[r,n]=_4t(e,t),i=T5(r,n);return i.byteLength=e.byteLength,i}function _4t(e,t){let r=[],n={coordLength:2,pointPositionsCount:0,pointFeaturesCount:0,linePositionsCount:0,linePathsCount:0,lineFeaturesCount:0,polygonPositionsCount:0,polygonObjectsCount:0,polygonRingsCount:0,polygonFeaturesCount:0};if(e.byteLength<=0)return[r,n];let i=new uI(new L5.default(e));return(t&&Array.isArray(t.layers)?t.layers:Object.keys(i.layers)).forEach(s=>{let c=i.layers[s];if(c)for(let l=0;l<c.length;l++){let h=c.feature(l,n),p=v4t(h,t,s);r.push(p)}}),[r,n]}function Oit(e,t){if(e.byteLength<=0)return[];let r=[],n=new sI(new L5.default(e));return(Array.isArray(t.layers)?t.layers:Object.keys(n.layers)).forEach(o=>{let s=n.layers[o];if(s)for(let c=0;c<s.length;c++){let l=s.feature(c),h=x4t(l,t,o);r.push(h)}}),r}function y4t(e){if(!e?.mvt)throw new Error("mvt options required");let t=e.mvt?.coordinates==="wgs84",{tileIndex:r}=e.mvt,n=r&&Number.isFinite(r.x)&&Number.isFinite(r.y)&&Number.isFinite(r.z);if(t&&!n)throw new Error("MVT Loader: WGS84 coordinates need tileIndex property");return e.mvt}function x4t(e,t,r){let n=e.toGeoJSON(t.coordinates==="wgs84"?t.tileIndex:b4t);return t.layerProperty&&(n.properties[t.layerProperty]=r),n}function v4t(e,t,r){let n=e.toBinaryCoordinates(t.coordinates==="wgs84"?t.tileIndex:w4t);return t.layerProperty&&n.properties&&(n.properties[t.layerProperty]=r),n}function b4t(e,t){let{extent:r}=t;for(let n=0;n<e.length;n++){let i=e[n];i[0]/=r,i[1]/=r}}function w4t(e,t){let{extent:r}=t;for(let n=0,i=e.length;n<i;++n)e[n]/=r}var T4t="4.2.1",hI={dataType:null,batchType:null,name:"Mapbox Vector Tile",id:"mvt",module:"mvt",version:T4t,extensions:["mvt","pbf"],mimeTypes:["application/vnd.mapbox-vector-tile","application/x-protobuf"],worker:!0,category:"geometry",options:{mvt:{shape:"geojson",coordinates:"local",layerProperty:"layerName",layers:void 0,tileIndex:null}}},E4t={...hI,parse:async(e,t)=>O5(e,t),parseSync:O5,binary:!0};var M4t={Point:Bit,MultiPoint:S4t,LineString:Dit,MultiLineString:C4t,Polygon:Nit,MultiPolygon:P4t};function Bit([e,t],[r,n],i){let o=ka(r[0],n[0],e),s=ka(r[1],n[1],t);return i.unprojectFlat([o,s])}function B5(e,t,r){return e.map(n=>Bit(n,t,r))}function S4t(e,t,r){return B5(e,t,r)}function Dit(e,t,r){return B5(e,t,r)}function C4t(e,t,r){return e.map(n=>Dit(n,t,r))}function Nit(e,t,r){return e.map(n=>B5(n,t,r))}function P4t(e,t,r){return e.map(n=>Nit(n,t,r))}function kit(e,t,r){let n=r.projectFlat([t.west,t.north]),i=r.projectFlat([t.east,t.south]),o=[n,i];return{...e,coordinates:M4t[e.type](e.coordinates,o,r)}}var I4t=["points","lines","polygons"];function D5(e,t,r,n){for(let i of I4t){let o=e[i]&&R4t(e[i],t,r,n);if(o>=0)return o}return-1}function R4t(e,t,r,n){let i=e.featureIds.value;if(!i.length)return-1;let o=0,s=i[i.length-1]+1;if(n){let l=L4t(e,n);if(l)o=l[0],s=l[1]+1;else return-1}let c=-1;if(t in e.numericProps){let l=e.numericProps[t].value.findIndex((h,p)=>h===r&&i[p]>=o&&i[p]<s);return l>=0?e.globalFeatureIds.value[l]:-1}else t?c=Fit(e.properties,l=>l[t]===r,o,s):e.fields&&(c=Fit(e.fields,l=>l.id===r,o,s));return c>=0?O4t(e,c):-1}function L4t(e,t){if(!e.__layers){let r={},{properties:n}=e;for(let i=0;i<n.length;i++){let{layerName:o}=n[i];o&&(r[o]?r[o][1]=i:r[o]=[i,i])}e.__layers=r}return e.__layers[t]}function O4t(e,t){if(!e.__ids){let r=[],n=e.featureIds.value,i=e.globalFeatureIds.value;for(let o=0;o<n.length;o++)r[n[o]]=i[o];e.__ids=r}return e.__ids[t]}function Fit(e,t,r,n){for(let i=r;i<n;i++)if(t(e[i],i))return i;return-1}var N5=512,B4t={...C0.defaultProps,data:Bm,onDataLoad:{type:"function",value:null,optional:!0,compare:!1},uniqueIdProperty:"",highlightedFeatureId:null,loaders:[hI],binary:!0},kw=class extends D0{initializeState(){super.initializeState();let t=this.context.viewport.resolution!==void 0?!1:this.props.binary;this.setState({binary:t,data:null,tileJSON:null,hoveredFeatureId:null,hoveredFeatureLayerName:null})}get isLoaded(){return Boolean(this.state?.data&&super.isLoaded)}updateState({props:t,oldProps:r,context:n,changeFlags:i}){i.dataChanged&&this._updateTileData(),this.state?.data&&(super.updateState({props:t,oldProps:r,context:n,changeFlags:i}),this._setWGS84PropertyForTiles());let{highlightColor:o}=t;o!==r.highlightColor&&Array.isArray(o)&&this.setState({highlightColor:o})}async _updateTileData(){let t=this.props.data,r=null;if(typeof t=="string"&&!TN(t)){let{onDataLoad:n,fetch:i}=this.props;this.setState({data:null,tileJSON:null});try{r=await i(t,{propName:"data",layer:this,loaders:[]})}catch(o){this.raiseError(o,"loading TileJSON"),t=null}n&&n(r,{propName:"data",layer:this})}else t&&typeof t=="object"&&"tilejson"in t&&(r=t);r&&(t=r.tiles),this.setState({data:t,tileJSON:r})}_getTilesetOptions(){let t=super._getTilesetOptions(),r=this.state.tileJSON,{minZoom:n,maxZoom:i}=this.props;return r&&(Number.isFinite(r.minzoom)&&r.minzoom>n&&(t.minZoom=r.minzoom),Number.isFinite(r.maxzoom)&&(!Number.isFinite(i)||r.maxzoom<i)&&(t.maxZoom=r.maxzoom)),t}renderLayers(){return this.state?.data?super.renderLayers():null}getTileData(t){let{data:r,binary:n}=this.state,{index:i,signal:o}=t,s=Qf(r,t);if(!s)return Promise.reject("Invalid URL");let c=this.getLoadOptions(),{fetch:l}=this.props;return c={...c,mimeType:"application/x-protobuf",mvt:{...c?.mvt,coordinates:this.context.viewport.resolution?"wgs84":"local",tileIndex:i},gis:n?{format:"binary"}:{}},l(s,{propName:"data",layer:this,loadOptions:c,signal:o})}renderSubLayers(t){let{x:r,y:n,z:i}=t.tile.index,o=Math.pow(2,i),s=N5/o,c=-s,l=N5*r/o,h=N5*(1-n/o),p=new Fn().scale([s,c,1]);t.autoHighlight=!1,this.context.viewport.resolution||(t.modelMatrix=p,t.coordinateOrigin=[l,h,0],t.coordinateSystem=Yr.CARTESIAN,t.extensions=[...t.extensions||[],new y5]);let x=super.renderSubLayers(t);return this.state.binary&&!(x instanceof C0)&&br.warn("renderSubLayers() must return GeoJsonLayer when using binary:true")(),x}_updateAutoHighlight(t){let{uniqueIdProperty:r}=this.props,{hoveredFeatureId:n,hoveredFeatureLayerName:i}=this.state,o=t.object,s=null,c=null;o&&(s=k5(o,r),c=zit(o));let{highlightColor:l}=this.props;typeof l=="function"&&(l=l(t)),(n!==s||i!==c)&&this.setState({highlightColor:l,hoveredFeatureId:s,hoveredFeatureLayerName:c})}_isWGS84(){return Boolean(this.context.viewport.resolution)}getPickingInfo(t){let r=super.getPickingInfo(t);if(this.state.binary&&r.index!==-1){let{data:n}=t.sourceLayer.props;r.object=rI(n,{globalFeatureId:r.index})}return r.object&&!this._isWGS84()&&(r.object=Vit(r.object,r.tile.bbox,this.context.viewport)),r}getSubLayerPropsByTile(t){return{highlightedObjectIndex:this.getHighlightedObjectIndex(t),highlightColor:this.state.highlightColor}}getHighlightedObjectIndex(t){let{hoveredFeatureId:r,hoveredFeatureLayerName:n,binary:i}=this.state,{uniqueIdProperty:o,highlightedFeatureId:s}=this.props,c=t.content,l=Uit(s);if(!(Uit(r)||l))return-1;let p=l?s:r;return Array.isArray(c)?c.findIndex(x=>{let w=k5(x,o)===p,E=l||zit(x)===n;return w&&E}):c&&i?D5(c,o,p,l?"":n):-1}_pickObjects(t){let{deck:r,viewport:n}=this.context,i=n.width,o=n.height,s=n.x,c=n.y,l=[this.id];return r.pickObjects({x:s,y:c,width:i,height:o,layerIds:l,maxObjects:t})}getRenderedFeatures(t=null){let r=this._pickObjects(t),n=new Set,i=[];for(let o of r){let s=k5(o.object,this.props.uniqueIdProperty);s===void 0?i.push(o.object):n.has(s)||(n.add(s),i.push(o.object))}return i}_setWGS84PropertyForTiles(){let t="dataInWGS84";this.state.tileset.selectedTiles.forEach(n=>{n.hasOwnProperty(t)||Object.defineProperty(n,t,{get:()=>{if(!n.content)return null;if(this.state.binary&&Array.isArray(n.content)&&!n.content.length)return[];let{bbox:i}=n;if(n._contentWGS84===void 0&&EN(i)){let o=this.state.binary?rI(n.content):n.content;n._contentWGS84=o.map(s=>Vit(s,i,this.context.viewport))}return n._contentWGS84}})})}};kw.layerName="MVTLayer";kw.defaultProps=B4t;var jit=kw;function k5(e,t){if(e.properties&&t)return e.properties[t];if("id"in e)return e.id}function zit(e){return e.properties?.layerName||null}function Uit(e){return e!=null&&e!==""}function Vit(e,t,r){let n={...e,geometry:{type:e.geometry.type}};return Object.defineProperty(n.geometry,"coordinates",{get:()=>kit(e.geometry,t,r).coordinates}),n}var Hit="0123456789bcdefghjkmnpqrstuvwxyz",Wit={};for(let e=0;e<Hit.length;e++)Wit[Hit.charAt(e)]=e;var D4t=-90,N4t=90,k4t=-180,F4t=180;function z4t(e){let t=!0,r=N4t,n=D4t,i=F4t,o=k4t,s,c=0;for(let l=0,h=e.length;l<h;l++){let p=e[l].toLowerCase();c=Wit[p];for(let x=4;x>=0;x--){let w=c>>x&1;t?(s=(i+o)/2,w===1?o=s:i=s):(s=(r+n)/2,w===1?n=s:r=s),t=!t}}return[n,o,r,i]}function qit(e){let[t,r,n,i]=z4t(e);return[i,n,i,t,r,t,r,n,i,n]}var U4t={getGeohash:{type:"accessor",value:e=>e.geohash}},Fw=class extends Zf{indexToBounds(){let{data:t,getGeohash:r}=this.props;return{data:t,_normalize:!1,positionFormat:"XY",getPolygon:(n,i)=>qit(r(n,i))}}};Fw.layerName="GeohashLayer";Fw.defaultProps=U4t;var Git=Fw;function C1(e,t=""){if(!e)throw new Error(`JSON conversion error ${t}`)}function Yit(e,t){let r=j4t(t),n=e;for(let i of r)n=V4t(n)?n[i]:void 0;return n}function V4t(e){return e!==null&&typeof e=="object"}var Xit={};function j4t(e){if(typeof e=="string"){let t=Xit[e];return t||(t=e.split("."),Xit[e]=t),t}return Array.isArray(e)?e:[e]}var F5=tc(Kit(),1);var Zit={"||":(e,t)=>e||t,"&&":(e,t)=>e&&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"&":(e,t)=>e&t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"<":(e,t)=>e<t,">":(e,t)=>e>t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"*":(e,t)=>e*t,"/":(e,t)=>e/t,"%":(e,t)=>e%t},H4t={"-":e=>-e,"+":e=>+e,"~":e=>~e,"!":e=>!e};function $it(e,t){return e.map(function(r){return sc(r,t)})}function Qit(e,t){let r=sc(e.object,t),n;if(e.computed?n=sc(e.property,t):n=e.property.name,/^__proto__|prototype|constructor$/.test(n))throw Error(`Access to member "${n}" disallowed.`);return[r,r[n]]}function sc(e,t){let r=e;switch(r.type){case"ArrayExpression":return $it(r.elements,t);case"BinaryExpression":return Zit[r.operator](sc(r.left,t),sc(r.right,t));case"CallExpression":let n,i,o;return r.callee.type==="MemberExpression"?(o=Qit(r.callee,t),n=o[0],i=o[1]):i=sc(r.callee,t),typeof i!="function"?void 0:i.apply(n,$it(r.arguments,t));case"ConditionalExpression":return sc(r.test,t)?sc(r.consequent,t):sc(r.alternate,t);case"Identifier":return t[r.name];case"Literal":return r.value;case"LogicalExpression":return r.operator==="||"?sc(r.left,t)||sc(r.right,t):r.operator==="&&"?sc(r.left,t)&&sc(r.right,t):Zit[r.operator](sc(r.left,t),sc(r.right,t));case"MemberExpression":return Qit(r,t)[1];case"ThisExpression":return t;case"UnaryExpression":return H4t[r.operator](sc(r.argument,t));default:return}}var z5={"-":e=>e};function og(e,t){if(e in z5)return z5[e];let r,n=(0,F5.default)(e);return n.type==="Identifier"?r=i=>Yit(i,e):(U5(n,i=>{if(i.type==="CallExpression")throw new Error("Function calls not allowed in JSON expressions")}),r=i=>sc(n,i)),z5[e]=r,r}function U5(e,t){if(Array.isArray(e))e.forEach(r=>U5(r,t));else if(e&&typeof e=="object"){e.type&&t(e);for(let r in e)U5(e[r],t)}}var P1="@@=",V5="@@#",Jit="@@type",pI="@@function";var tot=e=>e&&typeof e=="object",yd=class{constructor(...t){this.typeKey=Jit,this.functionKey=pI,this.log=console,this.classes={},this.reactComponents={},this.enumerations={},this.constants={},this.functions={},this.React=null,this.convertFunction=og,this.preProcessClassProps=(r,n)=>n,this.postProcessConvertedJson=r=>r;for(let r of t)this.merge(r)}merge(t){for(let r in t)switch(r){case"layers":case"views":Object.assign(this.classes,t[r]);break;default:if(r in this){let n=t[r];this[r]=tot(this[r])?Object.assign(this[r],n):n}}}validate(t){return C1(!this.typeKey||typeof this.typeKey=="string"),C1(tot(this.classes)),!0}};function W4t(e){return typeof e=="string"&&e.startsWith(P1)}function q4t(e){return e.replace(P1,"")}function I1(e,t){let r={};for(let n in e){let i=e[n];W4t(i)&&(i=q4t(i),i=og(i,t)),r[n]=i}return r}function eot(e,t,r){let n=r.classes[e],i=r.reactComponents[e];if(!n&&!i){let{log:o}=r;if(o){let s=JSON.stringify(t,null,0).slice(0,40);o.warn(`JSON converter: No registered class of type ${e}(${s}...)  `)}return null}return n?G4t(n,t,r):X4t(i,t,r)}function G4t(e,t,r){return r.preProcessClassProps&&(t=r.preProcessClassProps(e,t,r)),t=I1(t,r),new e(t)}function X4t(e,t,r){let{React:n}=r,{children:i=[]}=t;return delete t.children,r.preProcessClassProps&&(t=r.preProcessClassProps(e,t,r)),t=I1(t,r),n.createElement(e,t,i)}function rot(e,t,r){let n=r.functions[e];if(!n){let{log:i}=r;if(i){let o=JSON.stringify(t,null,0).slice(0,40);i.warn(`JSON converter: No registered function ${e}(${o}...)  `)}return null}return n(t)}function j5(e){return typeof e=="string"?JSON.parse(e):e}var H5=e=>e&&typeof e=="object",sg=class{constructor(t){this.log=console,this.onJSONChange=()=>{},this.json=null,this.convertedJson=null,this.setProps(t)}finalize(){}setProps(t){"configuration"in t&&(this.configuration=t.configuration instanceof yd?t.configuration:new yd(t.configuration)),"onJSONChange"in t&&(this.onJSONChange=t.onJSONChange)}mergeConfiguration(t){this.configuration.merge(t)}convert(t){if(!t||t===this.json)return this.convertedJson;this.json=t;let r=j5(t),n=Y4t(r,this.configuration);return n=this.configuration.postProcessConvertedJson(n),this.convertedJson=n,n}convertJson(t){return this.convert(t)}};function Y4t(e,t){return t=new yd(t),W5(e,"",t)}function W5(e,t,r){return Array.isArray(e)?e.map((n,i)=>W5(n,String(i),r)):K4t(e,r)?Z4t(e,r):H5(e)?pI in e?$4t(e,r):q5(e,r):typeof e=="string"?Q4t(e,t,r):e}function K4t(e,t){let{typeKey:r}=t;return H5(e)&&Boolean(e[r])}function Z4t(e,t){let{typeKey:r}=t,n=e[r],i={...e};return delete i[r],i=q5(i,t),eot(n,i,t)}function $4t(e,t){let{functionKey:r}=t,n=e[r],i={...e};return delete i[r],i=q5(i,t),rot(n,i,t)}function q5(e,t){C1(H5(e));let r={};for(let n in e){let i=e[n];r[n]=W5(i,n,t)}return r}function Q4t(e,t,r){if(e.startsWith(P1)&&r.convertFunction)return e=e.replace(P1,""),r.convertFunction(e,r);if(e.startsWith(V5)){if(e=e.replace(V5,""),r.constants[e])return r.constants[e];let[n,i]=e.split(".");return r.enumerations[n][i]}return e}var R1={onInitialize:e=>e,onFinalize:e=>e,onMessage:e=>e},op=class{static setCallbacks({onInitialize:t,onFinalize:r,onMessage:n}){t&&(R1.onInitialize=t),r&&(R1.onFinalize=r),n&&(R1.onMessage=n)}constructor(t="Transport"){this._messageQueue=[],this.userData={},this._destroyed=!1,this.name=t}getRootDOMElement(){return typeof document<"u"?document.body:null}sendJSONMessage(){console.error("Back-channel not implemented for this transport")}sendBinaryMessage(){console.error("Back-channel not implemented for this transport")}_initialize(t={}){let r={transport:this,...t};R1.onInitialize(r)}_finalize(t={}){let r={transport:this,...t};R1.onFinalize(r),this._destroyed=!0}_messageReceived(t={}){t={transport:this,...t},console.debug("Delivering transport message",t),R1.onMessage(t)}static _stringifyJSONSafe(t){let r=new Set;return JSON.stringify(t,(n,i)=>{if(typeof i=="object"&&i!==null){if(r.has(i))try{return JSON.parse(JSON.stringify(i))}catch{return}r.add(i)}return i})}};function not(e,t){if(e===t)return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null||Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(!(r in t)||e[r]!==t[r])return!1;for(let r in t)if(!(r in e))return!1;return!0}var _I,hs,cot,J4t,ag,iot,lot,G5,Z5,X5,Y5,tDt,Uw={},uot=[],eDt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,$5=Array.isArray;function Qm(e,t){for(var r in t)e[r]=t[r];return e}function hot(e){var t=e.parentNode;t&&t.removeChild(e)}function rDt(e,t,r){var n,i,o,s={};for(o in t)o=="key"?n=t[o]:o=="ref"?i=t[o]:s[o]=t[o];if(arguments.length>2&&(s.children=arguments.length>3?_I.call(arguments,2):r),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)s[o]===void 0&&(s[o]=e.defaultProps[o]);return mI(e,s,n,i,null)}function mI(e,t,r,n,i){var o={type:e,props:t,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:i??++cot,__i:-1,__u:0};return i==null&&hs.vnode!=null&&hs.vnode(o),o}function L1(e){return e.children}function AI(e,t){this.props=e,this.context=t}function cg(e,t){if(t==null)return e.__?cg(e.__,e.__i+1):null;for(var r;t<e.__k.length;t++)if((r=e.__k[t])!=null&&r.__e!=null)return r.__e;return typeof e.type=="function"?cg(e):null}function fot(e){var t,r;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((r=e.__k[t])!=null&&r.__e!=null){e.__e=e.__c.base=r.__e;break}return fot(e)}}function oot(e){(!e.__d&&(e.__d=!0)&&ag.push(e)&&!gI.__r++||iot!==hs.debounceRendering)&&((iot=hs.debounceRendering)||lot)(gI)}function gI(){var e,t,r,n,i,o,s,c;for(ag.sort(G5);e=ag.shift();)e.__d&&(t=ag.length,n=void 0,o=(i=(r=e).__v).__e,s=[],c=[],r.__P&&((n=Qm({},i)).__v=i.__v+1,hs.vnode&&hs.vnode(n),Q5(r.__P,n,i,r.__n,r.__P.namespaceURI,32&i.__u?[o]:null,s,o??cg(i),!!(32&i.__u),c),n.__v=i.__v,n.__.__k[n.__i]=n,mot(s,n,c),n.__e!=o&&fot(n)),ag.length>t&&ag.sort(G5));gI.__r=0}function pot(e,t,r,n,i,o,s,c,l,h,p){var x,w,E,P,B,D=n&&n.__k||uot,W=t.length;for(r.__d=l,nDt(r,t,D),l=r.__d,x=0;x<W;x++)(E=r.__k[x])!=null&&typeof E!="boolean"&&typeof E!="function"&&(w=E.__i===-1?Uw:D[E.__i]||Uw,E.__i=x,Q5(e,E,w,i,o,s,c,l,h,p),P=E.__e,E.ref&&w.ref!=E.ref&&(w.ref&&J5(w.ref,null,E),p.push(E.ref,E.__c||P,E)),B==null&&P!=null&&(B=P),65536&E.__u||w.__k===E.__k?l=dot(E,l,e):typeof E.type=="function"&&E.__d!==void 0?l=E.__d:P&&(l=P.nextSibling),E.__d=void 0,E.__u&=-196609);r.__d=l,r.__e=B}function nDt(e,t,r){var n,i,o,s,c,l=t.length,h=r.length,p=h,x=0;for(e.__k=[],n=0;n<l;n++)s=n+x,(i=e.__k[n]=(i=t[n])==null||typeof i=="boolean"||typeof i=="function"?null:typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?mI(null,i,null,null,null):$5(i)?mI(L1,{children:i},null,null,null):i.constructor===void 0&&i.__b>0?mI(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i)!=null?(i.__=e,i.__b=e.__b+1,c=iDt(i,r,s,p),i.__i=c,o=null,c!==-1&&(p--,(o=r[c])&&(o.__u|=131072)),o==null||o.__v===null?(c==-1&&x--,typeof i.type!="function"&&(i.__u|=65536)):c!==s&&(c==s-1?x--:c==s+1?x++:c>s?p>l-s?x+=c-s:x--:c<s&&(c==s-x?x-=c-s:x++),c!==n+x&&(i.__u|=65536))):(o=r[s])&&o.key==null&&o.__e&&!(131072&o.__u)&&(o.__e==e.__d&&(e.__d=cg(o)),K5(o,o,!1),r[s]=null,p--);if(p)for(n=0;n<h;n++)(o=r[n])!=null&&!(131072&o.__u)&&(o.__e==e.__d&&(e.__d=cg(o)),K5(o,o))}function dot(e,t,r){var n,i;if(typeof e.type=="function"){for(n=e.__k,i=0;n&&i<n.length;i++)n[i]&&(n[i].__=e,t=dot(n[i],t,r));return t}e.__e!=t&&(t&&e.type&&!r.contains(t)&&(t=cg(e)),r.insertBefore(e.__e,t||null),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType===8);return t}function iDt(e,t,r,n){var i=e.key,o=e.type,s=r-1,c=r+1,l=t[r];if(l===null||l&&i==l.key&&o===l.type&&!(131072&l.__u))return r;if(n>(l!=null&&!(131072&l.__u)?1:0))for(;s>=0||c<t.length;){if(s>=0){if((l=t[s])&&!(131072&l.__u)&&i==l.key&&o===l.type)return s;s--}if(c<t.length){if((l=t[c])&&!(131072&l.__u)&&i==l.key&&o===l.type)return c;c++}}return-1}function sot(e,t,r){t[0]==="-"?e.setProperty(t,r??""):e[t]=r==null?"":typeof r!="number"||eDt.test(t)?r:r+"px"}function dI(e,t,r,n,i){var o;t:if(t==="style")if(typeof r=="string")e.style.cssText=r;else{if(typeof n=="string"&&(e.style.cssText=n=""),n)for(t in n)r&&t in r||sot(e.style,t,"");if(r)for(t in r)n&&r[t]===n[t]||sot(e.style,t,r[t])}else if(t[0]==="o"&&t[1]==="n")o=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase()in e||t==="onFocusOut"||t==="onFocusIn"?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=r,r?n?r.u=n.u:(r.u=Z5,e.addEventListener(t,o?Y5:X5,o)):e.removeEventListener(t,o?Y5:X5,o);else{if(i=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=r??"";break t}catch{}typeof r=="function"||(r==null||r===!1&&t[4]!=="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&r==1?"":r))}}function aot(e){return function(t){if(this.l){var r=this.l[t.type+e];if(t.t==null)t.t=Z5++;else if(t.t<r.u)return;return r(hs.event?hs.event(t):t)}}}function Q5(e,t,r,n,i,o,s,c,l,h){var p,x,w,E,P,B,D,W,X,q,$,et,F,ut,ot,J,G=t.type;if(t.constructor!==void 0)return null;128&r.__u&&(l=!!(32&r.__u),o=[c=t.__e=r.__e]),(p=hs.__b)&&p(t);t:if(typeof G=="function")try{if(W=t.props,X="prototype"in G&&G.prototype.render,q=(p=G.contextType)&&n[p.__c],$=p?q?q.props.value:p.__:n,r.__c?D=(x=t.__c=r.__c).__=x.__E:(X?t.__c=x=new G(W,$):(t.__c=x=new AI(W,$),x.constructor=G,x.render=sDt),q&&q.sub(x),x.props=W,x.state||(x.state={}),x.context=$,x.__n=n,w=x.__d=!0,x.__h=[],x._sb=[]),X&&x.__s==null&&(x.__s=x.state),X&&G.getDerivedStateFromProps!=null&&(x.__s==x.state&&(x.__s=Qm({},x.__s)),Qm(x.__s,G.getDerivedStateFromProps(W,x.__s))),E=x.props,P=x.state,x.__v=t,w)X&&G.getDerivedStateFromProps==null&&x.componentWillMount!=null&&x.componentWillMount(),X&&x.componentDidMount!=null&&x.__h.push(x.componentDidMount);else{if(X&&G.getDerivedStateFromProps==null&&W!==E&&x.componentWillReceiveProps!=null&&x.componentWillReceiveProps(W,$),!x.__e&&(x.shouldComponentUpdate!=null&&x.shouldComponentUpdate(W,x.__s,$)===!1||t.__v===r.__v)){for(t.__v!==r.__v&&(x.props=W,x.state=x.__s,x.__d=!1),t.__e=r.__e,t.__k=r.__k,t.__k.forEach(function(mt){mt&&(mt.__=t)}),et=0;et<x._sb.length;et++)x.__h.push(x._sb[et]);x._sb=[],x.__h.length&&s.push(x);break t}x.componentWillUpdate!=null&&x.componentWillUpdate(W,x.__s,$),X&&x.componentDidUpdate!=null&&x.__h.push(function(){x.componentDidUpdate(E,P,B)})}if(x.context=$,x.props=W,x.__P=e,x.__e=!1,F=hs.__r,ut=0,X){for(x.state=x.__s,x.__d=!1,F&&F(t),p=x.render(x.props,x.state,x.context),ot=0;ot<x._sb.length;ot++)x.__h.push(x._sb[ot]);x._sb=[]}else do x.__d=!1,F&&F(t),p=x.render(x.props,x.state,x.context),x.state=x.__s;while(x.__d&&++ut<25);x.state=x.__s,x.getChildContext!=null&&(n=Qm(Qm({},n),x.getChildContext())),X&&!w&&x.getSnapshotBeforeUpdate!=null&&(B=x.getSnapshotBeforeUpdate(E,P)),pot(e,$5(J=p!=null&&p.type===L1&&p.key==null?p.props.children:p)?J:[J],t,r,n,i,o,s,c,l,h),x.base=t.__e,t.__u&=-161,x.__h.length&&s.push(x),D&&(x.__E=x.__=null)}catch(mt){if(t.__v=null,l||o!=null){for(t.__u|=l?160:32;c&&c.nodeType===8&&c.nextSibling;)c=c.nextSibling;o[o.indexOf(c)]=null,t.__e=c}else t.__e=r.__e,t.__k=r.__k;hs.__e(mt,t,r)}else o==null&&t.__v===r.__v?(t.__k=r.__k,t.__e=r.__e):t.__e=oDt(r.__e,t,r,n,i,o,s,l,h);(p=hs.diffed)&&p(t)}function mot(e,t,r){t.__d=void 0;for(var n=0;n<r.length;n++)J5(r[n],r[++n],r[++n]);hs.__c&&hs.__c(t,e),e.some(function(i){try{e=i.__h,i.__h=[],e.some(function(o){o.call(i)})}catch(o){hs.__e(o,i.__v)}})}function oDt(e,t,r,n,i,o,s,c,l){var h,p,x,w,E,P,B,D=r.props,W=t.props,X=t.type;if(X==="svg"?i="http://www.w3.org/2000/svg":X==="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),o!=null){for(h=0;h<o.length;h++)if((E=o[h])&&"setAttribute"in E==!!X&&(X?E.localName===X:E.nodeType===3)){e=E,o[h]=null;break}}if(e==null){if(X===null)return document.createTextNode(W);e=document.createElementNS(i,X,W.is&&W),o=null,c=!1}if(X===null)D===W||c&&e.data===W||(e.data=W);else{if(o=o&&_I.call(e.childNodes),D=r.props||Uw,!c&&o!=null)for(D={},h=0;h<e.attributes.length;h++)D[(E=e.attributes[h]).name]=E.value;for(h in D)if(E=D[h],h!="children"){if(h=="dangerouslySetInnerHTML")x=E;else if(h!=="key"&&!(h in W)){if(h=="value"&&"defaultValue"in W||h=="checked"&&"defaultChecked"in W)continue;dI(e,h,null,E,i)}}for(h in W)E=W[h],h=="children"?w=E:h=="dangerouslySetInnerHTML"?p=E:h=="value"?P=E:h=="checked"?B=E:h==="key"||c&&typeof E!="function"||D[h]===E||dI(e,h,E,D[h],i);if(p)c||x&&(p.__html===x.__html||p.__html===e.innerHTML)||(e.innerHTML=p.__html),t.__k=[];else if(x&&(e.innerHTML=""),pot(e,$5(w)?w:[w],t,r,n,X==="foreignObject"?"http://www.w3.org/1999/xhtml":i,o,s,o?o[0]:r.__k&&cg(r,0),c,l),o!=null)for(h=o.length;h--;)o[h]!=null&&hot(o[h]);c||(h="value",P!==void 0&&(P!==e[h]||X==="progress"&&!P||X==="option"&&P!==D[h])&&dI(e,h,P,D[h],i),h="checked",B!==void 0&&B!==e[h]&&dI(e,h,B,D[h],i))}return e}function J5(e,t,r){try{if(typeof e=="function"){var n=typeof e.__u=="function";n&&e.__u(),n&&t==null||(e.__u=e(t))}else e.current=t}catch(i){hs.__e(i,r)}}function K5(e,t,r){var n,i;if(hs.unmount&&hs.unmount(e),(n=e.ref)&&(n.current&&n.current!==e.__e||J5(n,null,t)),(n=e.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(o){hs.__e(o,t)}n.base=n.__P=null}if(n=e.__k)for(i=0;i<n.length;i++)n[i]&&K5(n[i],t,r||typeof e.type!="function");r||e.__e==null||hot(e.__e),e.__c=e.__=e.__e=e.__d=void 0}function sDt(e,t,r){return this.constructor(e,r)}function O1(e,t,r){var n,i,o,s;hs.__&&hs.__(e,t),i=(n=typeof r=="function")?null:r&&r.__k||t.__k,o=[],s=[],Q5(t,e=(!n&&r||t).__k=rDt(L1,null,[e]),i||Uw,Uw,t.namespaceURI,!n&&r?[r]:i?null:t.firstChild?_I.call(t.childNodes):null,o,!n&&r?r:i?i.__e:t.firstChild,n,s),mot(o,e,s)}_I=uot.slice,hs={__e:function(e,t,r,n){for(var i,o,s;t=t.__;)if((i=t.__c)&&!i.__)try{if((o=i.constructor)&&o.getDerivedStateFromError!=null&&(i.setState(o.getDerivedStateFromError(e)),s=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(e,n||{}),s=i.__d),s)return i.__E=i}catch(c){e=c}throw e}},cot=0,J4t=function(e){return e!=null&&e.constructor==null},AI.prototype.setState=function(e,t){var r;r=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Qm({},this.state),typeof e=="function"&&(e=e(Qm({},r),this.props)),e&&Qm(r,e),e!=null&&this.__v&&(t&&this._sb.push(t),oot(this))},AI.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),oot(this))},AI.prototype.render=L1,ag=[],lot=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,G5=function(e,t){return e.__v.__b-t.__v.__b},gI.__r=0,Z5=0,X5=aot(!1),Y5=aot(!0),tDt=0;var aDt=0,iDe=Array.isArray;function Ys(e,t,r,n,i,o){t||(t={});var s,c,l=t;if("ref"in l)for(c in l={},t)c=="ref"?s=t[c]:l[c]=t[c];var h={type:e,props:l,key:r,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--aDt,__i:-1,__u:0,__source:i,__self:o};if(typeof e=="function"&&(s=e.defaultProps))for(c in s)l[c]===void 0&&(l[c]=s[c]);return hs.vnode&&hs.vnode(h),h}var Aot=e=>{let{className:t,label:r,onClick:n}=e;return Ys("div",{className:"deck-widget-button",children:Ys("button",{className:`deck-widget-icon-button ${t}`,type:"button",onClick:n,title:r,children:Ys("div",{className:"deck-widget-icon"})})})},got=e=>{let{children:t,orientation:r}=e;return Ys("div",{className:`deck-widget-button-group ${r}`,children:t})},t6=e=>{let{className:t,label:r,onClick:n}=e;return Ys("button",{className:`deck-widget-icon-button ${t}`,type:"button",onClick:n,title:r,children:Ys("div",{className:"deck-widget-icon"})})};var yI=class{constructor(t){this.id="fullscreen",this.placement="top-left",this.fullscreen=!1,this.id=t.id??this.id,this.placement=t.placement??this.placement,this.props={...t,enterLabel:t.enterLabel??"Enter Fullscreen",exitLabel:t.exitLabel??"Exit Fullscreen",style:t.style??{}}}onAdd({deck:t}){let{style:r,className:n}=this.props,i=document.createElement("div");return i.classList.add("deck-widget","deck-widget-fullscreen"),n&&i.classList.add(n),zh(i,r),this.deck=t,this.element=i,this.update(),document.addEventListener("fullscreenchange",this.onFullscreenChange.bind(this)),i}onRemove(){this.deck=void 0,this.element=void 0,document.removeEventListener("fullscreenchange",this.onFullscreenChange.bind(this))}update(){let{enterLabel:t,exitLabel:r}=this.props,n=this.element;if(!n)return;let i=Ys(Aot,{onClick:this.handleClick.bind(this),label:this.fullscreen?r:t,className:this.fullscreen?"deck-widget-fullscreen-exit":"deck-widget-fullscreen-enter"});O1(i,n)}setProps(t){this.placement=t.placement??this.placement;let r=this.props,n=this.element;n&&(r.className!==t.className&&(r.className&&n.classList.remove(r.className),t.className&&n.classList.add(t.className)),Oi(r.style,t.style,1)||(bm(n,r.style),zh(n,t.style))),Object.assign(this.props,t),this.update()}getContainer(){return this.props.container||this.deck?.getCanvas()?.parentElement}onFullscreenChange(){let t=this.fullscreen,r=document.fullscreenElement===this.getContainer();t!==r&&(this.fullscreen=!this.fullscreen),this.update()}async handleClick(){this.fullscreen?await this.exitFullscreen():await this.requestFullscreen(),this.update()}async requestFullscreen(){let t=this.getContainer();t?.requestFullscreen?await t.requestFullscreen({navigationUI:"hide"}):this.togglePseudoFullscreen()}async exitFullscreen(){document.exitFullscreen?await document.exitFullscreen():this.togglePseudoFullscreen()}togglePseudoFullscreen(){this.getContainer()?.classList.toggle("deck-pseudo-fullscreen")}};var xI=class{constructor(t){this.id="compass",this.placement="top-left",this.viewId=null,this.viewports={},this.id=t.id??this.id,this.viewId=t.viewId??this.viewId,this.placement=t.placement??this.placement,this.props={...t,transitionDuration:t.transitionDuration??200,label:t.label??"Reset Compass",style:t.style??{}}}setProps(t){this.placement=t.placement??this.placement,this.viewId=t.viewId??this.viewId;let r=this.props,n=this.element;n&&(r.className!==t.className&&(r.className&&n.classList.remove(r.className),t.className&&n.classList.add(t.className)),Oi(r.style,t.style,1)||(bm(n,r.style),zh(n,t.style))),Object.assign(this.props,t),this.update()}onViewportChange(t){t.equals(this.viewports[t.id])||(this.viewports[t.id]=t,this.update())}onAdd({deck:t}){let{style:r,className:n}=this.props,i=document.createElement("div");return i.classList.add("deck-widget","deck-widget-compass"),n&&i.classList.add(n),zh(i,r),this.deck=t,this.element=i,this.update(),i}getRotation(t){return t instanceof Uc?[-t.bearing,t.pitch]:t instanceof Fh?[0,Math.max(-80,Math.min(80,t.latitude))]:[0,0]}update(){let t=this.viewId||Object.values(this.viewports)[0]?.id||"default-view",r=this.viewports[t],[n,i]=this.getRotation(r),o=this.element;if(!o)return;let s=Ys("div",{className:"deck-widget-button",style:{perspective:100},children:Ys("button",{type:"button",onClick:()=>{for(let c of Object.values(this.viewports))this.handleCompassReset(c)},title:this.props.label,style:{transform:`rotateX(${i}deg)`},children:Ys("svg",{fill:"none",width:"100%",height:"100%",viewBox:"0 0 26 26",children:Ys("g",{transform:`rotate(${n},13,13)`,children:[Ys("path",{d:"M10 13.0001L12.9999 5L15.9997 13.0001H10Z",fill:"var(--icon-compass-north-color, #F05C44)"}),Ys("path",{d:"M16.0002 12.9999L13.0004 21L10.0005 12.9999H16.0002Z",fill:"var(--icon-compass-south-color, #C2C2CC)"})]})})})});O1(s,o)}onRemove(){this.deck=void 0,this.element=void 0}handleCompassReset(t){let r=this.viewId||t.id||"default-view";if(t instanceof Uc){let n={...t,bearing:0,...this.getRotation(t)[0]===0?{pitch:0}:{},transitionDuration:this.props.transitionDuration,transitionInterpolator:new ed};this.deck._onViewStateChange({viewId:r,viewState:n,interactionState:{}})}}};var vI=class{constructor(t){this.id="zoom",this.placement="top-left",this.viewId=null,this.viewports={},this.id=t.id??this.id,this.viewId=t.viewId??this.viewId,this.placement=t.placement??this.placement,this.props={...t,orientation:t.orientation??"vertical",transitionDuration:t.transitionDuration??200,zoomInLabel:t.zoomInLabel??"Zoom In",zoomOutLabel:t.zoomOutLabel??"Zoom Out",style:t.style??{}}}onAdd({deck:t}){let{style:r,className:n}=this.props,i=document.createElement("div");return i.classList.add("deck-widget","deck-widget-zoom"),n&&i.classList.add(n),zh(i,r),this.deck=t,this.element=i,this.update(),i}onRemove(){this.deck=void 0,this.element=void 0}setProps(t){this.placement=t.placement??this.placement,this.viewId=t.viewId??this.viewId;let r=this.props,n=this.element;n&&(r.className!==t.className&&(r.className&&n.classList.remove(r.className),t.className&&n.classList.add(t.className)),Oi(r.style,t.style,1)||(bm(n,r.style),zh(n,t.style))),Object.assign(this.props,t),this.update()}onViewportChange(t){this.viewports[t.id]=t}handleZoom(t,r){let n=this.viewId||t?.id||"default-view",i={...t,zoom:r,transitionDuration:this.props.transitionDuration,transitionInterpolator:new ed};this.deck._onViewStateChange({viewId:n,viewState:i,interactionState:{}})}handleZoomIn(){for(let t of Object.values(this.viewports))this.handleZoom(t,t.zoom+1)}handleZoomOut(){for(let t of Object.values(this.viewports))this.handleZoom(t,t.zoom-1)}update(){let t=this.element;if(!t)return;let r=Ys(got,{orientation:this.props.orientation,children:[Ys(t6,{onClick:()=>this.handleZoomIn(),label:this.props.zoomInLabel,className:"deck-widget-zoom-in"}),Ys(t6,{onClick:()=>this.handleZoomOut(),label:this.props.zoomOutLabel,className:"deck-widget-zoom-out"})]});O1(r,t)}};var cDt={"--button-background":"#fff","--button-stroke":"rgba(255, 255, 255, 0.3)","--button-inner-stroke":"unset","--button-shadow":"0px 0px 8px 0px rgba(0, 0, 0, 0.25)","--button-backdrop-filter":"unset","--button-icon-idle":"rgba(97, 97, 102, 1)","--button-icon-hover":"rgba(24, 24, 26, 1)","--icon-compass-north-color":"#F05C44","--icon-compass-south-color":"#C2C2CC"},lDt={"--button-background":"rgba(18, 18, 20, 1)","--button-stroke":"rgba(18, 18, 20, 0.30)","--button-inner-stroke":"unset","--button-shadow":"0px 0px 8px 0px rgba(0, 0, 0, 0.25)","--button-backdrop-filter":"unset","--button-icon-idle":"rgba(158, 157, 168, 1)","--button-icon-hover":"rgba(215, 214, 229, 1)","--icon-compass-north-color":"#F05C44","--icon-compass-south-color":"#C2C2CC"},uDt={"--button-background":"rgba(255, 255, 255, 0.6)","--button-stroke":"rgba(255, 255, 255, 0.3)","--button-inner-stroke":"1px solid rgba(255, 255, 255, 0.6)","--button-shadow":"0px 0px 8px 0px rgba(0, 0, 0, 0.25), 0px 0px 8px 0px rgba(0, 0, 0, 0.1) inset","--button-backdrop-filter":"blur(4px)","--button-icon-idle":"rgba(97, 97, 102, 1)","--button-icon-hover":"rgba(24, 24, 26, 1)","--icon-compass-north-color":"#F05C44","--icon-compass-south-color":"#C2C2CC"},hDt={"--button-background":"rgba(18, 18, 20, 0.75)","--button-stroke":"rgba(18, 18, 20, 0.30)","--button-inner-stroke":"1px solid rgba(18, 18, 20, 0.75)","--button-shadow":"0px 0px 8px 0px rgba(0, 0, 0, 0.25), 0px 0px 8px 0px rgba(0, 0, 0, 0.1) inset","--button-backdrop-filter":"blur(4px)","--button-icon-idle":"rgba(158, 157, 168, 1)","--button-icon-hover":"rgba(215, 214, 229, 1)","--icon-compass-north-color":"#F05C44","--icon-compass-south-color":"#C2C2CC"};var bI=class{constructor(t){this.map=null,this.width=0,this.height=0,this.props={...t},this._initialize(this.props)}finalize(){this.map?.remove(),this.map=null}setProps(t){let r=this.props,n={...this.props,...t};if(this.props=n,!this.map)return;this._update(r,n)&&this.redraw()}redraw(){let t=this.map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}getMap(){return this.map}_initialize(t){let{mapLib:r,container:n}=t;r.accessToken=t.mapboxApiAccessToken||"",this.map=new t.mapLib.Map({container:n,maxZoom:24,...t.mapOptions,..._ot(t.viewState),style:t.mapStyle,interactive:!1,trackResize:!1}),Object.defineProperty(n,"offsetWidth",{get:()=>this.width}),Object.defineProperty(n,"clientWidth",{get:()=>this.width}),Object.defineProperty(n,"offsetHeight",{get:()=>this.height}),Object.defineProperty(n,"clientHeight",{get:()=>this.height}),this.map.resize()}_update(t,r){t.mapStyle!==r.mapStyle&&this.map.setStyle(r.mapStyle);let i=t.width!==r.width||t.height!==r.height;i&&(this.width=r.width,this.height=r.height,this.map.resize());let o=t.viewState,s=r.viewState,c=s.latitude!==o.latitude||s.longitude!==o.longitude||s.zoom!==o.zoom||s.pitch!==o.pitch||s.bearing!==o.bearing;return c&&this.map.jumpTo(_ot(s)),i||c}};function _ot(e){return{center:[e.longitude,e.latitude],zoom:e.zoom,bearing:e.bearing??0,pitch:e.pitch??0}}var yot={position:"absolute",left:0,top:0,width:"100%",height:"100%"};function fDt(e){let{container:t=document.body}=e;if(typeof t=="string"&&(t=document.getElementById(t)),!t)throw Error("Deck: container not found");window.getComputedStyle(t).position==="static"&&(t.style.position="relative");let n=document.createElement("div");t.appendChild(n),Object.assign(n.style,yot);let i=document.createElement("canvas");return t.appendChild(i),Object.assign(i.style,yot),{container:t,mapCanvas:n,deckCanvas:i}}var lg=class extends cy{constructor(t){if(typeof document>"u")throw Error("Deck can only be used in the browser");let{mapCanvas:r,deckCanvas:n}=fDt(t),i=t.viewState||t.initialViewState,o=Number.isFinite(i&&i.latitude),{map:s=globalThis.mapboxgl||globalThis.maplibregl}=t;super({canvas:n,...t}),s&&s.Map?this._map=o&&new bI({...t,width:0,height:0,viewState:i,container:r,mapLib:s}):this._map=s}getMapboxMap(){return this._map&&this._map.getMap()}finalize(){this._map&&this._map.finalize(),super.finalize()}setProps(t){"mapStyle"in t&&this._map&&this._map.setProps({mapStyle:t.mapStyle}),super.setProps(t)}_drawLayers(t,r){if(this._map){let n=this.getViewports()[0];n&&this._map.setProps({width:n.width,height:n.height,viewState:n})}super._drawLayers(t,r)}};Rf.registerDevices([Na]);var xot=e=>e.charAt(0)===e.charAt(0).toUpperCase(),pDt=e=>e.charAt(0)===e.charAt(0).toLowerCase()&&e.charAt(0)!=="_";function e6(e={},t){let r={},n=Object.keys(e).filter(t);for(let i of n)r[i]=e[i];return r}var dDt={classes:e6(Vw,xot),enumerations:{COORDINATE_SYSTEM:Yr,GL:Of}};HA([ov]);var Jm=new sg({configuration:dDt});function mDt(e,t){let r={classes:e6(e,xot),functions:e6(e,pDt)};t.mergeConfiguration(r)}function ADt(e,t){if(!e)return;let r={};function n(){Object.values(r).every(o=>o)&&typeof t=="function"&&t()}function i(o,s){mDt(s,Jm),r[o]=s,n()}e.forEach(({libraryName:o,resourceUri:s})=>{if(r[o]=!1,o in window){i(o,window[o]);return}Object.defineProperty(window,o,{set:c=>i(o,c),get:()=>r[o]}),W7(s)})}function vot(e,t){let r=Jm.convert(e);t.setProps(r)}function gDt(e,t){return e.filter(r=>r&&r.id&&!t.find(n=>n.id===r.id))}function _Dt({mapProvider:e,props:t,mapboxApiKey:r,googleMapsKey:n,handleEvent:i,getTooltip:o,container:s}){let l={...i?{onClick:h=>i("deck-click-event",h),onHover:h=>i("deck-hover-event",h),onResize:h=>i("deck-resize-event",h),onViewStateChange:({viewState:h,interactionState:p,oldViewState:x})=>{let w=new Uc(h);h.nw=w.unproject([0,0]),h.se=w.unproject([w.width,w.height]),i("deck-view-state-change-event",h)},onDragStart:h=>i("deck-drag-start-event",h),onDrag:h=>i("deck-drag-event",h),onDragEnd:h=>i("deck-drag-end-event",h)}:null,getTooltip:o,container:s};switch(e){case"mapbox":return br.info("Using Mapbox base maps")(),new lg({...l,...t,map:jO,mapboxApiAccessToken:r,onLoad:H7});case"carto":return br.info("Using Carto base maps")(),new lg({map:jO,...l,...t});case"google_maps":return br.info("Using Google Maps base maps")(),Iq({...l,...t,googleMapsKey:n});default:return br.info("No recognized map provider specified")(),new lg({...l,...t,map:null,mapboxApiAccessToken:null})}}function wI({mapboxApiKey:e,googleMapsKey:t,container:r,jsonInput:n,tooltip:i,handleEvent:o,customLibraries:s,configuration:c}){let l;try{c&&Jm.mergeConfiguration(c);let h=n.layers||[],p=Jm.convert(n);CD(r,p);let x=(p.layers||[]).filter(D=>D),w=gDt(h,x),E=zO(i),{mapProvider:P}=p;l=_Dt({mapProvider:P,props:p,mapboxApiKey:e,googleMapsKey:t,handleEvent:o,getTooltip:E,container:r}),ADt(s,()=>{if(w.length){let W=(Jm.convert({layers:n.layers}).layers||[]).filter(X=>X);W.length>x.length&&l.setProps({layers:W})}})}catch(h){console.error(h)}return l}function TI(){op.setCallbacks({onInitialize({transport:e}){let{width:t,height:r,customLibraries:n,mapboxApiKey:i,jsonInput:o,tooltip:s}=bDt(e);j7();let c=e.getRootDOMElement(),l=z7(t,r);c.appendChild(l);let h=JSON.parse(o),p=wI({mapboxApiKey:i,container:l,jsonInput:h,tooltip:s,handleEvent:(x,w)=>vDt(e,x,w),customLibraries:n});e.userData.deck=p},onFinalize({transport:e}){let{deck:t}=e.userData;t.finalize()},onMessage({transport:e,type:t,json:r,binary:n}){let{deck:i}=e.userData,o;switch(t){case"json":o=Jm.convert(r),i.setProps(o);break;case"json-with-binary":o=Jm.convert(r);let s=e.jupyterModel.get("data_buffer"),c=yDt({binary:s,convertedJson:o});i.setProps(c);break;default:}}})}function yDt({binary:e,convertedJson:t}){for(let r=0;r<t.layers.length;r++){let n=t.layers[r].id,i=t.layers[r];t.layers[r]=i.clone({data:e[n]})}return t}function xDt(e,t){return t instanceof qi?t.id:t}function vDt(e,t,r){if(t==="hover"&&!r.picked&&r.index===-1)return;let n=JSON.parse(JSON.stringify(r,xDt));e.sendJSONMessage(t,n)}function bDt(e){let{jupyterModel:t}=e;if(!t)throw new Error("deck.gl playground currently only works with the Jupyter Widget Transport");return{width:t.get("width"),height:t.get("height"),customLibraries:t.get("custom_libraries"),mapboxApiKey:t.get("mapbox_key"),jsonInput:t.get("json_input"),tooltip:t.get("tooltip")}}var ug=class extends op{constructor(){super("Jupyter Transport (JavaScript <=> Jupyter Kernel)"),this.jupyterModel=null,this.jupyterView=null}getRootDOMElement(){return this.jupyterView.el}sendJSONMessage(t,r){let n=op._stringifyJSONSafe({type:t,data:r});this.jupyterModel.send(n)}};var zT={};Lo(zT,{CONTROL_COMM_PROTOCOL_VERSION:()=>llt,CONTROL_COMM_TARGET:()=>clt,CONTROL_COMM_TIMEOUT:()=>ult,DOMWidgetModel:()=>Sx,DOMWidgetView:()=>FT,IJupyterWidgetRegistry:()=>Vzt,JUPYTER_WIDGETS_VERSION:()=>BI,JupyterPhosphorPanelWidget:()=>O8,JupyterPhosphorWidget:()=>$R,LayoutModel:()=>B8,LayoutView:()=>D8,ManagerBase:()=>S6,PROTOCOL_VERSION:()=>DI,StyleModel:()=>QR,StyleView:()=>N8,ViewList:()=>F8,WidgetModel:()=>up,WidgetView:()=>gA,WrappedError:()=>Zw,assign:()=>xd,base64ToBuffer:()=>E6,bufferToBase64:()=>T6,bufferToHex:()=>lzt,difference:()=>OI,hexToBuffer:()=>w6,isEqual:()=>W1,pack_models:()=>L8,put_buffers:()=>tA,reject:()=>cp,remove_buffers:()=>Qw,resolvePromisesDict:()=>q1,serialize_state:()=>hlt,shims:()=>k8,unpack_models:()=>kT,uuid:()=>$w});var LI=tc(Tot()),nlt=tc(B1()),ilt=tc($ct()),olt=tc(rlt());function OI(e,t){return e.filter(r=>t.indexOf(r)===-1)}function W1(e,t){return(0,ilt.default)(e,t)}var xd=Object.assign||function(e){for(let t=1;t<arguments.length;t++){let r=arguments[t];for(let n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function $w(){return nlt.UUID.uuid4()}var Zw=class extends Error{constructor(t,r){super(t),console.warn("WrappedError has been deprecated!"),r instanceof Zw?this.error_stack=r.error_stack:this.error_stack=[r],this.error_stack.push(this)}};function q1(e){let t=Object.keys(e),r=[];return t.forEach(function(n){r.push(e[n])}),Promise.all(r).then(n=>{let i={};for(let o=0;o<t.length;o++)i[t[o]]=n[o];return i})}function cp(e,t){return function(n){throw t&&console.error(new Error(e)),n}}function tA(e,t,r){for(let n=0;n<t.length;n++){let i=t[n],o=e;for(let s=0;s<i.length-1;s++)o=o[i[s]];o[i[i.length-1]]=r[n]}}function Qw(e){let t=[],r=[];function n(o,s){if(o.toJSON&&(o=o.toJSON()),Array.isArray(o)){let c=!1;for(let l=0;l<o.length;l++){let h=o[l];if(h)if(h instanceof ArrayBuffer||ArrayBuffer.isView(h))c||(o=o.slice(),c=!0),t.push(ArrayBuffer.isView(h)?h.buffer:h),r.push(s.concat([l])),o[l]=null;else{let p=n(h,s.concat([l]));p!==h&&(c||(o=o.slice(),c=!0),o[l]=p)}}}else if((0,olt.default)(o))for(let c in o){let l=!1;if(o.hasOwnProperty(c)){let h=o[c];if(h)if(h instanceof ArrayBuffer||ArrayBuffer.isView(h))l||(o=Object.assign({},o),l=!0),t.push(ArrayBuffer.isView(h)?h.buffer:h),r.push(s.concat([c])),delete o[c];else{let p=n(h,s.concat([c]));p!==h&&(l||(o=Object.assign({},o),l=!0),o[c]=p)}}}return o}return{state:n(e,[]),buffers:t,buffer_paths:r}}var czt=["00","01","02","03","04","05","06","07","08","09","0A","0B","0C","0D","0E","0F","10","11","12","13","14","15","16","17","18","19","1A","1B","1C","1D","1E","1F","20","21","22","23","24","25","26","27","28","29","2A","2B","2C","2D","2E","2F","30","31","32","33","34","35","36","37","38","39","3A","3B","3C","3D","3E","3F","40","41","42","43","44","45","46","47","48","49","4A","4B","4C","4D","4E","4F","50","51","52","53","54","55","56","57","58","59","5A","5B","5C","5D","5E","5F","60","61","62","63","64","65","66","67","68","69","6A","6B","6C","6D","6E","6F","70","71","72","73","74","75","76","77","78","79","7A","7B","7C","7D","7E","7F","80","81","82","83","84","85","86","87","88","89","8A","8B","8C","8D","8E","8F","90","91","92","93","94","95","96","97","98","99","9A","9B","9C","9D","9E","9F","A0","A1","A2","A3","A4","A5","A6","A7","A8","A9","AA","AB","AC","AD","AE","AF","B0","B1","B2","B3","B4","B5","B6","B7","B8","B9","BA","BB","BC","BD","BE","BF","C0","C1","C2","C3","C4","C5","C6","C7","C8","C9","CA","CB","CC","CD","CE","CF","D0","D1","D2","D3","D4","D5","D6","D7","D8","D9","DA","DB","DC","DD","DE","DF","E0","E1","E2","E3","E4","E5","E6","E7","E8","E9","EA","EB","EC","ED","EE","EF","F0","F1","F2","F3","F4","F5","F6","F7","F8","F9","FA","FB","FC","FD","FE","FF"];function lzt(e){let t=new Uint8Array(e),r=[];for(let n=0;n<t.length;n++)r.push(czt[t[n]]);return r.join("")}function w6(e){let t=new Uint8Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=parseInt(e.slice(r,r+2),16);return t.buffer}function T6(e){return(0,LI.fromByteArray)(new Uint8Array(e))}function E6(e){return(0,LI.toByteArray)(e).buffer}var alt=tc(B1());var BI="1.2.0",DI="2.1.0";var slt=DI.split(".",1)[0],clt="jupyter.widget.control",llt="1.0.0",ult=4e3,S6=class{constructor(){this.comm_target_name="jupyter.widget",this._models=Object.create(null)}display_model(t,r,n={}){return this.create_view(r,n).then(i=>this.display_view(t,i,n)).catch(cp("Could not create view",!0))}setViewOptions(t={}){return t}create_view(t,r={}){let n=t.state_change=t.state_change.then(()=>this.loadClass(t.get("_view_name"),t.get("_view_module"),t.get("_view_module_version")).then(o=>{let s=new o({model:t,options:this.setViewOptions(r)});return s.listenTo(t,"destroy",s.remove),Promise.resolve(s.render()).then(()=>s)}).catch(cp("Could not create a view for model id "+t.model_id,!0))),i=$w();return t.views[i]=n,n.then(o=>{o.once("remove",()=>{delete o.model.views[i]},this)}),t.state_change}callbacks(t){return{}}get_model(t){return this._models[t]}has_model(t){return this._models[t]!==void 0}handle_comm_open(t,r){let n=(r.metadata||{}).version||"";if(n.split(".",1)[0]!==slt){let c=`Wrong widget protocol version: received protocol version '${n}', but was expecting major version '${slt}'`;return console.error(c),Promise.reject(c)}let i=r.content.data,o=i.buffer_paths||[],s=(r.buffers||[]).map(c=>c instanceof DataView?c:new DataView(c instanceof ArrayBuffer?c:c.buffer));return tA(i.state,o,s),this.new_model({model_name:i.state._model_name,model_module:i.state._model_module,model_module_version:i.state._model_module_version,comm:t},i.state).catch(cp("Could not create a model.",!0))}new_widget(t,r={}){let n;if(t.view_name===void 0||t.view_module===void 0||t.view_module_version===void 0)return Promise.reject("new_widget(...) must be given view information in the options.");t.comm?n=Promise.resolve(t.comm):n=this._create_comm(this.comm_target_name,t.model_id,{state:{_model_module:t.model_module,_model_module_version:t.model_module_version,_model_name:t.model_name,_view_module:t.view_module,_view_module_version:t.view_module_version,_view_name:t.view_name}},{version:DI});let i=Object.assign({},t);return n.then(o=>(i.comm=o,this.new_model(i,r).then(c=>(c.sync("create",c),c))),()=>(i.model_id||(i.model_id=$w()),this.new_model(i,r)))}register_model(t,r){this._models[t]=r,r.then(n=>{n.once("comm:close",()=>{delete this._models[t]})})}async new_model(t,r={}){let n;if(t.model_id)n=t.model_id;else if(t.comm)n=t.model_id=t.comm.comm_id;else throw new Error("Neither comm nor model_id provided in options object. At least one must exist.");let i=this._make_model(t,r);return this.register_model(n,i),await i}async _make_model(t,r={}){let n=t.model_id,i=this.loadClass(t.model_name,t.model_module,t.model_module_version),o;try{o=await i}catch(h){throw console.error("Could not instantiate widget"),h}if(!o)throw new Error(`Cannot find model module ${t.model_module}@${t.model_module_version}, ${t.model_name}`);let s=await o._deserialize_state(r,this),c={widget_manager:this,model_id:n,comm:t.comm},l=new o(s,c);return l.name=t.model_name,l.module=t.model_module,l}async _loadFromKernel(){let t,r;try{let c=await this._create_comm(clt,$w(),{},{version:llt});await new Promise((l,h)=>{c.on_msg(p=>{if(t=p.content.data,t.method!=="update_states"){console.warn(`
                        Unknown ${t.method} message on the Control channel
                        `);return}r=(p.buffers||[]).map(x=>x instanceof DataView?x:new DataView(x instanceof ArrayBuffer?x:x.buffer)),l(null)}),c.on_close(()=>h("Control comm was closed too early")),c.send({method:"request_states"},{}),setTimeout(()=>h("Control comm did not respond in time"),ult)}),c.close()}catch(c){return console.warn('Failed to fetch ipywidgets through the "jupyter.widget.control" comm channel, fallback to fetching individual model state. Reason:',c),this._loadFromKernelModels()}let n=t.states,i={},o={};for(let c=0;c<t.buffer_paths.length;c++){let[l,...h]=t.buffer_paths[c],p=r[c];i[l]||(i[l]=[],o[l]=[]),i[l].push(h),o[l].push(p)}let s=await Promise.all(Object.keys(n).map(async c=>{let l=this.has_model(c)?void 0:await this._create_comm("jupyter.widget",c);return{widget_id:c,comm:l}}));await Promise.all(s.map(async({widget_id:c,comm:l})=>{let h=n[c];c in i&&tA(h,i[c],o[c]);try{if(l)await this.new_model({model_name:h.model_name,model_module:h.model_module,model_module_version:h.model_module_version,model_id:c,comm:l},h.state);else{let p=await this.get_model(c),x=await p.constructor._deserialize_state(h.state,this);p.set_state(x)}}catch(p){console.error(p)}}))}async _loadFromKernelModels(){let t=await this._get_comm_info(),r=await Promise.all(Object.keys(t).map(async n=>{if(this.has_model(n))return;let i=await this._create_comm(this.comm_target_name,n),o="",s=new alt.PromiseDelegate;return i.on_msg(c=>{if(c.parent_header.msg_id===o&&c.header.msg_type==="comm_msg"&&c.content.data.method==="update"){let l=c.content.data,h=l.buffer_paths||[],p=c.buffers||[];tA(l.state,h,p),s.resolve({comm:i,msg:c})}}),o=i.send({method:"request_state"},this.callbacks(void 0)),s.promise}));await Promise.all(r.map(async n=>{if(!n)return;let i=n.msg.content;await this.new_model({model_name:i.data.state._model_name,model_module:i.data.state._model_module,model_module_version:i.data.state._model_module_version,comm:n.comm},i.data.state)}))}clear_state(){return q1(this._models).then(t=>{Object.keys(t).forEach(r=>t[r].close()),this._models=Object.create(null)})}get_state(t={}){let r=Object.keys(this._models).map(n=>this._models[n]);return Promise.all(r).then(n=>hlt(n,t))}set_state(t){if(!(t.version_major&&t.version_major<=2))throw"Unsupported widget state format";let r=t.state;return this._get_comm_info().then(i=>Promise.all(Object.keys(r).map(o=>{let s={base64:E6,hex:w6},c=r[o],l=c.state;if(c.buffers){let p=c.buffers.map(w=>w.path),x=c.buffers.map(w=>new DataView(s[w.encoding](w.data)));tA(c.state,p,x)}if(this.has_model(o))return this.get_model(o).then(p=>p.constructor._deserialize_state(l||{},this).then(x=>(p.set_state(x),p)));let h={model_id:o,model_name:c.model_name,model_module:c.model_module,model_module_version:c.model_module_version};return i.hasOwnProperty(o)?this._create_comm(this.comm_target_name,o).then(p=>(h.comm=p,this.new_model(h))):this.new_model(h,l)})))}disconnect(){Object.keys(this._models).forEach(t=>{this._models[t].then(r=>{r.comm_live=!1})})}resolveUrl(t){return Promise.resolve(t)}filterExistingModelState(t){let r=t.state;return r=Object.keys(r).filter(n=>!this.has_model(n)).reduce((n,i)=>(n[i]=r[i],n),{}),Object.assign(Object.assign({},t),{state:r})}};function hlt(e,t={}){let r={};return e.forEach(n=>{let i=n.model_id,o=Qw(n.serialize(n.get_state(t.drop_defaults))),s=o.buffers.map((c,l)=>({data:T6(c),path:o.buffer_paths[l],encoding:"base64"}));r[i]={model_name:n.name,model_module:n.module,model_module_version:n.get("_model_module_version"),state:o.state},s.length>0&&(r[i].buffers=s)}),{version_major:2,version_minor:0,state:r}}function flt(e,t,r){if(e==null)return this;let n;if(typeof e=="object"?(n=e,r=t):(n={})[e]=t,r||(r={}),!this._validate(n,r))return!1;let i=r.unset,o=r.silent,s=[],c=this._changing;this._changing=!0;try{c||(this._previousAttributes=Object.assign({},this.attributes),this.changed={});let l=this.attributes,h=this.changed,p=this._previousAttributes;for(let x in n)t=n[x],W1(l[x],t)||s.push(x),W1(p[x],t)?delete h[x]:h[x]=t,i?delete l[x]:l[x]=t;if(this.id=this.get(this.idAttribute),!o){s.length&&(this._pending=r);for(let x=0;x<s.length;x++)this.trigger("change:"+s[x],this,l[s[x]],r)}if(c)return this;if(!o)for(;this._pending;)r=this._pending,this._pending=!1,this.trigger("change",this,r)}finally{this._pending=!1,this._changing=!1}return this}var pht=tc(h8()),R8=tc(l8());var Qut=tc(h8()),IT=Element.prototype,Tzt=IT.matches||IT.webkitMatchesSelector||IT.mozMatchesSelector||IT.msMatchesSelector||IT.oMatchesSelector||function(t){let r=(this.document||this.ownerDocument).querySelectorAll(t),n=r.length;for(;--n>=0&&r.item(n)!==this;);return n>-1},VR=class extends Qut.View{_removeElement(){this.undelegateEvents(),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}_setElement(t){this.el=t}_setAttributes(t){for(let r in t)r in this.el?this.el[r]=t[r]:this.el.setAttribute(r,t[r])}delegate(t,r,n){typeof r!="string"&&(n=r,r=null),this._domEvents===void 0&&(this._domEvents=[]);let i=this.el,o=r?function(s){let c=s.target||s.srcElement;for(;c&&c!==i;c=c.parentNode)if(Tzt.call(c,r))return s.delegateTarget=c,n.handleEvent?n.handleEvent(s):n(s)}:n;return this.el.addEventListener(t,o,!1),this._domEvents.push({eventName:t,handler:o,listener:n,selector:r}),o}undelegate(t,r,n){if(typeof r=="function"&&(n=r,r=null),this.el&&this._domEvents){let i=this._domEvents.slice(),o=i.length;for(;o--;){let s=i[o];s.eventName===t&&(!n||s.listener===n)&&(!r||s.selector===r)&&(this.el.removeEventListener(s.eventName,s.handler,!1),this._domEvents.splice(o,1))}}return this}undelegateEvents(){if(this.el&&this._domEvents){let t=this._domEvents.length;for(let r=0;r<t;r++){let n=this._domEvents[r];this.el.removeEventListener(n.eventName,n.handler,!1)}this._domEvents.length=0}return this}};var Ze;(function(e){function t(ut,ot,J,G){J===void 0&&(J=0),G===void 0&&(G=-1);var mt=ut.length;if(mt===0)return-1;J<0?J=Math.max(0,J+mt):J=Math.min(J,mt-1),G<0?G=Math.max(0,G+mt):G=Math.min(G,mt-1);var Mt;G<J?Mt=G+1+(mt-J):Mt=G-J+1;for(var ct=0;ct<Mt;++ct){var gt=(J+ct)%mt;if(ut[gt]===ot)return gt}return-1}e.firstIndexOf=t;function r(ut,ot,J,G){J===void 0&&(J=-1),G===void 0&&(G=0);var mt=ut.length;if(mt===0)return-1;J<0?J=Math.max(0,J+mt):J=Math.min(J,mt-1),G<0?G=Math.max(0,G+mt):G=Math.min(G,mt-1);var Mt;J<G?Mt=J+1+(mt-G):Mt=J-G+1;for(var ct=0;ct<Mt;++ct){var gt=(J-ct+mt)%mt;if(ut[gt]===ot)return gt}return-1}e.lastIndexOf=r;function n(ut,ot,J,G){J===void 0&&(J=0),G===void 0&&(G=-1);var mt=ut.length;if(mt===0)return-1;J<0?J=Math.max(0,J+mt):J=Math.min(J,mt-1),G<0?G=Math.max(0,G+mt):G=Math.min(G,mt-1);var Mt;G<J?Mt=G+1+(mt-J):Mt=G-J+1;for(var ct=0;ct<Mt;++ct){var gt=(J+ct)%mt;if(ot(ut[gt],gt))return gt}return-1}e.findFirstIndex=n;function i(ut,ot,J,G){J===void 0&&(J=-1),G===void 0&&(G=0);var mt=ut.length;if(mt===0)return-1;J<0?J=Math.max(0,J+mt):J=Math.min(J,mt-1),G<0?G=Math.max(0,G+mt):G=Math.min(G,mt-1);var Mt;J<G?Mt=J+1+(mt-G):Mt=J-G+1;for(var ct=0;ct<Mt;++ct){var gt=(J-ct+mt)%mt;if(ot(ut[gt],gt))return gt}return-1}e.findLastIndex=i;function o(ut,ot,J,G){J===void 0&&(J=0),G===void 0&&(G=-1);var mt=n(ut,ot,J,G);return mt!==-1?ut[mt]:void 0}e.findFirstValue=o;function s(ut,ot,J,G){J===void 0&&(J=-1),G===void 0&&(G=0);var mt=i(ut,ot,J,G);return mt!==-1?ut[mt]:void 0}e.findLastValue=s;function c(ut,ot,J,G,mt){G===void 0&&(G=0),mt===void 0&&(mt=-1);var Mt=ut.length;if(Mt===0)return 0;G<0?G=Math.max(0,G+Mt):G=Math.min(G,Mt-1),mt<0?mt=Math.max(0,mt+Mt):mt=Math.min(mt,Mt-1);for(var ct=G,gt=mt-G+1;gt>0;){var ee=gt>>1,Ne=ct+ee;J(ut[Ne],ot)<0?(ct=Ne+1,gt-=ee+1):gt=ee}return ct}e.lowerBound=c;function l(ut,ot,J,G,mt){G===void 0&&(G=0),mt===void 0&&(mt=-1);var Mt=ut.length;if(Mt===0)return 0;G<0?G=Math.max(0,G+Mt):G=Math.min(G,Mt-1),mt<0?mt=Math.max(0,mt+Mt):mt=Math.min(mt,Mt-1);for(var ct=G,gt=mt-G+1;gt>0;){var ee=gt>>1,Ne=ct+ee;J(ut[Ne],ot)>0?gt=ee:(ct=Ne+1,gt-=ee+1)}return ct}e.upperBound=l;function h(ut,ot,J){if(ut===ot)return!0;if(ut.length!==ot.length)return!1;for(var G=0,mt=ut.length;G<mt;++G)if(J?!J(ut[G],ot[G]):ut[G]!==ot[G])return!1;return!0}e.shallowEqual=h;function p(ut,ot){ot===void 0&&(ot={});var J=ot.start,G=ot.stop,mt=ot.step;if(mt===void 0&&(mt=1),mt===0)throw new Error("Slice `step` cannot be zero.");var Mt=ut.length;J===void 0?J=mt<0?Mt-1:0:J<0?J=Math.max(J+Mt,mt<0?-1:0):J>=Mt&&(J=mt<0?Mt-1:Mt),G===void 0?G=mt<0?-1:Mt:G<0?G=Math.max(G+Mt,mt<0?-1:0):G>=Mt&&(G=mt<0?Mt-1:Mt);var ct;mt<0&&G>=J||mt>0&&J>=G?ct=0:mt<0?ct=Math.floor((G-J+1)/mt+1):ct=Math.floor((G-J-1)/mt+1);for(var gt=[],ee=0;ee<ct;++ee)gt[ee]=ut[J+ee*mt];return gt}e.slice=p;function x(ut,ot,J){var G=ut.length;if(!(G<=1)&&(ot<0?ot=Math.max(0,ot+G):ot=Math.min(ot,G-1),J<0?J=Math.max(0,J+G):J=Math.min(J,G-1),ot!==J)){for(var mt=ut[ot],Mt=ot<J?1:-1,ct=ot;ct!==J;ct+=Mt)ut[ct]=ut[ct+Mt];ut[J]=mt}}e.move=x;function w(ut,ot,J){ot===void 0&&(ot=0),J===void 0&&(J=-1);var G=ut.length;if(!(G<=1))for(ot<0?ot=Math.max(0,ot+G):ot=Math.min(ot,G-1),J<0?J=Math.max(0,J+G):J=Math.min(J,G-1);ot<J;){var mt=ut[ot],Mt=ut[J];ut[ot++]=Mt,ut[J--]=mt}}e.reverse=w;function E(ut,ot,J,G){J===void 0&&(J=0),G===void 0&&(G=-1);var mt=ut.length;if(!(mt<=1)&&(J<0?J=Math.max(0,J+mt):J=Math.min(J,mt-1),G<0?G=Math.max(0,G+mt):G=Math.min(G,mt-1),!(J>=G))){var Mt=G-J+1;if(ot>0?ot=ot%Mt:ot<0&&(ot=(ot%Mt+Mt)%Mt),ot!==0){var ct=J+ot;w(ut,J,ct-1),w(ut,ct,G),w(ut,J,G)}}}e.rotate=E;function P(ut,ot,J,G){J===void 0&&(J=0),G===void 0&&(G=-1);var mt=ut.length;if(mt!==0){J<0?J=Math.max(0,J+mt):J=Math.min(J,mt-1),G<0?G=Math.max(0,G+mt):G=Math.min(G,mt-1);var Mt;G<J?Mt=G+1+(mt-J):Mt=G-J+1;for(var ct=0;ct<Mt;++ct)ut[(J+ct)%mt]=ot}}e.fill=P;function B(ut,ot,J){var G=ut.length;ot<0?ot=Math.max(0,ot+G):ot=Math.min(ot,G);for(var mt=G;mt>ot;--mt)ut[mt]=ut[mt-1];ut[ot]=J}e.insert=B;function D(ut,ot){var J=ut.length;if(ot<0&&(ot+=J),!(ot<0||ot>=J)){for(var G=ut[ot],mt=ot+1;mt<J;++mt)ut[mt-1]=ut[mt];return ut.length=J-1,G}}e.removeAt=D;function W(ut,ot,J,G){J===void 0&&(J=0),G===void 0&&(G=-1);var mt=t(ut,ot,J,G);return mt!==-1&&D(ut,mt),mt}e.removeFirstOf=W;function X(ut,ot,J,G){J===void 0&&(J=-1),G===void 0&&(G=0);var mt=r(ut,ot,J,G);return mt!==-1&&D(ut,mt),mt}e.removeLastOf=X;function q(ut,ot,J,G){J===void 0&&(J=0),G===void 0&&(G=-1);var mt=ut.length;if(mt===0)return 0;J<0?J=Math.max(0,J+mt):J=Math.min(J,mt-1),G<0?G=Math.max(0,G+mt):G=Math.min(G,mt-1);for(var Mt=0,ct=0;ct<mt;++ct)J<=G&&ct>=J&&ct<=G&&ut[ct]===ot||G<J&&(ct<=G||ct>=J)&&ut[ct]===ot?Mt++:Mt>0&&(ut[ct-Mt]=ut[ct]);return Mt>0&&(ut.length=mt-Mt),Mt}e.removeAllOf=q;function $(ut,ot,J,G){J===void 0&&(J=0),G===void 0&&(G=-1);var mt,Mt=n(ut,ot,J,G);return Mt!==-1&&(mt=D(ut,Mt)),{index:Mt,value:mt}}e.removeFirstWhere=$;function et(ut,ot,J,G){J===void 0&&(J=-1),G===void 0&&(G=0);var mt,Mt=i(ut,ot,J,G);return Mt!==-1&&(mt=D(ut,Mt)),{index:Mt,value:mt}}e.removeLastWhere=et;function F(ut,ot,J,G){J===void 0&&(J=0),G===void 0&&(G=-1);var mt=ut.length;if(mt===0)return 0;J<0?J=Math.max(0,J+mt):J=Math.min(J,mt-1),G<0?G=Math.max(0,G+mt):G=Math.min(G,mt-1);for(var Mt=0,ct=0;ct<mt;++ct)J<=G&&ct>=J&&ct<=G&&ot(ut[ct],ct)||G<J&&(ct<=G||ct>=J)&&ot(ut[ct],ct)?Mt++:Mt>0&&(ut[ct-Mt]=ut[ct]);return Mt>0&&(ut.length=mt-Mt),Mt}e.removeAllWhere=F})(Ze||(Ze={}));function gu(e){var t;return typeof e.iter=="function"?t=e.iter():t=new Ezt(e),t}function yn(e,t){for(var r=0,n=gu(e),i;(i=n.next())!==void 0;)if(t(i,r++)===!1)return}function Jut(e,t){for(var r=0,n=gu(e),i;(i=n.next())!==void 0;)if(!t(i,r++))return!1;return!0}function tht(e,t){for(var r=0,n=gu(e),i;(i=n.next())!==void 0;)if(t(i,r++))return!0;return!1}function eht(e){for(var t=0,r=[],n=gu(e),i;(i=n.next())!==void 0;)r[t++]=i;return r}var Ezt=function(){function e(t){this._index=0,this._source=t}return e.prototype.iter=function(){return this},e.prototype.clone=function(){var t=new e(this._source);return t._index=this._index,t},e.prototype.next=function(){if(!(this._index>=this._source.length))return this._source[this._index++]},e}(),QHe=function(){function e(t,r){r===void 0&&(r=Object.keys(t)),this._index=0,this._source=t,this._keys=r}return e.prototype.iter=function(){return this},e.prototype.clone=function(){var t=new e(this._source,this._keys);return t._index=this._index,t},e.prototype.next=function(){if(!(this._index>=this._keys.length)){var t=this._keys[this._index++];return t in this._source?t:this.next()}},e}(),JHe=function(){function e(t,r){r===void 0&&(r=Object.keys(t)),this._index=0,this._source=t,this._keys=r}return e.prototype.iter=function(){return this},e.prototype.clone=function(){var t=new e(this._source,this._keys);return t._index=this._index,t},e.prototype.next=function(){if(!(this._index>=this._keys.length)){var t=this._keys[this._index++];return t in this._source?this._source[t]:this.next()}},e}(),tWe=function(){function e(t,r){r===void 0&&(r=Object.keys(t)),this._index=0,this._source=t,this._keys=r}return e.prototype.iter=function(){return this},e.prototype.clone=function(){var t=new e(this._source,this._keys);return t._index=this._index,t},e.prototype.next=function(){if(!(this._index>=this._keys.length)){var t=this._keys[this._index++];return t in this._source?[t,this._source[t]]:this.next()}},e}(),eWe=function(){function e(t){this._fn=t}return e.prototype.iter=function(){return this},e.prototype.clone=function(){throw new Error("An `FnIterator` cannot be cloned.")},e.prototype.next=function(){return this._fn.call(void 0)},e}();function p8(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new Pg(gu(e.map(gu)))}var Pg=function(){function e(t){this._cloned=!1,this._source=t,this._active=void 0}return e.prototype.iter=function(){return this},e.prototype.clone=function(){var t=new e(this._source.clone());return t._active=this._active&&this._active.clone(),t._cloned=!0,this._cloned=!0,t},e.prototype.next=function(){if(this._active===void 0){var t=this._source.next();if(t===void 0)return;this._active=this._cloned?t.clone():t}var r=this._active.next();return r!==void 0?r:(this._active=void 0,this.next())},e}();function _u(){return new Mzt}var Mzt=function(){function e(){}return e.prototype.iter=function(){return this},e.prototype.clone=function(){return new e},e.prototype.next=function(){},e}();var rWe=function(){function e(t,r){this._source=t,this._index=r}return e.prototype.iter=function(){return this},e.prototype.clone=function(){return new e(this._source.clone(),this._index)},e.prototype.next=function(){var t=this._source.next();if(t!==void 0)return[this._index++,t]},e}();function rht(e,t){return new Szt(gu(e),t)}var Szt=function(){function e(t,r){this._index=0,this._source=t,this._fn=r}return e.prototype.iter=function(){return this},e.prototype.clone=function(){var t=new e(this._source.clone(),this._fn);return t._index=this._index,t},e.prototype.next=function(){for(var t=this._fn,r=this._source,n;(n=r.next())!==void 0;)if(t(n,this._index++))return n},e}();function yx(e,t){for(var r=0,n=gu(e),i;(i=n.next())!==void 0;)if(t(i,r++))return i}function nht(e,t){var r=gu(e),n=r.next();if(n!==void 0){for(var i=n;(n=r.next())!==void 0;)t(n,i)>0&&(i=n);return i}}function hA(e,t){return new Czt(gu(e),t)}var Czt=function(){function e(t,r){this._index=0,this._source=t,this._fn=r}return e.prototype.iter=function(){return this},e.prototype.clone=function(){var t=new e(this._source.clone(),this._fn);return t._index=this._index,t},e.prototype.next=function(){var t=this._source.next();if(t!==void 0)return this._fn.call(void 0,t,this._index++)},e}();var nWe=function(){function e(t,r,n){this._index=0,this._start=t,this._stop=r,this._step=n,this._length=f8.rangeLength(t,r,n)}return e.prototype.iter=function(){return this},e.prototype.clone=function(){var t=new e(this._start,this._stop,this._step);return t._index=this._index,t},e.prototype.next=function(){if(!(this._index>=this._length))return this._start+this._step*this._index++},e}(),f8;(function(e){function t(r,n,i){return i===0?1/0:r>n&&i>0||r<n&&i<0?0:Math.ceil((n-r)/i)}e.rangeLength=t})(f8||(f8={}));function d8(e,t,r){var n=0,i=gu(e),o=i.next();if(o===void 0&&r===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(o===void 0)return r;var s=i.next();if(s===void 0&&r===void 0)return o;if(s===void 0)return t(r,o,n++);var c;r===void 0?c=t(o,s,n++):c=t(t(r,o,n++),s,n++);for(var l;(l=i.next())!==void 0;)c=t(c,l,n++);return c}function RT(e){return new Pzt(e,1)}var Pzt=function(){function e(t,r){this._value=t,this._count=r}return e.prototype.iter=function(){return this},e.prototype.clone=function(){return new e(this._value,this._count)},e.prototype.next=function(){if(!(this._count<=0))return this._count--,this._value},e}();function iht(e){var t;return typeof e.retro=="function"?t=e.retro():t=new Izt(e),t}var Izt=function(){function e(t){this._source=t,this._index=t.length-1}return e.prototype.iter=function(){return this},e.prototype.clone=function(){var t=new e(this._source);return t._index=this._index,t},e.prototype.next=function(){if(!(this._index<0||this._index>=this._source.length))return this._source[this._index--]},e}();var iWe=function(){function e(t,r){this._source=t,this._step=r}return e.prototype.iter=function(){return this},e.prototype.clone=function(){return new e(this._source.clone(),this._step)},e.prototype.next=function(){for(var t=this._source.next(),r=this._step-1;r>0;--r)this._source.next();return t},e}(),_x;(function(e){function t(s,c,l){l===void 0&&(l=0);for(var h=new Array(c.length),p=0,x=l,w=c.length;p<w;++p,++x){if(x=s.indexOf(c[p],x),x===-1)return null;h[p]=x}return h}e.findIndices=t;function r(s,c,l){l===void 0&&(l=0);var h=t(s,c,l);if(!h)return null;for(var p=0,x=0,w=h.length;x<w;++x){var E=h[x]-l;p+=E*E}return{score:p,indices:h}}e.matchSumOfSquares=r;function n(s,c,l){l===void 0&&(l=0);var h=t(s,c,l);if(!h)return null;for(var p=0,x=l-1,w=0,E=h.length;w<E;++w){var P=h[w];p+=P-x-1,x=P}return{score:p,indices:h}}e.matchSumOfDeltas=n;function i(s,c,l){for(var h=[],p=0,x=0,w=c.length;p<w;){for(var E=c[p],P=c[p];++p<w&&c[p]===P+1;)P++;x<E&&h.push(s.slice(x,E)),E<P+1&&h.push(l(s.slice(E,P+1))),x=P+1}return x<s.length&&h.push(s.slice(x)),h}e.highlight=i;function o(s,c){return s<c?-1:s>c?1:0}e.cmp=o})(_x||(_x={}));var oWe=function(){function e(t,r){this._source=t,this._count=r}return e.prototype.iter=function(){return this},e.prototype.clone=function(){return new e(this._source.clone(),this._count)},e.prototype.next=function(){if(!(this._count<=0)){var t=this._source.next();if(t!==void 0)return this._count--,t}},e}();var sWe=function(){function e(t){this._source=t}return e.prototype.iter=function(){return this},e.prototype.clone=function(){return new e(this._source.map(function(t){return t.clone()}))},e.prototype.next=function(){for(var t=new Array(this._source.length),r=0,n=this._source.length;r<n;++r){var i=this._source[r].next();if(i===void 0)return;t[r]=i}return t},e}();var oht;(function(e){function t(r){var n=document.body,i=function(o){o.preventDefault(),o.stopPropagation(),o.clipboardData.setData("text",r),n.removeEventListener("copy",i,!0)};n.addEventListener("copy",i,!0),document.execCommand("copy")}e.copyText=t})(oht||(oht={}));var co;(function(e){function t(o){var s=window.getComputedStyle(o),c=parseFloat(s.borderTopWidth)||0,l=parseFloat(s.borderLeftWidth)||0,h=parseFloat(s.borderRightWidth)||0,p=parseFloat(s.borderBottomWidth)||0,x=parseFloat(s.paddingTop)||0,w=parseFloat(s.paddingLeft)||0,E=parseFloat(s.paddingRight)||0,P=parseFloat(s.paddingBottom)||0,B=l+w+E+h,D=c+x+P+p;return{borderTop:c,borderLeft:l,borderRight:h,borderBottom:p,paddingTop:x,paddingLeft:w,paddingRight:E,paddingBottom:P,horizontalSum:B,verticalSum:D}}e.boxSizing=t;function r(o){var s=window.getComputedStyle(o),c=parseFloat(s.minWidth)||0,l=parseFloat(s.minHeight)||0,h=parseFloat(s.maxWidth)||1/0,p=parseFloat(s.maxHeight)||1/0;return h=Math.max(c,h),p=Math.max(l,p),{minWidth:c,minHeight:l,maxWidth:h,maxHeight:p}}e.sizeLimits=r;function n(o,s,c){var l=o.getBoundingClientRect();return s>=l.left&&s<l.right&&c>=l.top&&c<l.bottom}e.hitTest=n;function i(o,s){var c=o.getBoundingClientRect(),l=s.getBoundingClientRect();if(!(l.top<=c.top&&l.bottom>=c.bottom)){if(l.top<c.top&&l.height<=c.height){o.scrollTop-=c.top-l.top;return}if(l.bottom>c.bottom&&l.height>=c.height){o.scrollTop-=c.top-l.top;return}if(l.top<c.top&&l.height>c.height){o.scrollTop-=c.bottom-l.bottom;return}if(l.bottom>c.bottom&&l.height<c.height){o.scrollTop-=c.bottom-l.bottom;return}}}e.scrollIntoViewIfNeeded=i})(co||(co={}));var lc;(function(e){e.IS_MAC=!!navigator.platform.match(/Mac/i),e.IS_WIN=!!navigator.platform.match(/Win/i),e.IS_IE=/Trident/.test(navigator.userAgent),e.IS_EDGE=/Edge/.test(navigator.userAgent);function t(r){return e.IS_MAC?r.metaKey:r.ctrlKey}e.accelKey=t})(lc||(lc={}));var Qh;(function(e){function t(i){if(i in $h.specificityCache)return $h.specificityCache[i];var o=$h.calculateSingle(i);return $h.specificityCache[i]=o}e.calculateSpecificity=t;function r(i){if(i in $h.validityCache)return $h.validityCache[i];var o=!0;try{$h.testElem.querySelector(i)}catch{o=!1}return $h.validityCache[i]=o}e.isValid=r;function n(i,o){return $h.protoMatchFunc.call(i,o)}e.matches=n})(Qh||(Qh={}));var $h;(function(e){e.specificityCache=Object.create(null),e.validityCache=Object.create(null),e.testElem=document.createElement("div"),e.protoMatchFunc=function(){var p=Element.prototype;return p.matches||p.matchesSelector||p.mozMatchesSelector||p.msMatchesSelector||p.oMatchesSelector||p.webkitMatchesSelector||function(x){var w=this,E=w.ownerDocument?w.ownerDocument.querySelectorAll(x):[];return Array.prototype.indexOf.call(E,w)!==-1}}();function t(p){p=p.split(",",1)[0];var x=0,w=0,E=0;function P(B){var D=p.match(B);return D===null?!1:(p=p.slice(D[0].length),!0)}for(p=p.replace(h," $1 ");p.length>0;){if(P(r)){x++;continue}if(P(n)){w++;continue}if(P(i)){w++;continue}if(P(s)){E++;continue}if(P(c)){w++;continue}if(P(o)){E++;continue}if(!P(l))return 0}return x=Math.min(x,255),w=Math.min(w,255),E=Math.min(E,255),x<<16|w<<8|E}e.calculateSingle=t;var r=/^#[^\s\+>~#\.\[:]+/,n=/^\.[^\s\+>~#\.\[:]+/,i=/^\[[^\]]+\]/,o=/^[^\s\+>~#\.\[:]+/,s=/^(::[^\s\+>~#\.\[:]+|:first-line|:first-letter|:before|:after)/,c=/^:[^\s\+>~#\.\[:]+/,l=/^[\s\+>~\*]+/,h=/:not\(([^\)]+)\)/g})($h||($h={}));var sht=function(){function e(t){this._root=new ua.LeafNode,this.cmp=t}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this._root.size===0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._root.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"first",{get:function(){var t=ua.firstLeaf(this._root);return t.size>0?t.items[0]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){var t=ua.lastLeaf(this._root);return t.size>0?t.items[t.size-1]:void 0},enumerable:!0,configurable:!0}),e.prototype.iter=function(){return ua.iterItems(this._root)},e.prototype.retro=function(){return ua.retroItems(this._root)},e.prototype.slice=function(t,r){return ua.sliceItems(this._root,t,r)},e.prototype.retroSlice=function(t,r){return ua.retroSliceItems(this._root,t,r)},e.prototype.at=function(t){return ua.itemAt(this._root,t)},e.prototype.has=function(t,r){return ua.hasItem(this._root,t,r)},e.prototype.indexOf=function(t,r){return ua.indexOf(this._root,t,r)},e.prototype.get=function(t,r){return ua.getItem(this._root,t,r)},e.prototype.assign=function(t){this.clear(),this.update(t)},e.prototype.insert=function(t){var r=ua.insertItem(this._root,t,this.cmp);return this._root=ua.maybeSplitRoot(this._root),r},e.prototype.update=function(t){var r=this;yn(t,function(n){r.insert(n)})},e.prototype.delete=function(t,r){var n=ua.deleteItem(this._root,t,r);return this._root=ua.maybeExtractRoot(this._root),n},e.prototype.remove=function(t){var r=ua.removeItem(this._root,t);return this._root=ua.maybeExtractRoot(this._root),r},e.prototype.clear=function(){ua.clear(this._root),this._root=new ua.LeafNode},e}();(function(e){function t(r,n){var i=new e(n);return i.assign(r),i}e.from=t})(sht||(sht={}));var ua;(function(e){var t=function(){function ct(){this.items=[],this.sizes=[],this.children=[]}return Object.defineProperty(ct.prototype,"type",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(ct.prototype,"size",{get:function(){return this.sizes[this.sizes.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(ct.prototype,"width",{get:function(){return this.children.length},enumerable:!0,configurable:!0}),ct}();e.BranchNode=t;var r=function(){function ct(){this.next=null,this.prev=null,this.items=[]}return Object.defineProperty(ct.prototype,"type",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(ct.prototype,"size",{get:function(){return this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(ct.prototype,"width",{get:function(){return this.items.length},enumerable:!0,configurable:!0}),ct}();e.LeafNode=r;function n(ct){for(;ct.type===0;)ct=ct.children[0];return ct}e.firstLeaf=n;function i(ct){for(;ct.type===0;)ct=ct.children[ct.children.length-1];return ct}e.lastLeaf=i;function o(ct){var gt=n(ct);return new et(gt,0,-1)}e.iterItems=o;function s(ct){var gt=i(ct);return new F(gt,gt.size-1,-1)}e.retroItems=s;function c(ct,gt,ee){gt===void 0?gt=0:gt<0?gt=Math.max(0,gt+ct.size):gt=Math.min(gt,ct.size),ee===void 0?ee=ct.size:ee<0?ee=Math.max(0,ee+ct.size):ee=Math.min(ee,ct.size);var Ne=Math.max(0,ee-gt);if(Ne===0)return _u();for(;ct.type===0;){var Ue=ut(ct.sizes,gt);Ue>0&&(gt-=ct.sizes[Ue-1]),ct=ct.children[Ue]}return new et(ct,gt,Ne)}e.sliceItems=c;function l(ct,gt,ee){gt===void 0?gt=ct.size-1:gt<0?gt=Math.max(-1,gt+ct.size):gt=Math.min(gt,ct.size-1),ee===void 0?ee=-1:ee<0?ee=Math.max(-1,ee+ct.size):ee=Math.min(ee,ct.size-1);var Ne=Math.max(0,gt-ee);if(Ne===0)return _u();for(;ct.type===0;){var Ue=ut(ct.sizes,gt);Ue>0&&(gt-=ct.sizes[Ue-1]),ct=ct.children[Ue]}return new F(ct,gt,Ne)}e.retroSliceItems=l;function h(ct,gt){if(gt<0&&(gt+=ct.size),!(gt<0||gt>=ct.size)){for(;ct.type===0;){var ee=ut(ct.sizes,gt);ee>0&&(gt-=ct.sizes[ee-1]),ct=ct.children[ee]}return ct.items[gt]}}e.itemAt=h;function p(ct,gt,ee){for(;ct.type===0;){var Ne=ot(ct.items,gt,ee);ct=ct.children[Ne]}var Ue=J(ct.items,gt,ee);return Ue>=0}e.hasItem=p;function x(ct,gt,ee){for(var Ne=0;ct.type===0;){var Ue=ot(ct.items,gt,ee);Ue>0&&(Ne+=ct.sizes[Ue-1]),ct=ct.children[Ue]}var sr=J(ct.items,gt,ee);return sr>=0?Ne+sr:-Ne+sr}e.indexOf=x;function w(ct,gt,ee){for(;ct.type===0;){var Ne=ot(ct.items,gt,ee);ct=ct.children[Ne]}var Ue=J(ct.items,gt,ee);return Ue>=0?ct.items[Ue]:void 0}e.getItem=w;function E(ct,gt,ee){if(ct.type===1){var Ne=J(ct.items,gt,ee),Ue;return Ne>=0?(Ue=ct.items[Ne],ct.items[Ne]=gt):(Ue=void 0,Ze.insert(ct.items,-Ne-1,gt)),Ue}var sr=ot(ct.items,gt,ee),gr=ct.children[sr],Xr=gr.size,ir=E(gr,gt,ee),on=gr.size;if(ct.items[sr]=gr.items[0],Xr===on)return ir;if(gr.width>q){var Xe=mt(gr);Ze.insert(ct.children,sr+1,Xe),Ze.insert(ct.items,sr+1,Xe.items[0])}return G(ct,sr),ir}e.insertItem=E;function P(ct,gt,ee){if(ct.type===1){var Ne=J(ct.items,gt,ee);return Ne<0?void 0:Ze.removeAt(ct.items,Ne)}var Ue=ot(ct.items,gt,ee),sr=ct.children[Ue],gr=sr.size,Xr=P(sr,gt,ee),ir=sr.size;return gr===ir||(ct.items[Ue]=sr.items[0],sr.width<$&&(Ue=Mt(ct,Ue)),G(ct,Ue)),Xr}e.deleteItem=P;function B(ct,gt){if(gt<0&&(gt+=ct.size),!(gt<0||gt>=ct.size)){if(ct.type===1)return Ze.removeAt(ct.items,gt);var ee=ut(ct.sizes,gt);ee>0&&(gt-=ct.sizes[ee]);var Ne=ct.children[ee],Ue=B(Ne,gt);return ct.items[ee]=Ne.items[0],Ne.width<$&&(ee=Mt(ct,ee)),G(ct,ee),Ue}}e.removeItem=B;function D(ct){ct.type===0?(yn(ct.children,D),ct.children.length=0,ct.sizes.length=0,ct.items.length=0):(ct.items.length=0,ct.next=null,ct.prev=null)}e.clear=D;function W(ct){if(ct.width<=q)return ct;var gt=new t,ee=mt(ct);return gt.sizes[0]=ct.size,gt.sizes[1]=ct.size+ee.size,gt.children[0]=ct,gt.children[1]=ee,gt.items[0]=ct.items[0],gt.items[1]=ee.items[0],gt}e.maybeSplitRoot=W;function X(ct){if(ct.type===1||ct.children.length>1)return ct;var gt=ct.children.pop();return D(ct),gt}e.maybeExtractRoot=X;var q=32,$=q>>1,et=function(){function ct(gt,ee,Ne){this._node=gt,this._index=ee,this._count=Ne}return ct.prototype.iter=function(){return this},ct.prototype.clone=function(){return new ct(this._node,this._index,this._count)},ct.prototype.next=function(){if(!(this._node===null||this._count===0))return this._index>=this._node.size?(this._node=this._node.next,this._index=0,this.next()):(this._count>0&&this._count--,this._node.items[this._index++])},ct}(),F=function(){function ct(gt,ee,Ne){this._node=gt,this._index=ee,this._count=Ne}return ct.prototype.iter=function(){return this},ct.prototype.clone=function(){return new ct(this._node,this._index,this._count)},ct.prototype.next=function(){if(!(this._node===null||this._count===0))return this._index>=this._node.size&&(this._index=this._node.size-1),this._index<0?(this._node=this._node.prev,this._index=this._node?this._node.size-1:-1,this.next()):(this._count>0&&this._count--,this._node.items[this._index--])},ct}();function ut(ct,gt){for(var ee=ct.length,Ne=0;Ne<ee;++Ne)if(ct[Ne]>gt)return Ne;return ee-1}function ot(ct,gt,ee){for(var Ne=ct.length,Ue=1;Ue<Ne;++Ue)if(ee(ct[Ue],gt)>0)return Ue-1;return Ne-1}function J(ct,gt,ee){for(var Ne=ct.length,Ue=0;Ue<Ne;++Ue){var sr=ee(ct[Ue],gt);if(sr===0)return Ue;if(sr>0)return-Ue-1}return-Ne-1}function G(ct,gt){for(var ee=ct.sizes,Ne=ct.children,Ue=gt>0?ee[gt-1]:0,sr=Ne.length;gt<sr;++gt)Ue=ee[gt]=Ue+Ne[gt].size;ee.length=Ne.length}function mt(ct){if(ct.type===1){for(var gt=new r,ee=ct.items,Ne=gt.items,Ue=$,sr=ee.length;Ue<sr;++Ue)Ne.push(ee[Ue]);return ee.length=$,ct.next&&(ct.next.prev=gt),gt.next=ct.next,gt.prev=ct,ct.next=gt,gt}for(var gr=new t,Xr=ct.children,ir=gr.children,Ue=$,sr=Xr.length;Ue<sr;++Ue)ir.push(Xr[Ue]);Xr.length=$;for(var on=ct.items,Xe=gr.items,Ue=$,sr=on.length;Ue<sr;++Ue)Xe.push(on[Ue]);return on.length=$,G(ct,$),G(gr,0),gr}function Mt(ct,gt){var ee,Ne,Ue,sr,gr,Xr,ir=ct.children[gt],on=gt===0?ct.children[gt+1]:ct.children[gt-1],Xe=gt===0,He=ir.type===1,_n=on.width>$;if(He&&_n&&Xe){var dt=ir,wt=on;return dt.items.push(wt.items.shift()),ct.items[gt+1]=wt.items[0],gt}if(He&&_n&&!Xe){var dt=ir,wt=on;return dt.items.unshift(wt.items.pop()),ct.items[gt]=dt.items[0],gt-1}if(He&&!_n&&Xe){var dt=ir,wt=on;return(ee=wt.items).unshift.apply(ee,dt.items),Ze.removeAt(ct.children,gt),Ze.removeAt(ct.items,gt+1),dt.prev&&(dt.prev.next=wt),wt.prev=dt.prev,D(dt),gt}if(He&&!_n&&!Xe){var dt=ir,wt=on;return(Ne=wt.items).push.apply(Ne,dt.items),Ze.removeAt(ct.children,gt),Ze.removeAt(ct.items,gt),dt.next&&(dt.next.prev=wt),wt.next=dt.next,D(dt),gt-1}if(!He&&_n&&Xe){var dt=ir,wt=on;return dt.children.push(wt.children.shift()),dt.items.push(wt.items.shift()),ct.items[gt+1]=wt.items[0],G(dt,dt.width-1),G(wt,0),gt}if(!He&&_n&&!Xe){var dt=ir,wt=on;return dt.children.unshift(wt.children.pop()),dt.items.unshift(wt.items.pop()),ct.items[gt]=dt.items[0],G(dt,0),G(wt,wt.width-1),gt-1}if(!He&&!_n&&Xe){var dt=ir,wt=on;return(Ue=wt.children).unshift.apply(Ue,dt.children),(sr=wt.items).unshift.apply(sr,dt.items),Ze.removeAt(ct.children,gt),Ze.removeAt(ct.items,gt+1),G(wt,0),dt.children.length=0,D(dt),gt}if(!He&&!_n&&!Xe){var dt=ir,wt=on;return(gr=wt.children).push.apply(gr,dt.children),(Xr=wt.items).push.apply(Xr,dt.items),Ze.removeAt(ct.children,gt),Ze.removeAt(ct.items,gt),G(wt,0),dt.children.length=0,D(dt),gt-1}throw"unreachable"}})(ua||(ua={}));var jR=function(){function e(){this._first=null,this._last=null,this._size=0}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this._size===0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"first",{get:function(){return this._first?this._first.value:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){return this._last?this._last.value:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstNode",{get:function(){return this._first},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastNode",{get:function(){return this._last},enumerable:!0,configurable:!0}),e.prototype.iter=function(){return new e.ForwardValueIterator(this._first)},e.prototype.retro=function(){return new e.RetroValueIterator(this._last)},e.prototype.nodes=function(){return new e.ForwardNodeIterator(this._first)},e.prototype.retroNodes=function(){return new e.RetroNodeIterator(this._last)},e.prototype.assign=function(t){var r=this;this.clear(),yn(t,function(n){r.addLast(n)})},e.prototype.push=function(t){this.addLast(t)},e.prototype.pop=function(){return this.removeLast()},e.prototype.shift=function(t){this.addFirst(t)},e.prototype.unshift=function(){return this.removeFirst()},e.prototype.addFirst=function(t){var r=new Md.LinkedListNode(this,t);return this._first?(r.next=this._first,this._first.prev=r,this._first=r):(this._first=r,this._last=r),this._size++,r},e.prototype.addLast=function(t){var r=new Md.LinkedListNode(this,t);return this._last?(r.prev=this._last,this._last.next=r,this._last=r):(this._first=r,this._last=r),this._size++,r},e.prototype.insertBefore=function(t,r){if(!r||r===this._first)return this.addFirst(t);if(!(r instanceof Md.LinkedListNode)||r.list!==this)throw new Error("Reference node is not owned by the list.");var n=new Md.LinkedListNode(this,t),i=r,o=i.prev;return n.next=i,n.prev=o,i.prev=n,o.next=n,this._size++,n},e.prototype.insertAfter=function(t,r){if(!r||r===this._last)return this.addLast(t);if(!(r instanceof Md.LinkedListNode)||r.list!==this)throw new Error("Reference node is not owned by the list.");var n=new Md.LinkedListNode(this,t),i=r,o=i.next;return n.next=o,n.prev=i,i.next=n,o.prev=n,this._size++,n},e.prototype.removeFirst=function(){var t=this._first;if(t)return t===this._last?(this._first=null,this._last=null):(this._first=t.next,this._first.prev=null),t.list=null,t.next=null,t.prev=null,this._size--,t.value},e.prototype.removeLast=function(){var t=this._last;if(t)return t===this._first?(this._first=null,this._last=null):(this._last=t.prev,this._last.next=null),t.list=null,t.next=null,t.prev=null,this._size--,t.value},e.prototype.removeNode=function(t){if(!(t instanceof Md.LinkedListNode)||t.list!==this)throw new Error("Node is not owned by the list.");var r=t;r===this._first&&r===this._last?(this._first=null,this._last=null):r===this._first?(this._first=r.next,this._first.prev=null):r===this._last?(this._last=r.prev,this._last.next=null):(r.next.prev=r.prev,r.prev.next=r.next),r.list=null,r.next=null,r.prev=null,this._size--},e.prototype.clear=function(){for(var t=this._first;t;){var r=t.next;t.list=null,t.prev=null,t.next=null,t=r}this._first=null,this._last=null,this._size=0},e}();(function(e){function t(s){var c=new e;return c.assign(s),c}e.from=t;var r=function(){function s(c){this._node=c}return s.prototype.iter=function(){return this},s.prototype.clone=function(){return new s(this._node)},s.prototype.next=function(){if(this._node){var c=this._node;return this._node=c.next,c.value}},s}();e.ForwardValueIterator=r;var n=function(){function s(c){this._node=c}return s.prototype.iter=function(){return this},s.prototype.clone=function(){return new s(this._node)},s.prototype.next=function(){if(this._node){var c=this._node;return this._node=c.prev,c.value}},s}();e.RetroValueIterator=n;var i=function(){function s(c){this._node=c}return s.prototype.iter=function(){return this},s.prototype.clone=function(){return new s(this._node)},s.prototype.next=function(){if(this._node){var c=this._node;return this._node=c.next,c}},s}();e.ForwardNodeIterator=i;var o=function(){function s(c){this._node=c}return s.prototype.iter=function(){return this},s.prototype.clone=function(){return new s(this._node)},s.prototype.next=function(){if(this._node){var c=this._node;return this._node=c.prev,c}},s}();e.RetroNodeIterator=o})(jR||(jR={}));var Md;(function(e){var t=function(){function r(n,i){this.list=null,this.next=null,this.prev=null,this.list=n,this.value=i}return r}();e.LinkedListNode=t})(Md||(Md={}));var m8=function(e,t){return m8=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},m8(e,t)};function Rzt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");m8(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var yu=function(){function e(t){this.type=t}return Object.defineProperty(e.prototype,"isConflatable",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.conflate=function(t){return!1},e}(),xx=function(e){Rzt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"isConflatable",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.conflate=function(r){return!0},t}(yu),mr;(function(e){function t(J,G){var mt=p.get(J);if(!mt||mt.length===0){X(J,G);return}var Mt=Jut(iht(mt),function(ct){return ct?W(ct,J,G):!0});Mt&&X(J,G)}e.sendMessage=t;function r(J,G){if(!G.isConflatable){q(J,G);return}var mt=tht(h,function(Mt){return Mt.handler!==J||!Mt.msg||Mt.msg.type!==G.type||!Mt.msg.isConflatable?!1:Mt.msg.conflate(G)});mt||q(J,G)}e.postMessage=r;function n(J,G){var mt=p.get(J);mt&&mt.indexOf(G)!==-1||(mt?mt.push(G):p.set(J,[G]))}e.installMessageHook=n;function i(J,G){var mt=p.get(J);if(mt){var Mt=mt.indexOf(G);Mt!==-1&&(mt[Mt]=null,et(mt))}}e.removeMessageHook=i;function o(J){var G=p.get(J);G&&G.length>0&&(Ze.fill(G,null),et(G)),yn(h,function(mt){mt.handler===J&&(mt.handler=null,mt.msg=null)})}e.clearData=o;function s(){P||E===0||(D(E),P=!0,$(),P=!1)}e.flush=s;function c(){return w}e.getExceptionHandler=c;function l(J){var G=w;return w=J,G}e.setExceptionHandler=l;var h=new jR,p=new WeakMap,x=new Set,w=function(J){console.error(J)},E=0,P=!1,B=function(){var J=typeof requestAnimationFrame=="function";return J?requestAnimationFrame:setImmediate}(),D=function(){var J=typeof cancelAnimationFrame=="function";return J?cancelAnimationFrame:clearImmediate}();function W(J,G,mt){var Mt=!0;try{typeof J=="function"?Mt=J(G,mt):Mt=J.messageHook(G,mt)}catch(ct){w(ct)}return Mt}function X(J,G){try{J.processMessage(G)}catch(mt){w(mt)}}function q(J,G){h.addLast({handler:J,msg:G}),E===0&&(E=B($))}function $(){if(E=0,!h.isEmpty){var J={handler:null,msg:null};for(h.addLast(J);;){var G=h.removeFirst();if(G===J)return;G.handler&&G.msg&&t(G.handler,G.msg)}}}function et(J){x.size===0&&B(F),x.add(J)}function F(){x.forEach(ut),x.clear()}function ut(J){Ze.removeAllWhere(J,ot)}function ot(J){return J===null}})(mr||(mr={}));var xl=function(){function e(t){this._pid=Ig.nextPID(),this.name=t.name,this._create=t.create,this._coerce=t.coerce||null,this._compare=t.compare||null,this._changed=t.changed||null}return e.prototype.get=function(t){var r,n=Ig.ensureMap(t);return this._pid in n?r=n[this._pid]:r=n[this._pid]=this._createValue(t),r},e.prototype.set=function(t,r){var n,i=Ig.ensureMap(t);this._pid in i?n=i[this._pid]:n=i[this._pid]=this._createValue(t);var o=this._coerceValue(t,r);this._maybeNotify(t,n,i[this._pid]=o)},e.prototype.coerce=function(t){var r,n=Ig.ensureMap(t);this._pid in n?r=n[this._pid]:r=n[this._pid]=this._createValue(t);var i=this._coerceValue(t,r);this._maybeNotify(t,r,n[this._pid]=i)},e.prototype._createValue=function(t){var r=this._create;return r(t)},e.prototype._coerceValue=function(t,r){var n=this._coerce;return n?n(t,r):r},e.prototype._compareValue=function(t,r){var n=this._compare;return n?n(t,r):t===r},e.prototype._maybeNotify=function(t,r,n){var i=this._changed;i&&!this._compareValue(r,n)&&i(t,r,n)},e}();(function(e){function t(r){Ig.ownerData.delete(r)}e.clearData=t})(xl||(xl={}));var Ig;(function(e){e.ownerData=new WeakMap,e.nextPID=function(){var r=0;return function(){var n=Math.random(),i=(""+n).slice(2);return"pid-"+i+"-"+r++}}();function t(r){var n=e.ownerData.get(r);return n||(n=Object.create(null),e.ownerData.set(r,n),n)}e.ensureMap=t})(Ig||(Ig={}));var Di=function(){function e(t){this._blockedCount=0,this.sender=t}return e.prototype.block=function(t){this._blockedCount++;try{t()}finally{this._blockedCount--}},e.prototype.connect=function(t,r){return Gl.connect(this,t,r)},e.prototype.disconnect=function(t,r){return Gl.disconnect(this,t,r)},e.prototype.emit=function(t){this._blockedCount||Gl.emit(this,t)},e}();(function(e){function t(h,p){var x=Gl.blockedProperty;x.set(h,x.get(h)+1);try{p()}finally{x.set(h,x.get(h)-1)}}e.blockAll=t;function r(h,p){Gl.disconnectBetween(h,p)}e.disconnectBetween=r;function n(h){Gl.disconnectSender(h)}e.disconnectSender=n;function i(h){Gl.disconnectReceiver(h)}e.disconnectReceiver=i;function o(h){Gl.disconnectAll(h)}e.disconnectAll=o;function s(h){Gl.disconnectAll(h)}e.clearData=s;function c(){return Gl.exceptionHandler}e.getExceptionHandler=c;function l(h){var p=Gl.exceptionHandler;return Gl.exceptionHandler=h,p}e.setExceptionHandler=l})(Di||(Di={}));var Gl;(function(e){e.exceptionHandler=function(X){console.error(X)};function t(X,q,$){$=$||void 0;var et=l.get(X.sender);if(et||(et=[],l.set(X.sender,et)),w(et,X,q,$))return!1;var F=$||q,ut=h.get(F);ut||(ut=[],h.set(F,ut));var ot={signal:X,slot:q,thisArg:$};return et.push(ot),ut.push(ot),!0}e.connect=t;function r(X,q,$){$=$||void 0;var et=l.get(X.sender);if(!et||et.length===0)return!1;var F=w(et,X,q,$);if(!F)return!1;var ut=$||q,ot=h.get(ut);return F.signal=null,P(et),P(ot),!0}e.disconnect=r;function n(X,q){var $=l.get(X);if(!(!$||$.length===0)){var et=h.get(q);!et||et.length===0||(yn(et,function(F){F.signal&&F.signal.sender===X&&(F.signal=null)}),P($),P(et))}}e.disconnectBetween=n;function i(X){var q=l.get(X);!q||q.length===0||(yn(q,function($){if($.signal){var et=$.thisArg||$.slot;$.signal=null,P(h.get(et))}}),P(q))}e.disconnectSender=i;function o(X){var q=h.get(X);!q||q.length===0||(yn(q,function($){if($.signal){var et=$.signal.sender;$.signal=null,P(l.get(et))}}),P(q))}e.disconnectReceiver=o;function s(X){i(X),o(X)}e.disconnectAll=s;function c(X,q){if(!(e.blockedProperty.get(X.sender)>0)){var $=l.get(X.sender);if(!(!$||$.length===0))for(var et=0,F=$.length;et<F;++et){var ut=$[et];ut.signal===X&&E(ut,q)}}}e.emit=c;var l=new WeakMap,h=new WeakMap,p=new Set,x=function(){var X=typeof requestAnimationFrame=="function";return X?requestAnimationFrame:setImmediate}();function w(X,q,$,et){return yx(X,function(F){return F.signal===q&&F.slot===$&&F.thisArg===et})}function E(X,q){var $=X.signal,et=X.slot,F=X.thisArg;try{et.call(F,$.sender,q)}catch(ut){e.exceptionHandler(ut)}}function P(X){p.size===0&&x(B),p.add(X)}function B(){p.forEach(D),p.clear()}function D(X){Ze.removeAllWhere(X,W)}function W(X){return X.signal===null}e.blockedProperty=new xl({name:"blocked",create:function(){return 0}})})(Gl||(Gl={}));var A8=function(e,t){return A8=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},A8(e,t)};function cht(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");A8(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var fA=function(){function e(t){this._fn=t}return Object.defineProperty(e.prototype,"isDisposed",{get:function(){return!this._fn},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){if(this._fn){var t=this._fn;this._fn=null,t()}},e}(),xWe=function(e){cht(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r._disposed=new Di(r),r}return Object.defineProperty(t.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.isDisposed||(e.prototype.dispose.call(this),this._disposed.emit(void 0),Di.clearData(this))},t}(fA),g8=function(){function e(){this._isDisposed=!1,this._items=new Set}return Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this._items.forEach(function(t){t.dispose()}),this._items.clear())},e.prototype.contains=function(t){return this._items.has(t)},e.prototype.add=function(t){this._items.add(t)},e.prototype.remove=function(t){this._items.delete(t)},e.prototype.clear=function(){this._items.clear()},e}();(function(e){function t(r){var n=new e;return yn(r,function(i){n.add(i)}),n}e.from=t})(g8||(g8={}));var aht=function(e){cht(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r._disposed=new Di(r),r}return Object.defineProperty(t.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.isDisposed||(e.prototype.dispose.call(this),this._disposed.emit(void 0),Di.clearData(this))},t}(g8);(function(e){function t(r){var n=new e;return yn(r,function(i){n.add(i)}),n}e.from=t})(aht||(aht={}));var pA=function(){function e(t){var r=this;this._onScrollFrame=function(){if(r._scrollTarget){var n=r._scrollTarget,i=n.element,o=n.edge,s=n.distance,c=tl.SCROLL_EDGE_SIZE-s,l=Math.pow(c/tl.SCROLL_EDGE_SIZE,2),h=Math.max(1,Math.round(l*tl.SCROLL_EDGE_SIZE));switch(o){case"top":i.scrollTop-=h;break;case"left":i.scrollLeft-=h;break;case"right":i.scrollLeft+=h;break;case"bottom":i.scrollTop+=h;break}requestAnimationFrame(r._onScrollFrame)}},this._disposed=!1,this._dropAction="none",this._override=null,this._currentTarget=null,this._currentElement=null,this._promise=null,this._scrollTarget=null,this._resolve=null,this.document=t.document||document,this.mimeData=t.mimeData,this.dragImage=t.dragImage||null,this.proposedAction=t.proposedAction||"copy",this.supportedActions=t.supportedActions||"all",this.source=t.source||null}return e.prototype.dispose=function(){if(!this._disposed){if(this._disposed=!0,this._currentTarget){var t=tl.createMouseEvent("pointerup",-1,-1);tl.dispatchDragLeave(this,this._currentTarget,null,t)}this._finalize("none")}},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),e.prototype.start=function(t,r){var n=this;if(this._disposed)return Promise.resolve("none");if(this._promise)return this._promise;this._addListeners(),this._attachDragImage(t,r),this._promise=new Promise(function(o,s){n._resolve=o});var i=tl.createMouseEvent("pointermove",t,r);return document.dispatchEvent(i),this._promise},e.prototype.handleEvent=function(t){switch(t.type){case"mousemove":this._evtMouseMove(t);break;case"mouseup":this._evtMouseUp(t);break;case"pointermove":this._evtMouseMove(t);break;case"pointerup":this._evtMouseUp(t);break;case"keydown":this._evtKeyDown(t);break;default:t.preventDefault(),t.stopPropagation();break}},e.prototype.moveDragImage=function(t,r){if(this.dragImage){var n=this.dragImage.style;n.top=r+"px",n.left=t+"px"}},e.prototype._evtMouseMove=function(t){t.preventDefault(),t.stopPropagation(),this._updateCurrentTarget(t),this._updateDragScroll(t),this.moveDragImage(t.clientX,t.clientY)},e.prototype._evtMouseUp=function(t){if(t.preventDefault(),t.stopPropagation(),t.button===0){if(this._updateCurrentTarget(t),!this._currentTarget){this._finalize("none");return}if(this._dropAction==="none"){tl.dispatchDragLeave(this,this._currentTarget,null,t),this._finalize("none");return}var r=tl.dispatchDrop(this,this._currentTarget,t);this._finalize(r)}},e.prototype._evtKeyDown=function(t){t.preventDefault(),t.stopPropagation(),t.keyCode===27&&this.dispose()},e.prototype._addListeners=function(){document.addEventListener("mousedown",this,!0),document.addEventListener("mousemove",this,!0),document.addEventListener("mouseup",this,!0),document.addEventListener("mouseenter",this,!0),document.addEventListener("mouseleave",this,!0),document.addEventListener("mouseover",this,!0),document.addEventListener("mouseout",this,!0),document.addEventListener("pointerdown",this,!0),document.addEventListener("pointermove",this,!0),document.addEventListener("pointerup",this,!0),document.addEventListener("pointerenter",this,!0),document.addEventListener("pointerleave",this,!0),document.addEventListener("pointerover",this,!0),document.addEventListener("pointerout",this,!0),document.addEventListener("keydown",this,!0),document.addEventListener("keyup",this,!0),document.addEventListener("keypress",this,!0),document.addEventListener("contextmenu",this,!0)},e.prototype._removeListeners=function(){document.removeEventListener("mousedown",this,!0),document.removeEventListener("mousemove",this,!0),document.removeEventListener("mouseup",this,!0),document.removeEventListener("mouseenter",this,!0),document.removeEventListener("mouseleave",this,!0),document.removeEventListener("mouseover",this,!0),document.removeEventListener("mouseout",this,!0),document.removeEventListener("pointerdown",this,!0),document.removeEventListener("pointermove",this,!0),document.removeEventListener("pointerup",this,!0),document.removeEventListener("pointerenter",this,!0),document.removeEventListener("pointerleave",this,!0),document.removeEventListener("pointerover",this,!0),document.removeEventListener("pointerout",this,!0),document.removeEventListener("keydown",this,!0),document.removeEventListener("keyup",this,!0),document.removeEventListener("keypress",this,!0),document.removeEventListener("contextmenu",this,!0)},e.prototype._updateDragScroll=function(t){var r=tl.findScrollTarget(t);!this._scrollTarget&&!r||(this._scrollTarget||setTimeout(this._onScrollFrame,500),this._scrollTarget=r)},e.prototype._updateCurrentTarget=function(t){var r=this._currentTarget,n=this._currentTarget,i=this._currentElement,o=this.document.elementFromPoint(t.clientX,t.clientY);this._currentElement=o,o!==i&&o!==n&&tl.dispatchDragExit(this,n,o,t),o!==i&&o!==n&&(n=tl.dispatchDragEnter(this,o,n,t)),n!==r&&(this._currentTarget=n,tl.dispatchDragLeave(this,r,n,t));var s=tl.dispatchDragOver(this,n,t);this._setDropAction(s)},e.prototype._attachDragImage=function(t,r){if(this.dragImage){this.dragImage.classList.add("lm-mod-drag-image"),this.dragImage.classList.add("p-mod-drag-image");var n=this.dragImage.style;n.pointerEvents="none",n.position="fixed",n.top=r+"px",n.left=t+"px";var i=this.document instanceof Document?this.document.body:this.document.firstElementChild;i.appendChild(this.dragImage)}},e.prototype._detachDragImage=function(){if(this.dragImage){var t=this.dragImage.parentNode;t&&t.removeChild(this.dragImage)}},e.prototype._setDropAction=function(t){if(t=tl.validateAction(t,this.supportedActions),!(this._override&&this._dropAction===t))switch(t){case"none":this._dropAction=t,this._override=e.overrideCursor("no-drop",this.document);break;case"copy":this._dropAction=t,this._override=e.overrideCursor("copy",this.document);break;case"link":this._dropAction=t,this._override=e.overrideCursor("alias",this.document);break;case"move":this._dropAction=t,this._override=e.overrideCursor("move",this.document);break}},e.prototype._finalize=function(t){var r=this._resolve;this._removeListeners(),this._detachDragImage(),this._override&&(this._override.dispose(),this._override=null),this.mimeData.clear(),this._disposed=!0,this._dropAction="none",this._currentTarget=null,this._currentElement=null,this._scrollTarget=null,this._promise=null,this._resolve=null,r&&r(t)},e}();(function(e){function t(n,i){i===void 0&&(i=document);var o=++r,s=i instanceof Document?i.body:i.firstElementChild;return s.style.cursor=n,s.classList.add("lm-mod-override-cursor"),s.classList.add("p-mod-override-cursor"),new fA(function(){o===r&&(s.style.cursor="",s.classList.remove("lm-mod-override-cursor"),s.classList.remove("p-mod-override-cursor"))})}e.overrideCursor=t;var r=0})(pA||(pA={}));var tl;(function(e){e.SCROLL_EDGE_SIZE=20;function t(w,E){return h[w]&p[E]?w:"none"}e.validateAction=t;function r(w,E,P){var B=document.createEvent("MouseEvent");return B.initMouseEvent(w,!0,!0,window,0,0,0,E,P,!1,!1,!1,!1,0,null),B}e.createMouseEvent=r;function n(w){for(var E=w.clientX,P=w.clientY,B=document.elementFromPoint(E,P);B;B=B.parentElement){var D=B.hasAttribute("data-lm-dragscroll");if(D=D||B.hasAttribute("data-p-dragscroll"),!!D){var W=0,X=0;B===document.body&&(W=window.pageXOffset,X=window.pageYOffset);var q=B.getBoundingClientRect(),$=q.top+X,et=q.left+W,F=et+q.width,ut=$+q.height;if(!(E<et||E>=F||P<$||P>=ut)){var ot=E-et+1,J=P-$+1,G=F-E,mt=ut-P,Mt=Math.min(ot,J,G,mt);if(!(Mt>e.SCROLL_EDGE_SIZE)){var ct=void 0;switch(Mt){case mt:ct="bottom";break;case J:ct="top";break;case G:ct="right";break;case ot:ct="left";break;default:throw"unreachable"}var gt=B.scrollWidth-B.clientWidth,ee=B.scrollHeight-B.clientHeight,Ne=void 0;switch(ct){case"top":Ne=ee>0&&B.scrollTop>0;break;case"left":Ne=gt>0&&B.scrollLeft>0;break;case"right":Ne=gt>0&&B.scrollLeft<gt;break;case"bottom":Ne=ee>0&&B.scrollTop<ee;break;default:throw"unreachable"}if(Ne)return{element:B,edge:ct,distance:Mt}}}}}return null}e.findScrollTarget=n;function i(w,E,P,B){if(!E)return null;var D=x("lm-dragenter",w,B,P),W=!E.dispatchEvent(D);if(W||(D=x("p-dragenter",w,B,P),W=!E.dispatchEvent(D),W))return E;var X=w.document instanceof Document?w.document.body:w.document.firstElementChild;return E===X?P:(D=x("lm-dragenter",w,B,P),X.dispatchEvent(D),D=x("p-dragenter",w,B,P),X.dispatchEvent(D),X)}e.dispatchDragEnter=i;function o(w,E,P,B){if(E){var D=x("lm-dragexit",w,B,P);E.dispatchEvent(D),D=x("p-dragexit",w,B,P),E.dispatchEvent(D)}}e.dispatchDragExit=o;function s(w,E,P,B){if(E){var D=x("lm-dragleave",w,B,P);E.dispatchEvent(D),D=x("p-dragleave",w,B,P),E.dispatchEvent(D)}}e.dispatchDragLeave=s;function c(w,E,P){if(!E)return"none";var B=x("lm-dragover",w,P,null),D=!E.dispatchEvent(B);return D||(B=x("p-dragover",w,P,null),D=!E.dispatchEvent(B),D)?B.dropAction:"none"}e.dispatchDragOver=c;function l(w,E,P){if(!E)return"none";var B=x("lm-drop",w,P,null),D=!E.dispatchEvent(B);return D||(B=x("p-drop",w,P,null),D=!E.dispatchEvent(B),D)?B.dropAction:"none"}e.dispatchDrop=l;var h={none:0,copy:1,link:2,move:4},p={none:h.none,copy:h.copy,link:h.link,move:h.move,"copy-link":h.copy|h.link,"copy-move":h.copy|h.move,"link-move":h.link|h.move,all:h.copy|h.link|h.move};function x(w,E,P,B){var D=document.createEvent("MouseEvent");return D.initMouseEvent(w,!0,!0,window,0,P.screenX,P.screenY,P.clientX,P.clientY,P.ctrlKey,P.altKey,P.shiftKey,P.metaKey,P.button,B),D.dropAction="none",D.mimeData=E.mimeData,D.proposedAction=E.proposedAction,D.supportedActions=E.supportedActions,D.source=E.source,D}})(tl||(tl={}));var Og=tc(B1());var vl=tc(B1());function vx(){return y8.keyboardLayout}var _8=function(){function e(t,r,n){n===void 0&&(n=[]),this.name=t,this._codes=r,this._keys=e.extractKeys(r),this._modifierKeys=e.convertToKeySet(n)}return e.prototype.keys=function(){return Object.keys(this._keys)},e.prototype.isValidKey=function(t){return t in this._keys},e.prototype.isModifierKey=function(t){return t in this._modifierKeys},e.prototype.keyForKeydownEvent=function(t){return this._codes[t.keyCode]||""},e}();(function(e){function t(n){var i=Object.create(null);for(var o in n)i[n[o]]=!0;return i}e.extractKeys=t;function r(n){for(var i=Object(null),o=0,s=n.length;o<s;++o)i[n[o]]=!0;return i}e.convertToKeySet=r})(_8||(_8={}));var Lzt=new _8("en-us",{8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",27:"Escape",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"Meta",93:"ContextMenu",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Meta"},["Shift","Ctrl","Alt","Meta"]),y8;(function(e){e.keyboardLayout=Lzt})(y8||(y8={}));var x8=function(){return x8=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},x8.apply(this,arguments)},bx=function(){function e(){this._timerID=0,this._replaying=!1,this._keystrokes=[],this._keydownEvents=[],this._keyBindings=[],this._exactKeyMatch=null,this._commands=Object.create(null),this._commandChanged=new Di(this),this._commandExecuted=new Di(this),this._keyBindingChanged=new Di(this)}return Object.defineProperty(e.prototype,"commandChanged",{get:function(){return this._commandChanged},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"commandExecuted",{get:function(){return this._commandExecuted},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keyBindingChanged",{get:function(){return this._keyBindingChanged},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keyBindings",{get:function(){return this._keyBindings},enumerable:!0,configurable:!0}),e.prototype.listCommands=function(){return Object.keys(this._commands)},e.prototype.hasCommand=function(t){return t in this._commands},e.prototype.addCommand=function(t,r){var n=this;if(t in this._commands)throw new Error("Command '"+t+"' already registered.");return this._commands[t]=dA.createCommand(r),this._commandChanged.emit({id:t,type:"added"}),new fA(function(){delete n._commands[t],n._commandChanged.emit({id:t,type:"removed"})})},e.prototype.notifyCommandChanged=function(t){if(t!==void 0&&!(t in this._commands))throw new Error("Command '"+t+"' is not registered.");this._commandChanged.emit({id:t,type:t?"changed":"many-changed"})},e.prototype.describedBy=function(t){var r=this._commands[t];return r?r.describedBy||{args:null}:{args:null}},e.prototype.label=function(t,r){r===void 0&&(r=vl.JSONExt.emptyObject);var n=this._commands[t];return n?n.label.call(void 0,r):""},e.prototype.mnemonic=function(t,r){r===void 0&&(r=vl.JSONExt.emptyObject);var n=this._commands[t];return n?n.mnemonic.call(void 0,r):-1},e.prototype.icon=function(t,r){r===void 0&&(r=vl.JSONExt.emptyObject);var n=this._commands[t];return n?n.icon.call(void 0,r):""},e.prototype.iconClass=function(t,r){r===void 0&&(r=vl.JSONExt.emptyObject);var n=this._commands[t];return n?n.iconClass.call(void 0,r):""},e.prototype.iconLabel=function(t,r){r===void 0&&(r=vl.JSONExt.emptyObject);var n=this._commands[t];return n?n.iconLabel.call(void 0,r):""},e.prototype.caption=function(t,r){r===void 0&&(r=vl.JSONExt.emptyObject);var n=this._commands[t];return n?n.caption.call(void 0,r):""},e.prototype.usage=function(t,r){r===void 0&&(r=vl.JSONExt.emptyObject);var n=this._commands[t];return n?n.usage.call(void 0,r):""},e.prototype.className=function(t,r){r===void 0&&(r=vl.JSONExt.emptyObject);var n=this._commands[t];return n?n.className.call(void 0,r):""},e.prototype.dataset=function(t,r){r===void 0&&(r=vl.JSONExt.emptyObject);var n=this._commands[t];return n?n.dataset.call(void 0,r):{}},e.prototype.isEnabled=function(t,r){r===void 0&&(r=vl.JSONExt.emptyObject);var n=this._commands[t];return n?n.isEnabled.call(void 0,r):!1},e.prototype.isToggled=function(t,r){r===void 0&&(r=vl.JSONExt.emptyObject);var n=this._commands[t];return n?n.isToggled.call(void 0,r):!1},e.prototype.isToggleable=function(t,r){var n=this._commands[t];return n?n.isToggleable:!1},e.prototype.isVisible=function(t,r){r===void 0&&(r=vl.JSONExt.emptyObject);var n=this._commands[t];return n?n.isVisible.call(void 0,r):!1},e.prototype.execute=function(t,r){r===void 0&&(r=vl.JSONExt.emptyObject);var n=this._commands[t];if(!n)return Promise.reject(new Error("Command '"+t+"' not registered."));var i;try{i=n.execute.call(void 0,r)}catch(s){i=Promise.reject(s)}var o=Promise.resolve(i);return this._commandExecuted.emit({id:t,args:r,result:o}),o},e.prototype.addKeyBinding=function(t){var r=this,n=dA.createKeyBinding(t);return this._keyBindings.push(n),this._keyBindingChanged.emit({binding:n,type:"added"}),new fA(function(){Ze.removeFirstOf(r._keyBindings,n),r._keyBindingChanged.emit({binding:n,type:"removed"})})},e.prototype.processKeydownEvent=function(t){if(!(this._replaying||e.isModifierKeyPressed(t))){var r=e.keystrokeForKeydownEvent(t);if(!r){this._replayKeydownEvents(),this._clearPendingState();return}this._keystrokes.push(r);var n=dA.matchKeyBinding(this._keyBindings,this._keystrokes,t),i=n.exact,o=n.partial;if(!i&&!o){this._replayKeydownEvents(),this._clearPendingState();return}if(t.preventDefault(),t.stopPropagation(),i&&!o){this._executeKeyBinding(i),this._clearPendingState();return}i&&(this._exactKeyMatch=i),this._keydownEvents.push(t),this._startTimer()}},e.prototype._startTimer=function(){var t=this;this._clearTimer(),this._timerID=window.setTimeout(function(){t._onPendingTimeout()},dA.CHORD_TIMEOUT)},e.prototype._clearTimer=function(){this._timerID!==0&&(clearTimeout(this._timerID),this._timerID=0)},e.prototype._replayKeydownEvents=function(){this._keydownEvents.length!==0&&(this._replaying=!0,this._keydownEvents.forEach(dA.replayKeyEvent),this._replaying=!1)},e.prototype._executeKeyBinding=function(t){var r=t.command,n=t.args;if(!this.hasCommand(r)||!this.isEnabled(r,n)){var i=this.hasCommand(r)?"enabled":"registered",o=t.keys.join(", "),s="Cannot execute key binding '"+o+"':",c="command '"+r+"' is not "+i+".";console.warn(s+" "+c);return}this.execute(r,n)},e.prototype._clearPendingState=function(){this._clearTimer(),this._exactKeyMatch=null,this._keystrokes.length=0,this._keydownEvents.length=0},e.prototype._onPendingTimeout=function(){this._timerID=0,this._exactKeyMatch?this._executeKeyBinding(this._exactKeyMatch):this._replayKeydownEvents(),this._clearPendingState()},e}();(function(e){function t(c){for(var l="",h=!1,p=!1,x=!1,w=!1,E=0,P=c.split(/\s+/);E<P.length;E++){var B=P[E];B==="Accel"?lc.IS_MAC?p=!0:x=!0:B==="Alt"?h=!0:B==="Cmd"?p=!0:B==="Ctrl"?x=!0:B==="Shift"?w=!0:B.length>0&&(l=B)}return{cmd:p,ctrl:x,alt:h,shift:w,key:l}}e.parseKeystroke=t;function r(c){var l="",h=t(c);return h.ctrl&&(l+="Ctrl "),h.alt&&(l+="Alt "),h.shift&&(l+="Shift "),h.cmd&&lc.IS_MAC&&(l+="Cmd "),l+h.key}e.normalizeKeystroke=r;function n(c){var l;return lc.IS_WIN?l=c.winKeys||c.keys:lc.IS_MAC?l=c.macKeys||c.keys:l=c.linuxKeys||c.keys,l.map(r)}e.normalizeKeys=n;function i(c){return typeof c=="string"?l(c):c.map(l).join(", ");function l(h){var p=[],x=lc.IS_MAC?" ":"+",w=t(h);return w.ctrl&&p.push("Ctrl"),w.alt&&p.push("Alt"),w.shift&&p.push("Shift"),lc.IS_MAC&&w.cmd&&p.push("Cmd"),p.push(w.key),p.map(dA.formatKey).join(x)}}e.formatKeystroke=i;function o(c){var l=vx(),h=l.keyForKeydownEvent(c);return l.isModifierKey(h)}e.isModifierKeyPressed=o;function s(c){var l=vx(),h=l.keyForKeydownEvent(c);if(!h||l.isModifierKey(h))return"";var p=[];return c.ctrlKey&&p.push("Ctrl"),c.altKey&&p.push("Alt"),c.shiftKey&&p.push("Shift"),c.metaKey&&lc.IS_MAC&&p.push("Cmd"),p.push(h),p.join(" ")}e.keystrokeForKeydownEvent=s})(bx||(bx={}));var dA;(function(e){e.CHORD_TIMEOUT=1e3;function t(q){var $,et;return!q.icon||typeof q.icon=="string"?(et=P(q.iconClass||q.icon,l),$=et):(et=P(q.iconClass,l),$=P(q.icon,E)),{execute:q.execute,describedBy:x8({args:null},q.describedBy),label:P(q.label,l),mnemonic:P(q.mnemonic,h),icon:$,iconClass:et,iconLabel:P(q.iconLabel,l),caption:P(q.caption,l),usage:P(q.usage,l),className:P(q.className,l),dataset:P(q.dataset,w),isEnabled:q.isEnabled||p,isToggled:q.isToggled||x,isToggleable:q.isToggleable||!!q.isToggled,isVisible:q.isVisible||p}}e.createCommand=t;function r(q){return{keys:bx.normalizeKeys(q),selector:B(q),command:q.command,args:q.args||vl.JSONExt.emptyObject}}e.createKeyBinding=r;function n(q,$,et){for(var F=null,ut=!1,ot=1/0,J=0,G=0,mt=q.length;G<mt;++G){var Mt=q[G],ct=D(Mt.keys,$);if(ct!==0){if(ct===2){!ut&&W(Mt.selector,et)!==-1&&(ut=!0);continue}var gt=W(Mt.selector,et);if(!(gt===-1||gt>ot)){var ee=Qh.calculateSpecificity(Mt.selector);(!F||gt<ot||ee>=J)&&(F=Mt,ot=gt,J=ee)}}}return{exact:F,partial:ut}}e.matchKeyBinding=n;function i(q){q.target.dispatchEvent(X(q))}e.replayKeyEvent=i;function o(q){return lc.IS_MAC?s.hasOwnProperty(q)?s[q]:q:c.hasOwnProperty(q)?c[q]:q}e.formatKey=o;var s={Backspace:"\u232B",Tab:"\u21E5",Enter:"\u21A9",Shift:"\u21E7",Ctrl:"\u2303",Alt:"\u2325",Escape:"\u238B",PageUp:"\u21DE",PageDown:"\u21DF",End:"\u2198",Home:"\u2196",ArrowLeft:"\u2190",ArrowUp:"\u2191",ArrowRight:"\u2192",ArrowDown:"\u2193",Delete:"\u2326",Cmd:"\u2318"},c={Escape:"Esc",PageUp:"Page Up",PageDown:"Page Down",ArrowLeft:"Left",ArrowUp:"Up",ArrowRight:"Right",ArrowDown:"Down",Delete:"Del"},l=function(){return""},h=function(){return-1},p=function(){return!0},x=function(){return!1},w=function(){return{}},E=function(){};function P(q,$){return q===void 0?$:typeof q=="function"?q:function(){return q}}function B(q){if(q.selector.indexOf(",")!==-1)throw new Error("Selector cannot contain commas: "+q.selector);if(!Qh.isValid(q.selector))throw new Error("Invalid selector: "+q.selector);return q.selector}function D(q,$){if(q.length<$.length)return 0;for(var et=0,F=$.length;et<F;++et)if(q[et]!==$[et])return 0;return q.length>$.length?2:1}function W(q,$){for(var et=$.target,F=$.currentTarget,ut=0;et!==null;et=et.parentElement,++ut){if(et.hasAttribute("data-lm-suppress-shortcuts")||et.hasAttribute("data-p-suppress-shortcuts"))return-1;if(Qh.matches(et,q))return ut;if(et===F)return-1}return-1}function X(q){var $=document.createEvent("Event"),et=q.bubbles||!0,F=q.cancelable||!0;return $.initEvent(q.type||"keydown",et,F),$.key=q.key||"",$.keyCode=q.keyCode||0,$.which=q.keyCode||0,$.ctrlKey=q.ctrlKey||!1,$.altKey=q.altKey||!1,$.shiftKey=q.shiftKey||!1,$.metaKey=q.metaKey||!1,$.view=q.view||window,$}})(dA||(dA={}));var v8=function(e,t){return v8=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},v8(e,t)};function Ozt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");v8(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var HR=function(){function e(t){this.type="text",this.content=t}return e}(),WR=function(){function e(t,r,n,i){this.type="element",this.tag=t,this.attrs=r,this.children=n,this.renderer=i}return e}(),LWe=function(e){Ozt(t,e);function t(r,n,i){return e.call(this,r,n,[],i||void 0)||this}return t}(WR);function Ji(e){for(var t={},r,n=[],i=1,o=arguments.length;i<o;++i){var s=arguments[i];typeof s=="string"?n.push(new HR(s)):s instanceof HR||s instanceof WR?n.push(s):s instanceof Array?c(n,s):(i===1||i===2)&&s&&typeof s=="object"&&("render"in s?r=s:t=s)}return new WR(e,t,n,r);function c(l,h){for(var p=0,x=h;p<x.length;p++){var w=x[p];typeof w=="string"?l.push(new HR(w)):(w instanceof HR||w instanceof WR)&&l.push(w)}}}(function(e){e.a=e.bind(void 0,"a"),e.abbr=e.bind(void 0,"abbr"),e.address=e.bind(void 0,"address"),e.area=e.bind(void 0,"area"),e.article=e.bind(void 0,"article"),e.aside=e.bind(void 0,"aside"),e.audio=e.bind(void 0,"audio"),e.b=e.bind(void 0,"b"),e.bdi=e.bind(void 0,"bdi"),e.bdo=e.bind(void 0,"bdo"),e.blockquote=e.bind(void 0,"blockquote"),e.br=e.bind(void 0,"br"),e.button=e.bind(void 0,"button"),e.canvas=e.bind(void 0,"canvas"),e.caption=e.bind(void 0,"caption"),e.cite=e.bind(void 0,"cite"),e.code=e.bind(void 0,"code"),e.col=e.bind(void 0,"col"),e.colgroup=e.bind(void 0,"colgroup"),e.data=e.bind(void 0,"data"),e.datalist=e.bind(void 0,"datalist"),e.dd=e.bind(void 0,"dd"),e.del=e.bind(void 0,"del"),e.dfn=e.bind(void 0,"dfn"),e.div=e.bind(void 0,"div"),e.dl=e.bind(void 0,"dl"),e.dt=e.bind(void 0,"dt"),e.em=e.bind(void 0,"em"),e.embed=e.bind(void 0,"embed"),e.fieldset=e.bind(void 0,"fieldset"),e.figcaption=e.bind(void 0,"figcaption"),e.figure=e.bind(void 0,"figure"),e.footer=e.bind(void 0,"footer"),e.form=e.bind(void 0,"form"),e.h1=e.bind(void 0,"h1"),e.h2=e.bind(void 0,"h2"),e.h3=e.bind(void 0,"h3"),e.h4=e.bind(void 0,"h4"),e.h5=e.bind(void 0,"h5"),e.h6=e.bind(void 0,"h6"),e.header=e.bind(void 0,"header"),e.hr=e.bind(void 0,"hr"),e.i=e.bind(void 0,"i"),e.iframe=e.bind(void 0,"iframe"),e.img=e.bind(void 0,"img"),e.input=e.bind(void 0,"input"),e.ins=e.bind(void 0,"ins"),e.kbd=e.bind(void 0,"kbd"),e.label=e.bind(void 0,"label"),e.legend=e.bind(void 0,"legend"),e.li=e.bind(void 0,"li"),e.main=e.bind(void 0,"main"),e.map=e.bind(void 0,"map"),e.mark=e.bind(void 0,"mark"),e.meter=e.bind(void 0,"meter"),e.nav=e.bind(void 0,"nav"),e.noscript=e.bind(void 0,"noscript"),e.object=e.bind(void 0,"object"),e.ol=e.bind(void 0,"ol"),e.optgroup=e.bind(void 0,"optgroup"),e.option=e.bind(void 0,"option"),e.output=e.bind(void 0,"output"),e.p=e.bind(void 0,"p"),e.param=e.bind(void 0,"param"),e.pre=e.bind(void 0,"pre"),e.progress=e.bind(void 0,"progress"),e.q=e.bind(void 0,"q"),e.rp=e.bind(void 0,"rp"),e.rt=e.bind(void 0,"rt"),e.ruby=e.bind(void 0,"ruby"),e.s=e.bind(void 0,"s"),e.samp=e.bind(void 0,"samp"),e.section=e.bind(void 0,"section"),e.select=e.bind(void 0,"select"),e.small=e.bind(void 0,"small"),e.source=e.bind(void 0,"source"),e.span=e.bind(void 0,"span"),e.strong=e.bind(void 0,"strong"),e.sub=e.bind(void 0,"sub"),e.summary=e.bind(void 0,"summary"),e.sup=e.bind(void 0,"sup"),e.table=e.bind(void 0,"table"),e.tbody=e.bind(void 0,"tbody"),e.td=e.bind(void 0,"td"),e.textarea=e.bind(void 0,"textarea"),e.tfoot=e.bind(void 0,"tfoot"),e.th=e.bind(void 0,"th"),e.thead=e.bind(void 0,"thead"),e.time=e.bind(void 0,"time"),e.title=e.bind(void 0,"title"),e.tr=e.bind(void 0,"tr"),e.track=e.bind(void 0,"track"),e.u=e.bind(void 0,"u"),e.ul=e.bind(void 0,"ul"),e.var_=e.bind(void 0,"var"),e.video=e.bind(void 0,"video"),e.wbr=e.bind(void 0,"wbr")})(Ji||(Ji={}));var Sd;(function(e){function t(n){return Rg.createDOMNode(n)}e.realize=t;function r(n,i){var o=Rg.hostMap.get(i)||[],s=Rg.asContentArray(n);Rg.hostMap.set(i,s),Rg.updateContent(i,o,s)}e.render=r})(Sd||(Sd={}));var Rg;(function(e){e.hostMap=new WeakMap;function t(E){return E?E instanceof Array?E:[E]:[]}e.asContentArray=t;function r(E){var P=arguments[1]||null,B=arguments[2]||null;if(P)P.insertBefore(r(E),B);else{if(E.type==="text")return document.createTextNode(E.content);if(P=document.createElement(E.tag),s(P,E.attrs),E.renderer)return E.renderer.render(P,{attrs:E.attrs,children:E.children}),P;for(var D=0,W=E.children.length;D<W;++D)r(E.children[D],P)}return P}e.createDOMNode=r;function n(E,P,B){if(P!==B){for(var D=w(E,P),W=P.slice(),X=E.firstChild,q=B.length,$=0;$<q;++$){if($>=W.length){r(B[$],E);continue}var et=W[$],F=B[$];if(et===F){X=X.nextSibling;continue}if(et.type==="text"&&F.type==="text"){X.textContent!==F.content&&(X.textContent=F.content),X=X.nextSibling;continue}if(et.type==="text"||F.type==="text"){Ze.insert(W,$,F),r(F,E,X);continue}if(!et.renderer!=!F.renderer){Ze.insert(W,$,F),r(F,E,X);continue}var ut=F.attrs.key;if(ut&&ut in D){var ot=D[ut];ot.vNode!==et&&(Ze.move(W,W.indexOf(ot.vNode,$+1),$),E.insertBefore(ot.element,X),et=ot.vNode,X=ot.element)}if(et===F){X=X.nextSibling;continue}var J=et.attrs.key;if(J&&J!==ut){Ze.insert(W,$,F),r(F,E,X);continue}if(et.tag!==F.tag){Ze.insert(W,$,F),r(F,E,X);continue}c(X,et.attrs,F.attrs),F.renderer?F.renderer.render(X,{attrs:F.attrs,children:F.children}):n(X,et.children,F.children),X=X.nextSibling}i(E,W,q,!0)}}e.updateContent=n;function i(E,P,B,D){for(var W=P.length-1;W>=B;--W){var X=P[W],q=D?E.lastChild:E.childNodes[W];X.type==="text"||(X.renderer&&X.renderer.unrender?X.renderer.unrender(q,{attrs:X.attrs,children:X.children}):i(q,X.children,0,!1)),D&&E.removeChild(q)}}var o={key:!0,className:!0,htmlFor:!0,dataset:!0,style:!0};function s(E,P){for(var B in P)B in o||(B.substr(0,2)==="on"?E[B]=P[B]:E.setAttribute(B,P[B]));P.className!==void 0&&E.setAttribute("class",P.className),P.htmlFor!==void 0&&E.setAttribute("for",P.htmlFor),P.dataset&&l(E,P.dataset),P.style&&p(E,P.style)}function c(E,P,B){if(P!==B){var D;for(D in P)D in o||D in B||(D.substr(0,2)==="on"?E[D]=null:E.removeAttribute(D));for(D in B)D in o||P[D]===B[D]||(D.substr(0,2)==="on"?E[D]=B[D]:E.setAttribute(D,B[D]));P.className!==B.className&&(B.className!==void 0?E.setAttribute("class",B.className):E.removeAttribute("class")),P.htmlFor!==B.htmlFor&&(B.htmlFor!==void 0?E.setAttribute("for",B.htmlFor):E.removeAttribute("for")),P.dataset!==B.dataset&&h(E,P.dataset||{},B.dataset||{}),P.style!==B.style&&x(E,P.style||{},B.style||{})}}function l(E,P){for(var B in P)E.setAttribute("data-"+B,P[B])}function h(E,P,B){for(var D in P)D in B||E.removeAttribute("data-"+D);for(var W in B)P[W]!==B[W]&&E.setAttribute("data-"+W,B[W])}function p(E,P){var B=E.style,D;for(D in P)B[D]=P[D]}function x(E,P,B){var D=E.style,W;for(W in P)W in B||(D[W]="");for(W in B)P[W]!==B[W]&&(D[W]=B[W])}function w(E,P){for(var B=E.firstChild,D=Object.create(null),W=0,X=P;W<X.length;W++){var q=X[W];q.type==="element"&&q.attrs.key&&(D[q.attrs.key]={vNode:q,element:B}),B=B.nextSibling}return D}})(Rg||(Rg={}));var b8=function(e,t){return b8=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},b8(e,t)};function Ds(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");b8(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var uc=function(){return uc=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},uc.apply(this,arguments)};function Bzt(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Dzt(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var o=arguments[t],s=0,c=o.length;s<c;s++,i++)n[i]=o[s];return n}var mA=function(){function e(){this.sizeHint=0,this.minSize=0,this.maxSize=1/0,this.stretch=1,this.size=0,this.done=!1}return e}(),xu;(function(e){function t(o,s){var c=o.length;if(c===0)return s;for(var l=0,h=0,p=0,x=0,w=0,E=0;E<c;++E){var P=o[E],B=P.minSize,D=P.maxSize,W=P.sizeHint;P.done=!1,P.size=Math.max(B,Math.min(W,D)),p+=P.size,l+=B,h+=D,P.stretch>0&&(x+=P.stretch,w++)}if(s===p)return 0;if(s<=l){for(var E=0;E<c;++E){var P=o[E];P.size=P.minSize}return s-l}if(s>=h){for(var E=0;E<c;++E){var P=o[E];P.size=P.maxSize}return s-h}var X=.01,q=c;if(s<p){for(var $=p-s;w>0&&$>X;)for(var et=$,F=x,E=0;E<c;++E){var P=o[E];if(!(P.done||P.stretch===0)){var ut=P.stretch*et/F;P.size-ut<=P.minSize?($-=P.size-P.minSize,x-=P.stretch,P.size=P.minSize,P.done=!0,q--,w--):($-=ut,P.size-=ut)}}for(;q>0&&$>X;)for(var ut=$/q,E=0;E<c;++E){var P=o[E];P.done||(P.size-ut<=P.minSize?($-=P.size-P.minSize,P.size=P.minSize,P.done=!0,q--):($-=ut,P.size-=ut))}}else{for(var $=s-p;w>0&&$>X;)for(var et=$,F=x,E=0;E<c;++E){var P=o[E];if(!(P.done||P.stretch===0)){var ut=P.stretch*et/F;P.size+ut>=P.maxSize?($-=P.maxSize-P.size,x-=P.stretch,P.size=P.maxSize,P.done=!0,q--,w--):($-=ut,P.size+=ut)}}for(;q>0&&$>X;)for(var ut=$/q,E=0;E<c;++E){var P=o[E];P.done||(P.size+ut>=P.maxSize?($-=P.maxSize-P.size,P.size=P.maxSize,P.done=!0,q--):($-=ut,P.size+=ut))}}return 0}e.calc=t;function r(o,s,c){o.length===0||c===0||(c>0?n(o,s,c):i(o,s,-c))}e.adjust=r;function n(o,s,c){for(var l=0,h=0;h<=s;++h){var p=o[h];l+=p.maxSize-p.size}for(var x=0,h=s+1,w=o.length;h<w;++h){var p=o[h];x+=p.size-p.minSize}c=Math.min(c,l,x);for(var E=c,h=s;h>=0&&E>0;--h){var p=o[h],P=p.maxSize-p.size;P>=E?(p.sizeHint=p.size+E,E=0):(p.sizeHint=p.size+P,E-=P)}for(var B=c,h=s+1,w=o.length;h<w&&B>0;++h){var p=o[h],P=p.size-p.minSize;P>=B?(p.sizeHint=p.size-B,B=0):(p.sizeHint=p.size-P,B-=P)}}function i(o,s,c){for(var l=0,h=s+1,p=o.length;h<p;++h){var x=o[h];l+=x.maxSize-x.size}for(var w=0,h=0;h<=s;++h){var x=o[h];w+=x.size-x.minSize}c=Math.min(c,l,w);for(var E=c,h=s+1,p=o.length;h<p&&E>0;++h){var x=o[h],P=x.maxSize-x.size;P>=E?(x.sizeHint=x.size+E,E=0):(x.sizeHint=x.size+P,E-=P)}for(var B=c,h=s;h>=0&&B>0;--h){var x=o[h],P=x.size-x.minSize;P>=B?(x.sizeHint=x.size-B,B=0):(x.sizeHint=x.size-P,B-=P)}}})(xu||(xu={}));var w8=function(){function e(t){this._label="",this._caption="",this._mnemonic=-1,this._iconClass="",this._iconLabel="",this._className="",this._closable=!1,this._changed=new Di(this),this._isDisposed=!1,this.owner=t.owner,t.label!==void 0&&(this._label=t.label),t.mnemonic!==void 0&&(this._mnemonic=t.mnemonic),t.icon!==void 0?typeof t.icon=="string"?(this._icon=null,this._iconClass=t.icon):this._icon=t.icon:this._icon=null,t.iconClass!==void 0&&(this._iconClass=t.iconClass),t.iconLabel!==void 0&&(this._iconLabel=t.iconLabel),t.iconRenderer!==void 0&&(this._icon=t.iconRenderer),t.caption!==void 0&&(this._caption=t.caption),t.className!==void 0&&(this._className=t.className),t.closable!==void 0&&(this._closable=t.closable),this._dataset=t.dataset||{}}return Object.defineProperty(e.prototype,"changed",{get:function(){return this._changed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){return this._label},set:function(t){this._label!==t&&(this._label=t,this._changed.emit(void 0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mnemonic",{get:function(){return this._mnemonic},set:function(t){this._mnemonic!==t&&(this._mnemonic=t,this._changed.emit(void 0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this._icon===null?this.iconClass:this._icon},set:function(t){if(typeof t=="string")this._icon=null,this.iconClass=t;else{if(this._icon===t)return;this._icon=t,this._changed.emit(void 0)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iconClass",{get:function(){return this._iconClass},set:function(t){this._iconClass!==t&&(this._iconClass=t,this._changed.emit(void 0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iconLabel",{get:function(){return this._iconLabel},set:function(t){this._iconLabel!==t&&(this._iconLabel=t,this._changed.emit(void 0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iconRenderer",{get:function(){return this._icon||void 0},set:function(t){this.icon=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"caption",{get:function(){return this._caption},set:function(t){this._caption!==t&&(this._caption=t,this._changed.emit(void 0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},set:function(t){this._className!==t&&(this._className=t,this._changed.emit(void 0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"closable",{get:function(){return this._closable},set:function(t){this._closable!==t&&(this._closable=t,this._changed.emit(void 0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataset",{get:function(){return this._dataset},set:function(t){this._dataset!==t&&(this._dataset=t,this._changed.emit(void 0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.isDisposed||(this._isDisposed=!0,Di.clearData(this))},e}(),Mr=function(){function e(t){t===void 0&&(t={}),this._flags=0,this._layout=null,this._parent=null,this._disposed=new Di(this),this._hiddenMode=e.HiddenMode.Display,this.node=qR.createNode(t),this.addClass("lm-Widget"),this.addClass("p-Widget")}return e.prototype.dispose=function(){this.isDisposed||(this.setFlag(e.Flag.IsDisposed),this._disposed.emit(void 0),this.parent?this.parent=null:this.isAttached&&e.detach(this),this._layout&&(this._layout.dispose(),this._layout=null),this.title.dispose(),Di.clearData(this),mr.clearData(this),xl.clearData(this))},Object.defineProperty(e.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.testFlag(e.Flag.IsDisposed)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAttached",{get:function(){return this.testFlag(e.Flag.IsAttached)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHidden",{get:function(){return this.testFlag(e.Flag.IsHidden)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){return this.testFlag(e.Flag.IsVisible)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return qR.titleProperty.get(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.node.id},set:function(t){this.node.id=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataset",{get:function(){return this.node.dataset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hiddenMode",{get:function(){return this._hiddenMode},set:function(t){this._hiddenMode!==t&&(this.isHidden&&this._toggleHidden(!1),t==e.HiddenMode.Scale?this.node.style.willChange="transform":this.node.style.willChange="auto",this._hiddenMode=t,this.isHidden&&this._toggleHidden(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},set:function(t){if(this._parent!==t){if(t&&this.contains(t))throw new Error("Invalid parent widget.");if(this._parent&&!this._parent.isDisposed){var r=new e.ChildMessage("child-removed",this);mr.sendMessage(this._parent,r)}if(this._parent=t,this._parent&&!this._parent.isDisposed){var r=new e.ChildMessage("child-added",this);mr.sendMessage(this._parent,r)}this.isDisposed||mr.sendMessage(this,e.Msg.ParentChanged)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"layout",{get:function(){return this._layout},set:function(t){if(this._layout!==t){if(this.testFlag(e.Flag.DisallowLayout))throw new Error("Cannot set widget layout.");if(this._layout)throw new Error("Cannot change widget layout.");if(t.parent)throw new Error("Cannot change layout parent.");this._layout=t,t.parent=this}},enumerable:!0,configurable:!0}),e.prototype.children=function(){return this._layout?this._layout.iter():_u()},e.prototype.contains=function(t){for(var r=t;r;r=r._parent)if(r===this)return!0;return!1},e.prototype.hasClass=function(t){return this.node.classList.contains(t)},e.prototype.addClass=function(t){this.node.classList.add(t)},e.prototype.removeClass=function(t){this.node.classList.remove(t)},e.prototype.toggleClass=function(t,r){return r===!0?(this.node.classList.add(t),!0):r===!1?(this.node.classList.remove(t),!1):this.node.classList.toggle(t)},e.prototype.update=function(){mr.postMessage(this,e.Msg.UpdateRequest)},e.prototype.fit=function(){mr.postMessage(this,e.Msg.FitRequest)},e.prototype.activate=function(){mr.postMessage(this,e.Msg.ActivateRequest)},e.prototype.close=function(){mr.sendMessage(this,e.Msg.CloseRequest)},e.prototype.show=function(){if(this.testFlag(e.Flag.IsHidden)&&(this.isAttached&&(!this.parent||this.parent.isVisible)&&mr.sendMessage(this,e.Msg.BeforeShow),this.clearFlag(e.Flag.IsHidden),this.node.removeAttribute("aria-hidden"),this._toggleHidden(!1),this.isAttached&&(!this.parent||this.parent.isVisible)&&mr.sendMessage(this,e.Msg.AfterShow),this.parent)){var t=new e.ChildMessage("child-shown",this);mr.sendMessage(this.parent,t)}},e.prototype.hide=function(){if(!this.testFlag(e.Flag.IsHidden)&&(this.isAttached&&(!this.parent||this.parent.isVisible)&&mr.sendMessage(this,e.Msg.BeforeHide),this.setFlag(e.Flag.IsHidden),this.node.setAttribute("aria-hidden","true"),this._toggleHidden(!0),this.isAttached&&(!this.parent||this.parent.isVisible)&&mr.sendMessage(this,e.Msg.AfterHide),this.parent)){var t=new e.ChildMessage("child-hidden",this);mr.sendMessage(this.parent,t)}},e.prototype.setHidden=function(t){t?this.hide():this.show()},e.prototype.testFlag=function(t){return(this._flags&t)!==0},e.prototype.setFlag=function(t){this._flags|=t},e.prototype.clearFlag=function(t){this._flags&=~t},e.prototype.processMessage=function(t){switch(t.type){case"resize":this.notifyLayout(t),this.onResize(t);break;case"update-request":this.notifyLayout(t),this.onUpdateRequest(t);break;case"fit-request":this.notifyLayout(t),this.onFitRequest(t);break;case"before-show":this.notifyLayout(t),this.onBeforeShow(t);break;case"after-show":this.setFlag(e.Flag.IsVisible),this.notifyLayout(t),this.onAfterShow(t);break;case"before-hide":this.notifyLayout(t),this.onBeforeHide(t);break;case"after-hide":this.clearFlag(e.Flag.IsVisible),this.notifyLayout(t),this.onAfterHide(t);break;case"before-attach":this.notifyLayout(t),this.onBeforeAttach(t);break;case"after-attach":!this.isHidden&&(!this.parent||this.parent.isVisible)&&this.setFlag(e.Flag.IsVisible),this.setFlag(e.Flag.IsAttached),this.notifyLayout(t),this.onAfterAttach(t);break;case"before-detach":this.notifyLayout(t),this.onBeforeDetach(t);break;case"after-detach":this.clearFlag(e.Flag.IsVisible),this.clearFlag(e.Flag.IsAttached),this.notifyLayout(t),this.onAfterDetach(t);break;case"activate-request":this.notifyLayout(t),this.onActivateRequest(t);break;case"close-request":this.notifyLayout(t),this.onCloseRequest(t);break;case"child-added":this.notifyLayout(t),this.onChildAdded(t);break;case"child-removed":this.notifyLayout(t),this.onChildRemoved(t);break;default:this.notifyLayout(t);break}},e.prototype.notifyLayout=function(t){this._layout&&this._layout.processParentMessage(t)},e.prototype.onCloseRequest=function(t){this.parent?this.parent=null:this.isAttached&&e.detach(this)},e.prototype.onResize=function(t){},e.prototype.onUpdateRequest=function(t){},e.prototype.onFitRequest=function(t){},e.prototype.onActivateRequest=function(t){},e.prototype.onBeforeShow=function(t){},e.prototype.onAfterShow=function(t){},e.prototype.onBeforeHide=function(t){},e.prototype.onAfterHide=function(t){},e.prototype.onBeforeAttach=function(t){},e.prototype.onAfterAttach=function(t){},e.prototype.onBeforeDetach=function(t){},e.prototype.onAfterDetach=function(t){},e.prototype.onChildAdded=function(t){},e.prototype.onChildRemoved=function(t){},e.prototype._toggleHidden=function(t){if(t)switch(this._hiddenMode){case e.HiddenMode.Display:this.addClass("lm-mod-hidden"),this.addClass("p-mod-hidden");break;case e.HiddenMode.Scale:this.node.style.transform="scale(0)";break;case e.HiddenMode.ContentVisibility:this.node.style.contentVisibility="hidden",this.node.style.zIndex="-1";break}else switch(this._hiddenMode){case e.HiddenMode.Display:this.removeClass("lm-mod-hidden"),this.removeClass("p-mod-hidden");break;case e.HiddenMode.Scale:this.node.style.transform="";break;case e.HiddenMode.ContentVisibility:this.node.style.contentVisibility="",this.node.style.zIndex="";break}},e}();(function(e){(function(o){o[o.Display=0]="Display",o[o.Scale=1]="Scale",o[o.ContentVisibility=2]="ContentVisibility"})(e.HiddenMode||(e.HiddenMode={})),function(o){o[o.IsDisposed=1]="IsDisposed",o[o.IsAttached=2]="IsAttached",o[o.IsHidden=4]="IsHidden",o[o.IsVisible=8]="IsVisible",o[o.DisallowLayout=16]="DisallowLayout"}(e.Flag||(e.Flag={})),function(o){o.BeforeShow=new yu("before-show"),o.AfterShow=new yu("after-show"),o.BeforeHide=new yu("before-hide"),o.AfterHide=new yu("after-hide"),o.BeforeAttach=new yu("before-attach"),o.AfterAttach=new yu("after-attach"),o.BeforeDetach=new yu("before-detach"),o.AfterDetach=new yu("after-detach"),o.ParentChanged=new yu("parent-changed"),o.UpdateRequest=new xx("update-request"),o.FitRequest=new xx("fit-request"),o.ActivateRequest=new xx("activate-request"),o.CloseRequest=new xx("close-request")}(e.Msg||(e.Msg={}));var t=function(o){Ds(s,o);function s(c,l){var h=o.call(this,c)||this;return h.child=l,h}return s}(yu);e.ChildMessage=t;var r=function(o){Ds(s,o);function s(c,l){var h=o.call(this,"resize")||this;return h.width=c,h.height=l,h}return s}(yu);e.ResizeMessage=r,function(o){o.UnknownSize=new o(-1,-1)}(r=e.ResizeMessage||(e.ResizeMessage={}));function n(o,s,c){if(c===void 0&&(c=null),o.parent)throw new Error("Cannot attach a child widget.");if(o.isAttached||o.node.isConnected)throw new Error("Widget is already attached.");if(!s.isConnected)throw new Error("Host is not attached.");mr.sendMessage(o,e.Msg.BeforeAttach),s.insertBefore(o.node,c),mr.sendMessage(o,e.Msg.AfterAttach)}e.attach=n;function i(o){if(o.parent)throw new Error("Cannot detach a child widget.");if(!o.isAttached||!o.node.isConnected)throw new Error("Widget is not attached.");mr.sendMessage(o,e.Msg.BeforeDetach),o.node.parentNode.removeChild(o.node),mr.sendMessage(o,e.Msg.AfterDetach)}e.detach=i})(Mr||(Mr={}));var qR;(function(e){e.titleProperty=new xl({name:"title",create:function(r){return new w8({owner:r})}});function t(r){return r.node||document.createElement(r.tag||"div")}e.createNode=t})(qR||(qR={}));var AA=function(){function e(t){t===void 0&&(t={}),this._disposed=!1,this._parent=null,this._fitPolicy=t.fitPolicy||"set-min-size"}return e.prototype.dispose=function(){this._parent=null,this._disposed=!0,Di.clearData(this),xl.clearData(this)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},set:function(t){if(this._parent!==t){if(this._parent)throw new Error("Cannot change parent widget.");if(t.layout!==this)throw new Error("Invalid parent widget.");this._parent=t,this.init()}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fitPolicy",{get:function(){return this._fitPolicy},set:function(t){if(this._fitPolicy!==t&&(this._fitPolicy=t,this._parent)){var r=this._parent.node.style;r.minWidth="",r.minHeight="",r.maxWidth="",r.maxHeight="",this._parent.fit()}},enumerable:!0,configurable:!0}),e.prototype.processParentMessage=function(t){switch(t.type){case"resize":this.onResize(t);break;case"update-request":this.onUpdateRequest(t);break;case"fit-request":this.onFitRequest(t);break;case"before-show":this.onBeforeShow(t);break;case"after-show":this.onAfterShow(t);break;case"before-hide":this.onBeforeHide(t);break;case"after-hide":this.onAfterHide(t);break;case"before-attach":this.onBeforeAttach(t);break;case"after-attach":this.onAfterAttach(t);break;case"before-detach":this.onBeforeDetach(t);break;case"after-detach":this.onAfterDetach(t);break;case"child-removed":this.onChildRemoved(t);break;case"child-shown":this.onChildShown(t);break;case"child-hidden":this.onChildHidden(t);break}},e.prototype.init=function(){var t=this;yn(this,function(r){r.parent=t.parent})},e.prototype.onResize=function(t){yn(this,function(r){mr.sendMessage(r,Mr.ResizeMessage.UnknownSize)})},e.prototype.onUpdateRequest=function(t){yn(this,function(r){mr.sendMessage(r,Mr.ResizeMessage.UnknownSize)})},e.prototype.onBeforeAttach=function(t){yn(this,function(r){mr.sendMessage(r,t)})},e.prototype.onAfterAttach=function(t){yn(this,function(r){mr.sendMessage(r,t)})},e.prototype.onBeforeDetach=function(t){yn(this,function(r){mr.sendMessage(r,t)})},e.prototype.onAfterDetach=function(t){yn(this,function(r){mr.sendMessage(r,t)})},e.prototype.onBeforeShow=function(t){yn(this,function(r){r.isHidden||mr.sendMessage(r,t)})},e.prototype.onAfterShow=function(t){yn(this,function(r){r.isHidden||mr.sendMessage(r,t)})},e.prototype.onBeforeHide=function(t){yn(this,function(r){r.isHidden||mr.sendMessage(r,t)})},e.prototype.onAfterHide=function(t){yn(this,function(r){r.isHidden||mr.sendMessage(r,t)})},e.prototype.onChildRemoved=function(t){this.removeWidget(t.child)},e.prototype.onFitRequest=function(t){},e.prototype.onChildShown=function(t){},e.prototype.onChildHidden=function(t){},e}();(function(e){function t(o){return wx.horizontalAlignmentProperty.get(o)}e.getHorizontalAlignment=t;function r(o,s){wx.horizontalAlignmentProperty.set(o,s)}e.setHorizontalAlignment=r;function n(o){return wx.verticalAlignmentProperty.get(o)}e.getVerticalAlignment=n;function i(o,s){wx.verticalAlignmentProperty.set(o,s)}e.setVerticalAlignment=i})(AA||(AA={}));var DT=function(){function e(t){this._top=NaN,this._left=NaN,this._width=NaN,this._height=NaN,this._minWidth=0,this._minHeight=0,this._maxWidth=1/0,this._maxHeight=1/0,this._disposed=!1,this.widget=t,this.widget.node.style.position="absolute"}return e.prototype.dispose=function(){if(!this._disposed){this._disposed=!0;var t=this.widget.node.style;t.position="",t.top="",t.left="",t.width="",t.height=""}},Object.defineProperty(e.prototype,"minWidth",{get:function(){return this._minWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minHeight",{get:function(){return this._minHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxHeight",{get:function(){return this._maxHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHidden",{get:function(){return this.widget.isHidden},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){return this.widget.isVisible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAttached",{get:function(){return this.widget.isAttached},enumerable:!0,configurable:!0}),e.prototype.fit=function(){var t=co.sizeLimits(this.widget.node);this._minWidth=t.minWidth,this._minHeight=t.minHeight,this._maxWidth=t.maxWidth,this._maxHeight=t.maxHeight},e.prototype.update=function(t,r,n,i){var o=Math.max(this._minWidth,Math.min(n,this._maxWidth)),s=Math.max(this._minHeight,Math.min(i,this._maxHeight));if(o<n)switch(AA.getHorizontalAlignment(this.widget)){case"left":break;case"center":t+=(n-o)/2;break;case"right":t+=n-o;break;default:throw"unreachable"}if(s<i)switch(AA.getVerticalAlignment(this.widget)){case"top":break;case"center":r+=(i-s)/2;break;case"bottom":r+=i-s;break;default:throw"unreachable"}var c=!1,l=this.widget.node.style;if(this._top!==r&&(this._top=r,l.top=r+"px"),this._left!==t&&(this._left=t,l.left=t+"px"),this._width!==o&&(c=!0,this._width=o,l.width=o+"px"),this._height!==s&&(c=!0,this._height=s,l.height=s+"px"),c){var h=new Mr.ResizeMessage(o,s);mr.sendMessage(this.widget,h)}},e}(),wx;(function(e){e.horizontalAlignmentProperty=new xl({name:"horizontalAlignment",create:function(){return"center"},changed:t}),e.verticalAlignmentProperty=new xl({name:"verticalAlignment",create:function(){return"top"},changed:t});function t(r){r.parent&&r.parent.layout&&r.parent.update()}})(wx||(wx={}));var ZR=function(e){Ds(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r._widgets=[],r}return t.prototype.dispose=function(){for(;this._widgets.length>0;)this._widgets.pop().dispose();e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"widgets",{get:function(){return this._widgets},enumerable:!0,configurable:!0}),t.prototype.iter=function(){return gu(this._widgets)},t.prototype.addWidget=function(r){this.insertWidget(this._widgets.length,r)},t.prototype.insertWidget=function(r,n){n.parent=this.parent;var i=this._widgets.indexOf(n),o=Math.max(0,Math.min(r,this._widgets.length));if(i===-1){Ze.insert(this._widgets,o,n),this.parent&&this.attachWidget(o,n);return}o===this._widgets.length&&o--,i!==o&&(Ze.move(this._widgets,i,o),this.parent&&this.moveWidget(i,o,n))},t.prototype.removeWidget=function(r){this.removeWidgetAt(this._widgets.indexOf(r))},t.prototype.removeWidgetAt=function(r){var n=Ze.removeAt(this._widgets,r);n&&this.parent&&this.detachWidget(r,n)},t.prototype.init=function(){var r=this;e.prototype.init.call(this),yn(this,function(n,i){r.attachWidget(i,n)})},t.prototype.attachWidget=function(r,n){var i=this.parent.node.children[r];this.parent.isAttached&&mr.sendMessage(n,Mr.Msg.BeforeAttach),this.parent.node.insertBefore(n.node,i),this.parent.isAttached&&mr.sendMessage(n,Mr.Msg.AfterAttach)},t.prototype.moveWidget=function(r,n,i){this.parent.isAttached&&mr.sendMessage(i,Mr.Msg.BeforeDetach),this.parent.node.removeChild(i.node),this.parent.isAttached&&mr.sendMessage(i,Mr.Msg.AfterDetach);var o=this.parent.node.children[n];this.parent.isAttached&&mr.sendMessage(i,Mr.Msg.BeforeAttach),this.parent.node.insertBefore(i.node,o),this.parent.isAttached&&mr.sendMessage(i,Mr.Msg.AfterAttach)},t.prototype.detachWidget=function(r,n){this.parent.isAttached&&mr.sendMessage(n,Mr.Msg.BeforeDetach),this.parent.node.removeChild(n.node),this.parent.isAttached&&mr.sendMessage(n,Mr.Msg.AfterDetach)},t}(AA),LT;(function(e){function t(r){return Math.max(0,Math.floor(r))}e.clampDimension=t})(LT||(LT={}));var OT=LT,Bg=function(e){Ds(t,e);function t(r){var n=e.call(this)||this;return n.widgetOffset=0,n._fixed=0,n._spacing=4,n._dirty=!1,n._hasNormedSizes=!1,n._sizers=[],n._items=[],n._handles=[],n._box=null,n._alignment="start",n._orientation="horizontal",n.renderer=r.renderer,r.orientation!==void 0&&(n._orientation=r.orientation),r.alignment!==void 0&&(n._alignment=r.alignment),r.spacing!==void 0&&(n._spacing=LT.clampDimension(r.spacing)),n}return t.prototype.dispose=function(){yn(this._items,function(r){r.dispose()}),this._box=null,this._items.length=0,this._sizers.length=0,this._handles.length=0,e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"orientation",{get:function(){return this._orientation},set:function(r){this._orientation!==r&&(this._orientation=r,this.parent&&(this.parent.dataset.orientation=r,this.parent.fit()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alignment",{get:function(){return this._alignment},set:function(r){this._alignment!==r&&(this._alignment=r,this.parent&&(this.parent.dataset.alignment=r,this.parent.update()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spacing",{get:function(){return this._spacing},set:function(r){r=LT.clampDimension(r),this._spacing!==r&&(this._spacing=r,this.parent&&this.parent.fit())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"handles",{get:function(){return this._handles},enumerable:!0,configurable:!0}),t.prototype.absoluteSizes=function(){return this._sizers.map(function(r){return r.size})},t.prototype.relativeSizes=function(){return Pd.normalize(this._sizers.map(function(r){return r.size}))},t.prototype.setRelativeSizes=function(r,n){n===void 0&&(n=!0);for(var i=this._sizers.length,o=r.slice(0,i);o.length<i;)o.push(0);for(var s=Pd.normalize(o),c=0;c<i;++c){var l=this._sizers[c];l.sizeHint=s[c],l.size=s[c]}this._hasNormedSizes=!0,n&&this.parent&&this.parent.update()},t.prototype.moveHandle=function(r,n){var i=this._handles[r];if(!(!i||i.classList.contains("lm-mod-hidden"))){var o;if(this._orientation==="horizontal"?o=n-i.offsetLeft:o=n-i.offsetTop,o!==0){for(var s=0,c=this._sizers;s<c.length;s++){var l=c[s];l.size>0&&(l.sizeHint=l.size)}xu.adjust(this._sizers,r,o),this.parent&&this.parent.update()}}},t.prototype.init=function(){this.parent.dataset.orientation=this.orientation,this.parent.dataset.alignment=this.alignment,e.prototype.init.call(this)},t.prototype.attachWidget=function(r,n){var i=new DT(n),o=Pd.createHandle(this.renderer),s=Pd.averageSize(this._sizers),c=Pd.createSizer(s);Ze.insert(this._items,r,i),Ze.insert(this._sizers,r,c),Ze.insert(this._handles,r,o),this.parent.isAttached&&mr.sendMessage(n,Mr.Msg.BeforeAttach),this.parent.node.appendChild(n.node),this.parent.node.appendChild(o),this.parent.isAttached&&mr.sendMessage(n,Mr.Msg.AfterAttach),this.parent.fit()},t.prototype.moveWidget=function(r,n,i){Ze.move(this._items,r,n),Ze.move(this._sizers,r,n),Ze.move(this._handles,r,n),this.parent.fit()},t.prototype.detachWidget=function(r,n){var i=Ze.removeAt(this._items,r),o=Ze.removeAt(this._handles,r);Ze.removeAt(this._sizers,r),this.parent.isAttached&&mr.sendMessage(n,Mr.Msg.BeforeDetach),this.parent.node.removeChild(n.node),this.parent.node.removeChild(o),this.parent.isAttached&&mr.sendMessage(n,Mr.Msg.AfterDetach),i.dispose(),this.parent.fit()},t.prototype.onBeforeShow=function(r){e.prototype.onBeforeShow.call(this,r),this.parent.update()},t.prototype.onBeforeAttach=function(r){e.prototype.onBeforeAttach.call(this,r),this.parent.fit()},t.prototype.onChildShown=function(r){this.parent.fit()},t.prototype.onChildHidden=function(r){this.parent.fit()},t.prototype.onResize=function(r){this.parent.isVisible&&this._update(r.width,r.height)},t.prototype.onUpdateRequest=function(r){this.parent.isVisible&&this._update(-1,-1)},t.prototype.onFitRequest=function(r){this.parent.isAttached&&this._fit()},t.prototype.updateItemPosition=function(r,n,i,o,s,c,l){var h=this._items[r];if(!h.isHidden){var p=this._handles[r].style;n?(i+=this.widgetOffset,h.update(i,o,l,s),i+=l,p.top=o+"px",p.left=i+"px",p.width=this._spacing+"px",p.height=s+"px"):(o+=this.widgetOffset,h.update(i,o,c,l),o+=l,p.top=o+"px",p.left=i+"px",p.width=c+"px",p.height=this._spacing+"px")}},t.prototype._fit=function(){for(var r=0,n=-1,i=0,o=this._items.length;i<o;++i)this._items[i].isHidden?(this._handles[i].classList.add("lm-mod-hidden"),this._handles[i].classList.add("p-mod-hidden")):(this._handles[i].classList.remove("lm-mod-hidden"),this._handles[i].classList.remove("p-mod-hidden"),n=i,r++);n!==-1&&(this._handles[n].classList.add("lm-mod-hidden"),this._handles[n].classList.add("p-mod-hidden")),this._fixed=this._spacing*Math.max(0,r-1)+this.widgetOffset*this._items.length;for(var s=this._orientation==="horizontal",c=s?this._fixed:0,l=s?0:this._fixed,i=0,o=this._items.length;i<o;++i){var h=this._items[i],p=this._sizers[i];if(p.size>0&&(p.sizeHint=p.size),h.isHidden){p.minSize=0,p.maxSize=0;continue}h.fit(),p.stretch=t.getStretch(h.widget),s?(p.minSize=h.minWidth,p.maxSize=h.maxWidth,c+=h.minWidth,l=Math.max(l,h.minHeight)):(p.minSize=h.minHeight,p.maxSize=h.maxHeight,l+=h.minHeight,c=Math.max(c,h.minWidth))}var x=this._box=co.boxSizing(this.parent.node);c+=x.horizontalSum,l+=x.verticalSum;var w=this.parent.node.style;w.minWidth=c+"px",w.minHeight=l+"px",this._dirty=!0,this.parent.parent&&mr.sendMessage(this.parent.parent,Mr.Msg.FitRequest),this._dirty&&mr.sendMessage(this.parent,Mr.Msg.UpdateRequest)},t.prototype._update=function(r,n){this._dirty=!1;for(var i=0,o=0,s=this._items.length;o<s;++o)i+=+!this._items[o].isHidden;if(!(i===0&&this.widgetOffset===0)){r<0&&(r=this.parent.node.offsetWidth),n<0&&(n=this.parent.node.offsetHeight),this._box||(this._box=co.boxSizing(this.parent.node));var c=this._box.paddingTop,l=this._box.paddingLeft,h=r-this._box.horizontalSum,p=n-this._box.verticalSum,x=0,w=0,E=this._orientation==="horizontal";if(i>0){var P=void 0;if(E?P=Math.max(0,h-this._fixed):P=Math.max(0,p-this._fixed),this._hasNormedSizes){for(var B=0,D=this._sizers;B<D.length;B++){var W=D[B];W.sizeHint*=P}this._hasNormedSizes=!1}var X=xu.calc(this._sizers,P);if(X>0)switch(this._alignment){case"start":break;case"center":x=0,w=X/2;break;case"end":x=0,w=X;break;case"justify":x=X/i,w=0;break;default:throw"unreachable"}}for(var o=0,s=this._items.length;o<s;++o){var q=this._items[o],$=q.isHidden?0:this._sizers[o].size+x;this.updateItemPosition(o,E,E?l+w:l,E?c:c+w,p,h,$);var et=this.widgetOffset+(this._handles[o].classList.contains("lm-mod-hidden")?0:this._spacing);E?l+=$+et:c+=$+et}}},t}(ZR);(function(e){function t(n){return Pd.stretchProperty.get(n)}e.getStretch=t;function r(n,i){Pd.stretchProperty.set(n,i)}e.setStretch=r})(Bg||(Bg={}));var Pd;(function(e){e.stretchProperty=new xl({name:"stretch",create:function(){return 0},coerce:function(s,c){return Math.max(0,Math.floor(c))},changed:o});function t(s){var c=new mA;return c.sizeHint=Math.floor(s),c}e.createSizer=t;function r(s){var c=s.createHandle();return c.style.position="absolute",c}e.createHandle=r;function n(s){return s.reduce(function(c,l){return c+l.size},0)/s.length||0}e.averageSize=n;function i(s){var c=s.length;if(c===0)return[];var l=s.reduce(function(h,p){return h+Math.abs(p)},0);return l===0?s.map(function(h){return 1/c}):s.map(function(h){return h/l})}e.normalize=i;function o(s){s.parent&&s.parent.layout instanceof Bg&&s.parent.fit()}})(Pd||(Pd={}));var Nzt=function(e){Ds(t,e);function t(r){var n=e.call(this,uc(uc({},r),{orientation:r.orientation||"vertical"}))||this;return n._titles=[],n.titleSpace=r.titleSpace||22,n}return Object.defineProperty(t.prototype,"titleSpace",{get:function(){return this.widgetOffset},set:function(r){r=OT.clampDimension(r),this.widgetOffset!==r&&(this.widgetOffset=r,this.parent&&this.parent.fit())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"titles",{get:function(){return this._titles},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.isDisposed||(this._titles.length=0,e.prototype.dispose.call(this))},t.prototype.updateTitle=function(r,n){var i=this._titles[r],o=i.classList.contains("lm-mod-expanded"),s=GR.createTitle(this.renderer,n.title,o);this._titles[r]=s,this.parent.node.replaceChild(s,i)},t.prototype.attachWidget=function(r,n){var i=GR.createTitle(this.renderer,n.title);Ze.insert(this._titles,r,i),this.parent.node.appendChild(i),n.node.setAttribute("role","region"),n.node.setAttribute("aria-labelledby",i.id),e.prototype.attachWidget.call(this,r,n)},t.prototype.moveWidget=function(r,n,i){Ze.move(this._titles,r,n),e.prototype.moveWidget.call(this,r,n,i)},t.prototype.detachWidget=function(r,n){var i=Ze.removeAt(this._titles,r);this.parent.node.removeChild(i),e.prototype.detachWidget.call(this,r,n)},t.prototype.updateItemPosition=function(r,n,i,o,s,c,l){var h=this._titles[r].style;h.top=o+"px",h.left=i+"px",h.height=this.widgetOffset+"px",n?h.width=s+"px":h.width=c+"px",e.prototype.updateItemPosition.call(this,r,n,i,o,s,c,l)},t}(Bg),GR;(function(e){function t(r,n,i){i===void 0&&(i=!0);var o=r.createSectionTitle(n);return o.style.position="absolute",o.setAttribute("aria-label",n.label+" Section"),o.setAttribute("aria-expanded",i?"true":"false"),o.setAttribute("aria-controls",n.owner.id),i&&o.classList.add("lm-mod-expanded"),o}e.createTitle=t})(GR||(GR={}));var NT=function(e){Ds(t,e);function t(r){r===void 0&&(r={});var n=e.call(this)||this;return n.addClass("lm-Panel"),n.addClass("p-Panel"),n.layout=T8.createLayout(r),n}return Object.defineProperty(t.prototype,"widgets",{get:function(){return this.layout.widgets},enumerable:!0,configurable:!0}),t.prototype.addWidget=function(r){this.layout.addWidget(r)},t.prototype.insertWidget=function(r,n){this.layout.insertWidget(r,n)},t}(Mr),T8;(function(e){function t(r){return r.layout||new ZR}e.createLayout=t})(T8||(T8={}));var BT=function(e){Ds(t,e);function t(r){r===void 0&&(r={});var n=e.call(this,{layout:E8.createLayout(r)})||this;return n._handleMoved=new Di(n),n._pressData=null,n.addClass("lm-SplitPanel"),n.addClass("p-SplitPanel"),n}return t.prototype.dispose=function(){this._releaseMouse(),e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"orientation",{get:function(){return this.layout.orientation},set:function(r){this.layout.orientation=r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alignment",{get:function(){return this.layout.alignment},set:function(r){this.layout.alignment=r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spacing",{get:function(){return this.layout.spacing},set:function(r){this.layout.spacing=r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{get:function(){return this.layout.renderer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"handleMoved",{get:function(){return this._handleMoved},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"handles",{get:function(){return this.layout.handles},enumerable:!0,configurable:!0}),t.prototype.relativeSizes=function(){return this.layout.relativeSizes()},t.prototype.setRelativeSizes=function(r,n){n===void 0&&(n=!0),this.layout.setRelativeSizes(r,n)},t.prototype.handleEvent=function(r){switch(r.type){case"mousedown":this._evtMouseDown(r);break;case"mousemove":this._evtMouseMove(r);break;case"mouseup":this._evtMouseUp(r);break;case"pointerdown":this._evtMouseDown(r);break;case"pointermove":this._evtMouseMove(r);break;case"pointerup":this._evtMouseUp(r);break;case"keydown":this._evtKeyDown(r);break;case"contextmenu":r.preventDefault(),r.stopPropagation();break}},t.prototype.onBeforeAttach=function(r){this.node.addEventListener("mousedown",this),this.node.addEventListener("pointerdown",this)},t.prototype.onAfterDetach=function(r){this.node.removeEventListener("mousedown",this),this.node.removeEventListener("pointerdown",this),this._releaseMouse()},t.prototype.onChildAdded=function(r){r.child.addClass("lm-SplitPanel-child"),r.child.addClass("p-SplitPanel-child"),this._releaseMouse()},t.prototype.onChildRemoved=function(r){r.child.removeClass("lm-SplitPanel-child"),r.child.removeClass("p-SplitPanel-child"),this._releaseMouse()},t.prototype._evtKeyDown=function(r){this._pressData&&(r.preventDefault(),r.stopPropagation()),r.keyCode===27&&this._releaseMouse()},t.prototype._evtMouseDown=function(r){if(r.button===0){var n=this.layout,i=Ze.findFirstIndex(n.handles,function(p){return p.contains(r.target)});if(i!==-1){r.preventDefault(),r.stopPropagation(),document.addEventListener("mouseup",this,!0),document.addEventListener("mousemove",this,!0),document.addEventListener("pointerup",this,!0),document.addEventListener("pointermove",this,!0),document.addEventListener("keydown",this,!0),document.addEventListener("contextmenu",this,!0);var o,s=n.handles[i],c=s.getBoundingClientRect();n.orientation==="horizontal"?o=r.clientX-c.left:o=r.clientY-c.top;var l=window.getComputedStyle(s),h=pA.overrideCursor(l.cursor);this._pressData={index:i,delta:o,override:h}}}},t.prototype._evtMouseMove=function(r){r.preventDefault(),r.stopPropagation();var n,i=this.layout,o=this.node.getBoundingClientRect();i.orientation==="horizontal"?n=r.clientX-o.left-this._pressData.delta:n=r.clientY-o.top-this._pressData.delta,i.moveHandle(this._pressData.index,n)},t.prototype._evtMouseUp=function(r){r.button===0&&(r.preventDefault(),r.stopPropagation(),this._releaseMouse())},t.prototype._releaseMouse=function(){this._pressData&&(this._pressData.override.dispose(),this._pressData=null,this._handleMoved.emit(),document.removeEventListener("mouseup",this,!0),document.removeEventListener("mousemove",this,!0),document.removeEventListener("keydown",this,!0),document.removeEventListener("pointerup",this,!0),document.removeEventListener("pointermove",this,!0),document.removeEventListener("contextmenu",this,!0))},t}(NT);(function(e){var t=function(){function i(){}return i.prototype.createHandle=function(){var o=document.createElement("div");return o.className="lm-SplitPanel-handle",o.classList.add("p-SplitPanel-handle"),o},i}();e.Renderer=t,e.defaultRenderer=new t;function r(i){return Bg.getStretch(i)}e.getStretch=r;function n(i,o){Bg.setStretch(i,o)}e.setStretch=n})(BT||(BT={}));var E8;(function(e){function t(r){return r.layout||new Bg({renderer:r.renderer||BT.defaultRenderer,orientation:r.orientation,alignment:r.alignment,spacing:r.spacing})}e.createLayout=t})(E8||(E8={}));var M8=function(e){Ds(t,e);function t(r){r===void 0&&(r={});var n=e.call(this,uc(uc({},r),{layout:S8.createLayout(r)}))||this;return n._widgetSizesCache=new WeakMap,n.addClass("lm-AccordionPanel"),n}return Object.defineProperty(t.prototype,"renderer",{get:function(){return this.layout.renderer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"titleSpace",{get:function(){return this.layout.titleSpace},set:function(r){this.layout.titleSpace=r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"titles",{get:function(){return this.layout.titles},enumerable:!0,configurable:!0}),t.prototype.addWidget=function(r){e.prototype.addWidget.call(this,r),r.title.changed.connect(this._onTitleChanged,this)},t.prototype.collapse=function(r){var n=this.layout.widgets[r];n&&!n.isHidden&&this._toggleExpansion(r)},t.prototype.expand=function(r){var n=this.layout.widgets[r];n&&n.isHidden&&this._toggleExpansion(r)},t.prototype.insertWidget=function(r,n){e.prototype.insertWidget.call(this,r,n),n.title.changed.connect(this._onTitleChanged,this)},t.prototype.handleEvent=function(r){switch(e.prototype.handleEvent.call(this,r),r.type){case"click":this._evtClick(r);break;case"keydown":this._eventKeyDown(r);break}},t.prototype.onBeforeAttach=function(r){this.node.addEventListener("click",this),this.node.addEventListener("keydown",this),e.prototype.onBeforeAttach.call(this,r)},t.prototype.onAfterDetach=function(r){e.prototype.onAfterDetach.call(this,r),this.node.removeEventListener("click",this),this.node.removeEventListener("keydown",this)},t.prototype._onTitleChanged=function(r){var n=Ze.findFirstIndex(this.widgets,function(i){return i.contains(r.owner)});n>=0&&(this.layout.updateTitle(n,r.owner),this.update())},t.prototype._computeWidgetSize=function(r){var n=this.layout,i=n.widgets[r];if(i){var o=i.isHidden,s=n.absoluteSizes(),c=(o?-1:1)*this.spacing,l=s.reduce(function(E,P){return E+P}),h=Dzt(s);if(o){var w=this._widgetSizesCache.get(i);if(!w)return;h[r]+=w;var x=h.map(function(P){return P-w>0}).lastIndexOf(!0);x===-1?h.forEach(function(P,B){B!==r&&(h[B]-=s[B]/l*(w-c))}):h[x]-=w-c}else{var p=s[r];this._widgetSizesCache.set(i,p),h[r]=0;var x=h.map(function(E){return E>0}).lastIndexOf(!0);if(x===-1)return;h[x]=s[x]+p+c}return h.map(function(E){return E/(l+c)})}},t.prototype._evtClick=function(r){var n=r.target;if(n){var i=Ze.findFirstIndex(this.titles,function(o){return o.contains(n)});i>=0&&(r.preventDefault(),r.stopPropagation(),this._toggleExpansion(i))}},t.prototype._eventKeyDown=function(r){if(!r.defaultPrevented){var n=r.target,i=!1;if(n){var o=Ze.findFirstIndex(this.titles,function(p){return p.contains(n)});if(o>=0){var s=r.keyCode.toString();if(r.key.match(/Space|Enter/)||s.match(/13|32/))n.click(),i=!0;else if(this.orientation==="horizontal"?r.key.match(/ArrowLeft|ArrowRight/)||s.match(/37|39/):r.key.match(/ArrowUp|ArrowDown/)||s.match(/38|40/)){var c=r.key.match(/ArrowLeft|ArrowUp/)||s.match(/37|38/)?-1:1,l=this.titles.length,h=(o+l+c)%l;this.titles[h].focus(),i=!0}else r.key==="End"||s==="35"?(this.titles[this.titles.length-1].focus(),i=!0):(r.key==="Home"||s==="36")&&(this.titles[0].focus(),i=!0)}i&&r.preventDefault()}}},t.prototype._toggleExpansion=function(r){var n=this.titles[r],i=this.layout.widgets[r],o=this._computeWidgetSize(r);o&&this.setRelativeSizes(o,!1),i.isHidden?(n.classList.add("lm-mod-expanded"),n.setAttribute("aria-expanded","true"),i.show()):(n.classList.remove("lm-mod-expanded"),n.setAttribute("aria-expanded","false"),i.hide())},t}(BT);(function(e){var t=function(r){Ds(n,r);function n(){var i=r.call(this)||this;return i.titleClassName="lm-AccordionPanel-title",i._titleID=0,i._titleKeys=new WeakMap,i._uuid=++n._nInstance,i}return n.prototype.createCollapseIcon=function(i){return document.createElement("span")},n.prototype.createSectionTitle=function(i){var o=document.createElement("h3");o.setAttribute("role","button"),o.setAttribute("tabindex","0"),o.id=this.createTitleKey(i),o.className=this.titleClassName;for(var s in i.dataset)o.dataset[s]=i.dataset[s];var c=o.appendChild(this.createCollapseIcon(i));c.className="lm-AccordionPanel-titleCollapser";var l=o.appendChild(document.createElement("span"));return l.className="lm-AccordionPanel-titleLabel",l.textContent=i.label,l.title=i.caption||i.label,o},n.prototype.createTitleKey=function(i){var o=this._titleKeys.get(i);return o===void 0&&(o="title-key-"+this._uuid+"-"+this._titleID++,this._titleKeys.set(i,o)),o},n._nInstance=0,n}(BT.Renderer);e.Renderer=t,e.defaultRenderer=new t})(M8||(M8={}));var S8;(function(e){function t(r){return r.layout||new Nzt({renderer:r.renderer||M8.defaultRenderer,orientation:r.orientation,alignment:r.alignment,spacing:r.spacing,titleSpace:r.titleSpace})}e.createLayout=t})(S8||(S8={}));var Jh=function(e){Ds(t,e);function t(r){r===void 0&&(r={});var n=e.call(this)||this;return n._fixed=0,n._spacing=4,n._dirty=!1,n._sizers=[],n._items=[],n._box=null,n._alignment="start",n._direction="top-to-bottom",r.direction!==void 0&&(n._direction=r.direction),r.alignment!==void 0&&(n._alignment=r.alignment),r.spacing!==void 0&&(n._spacing=OT.clampDimension(r.spacing)),n}return t.prototype.dispose=function(){yn(this._items,function(r){r.dispose()}),this._box=null,this._items.length=0,this._sizers.length=0,e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"direction",{get:function(){return this._direction},set:function(r){this._direction!==r&&(this._direction=r,this.parent&&(this.parent.dataset.direction=r,this.parent.fit()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alignment",{get:function(){return this._alignment},set:function(r){this._alignment!==r&&(this._alignment=r,this.parent&&(this.parent.dataset.alignment=r,this.parent.update()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spacing",{get:function(){return this._spacing},set:function(r){r=OT.clampDimension(r),this._spacing!==r&&(this._spacing=r,this.parent&&this.parent.fit())},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.parent.dataset.direction=this.direction,this.parent.dataset.alignment=this.alignment,e.prototype.init.call(this)},t.prototype.attachWidget=function(r,n){Ze.insert(this._items,r,new DT(n)),Ze.insert(this._sizers,r,new mA),this.parent.isAttached&&mr.sendMessage(n,Mr.Msg.BeforeAttach),this.parent.node.appendChild(n.node),this.parent.isAttached&&mr.sendMessage(n,Mr.Msg.AfterAttach),this.parent.fit()},t.prototype.moveWidget=function(r,n,i){Ze.move(this._items,r,n),Ze.move(this._sizers,r,n),this.parent.update()},t.prototype.detachWidget=function(r,n){var i=Ze.removeAt(this._items,r);Ze.removeAt(this._sizers,r),this.parent.isAttached&&mr.sendMessage(n,Mr.Msg.BeforeDetach),this.parent.node.removeChild(n.node),this.parent.isAttached&&mr.sendMessage(n,Mr.Msg.AfterDetach),i.dispose(),this.parent.fit()},t.prototype.onBeforeShow=function(r){e.prototype.onBeforeShow.call(this,r),this.parent.update()},t.prototype.onBeforeAttach=function(r){e.prototype.onBeforeAttach.call(this,r),this.parent.fit()},t.prototype.onChildShown=function(r){this.parent.fit()},t.prototype.onChildHidden=function(r){this.parent.fit()},t.prototype.onResize=function(r){this.parent.isVisible&&this._update(r.width,r.height)},t.prototype.onUpdateRequest=function(r){this.parent.isVisible&&this._update(-1,-1)},t.prototype.onFitRequest=function(r){this.parent.isAttached&&this._fit()},t.prototype._fit=function(){for(var r=0,n=0,i=this._items.length;n<i;++n)r+=+!this._items[n].isHidden;this._fixed=this._spacing*Math.max(0,r-1);for(var o=Lg.isHorizontal(this._direction),s=o?this._fixed:0,c=o?0:this._fixed,n=0,i=this._items.length;n<i;++n){var l=this._items[n],h=this._sizers[n];if(l.isHidden){h.minSize=0,h.maxSize=0;continue}l.fit(),h.sizeHint=t.getSizeBasis(l.widget),h.stretch=t.getStretch(l.widget),o?(h.minSize=l.minWidth,h.maxSize=l.maxWidth,s+=l.minWidth,c=Math.max(c,l.minHeight)):(h.minSize=l.minHeight,h.maxSize=l.maxHeight,c+=l.minHeight,s=Math.max(s,l.minWidth))}var p=this._box=co.boxSizing(this.parent.node);s+=p.horizontalSum,c+=p.verticalSum;var x=this.parent.node.style;x.minWidth=s+"px",x.minHeight=c+"px",this._dirty=!0,this.parent.parent&&mr.sendMessage(this.parent.parent,Mr.Msg.FitRequest),this._dirty&&mr.sendMessage(this.parent,Mr.Msg.UpdateRequest)},t.prototype._update=function(r,n){this._dirty=!1;for(var i=0,o=0,s=this._items.length;o<s;++o)i+=+!this._items[o].isHidden;if(i!==0){r<0&&(r=this.parent.node.offsetWidth),n<0&&(n=this.parent.node.offsetHeight),this._box||(this._box=co.boxSizing(this.parent.node));var c=this._box.paddingTop,l=this._box.paddingLeft,h=r-this._box.horizontalSum,p=n-this._box.verticalSum,x;switch(this._direction){case"left-to-right":x=xu.calc(this._sizers,Math.max(0,h-this._fixed));break;case"top-to-bottom":x=xu.calc(this._sizers,Math.max(0,p-this._fixed));break;case"right-to-left":x=xu.calc(this._sizers,Math.max(0,h-this._fixed)),l+=h;break;case"bottom-to-top":x=xu.calc(this._sizers,Math.max(0,p-this._fixed)),c+=p;break;default:throw"unreachable"}var w=0,E=0;if(x>0)switch(this._alignment){case"start":break;case"center":w=0,E=x/2;break;case"end":w=0,E=x;break;case"justify":w=x/i,E=0;break;default:throw"unreachable"}for(var o=0,s=this._items.length;o<s;++o){var P=this._items[o];if(!P.isHidden){var B=this._sizers[o].size;switch(this._direction){case"left-to-right":P.update(l+E,c,B+w,p),l+=B+w+this._spacing;break;case"top-to-bottom":P.update(l,c+E,h,B+w),c+=B+w+this._spacing;break;case"right-to-left":P.update(l-E-B-w,c,B+w,p),l-=B+w+this._spacing;break;case"bottom-to-top":P.update(l,c-E-B-w,h,B+w),c-=B+w+this._spacing;break;default:throw"unreachable"}}}}},t}(ZR);(function(e){function t(o){return Lg.stretchProperty.get(o)}e.getStretch=t;function r(o,s){Lg.stretchProperty.set(o,s)}e.setStretch=r;function n(o){return Lg.sizeBasisProperty.get(o)}e.getSizeBasis=n;function i(o,s){Lg.sizeBasisProperty.set(o,s)}e.setSizeBasis=i})(Jh||(Jh={}));var Lg;(function(e){e.stretchProperty=new xl({name:"stretch",create:function(){return 0},coerce:function(i,o){return Math.max(0,Math.floor(o))},changed:n}),e.sizeBasisProperty=new xl({name:"sizeBasis",create:function(){return 0},coerce:function(i,o){return Math.max(0,Math.floor(o))},changed:n});function t(i){return i==="left-to-right"||i==="right-to-left"}e.isHorizontal=t;function r(i){return Math.max(0,Math.floor(i))}e.clampSpacing=r;function n(i){i.parent&&i.parent.layout instanceof Jh&&i.parent.fit()}})(Lg||(Lg={}));var lht=function(e){Ds(t,e);function t(r){r===void 0&&(r={});var n=e.call(this,{layout:C8.createLayout(r)})||this;return n.addClass("lm-BoxPanel"),n.addClass("p-BoxPanel"),n}return Object.defineProperty(t.prototype,"direction",{get:function(){return this.layout.direction},set:function(r){this.layout.direction=r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alignment",{get:function(){return this.layout.alignment},set:function(r){this.layout.alignment=r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spacing",{get:function(){return this.layout.spacing},set:function(r){this.layout.spacing=r},enumerable:!0,configurable:!0}),t.prototype.onChildAdded=function(r){r.child.addClass("lm-BoxPanel-child"),r.child.addClass("p-BoxPanel-child")},t.prototype.onChildRemoved=function(r){r.child.removeClass("lm-BoxPanel-child"),r.child.removeClass("p-BoxPanel-child")},t}(NT);(function(e){function t(o){return Jh.getStretch(o)}e.getStretch=t;function r(o,s){Jh.setStretch(o,s)}e.setStretch=r;function n(o){return Jh.getSizeBasis(o)}e.getSizeBasis=n;function i(o,s){Jh.setSizeBasis(o,s)}e.setSizeBasis=i})(lht||(lht={}));var C8;(function(e){function t(r){return r.layout||new Jh(r)}e.createLayout=t})(C8||(C8={}));var uht=function(e){Ds(t,e);function t(r){var n=e.call(this,{node:Cd.createNode()})||this;return n._activeIndex=-1,n._items=[],n._results=null,n.addClass("lm-CommandPalette"),n.addClass("p-CommandPalette"),n.setFlag(Mr.Flag.DisallowLayout),n.commands=r.commands,n.renderer=r.renderer||t.defaultRenderer,n.commands.commandChanged.connect(n._onGenericChange,n),n.commands.keyBindingChanged.connect(n._onGenericChange,n),n}return t.prototype.dispose=function(){this._items.length=0,this._results=null,e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"searchNode",{get:function(){return this.node.getElementsByClassName("lm-CommandPalette-search")[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputNode",{get:function(){return this.node.getElementsByClassName("lm-CommandPalette-input")[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentNode",{get:function(){return this.node.getElementsByClassName("lm-CommandPalette-content")[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return this._items},enumerable:!0,configurable:!0}),t.prototype.addItem=function(r){var n=Cd.createItem(this.commands,r);return this._items.push(n),this.refresh(),n},t.prototype.addItems=function(r){var n=this,i=r.map(function(o){return Cd.createItem(n.commands,o)});return i.forEach(function(o){return n._items.push(o)}),this.refresh(),i},t.prototype.removeItem=function(r){this.removeItemAt(this._items.indexOf(r))},t.prototype.removeItemAt=function(r){var n=Ze.removeAt(this._items,r);n&&this.refresh()},t.prototype.clearItems=function(){this._items.length!==0&&(this._items.length=0,this.refresh())},t.prototype.refresh=function(){if(this._results=null,this.inputNode.value!==""){var r=this.node.getElementsByClassName("lm-close-icon")[0];r.style.display="inherit"}else{var r=this.node.getElementsByClassName("lm-close-icon")[0];r.style.display="none"}this.update()},t.prototype.handleEvent=function(r){switch(r.type){case"click":this._evtClick(r);break;case"keydown":this._evtKeyDown(r);break;case"input":this.refresh();break;case"focus":case"blur":this._toggleFocused();break}},t.prototype.onBeforeAttach=function(r){this.node.addEventListener("click",this),this.node.addEventListener("keydown",this),this.node.addEventListener("input",this),this.node.addEventListener("focus",this,!0),this.node.addEventListener("blur",this,!0)},t.prototype.onAfterDetach=function(r){this.node.removeEventListener("click",this),this.node.removeEventListener("keydown",this),this.node.removeEventListener("input",this),this.node.removeEventListener("focus",this,!0),this.node.removeEventListener("blur",this,!0)},t.prototype.onActivateRequest=function(r){if(this.isAttached){var n=this.inputNode;n.focus(),n.select()}},t.prototype.onUpdateRequest=function(r){var n=this.inputNode.value,i=this.contentNode,o=this._results;if(o||(o=this._results=Cd.search(this._items,n),this._activeIndex=n?Ze.findFirstIndex(o,Cd.canActivate):-1),!n&&o.length===0){Sd.render(null,i);return}if(n&&o.length===0){var s=this.renderer.renderEmptyMessage({query:n});Sd.render(s,i);return}for(var c=this.renderer,l=this._activeIndex,h=new Array(o.length),p=0,x=o.length;p<x;++p){var w=o[p];if(w.type==="header"){var E=w.indices,P=w.category;h[p]=c.renderHeader({category:P,indices:E})}else{var B=w.item,E=w.indices,D=p===l;h[p]=c.renderItem({item:B,indices:E,active:D})}}if(Sd.render(h,i),l<0||l>=o.length)i.scrollTop=0;else{var W=i.children[l];co.scrollIntoViewIfNeeded(i,W)}},t.prototype._evtClick=function(r){if(r.button===0){if(r.target.classList.contains("lm-close-icon")){this.inputNode.value="",this.refresh();return}var n=Ze.findFirstIndex(this.contentNode.children,function(i){return i.contains(r.target)});n!==-1&&(r.preventDefault(),r.stopPropagation(),this._execute(n))}},t.prototype._evtKeyDown=function(r){if(!(r.altKey||r.ctrlKey||r.metaKey||r.shiftKey))switch(r.keyCode){case 13:r.preventDefault(),r.stopPropagation(),this._execute(this._activeIndex);break;case 38:r.preventDefault(),r.stopPropagation(),this._activatePreviousItem();break;case 40:r.preventDefault(),r.stopPropagation(),this._activateNextItem();break}},t.prototype._activateNextItem=function(){if(!(!this._results||this._results.length===0)){var r=this._activeIndex,n=this._results.length,i=r<n-1?r+1:0,o=i===0?n-1:i-1;this._activeIndex=Ze.findFirstIndex(this._results,Cd.canActivate,i,o),this.update()}},t.prototype._activatePreviousItem=function(){if(!(!this._results||this._results.length===0)){var r=this._activeIndex,n=this._results.length,i=r<=0?n-1:r-1,o=i===n-1?0:i+1;this._activeIndex=Ze.findLastIndex(this._results,Cd.canActivate,i,o),this.update()}},t.prototype._execute=function(r){if(this._results){var n=this._results[r];if(n){if(n.type==="header"){var i=this.inputNode;i.value=n.category.toLowerCase()+" ",i.focus(),this.refresh();return}n.item.isEnabled&&(this.commands.execute(n.item.command,n.item.args),this.inputNode.value="",this.refresh())}}},t.prototype._toggleFocused=function(){var r=document.activeElement===this.inputNode;this.toggleClass("lm-mod-focused",r),this.toggleClass("p-mod-focused",r)},t.prototype._onGenericChange=function(){this.refresh()},t}(Mr);(function(e){var t=function(){function r(){}return r.prototype.renderHeader=function(n){var i=this.formatHeader(n);return Ji.li({className:"lm-CommandPalette-header p-CommandPalette-header"},i)},r.prototype.renderItem=function(n){var i=this.createItemClass(n),o=this.createItemDataset(n);return n.item.isToggleable?Ji.li({className:i,dataset:o,role:"checkbox","aria-checked":""+n.item.isToggled},this.renderItemIcon(n),this.renderItemContent(n),this.renderItemShortcut(n)):Ji.li({className:i,dataset:o},this.renderItemIcon(n),this.renderItemContent(n),this.renderItemShortcut(n))},r.prototype.renderEmptyMessage=function(n){var i=this.formatEmptyMessage(n);return Ji.li({className:"lm-CommandPalette-emptyMessage p-CommandPalette-emptyMessage"},i)},r.prototype.renderItemIcon=function(n){var i=this.createIconClass(n);return typeof n.item.icon=="string"?Ji.div({className:i},n.item.iconLabel):Ji.div({className:i},n.item.icon,n.item.iconLabel)},r.prototype.renderItemContent=function(n){return Ji.div({className:"lm-CommandPalette-itemContent p-CommandPalette-itemContent"},this.renderItemLabel(n),this.renderItemCaption(n))},r.prototype.renderItemLabel=function(n){var i=this.formatItemLabel(n);return Ji.div({className:"lm-CommandPalette-itemLabel p-CommandPalette-itemLabel"},i)},r.prototype.renderItemCaption=function(n){var i=this.formatItemCaption(n);return Ji.div({className:"lm-CommandPalette-itemCaption p-CommandPalette-itemCaption"},i)},r.prototype.renderItemShortcut=function(n){var i=this.formatItemShortcut(n);return Ji.div({className:"lm-CommandPalette-itemShortcut p-CommandPalette-itemShortcut"},i)},r.prototype.createItemClass=function(n){var i="lm-CommandPalette-item";i+=" p-CommandPalette-item",n.item.isEnabled||(i+=" lm-mod-disabled",i+=" p-mod-disabled"),n.item.isToggled&&(i+=" lm-mod-toggled",i+=" p-mod-toggled"),n.active&&(i+=" lm-mod-active",i+=" p-mod-active");var o=n.item.className;return o&&(i+=" "+o),i},r.prototype.createItemDataset=function(n){return uc(uc({},n.item.dataset),{command:n.item.command})},r.prototype.createIconClass=function(n){var i="lm-CommandPalette-itemIcon";i+=" p-CommandPalette-itemIcon";var o=n.item.iconClass;return o?i+" "+o:i},r.prototype.formatHeader=function(n){return!n.indices||n.indices.length===0?n.category:_x.highlight(n.category,n.indices,Ji.mark)},r.prototype.formatEmptyMessage=function(n){return"No commands found that match '"+n.query+"'"},r.prototype.formatItemShortcut=function(n){var i=n.item.keyBinding;return i?bx.formatKeystroke(i.keys):null},r.prototype.formatItemLabel=function(n){return!n.indices||n.indices.length===0?n.item.label:_x.highlight(n.item.label,n.indices,Ji.mark)},r.prototype.formatItemCaption=function(n){return n.item.caption},r}();e.Renderer=t,e.defaultRenderer=new t})(uht||(uht={}));var Cd;(function(e){function t(){var w=document.createElement("div"),E=document.createElement("div"),P=document.createElement("div"),B=document.createElement("input"),D=document.createElement("ul"),W=document.createElement("button");return E.className="lm-CommandPalette-search",P.className="lm-CommandPalette-wrapper",B.className="lm-CommandPalette-input",W.className="lm-close-icon",D.className="lm-CommandPalette-content",E.classList.add("p-CommandPalette-search"),P.classList.add("p-CommandPalette-wrapper"),B.classList.add("p-CommandPalette-input"),D.classList.add("p-CommandPalette-content"),B.spellcheck=!1,P.appendChild(B),P.appendChild(W),E.appendChild(P),w.appendChild(E),w.appendChild(D),w}e.createNode=t;function r(w,E){return new x(w,E)}e.createItem=r;function n(w,E){var P=c(w,E);return P.sort(h),p(P)}e.search=n;function i(w){return w.type==="item"&&w.item.isEnabled}e.canActivate=i;function o(w){return w.trim().replace(/\s+/g," ")}function s(w){return w.replace(/\s+/g,"").toLowerCase()}function c(w,E){E=s(E);for(var P=[],B=0,D=w.length;B<D;++B){var W=w[B];if(W.isVisible){if(!E){P.push({matchType:3,categoryIndices:null,labelIndices:null,score:0,item:W});continue}var X=l(W,E);X&&(W.isEnabled||(X.score+=1e3),P.push(X))}}return P}function l(w,E){for(var P=w.category.toLowerCase(),B=w.label.toLowerCase(),D=P+" "+B,W=1/0,X=null,q=/\b\w/g;;){var $=q.exec(D);if(!$)break;var et=_x.matchSumOfDeltas(D,E,$.index);if(!et)break;et&&et.score<=W&&(W=et.score,X=et.indices)}if(!X||W===1/0)return null;for(var F=P.length+1,ut=Ze.lowerBound(X,F,function(Mt,ct){return Mt-ct}),ot=X.slice(0,ut),J=X.slice(ut),G=0,mt=J.length;G<mt;++G)J[G]-=F;return ot.length===0?{matchType:0,categoryIndices:null,labelIndices:J,score:W,item:w}:J.length===0?{matchType:1,categoryIndices:ot,labelIndices:null,score:W,item:w}:{matchType:2,categoryIndices:ot,labelIndices:J,score:W,item:w}}function h(w,E){var P=w.matchType-E.matchType;if(P!==0)return P;var B=w.score-E.score;if(B!==0)return B;var D=0,W=0;switch(w.matchType){case 0:D=w.labelIndices[0],W=E.labelIndices[0];break;case 1:case 2:D=w.categoryIndices[0],W=E.categoryIndices[0];break}if(D!==W)return D-W;var X=w.item.category.localeCompare(E.item.category);if(X!==0)return X;var q=w.item.rank,$=E.item.rank;return q!==$?q<$?-1:1:w.item.label.localeCompare(E.item.label)}function p(w){var E=new Array(w.length);Ze.fill(E,!1);for(var P=[],B=0,D=w.length;B<D;++B)if(!E[B]){var W=w[B],X=W.item,q=W.categoryIndices,$=X.category;P.push({type:"header",category:$,indices:q});for(var et=B;et<D;++et)if(!E[et]){var F=w[et],ut=F.item,ot=F.labelIndices;ut.category===$&&(P.push({type:"item",item:ut,indices:ot}),E[et]=!0)}}return P}var x=function(){function w(E,P){this._commands=E,this.category=o(P.category),this.command=P.command,this.args=P.args||Og.JSONExt.emptyObject,this.rank=P.rank!==void 0?P.rank:1/0}return Object.defineProperty(w.prototype,"label",{get:function(){return this._commands.label(this.command,this.args)},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"icon",{get:function(){return this._commands.icon(this.command,this.args)},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"iconClass",{get:function(){return this._commands.iconClass(this.command,this.args)},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"iconLabel",{get:function(){return this._commands.iconLabel(this.command,this.args)},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"caption",{get:function(){return this._commands.caption(this.command,this.args)},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"className",{get:function(){return this._commands.className(this.command,this.args)},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"dataset",{get:function(){return this._commands.dataset(this.command,this.args)},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"isEnabled",{get:function(){return this._commands.isEnabled(this.command,this.args)},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"isToggled",{get:function(){return this._commands.isToggled(this.command,this.args)},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"isToggleable",{get:function(){return this._commands.isToggleable(this.command,this.args)},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"isVisible",{get:function(){return this._commands.isVisible(this.command,this.args)},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"keyBinding",{get:function(){var E=this,P=E.command,B=E.args;return Ze.findLastValue(this._commands.keyBindings,function(D){return D.command===P&&Og.JSONExt.deepEqual(D.args,B)})||null},enumerable:!0,configurable:!0}),w}()})(Cd||(Cd={}));var Ex=function(e){Ds(t,e);function t(r){var n=e.call(this,{node:bl.createNode()})||this;return n._childIndex=-1,n._activeIndex=-1,n._openTimerID=0,n._closeTimerID=0,n._items=[],n._childMenu=null,n._parentMenu=null,n._aboutToClose=new Di(n),n._menuRequested=new Di(n),n.addClass("lm-Menu"),n.addClass("p-Menu"),n.setFlag(Mr.Flag.DisallowLayout),n.commands=r.commands,n.renderer=r.renderer||t.defaultRenderer,n}return t.prototype.dispose=function(){this.close(),this._items.length=0,e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"aboutToClose",{get:function(){return this._aboutToClose},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"menuRequested",{get:function(){return this._menuRequested},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentMenu",{get:function(){return this._parentMenu},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childMenu",{get:function(){return this._childMenu},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rootMenu",{get:function(){for(var r=this;r._parentMenu;)r=r._parentMenu;return r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leafMenu",{get:function(){for(var r=this;r._childMenu;)r=r._childMenu;return r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentNode",{get:function(){return this.node.getElementsByClassName("lm-Menu-content")[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activeItem",{get:function(){return this._items[this._activeIndex]||null},set:function(r){this.activeIndex=r?this._items.indexOf(r):-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activeIndex",{get:function(){return this._activeIndex},set:function(r){(r<0||r>=this._items.length)&&(r=-1),r!==-1&&!bl.canActivate(this._items[r])&&(r=-1),this._activeIndex!==r&&(this._activeIndex=r,this._activeIndex>=0&&this.contentNode.childNodes[this._activeIndex]&&this.contentNode.childNodes[this._activeIndex].focus(),this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return this._items},enumerable:!0,configurable:!0}),t.prototype.activateNextItem=function(){var r=this._items.length,n=this._activeIndex,i=n<r-1?n+1:0,o=i===0?r-1:i-1;this.activeIndex=Ze.findFirstIndex(this._items,bl.canActivate,i,o)},t.prototype.activatePreviousItem=function(){var r=this._items.length,n=this._activeIndex,i=n<=0?r-1:n-1,o=i===r-1?0:i+1;this.activeIndex=Ze.findLastIndex(this._items,bl.canActivate,i,o)},t.prototype.triggerActiveItem=function(){if(this.isAttached){var r=this.activeItem;if(r){if(this._cancelOpenTimer(),this._cancelCloseTimer(),r.type==="submenu"){this._openChildMenu(!0);return}this.rootMenu.close();var n=r.command,i=r.args;this.commands.isEnabled(n,i)?this.commands.execute(n,i):console.log("Command '"+n+"' is disabled.")}}},t.prototype.addItem=function(r){return this.insertItem(this._items.length,r)},t.prototype.insertItem=function(r,n){this.isAttached&&this.close(),this.activeIndex=-1;var i=Math.max(0,Math.min(r,this._items.length)),o=bl.createItem(this,n);return Ze.insert(this._items,i,o),this.update(),o},t.prototype.removeItem=function(r){this.removeItemAt(this._items.indexOf(r))},t.prototype.removeItemAt=function(r){this.isAttached&&this.close(),this.activeIndex=-1;var n=Ze.removeAt(this._items,r);n&&this.update()},t.prototype.clearItems=function(){this.isAttached&&this.close(),this.activeIndex=-1,this._items.length!==0&&(this._items.length=0,this.update())},t.prototype.open=function(r,n,i){if(i===void 0&&(i={}),!this.isAttached){var o=i.forceX||!1,s=i.forceY||!1;bl.openRootMenu(this,r,n,o,s),this.activate()}},t.prototype.handleEvent=function(r){switch(r.type){case"keydown":this._evtKeyDown(r);break;case"mouseup":this._evtMouseUp(r);break;case"mousemove":this._evtMouseMove(r);break;case"mouseenter":this._evtMouseEnter(r);break;case"mouseleave":this._evtMouseLeave(r);break;case"mousedown":this._evtMouseDown(r);break;case"contextmenu":r.preventDefault(),r.stopPropagation();break}},t.prototype.onBeforeAttach=function(r){this.node.addEventListener("keydown",this),this.node.addEventListener("mouseup",this),this.node.addEventListener("mousemove",this),this.node.addEventListener("mouseenter",this),this.node.addEventListener("mouseleave",this),this.node.addEventListener("contextmenu",this),document.addEventListener("mousedown",this,!0)},t.prototype.onAfterDetach=function(r){this.node.removeEventListener("keydown",this),this.node.removeEventListener("mouseup",this),this.node.removeEventListener("mousemove",this),this.node.removeEventListener("mouseenter",this),this.node.removeEventListener("mouseleave",this),this.node.removeEventListener("contextmenu",this),document.removeEventListener("mousedown",this,!0)},t.prototype.onActivateRequest=function(r){this.isAttached&&this.node.focus()},t.prototype.onUpdateRequest=function(r){for(var n=this,i=this._items,o=this.renderer,s=this._activeIndex,c=bl.computeCollapsed(i),l=new Array(i.length),h=function(w,E){var P=i[w],B=w===s,D=c[w];l[w]=o.renderItem({item:P,active:B,collapsed:D,onfocus:function(){n.activeIndex=w}})},p=0,x=i.length;p<x;++p)h(p);Sd.render(l,this.contentNode)},t.prototype.onCloseRequest=function(r){this._cancelOpenTimer(),this._cancelCloseTimer(),this.activeIndex=-1;var n=this._childMenu;n&&(this._childIndex=-1,this._childMenu=null,n._parentMenu=null,n.close());var i=this._parentMenu;i&&(this._parentMenu=null,i._childIndex=-1,i._childMenu=null,i.activate()),this.isAttached&&this._aboutToClose.emit(void 0),e.prototype.onCloseRequest.call(this,r)},t.prototype._evtKeyDown=function(r){r.preventDefault(),r.stopPropagation();var n=r.keyCode;if(n===13){this.triggerActiveItem();return}if(n===27){this.close();return}if(n===37){this._parentMenu?this.close():this._menuRequested.emit("previous");return}if(n===38){this.activatePreviousItem();return}if(n===39){var i=this.activeItem;i&&i.type==="submenu"?this.triggerActiveItem():this.rootMenu._menuRequested.emit("next");return}if(n===40){this.activateNextItem();return}var o=vx().keyForKeydownEvent(r);if(o){var s=this._activeIndex+1,c=bl.findMnemonic(this._items,o,s);c.index!==-1&&!c.multiple?(this.activeIndex=c.index,this.triggerActiveItem()):c.index!==-1?this.activeIndex=c.index:c.auto!==-1&&(this.activeIndex=c.auto)}},t.prototype._evtMouseUp=function(r){r.button===0&&(r.preventDefault(),r.stopPropagation(),this.triggerActiveItem())},t.prototype._evtMouseMove=function(r){var n=Ze.findFirstIndex(this.contentNode.children,function(o){return co.hitTest(o,r.clientX,r.clientY)});if(n!==this._activeIndex){if(this.activeIndex=n,n=this.activeIndex,n===this._childIndex){this._cancelOpenTimer(),this._cancelCloseTimer();return}this._childIndex!==-1&&this._startCloseTimer(),this._cancelOpenTimer();var i=this.activeItem;!i||i.type!=="submenu"||!i.submenu||this._startOpenTimer()}},t.prototype._evtMouseEnter=function(r){for(var n=this._parentMenu;n;n=n._parentMenu)n._cancelOpenTimer(),n._cancelCloseTimer(),n.activeIndex=n._childIndex},t.prototype._evtMouseLeave=function(r){if(this._cancelOpenTimer(),!this._childMenu){this.activeIndex=-1;return}var n=r.clientX,i=r.clientY;if(co.hitTest(this._childMenu.node,n,i)){this._cancelCloseTimer();return}this.activeIndex=-1,this._startCloseTimer()},t.prototype._evtMouseDown=function(r){this._parentMenu||(bl.hitTestMenus(this,r.clientX,r.clientY)?(r.preventDefault(),r.stopPropagation()):this.close())},t.prototype._openChildMenu=function(r){r===void 0&&(r=!1);var n=this.activeItem;if(!n||n.type!=="submenu"||!n.submenu){this._closeChildMenu();return}var i=n.submenu;if(i!==this._childMenu){t.saveWindowData(),this._closeChildMenu(),this._childMenu=i,this._childIndex=this._activeIndex,i._parentMenu=this,mr.sendMessage(this,Mr.Msg.UpdateRequest);var o=this.contentNode.children[this._activeIndex];bl.openSubmenu(i,o),r&&(i.activeIndex=-1,i.activateNextItem()),i.activate()}},t.prototype._closeChildMenu=function(){this._childMenu&&this._childMenu.close()},t.prototype._startOpenTimer=function(){var r=this;this._openTimerID===0&&(this._openTimerID=window.setTimeout(function(){r._openTimerID=0,r._openChildMenu()},bl.TIMER_DELAY))},t.prototype._startCloseTimer=function(){var r=this;this._closeTimerID===0&&(this._closeTimerID=window.setTimeout(function(){r._closeTimerID=0,r._closeChildMenu()},bl.TIMER_DELAY))},t.prototype._cancelOpenTimer=function(){this._openTimerID!==0&&(clearTimeout(this._openTimerID),this._openTimerID=0)},t.prototype._cancelCloseTimer=function(){this._closeTimerID!==0&&(clearTimeout(this._closeTimerID),this._closeTimerID=0)},t.saveWindowData=function(){bl.saveWindowData()},t}(Mr);(function(e){var t=function(){function r(){}return r.prototype.renderItem=function(n){var i=this.createItemClass(n),o=this.createItemDataset(n),s=this.createItemARIA(n);return Ji.li(uc({className:i,dataset:o,tabindex:"0",onfocus:n.onfocus},s),this.renderIcon(n),this.renderLabel(n),this.renderShortcut(n),this.renderSubmenu(n))},r.prototype.renderIcon=function(n){var i=this.createIconClass(n);return typeof n.item.icon=="string"?Ji.div({className:i},n.item.iconLabel):Ji.div({className:i},n.item.icon,n.item.iconLabel)},r.prototype.renderLabel=function(n){var i=this.formatLabel(n);return Ji.div({className:"lm-Menu-itemLabel p-Menu-itemLabel"},i)},r.prototype.renderShortcut=function(n){var i=this.formatShortcut(n);return Ji.div({className:"lm-Menu-itemShortcut p-Menu-itemShortcut"},i)},r.prototype.renderSubmenu=function(n){return Ji.div({className:"lm-Menu-itemSubmenuIcon p-Menu-itemSubmenuIcon"})},r.prototype.createItemClass=function(n){var i="lm-Menu-item";i+=" p-Menu-item",n.item.isEnabled||(i+=" lm-mod-disabled",i+=" p-mod-disabled"),n.item.isToggled&&(i+=" lm-mod-toggled",i+=" p-mod-toggled"),n.item.isVisible||(i+=" lm-mod-hidden",i+=" p-mod-hidden"),n.active&&(i+=" lm-mod-active",i+=" p-mod-active"),n.collapsed&&(i+=" lm-mod-collapsed",i+=" p-mod-collapsed");var o=n.item.className;return o&&(i+=" "+o),i},r.prototype.createItemDataset=function(n){var i,o=n.item,s=o.type,c=o.command,l=o.dataset;return s==="command"?i=uc(uc({},l),{type:s,command:c}):i=uc(uc({},l),{type:s}),i},r.prototype.createIconClass=function(n){var i="lm-Menu-itemIcon";i+=" p-Menu-itemIcon";var o=n.item.iconClass;return o?i+" "+o:i},r.prototype.createItemARIA=function(n){var i={};switch(n.item.type){case"separator":i.role="presentation";break;case"submenu":i["aria-haspopup"]="true",n.item.isEnabled||(i["aria-disabled"]="true");break;default:n.item.isEnabled||(i["aria-disabled"]="true"),i.role="menuitem"}return i},r.prototype.formatLabel=function(n){var i=n.item,o=i.label,s=i.mnemonic;if(s<0||s>=o.length)return o;var c=o.slice(0,s),l=o.slice(s+1),h=o[s],p=Ji.span({className:"lm-Menu-itemMnemonic p-Menu-itemMnemonic"},h);return[c,p,l]},r.prototype.formatShortcut=function(n){var i=n.item.keyBinding;return i?bx.formatKeystroke(i.keys):null},r}();e.Renderer=t,e.defaultRenderer=new t})(Ex||(Ex={}));var bl;(function(e){e.TIMER_DELAY=300,e.SUBMENU_OVERLAP=3;var t=null,r=0;function n(){return r>0?(r--,t):p()}function i(){t=p(),r++}e.saveWindowData=i;function o(){var B=document.createElement("div"),D=document.createElement("ul");return D.className="lm-Menu-content",D.classList.add("p-Menu-content"),B.appendChild(D),D.setAttribute("role","menu"),B.tabIndex=0,B}e.createNode=o;function s(B){return B.type!=="separator"&&B.isEnabled&&B.isVisible}e.canActivate=s;function c(B,D){return new P(B.commands,D)}e.createItem=c;function l(B,D,W){for(var X=B;X;X=X.childMenu)if(co.hitTest(X.node,D,W))return!0;return!1}e.hitTestMenus=l;function h(B){var D=new Array(B.length);Ze.fill(D,!1);for(var W=0,X=B.length;W<X;++W){var q=B[W];if(q.isVisible){if(q.type!=="separator")break;D[W]=!0}}for(var $=X-1;$>=0;--$){var q=B[$];if(q.isVisible){if(q.type!=="separator")break;D[$]=!0}}for(var et=!1;++W<$;){var q=B[W];q.isVisible&&(q.type!=="separator"?et=!1:et?D[W]=!0:et=!0)}return D}e.computeCollapsed=h;function p(){return{pageXOffset:window.pageXOffset,pageYOffset:window.pageYOffset,clientWidth:document.documentElement.clientWidth,clientHeight:document.documentElement.clientHeight}}function x(B,D,W,X,q){var $=n(),et=$.pageXOffset,F=$.pageYOffset,ut=$.clientWidth,ot=$.clientHeight;mr.sendMessage(B,Mr.Msg.UpdateRequest);var J=ot-(q?W:0),G=B.node,mt=G.style;mt.opacity="0",mt.maxHeight=J+"px",Mr.attach(B,document.body);var Mt=G.getBoundingClientRect(),ct=Mt.width,gt=Mt.height;!X&&D+ct>et+ut&&(D=et+ut-ct),!q&&W+gt>F+ot&&(W>F+ot?W=F+ot-gt:W=W-gt),mt.transform="translate("+Math.max(0,D)+"px, "+Math.max(0,W)+"px",mt.opacity="1"}e.openRootMenu=x;function w(B,D){var W=n(),X=W.pageXOffset,q=W.pageYOffset,$=W.clientWidth,et=W.clientHeight;mr.sendMessage(B,Mr.Msg.UpdateRequest);var F=et,ut=B.node,ot=ut.style;ot.opacity="0",ot.maxHeight=F+"px",Mr.attach(B,document.body);var J=ut.getBoundingClientRect(),G=J.width,mt=J.height,Mt=co.boxSizing(B.node),ct=D.getBoundingClientRect(),gt=ct.right-e.SUBMENU_OVERLAP;gt+G>X+$&&(gt=ct.left+e.SUBMENU_OVERLAP-G);var ee=ct.top-Mt.borderTop-Mt.paddingTop;ee+mt>q+et&&(ee=ct.bottom+Mt.borderBottom+Mt.paddingBottom-mt),ot.transform="translate("+Math.max(0,gt)+"px, "+Math.max(0,ee)+"px",ot.opacity="1"}e.openSubmenu=w;function E(B,D,W){for(var X=-1,q=-1,$=!1,et=D.toUpperCase(),F=0,ut=B.length;F<ut;++F){var ot=(F+W)%ut,J=B[ot];if(s(J)){var G=J.label;if(G.length!==0){var mt=J.mnemonic;if(mt>=0&&mt<G.length){G[mt].toUpperCase()===et&&(X===-1?X=ot:$=!0);continue}q===-1&&G[0].toUpperCase()===et&&(q=ot)}}}return{index:X,multiple:$,auto:q}}e.findMnemonic=E;var P=function(){function B(D,W){this._commands=D,this.type=W.type||"command",this.command=W.command||"",this.args=W.args||Og.JSONExt.emptyObject,this.submenu=W.submenu||null}return Object.defineProperty(B.prototype,"label",{get:function(){return this.type==="command"?this._commands.label(this.command,this.args):this.type==="submenu"&&this.submenu?this.submenu.title.label:""},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"mnemonic",{get:function(){return this.type==="command"?this._commands.mnemonic(this.command,this.args):this.type==="submenu"&&this.submenu?this.submenu.title.mnemonic:-1},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"icon",{get:function(){return this.type==="command"?this._commands.icon(this.command,this.args):this.type==="submenu"&&this.submenu?this.submenu.title.icon:this.iconClass},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"iconClass",{get:function(){return this.type==="command"?this._commands.iconClass(this.command,this.args):this.type==="submenu"&&this.submenu?this.submenu.title.iconClass:""},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"iconLabel",{get:function(){return this.type==="command"?this._commands.iconLabel(this.command,this.args):this.type==="submenu"&&this.submenu?this.submenu.title.iconLabel:""},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"caption",{get:function(){return this.type==="command"?this._commands.caption(this.command,this.args):this.type==="submenu"&&this.submenu?this.submenu.title.caption:""},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"className",{get:function(){return this.type==="command"?this._commands.className(this.command,this.args):this.type==="submenu"&&this.submenu?this.submenu.title.className:""},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"dataset",{get:function(){return this.type==="command"?this._commands.dataset(this.command,this.args):this.type==="submenu"&&this.submenu?this.submenu.title.dataset:{}},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"isEnabled",{get:function(){return this.type==="command"?this._commands.isEnabled(this.command,this.args):this.type==="submenu"?this.submenu!==null:!0},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"isToggled",{get:function(){return this.type==="command"?this._commands.isToggled(this.command,this.args):!1},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"isVisible",{get:function(){return this.type==="command"?this._commands.isVisible(this.command,this.args):this.type==="submenu"?this.submenu!==null:!0},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"keyBinding",{get:function(){if(this.type==="command"){var D=this,W=D.command,X=D.args;return Ze.findLastValue(this._commands.keyBindings,function(q){return q.command===W&&Og.JSONExt.deepEqual(q.args,X)})||null}return null},enumerable:!0,configurable:!0}),B}()})(bl||(bl={}));var WWe=function(){function e(t){this._groupByTarget=!0,this._idTick=0,this._items=[],this._sortBySelector=!0;var r=t.groupByTarget,n=t.sortBySelector,i=Bzt(t,["groupByTarget","sortBySelector"]);this.menu=new Ex(i),this._groupByTarget=r!==!1,this._sortBySelector=n!==!1}return e.prototype.addItem=function(t){var r=this,n=XR.createItem(t,this._idTick++);return this._items.push(n),new fA(function(){Ze.removeFirstOf(r._items,n)})},e.prototype.open=function(t){var r=this;if(Ex.saveWindowData(),this.menu.clearItems(),this._items.length===0)return!1;var n=XR.matchItems(this._items,t,this._groupByTarget,this._sortBySelector);return!n||n.length===0?!1:(yn(n,function(i){r.menu.addItem(i)}),this.menu.open(t.clientX,t.clientY),!0)},e}(),XR;(function(e){function t(s,c){var l=n(s.selector),h=s.rank!==void 0?s.rank:1/0;return uc(uc({},s),{selector:l,rank:h,id:c})}e.createItem=t;function r(s,c,l,h){var p=c.target;if(!p)return null;var x=c.currentTarget;if(!x||!x.contains(p)&&(p=document.elementFromPoint(c.clientX,c.clientY),!p||!x.contains(p)))return null;for(var w=[],E=s.slice();p!==null;){for(var P=[],B=0,D=E.length;B<D;++B){var W=E[B];W&&Qh.matches(p,W.selector)&&(P.push(W),E[B]=null)}if(P.length!==0&&(l&&P.sort(h?o:i),w.push.apply(w,P)),p===x)break;p=p.parentElement}return l||w.sort(h?o:i),w}e.matchItems=r;function n(s){if(s.indexOf(",")!==-1)throw new Error("Selector cannot contain commas: "+s);if(!Qh.isValid(s))throw new Error("Invalid selector: "+s);return s}function i(s,c){var l=s.rank,h=c.rank;return l!==h?l<h?-1:1:s.id-c.id}function o(s,c){var l=Qh.calculateSpecificity(s.selector),h=Qh.calculateSpecificity(c.selector);return l!==h?h-l:i(s,c)}})(XR||(XR={}));var Mx=function(e){Ds(t,e);function t(r){r===void 0&&(r={});var n=e.call(this,{node:ah.createNode()})||this;return n._currentIndex=-1,n._titles=[],n._titlesEditable=!1,n._previousTitle=null,n._dragData=null,n._addButtonEnabled=!1,n._tabMoved=new Di(n),n._currentChanged=new Di(n),n._addRequested=new Di(n),n._tabCloseRequested=new Di(n),n._tabDetachRequested=new Di(n),n._tabActivateRequested=new Di(n),n.addClass("lm-TabBar"),n.addClass("p-TabBar"),n.contentNode.setAttribute("role","tablist"),n.setFlag(Mr.Flag.DisallowLayout),n._document=r.document||document,n.tabsMovable=r.tabsMovable||!1,n.titlesEditable=r.titlesEditable||!1,n.allowDeselect=r.allowDeselect||!1,n.addButtonEnabled=r.addButtonEnabled||!1,n.insertBehavior=r.insertBehavior||"select-tab-if-needed",n.name=r.name||"",n.orientation=r.orientation||"horizontal",n.removeBehavior=r.removeBehavior||"select-tab-after",n.renderer=r.renderer||t.defaultRenderer,n}return t.prototype.dispose=function(){this._releaseMouse(),this._titles.length=0,this._previousTitle=null,e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"currentChanged",{get:function(){return this._currentChanged},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tabMoved",{get:function(){return this._tabMoved},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tabActivateRequested",{get:function(){return this._tabActivateRequested},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"addRequested",{get:function(){return this._addRequested},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tabCloseRequested",{get:function(){return this._tabCloseRequested},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tabDetachRequested",{get:function(){return this._tabDetachRequested},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"document",{get:function(){return this._document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"titlesEditable",{get:function(){return this._titlesEditable},set:function(r){this._titlesEditable=r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentTitle",{get:function(){return this._titles[this._currentIndex]||null},set:function(r){this.currentIndex=r?this._titles.indexOf(r):-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentIndex",{get:function(){return this._currentIndex},set:function(r){if((r<0||r>=this._titles.length)&&(r=-1),this._currentIndex!==r){var n=this._currentIndex,i=this._titles[n]||null,o=r,s=this._titles[o]||null;this._currentIndex=o,this._previousTitle=i,this.update(),this._currentChanged.emit({previousIndex:n,previousTitle:i,currentIndex:o,currentTitle:s})}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},set:function(r){this._name=r,r?this.contentNode.setAttribute("aria-label",r):this.contentNode.removeAttribute("aria-label")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"orientation",{get:function(){return this._orientation},set:function(r){this._orientation!==r&&(this._releaseMouse(),this._orientation=r,this.dataset.orientation=r,this.contentNode.setAttribute("aria-orientation",r))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"addButtonEnabled",{get:function(){return this._addButtonEnabled},set:function(r){this._addButtonEnabled!==r&&(this._addButtonEnabled=r,r?this.addButtonNode.classList.remove("lm-mod-hidden"):this.addButtonNode.classList.add("lm-mod-hidden"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"titles",{get:function(){return this._titles},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentNode",{get:function(){return this.node.getElementsByClassName("lm-TabBar-content")[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"addButtonNode",{get:function(){return this.node.getElementsByClassName("lm-TabBar-addButton")[0]},enumerable:!0,configurable:!0}),t.prototype.addTab=function(r){return this.insertTab(this._titles.length,r)},t.prototype.insertTab=function(r,n){this._releaseMouse();var i=ah.asTitle(n),o=this._titles.indexOf(i),s=Math.max(0,Math.min(r,this._titles.length));return o===-1?(Ze.insert(this._titles,s,i),i.changed.connect(this._onTitleChanged,this),this.update(),this._adjustCurrentForInsert(s,i),i):(s===this._titles.length&&s--,o===s||(Ze.move(this._titles,o,s),this.update(),this._adjustCurrentForMove(o,s)),i)},t.prototype.removeTab=function(r){this.removeTabAt(this._titles.indexOf(r))},t.prototype.removeTabAt=function(r){this._releaseMouse();var n=Ze.removeAt(this._titles,r);n&&(n.changed.disconnect(this._onTitleChanged,this),n===this._previousTitle&&(this._previousTitle=null),this.update(),this._adjustCurrentForRemove(r,n))},t.prototype.clearTabs=function(){if(this._titles.length!==0){this._releaseMouse();for(var r=0,n=this._titles;r<n.length;r++){var i=n[r];i.changed.disconnect(this._onTitleChanged,this)}var o=this.currentIndex,s=this.currentTitle;this._currentIndex=-1,this._previousTitle=null,this._titles.length=0,this.update(),o!==-1&&this._currentChanged.emit({previousIndex:o,previousTitle:s,currentIndex:-1,currentTitle:null})}},t.prototype.releaseMouse=function(){this._releaseMouse()},t.prototype.handleEvent=function(r){switch(r.type){case"mousedown":this._evtMouseDown(r);break;case"mousemove":this._evtMouseMove(r);break;case"mouseup":this._evtMouseUp(r);break;case"pointerdown":this._evtMouseDown(r);break;case"pointermove":this._evtMouseMove(r);break;case"pointerup":this._evtMouseUp(r);break;case"dblclick":this._evtDblClick(r);break;case"keydown":this._evtKeyDown(r);break;case"contextmenu":r.preventDefault(),r.stopPropagation();break}},t.prototype.onBeforeAttach=function(r){this.node.addEventListener("mousedown",this),this.node.addEventListener("pointerdown",this),this.node.addEventListener("dblclick",this)},t.prototype.onAfterDetach=function(r){this.node.removeEventListener("mousedown",this),this.node.removeEventListener("pointerdown",this),this.node.removeEventListener("dblclick",this),this._releaseMouse()},t.prototype.onUpdateRequest=function(r){for(var n=this._titles,i=this.renderer,o=this.currentTitle,s=new Array(n.length),c=0,l=n.length;c<l;++c){var h=n[c],p=h===o,x=p?l:l-c-1;s[c]=i.renderTab({title:h,current:p,zIndex:x})}Sd.render(s,this.contentNode)},t.prototype._evtDblClick=function(r){if(this.titlesEditable){var n=this.contentNode.children,i=Ze.findFirstIndex(n,function(x){return co.hitTest(x,r.clientX,r.clientY)});if(i!==-1){var o=this.titles[i],s=n[i].querySelector(".lm-TabBar-tabLabel");if(s&&s.contains(r.target)){var c=o.label||"",l=s.innerHTML;s.innerHTML="";var h=document.createElement("input");h.classList.add("lm-TabBar-tabInput"),h.value=c,s.appendChild(h);var p=function(){h.removeEventListener("blur",p),s.innerHTML=l};h.addEventListener("dblclick",function(x){return x.stopPropagation()}),h.addEventListener("blur",p),h.addEventListener("keydown",function(x){x.key==="Enter"?(h.value!==""&&(o.label=o.caption=h.value),p()):x.key==="Escape"&&p()}),h.select(),h.focus(),s.children.length>0&&s.children[0].focus()}}}},t.prototype._evtKeyDown=function(r){r.preventDefault(),r.stopPropagation(),r.keyCode===27&&this._releaseMouse()},t.prototype._evtMouseDown=function(r){if(!(r.button!==0&&r.button!==1)&&!this._dragData){var n=this.addButtonEnabled&&this.addButtonNode.contains(r.target),i=this.contentNode.children,o=Ze.findFirstIndex(i,function(c){return co.hitTest(c,r.clientX,r.clientY)});if(!(o===-1&&!n)&&(r.preventDefault(),r.stopPropagation(),this._dragData={tab:i[o],index:o,pressX:r.clientX,pressY:r.clientY,tabPos:-1,tabSize:-1,tabPressPos:-1,targetIndex:-1,tabLayout:null,contentRect:null,override:null,dragActive:!1,dragAborted:!1,detachRequested:!1},this.document.addEventListener("mouseup",this,!0),this.document.addEventListener("pointerup",this,!0),!(r.button===1||n))){var s=i[o].querySelector(this.renderer.closeIconSelector);s&&s.contains(r.target)||(this.tabsMovable&&(this.document.addEventListener("mousemove",this,!0),this.document.addEventListener("pointermove",this,!0),this.document.addEventListener("keydown",this,!0),this.document.addEventListener("contextmenu",this,!0)),this.allowDeselect&&this.currentIndex===o?this.currentIndex=-1:this.currentIndex=o,this.currentIndex!==-1&&this._tabActivateRequested.emit({index:this.currentIndex,title:this.currentTitle}))}}},t.prototype._evtMouseMove=function(r){var n=this._dragData;if(n){r.preventDefault(),r.stopPropagation();var i=this.contentNode.children;if(!(!n.dragActive&&!ah.dragExceeded(n,r))){if(!n.dragActive){var o=n.tab.getBoundingClientRect();this._orientation==="horizontal"?(n.tabPos=n.tab.offsetLeft,n.tabSize=o.width,n.tabPressPos=n.pressX-o.left):(n.tabPos=n.tab.offsetTop,n.tabSize=o.height,n.tabPressPos=n.pressY-o.top),n.tabLayout=ah.snapTabLayout(i,this._orientation),n.contentRect=this.contentNode.getBoundingClientRect(),n.override=pA.overrideCursor("default"),n.tab.classList.add("lm-mod-dragging"),this.addClass("lm-mod-dragging"),n.tab.classList.add("p-mod-dragging"),this.addClass("p-mod-dragging"),n.dragActive=!0}if(!n.detachRequested&&ah.detachExceeded(n,r)){n.detachRequested=!0;var s=n.index,c=r.clientX,l=r.clientY,h=i[s],p=this._titles[s];if(this._tabDetachRequested.emit({index:s,title:p,tab:h,clientX:c,clientY:l}),n.dragAborted)return}ah.layoutTabs(i,n,r,this._orientation)}}},t.prototype._evtMouseUp=function(r){var n=this;if(!(r.button!==0&&r.button!==1)){var i=this._dragData;if(i){if(r.preventDefault(),r.stopPropagation(),this.document.removeEventListener("mousemove",this,!0),this.document.removeEventListener("mouseup",this,!0),this.document.removeEventListener("pointermove",this,!0),this.document.removeEventListener("pointerup",this,!0),this.document.removeEventListener("keydown",this,!0),this.document.removeEventListener("contextmenu",this,!0),!i.dragActive){this._dragData=null;var o=this.addButtonEnabled&&this.addButtonNode.contains(r.target);if(o){this._addRequested.emit(void 0);return}var s=this.contentNode.children,c=Ze.findFirstIndex(s,function(x){return co.hitTest(x,r.clientX,r.clientY)});if(c!==i.index)return;var l=this._titles[c];if(!l.closable)return;if(r.button===1){this._tabCloseRequested.emit({index:c,title:l});return}var h=s[c].querySelector(this.renderer.closeIconSelector);if(h&&h.contains(r.target)){this._tabCloseRequested.emit({index:c,title:l});return}return}if(r.button===0){ah.finalizeTabPosition(i,this._orientation),i.tab.classList.remove("lm-mod-dragging"),i.tab.classList.remove("p-mod-dragging");var p=ah.parseTransitionDuration(i.tab);setTimeout(function(){if(!i.dragAborted){n._dragData=null,ah.resetTabPositions(n.contentNode.children,n._orientation),i.override.dispose(),n.removeClass("lm-mod-dragging"),n.removeClass("p-mod-dragging");var x=i.index,w=i.targetIndex;w===-1||x===w||(Ze.move(n._titles,x,w),n._adjustCurrentForMove(x,w),n._tabMoved.emit({fromIndex:x,toIndex:w,title:n._titles[w]}),mr.sendMessage(n,Mr.Msg.UpdateRequest))}},p)}}}},t.prototype._releaseMouse=function(){var r=this._dragData;r&&(this._dragData=null,this.document.removeEventListener("mousemove",this,!0),this.document.removeEventListener("mouseup",this,!0),this.document.removeEventListener("pointermove",this,!0),this.document.removeEventListener("pointerup",this,!0),this.document.removeEventListener("keydown",this,!0),this.document.removeEventListener("contextmenu",this,!0),r.dragAborted=!0,r.dragActive&&(ah.resetTabPositions(this.contentNode.children,this._orientation),r.override.dispose(),r.tab.classList.remove("lm-mod-dragging"),this.removeClass("lm-mod-dragging"),r.tab.classList.remove("p-mod-dragging"),this.removeClass("p-mod-dragging")))},t.prototype._adjustCurrentForInsert=function(r,n){var i=this.currentTitle,o=this._currentIndex,s=this.insertBehavior;if(s==="select-tab"||s==="select-tab-if-needed"&&o===-1){this._currentIndex=r,this._previousTitle=i,this._currentChanged.emit({previousIndex:o,previousTitle:i,currentIndex:r,currentTitle:n});return}o>=r&&this._currentIndex++},t.prototype._adjustCurrentForMove=function(r,n){this._currentIndex===r?this._currentIndex=n:this._currentIndex<r&&this._currentIndex>=n?this._currentIndex++:this._currentIndex>r&&this._currentIndex<=n&&this._currentIndex--},t.prototype._adjustCurrentForRemove=function(r,n){var i=this._currentIndex,o=this.removeBehavior;if(i!==r){i>r&&this._currentIndex--;return}if(this._titles.length===0){this._currentIndex=-1,this._currentChanged.emit({previousIndex:r,previousTitle:n,currentIndex:-1,currentTitle:null});return}if(o==="select-tab-after"){this._currentIndex=Math.min(r,this._titles.length-1),this._currentChanged.emit({previousIndex:r,previousTitle:n,currentIndex:this._currentIndex,currentTitle:this.currentTitle});return}if(o==="select-tab-before"){this._currentIndex=Math.max(0,r-1),this._currentChanged.emit({previousIndex:r,previousTitle:n,currentIndex:this._currentIndex,currentTitle:this.currentTitle});return}if(o==="select-previous-tab"){this._previousTitle?(this._currentIndex=this._titles.indexOf(this._previousTitle),this._previousTitle=null):this._currentIndex=Math.min(r,this._titles.length-1),this._currentChanged.emit({previousIndex:r,previousTitle:n,currentIndex:this._currentIndex,currentTitle:this.currentTitle});return}this._currentIndex=-1,this._currentChanged.emit({previousIndex:r,previousTitle:n,currentIndex:-1,currentTitle:null})},t.prototype._onTitleChanged=function(r){this.update()},t}(Mr);(function(e){var t=function(){function r(){this.closeIconSelector=".lm-TabBar-tabCloseIcon",this._tabID=0,this._tabKeys=new WeakMap,this._uuid=++r._nInstance}return r.prototype.renderTab=function(n){var i=n.title.caption,o=this.createTabKey(n),s=o,c=this.createTabStyle(n),l=this.createTabClass(n),h=this.createTabDataset(n),p=this.createTabARIA(n);return n.title.closable?Ji.li(uc({id:s,key:o,className:l,title:i,style:c,dataset:h},p),this.renderIcon(n),this.renderLabel(n),this.renderCloseIcon(n)):Ji.li(uc({id:s,key:o,className:l,title:i,style:c,dataset:h},p),this.renderIcon(n),this.renderLabel(n))},r.prototype.renderIcon=function(n){var i=n.title,o=this.createIconClass(n);return typeof i.icon=="string"?Ji.div({className:o},i.iconLabel):Ji.div({className:o},i.icon,i.iconLabel)},r.prototype.renderLabel=function(n){return Ji.div({className:"lm-TabBar-tabLabel p-TabBar-tabLabel"},n.title.label)},r.prototype.renderCloseIcon=function(n){return Ji.div({className:"lm-TabBar-tabCloseIcon p-TabBar-tabCloseIcon"})},r.prototype.createTabKey=function(n){var i=this._tabKeys.get(n.title);return i===void 0&&(i="tab-key-"+this._uuid+"-"+this._tabID++,this._tabKeys.set(n.title,i)),i},r.prototype.createTabStyle=function(n){return{zIndex:""+n.zIndex}},r.prototype.createTabClass=function(n){var i="lm-TabBar-tab";return i+=" p-TabBar-tab",n.title.className&&(i+=" "+n.title.className),n.title.closable&&(i+=" lm-mod-closable",i+=" p-mod-closable"),n.current&&(i+=" lm-mod-current",i+=" p-mod-current"),i},r.prototype.createTabDataset=function(n){return n.title.dataset},r.prototype.createTabARIA=function(n){return{role:"tab","aria-selected":n.current.toString()}},r.prototype.createIconClass=function(n){var i="lm-TabBar-tabIcon";i+=" p-TabBar-tabIcon";var o=n.title.iconClass;return o?i+" "+o:i},r._nInstance=0,r}();e.Renderer=t,e.defaultRenderer=new t,e.addButtonSelector=".lm-TabBar-addButton"})(Mx||(Mx={}));var ah;(function(e){e.DRAG_THRESHOLD=5,e.DETACH_THRESHOLD=20;function t(){var p=document.createElement("div"),x=document.createElement("ul");x.setAttribute("role","tablist"),x.className="lm-TabBar-content",x.classList.add("p-TabBar-content"),p.appendChild(x);var w=document.createElement("div");return w.className="lm-TabBar-addButton lm-mod-hidden",p.appendChild(w),p}e.createNode=t;function r(p){return p instanceof w8?p:new w8(p)}e.asTitle=r;function n(p){var x=window.getComputedStyle(p);return 1e3*(parseFloat(x.transitionDuration)||0)}e.parseTransitionDuration=n;function i(p,x){for(var w=new Array(p.length),E=0,P=p.length;E<P;++E){var B=p[E],D=window.getComputedStyle(B);x==="horizontal"?w[E]={pos:B.offsetLeft,size:B.offsetWidth,margin:parseFloat(D.marginLeft)||0}:w[E]={pos:B.offsetTop,size:B.offsetHeight,margin:parseFloat(D.marginTop)||0}}return w}e.snapTabLayout=i;function o(p,x){var w=Math.abs(x.clientX-p.pressX),E=Math.abs(x.clientY-p.pressY);return w>=e.DRAG_THRESHOLD||E>=e.DRAG_THRESHOLD}e.dragExceeded=o;function s(p,x){var w=p.contentRect;return x.clientX<w.left-e.DETACH_THRESHOLD||x.clientX>=w.right+e.DETACH_THRESHOLD||x.clientY<w.top-e.DETACH_THRESHOLD||x.clientY>=w.bottom+e.DETACH_THRESHOLD}e.detachExceeded=s;function c(p,x,w,E){var P,B,D,W;E==="horizontal"?(P=x.pressX,B=w.clientX-x.contentRect.left,D=w.clientX,W=x.contentRect.width):(P=x.pressY,B=w.clientY-x.contentRect.top,D=w.clientY,W=x.contentRect.height);for(var X=x.index,q=B-x.tabPressPos,$=q+x.tabSize,et=0,F=p.length;et<F;++et){var ut=void 0,ot=x.tabLayout[et],J=ot.pos+(ot.size>>1);if(et<x.index&&q<J)ut=x.tabSize+x.tabLayout[et+1].margin+"px",X=Math.min(X,et);else if(et>x.index&&$>J)ut=-x.tabSize-ot.margin+"px",X=Math.max(X,et);else if(et===x.index){var G=D-P,mt=W-(x.tabPos+x.tabSize);ut=Math.max(-x.tabPos,Math.min(G,mt))+"px"}else ut="";E==="horizontal"?p[et].style.left=ut:p[et].style.top=ut}x.targetIndex=X}e.layoutTabs=c;function l(p,x){var w;x==="horizontal"?w=p.contentRect.width:w=p.contentRect.height;var E;if(p.targetIndex===p.index)E=0;else if(p.targetIndex>p.index){var P=p.tabLayout[p.targetIndex];E=P.pos+P.size-p.tabSize-p.tabPos}else{var P=p.tabLayout[p.targetIndex];E=P.pos-p.tabPos}var B=w-(p.tabPos+p.tabSize),D=Math.max(-p.tabPos,Math.min(E,B));x==="horizontal"?p.tab.style.left=D+"px":p.tab.style.top=D+"px"}e.finalizeTabPosition=l;function h(p,x){yn(p,function(w){x==="horizontal"?w.style.left="":w.style.top=""})}e.resetTabPositions=h})(ah||(ah={}));var kzt=function(e){Ds(t,e);function t(r){var n=e.call(this)||this;return n._spacing=4,n._dirty=!1,n._root=null,n._box=null,n._items=new Map,n.renderer=r.renderer,r.spacing!==void 0&&(n._spacing=OT.clampDimension(r.spacing)),n._document=r.document||document,n._hiddenMode=r.hiddenMode!==void 0?r.hiddenMode:Mr.HiddenMode.Display,n}return t.prototype.dispose=function(){var r=this.iter();this._items.forEach(function(n){n.dispose()}),this._box=null,this._root=null,this._items.clear(),yn(r,function(n){n.dispose()}),e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"hiddenMode",{get:function(){return this._hiddenMode},set:function(r){var n=this;this._hiddenMode!==r&&(this._hiddenMode=r,yn(this.tabBars(),function(i){i.titles.length>1&&i.titles.forEach(function(o){o.owner.hiddenMode=n._hiddenMode})}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spacing",{get:function(){return this._spacing},set:function(r){r=OT.clampDimension(r),this._spacing!==r&&(this._spacing=r,this.parent&&this.parent.fit())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return this._root===null},enumerable:!0,configurable:!0}),t.prototype.iter=function(){return this._root?this._root.iterAllWidgets():_u()},t.prototype.widgets=function(){return this._root?this._root.iterUserWidgets():_u()},t.prototype.selectedWidgets=function(){return this._root?this._root.iterSelectedWidgets():_u()},t.prototype.tabBars=function(){return this._root?this._root.iterTabBars():_u()},t.prototype.handles=function(){return this._root?this._root.iterHandles():_u()},t.prototype.moveHandle=function(r,n,i){var o=r.classList.contains("lm-mod-hidden");if(o=o||r.classList.contains("p-mod-hidden"),!(!this._root||o)){var s=this._root.findSplitNode(r);if(s){var c;s.node.orientation==="horizontal"?c=n-r.offsetLeft:c=i-r.offsetTop,c!==0&&(s.node.holdSizes(),xu.adjust(s.node.sizers,s.index,c),this.parent&&this.parent.update())}}},t.prototype.saveLayout=function(){return this._root?(this._root.holdAllSizes(),{main:this._root.createConfig()}):{main:null}},t.prototype.restoreLayout=function(r){var n=this,i=new Set,o;r.main?o=Ma.normalizeAreaConfig(r.main,i):o=null;var s=this.widgets(),c=this.tabBars(),l=this.handles();this._root=null,yn(s,function(h){i.has(h)||(h.parent=null)}),yn(c,function(h){h.dispose()}),yn(l,function(h){h.parentNode&&h.parentNode.removeChild(h)}),i.forEach(function(h){h.parent=n.parent}),o?this._root=Ma.realizeAreaConfig(o,{createTabBar:function(h){return n._createTabBar()},createHandle:function(){return n._createHandle()}},this._document):this._root=null,this.parent&&(i.forEach(function(h){n.attachWidget(h)}),this.parent.fit())},t.prototype.addWidget=function(r,n){n===void 0&&(n={});var i=n.ref||null,o=n.mode||"tab-after",s=null;if(this._root&&i&&(s=this._root.findTabNode(i)),i&&!s)throw new Error("Reference widget is not in the layout.");switch(r.parent=this.parent,o){case"tab-after":this._insertTab(r,i,s,!0);break;case"tab-before":this._insertTab(r,i,s,!1);break;case"split-top":this._insertSplit(r,i,s,"vertical",!1);break;case"split-left":this._insertSplit(r,i,s,"horizontal",!1);break;case"split-right":this._insertSplit(r,i,s,"horizontal",!0);break;case"split-bottom":this._insertSplit(r,i,s,"vertical",!0);break}this.parent&&(this.attachWidget(r),this.parent.fit())},t.prototype.removeWidget=function(r){this._removeWidget(r),this.parent&&(this.detachWidget(r),this.parent.fit())},t.prototype.hitTestTabAreas=function(r,n){if(!this._root||!this.parent||!this.parent.isVisible)return null;this._box||(this._box=co.boxSizing(this.parent.node));var i=this.parent.node.getBoundingClientRect(),o=r-i.left-this._box.borderLeft,s=n-i.top-this._box.borderTop,c=this._root.hitTestTabNodes(o,s);if(!c)return null;var l=c.tabBar,h=c.top,p=c.left,x=c.width,w=c.height,E=this._box.borderLeft+this._box.borderRight,P=this._box.borderTop+this._box.borderBottom,B=i.width-E-(p+x),D=i.height-P-(h+w);return{tabBar:l,x:o,y:s,top:h,left:p,right:B,bottom:D,width:x,height:w}},t.prototype.init=function(){var r=this;e.prototype.init.call(this),yn(this,function(n){r.attachWidget(n)}),yn(this.handles(),function(n){r.parent.node.appendChild(n)}),this.parent.fit()},t.prototype.attachWidget=function(r){this.parent.node!==r.node.parentNode&&(this._items.set(r,new DT(r)),this.parent.isAttached&&mr.sendMessage(r,Mr.Msg.BeforeAttach),this.parent.node.appendChild(r.node),this.parent.isAttached&&mr.sendMessage(r,Mr.Msg.AfterAttach))},t.prototype.detachWidget=function(r){if(this.parent.node===r.node.parentNode){this.parent.isAttached&&mr.sendMessage(r,Mr.Msg.BeforeDetach),this.parent.node.removeChild(r.node),this.parent.isAttached&&mr.sendMessage(r,Mr.Msg.AfterDetach);var n=this._items.get(r);n&&(this._items.delete(r),n.dispose())}},t.prototype.onBeforeShow=function(r){e.prototype.onBeforeShow.call(this,r),this.parent.update()},t.prototype.onBeforeAttach=function(r){e.prototype.onBeforeAttach.call(this,r),this.parent.fit()},t.prototype.onChildShown=function(r){this.parent.fit()},t.prototype.onChildHidden=function(r){this.parent.fit()},t.prototype.onResize=function(r){this.parent.isVisible&&this._update(r.width,r.height)},t.prototype.onUpdateRequest=function(r){this.parent.isVisible&&this._update(-1,-1)},t.prototype.onFitRequest=function(r){this.parent.isAttached&&this._fit()},t.prototype._removeWidget=function(r){if(this._root){var n=this._root.findTabNode(r);if(n){if(Ma.removeAria(r),n.tabBar.titles.length>1){if(n.tabBar.removeTab(r.title),this._hiddenMode===Mr.HiddenMode.Scale&&n.tabBar.titles.length==1){var i=n.tabBar.titles[0].owner;i.hiddenMode=Mr.HiddenMode.Display}return}if(n.tabBar.dispose(),this._root===n){this._root=null;return}this._root.holdAllSizes();var o=n.parent;n.parent=null;var s=Ze.removeFirstOf(o.children,n),c=Ze.removeAt(o.handles,s);if(Ze.removeAt(o.sizers,s),c.parentNode&&c.parentNode.removeChild(c),o.children.length>1){o.syncHandles();return}var l=o.parent;o.parent=null;var h=o.children[0],p=o.handles[0];if(o.children.length=0,o.handles.length=0,o.sizers.length=0,p.parentNode&&p.parentNode.removeChild(p),this._root===o){h.parent=null,this._root=h;return}var x=l,w=x.children.indexOf(o);if(h instanceof Ma.TabLayoutNode){h.parent=x,x.children[w]=h;return}var E=Ze.removeAt(x.handles,w);Ze.removeAt(x.children,w),Ze.removeAt(x.sizers,w),E.parentNode&&E.parentNode.removeChild(E);for(var P=0,B=h.children.length;P<B;++P){var D=h.children[P],W=h.handles[P],X=h.sizers[P];Ze.insert(x.children,w+P,D),Ze.insert(x.handles,w+P,W),Ze.insert(x.sizers,w+P,X),D.parent=x}h.children.length=0,h.handles.length=0,h.sizers.length=0,h.parent=null,x.syncHandles()}}},t.prototype._insertTab=function(r,n,i,o){if(r!==n){if(!this._root){var s=new Ma.TabLayoutNode(this._createTabBar());s.tabBar.addTab(r.title),this._root=s,Ma.addAria(r,s.tabBar);return}i||(i=this._root.findFirstTabNode()),i.tabBar.titles.indexOf(r.title)===-1&&(this._removeWidget(r),r.hide());var c;if(n?c=i.tabBar.titles.indexOf(n.title):c=i.tabBar.currentIndex,this._hiddenMode===Mr.HiddenMode.Scale)if(i.tabBar.titles.length===0)r.hiddenMode=Mr.HiddenMode.Display;else if(i.tabBar.titles.length==1){var l=i.tabBar.titles[0].owner;l.hiddenMode=Mr.HiddenMode.Scale}else r.hiddenMode=Mr.HiddenMode.Scale;else r.hiddenMode=this._hiddenMode;i.tabBar.insertTab(c+(o?1:0),r.title),Ma.addAria(r,i.tabBar)}},t.prototype._insertSplit=function(r,n,i,o,s){if(!(r===n&&i&&i.tabBar.titles.length===1)){this._removeWidget(r);var c=new Ma.TabLayoutNode(this._createTabBar());if(c.tabBar.addTab(r.title),Ma.addAria(r,c.tabBar),!this._root){this._root=c;return}if(!i||!i.parent){var l=this._splitRoot(o),h=s?l.children.length:0;l.normalizeSizes();var p=Ma.createSizer(i?1:Ma.GOLDEN_RATIO);Ze.insert(l.children,h,c),Ze.insert(l.sizers,h,p),Ze.insert(l.handles,h,this._createHandle()),c.parent=l,l.normalizeSizes(),l.syncHandles();return}var x=i.parent;if(x.orientation===o){var w=x.children.indexOf(i);x.normalizeSizes();var E=x.sizers[w].sizeHint/=2,P=w+(s?1:0);Ze.insert(x.children,P,c),Ze.insert(x.sizers,P,Ma.createSizer(E)),Ze.insert(x.handles,P,this._createHandle()),c.parent=x,x.syncHandles();return}var B=Ze.removeFirstOf(x.children,i),D=new Ma.SplitLayoutNode(o);D.normalized=!0,D.children.push(i),D.sizers.push(Ma.createSizer(.5)),D.handles.push(this._createHandle()),i.parent=D;var W=s?1:0;Ze.insert(D.children,W,c),Ze.insert(D.sizers,W,Ma.createSizer(.5)),Ze.insert(D.handles,W,this._createHandle()),c.parent=D,D.syncHandles(),Ze.insert(x.children,B,D),D.parent=x}},t.prototype._splitRoot=function(r){var n=this._root;if(n instanceof Ma.SplitLayoutNode&&n.orientation===r)return n;var i=this._root=new Ma.SplitLayoutNode(r);return n&&(i.children.push(n),i.sizers.push(Ma.createSizer(0)),i.handles.push(this._createHandle()),n.parent=i),i},t.prototype._fit=function(){var r=0,n=0;if(this._root){var i=this._root.fit(this._spacing,this._items);r=i.minWidth,n=i.minHeight}var o=this._box=co.boxSizing(this.parent.node);r+=o.horizontalSum,n+=o.verticalSum;var s=this.parent.node.style;s.minWidth=r+"px",s.minHeight=n+"px",this._dirty=!0,this.parent.parent&&mr.sendMessage(this.parent.parent,Mr.Msg.FitRequest),this._dirty&&mr.sendMessage(this.parent,Mr.Msg.UpdateRequest)},t.prototype._update=function(r,n){if(this._dirty=!1,!!this._root){r<0&&(r=this.parent.node.offsetWidth),n<0&&(n=this.parent.node.offsetHeight),this._box||(this._box=co.boxSizing(this.parent.node));var i=this._box.paddingTop,o=this._box.paddingLeft,s=r-this._box.horizontalSum,c=n-this._box.verticalSum;this._root.update(i,o,s,c,this._spacing,this._items)}},t.prototype._createTabBar=function(){var r=this.renderer.createTabBar(this._document);return r.orientation="horizontal",this.parent&&(r.parent=this.parent,this.attachWidget(r)),r},t.prototype._createHandle=function(){var r=this.renderer.createHandle(),n=r.style;return n.position="absolute",n.top="0",n.left="0",n.width="0",n.height="0",this.parent&&this.parent.node.appendChild(r),r},t}(AA),Ma;(function(e){e.GOLDEN_RATIO=.618;function t(w){var E=new mA;return E.sizeHint=w,E.size=w,E}e.createSizer=t;function r(w,E){var P;return w.type==="tab-area"?P=l(w,E):P=h(w,E),P}e.normalizeAreaConfig=r;function n(w,E,P){var B;return w.type==="tab-area"?B=p(w,E,P):B=x(w,E,P),B}e.realizeAreaConfig=n;var i=function(){function w(E){this.parent=null,this._top=0,this._left=0,this._width=0,this._height=0;var P=new mA,B=new mA;P.stretch=0,B.stretch=1,this.tabBar=E,this.sizers=[P,B]}return Object.defineProperty(w.prototype,"top",{get:function(){return this._top},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"left",{get:function(){return this._left},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),w.prototype.iterAllWidgets=function(){return p8(RT(this.tabBar),this.iterUserWidgets())},w.prototype.iterUserWidgets=function(){return hA(this.tabBar.titles,function(E){return E.owner})},w.prototype.iterSelectedWidgets=function(){var E=this.tabBar.currentTitle;return E?RT(E.owner):_u()},w.prototype.iterTabBars=function(){return RT(this.tabBar)},w.prototype.iterHandles=function(){return _u()},w.prototype.findTabNode=function(E){return this.tabBar.titles.indexOf(E.title)!==-1?this:null},w.prototype.findSplitNode=function(E){return null},w.prototype.findFirstTabNode=function(){return this},w.prototype.hitTestTabNodes=function(E,P){return E<this._left||E>=this._left+this._width||P<this._top||P>=this._top+this._height?null:this},w.prototype.createConfig=function(){var E=this.tabBar.titles.map(function(B){return B.owner}),P=this.tabBar.currentIndex;return{type:"tab-area",widgets:E,currentIndex:P}},w.prototype.holdAllSizes=function(){},w.prototype.fit=function(E,P){var B=0,D=0,W=1/0,X=1/0,q=P.get(this.tabBar),$=this.tabBar.currentTitle,et=$?P.get($.owner):void 0,F=this.sizers,ut=F[0],ot=F[1];return q&&q.fit(),et&&et.fit(),q&&!q.isHidden?(B=Math.max(B,q.minWidth),D+=q.minHeight,ut.minSize=q.minHeight,ut.maxSize=q.maxHeight):(ut.minSize=0,ut.maxSize=0),et&&!et.isHidden?(B=Math.max(B,et.minWidth),D+=et.minHeight,ot.minSize=et.minHeight,ot.maxSize=1/0):(ot.minSize=0,ot.maxSize=1/0),{minWidth:B,minHeight:D,maxWidth:W,maxHeight:X}},w.prototype.update=function(E,P,B,D,W,X){this._top=P,this._left=E,this._width=B,this._height=D;var q=X.get(this.tabBar),$=this.tabBar.currentTitle,et=$?X.get($.owner):void 0;if(xu.calc(this.sizers,D),q&&!q.isHidden){var F=this.sizers[0].size;q.update(E,P,B,F),P+=F}if(et&&!et.isHidden){var F=this.sizers[1].size;et.update(E,P,B,F)}},w}();e.TabLayoutNode=i;var o=function(){function w(E){this.parent=null,this.normalized=!1,this.children=[],this.sizers=[],this.handles=[],this.orientation=E}return w.prototype.iterAllWidgets=function(){var E=hA(this.children,function(P){return P.iterAllWidgets()});return new Pg(E)},w.prototype.iterUserWidgets=function(){var E=hA(this.children,function(P){return P.iterUserWidgets()});return new Pg(E)},w.prototype.iterSelectedWidgets=function(){var E=hA(this.children,function(P){return P.iterSelectedWidgets()});return new Pg(E)},w.prototype.iterTabBars=function(){var E=hA(this.children,function(P){return P.iterTabBars()});return new Pg(E)},w.prototype.iterHandles=function(){var E=hA(this.children,function(P){return P.iterHandles()});return p8(this.handles,new Pg(E))},w.prototype.findTabNode=function(E){for(var P=0,B=this.children.length;P<B;++P){var D=this.children[P].findTabNode(E);if(D)return D}return null},w.prototype.findSplitNode=function(E){var P=this.handles.indexOf(E);if(P!==-1)return{index:P,node:this};for(var B=0,D=this.children.length;B<D;++B){var W=this.children[B].findSplitNode(E);if(W)return W}return null},w.prototype.findFirstTabNode=function(){return this.children.length===0?null:this.children[0].findFirstTabNode()},w.prototype.hitTestTabNodes=function(E,P){for(var B=0,D=this.children.length;B<D;++B){var W=this.children[B].hitTestTabNodes(E,P);if(W)return W}return null},w.prototype.createConfig=function(){var E=this.orientation,P=this.createNormalizedSizes(),B=this.children.map(function(D){return D.createConfig()});return{type:"split-area",orientation:E,children:B,sizes:P}},w.prototype.syncHandles=function(){var E=this;yn(this.handles,function(P,B){P.setAttribute("data-orientation",E.orientation),B===E.handles.length-1?(P.classList.add("lm-mod-hidden"),P.classList.add("p-mod-hidden")):(P.classList.remove("lm-mod-hidden"),P.classList.remove("p-mod-hidden"))})},w.prototype.holdSizes=function(){yn(this.sizers,function(E){E.sizeHint=E.size})},w.prototype.holdAllSizes=function(){yn(this.children,function(E){return E.holdAllSizes()}),this.holdSizes()},w.prototype.normalizeSizes=function(){var E=this.sizers.length;if(E!==0){this.holdSizes();var P=d8(this.sizers,function(B,D){return B+D.sizeHint},0);P===0?yn(this.sizers,function(B){B.size=B.sizeHint=1/E}):yn(this.sizers,function(B){B.size=B.sizeHint/=P}),this.normalized=!0}},w.prototype.createNormalizedSizes=function(){var E=this.sizers.length;if(E===0)return[];var P=this.sizers.map(function(D){return D.size}),B=d8(P,function(D,W){return D+W},0);return B===0?yn(P,function(D,W){P[W]=1/E}):yn(P,function(D,W){P[W]=D/B}),P},w.prototype.fit=function(E,P){for(var B=this.orientation==="horizontal",D=Math.max(0,this.children.length-1)*E,W=B?D:0,X=B?0:D,q=1/0,$=1/0,et=0,F=this.children.length;et<F;++et){var ut=this.children[et].fit(E,P);B?(X=Math.max(X,ut.minHeight),W+=ut.minWidth,this.sizers[et].minSize=ut.minWidth):(W=Math.max(W,ut.minWidth),X+=ut.minHeight,this.sizers[et].minSize=ut.minHeight)}return{minWidth:W,minHeight:X,maxWidth:q,maxHeight:$}},w.prototype.update=function(E,P,B,D,W,X){var q=this.orientation==="horizontal",$=Math.max(0,this.children.length-1)*W,et=Math.max(0,(q?B:D)-$);this.normalized&&(yn(this.sizers,function(mt){mt.sizeHint*=et}),this.normalized=!1),xu.calc(this.sizers,et);for(var F=0,ut=this.children.length;F<ut;++F){var ot=this.children[F],J=this.sizers[F].size,G=this.handles[F].style;q?(ot.update(E,P,J,D,W,X),E+=J,G.top=P+"px",G.left=E+"px",G.width=W+"px",G.height=D+"px",E+=W):(ot.update(E,P,B,J,W,X),P+=J,G.top=P+"px",G.left=E+"px",G.width=B+"px",G.height=W+"px",P+=W)}},w}();e.SplitLayoutNode=o;function s(w,E){w.node.setAttribute("role","tabpanel");var P=E.renderer;if(P instanceof Mx.Renderer){var B=P.createTabKey({title:w.title,current:!1,zIndex:0});w.node.setAttribute("aria-labelledby",B)}}e.addAria=s;function c(w){w.node.removeAttribute("role"),w.node.removeAttribute("aria-labelledby")}e.removeAria=c;function l(w,E){if(w.widgets.length===0)return null;var P=[];if(yn(w.widgets,function(D){E.has(D)||(E.add(D),P.push(D))}),P.length===0)return null;var B=w.currentIndex;return B!==-1&&(B<0||B>=P.length)&&(B=0),{type:"tab-area",widgets:P,currentIndex:B}}function h(w,E){for(var P=w.orientation,B=[],D=[],W=0,X=w.children.length;W<X;++W){var q=r(w.children[W],E);q&&(q.type==="tab-area"||q.orientation!==P?(B.push(q),D.push(Math.abs(w.sizes[W]||0))):(B.push.apply(B,q.children),D.push.apply(D,q.sizes)))}return B.length===0?null:B.length===1?B[0]:{type:"split-area",orientation:P,children:B,sizes:D}}function p(w,E,P){var B=E.createTabBar(P);return yn(w.widgets,function(D){D.hide(),B.addTab(D.title),e.addAria(D,B)}),B.currentIndex=w.currentIndex,new i(B)}function x(w,E,P){var B=new o(w.orientation);return yn(w.children,function(D,W){var X=n(D,E,P),q=t(w.sizes[W]),$=E.createHandle();B.children.push(X),B.handles.push($),B.sizers.push(q),X.parent=B}),B.syncHandles(),B.normalizeSizes(),B}})(Ma||(Ma={}));var hht=function(e){Ds(t,e);function t(r){r===void 0&&(r={});var n=e.call(this)||this;n._drag=null,n._tabsMovable=!0,n._tabsConstrained=!1,n._addButtonEnabled=!1,n._pressData=null,n._layoutModified=new Di(n),n._addRequested=new Di(n),n.addClass("lm-DockPanel"),n.addClass("p-DockPanel"),n._document=r.document||document,n._mode=r.mode||"multiple-document",n._renderer=r.renderer||t.defaultRenderer,n._edges=r.edges||Ks.DEFAULT_EDGES,r.tabsMovable!==void 0&&(n._tabsMovable=r.tabsMovable),r.tabsConstrained!==void 0&&(n._tabsConstrained=r.tabsConstrained),r.addButtonEnabled!==void 0&&(n._addButtonEnabled=r.addButtonEnabled),n.dataset.mode=n._mode;var i={createTabBar:function(){return n._createTabBar()},createHandle:function(){return n._createHandle()}};return n.layout=new kzt({document:n._document,renderer:i,spacing:r.spacing,hiddenMode:r.hiddenMode}),n.overlay=r.overlay||new t.Overlay,n.node.appendChild(n.overlay.node),n}return t.prototype.dispose=function(){this._releaseMouse(),this.overlay.hide(0),this._drag&&this._drag.dispose(),e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"hiddenMode",{get:function(){return this.layout.hiddenMode},set:function(r){this.layout.hiddenMode=r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layoutModified",{get:function(){return this._layoutModified},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"addRequested",{get:function(){return this._addRequested},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{get:function(){return this.layout.renderer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spacing",{get:function(){return this.layout.spacing},set:function(r){this.layout.spacing=r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mode",{get:function(){return this._mode},set:function(r){if(this._mode!==r){this._mode=r,this.dataset.mode=r;var n=this.layout;switch(r){case"multiple-document":yn(n.tabBars(),function(i){i.show()});break;case"single-document":n.restoreLayout(Ks.createSingleDocumentConfig(this));break;default:throw"unreachable"}mr.postMessage(this,Ks.LayoutModified)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tabsMovable",{get:function(){return this._tabsMovable},set:function(r){this._tabsMovable=r,yn(this.tabBars(),function(n){n.tabsMovable=r})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tabsConstrained",{get:function(){return this._tabsConstrained},set:function(r){this._tabsConstrained=r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"addButtonEnabled",{get:function(){return this._addButtonEnabled},set:function(r){this._addButtonEnabled=r,yn(this.tabBars(),function(n){n.addButtonEnabled=r})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return this.layout.isEmpty},enumerable:!0,configurable:!0}),t.prototype.widgets=function(){return this.layout.widgets()},t.prototype.selectedWidgets=function(){return this.layout.selectedWidgets()},t.prototype.tabBars=function(){return this.layout.tabBars()},t.prototype.handles=function(){return this.layout.handles()},t.prototype.selectWidget=function(r){var n=yx(this.tabBars(),function(i){return i.titles.indexOf(r.title)!==-1});if(!n)throw new Error("Widget is not contained in the dock panel.");n.currentTitle=r.title},t.prototype.activateWidget=function(r){this.selectWidget(r),r.activate()},t.prototype.saveLayout=function(){return this.layout.saveLayout()},t.prototype.restoreLayout=function(r){this._mode="multiple-document",this.layout.restoreLayout(r),(lc.IS_EDGE||lc.IS_IE)&&mr.flush(),mr.postMessage(this,Ks.LayoutModified)},t.prototype.addWidget=function(r,n){n===void 0&&(n={}),this._mode==="single-document"?this.layout.addWidget(r):this.layout.addWidget(r,n),mr.postMessage(this,Ks.LayoutModified)},t.prototype.processMessage=function(r){r.type==="layout-modified"?this._layoutModified.emit(void 0):e.prototype.processMessage.call(this,r)},t.prototype.handleEvent=function(r){switch(r.type){case"lm-dragenter":this._evtDragEnter(r);break;case"lm-dragleave":this._evtDragLeave(r);break;case"lm-dragover":this._evtDragOver(r);break;case"lm-drop":this._evtDrop(r);break;case"mousedown":this._evtMouseDown(r);break;case"mousemove":this._evtMouseMove(r);break;case"mouseup":this._evtMouseUp(r);break;case"pointerdown":this._evtMouseDown(r);break;case"pointermove":this._evtMouseMove(r);break;case"pointerup":this._evtMouseUp(r);break;case"keydown":this._evtKeyDown(r);break;case"contextmenu":r.preventDefault(),r.stopPropagation();break}},t.prototype.onBeforeAttach=function(r){this.node.addEventListener("lm-dragenter",this),this.node.addEventListener("lm-dragleave",this),this.node.addEventListener("lm-dragover",this),this.node.addEventListener("lm-drop",this),this.node.addEventListener("mousedown",this),this.node.addEventListener("pointerdown",this)},t.prototype.onAfterDetach=function(r){this.node.removeEventListener("lm-dragenter",this),this.node.removeEventListener("lm-dragleave",this),this.node.removeEventListener("lm-dragover",this),this.node.removeEventListener("lm-drop",this),this.node.removeEventListener("mousedown",this),this.node.removeEventListener("pointerdown",this),this._releaseMouse()},t.prototype.onChildAdded=function(r){Ks.isGeneratedTabBarProperty.get(r.child)||(r.child.addClass("lm-DockPanel-widget"),r.child.addClass("p-DockPanel-widget"))},t.prototype.onChildRemoved=function(r){Ks.isGeneratedTabBarProperty.get(r.child)||(r.child.removeClass("lm-DockPanel-widget"),r.child.removeClass("p-DockPanel-widget"),mr.postMessage(this,Ks.LayoutModified))},t.prototype._evtDragEnter=function(r){r.mimeData.hasData("application/vnd.lumino.widget-factory")&&(r.preventDefault(),r.stopPropagation())},t.prototype._evtDragLeave=function(r){r.preventDefault(),!(this._tabsConstrained&&r.source!==this)&&(r.stopPropagation(),this.overlay.hide(1))},t.prototype._evtDragOver=function(r){r.preventDefault(),this._tabsConstrained&&r.source!==this||this._showOverlay(r.clientX,r.clientY)==="invalid"?r.dropAction="none":(r.stopPropagation(),r.dropAction=r.proposedAction)},t.prototype._evtDrop=function(r){if(r.preventDefault(),this.overlay.hide(0),r.proposedAction==="none"){r.dropAction="none";return}var n=r.clientX,i=r.clientY,o=Ks.findDropTarget(this,n,i,this._edges),s=o.zone,c=o.target;if(this._tabsConstrained&&r.source!==this||s==="invalid"){r.dropAction="none";return}var l=r.mimeData,h=l.getData("application/vnd.lumino.widget-factory");if(typeof h!="function"){r.dropAction="none";return}var p=h();if(!(p instanceof Mr)){r.dropAction="none";return}if(p.contains(this)){r.dropAction="none";return}var x=c?Ks.getDropRef(c.tabBar):null;switch(s){case"root-all":this.addWidget(p);break;case"root-top":this.addWidget(p,{mode:"split-top"});break;case"root-left":this.addWidget(p,{mode:"split-left"});break;case"root-right":this.addWidget(p,{mode:"split-right"});break;case"root-bottom":this.addWidget(p,{mode:"split-bottom"});break;case"widget-all":this.addWidget(p,{mode:"tab-after",ref:x});break;case"widget-top":this.addWidget(p,{mode:"split-top",ref:x});break;case"widget-left":this.addWidget(p,{mode:"split-left",ref:x});break;case"widget-right":this.addWidget(p,{mode:"split-right",ref:x});break;case"widget-bottom":this.addWidget(p,{mode:"split-bottom",ref:x});break;case"widget-tab":this.addWidget(p,{mode:"tab-after",ref:x});break;default:throw"unreachable"}r.dropAction=r.proposedAction,r.stopPropagation(),this.activateWidget(p)},t.prototype._evtKeyDown=function(r){r.preventDefault(),r.stopPropagation(),r.keyCode===27&&(this._releaseMouse(),mr.postMessage(this,Ks.LayoutModified))},t.prototype._evtMouseDown=function(r){if(r.button===0){var n=this.layout,i=r.target,o=yx(n.handles(),function(x){return x.contains(i)});if(o){r.preventDefault(),r.stopPropagation(),this._document.addEventListener("keydown",this,!0),this._document.addEventListener("mouseup",this,!0),this._document.addEventListener("mousemove",this,!0),this._document.addEventListener("pointerup",this,!0),this._document.addEventListener("pointermove",this,!0),this._document.addEventListener("contextmenu",this,!0);var s=o.getBoundingClientRect(),c=r.clientX-s.left,l=r.clientY-s.top,h=window.getComputedStyle(o),p=pA.overrideCursor(h.cursor,this._document);this._pressData={handle:o,deltaX:c,deltaY:l,override:p}}}},t.prototype._evtMouseMove=function(r){if(this._pressData){r.preventDefault(),r.stopPropagation();var n=this.node.getBoundingClientRect(),i=r.clientX-n.left-this._pressData.deltaX,o=r.clientY-n.top-this._pressData.deltaY,s=this.layout;s.moveHandle(this._pressData.handle,i,o)}},t.prototype._evtMouseUp=function(r){r.button===0&&(r.preventDefault(),r.stopPropagation(),this._releaseMouse(),mr.postMessage(this,Ks.LayoutModified))},t.prototype._releaseMouse=function(){this._pressData&&(this._pressData.override.dispose(),this._pressData=null,this._document.removeEventListener("keydown",this,!0),this._document.removeEventListener("mouseup",this,!0),this._document.removeEventListener("mousemove",this,!0),this._document.removeEventListener("pointerup",this,!0),this._document.removeEventListener("pointermove",this,!0),this._document.removeEventListener("contextmenu",this,!0))},t.prototype._showOverlay=function(r,n){var i=Ks.findDropTarget(this,r,n,this._edges),o=i.zone,s=i.target;if(o==="invalid")return this.overlay.hide(100),o;var c,l,h,p,x=co.boxSizing(this.node),w=this.node.getBoundingClientRect();switch(o){case"root-all":c=x.paddingTop,l=x.paddingLeft,h=x.paddingRight,p=x.paddingBottom;break;case"root-top":c=x.paddingTop,l=x.paddingLeft,h=x.paddingRight,p=w.height*Ks.GOLDEN_RATIO;break;case"root-left":c=x.paddingTop,l=x.paddingLeft,h=w.width*Ks.GOLDEN_RATIO,p=x.paddingBottom;break;case"root-right":c=x.paddingTop,l=w.width*Ks.GOLDEN_RATIO,h=x.paddingRight,p=x.paddingBottom;break;case"root-bottom":c=w.height*Ks.GOLDEN_RATIO,l=x.paddingLeft,h=x.paddingRight,p=x.paddingBottom;break;case"widget-all":c=s.top,l=s.left,h=s.right,p=s.bottom;break;case"widget-top":c=s.top,l=s.left,h=s.right,p=s.bottom+s.height/2;break;case"widget-left":c=s.top,l=s.left,h=s.right+s.width/2,p=s.bottom;break;case"widget-right":c=s.top,l=s.left+s.width/2,h=s.right,p=s.bottom;break;case"widget-bottom":c=s.top+s.height/2,l=s.left,h=s.right,p=s.bottom;break;case"widget-tab":var E=s.tabBar.node.getBoundingClientRect().height;c=s.top,l=s.left,h=s.right,p=s.bottom+s.height-E;break;default:throw"unreachable"}return this.overlay.show({top:c,left:l,right:h,bottom:p}),o},t.prototype._createTabBar=function(){var r=this._renderer.createTabBar(this._document);return Ks.isGeneratedTabBarProperty.set(r,!0),this._mode==="single-document"&&r.hide(),r.tabsMovable=this._tabsMovable,r.allowDeselect=!1,r.addButtonEnabled=this._addButtonEnabled,r.removeBehavior="select-previous-tab",r.insertBehavior="select-tab-if-needed",r.tabMoved.connect(this._onTabMoved,this),r.currentChanged.connect(this._onCurrentChanged,this),r.tabCloseRequested.connect(this._onTabCloseRequested,this),r.tabDetachRequested.connect(this._onTabDetachRequested,this),r.tabActivateRequested.connect(this._onTabActivateRequested,this),r.addRequested.connect(this._onTabAddRequested,this),r},t.prototype._createHandle=function(){return this._renderer.createHandle()},t.prototype._onTabMoved=function(){mr.postMessage(this,Ks.LayoutModified)},t.prototype._onCurrentChanged=function(r,n){var i=n.previousTitle,o=n.currentTitle;i&&i.owner.hide(),o&&o.owner.show(),(lc.IS_EDGE||lc.IS_IE)&&mr.flush(),mr.postMessage(this,Ks.LayoutModified)},t.prototype._onTabAddRequested=function(r){this._addRequested.emit(r)},t.prototype._onTabActivateRequested=function(r,n){n.title.owner.activate()},t.prototype._onTabCloseRequested=function(r,n){n.title.owner.close()},t.prototype._onTabDetachRequested=function(r,n){var i=this;if(!this._drag){r.releaseMouse();var o=n.title,s=n.tab,c=n.clientX,l=n.clientY,h=new Og.MimeData,p=function(){return o.owner};h.setData("application/vnd.lumino.widget-factory",p);var x=s.cloneNode(!0);this._drag=new pA({document:this._document,mimeData:h,dragImage:x,proposedAction:"move",supportedActions:"move",source:this}),s.classList.add("lm-mod-hidden"),s.classList.add("p-mod-hidden");var w=function(){i._drag=null,s.classList.remove("lm-mod-hidden"),s.classList.remove("p-mod-hidden")};this._drag.start(c,l).then(w)}},t}(Mr);(function(e){var t=function(){function n(){this._timer=-1,this._hidden=!0,this.node=document.createElement("div"),this.node.classList.add("lm-DockPanel-overlay"),this.node.classList.add("lm-mod-hidden"),this.node.classList.add("p-DockPanel-overlay"),this.node.classList.add("p-mod-hidden"),this.node.style.position="absolute"}return n.prototype.show=function(i){var o=this.node.style;o.top=i.top+"px",o.left=i.left+"px",o.right=i.right+"px",o.bottom=i.bottom+"px",clearTimeout(this._timer),this._timer=-1,this._hidden&&(this._hidden=!1,this.node.classList.remove("lm-mod-hidden"),this.node.classList.remove("p-mod-hidden"))},n.prototype.hide=function(i){var o=this;if(!this._hidden){if(i<=0){clearTimeout(this._timer),this._timer=-1,this._hidden=!0,this.node.classList.add("lm-mod-hidden"),this.node.classList.add("p-mod-hidden");return}this._timer===-1&&(this._timer=window.setTimeout(function(){o._timer=-1,o._hidden=!0,o.node.classList.add("lm-mod-hidden"),o.node.classList.add("p-mod-hidden")},i))}},n}();e.Overlay=t;var r=function(){function n(){}return n.prototype.createTabBar=function(i){var o=new Mx({document:i});return o.addClass("lm-DockPanel-tabBar"),o.addClass("p-DockPanel-tabBar"),o},n.prototype.createHandle=function(){var i=document.createElement("div");return i.className="lm-DockPanel-handle",i.classList.add("p-DockPanel-handle"),i},n}();e.Renderer=r,e.defaultRenderer=new r})(hht||(hht={}));var Ks;(function(e){e.GOLDEN_RATIO=.618,e.DEFAULT_EDGES={top:12,right:40,bottom:40,left:40},e.LayoutModified=new xx("layout-modified"),e.isGeneratedTabBarProperty=new xl({name:"isGeneratedTabBar",create:function(){return!1}});function t(i){if(i.isEmpty)return{main:null};var o=eht(i.widgets()),s=i.selectedWidgets().next(),c=s?o.indexOf(s):-1;return{main:{type:"tab-area",widgets:o,currentIndex:c}}}e.createSingleDocumentConfig=t;function r(i,o,s,c){if(!co.hitTest(i.node,o,s))return{zone:"invalid",target:null};var l=i.layout;if(l.isEmpty)return{zone:"root-all",target:null};if(i.mode==="multiple-document"){var h=i.node.getBoundingClientRect(),p=o-h.left+1,x=s-h.top+1,w=h.right-o,E=h.bottom-s,P=Math.min(x,w,E,p);switch(P){case x:if(x<c.top)return{zone:"root-top",target:null};break;case w:if(w<c.right)return{zone:"root-right",target:null};break;case E:if(E<c.bottom)return{zone:"root-bottom",target:null};break;case p:if(p<c.left)return{zone:"root-left",target:null};break;default:throw"unreachable"}}var B=l.hitTestTabAreas(o,s);if(!B)return{zone:"invalid",target:null};if(i.mode==="single-document")return{zone:"widget-all",target:B};var D=B.x-B.left+1,W=B.y-B.top+1,X=B.left+B.width-B.x,q=B.top+B.height-B.y,$=B.tabBar.node.getBoundingClientRect().height;if(W<$)return{zone:"widget-tab",target:B};var et=Math.round(B.width/3),F=Math.round(B.height/3);if(D>et&&X>et&&W>F&&q>F)return{zone:"widget-all",target:B};D/=et,W/=F,X/=et,q/=F;var ut=Math.min(D,W,X,q),ot;switch(ut){case D:ot="widget-left";break;case W:ot="widget-top";break;case X:ot="widget-right";break;case q:ot="widget-bottom";break;default:throw"unreachable"}return{zone:ot,target:B}}e.findDropTarget=r;function n(i){return i.titles.length===0?null:i.currentTitle?i.currentTitle.owner:i.titles[i.titles.length-1].owner}e.getDropRef=n})(Ks||(Ks={}));var qWe=function(){function e(){this._counter=0,this._widgets=[],this._activeWidget=null,this._currentWidget=null,this._numbers=new Map,this._nodes=new Map,this._activeChanged=new Di(this),this._currentChanged=new Di(this)}return e.prototype.dispose=function(){var t=this;this._counter<0||(this._counter=-1,Di.clearData(this),yn(this._widgets,function(r){r.node.removeEventListener("focus",t,!0),r.node.removeEventListener("blur",t,!0)}),this._activeWidget=null,this._currentWidget=null,this._nodes.clear(),this._numbers.clear(),this._widgets.length=0)},Object.defineProperty(e.prototype,"currentChanged",{get:function(){return this._currentChanged},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeChanged",{get:function(){return this._activeChanged},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._counter<0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentWidget",{get:function(){return this._currentWidget},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeWidget",{get:function(){return this._activeWidget},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"widgets",{get:function(){return this._widgets},enumerable:!0,configurable:!0}),e.prototype.focusNumber=function(t){var r=this._numbers.get(t);return r===void 0?-1:r},e.prototype.has=function(t){return this._numbers.has(t)},e.prototype.add=function(t){if(!this._numbers.has(t)){var r=t.node.contains(document.activeElement),n=r?this._counter++:-1;this._widgets.push(t),this._numbers.set(t,n),this._nodes.set(t.node,t),t.node.addEventListener("focus",this,!0),t.node.addEventListener("blur",this,!0),t.disposed.connect(this._onWidgetDisposed,this),r&&this._setWidgets(t,t)}},e.prototype.remove=function(t){var r=this;if(this._numbers.has(t)&&(t.disposed.disconnect(this._onWidgetDisposed,this),t.node.removeEventListener("focus",this,!0),t.node.removeEventListener("blur",this,!0),Ze.removeFirstOf(this._widgets,t),this._nodes.delete(t.node),this._numbers.delete(t),this._currentWidget===t)){var n=rht(this._widgets,function(o){return r._numbers.get(o)!==-1}),i=nht(n,function(o,s){var c=r._numbers.get(o),l=r._numbers.get(s);return c-l})||null;this._setWidgets(i,null)}},e.prototype.handleEvent=function(t){switch(t.type){case"focus":this._evtFocus(t);break;case"blur":this._evtBlur(t);break}},e.prototype._setWidgets=function(t,r){var n=this._currentWidget;this._currentWidget=t;var i=this._activeWidget;this._activeWidget=r,n!==t&&this._currentChanged.emit({oldValue:n,newValue:t}),i!==r&&this._activeChanged.emit({oldValue:i,newValue:r})},e.prototype._evtFocus=function(t){var r=this._nodes.get(t.currentTarget);r!==this._currentWidget&&this._numbers.set(r,this._counter++),this._setWidgets(r,r)},e.prototype._evtBlur=function(t){var r=this._nodes.get(t.currentTarget),n=t.relatedTarget;if(!n){this._setWidgets(this._currentWidget,null);return}if(!r.node.contains(n)&&!yx(this._widgets,function(i){return i.node.contains(n)})){this._setWidgets(this._currentWidget,null);return}},e.prototype._onWidgetDisposed=function(t){this.remove(t)},e}(),P8=function(e){Ds(t,e);function t(r){r===void 0&&(r={});var n=e.call(this,r)||this;return n._dirty=!1,n._rowSpacing=4,n._columnSpacing=4,n._items=[],n._rowStarts=[],n._columnStarts=[],n._rowSizers=[new mA],n._columnSizers=[new mA],n._box=null,r.rowCount!==void 0&&ja.reallocSizers(n._rowSizers,r.rowCount),r.columnCount!==void 0&&ja.reallocSizers(n._columnSizers,r.columnCount),r.rowSpacing!==void 0&&(n._rowSpacing=ja.clampValue(r.rowSpacing)),r.columnSpacing!==void 0&&(n._columnSpacing=ja.clampValue(r.columnSpacing)),n}return t.prototype.dispose=function(){yn(this._items,function(r){var n=r.widget;r.dispose(),n.dispose()}),this._box=null,this._items.length=0,this._rowStarts.length=0,this._rowSizers.length=0,this._columnStarts.length=0,this._columnSizers.length=0,e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"rowCount",{get:function(){return this._rowSizers.length},set:function(r){r!==this.rowCount&&(ja.reallocSizers(this._rowSizers,r),this.parent&&this.parent.fit())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnCount",{get:function(){return this._columnSizers.length},set:function(r){r!==this.columnCount&&(ja.reallocSizers(this._columnSizers,r),this.parent&&this.parent.fit())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowSpacing",{get:function(){return this._rowSpacing},set:function(r){r=ja.clampValue(r),this._rowSpacing!==r&&(this._rowSpacing=r,this.parent&&this.parent.fit())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnSpacing",{get:function(){return this._columnSpacing},set:function(r){r=ja.clampValue(r),this._columnSpacing!==r&&(this._columnSpacing=r,this.parent&&this.parent.fit())},enumerable:!0,configurable:!0}),t.prototype.rowStretch=function(r){var n=this._rowSizers[r];return n?n.stretch:-1},t.prototype.setRowStretch=function(r,n){var i=this._rowSizers[r];i&&(n=ja.clampValue(n),i.stretch!==n&&(i.stretch=n,this.parent&&this.parent.update()))},t.prototype.columnStretch=function(r){var n=this._columnSizers[r];return n?n.stretch:-1},t.prototype.setColumnStretch=function(r,n){var i=this._columnSizers[r];i&&(n=ja.clampValue(n),i.stretch!==n&&(i.stretch=n,this.parent&&this.parent.update()))},t.prototype.iter=function(){return hA(this._items,function(r){return r.widget})},t.prototype.addWidget=function(r){var n=Ze.findFirstIndex(this._items,function(i){return i.widget===r});n===-1&&(this._items.push(new DT(r)),this.parent&&this.attachWidget(r))},t.prototype.removeWidget=function(r){var n=Ze.findFirstIndex(this._items,function(o){return o.widget===r});if(n!==-1){var i=Ze.removeAt(this._items,n);this.parent&&this.detachWidget(r),i.dispose()}},t.prototype.init=function(){var r=this;e.prototype.init.call(this),yn(this,function(n){r.attachWidget(n)})},t.prototype.attachWidget=function(r){this.parent.isAttached&&mr.sendMessage(r,Mr.Msg.BeforeAttach),this.parent.node.appendChild(r.node),this.parent.isAttached&&mr.sendMessage(r,Mr.Msg.AfterAttach),this.parent.fit()},t.prototype.detachWidget=function(r){this.parent.isAttached&&mr.sendMessage(r,Mr.Msg.BeforeDetach),this.parent.node.removeChild(r.node),this.parent.isAttached&&mr.sendMessage(r,Mr.Msg.AfterDetach),this.parent.fit()},t.prototype.onBeforeShow=function(r){e.prototype.onBeforeShow.call(this,r),this.parent.update()},t.prototype.onBeforeAttach=function(r){e.prototype.onBeforeAttach.call(this,r),this.parent.fit()},t.prototype.onChildShown=function(r){this.parent.fit()},t.prototype.onChildHidden=function(r){this.parent.fit()},t.prototype.onResize=function(r){this.parent.isVisible&&this._update(r.width,r.height)},t.prototype.onUpdateRequest=function(r){this.parent.isVisible&&this._update(-1,-1)},t.prototype.onFitRequest=function(r){this.parent.isAttached&&this._fit()},t.prototype._fit=function(){for(var r=0,n=this.rowCount;r<n;++r)this._rowSizers[r].minSize=0;for(var r=0,n=this.columnCount;r<n;++r)this._columnSizers[r].minSize=0;for(var i=this._items.filter(function(W){return!W.isHidden}),r=0,n=i.length;r<n;++r)i[r].fit();var o=this.rowCount-1,s=this.columnCount-1;i.sort(ja.rowSpanCmp);for(var r=0,n=i.length;r<n;++r){var c=i[r],l=t.getCellConfig(c.widget),h=Math.min(l.row,o),p=Math.min(l.row+l.rowSpan-1,o);ja.distributeMin(this._rowSizers,h,p,c.minHeight)}i.sort(ja.columnSpanCmp);for(var r=0,n=i.length;r<n;++r){var c=i[r],l=t.getCellConfig(c.widget),x=Math.min(l.column,s),w=Math.min(l.column+l.columnSpan-1,s);ja.distributeMin(this._columnSizers,x,w,c.minWidth)}if(this.fitPolicy==="set-no-constraint"){mr.sendMessage(this.parent,Mr.Msg.UpdateRequest);return}for(var E=o*this._rowSpacing,P=s*this._columnSpacing,r=0,n=this.rowCount;r<n;++r)E+=this._rowSizers[r].minSize;for(var r=0,n=this.columnCount;r<n;++r)P+=this._columnSizers[r].minSize;var B=this._box=co.boxSizing(this.parent.node);P+=B.horizontalSum,E+=B.verticalSum;var D=this.parent.node.style;D.minWidth=P+"px",D.minHeight=E+"px",this._dirty=!0,this.parent.parent&&mr.sendMessage(this.parent.parent,Mr.Msg.FitRequest),this._dirty&&mr.sendMessage(this.parent,Mr.Msg.UpdateRequest)},t.prototype._update=function(r,n){this._dirty=!1,r<0&&(r=this.parent.node.offsetWidth),n<0&&(n=this.parent.node.offsetHeight),this._box||(this._box=co.boxSizing(this.parent.node));var i=this._box.paddingTop,o=this._box.paddingLeft,s=r-this._box.horizontalSum,c=n-this._box.verticalSum,l=this.rowCount-1,h=this.columnCount-1,p=l*this._rowSpacing,x=h*this._columnSpacing;xu.calc(this._rowSizers,Math.max(0,c-p)),xu.calc(this._columnSizers,Math.max(0,s-x));for(var w=0,E=i,P=this.rowCount;w<P;++w)this._rowStarts[w]=E,E+=this._rowSizers[w].size+this._rowSpacing;for(var w=0,E=o,P=this.columnCount;w<P;++w)this._columnStarts[w]=E,E+=this._columnSizers[w].size+this._columnSpacing;for(var w=0,P=this._items.length;w<P;++w){var B=this._items[w];if(!B.isHidden){var D=t.getCellConfig(B.widget),W=Math.min(D.row,l),X=Math.min(D.column,h),q=Math.min(D.row+D.rowSpan-1,l),$=Math.min(D.column+D.columnSpan-1,h),et=this._columnStarts[X],F=this._rowStarts[W],ut=this._columnStarts[$]+this._columnSizers[$].size-et,ot=this._rowStarts[q]+this._rowSizers[q].size-F;B.update(et,F,ut,ot)}}},t}(AA);(function(e){function t(n){return ja.cellConfigProperty.get(n)}e.getCellConfig=t;function r(n,i){ja.cellConfigProperty.set(n,ja.normalizeConfig(i))}e.setCellConfig=r})(P8||(P8={}));var ja;(function(e){e.cellConfigProperty=new xl({name:"cellConfig",create:function(){return{row:0,column:0,rowSpan:1,columnSpan:1}},changed:c});function t(l){var h=Math.max(0,Math.floor(l.row||0)),p=Math.max(0,Math.floor(l.column||0)),x=Math.max(1,Math.floor(l.rowSpan||0)),w=Math.max(1,Math.floor(l.columnSpan||0));return{row:h,column:p,rowSpan:x,columnSpan:w}}e.normalizeConfig=t;function r(l){return Math.max(0,Math.floor(l))}e.clampValue=r;function n(l,h){var p=e.cellConfigProperty.get(l.widget),x=e.cellConfigProperty.get(h.widget);return p.rowSpan-x.rowSpan}e.rowSpanCmp=n;function i(l,h){var p=e.cellConfigProperty.get(l.widget),x=e.cellConfigProperty.get(h.widget);return p.columnSpan-x.columnSpan}e.columnSpanCmp=i;function o(l,h){for(h=Math.max(1,Math.floor(h));l.length<h;)l.push(new mA);l.length>h&&(l.length=h)}e.reallocSizers=o;function s(l,h,p,x){if(!(p<h)){if(h===p){var w=l[h];w.minSize=Math.max(w.minSize,x);return}for(var E=0,P=h;P<=p;++P)E+=l[P].minSize;if(!(E>=x))for(var B=(x-E)/(p-h+1),P=h;P<=p;++P)l[P].minSize+=B}}e.distributeMin=s;function c(l){l.parent&&l.parent.layout instanceof P8&&l.parent.fit()}})(ja||(ja={}));var fht=function(e){Ds(t,e);function t(r){r===void 0&&(r={});var n=e.call(this,{node:YR.createNode()})||this;return n._activeIndex=-1,n._tabFocusIndex=0,n._menus=[],n._childMenu=null,n.addClass("lm-MenuBar"),n.addClass("p-MenuBar"),n.setFlag(Mr.Flag.DisallowLayout),n.renderer=r.renderer||t.defaultRenderer,n._forceItemsPosition=r.forceItemsPosition||{forceX:!0,forceY:!0},n}return t.prototype.dispose=function(){this._closeChildMenu(),this._menus.length=0,e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"childMenu",{get:function(){return this._childMenu},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentNode",{get:function(){return this.node.getElementsByClassName("lm-MenuBar-content")[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activeMenu",{get:function(){return this._menus[this._activeIndex]||null},set:function(r){this.activeIndex=r?this._menus.indexOf(r):-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activeIndex",{get:function(){return this._activeIndex},set:function(r){(r<0||r>=this._menus.length)&&(r=-1),this._activeIndex!==r&&(this._activeIndex=r,r!==-1&&(this._tabFocusIndex=r),this._activeIndex>=0&&this.contentNode.childNodes[this._activeIndex]&&this.contentNode.childNodes[this._activeIndex].focus(),this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"menus",{get:function(){return this._menus},enumerable:!0,configurable:!0}),t.prototype.openActiveMenu=function(){this._activeIndex!==-1&&(this._openChildMenu(),this._childMenu&&(this._childMenu.activeIndex=-1,this._childMenu.activateNextItem()))},t.prototype.addMenu=function(r){this.insertMenu(this._menus.length,r)},t.prototype.insertMenu=function(r,n){this._closeChildMenu();var i=this._menus.indexOf(n),o=Math.max(0,Math.min(r,this._menus.length));if(i===-1){Ze.insert(this._menus,o,n),n.addClass("lm-MenuBar-menu"),n.addClass("p-MenuBar-menu"),n.aboutToClose.connect(this._onMenuAboutToClose,this),n.menuRequested.connect(this._onMenuMenuRequested,this),n.title.changed.connect(this._onTitleChanged,this),this.update();return}o===this._menus.length&&o--,i!==o&&(Ze.move(this._menus,i,o),this.update())},t.prototype.removeMenu=function(r){this.removeMenuAt(this._menus.indexOf(r))},t.prototype.removeMenuAt=function(r){this._closeChildMenu();var n=Ze.removeAt(this._menus,r);n&&(n.aboutToClose.disconnect(this._onMenuAboutToClose,this),n.menuRequested.disconnect(this._onMenuMenuRequested,this),n.title.changed.disconnect(this._onTitleChanged,this),n.removeClass("lm-MenuBar-menu"),n.removeClass("p-MenuBar-menu"),this.update())},t.prototype.clearMenus=function(){if(this._menus.length!==0){this._closeChildMenu();for(var r=0,n=this._menus;r<n.length;r++){var i=n[r];i.aboutToClose.disconnect(this._onMenuAboutToClose,this),i.menuRequested.disconnect(this._onMenuMenuRequested,this),i.title.changed.disconnect(this._onTitleChanged,this),i.removeClass("lm-MenuBar-menu"),i.removeClass("p-MenuBar-menu")}this._menus.length=0,this.update()}},t.prototype.handleEvent=function(r){switch(r.type){case"keydown":this._evtKeyDown(r);break;case"mousedown":this._evtMouseDown(r);break;case"mousemove":this._evtMouseMove(r);break;case"mouseleave":this._evtMouseLeave(r);break;case"contextmenu":r.preventDefault(),r.stopPropagation();break}},t.prototype.onBeforeAttach=function(r){this.node.addEventListener("keydown",this),this.node.addEventListener("mousedown",this),this.node.addEventListener("mousemove",this),this.node.addEventListener("mouseleave",this),this.node.addEventListener("contextmenu",this)},t.prototype.onAfterDetach=function(r){this.node.removeEventListener("keydown",this),this.node.removeEventListener("mousedown",this),this.node.removeEventListener("mousemove",this),this.node.removeEventListener("mouseleave",this),this.node.removeEventListener("contextmenu",this),this._closeChildMenu()},t.prototype.onActivateRequest=function(r){this.isAttached&&(this.activeIndex=0)},t.prototype.onUpdateRequest=function(r){for(var n=this,i=this._menus,o=this.renderer,s=this._activeIndex,c=this._tabFocusIndex>=0&&this._tabFocusIndex<i.length?this._tabFocusIndex:0,l=new Array(i.length),h=function(w,E){var P=i[w].title,B=w===s;B&&i[w].items.length==0&&(B=!1),l[w]=o.renderItem({title:P,active:B,tabbable:w===c,onfocus:function(){n.activeIndex=w}})},p=0,x=i.length;p<x;++p)h(p);Sd.render(l,this.contentNode)},t.prototype._evtKeyDown=function(r){var n=r.keyCode;if(n===9){this.activeIndex=-1;return}if(r.preventDefault(),r.stopPropagation(),n===13||n===32||n===38||n===40){this.openActiveMenu();return}if(n===27){this._closeChildMenu(),this.activeIndex=-1,this.node.blur();return}if(n===37){var i=this._activeIndex,o=this._menus.length;this.activeIndex=i===0?o-1:i-1;return}if(n===39){var i=this._activeIndex,o=this._menus.length;this.activeIndex=i===o-1?0:i+1;return}var s=vx().keyForKeydownEvent(r);if(s){var c=this._activeIndex+1,l=YR.findMnemonic(this._menus,s,c);l.index!==-1&&!l.multiple?(this.activeIndex=l.index,this.openActiveMenu()):l.index!==-1?this.activeIndex=l.index:l.auto!==-1&&(this.activeIndex=l.auto)}},t.prototype._evtMouseDown=function(r){if(co.hitTest(this.node,r.clientX,r.clientY)){r.preventDefault(),r.stopPropagation(),r.stopImmediatePropagation();var n=Ze.findFirstIndex(this.contentNode.children,function(o){return co.hitTest(o,r.clientX,r.clientY)});if(n===-1){this._closeChildMenu();return}if(r.button===0)if(this._childMenu)this._closeChildMenu(),this.activeIndex=n;else{var i=this._positionForMenu(n);Ex.saveWindowData(),this.activeIndex=n,this._openChildMenu(i)}}},t.prototype._evtMouseMove=function(r){var n=Ze.findFirstIndex(this.contentNode.children,function(o){return co.hitTest(o,r.clientX,r.clientY)});if(n!==this._activeIndex&&!(n===-1&&this._childMenu)){var i=this._positionForMenu(n);Ex.saveWindowData(),this.activeIndex=n,this._childMenu&&this._openChildMenu(i)}},t.prototype._positionForMenu=function(r){var n=this.contentNode.children[r],i=n.getBoundingClientRect(),o=i.left,s=i.bottom;return{top:s,left:o}},t.prototype._evtMouseLeave=function(r){this._childMenu||(this.activeIndex=-1)},t.prototype._openChildMenu=function(r){var n;r===void 0&&(r={});var i=this.activeMenu;if(!i){this._closeChildMenu();return}var o=this._childMenu;if(o!==i){this._childMenu=i,o?o.close():document.addEventListener("mousedown",this,!0),mr.sendMessage(this,Mr.Msg.UpdateRequest);var s=r.left,c=r.top;(typeof s>"u"||typeof c>"u")&&(n=this._positionForMenu(this._activeIndex),s=n.left,c=n.top),o||(this.addClass("lm-mod-active"),this.addClass("p-mod-active")),i.items.length>0&&i.open(s,c,this._forceItemsPosition)}},t.prototype._closeChildMenu=function(){if(this._childMenu){this.removeClass("lm-mod-active"),this.removeClass("p-mod-active"),document.removeEventListener("mousedown",this,!0);var r=this._childMenu;this._childMenu=null,r.close(),this.activeIndex=-1}},t.prototype._onMenuAboutToClose=function(r){r===this._childMenu&&(this.removeClass("lm-mod-active"),this.removeClass("p-mod-active"),document.removeEventListener("mousedown",this,!0),this._childMenu=null,this.activeIndex=-1)},t.prototype._onMenuMenuRequested=function(r,n){if(r===this._childMenu){var i=this._activeIndex,o=this._menus.length;switch(n){case"next":this.activeIndex=i===o-1?0:i+1;break;case"previous":this.activeIndex=i===0?o-1:i-1;break}this.openActiveMenu()}},t.prototype._onTitleChanged=function(){this.update()},t}(Mr);(function(e){var t=function(){function r(){}return r.prototype.renderItem=function(n){var i=this.createItemClass(n),o=this.createItemDataset(n),s=this.createItemARIA(n);return Ji.li(uc({className:i,dataset:o,tabindex:n.tabbable?"0":"-1",onfocus:n.onfocus},s),this.renderIcon(n),this.renderLabel(n))},r.prototype.renderIcon=function(n){var i=this.createIconClass(n);return typeof n.title.icon=="string"?Ji.div({className:i},n.title.iconLabel):Ji.div({className:i},n.title.icon,n.title.iconLabel)},r.prototype.renderLabel=function(n){var i=this.formatLabel(n);return Ji.div({className:"lm-MenuBar-itemLabel p-MenuBar-itemLabel"},i)},r.prototype.createItemClass=function(n){var i="lm-MenuBar-item";return i+=" p-MenuBar-item",n.title.className&&(i+=" "+n.title.className),n.active&&(i+=" lm-mod-active",i+=" p-mod-active"),i},r.prototype.createItemDataset=function(n){return n.title.dataset},r.prototype.createItemARIA=function(n){return{role:"menuitem","aria-haspopup":"true"}},r.prototype.createIconClass=function(n){var i="lm-MenuBar-itemIcon";i+=" p-MenuBar-itemIcon";var o=n.title.iconClass;return o?i+" "+o:i},r.prototype.formatLabel=function(n){var i=n.title,o=i.label,s=i.mnemonic;if(s<0||s>=o.length)return o;var c=o.slice(0,s),l=o.slice(s+1),h=o[s],p=Ji.span({className:"lm-MenuBar-itemMnemonic p-MenuBar-itemMnemonic"},h);return[c,p,l]},r}();e.Renderer=t,e.defaultRenderer=new t})(fht||(fht={}));var YR;(function(e){function t(){var n=document.createElement("div"),i=document.createElement("ul");return i.className="lm-MenuBar-content",i.classList.add("p-MenuBar-content"),n.appendChild(i),i.setAttribute("role","menubar"),n}e.createNode=t;function r(n,i,o){for(var s=-1,c=-1,l=!1,h=i.toUpperCase(),p=0,x=n.length;p<x;++p){var w=(p+o)%x,E=n[w].title;if(E.label.length!==0){var P=E.mnemonic;if(P>=0&&P<E.label.length){E.label[P].toUpperCase()===h&&(s===-1?s=w:l=!0);continue}c===-1&&E.label[0].toUpperCase()===h&&(c=w)}}return{index:s,multiple:l,auto:c}}e.findMnemonic=r})(YR||(YR={}));var GWe=function(e){Ds(t,e);function t(r){r===void 0&&(r={});var n=e.call(this,{node:KR.createNode()})||this;return n._onRepeat=function(){if(n._repeatTimer=-1,!!n._pressData){var i=n._pressData.part;if(i!=="thumb"){n._repeatTimer=window.setTimeout(n._onRepeat,20);var o=n._pressData.mouseX,s=n._pressData.mouseY;if(i==="decrement"){if(!co.hitTest(n.decrementNode,o,s))return;n._stepRequested.emit("decrement");return}if(i==="increment"){if(!co.hitTest(n.incrementNode,o,s))return;n._stepRequested.emit("increment");return}if(i==="track"){if(!co.hitTest(n.trackNode,o,s))return;var c=n.thumbNode;if(co.hitTest(c,o,s))return;var l=c.getBoundingClientRect(),h=void 0;n._orientation==="horizontal"?h=o<l.left?"decrement":"increment":h=s<l.top?"decrement":"increment",n._pageRequested.emit(h);return}}}},n._value=0,n._page=10,n._maximum=100,n._repeatTimer=-1,n._pressData=null,n._thumbMoved=new Di(n),n._stepRequested=new Di(n),n._pageRequested=new Di(n),n.addClass("lm-ScrollBar"),n.addClass("p-ScrollBar"),n.setFlag(Mr.Flag.DisallowLayout),n._orientation=r.orientation||"vertical",n.dataset.orientation=n._orientation,r.maximum!==void 0&&(n._maximum=Math.max(0,r.maximum)),r.page!==void 0&&(n._page=Math.max(0,r.page)),r.value!==void 0&&(n._value=Math.max(0,Math.min(r.value,n._maximum))),n}return Object.defineProperty(t.prototype,"thumbMoved",{get:function(){return this._thumbMoved},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stepRequested",{get:function(){return this._stepRequested},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageRequested",{get:function(){return this._pageRequested},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"orientation",{get:function(){return this._orientation},set:function(r){this._orientation!==r&&(this._releaseMouse(),this._orientation=r,this.dataset.orientation=r,this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(r){r=Math.max(0,Math.min(r,this._maximum)),this._value!==r&&(this._value=r,this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"page",{get:function(){return this._page},set:function(r){r=Math.max(0,r),this._page!==r&&(this._page=r,this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maximum",{get:function(){return this._maximum},set:function(r){r=Math.max(0,r),this._maximum!==r&&(this._maximum=r,this._value=Math.min(this._value,r),this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"decrementNode",{get:function(){return this.node.getElementsByClassName("lm-ScrollBar-button")[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"incrementNode",{get:function(){return this.node.getElementsByClassName("lm-ScrollBar-button")[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trackNode",{get:function(){return this.node.getElementsByClassName("lm-ScrollBar-track")[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"thumbNode",{get:function(){return this.node.getElementsByClassName("lm-ScrollBar-thumb")[0]},enumerable:!0,configurable:!0}),t.prototype.handleEvent=function(r){switch(r.type){case"mousedown":this._evtMouseDown(r);break;case"mousemove":this._evtMouseMove(r);break;case"mouseup":this._evtMouseUp(r);break;case"keydown":this._evtKeyDown(r);break;case"contextmenu":r.preventDefault(),r.stopPropagation();break}},t.prototype.onBeforeAttach=function(r){this.node.addEventListener("mousedown",this),this.update()},t.prototype.onAfterDetach=function(r){this.node.removeEventListener("mousedown",this),this._releaseMouse()},t.prototype.onUpdateRequest=function(r){var n=this._value*100/this._maximum,i=this._page*100/(this._page+this._maximum);n=Math.max(0,Math.min(n,100)),i=Math.max(0,Math.min(i,100));var o=this.thumbNode.style;this._orientation==="horizontal"?(o.top="",o.height="",o.left=n+"%",o.width=i+"%",o.transform="translate("+-n+"%, 0%)"):(o.left="",o.width="",o.top=n+"%",o.height=i+"%",o.transform="translate(0%, "+-n+"%)")},t.prototype._evtKeyDown=function(r){if(r.preventDefault(),r.stopPropagation(),r.keyCode===27){var n=this._pressData?this._pressData.value:-1;this._releaseMouse(),n!==-1&&this._moveThumb(n)}},t.prototype._evtMouseDown=function(r){if(r.button===0&&(this.activate(),!this._pressData)){var n=KR.findPart(this,r.target);if(n){r.preventDefault(),r.stopPropagation();var i=pA.overrideCursor("default");if(this._pressData={part:n,override:i,delta:-1,value:-1,mouseX:r.clientX,mouseY:r.clientY},document.addEventListener("mousemove",this,!0),document.addEventListener("mouseup",this,!0),document.addEventListener("keydown",this,!0),document.addEventListener("contextmenu",this,!0),n==="thumb"){var o=this.thumbNode,s=o.getBoundingClientRect();this._orientation==="horizontal"?this._pressData.delta=r.clientX-s.left:this._pressData.delta=r.clientY-s.top,o.classList.add("lm-mod-active"),o.classList.add("p-mod-active"),this._pressData.value=this._value;return}if(n==="track"){var s=this.thumbNode.getBoundingClientRect(),c=void 0;this._orientation==="horizontal"?c=r.clientX<s.left?"decrement":"increment":c=r.clientY<s.top?"decrement":"increment",this._repeatTimer=window.setTimeout(this._onRepeat,350),this._pageRequested.emit(c);return}if(n==="decrement"){this.decrementNode.classList.add("lm-mod-active"),this.decrementNode.classList.add("p-mod-active"),this._repeatTimer=window.setTimeout(this._onRepeat,350),this._stepRequested.emit("decrement");return}if(n==="increment"){this.incrementNode.classList.add("lm-mod-active"),this.incrementNode.classList.add("p-mod-active"),this._repeatTimer=window.setTimeout(this._onRepeat,350),this._stepRequested.emit("increment");return}}}},t.prototype._evtMouseMove=function(r){if(this._pressData&&(r.preventDefault(),r.stopPropagation(),this._pressData.mouseX=r.clientX,this._pressData.mouseY=r.clientY,this._pressData.part==="thumb")){var n=this.thumbNode.getBoundingClientRect(),i=this.trackNode.getBoundingClientRect(),o,s;this._orientation==="horizontal"?(o=r.clientX-i.left-this._pressData.delta,s=i.width-n.width):(o=r.clientY-i.top-this._pressData.delta,s=i.height-n.height);var c=s===0?0:o*this._maximum/s;this._moveThumb(c)}},t.prototype._evtMouseUp=function(r){r.button===0&&(r.preventDefault(),r.stopPropagation(),this._releaseMouse())},t.prototype._releaseMouse=function(){this._pressData&&(clearTimeout(this._repeatTimer),this._repeatTimer=-1,this._pressData.override.dispose(),this._pressData=null,document.removeEventListener("mousemove",this,!0),document.removeEventListener("mouseup",this,!0),document.removeEventListener("keydown",this,!0),document.removeEventListener("contextmenu",this,!0),this.thumbNode.classList.remove("lm-mod-active"),this.decrementNode.classList.remove("lm-mod-active"),this.incrementNode.classList.remove("lm-mod-active"),this.thumbNode.classList.remove("p-mod-active"),this.decrementNode.classList.remove("p-mod-active"),this.incrementNode.classList.remove("p-mod-active"))},t.prototype._moveThumb=function(r){r=Math.max(0,Math.min(r,this._maximum)),this._value!==r&&(this._value=r,this.update(),this._thumbMoved.emit(r))},t}(Mr),KR;(function(e){function t(){var n=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div"),s=document.createElement("div"),c=document.createElement("div");return i.className="lm-ScrollBar-button",o.className="lm-ScrollBar-button",i.dataset.action="decrement",o.dataset.action="increment",s.className="lm-ScrollBar-track",c.className="lm-ScrollBar-thumb",i.classList.add("p-ScrollBar-button"),o.classList.add("p-ScrollBar-button"),s.classList.add("p-ScrollBar-track"),c.classList.add("p-ScrollBar-thumb"),s.appendChild(c),n.appendChild(i),n.appendChild(s),n.appendChild(o),n}e.createNode=t;function r(n,i){return n.thumbNode.contains(i)?"thumb":n.trackNode.contains(i)?"track":n.decrementNode.contains(i)?"decrement":n.incrementNode.contains(i)?"increment":null}e.findPart=r})(KR||(KR={}));var XWe=function(e){Ds(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r._widget=null,r}return t.prototype.dispose=function(){if(this._widget){var r=this._widget;this._widget=null,r.dispose()}e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"widget",{get:function(){return this._widget},set:function(r){r&&(r.parent=this.parent),this._widget!==r&&(this._widget&&this._widget.dispose(),this._widget=r,this.parent&&r&&this.attachWidget(r))},enumerable:!0,configurable:!0}),t.prototype.iter=function(){return this._widget?RT(this._widget):_u()},t.prototype.removeWidget=function(r){this._widget===r&&(this._widget=null,this.parent&&this.detachWidget(r))},t.prototype.init=function(){var r=this;e.prototype.init.call(this),yn(this,function(n){r.attachWidget(n)})},t.prototype.attachWidget=function(r){this.parent.isAttached&&mr.sendMessage(r,Mr.Msg.BeforeAttach),this.parent.node.appendChild(r.node),this.parent.isAttached&&mr.sendMessage(r,Mr.Msg.AfterAttach)},t.prototype.detachWidget=function(r){this.parent.isAttached&&mr.sendMessage(r,Mr.Msg.BeforeDetach),this.parent.node.removeChild(r.node),this.parent.isAttached&&mr.sendMessage(r,Mr.Msg.AfterDetach)},t}(AA),Fzt=function(e){Ds(t,e);function t(r){r===void 0&&(r={});var n=e.call(this,r)||this;return n._dirty=!1,n._items=[],n._box=null,n._hiddenMode=r.hiddenMode!==void 0?r.hiddenMode:Mr.HiddenMode.Display,n}return Object.defineProperty(t.prototype,"hiddenMode",{get:function(){return this._hiddenMode},set:function(r){var n=this;this._hiddenMode!==r&&(this._hiddenMode=r,this.widgets.length>1&&this.widgets.forEach(function(i){i.hiddenMode=n._hiddenMode}))},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){yn(this._items,function(r){r.dispose()}),this._box=null,this._items.length=0,e.prototype.dispose.call(this)},t.prototype.attachWidget=function(r,n){this._hiddenMode===Mr.HiddenMode.Scale&&this._items.length>0?(this._items.length===1&&(this.widgets[0].hiddenMode=Mr.HiddenMode.Scale),n.hiddenMode=Mr.HiddenMode.Scale):n.hiddenMode=Mr.HiddenMode.Display,Ze.insert(this._items,r,new DT(n)),this.parent.isAttached&&mr.sendMessage(n,Mr.Msg.BeforeAttach),this.parent.node.appendChild(n.node),this.parent.isAttached&&mr.sendMessage(n,Mr.Msg.AfterAttach),this.parent.fit()},t.prototype.moveWidget=function(r,n,i){Ze.move(this._items,r,n),this.parent.update()},t.prototype.detachWidget=function(r,n){var i=Ze.removeAt(this._items,r);this.parent.isAttached&&mr.sendMessage(n,Mr.Msg.BeforeDetach),this.parent.node.removeChild(n.node),this.parent.isAttached&&mr.sendMessage(n,Mr.Msg.AfterDetach),i.widget.node.style.zIndex="",this._hiddenMode===Mr.HiddenMode.Scale&&(n.hiddenMode=Mr.HiddenMode.Display,this._items.length===1&&(this._items[0].widget.hiddenMode=Mr.HiddenMode.Display)),i.dispose(),this.parent.fit()},t.prototype.onBeforeShow=function(r){e.prototype.onBeforeShow.call(this,r),this.parent.update()},t.prototype.onBeforeAttach=function(r){e.prototype.onBeforeAttach.call(this,r),this.parent.fit()},t.prototype.onChildShown=function(r){this.parent.fit()},t.prototype.onChildHidden=function(r){this.parent.fit()},t.prototype.onResize=function(r){this.parent.isVisible&&this._update(r.width,r.height)},t.prototype.onUpdateRequest=function(r){this.parent.isVisible&&this._update(-1,-1)},t.prototype.onFitRequest=function(r){this.parent.isAttached&&this._fit()},t.prototype._fit=function(){for(var r=0,n=0,i=0,o=this._items.length;i<o;++i){var s=this._items[i];s.isHidden||(s.fit(),r=Math.max(r,s.minWidth),n=Math.max(n,s.minHeight))}var c=this._box=co.boxSizing(this.parent.node);r+=c.horizontalSum,n+=c.verticalSum;var l=this.parent.node.style;l.minWidth=r+"px",l.minHeight=n+"px",this._dirty=!0,this.parent.parent&&mr.sendMessage(this.parent.parent,Mr.Msg.FitRequest),this._dirty&&mr.sendMessage(this.parent,Mr.Msg.UpdateRequest)},t.prototype._update=function(r,n){this._dirty=!1;for(var i=0,o=0,s=this._items.length;o<s;++o)i+=+!this._items[o].isHidden;if(i!==0){r<0&&(r=this.parent.node.offsetWidth),n<0&&(n=this.parent.node.offsetHeight),this._box||(this._box=co.boxSizing(this.parent.node));for(var c=this._box.paddingTop,l=this._box.paddingLeft,h=r-this._box.horizontalSum,p=n-this._box.verticalSum,o=0,s=this._items.length;o<s;++o){var x=this._items[o];x.isHidden||(x.widget.node.style.zIndex=""+o,x.update(l,c,h,p))}}},t}(ZR),zzt=function(e){Ds(t,e);function t(r){r===void 0&&(r={});var n=e.call(this,{layout:I8.createLayout(r)})||this;return n._widgetRemoved=new Di(n),n.addClass("lm-StackedPanel"),n.addClass("p-StackedPanel"),n}return Object.defineProperty(t.prototype,"hiddenMode",{get:function(){return this.layout.hiddenMode},set:function(r){this.layout.hiddenMode=r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"widgetRemoved",{get:function(){return this._widgetRemoved},enumerable:!0,configurable:!0}),t.prototype.onChildAdded=function(r){r.child.addClass("lm-StackedPanel-child"),r.child.addClass("p-StackedPanel-child")},t.prototype.onChildRemoved=function(r){r.child.removeClass("lm-StackedPanel-child"),r.child.removeClass("p-StackedPanel-child"),this._widgetRemoved.emit(r.child)},t}(NT),I8;(function(e){function t(r){return r.layout||new Fzt}e.createLayout=t})(I8||(I8={}));var YWe=function(e){Ds(t,e);function t(r){r===void 0&&(r={});var n=e.call(this)||this;n._currentChanged=new Di(n),n._addRequested=new Di(n),n.addClass("lm-TabPanel"),n.addClass("p-TabPanel"),n.tabBar=new Mx(r),n.tabBar.addClass("lm-TabPanel-tabBar"),n.stackedPanel=new zzt,n.stackedPanel.addClass("lm-TabPanel-stackedPanel"),n.tabBar.addClass("p-TabPanel-tabBar"),n.stackedPanel.addClass("p-TabPanel-stackedPanel"),n.tabBar.tabMoved.connect(n._onTabMoved,n),n.tabBar.currentChanged.connect(n._onCurrentChanged,n),n.tabBar.tabCloseRequested.connect(n._onTabCloseRequested,n),n.tabBar.tabActivateRequested.connect(n._onTabActivateRequested,n),n.tabBar.addRequested.connect(n._onTabAddRequested,n),n.stackedPanel.widgetRemoved.connect(n._onWidgetRemoved,n),n._tabPlacement=r.tabPlacement||"top";var i=Tx.directionFromPlacement(n._tabPlacement),o=Tx.orientationFromPlacement(n._tabPlacement);n.tabBar.orientation=o,n.tabBar.dataset.placement=n._tabPlacement;var s=new Jh({direction:i,spacing:0});return Jh.setStretch(n.tabBar,0),Jh.setStretch(n.stackedPanel,1),s.addWidget(n.tabBar),s.addWidget(n.stackedPanel),n.layout=s,n}return Object.defineProperty(t.prototype,"currentChanged",{get:function(){return this._currentChanged},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentIndex",{get:function(){return this.tabBar.currentIndex},set:function(r){this.tabBar.currentIndex=r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentWidget",{get:function(){var r=this.tabBar.currentTitle;return r?r.owner:null},set:function(r){this.tabBar.currentTitle=r?r.title:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tabsMovable",{get:function(){return this.tabBar.tabsMovable},set:function(r){this.tabBar.tabsMovable=r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"addButtonEnabled",{get:function(){return this.tabBar.addButtonEnabled},set:function(r){this.tabBar.addButtonEnabled=r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tabPlacement",{get:function(){return this._tabPlacement},set:function(r){if(this._tabPlacement!==r){this._tabPlacement=r;var n=Tx.directionFromPlacement(r),i=Tx.orientationFromPlacement(r);this.tabBar.orientation=i,this.tabBar.dataset.placement=r,this.layout.direction=n}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"addRequested",{get:function(){return this._addRequested},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"widgets",{get:function(){return this.stackedPanel.widgets},enumerable:!0,configurable:!0}),t.prototype.addWidget=function(r){this.insertWidget(this.widgets.length,r)},t.prototype.insertWidget=function(r,n){n!==this.currentWidget&&n.hide(),this.stackedPanel.insertWidget(r,n),this.tabBar.insertTab(r,n.title),n.node.setAttribute("role","tabpanel");var i=this.tabBar.renderer;if(i instanceof Mx.Renderer){var o=i.createTabKey({title:n.title,current:!1,zIndex:0});n.node.setAttribute("aria-labelledby",o)}},t.prototype._onCurrentChanged=function(r,n){var i=n.previousIndex,o=n.previousTitle,s=n.currentIndex,c=n.currentTitle,l=o?o.owner:null,h=c?c.owner:null;l&&l.hide(),h&&h.show(),this._currentChanged.emit({previousIndex:i,previousWidget:l,currentIndex:s,currentWidget:h}),(lc.IS_EDGE||lc.IS_IE)&&mr.flush()},t.prototype._onTabAddRequested=function(r,n){this._addRequested.emit(r)},t.prototype._onTabActivateRequested=function(r,n){n.title.owner.activate()},t.prototype._onTabCloseRequested=function(r,n){n.title.owner.close()},t.prototype._onTabMoved=function(r,n){this.stackedPanel.insertWidget(n.toIndex,n.title.owner)},t.prototype._onWidgetRemoved=function(r,n){n.node.removeAttribute("role"),n.node.removeAttribute("aria-labelledby"),this.tabBar.removeTab(n.title)},t}(Mr),Tx;(function(e){function t(o){return n[o]}e.orientationFromPlacement=t;function r(o){return i[o]}e.directionFromPlacement=r;var n={top:"horizontal",left:"vertical",right:"vertical",bottom:"horizontal"},i={top:"top-to-bottom",left:"left-to-right",right:"right-to-left",bottom:"bottom-to-top"}})(Tx||(Tx={}));var Uzt="IPY_MODEL_";function kT(e,t){if(Array.isArray(e)){let r=[];return e.forEach((n,i)=>{r.push(kT(n,t))}),Promise.all(r)}else if(e instanceof Object){let r={};return Object.keys(e).forEach(n=>{r[n]=kT(e[n],t)}),q1(r)}else return typeof e=="string"&&e.slice(0,10)==="IPY_MODEL_"?t.get_model(e.slice(10,e.length)):Promise.resolve(e)}function L8(e,t){if(Array.isArray(e)){let r=[];for(let n of e)r.push(L8(n,t));return r}else{if(e instanceof up)return`${Uzt}${e.model_id}`;if(e instanceof Object&&typeof e!="string"){let r={};Object.keys(e).forEach(n=>{r[n]=L8(e[n],t)})}else return e}}var up=class extends pht.Model{defaults(){return{_model_module:"@jupyter-widgets/base",_model_name:"WidgetModel",_model_module_version:BI,_view_module:"@jupyter-widgets/base",_view_name:null,_view_module_version:BI,_view_count:null}}isNew(){return!1}initialize(t,r){this._expectedEchoMsgIds={},this._attrsToUpdate={},super.initialize(t,r),this.widget_manager=r.widget_manager,this.model_id=r.model_id;let n=r.comm;this.views=Object.create(null),this.state_change=Promise.resolve(),this._closed=!1,this._state_lock=null,this._msg_buffer=null,this._msg_buffer_callbacks=null,this._pending_msgs=0,this._buffered_state_diff={},n?(this.comm=n,n.on_close(this._handle_comm_closed.bind(this)),n.on_msg(this._handle_comm_msg.bind(this)),this.comm_live=!0):this.comm_live=!1}get comm_live(){return this._comm_live}set comm_live(t){this._comm_live=t,this.trigger("comm_live_update")}send(t,r,n){if(this.comm!==void 0){let i={method:"custom",content:t};this.comm.send(i,r,{},n)}}close(t=!1){if(this._closed)return;this._closed=!0,this.comm&&!t&&this.comm.close(),this.stopListening(),this.trigger("destroy",this),this.comm&&delete this.comm;let r=Object.keys(this.views).map(n=>this.views[n].then(i=>i.remove()));return delete this.views,Promise.all(r).then(()=>{})}_handle_comm_closed(t){this.trigger("comm:close"),this.close(!0)}_handle_comm_msg(t){let r=t.content.data,n=r.method;switch(n){case"update":case"echo_update":return this.state_change=this.state_change.then(()=>{var i,o,s;let c=r.state,l=(i=r.buffer_paths,i??[]),h=(s=(o=t.buffers)===null||o===void 0?void 0:o.slice(0,l.length),s??[]).map(p=>p instanceof DataView?p:new DataView(p instanceof ArrayBuffer?p:p.buffer));if(tA(c,l,h),t.parent_header&&n==="echo_update"){let p=t.parent_header.msg_id;Object.keys(c).filter(w=>this._expectedEchoMsgIds.hasOwnProperty(w)).forEach(w=>{this._expectedEchoMsgIds[w]!==p?delete c[w]:(delete this._expectedEchoMsgIds[w],this._msg_buffer!==null&&Object.prototype.hasOwnProperty.call(this._msg_buffer,w)&&delete c[w])})}return this.constructor._deserialize_state(c,this.widget_manager)}).then(i=>{this.set_state(i)}).catch(cp(`Could not process update msg for model id: ${this.model_id}`,!0)),this.state_change;case"custom":return this.trigger("msg:custom",r.content,t.buffers),Promise.resolve()}}set_state(t){this._state_lock=t;try{this.set(t)}catch(r){console.error(`Error setting state: ${r.message}`)}finally{this._state_lock=null}}get_state(t){let r=this.attributes;if(t){let n=this.defaults,i=typeof n=="function"?n.call(this):n,o={};return Object.keys(r).forEach(s=>{W1(r[s],i[s])||(o[s]=r[s])}),o}else return Object.assign({},r)}_handle_status(t){if(this.comm!==void 0&&t.content.execution_state==="idle"&&(this._pending_msgs--,this._pending_msgs<0&&(console.error(`Jupyter Widgets message throttle: Pending messages < 0 (=${this._pending_msgs}), which is unexpected. Resetting to 0 to continue.`),this._pending_msgs=0),this._msg_buffer!==null&&this._pending_msgs<1)){let r=this.send_sync_message(this._msg_buffer,this._msg_buffer_callbacks);this.rememberLastUpdateFor(r),this._msg_buffer=null,this._msg_buffer_callbacks=null}}callbacks(t){return this.widget_manager.callbacks(t)}set(t,r,n){let i=flt.call(this,t,r,n);if(this._buffered_state_diff!==void 0){let o=this.changedAttributes()||{};if(this._state_lock)for(let s of Object.keys(this._state_lock))o[s]===this._state_lock[s]&&delete o[s];this._buffered_state_diff=xd(this._buffered_state_diff,o)}return i}sync(t,r,n={}){if(this.comm===void 0)throw"Syncing error: no comm channel defined";let i=t==="patch"?n.attrs:r.get_state(n.drop_defaults);if(this._state_lock)for(let s of Object.keys(this._state_lock))i[s]===this._state_lock[s]&&delete i[s];Object.keys(i).forEach(s=>{this._attrsToUpdate[s]=!0});let o=this.serialize(i);if(Object.keys(o).length>0){let s=n.callbacks||this.callbacks();if(this._pending_msgs>=1){switch(t){case"patch":this._msg_buffer=xd(this._msg_buffer||{},o);break;case"update":case"create":this._msg_buffer=o;break;default:throw"unrecognized syncing method"}this._msg_buffer_callbacks=s}else{let c=this.send_sync_message(i,s);this.rememberLastUpdateFor(c)}}}rememberLastUpdateFor(t){Object.keys(this._attrsToUpdate).forEach(r=>{this._expectedEchoMsgIds[r]=t}),this._attrsToUpdate={}}serialize(t){let r=this.constructor.serializers||{};for(let n of Object.keys(t))try{r[n]&&r[n].serialize?t[n]=r[n].serialize(t[n],this):t[n]=JSON.parse(JSON.stringify(t[n])),t[n]&&t[n].toJSON&&(t[n]=t[n].toJSON())}catch(i){throw console.error("Error serializing widget state attribute: ",n),i}return t}send_sync_message(t,r={}){if(!this.comm)return"";try{r={shell:Object.assign({},r.shell),iopub:Object.assign({},r.iopub),input:r.input};let n=r.iopub.status;r.iopub.status=s=>{this._handle_status(s),n&&n(s)};let i=Qw(t),o=this.comm.send({method:"update",state:i.state,buffer_paths:i.buffer_paths},r,{},i.buffers);return this._pending_msgs++,o}catch(n){console.error("Could not send widget sync message",n)}return""}save_changes(t){if(this.comm_live){let r={patch:!0};t&&(r.callbacks=t),this.save(this._buffered_state_diff,r),this._buffered_state_diff={}}}on_some_change(t,r,n){let i=this;this.on("change",function(){t.some(i.hasChanged,i)&&r.apply(n,arguments)},this)}toJSON(t){return`IPY_MODEL_${this.model_id}`}static _deserialize_state(t,r){let n=this.serializers,i;if(n){i={};for(let o in t)n[o]&&n[o].deserialize?i[o]=n[o].deserialize(t[o],r):i[o]=t[o]}else i=t;return q1(i)}},Sx=class extends up{defaults(){return xd(super.defaults(),{_dom_classes:[]})}};Sx.serializers=Object.assign(Object.assign({},up.serializers),{layout:{deserialize:kT},style:{deserialize:kT}});var gA=class extends VR{constructor(t){super(t)}initialize(t){this.listenTo(this.model,"change",()=>{let r=Object.keys(this.model.changedAttributes()||{});r[0]==="_view_count"&&r.length===1||this.update()}),this.options=t.options,this.once("remove",()=>{typeof this.model.get("_view_count")=="number"&&(this.model.set("_view_count",this.model.get("_view_count")-1),this.model.save_changes())}),this.once("displayed",()=>{typeof this.model.get("_view_count")=="number"&&(this.model.set("_view_count",this.model.get("_view_count")+1),this.model.save_changes())}),this.displayed=new Promise((r,n)=>{this.once("displayed",r)})}update(t){}render(){}create_child_view(t,r={}){return r=Object.assign({parent:this},r),this.model.widget_manager.create_view(t,r).catch(cp("Could not create child view",!0))}callbacks(){return this.model.callbacks(this)}send(t,r){this.model.send(t,this.callbacks(),r)}touch(){this.model.save_changes(this.callbacks())}remove(){return super.remove(),this.trigger("remove"),this}},$R=class extends Mr{constructor(t){let r=t.view;delete t.view,super(t),this._view=r}dispose(){this.isDisposed||(super.dispose(),this._view&&this._view.remove(),this._view=null)}processMessage(t){super.processMessage(t),this._view.processPhosphorMessage(t)}},O8=class extends NT{constructor(t){let r=t.view;delete t.view,super(t),this._view=r}processMessage(t){super.processMessage(t),this._view.processPhosphorMessage(t)}dispose(){this.isDisposed||(super.dispose(),this._view&&this._view.remove(),this._view=null)}},FT=class extends gA{initialize(t){super.initialize(t),this.listenTo(this.model,"change:_dom_classes",(r,n)=>{let i=r.previous("_dom_classes");this.update_classes(i,n)}),this.layoutPromise=Promise.resolve(),this.listenTo(this.model,"change:layout",(r,n)=>{this.setLayout(n,r.previous("layout"))}),this.stylePromise=Promise.resolve(),this.listenTo(this.model,"change:style",(r,n)=>{this.setStyle(n,r.previous("style"))}),this.displayed.then(()=>{this.update_classes([],this.model.get("_dom_classes")),this.setLayout(this.model.get("layout")),this.setStyle(this.model.get("style"))}),this._comm_live_update(),this.listenTo(this.model,"comm_live_update",()=>{this._comm_live_update()})}setLayout(t,r){t&&(this.layoutPromise=this.layoutPromise.then(n=>(n&&(n.unlayout(),this.stopListening(n.model),n.remove()),this.create_child_view(t).then(i=>this.displayed.then(()=>(i.trigger("displayed"),this.listenTo(i.model,"change",()=>{mr.postMessage(this.pWidget,Mr.ResizeMessage.UnknownSize)}),mr.postMessage(this.pWidget,Mr.ResizeMessage.UnknownSize),i))).catch(cp("Could not add LayoutView to DOMWidgetView",!0)))))}setStyle(t,r){t&&(this.stylePromise=this.stylePromise.then(n=>(n&&(n.unstyle(),this.stopListening(n.model),n.remove()),this.create_child_view(t).then(i=>this.displayed.then(()=>(i.trigger("displayed"),i))).catch(cp("Could not add styleView to DOMWidgetView",!0)))))}update_classes(t,r,n){n===void 0&&(n=this.el),OI(t,r).map(function(i){n.classList?n.classList.remove(i):n.setAttribute("class",n.getAttribute("class").replace(i,""))}),OI(r,t).map(function(i){n.classList?n.classList.add(i):n.setAttribute("class",n.getAttribute("class").concat(" ",i))})}update_mapped_classes(t,r,n){let i=this.model.previous(r),o=t[i]?t[i]:[];i=this.model.get(r);let s=t[i]?t[i]:[];this.update_classes(o,s,n||this.el)}set_mapped_classes(t,r,n){let i=this.model.get(r),o=t[i]?t[i]:[];this.update_classes([],o,n||this.el)}_setElement(t){this.pWidget&&this.pWidget.dispose(),this.$el=t instanceof R8.default?t:(0,R8.default)(t),this.el=this.$el[0],this.pWidget=new $R({node:t,view:this})}remove(){return this.pWidget&&this.pWidget.dispose(),super.remove()}processPhosphorMessage(t){switch(t.type){case"after-attach":this.trigger("displayed");break}}_comm_live_update(){this.model.comm_live?this.pWidget.removeClass("jupyter-widgets-disconnected"):this.pWidget.addClass("jupyter-widgets-disconnected")}};var dht={align_content:null,align_items:null,align_self:null,border:null,bottom:null,display:null,flex:null,flex_flow:null,height:null,justify_content:null,justify_items:null,left:null,margin:null,max_height:null,max_width:null,min_height:null,min_width:null,overflow:null,overflow_x:null,overflow_y:null,order:null,padding:null,right:null,top:null,visibility:null,width:null,object_fit:null,object_position:null,grid_auto_columns:null,grid_auto_flow:null,grid_auto_rows:null,grid_gap:null,grid_template_rows:null,grid_template_columns:null,grid_template_areas:null,grid_row:null,grid_column:null,grid_area:null},B8=class extends up{defaults(){return xd(super.defaults(),{_model_name:"LayoutModel",_view_name:"LayoutView"},dht)}},D8=class extends gA{initialize(t){this._traitNames=[],super.initialize(t);for(let r of Object.keys(dht))this.registerTrait(r)}registerTrait(t){if(this._traitNames.push(t),t==="overflow_x"||t==="overflow_y"){this.listenTo(this.model,"change:"+t,(r,n)=>{this.handleOverflowChange(t,n)}),this.handleOverflowChange(t,this.model.get(t));return}this.listenTo(this.model,"change:"+t,(r,n)=>{this.handleChange(t,n)}),this.handleChange(t,this.model.get(t))}css_name(t){return t.replace(/_/g,"-")}handleChange(t,r){let n=this.options.parent;n?r===null?n.el.style.removeProperty(this.css_name(t)):n.el.style[this.css_name(t)]=r:console.warn("Style not applied because a parent view does not exist")}handleOverflowChange(t,r){let n=this.options.parent;n?r===null?this.model.get("overflow")===null&&n.el.style.removeProperty(this.css_name(t)):n.el.style[this.css_name(t)]=r:console.warn("Style not applied because a parent view does not exist")}unlayout(){let t=this.options.parent;this._traitNames.forEach(r=>{t?t.el.style.removeProperty(this.css_name(r)):console.warn("Style not removed because a parent view does not exist")},this)}};var QR=class extends up{defaults(){let t=this.constructor;return xd(super.defaults(),{_model_name:"StyleModel",_view_name:"StyleView"},Object.keys(t.styleProperties).reduce((r,n)=>(r[n]=t.styleProperties[n].default,r),{}))}};QR.styleProperties={};var N8=class extends gA{initialize(t){this._traitNames=[],super.initialize(t);let r=this.model.constructor;for(let n of Object.keys(r.styleProperties))this.registerTrait(n);this.style()}registerTrait(t){this._traitNames.push(t),this.listenTo(this.model,"change:"+t,(r,n)=>{this.handleChange(t,n)})}handleChange(t,r){let n=this.options.parent;if(n){let o=this.model.constructor.styleProperties,s=o[t].attribute,c=o[t].selector,l=c?n.el.querySelectorAll(c):[n.el];if(r===null)for(let h=0;h!==l.length;++h)l[h].style.removeProperty(s);else for(let h=0;h!==l.length;++h)l[h].style[s]=r}else console.warn("Style not applied because a parent view does not exist")}style(){for(let t of this._traitNames)this.handleChange(t,this.model.get(t))}unstyle(){let t=this.options.parent,n=this.model.constructor.styleProperties;this._traitNames.forEach(i=>{if(t){let o=n[i].attribute,s=n[i].selector,c=s?t.el.querySelectorAll(s):[t.el];for(let l=0;l!==c.length;++l)c[l].style.removeProperty(o)}else console.warn("Style not removed because a parent view does not exist")},this)}};var k8;(function(e){let t;(function(r){class n{constructor(s){this.targets=Object.create(null),this.comms=Object.create(null),this.kernel=null,this.jsServicesKernel=null,this.init_kernel(s)}init_kernel(s){this.kernel=s,this.jsServicesKernel=s}async new_comm(s,c,l,h,p,x){let w=this.jsServicesKernel.createComm(s,p),E=new i(w);return this.register_comm(E),E.open(c,l,h,x),E}register_target(s,c){let l=this.jsServicesKernel.registerCommTarget(s,(h,p)=>{let x=new i(h);this.register_comm(x);try{return c(x,p)}catch(w){x.close(),console.error(w),console.error(new Error("Exception opening new comm"))}});this.targets[s]=l}unregister_target(s,c){this.targets[s].dispose(),delete this.targets[s]}register_comm(s){return this.comms[s.comm_id]=Promise.resolve(s),s.kernel=this.kernel,s.comm_id}}r.CommManager=n;class i{constructor(s){this.jsServicesComm=null,this.kernel=null,this.jsServicesComm=s}get comm_id(){return this.jsServicesComm.commId}get target_name(){return this.jsServicesComm.targetName}open(s,c,l,h){let p=this.jsServicesComm.open(s,l,h);return this._hookupCallbacks(p,c),p.msg.header.msg_id}send(s,c,l,h){let p=this.jsServicesComm.send(s,l,h);return this._hookupCallbacks(p,c),p.msg.header.msg_id}close(s,c,l,h){let p=this.jsServicesComm.close(s,l,h);return this._hookupCallbacks(p,c),p.msg.header.msg_id}on_msg(s){this.jsServicesComm.onMsg=s.bind(this)}on_close(s){this.jsServicesComm.onClose=s.bind(this)}_hookupCallbacks(s,c){c&&(s.onReply=function(l){c.shell&&c.shell.reply&&c.shell.reply(l)},s.onStdin=function(l){c.input&&c.input(l)},s.onIOPub=function(l){if(c.iopub){if(c.iopub.status&&l.header.msg_type==="status")c.iopub.status(l);else if(c.iopub.clear_output&&l.header.msg_type==="clear_output")c.iopub.clear_output(l);else if(c.iopub.output)switch(l.header.msg_type){case"display_data":case"execute_result":case"stream":case"error":c.iopub.output(l);break;default:break}}})}}r.Comm=i})(t=e.services||(e.services={}))})(k8||(k8={}));var F8=class{constructor(t,r,n){this.initialize(t,r,n)}initialize(t,r,n){this._handler_context=n||this,this._models=[],this.views=[],this._create_view=t,this._remove_view=r||function(i){i.remove()}}update(t,r,n,i){let o=n||this._remove_view,s=r||this._create_view;i=i||this._handler_context;let c=0;for(;c<t.length&&!(c>=this._models.length||t[c]!==this._models[c]);c++);let l=c,h=this.views.splice(l,this.views.length-l);for(let p=0;p<h.length;p++)h[p].then(function(x){o.call(i,x)});for(;c<t.length;c++)this.views.push(Promise.resolve(s.call(i,t[c],c)));return this._models=t.slice(),Promise.all(this.views)}remove(){return Promise.all(this.views).then(t=>{t.forEach(r=>this._remove_view.call(this._handler_context,r)),this.views=[],this._models=[]})}dispose(){this.views=null,this._models=null}};var mht=tc(B1()),Vzt=new mht.Token("jupyter.extensions.jupyterWidgetRegistry");function jzt(e){switch(e){case"int8":return Int8Array;case"uint8":return Uint8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"float32":return Float32Array;case"float64":return Float64Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`Unrecognized dtype ${e}`)}}function Aht(e,t){if(!e)return null;for(let r in e){let n=e[r].attributes;for(let i in n){let{dtype:o,value:s}=n[i],c=jzt(o);n[i].value=new c(s.buffer)}}return e}var _A=null,z8=zT&&Sx;if(z8){class e extends z8{defaults(){return{...super.defaults(),_model_name:_A.model_name,_model_module:_A.model_module,_model_module_version:_A.model_module_version,_view_name:_A.view_name,_view_module:_A.view_module,_view_module_version:_A.view_module_version,custom_libraries:[],json_input:null,mapbox_key:null,selected_data:[],data_buffer:null,tooltip:null,width:"100%",height:500,js_warning:!1}}static get serializers(){return{...z8.serializers,data_buffer:{deserialize:Aht}}}static get model_name(){return"JupyterTransportModel"}static get model_module(){return ev}static get model_module_version(){return tv}static get view_name(){return"JupyterTransportView"}static get view_module(){return ev}static get view_module_version(){return tv}}_A=e}var ght=_A;var yht=null,_ht=zT&&FT;if(_ht){class e extends _ht{initialize(){this.listenTo(this.model,"destroy",this.remove),this.transport=new ug,this.transport.jupyterModel=this.model,this.transport.jupyterView=this,this.transport._initialize(),super.initialize.apply(this,arguments)}remove(){this.transport&&(this.transport._finalize(),this.transport.jupyterModel=null,this.transport.jupyterView=null,this.transport=null)}render(){super.render(),this.model.on("change:json_input",this.onJsonChanged.bind(this)),this.model.on("change:data_buffer",this.onDataBufferChanged.bind(this)),this.onDataBufferChanged()}onJsonChanged(){let r=JSON.parse(this.model.get("json_input"));this.transport._messageReceived({type:"json",json:r})}onDataBufferChanged(){let r=this.model.get("json_input"),n=this.model.get("data_buffer");r&&n?this.transport._messageReceived({type:"json-with-binary",json:r,binary:n}):this.transport._messageReceived({type:"json",json:r})}}yht=e}var xht=yht;var U8={};Lo(U8,{Buffer:()=>Vn,BufferTransform:()=>uu,CubeGeometry:()=>Xp,Device:()=>Dl,Framebuffer:()=>Lf,Geometry:()=>Mi,GroupNode:()=>hu,Model:()=>jn,ModelNode:()=>Wf,ScenegraphNode:()=>Zu,SphereGeometry:()=>x2,Texture:()=>fi,TextureTransform:()=>gm,attachDevice:()=>Yzt,createDevice:()=>Kzt,enforceWebGL2:()=>Zzt,getBestAvailableAdapter:()=>Gzt,getSupportedAdapters:()=>qzt,registerDevices:()=>Wzt,setDefaultDeviceProps:()=>Xzt,stats:()=>Hzt});var{stats:Hzt,registerDevices:Wzt,getSupportedAdapters:qzt,getBestAvailableAdapter:Gzt,setDefaultDeviceProps:Xzt,attachDevice:Yzt,createDevice:Kzt,enforceWebGL2:Zzt}=Rf;var V8={};Lo(V8,{fetchFile:()=>y_,load:()=>xa,parse:()=>Qd,registerLoaders:()=>HA});var vht=document.body&&document.body.getAttribute("data-base-url");vht&&(window.__webpack_public_path__=`${vht}nbextensions/pydeck/nb_extension`);TI();globalThis.deck=globalThis.deck||{};Object.assign(globalThis.deck,Vw);globalThis.luma=globalThis.luma||{};Object.assign(globalThis.luma,U8);globalThis.loaders=globalThis.loaders||{};Object.assign(globalThis.loaders,V8);return rV($zt);})();
/*! Bundled license information:

long/dist/long.js:
  (**
   * @license long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
   * Released under the Apache License, Version 2.0
   * see: https://github.com/dcodeIO/long.js for details
   *)

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

jquery/dist/jquery.js:
  (*!
   * jQuery JavaScript Library v3.7.1
   * https://jquery.com/
   *
   * Copyright OpenJS Foundation and other contributors
   * Released under the MIT license
   * https://jquery.org/license
   *
   * Date: 2023-08-28T13:37Z
   *)

@loaders.gl/csv/dist/papaparse/papaparse.js:
  (* @license
  Papa Parse
  v5.0.0-beta.0
  https://github.com/mholt/PapaParse
  License: MIT
  *)

long/index.js:
  (**
   * @license
   * Copyright 2009 The Closure Library Authors
   * Copyright 2020 Daniel Wirtz / The long.js Authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   * SPDX-License-Identifier: Apache-2.0
   *)

@lumino/messaging/dist/index.es6.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)

@lumino/disposable/dist/index.es6.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)

@lumino/commands/dist/index.es6.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)

@lumino/virtualdom/dist/index.es6.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)

@lumino/widgets/dist/index.es6.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)
*/
      return __exports__;
      });
//# sourceMappingURL=index.js.map
